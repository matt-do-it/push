/*! For license information please see app.js.LICENSE.txt */
var t={485:t=>{var e=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&a.return&&a.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")},n=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var o=Object,s=["black","red","green","yellow","blue","magenta","cyan","lightGray","","default"],a=["darkGray","lightRed","lightGreen","lightYellow","lightBlue","lightMagenta","lightCyan","white",""],l=["","bright","dim","italic","underline","","","inverse"],u={red:"lightRed",green:"lightGreen",yellow:"lightYellow",blue:"lightBlue",magenta:"lightMagenta",cyan:"lightCyan",black:"darkGray",lightGray:"white"},c={0:"style",2:"unstyle",3:"color",9:"colorLight",4:"bgColor",10:"bgColorLight"},h={color:s,colorLight:a,bgColor:s,bgColorLight:a,style:l,unstyle:l},f=function(t){for(var e in t)t[e]||delete t[e];return 0===o.keys(t).length?void 0:t},d=function(){function t(e,n,r){i(this,t),this.background=e,this.name=n,this.brightness=r}return n(t,[{key:"defaultBrightness",value:function(e){return new t(this.background,this.name,this.brightness||e)}},{key:"css",value:function(t){var e=t?this.inverse:this,n=e.brightness===p.bright&&u[e.name]||e.name,i=e.background?"background:":"color:",o=y.rgb[n],s=this.brightness===p.dim?.5:1;return o?i+"rgba("+[].concat(r(o),[s]).join(",")+");":!e.background&&s<1?"color:rgba(0,0,0,0.5);":""}},{key:"inverse",get:function(){return new t(!this.background,this.name||(this.background?"black":"white"),this.brightness)}},{key:"clean",get:function(){return f({name:"default"===this.name?"":this.name,bright:this.brightness===p.bright,dim:this.brightness===p.dim})}}]),t}(),p=function(){function t(e){i(this,t),void 0!==e&&(this.value=Number(e))}return n(t,[{key:"type",get:function(){return c[Math.floor(this.value/10)]}},{key:"subtype",get:function(){return h[this.type][this.value%10]}},{key:"str",get:function(){return this.value?"["+this.value+"m":""}},{key:"isBrightness",get:function(){return this.value===t.noBrightness||this.value===t.bright||this.value===t.dim}}],[{key:"str",value:function(e){return new t(e).str}}]),t}();o.assign(p,{reset:0,bright:1,dim:2,inverse:7,noBrightness:22,noItalic:23,noUnderline:24,noInverse:27,noColor:39,noBgColor:49});var m=function(t,e){return t+e.charAt(0).toUpperCase()+e.slice(1)},g=[].concat(r(s.map((function(t,e){return t?[[t,30+e,p.noColor],[m("bg",t),40+e,p.noBgColor]]:[]}))),r(a.map((function(t,e){return t?[[t,90+e,p.noColor],[m("bg",t),100+e,p.noBgColor]]:[]}))),r(["","BrightRed","BrightGreen","BrightYellow","BrightBlue","BrightMagenta","BrightCyan"].map((function(t,e){return t?[["bg"+t,100+e,p.noBgColor]]:[]}))),r(l.map((function(t,e){return t?[[t,e,"bright"===t||"dim"===t?p.noBrightness:20+e]]:[]})))).reduce((function(t,e){return t.concat(e)})),y=function(){function t(e){i(this,t),this.spans=e?function(t){for(var e=0,n="",r="",i="",o=[],s=[],a=0,l=t.length;a<l;a++){var u=t[a];switch(n+=u,e){case 0:""===u?(e=1,n=u):r+=u;break;case 1:"["===u?(e=2,i="",o=[]):(e=0,r+=n);break;case 2:if(u>="0"&&u<="9")i+=u;else if(";"===u)o.push(new p(i)),i="";else if("m"===u){i=i||"0",o.push(new p(i));var c=!0,h=!1,f=void 0;try{for(var d,m=o[Symbol.iterator]();!(c=(d=m.next()).done);c=!0){var g=d.value;s.push({text:r,code:g}),r=""}}catch(t){h=!0,f=t}finally{try{!c&&m.return&&m.return()}finally{if(h)throw f}}e=0}else e=0,r+=n}}return 0!==e&&(r+=n),r&&s.push({text:r,code:new p}),s}(e):[]}return n(t,[{key:Symbol.iterator,value:function(){return this.spans[Symbol.iterator]()}},{key:"str",get:function(){return this.spans.reduce((function(t,e){return t+e.text+e.code.str}),"")}},{key:"parsed",get:function(){var e=void 0,n=void 0,r=void 0,i=void 0;function s(){e=new d,n=new d(!0),r=void 0,i=new Set}return s(),o.assign(new t,{spans:this.spans.map((function(t){var a=t.code,l=i.has("inverse"),u=i.has("underline")?"text-decoration: underline;":"",c=i.has("italic")?"font-style: italic;":"",h=r===p.bright?"font-weight: bold;":"",m=e.defaultBrightness(r),g=o.assign({css:h+c+u+m.css(l)+n.css(l)},f({bold:!!h,color:m.clean,bgColor:n.clean}),t),y=!0,b=!1,v=void 0;try{for(var w,x=i[Symbol.iterator]();!(y=(w=x.next()).done);y=!0)g[w.value]=!0}catch(t){b=!0,v=t}finally{try{!y&&x.return&&x.return()}finally{if(b)throw v}}if(a.isBrightness)r=a.value;else if(void 0!==t.code.value)if(t.code.value===p.reset)s();else switch(t.code.type){case"color":case"colorLight":e=new d(!1,a.subtype);break;case"bgColor":case"bgColorLight":n=new d(!0,a.subtype);break;case"style":i.add(a.subtype);break;case"unstyle":i.delete(a.subtype)}return g})).filter((function(t){return t.text.length>0}))})}},{key:"asChromeConsoleLogArguments",get:function(){var t=this.parsed.spans;return[t.map((function(t){return"%c"+t.text})).join("")].concat(r(t.map((function(t){return t.css}))))}},{key:"browserConsoleArguments",get:function(){return this.asChromeConsoleLogArguments}}],[{key:"parse",value:function(e){return new t(e).parsed}},{key:"strip",value:function(t){return t.replace(/[\u001b\u009b][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-PRZcf-nqry=><]/g,"")}},{key:"isEscaped",value:function(e){return e=String(e),t.strip(e)!==e}},{key:"nice",get:function(){return t.names.forEach((function(e){e in String.prototype||o.defineProperty(String.prototype,e,{get:function(){return t[e](this)}})})),t}},{key:"ansicolor",get:function(){return t}}]),t}();!function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n;return g.reduce((function(n,i){var s=e(i,3),a=s[0],l=s[1],u=s[2];return o.defineProperty(n,a,{get:function(){return t((function(t){return r(function(t,e,n){var r=p.str(e),i=p.str(n);return String(t).split("\n").map((function(t){return(r+(e=t.replace(/\u001b\[22m(\u001b\[(1|2)m)/g,"$1"),n=i,o=r,e.split(n).join(o))+i).replace(/(\u001b\[(1|2)m)/g,"[22m$1");var e,n,o})).join("\n")}(t,l,u))}))}})}),n)}(y,(function(t){return t})),y.names=g.map((function(t){return e(t,1)[0]})),y.rgb={black:[0,0,0],darkGray:[100,100,100],lightGray:[200,200,200],white:[255,255,255],red:[204,0,0],lightRed:[255,51,0],green:[0,204,0],lightGreen:[51,204,51],yellow:[204,102,0],lightYellow:[255,153,51],blue:[0,0,255],lightBlue:[26,140,255],magenta:[204,0,204],lightMagenta:[255,0,255],cyan:[0,153,255],lightCyan:[0,204,255]},t.exports=y},611:(t,e,n)=>{function r(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}const i=Object;var o=n(737);const s=o.first,a=o.strlen,l=(t,e)=>{const n=(t,e)=>t.reduce(((t,e)=>e.map(((e,n)=>[].concat(r(t[n]||[]),[e])))),[]).map((t=>e.apply(void 0,r(t)))),o=t.map((t=>t.map((t=>t.replace(/\n/g,"\\n"))))),l=o.map((t=>t.map(a))),u=n(l,Math.max),c=i.assign({delimiter:"  ",minColumnWidths:u.map((t=>0)),maxTotalWidth:0},e),h=a(c.delimiter),f=u.reduce(((t,e)=>t+e),0),d=u.map((t=>t/f)),p=c.maxTotalWidth-h*(u.length-1),m=Math.max(0,f-p),g=n([c.minColumnWidths,u,d],((t,e,n)=>Math.max(t,Math.floor(e-m*n)))),y=l.map((t=>n([g,t],((t,e)=>t-e))));return n([o,y],((t,e)=>n([t,e],((t,e)=>{return e>=0?c.right?" ".repeat(e)+t:t+" ".repeat(e):(n=t,r=a(t)+e,s(n,r-1)+"â€¦");var n,r})).join(c.delimiter)))},u=t=>i.assign((e=>{var n;if(e[0]&&Array.isArray(e[0]))return l(e.map((e=>e.map(((e,n)=>void 0===e?"":t.print(e,n))))),t).join("\n");const o=[].concat(r(new Set((n=[]).concat.apply(n,r(e.map(i.keys)))))),s=[o.map(t.title)].concat(r(e.map((e=>o.map((n=>void 0===e[n]?"":t.print(e[n],n))))))),u=l(s,t);return(t.dash?[u[0],t.dash.repeat(a(u[0]))].concat(r(u.slice(1))):u).join("\n")}),t,{configure:e=>u(i.assign({},t,e))});t.exports=u({maxTotalWidth:Number.MAX_SAFE_INTEGER,print:String,title:String,dash:"-",right:!1})},719:(t,e)=>{e.byteLength=function(t){var e=a(t),n=e[0],r=e[1];return 3*(n+r)/4-r},e.toByteArray=function(t){var e,n,o=a(t),s=o[0],l=o[1],u=new i(function(t,e,n){return 3*(e+n)/4-n}(0,s,l)),c=0,h=l>0?s-4:s;for(n=0;n<h;n+=4)e=r[t.charCodeAt(n)]<<18|r[t.charCodeAt(n+1)]<<12|r[t.charCodeAt(n+2)]<<6|r[t.charCodeAt(n+3)],u[c++]=e>>16&255,u[c++]=e>>8&255,u[c++]=255&e;return 2===l&&(e=r[t.charCodeAt(n)]<<2|r[t.charCodeAt(n+1)]>>4,u[c++]=255&e),1===l&&(e=r[t.charCodeAt(n)]<<10|r[t.charCodeAt(n+1)]<<4|r[t.charCodeAt(n+2)]>>2,u[c++]=e>>8&255,u[c++]=255&e),u},e.fromByteArray=function(t){for(var e,r=t.length,i=r%3,o=[],s=16383,a=0,u=r-i;a<u;a+=s)o.push(l(t,a,a+s>u?u:a+s));return 1===i?(e=t[r-1],o.push(n[e>>2]+n[e<<4&63]+"==")):2===i&&(e=(t[r-2]<<8)+t[r-1],o.push(n[e>>10]+n[e>>4&63]+n[e<<2&63]+"=")),o.join("")};for(var n=[],r=[],i="undefined"!=typeof Uint8Array?Uint8Array:Array,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0;s<64;++s)n[s]=o[s],r[o.charCodeAt(s)]=s;function a(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function l(t,e,r){for(var i,o,s=[],a=e;a<r;a+=3)i=(t[a]<<16&16711680)+(t[a+1]<<8&65280)+(255&t[a+2]),s.push(n[(o=i)>>18&63]+n[o>>12&63]+n[o>>6&63]+n[63&o]);return s.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},600:(t,e,n)=>{const r=n(719),i=n(6),o="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.hp=l,e.IS=50;const s=2147483647;function a(t){if(t>s)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,l.prototype),e}function l(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return h(t)}return u(t,e,n)}function u(t,e,n){if("string"==typeof t)return function(t,e){if("string"==typeof e&&""!==e||(e="utf8"),!l.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const n=0|m(t,e);let r=a(n);const i=r.write(t,e);return i!==n&&(r=r.slice(0,i)),r}(t,e);if(ArrayBuffer.isView(t))return function(t){if(X(t,Uint8Array)){const e=new Uint8Array(t);return d(e.buffer,e.byteOffset,e.byteLength)}return f(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(X(t,ArrayBuffer)||t&&X(t.buffer,ArrayBuffer))return d(t,e,n);if("undefined"!=typeof SharedArrayBuffer&&(X(t,SharedArrayBuffer)||t&&X(t.buffer,SharedArrayBuffer)))return d(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return l.from(r,e,n);const i=function(t){if(l.isBuffer(t)){const e=0|p(t.length),n=a(e);return 0===n.length||t.copy(n,0,0,e),n}return void 0!==t.length?"number"!=typeof t.length||J(t.length)?a(0):f(t):"Buffer"===t.type&&Array.isArray(t.data)?f(t.data):void 0}(t);if(i)return i;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return l.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function c(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function h(t){return c(t),a(t<0?0:0|p(t))}function f(t){const e=t.length<0?0:0|p(t.length),n=a(e);for(let r=0;r<e;r+=1)n[r]=255&t[r];return n}function d(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),Object.setPrototypeOf(r,l.prototype),r}function p(t){if(t>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return 0|t}function m(t,e){if(l.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||X(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const n=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return H(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return G(t).length;default:if(i)return r?-1:H(t).length;e=(""+e).toLowerCase(),i=!0}}function g(t,e,n){let r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return O(this,e,n);case"utf8":case"utf-8":return A(this,e,n);case"ascii":return D(this,e,n);case"latin1":case"binary":return M(this,e,n);case"base64":return E(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function y(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function b(t,e,n,r,i){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),J(n=+n)&&(n=i?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(i)return-1;n=t.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof e&&(e=l.from(e,r)),l.isBuffer(e))return 0===e.length?-1:v(t,e,n,r,i);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):v(t,[e],n,r,i);throw new TypeError("val must be string, number or Buffer")}function v(t,e,n,r,i){let o,s=1,a=t.length,l=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,l/=2,n/=2}function u(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(i){let r=-1;for(o=n;o<a;o++)if(u(t,o)===u(e,-1===r?0:o-r)){if(-1===r&&(r=o),o-r+1===l)return r*s}else-1!==r&&(o-=o-r),r=-1}else for(n+l>a&&(n=a-l),o=n;o>=0;o--){let n=!0;for(let r=0;r<l;r++)if(u(t,o+r)!==u(e,r)){n=!1;break}if(n)return o}return-1}function w(t,e,n,r){n=Number(n)||0;const i=t.length-n;r?(r=Number(r))>i&&(r=i):r=i;const o=e.length;let s;for(r>o/2&&(r=o/2),s=0;s<r;++s){const r=parseInt(e.substr(2*s,2),16);if(J(r))return s;t[n+s]=r}return s}function x(t,e,n,r){return Y(H(e,t.length-n),t,n,r)}function _(t,e,n,r){return Y(function(t){const e=[];for(let n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function k(t,e,n,r){return Y(G(e),t,n,r)}function S(t,e,n,r){return Y(function(t,e){let n,r,i;const o=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(e,t.length-n),t,n,r)}function E(t,e,n){return 0===e&&n===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,n))}function A(t,e,n){n=Math.min(t.length,n);const r=[];let i=e;for(;i<n;){const e=t[i];let o=null,s=e>239?4:e>223?3:e>191?2:1;if(i+s<=n){let n,r,a,l;switch(s){case 1:e<128&&(o=e);break;case 2:n=t[i+1],128==(192&n)&&(l=(31&e)<<6|63&n,l>127&&(o=l));break;case 3:n=t[i+1],r=t[i+2],128==(192&n)&&128==(192&r)&&(l=(15&e)<<12|(63&n)<<6|63&r,l>2047&&(l<55296||l>57343)&&(o=l));break;case 4:n=t[i+1],r=t[i+2],a=t[i+3],128==(192&n)&&128==(192&r)&&128==(192&a)&&(l=(15&e)<<18|(63&n)<<12|(63&r)<<6|63&a,l>65535&&l<1114112&&(o=l))}}null===o?(o=65533,s=1):o>65535&&(o-=65536,r.push(o>>>10&1023|55296),o=56320|1023&o),r.push(o),i+=s}return function(t){const e=t.length;if(e<=C)return String.fromCharCode.apply(String,t);let n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=C));return n}(r)}l.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),l.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(l.prototype,"parent",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.buffer}}),Object.defineProperty(l.prototype,"offset",{enumerable:!0,get:function(){if(l.isBuffer(this))return this.byteOffset}}),l.poolSize=8192,l.from=function(t,e,n){return u(t,e,n)},Object.setPrototypeOf(l.prototype,Uint8Array.prototype),Object.setPrototypeOf(l,Uint8Array),l.alloc=function(t,e,n){return function(t,e,n){return c(t),t<=0?a(t):void 0!==e?"string"==typeof n?a(t).fill(e,n):a(t).fill(e):a(t)}(t,e,n)},l.allocUnsafe=function(t){return h(t)},l.allocUnsafeSlow=function(t){return h(t)},l.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==l.prototype},l.compare=function(t,e){if(X(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),X(e,Uint8Array)&&(e=l.from(e,e.offset,e.byteLength)),!l.isBuffer(t)||!l.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let n=t.length,r=e.length;for(let i=0,o=Math.min(n,r);i<o;++i)if(t[i]!==e[i]){n=t[i],r=e[i];break}return n<r?-1:r<n?1:0},l.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},l.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return l.alloc(0);let n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;const r=l.allocUnsafe(e);let i=0;for(n=0;n<t.length;++n){let e=t[n];if(X(e,Uint8Array))i+e.length>r.length?(l.isBuffer(e)||(e=l.from(e)),e.copy(r,i)):Uint8Array.prototype.set.call(r,e,i);else{if(!l.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(r,i)}i+=e.length}return r},l.byteLength=m,l.prototype._isBuffer=!0,l.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)y(this,e,e+1);return this},l.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},l.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},l.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?A(this,0,t):g.apply(this,arguments)},l.prototype.toLocaleString=l.prototype.toString,l.prototype.equals=function(t){if(!l.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===l.compare(this,t)},l.prototype.inspect=function(){let t="";const n=e.IS;return t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(t+=" ... "),"<Buffer "+t+">"},o&&(l.prototype[o]=l.prototype.inspect),l.prototype.compare=function(t,e,n,r,i){if(X(t,Uint8Array)&&(t=l.from(t,t.offset,t.byteLength)),!l.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||n>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=n)return 0;if(r>=i)return-1;if(e>=n)return 1;if(this===t)return 0;let o=(i>>>=0)-(r>>>=0),s=(n>>>=0)-(e>>>=0);const a=Math.min(o,s),u=this.slice(r,i),c=t.slice(e,n);for(let t=0;t<a;++t)if(u[t]!==c[t]){o=u[t],s=c[t];break}return o<s?-1:s<o?1:0},l.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},l.prototype.indexOf=function(t,e,n){return b(this,t,e,n,!0)},l.prototype.lastIndexOf=function(t,e,n){return b(this,t,e,n,!1)},l.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const i=this.length-e;if((void 0===n||n>i)&&(n=i),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let o=!1;for(;;)switch(r){case"hex":return w(this,t,e,n);case"utf8":case"utf-8":return x(this,t,e,n);case"ascii":case"latin1":case"binary":return _(this,t,e,n);case"base64":return k(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,e,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},l.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const C=4096;function D(t,e,n){let r="";n=Math.min(t.length,n);for(let i=e;i<n;++i)r+=String.fromCharCode(127&t[i]);return r}function M(t,e,n){let r="";n=Math.min(t.length,n);for(let i=e;i<n;++i)r+=String.fromCharCode(t[i]);return r}function O(t,e,n){const r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);let i="";for(let r=e;r<n;++r)i+=K[t[r]];return i}function T(t,e,n){const r=t.slice(e,n);let i="";for(let t=0;t<r.length-1;t+=2)i+=String.fromCharCode(r[t]+256*r[t+1]);return i}function I(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function N(t,e,n,r,i,o){if(!l.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function $(t,e,n,r,i){U(e,r,i,t,n,7);let o=Number(e&BigInt(4294967295));t[n++]=o,o>>=8,t[n++]=o,o>>=8,t[n++]=o,o>>=8,t[n++]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[n++]=s,s>>=8,t[n++]=s,s>>=8,t[n++]=s,s>>=8,t[n++]=s,n}function F(t,e,n,r,i){U(e,r,i,t,n,7);let o=Number(e&BigInt(4294967295));t[n+7]=o,o>>=8,t[n+6]=o,o>>=8,t[n+5]=o,o>>=8,t[n+4]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[n+3]=s,s>>=8,t[n+2]=s,s>>=8,t[n+1]=s,s>>=8,t[n]=s,n+8}function L(t,e,n,r,i,o){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function B(t,e,n,r,o){return e=+e,n>>>=0,o||L(t,0,n,4),i.write(t,e,n,r,23,4),n+4}function R(t,e,n,r,o){return e=+e,n>>>=0,o||L(t,0,n,8),i.write(t,e,n,r,52,8),n+8}l.prototype.slice=function(t,e){const n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);const r=this.subarray(t,e);return Object.setPrototypeOf(r,l.prototype),r},l.prototype.readUintLE=l.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||I(t,e,this.length);let r=this[t],i=1,o=0;for(;++o<e&&(i*=256);)r+=this[t+o]*i;return r},l.prototype.readUintBE=l.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||I(t,e,this.length);let r=this[t+--e],i=1;for(;e>0&&(i*=256);)r+=this[t+--e]*i;return r},l.prototype.readUint8=l.prototype.readUInt8=function(t,e){return t>>>=0,e||I(t,1,this.length),this[t]},l.prototype.readUint16LE=l.prototype.readUInt16LE=function(t,e){return t>>>=0,e||I(t,2,this.length),this[t]|this[t+1]<<8},l.prototype.readUint16BE=l.prototype.readUInt16BE=function(t,e){return t>>>=0,e||I(t,2,this.length),this[t]<<8|this[t+1]},l.prototype.readUint32LE=l.prototype.readUInt32LE=function(t,e){return t>>>=0,e||I(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},l.prototype.readUint32BE=l.prototype.readUInt32BE=function(t,e){return t>>>=0,e||I(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},l.prototype.readBigUInt64LE=Q((function(t){V(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||q(t,this.length-8);const r=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,i=this[++t]+256*this[++t]+65536*this[++t]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))})),l.prototype.readBigUInt64BE=Q((function(t){V(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||q(t,this.length-8);const r=e*2**24+65536*this[++t]+256*this[++t]+this[++t],i=this[++t]*2**24+65536*this[++t]+256*this[++t]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)})),l.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||I(t,e,this.length);let r=this[t],i=1,o=0;for(;++o<e&&(i*=256);)r+=this[t+o]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*e)),r},l.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||I(t,e,this.length);let r=e,i=1,o=this[t+--r];for(;r>0&&(i*=256);)o+=this[t+--r]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*e)),o},l.prototype.readInt8=function(t,e){return t>>>=0,e||I(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},l.prototype.readInt16LE=function(t,e){t>>>=0,e||I(t,2,this.length);const n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt16BE=function(t,e){t>>>=0,e||I(t,2,this.length);const n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},l.prototype.readInt32LE=function(t,e){return t>>>=0,e||I(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},l.prototype.readInt32BE=function(t,e){return t>>>=0,e||I(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},l.prototype.readBigInt64LE=Q((function(t){V(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||q(t,this.length-8);const r=this[t+4]+256*this[t+5]+65536*this[t+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),l.prototype.readBigInt64BE=Q((function(t){V(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||q(t,this.length-8);const r=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(r)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+n)})),l.prototype.readFloatLE=function(t,e){return t>>>=0,e||I(t,4,this.length),i.read(this,t,!0,23,4)},l.prototype.readFloatBE=function(t,e){return t>>>=0,e||I(t,4,this.length),i.read(this,t,!1,23,4)},l.prototype.readDoubleLE=function(t,e){return t>>>=0,e||I(t,8,this.length),i.read(this,t,!0,52,8)},l.prototype.readDoubleBE=function(t,e){return t>>>=0,e||I(t,8,this.length),i.read(this,t,!1,52,8)},l.prototype.writeUintLE=l.prototype.writeUIntLE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||N(this,t,e,n,Math.pow(2,8*n)-1,0);let i=1,o=0;for(this[e]=255&t;++o<n&&(i*=256);)this[e+o]=t/i&255;return e+n},l.prototype.writeUintBE=l.prototype.writeUIntBE=function(t,e,n,r){t=+t,e>>>=0,n>>>=0,r||N(this,t,e,n,Math.pow(2,8*n)-1,0);let i=n-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+n},l.prototype.writeUint8=l.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||N(this,t,e,1,255,0),this[e]=255&t,e+1},l.prototype.writeUint16LE=l.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||N(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},l.prototype.writeUint16BE=l.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||N(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},l.prototype.writeUint32LE=l.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||N(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},l.prototype.writeUint32BE=l.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||N(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},l.prototype.writeBigUInt64LE=Q((function(t,e=0){return $(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeBigUInt64BE=Q((function(t,e=0){return F(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),l.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){const r=Math.pow(2,8*n-1);N(this,t,e,n,r-1,-r)}let i=0,o=1,s=0;for(this[e]=255&t;++i<n&&(o*=256);)t<0&&0===s&&0!==this[e+i-1]&&(s=1),this[e+i]=(t/o|0)-s&255;return e+n},l.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){const r=Math.pow(2,8*n-1);N(this,t,e,n,r-1,-r)}let i=n-1,o=1,s=0;for(this[e+i]=255&t;--i>=0&&(o*=256);)t<0&&0===s&&0!==this[e+i+1]&&(s=1),this[e+i]=(t/o|0)-s&255;return e+n},l.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||N(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},l.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||N(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},l.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||N(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},l.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||N(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},l.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||N(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},l.prototype.writeBigInt64LE=Q((function(t,e=0){return $(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeBigInt64BE=Q((function(t,e=0){return F(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),l.prototype.writeFloatLE=function(t,e,n){return B(this,t,e,!0,n)},l.prototype.writeFloatBE=function(t,e,n){return B(this,t,e,!1,n)},l.prototype.writeDoubleLE=function(t,e,n){return R(this,t,e,!0,n)},l.prototype.writeDoubleBE=function(t,e,n){return R(this,t,e,!1,n)},l.prototype.copy=function(t,e,n,r){if(!l.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);const i=r-n;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,n,r):Uint8Array.prototype.set.call(t,this.subarray(n,r),e),i},l.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!l.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===t.length){const e=t.charCodeAt(0);("utf8"===r&&e<128||"latin1"===r)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;let i;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(i=e;i<n;++i)this[i]=t;else{const o=l.isBuffer(t)?t:l.from(t,r),s=o.length;if(0===s)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(i=0;i<n-e;++i)this[i+e]=o[i%s]}return this};const P={};function z(t,e,n){P[t]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function j(t){let e="",n=t.length;const r="-"===t[0]?1:0;for(;n>=r+4;n-=3)e=`_${t.slice(n-3,n)}${e}`;return`${t.slice(0,n)}${e}`}function U(t,e,n,r,i,o){if(t>n||t<e){const r="bigint"==typeof e?"n":"";let i;throw i=o>3?0===e||e===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(o+1)}${r}`:`>= -(2${r} ** ${8*(o+1)-1}${r}) and < 2 ** ${8*(o+1)-1}${r}`:`>= ${e}${r} and <= ${n}${r}`,new P.ERR_OUT_OF_RANGE("value",i,t)}!function(t,e,n){V(e,"offset"),void 0!==t[e]&&void 0!==t[e+n]||q(e,t.length-(n+1))}(r,i,o)}function V(t,e){if("number"!=typeof t)throw new P.ERR_INVALID_ARG_TYPE(e,"number",t)}function q(t,e,n){if(Math.floor(t)!==t)throw V(t,n),new P.ERR_OUT_OF_RANGE(n||"offset","an integer",t);if(e<0)throw new P.ERR_BUFFER_OUT_OF_BOUNDS;throw new P.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${e}`,t)}z("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),z("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),z("ERR_OUT_OF_RANGE",(function(t,e,n){let r=`The value of "${t}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=j(String(n)):"bigint"==typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=j(i)),i+="n"),r+=` It must be ${e}. Received ${i}`,r}),RangeError);const W=/[^+/0-9A-Za-z-_]/g;function H(t,e){let n;e=e||1/0;const r=t.length;let i=null;const o=[];for(let s=0;s<r;++s){if(n=t.charCodeAt(s),n>55295&&n<57344){if(!i){if(n>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(e-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((e-=1)<0)break;o.push(n)}else if(n<2048){if((e-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function G(t){return r.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(W,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function Y(t,e,n,r){let i;for(i=0;i<r&&!(i+n>=e.length||i>=t.length);++i)e[i+n]=t[i];return i}function X(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function J(t){return t!=t}const K=function(){const t="0123456789abcdef",e=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let i=0;i<16;++i)e[r+i]=t[n]+t[i]}return e}();function Q(t){return"undefined"==typeof BigInt?Z:t}function Z(){throw new Error("BigInt not supported")}},943:t=>{t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var n="",r=void 0!==e[5];return e[4]&&(n+="@supports (".concat(e[4],") {")),e[2]&&(n+="@media ".concat(e[2]," {")),r&&(n+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),n+=t(e),r&&(n+="}"),e[2]&&(n+="}"),e[4]&&(n+="}"),n})).join("")},e.i=function(t,n,r,i,o){"string"==typeof t&&(t=[[null,t,void 0]]);var s={};if(r)for(var a=0;a<this.length;a++){var l=this[a][0];null!=l&&(s[l]=!0)}for(var u=0;u<t.length;u++){var c=[].concat(t[u]);r&&s[c[0]]||(void 0!==o&&(void 0===c[5]||(c[1]="@layer".concat(c[5].length>0?" ".concat(c[5]):""," {").concat(c[1],"}")),c[5]=o),n&&(c[2]?(c[1]="@media ".concat(c[2]," {").concat(c[1],"}"),c[2]=n):c[2]=n),i&&(c[4]?(c[1]="@supports (".concat(c[4],") {").concat(c[1],"}"),c[4]=i):c[4]="".concat(i)),e.push(c))}},e}},486:t=>{t.exports=function(t){return t[1]}},230:(t,e,n)=>{var r=n(600).hp;t.exports=function(t){if(!/^data\:/i.test(t))throw new TypeError('`uri` does not appear to be a Data URI (must begin with "data:")');var e=(t=t.replace(/\r?\n/g,"")).indexOf(",");if(-1===e||e<=4)throw new TypeError("malformed data: URI");for(var n=t.substring(5,e).split(";"),i=n[0]||"text/plain",o=i,s=!1,a="",l=1;l<n.length;l++)"base64"==n[l]?s=!0:(o+=";"+n[l],0==n[l].indexOf("charset=")&&(a=n[l].substring(8)));n[0]||a.length||(o+=";charset=US-ASCII",a="US-ASCII");var u=unescape(t.substring(e+1)),c=s?"base64":"ascii",h=r.from?r.from(u,c):new r(u,c);return h.type=i,h.typeFull=o,h.charset=a,h}},352:(t,e,n)=>{t=n.nmd(t);const{assign:r}=Object,i="undefined"!=typeof window&&window.window===window&&window.navigator,o=n(184).SourceMapConsumer,s=n(575),a=n(284),l=n(230),u=i?null:t.require,c=t=>{const e=n=>n in e.cache?e.cache[n]:e.cache[n]=t(n);return e.forgetEverything=()=>{e.cache=Object.create(null)},e.cache=Object.create(null),e};function h(t,e){const n=e?s:Promise,i=c((e=>u(e,t(e))));function u(t,h){return void 0===h?i(a.resolve(t)):n.resolve(h).then((n=>{let i,h,f,d=t=>(f=f||function(t){const e=/\u0023 sourceMappingURL=(.+)\n?/g;let n;for(;;){const r=e.exec(t.text);if(!r)break;n=r}const i=n&&n[1],s=e=>r({},e,{sourceFile:t,sourceLine:t.lines[e.line-1]||""});return i?function(t,e,n){const i=e.startsWith("data:")?u(t,l(e).toString()):u(a.relativeToFile(t,e)),s=i.then((t=>o(JSON.parse(t.text)))),h=c((function(t){return i.then((e=>{const n=a.relativeToFile(e.path,t);return s.then((e=>u(n,e.sourceContentFor(t,!0)||void 0)))}))}));return t=>s.then((e=>{const i=e.originalPositionFor(t);return i.source?h(i.source).then((e=>e._resolve(r({},t,{line:i.line,column:i.column+1,name:i.name})))):n(t)})).catch((e=>r(n(t),{sourceMapError:e})))}(t.path,i,s):s}(i))(t);return i={path:t,text:n,get lines(){return h=h||n.split("\n")},resolve(t){const n=d(t);if(!e)return Promise.resolve(n);try{return s.valueFrom(n)}catch(e){return r({},t,{error:e})}},_resolve:d}}))}return r((function(t){const n=u(t);if(e)try{return s.valueFrom(n)}catch(e){const n={path:t,text:"",lines:[],error:e,resolve:t=>r({},t,{error:e,sourceLine:"",sourceFile:n})};return n}return n}),{resetCache:()=>i.forgetEverything(),getCache:()=>i.cache})}t.exports=h((function(t){return new s((e=>{if(i){let n=new XMLHttpRequest;n.open("GET",t,!1),n.send(null),e(n.responseText)}else e(u("fs").readFileSync(t,{encoding:"utf8"}))}))}),!0),t.exports.async=h((function(t){return new Promise(((e,n)=>{if(i){let r=new XMLHttpRequest;r.open("GET",t),r.onreadystatechange=t=>{4===r.readyState&&(200===r.status?e(r.responseText):n(new Error(r.statusText)))},r.send(null)}else u("fs").readFile(t,{encoding:"utf8"},((t,r)=>{t?n(t):e(r)}))}))}))},575:t=>{t.exports=class t{constructor(t){try{t((t=>{this.setValue(t,!1)}),(t=>{this.setValue(t,!0)}))}catch(t){this.setValue(t,!0)}}setValue(e,n){this.val=e instanceof t?e.val:e,this.rejected=n||e instanceof t&&e.rejected}static valueFrom(e){if(e instanceof t){if(e.rejected)throw e.val;return e.val}return e}then(e){try{if(!this.rejected)return t.resolve(e(this.val))}catch(e){return t.reject(e)}return this}catch(e){try{if(this.rejected)return t.resolve(e(this.val))}catch(e){return t.reject(e)}return this}static resolve(e){return new t((t=>{t(e)}))}static reject(e){return new t(((t,n)=>{n(e)}))}}},284:t=>{const e="undefined"!=typeof window&&window.window===window&&window.navigator,n=e?window.location.href:process.cwd(),r=new RegExp("^((https|http)://)?[a-z0-9A-Z]{3}.[a-z0-9A-Z][a-z0-9A-Z]{0,61}?[a-z0-9A-Z].com|net|cn|cc (:s[0-9]{1-4})?/$"),i=t.exports={concat(t,e){const n="/"===t[t.length-1],r="/"===e[0];return t+(n||r?"":"/")+(n&&r?e.substring(1):e)},resolve:t=>i.isAbsolute(t)?i.normalize(t):i.normalize(i.concat(n,t)),normalize(t){let n=[],r=0;t.split("/").reverse().filter((t=>"."!==t)).forEach((t=>{".."===t?r++:0===r?n.push(t):r--}));const i=n.reverse().join("/");return(e&&"/"===i[0]?"/"===i[1]?window.location.protocol:window.location.origin:"")+i},isData:t=>0===t.indexOf("data:"),isURL:t=>r.test(t),isAbsolute:t=>"/"===t[0]||/^[^\/]*:/.test(t),relativeToFile:(t,e)=>i.isData(t)||i.isAbsolute(e)?i.normalize(e):i.normalize(i.concat(t.split("/").slice(0,-1).join("/"),e))}},6:(t,e)=>{e.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,l=(1<<a)-1,u=l>>1,c=-7,h=n?i-1:0,f=n?-1:1,d=t[e+h];for(h+=f,o=d&(1<<-c)-1,d>>=-c,c+=a;c>0;o=256*o+t[e+h],h+=f,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=r;c>0;s=256*s+t[e+h],h+=f,c-=8);if(0===o)o=1-u;else{if(o===l)return s?NaN:1/0*(d?-1:1);s+=Math.pow(2,r),o-=u}return(d?-1:1)*s*Math.pow(2,o-r)},e.write=function(t,e,n,r,i,o){var s,a,l,u=8*o-i-1,c=(1<<u)-1,h=c>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,d=r?0:o-1,p=r?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-s))<1&&(s--,l*=2),(e+=s+h>=1?f/l:f*Math.pow(2,1-h))*l>=2&&(s++,l/=2),s+h>=c?(a=0,s=c):s+h>=1?(a=(e*l-1)*Math.pow(2,i),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;t[n+d]=255&a,d+=p,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;t[n+d]=255&s,d+=p,s/=256,u-=8);t[n+d-p]|=128*m}},737:t=>{var e=function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var n=[],r=!0,i=!1,o=void 0;try{for(var s,a=t[Symbol.iterator]();!(r=(s=a.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,o=t}finally{try{!r&&a.return&&a.return()}finally{if(i)throw o}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")};const n="[Â›][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-PRZcf-nqry=><]",r="\0-\b\v-Â›Â­â€‹\u2028\u2029\ufeffï¸€-ï¸",i="\n"+r,o=new RegExp("(?:"+n+")|["+r+"]","g"),s=new RegExp("(?:"+n+")|["+i+"]","g"),a=new RegExp("((?:"+n+")|[\t"+i+"])?([^\t"+i+"]*)","g");t.exports={zeroWidthCharacters:s,ansiEscapeCodes:new RegExp(n,"g"),strlen:t=>Array.from(t.replace(s,"")).length,isBlank:t=>0===t.replace(s,"").replace(/\s/g,"").length,blank:t=>Array.from(t.replace(o,"")).map((t=>"\t"===t||"\n"===t?t:" ")).join(""),partition(t){for(var e,n=[];a.lastIndex!==t.length&&(e=a.exec(t));)n.push([e[1]||"",e[2]]);return a.lastIndex=0,n},first(n,r){let i="",o=0;for(const a of t.exports.partition(n)){var s=e(a,2);const t=s[0],n=s[1],l=Array.from(n).slice(0,r-o);i+=t+l.join(""),o+=l.length}return i}}},524:(t,e,n)=>{var r=n(202),i=Object.prototype.hasOwnProperty,o="undefined"!=typeof Map;function s(){this._array=[],this._set=o?new Map:Object.create(null)}s.fromArray=function(t,e){for(var n=new s,r=0,i=t.length;r<i;r++)n.add(t[r],e);return n},s.prototype.size=function(){return o?this._set.size:Object.getOwnPropertyNames(this._set).length},s.prototype.add=function(t,e){var n=o?t:r.toSetString(t),s=o?this.has(t):i.call(this._set,n),a=this._array.length;s&&!e||this._array.push(t),s||(o?this._set.set(t,a):this._set[n]=a)},s.prototype.has=function(t){if(o)return this._set.has(t);var e=r.toSetString(t);return i.call(this._set,e)},s.prototype.indexOf=function(t){if(o){var e=this._set.get(t);if(e>=0)return e}else{var n=r.toSetString(t);if(i.call(this._set,n))return this._set[n]}throw new Error('"'+t+'" is not in the set.')},s.prototype.at=function(t){if(t>=0&&t<this._array.length)return this._array[t];throw new Error("No element indexed by "+t)},s.prototype.toArray=function(){return this._array.slice()},e.C=s},685:(t,e,n)=>{var r=n(741);e.encode=function(t){var e,n="",i=function(t){return t<0?1+(-t<<1):0+(t<<1)}(t);do{e=31&i,(i>>>=5)>0&&(e|=32),n+=r.encode(e)}while(i>0);return n},e.decode=function(t,e,n){var i,o,s,a,l=t.length,u=0,c=0;do{if(e>=l)throw new Error("Expected more digits in base 64 VLQ value.");if(-1===(o=r.decode(t.charCodeAt(e++))))throw new Error("Invalid base64 digit: "+t.charAt(e-1));i=!!(32&o),u+=(o&=31)<<c,c+=5}while(i);n.value=(a=(s=u)>>1,1&~s?a:-a),n.rest=e}},741:(t,e)=>{var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");e.encode=function(t){if(0<=t&&t<n.length)return n[t];throw new TypeError("Must be between 0 and 63: "+t)},e.decode=function(t){return 65<=t&&t<=90?t-65:97<=t&&t<=122?t-97+26:48<=t&&t<=57?t-48+52:43==t?62:47==t?63:-1}},848:(t,e)=>{function n(t,r,i,o,s,a){var l=Math.floor((r-t)/2)+t,u=s(i,o[l],!0);return 0===u?l:u>0?r-l>1?n(l,r,i,o,s,a):a==e.LEAST_UPPER_BOUND?r<o.length?r:-1:l:l-t>1?n(t,l,i,o,s,a):a==e.LEAST_UPPER_BOUND?l:t<0?-1:t}e.GREATEST_LOWER_BOUND=1,e.LEAST_UPPER_BOUND=2,e.search=function(t,r,i,o){if(0===r.length)return-1;var s=n(-1,r.length,t,r,i,o||e.GREATEST_LOWER_BOUND);if(s<0)return-1;for(;s-1>=0&&0===i(r[s],r[s-1],!0);)--s;return s}},799:(t,e,n)=>{var r=n(202);function i(){this._array=[],this._sorted=!0,this._last={generatedLine:-1,generatedColumn:0}}i.prototype.unsortedForEach=function(t,e){this._array.forEach(t,e)},i.prototype.add=function(t){var e,n,i,o,s,a;n=t,i=(e=this._last).generatedLine,o=n.generatedLine,s=e.generatedColumn,a=n.generatedColumn,o>i||o==i&&a>=s||r.compareByGeneratedPositionsInflated(e,n)<=0?(this._last=t,this._array.push(t)):(this._sorted=!1,this._array.push(t))},i.prototype.toArray=function(){return this._sorted||(this._array.sort(r.compareByGeneratedPositionsInflated),this._sorted=!0),this._array},e.P=i},560:(t,e)=>{function n(t,e,n){var r=t[e];t[e]=t[n],t[n]=r}function r(t,e,i,o){if(i<o){var s=i-1;n(t,(c=i,h=o,Math.round(c+Math.random()*(h-c))),o);for(var a=t[o],l=i;l<o;l++)e(t[l],a)<=0&&n(t,s+=1,l);n(t,s+1,l);var u=s+1;r(t,e,i,u-1),r(t,e,u+1,o)}var c,h}e.g=function(t,e){r(t,e,0,t.length-1)}},961:(t,e,n)=>{var r=n(202),i=n(848),o=n(524).C,s=n(685),a=n(560).g;function l(t,e){var n=t;return"string"==typeof t&&(n=r.parseSourceMapInput(t)),null!=n.sections?new h(n,e):new u(n,e)}function u(t,e){var n=t;"string"==typeof t&&(n=r.parseSourceMapInput(t));var i=r.getArg(n,"version"),s=r.getArg(n,"sources"),a=r.getArg(n,"names",[]),l=r.getArg(n,"sourceRoot",null),u=r.getArg(n,"sourcesContent",null),c=r.getArg(n,"mappings"),h=r.getArg(n,"file",null);if(i!=this._version)throw new Error("Unsupported version: "+i);l&&(l=r.normalize(l)),s=s.map(String).map(r.normalize).map((function(t){return l&&r.isAbsolute(l)&&r.isAbsolute(t)?r.relative(l,t):t})),this._names=o.fromArray(a.map(String),!0),this._sources=o.fromArray(s,!0),this._absoluteSources=this._sources.toArray().map((function(t){return r.computeSourceURL(l,t,e)})),this.sourceRoot=l,this.sourcesContent=u,this._mappings=c,this._sourceMapURL=e,this.file=h}function c(){this.generatedLine=0,this.generatedColumn=0,this.source=null,this.originalLine=null,this.originalColumn=null,this.name=null}function h(t,e){var n=t;"string"==typeof t&&(n=r.parseSourceMapInput(t));var i=r.getArg(n,"version"),s=r.getArg(n,"sections");if(i!=this._version)throw new Error("Unsupported version: "+i);this._sources=new o,this._names=new o;var a={line:-1,column:0};this._sections=s.map((function(t){if(t.url)throw new Error("Support for url field in sections not implemented.");var n=r.getArg(t,"offset"),i=r.getArg(n,"line"),o=r.getArg(n,"column");if(i<a.line||i===a.line&&o<a.column)throw new Error("Section offsets must be ordered and non-overlapping.");return a=n,{generatedOffset:{generatedLine:i+1,generatedColumn:o+1},consumer:new l(r.getArg(t,"map"),e)}}))}l.fromSourceMap=function(t,e){return u.fromSourceMap(t,e)},l.prototype._version=3,l.prototype.__generatedMappings=null,Object.defineProperty(l.prototype,"_generatedMappings",{configurable:!0,enumerable:!0,get:function(){return this.__generatedMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__generatedMappings}}),l.prototype.__originalMappings=null,Object.defineProperty(l.prototype,"_originalMappings",{configurable:!0,enumerable:!0,get:function(){return this.__originalMappings||this._parseMappings(this._mappings,this.sourceRoot),this.__originalMappings}}),l.prototype._charIsMappingSeparator=function(t,e){var n=t.charAt(e);return";"===n||","===n},l.prototype._parseMappings=function(t,e){throw new Error("Subclasses must implement _parseMappings")},l.GENERATED_ORDER=1,l.ORIGINAL_ORDER=2,l.GREATEST_LOWER_BOUND=1,l.LEAST_UPPER_BOUND=2,l.prototype.eachMapping=function(t,e,n){var i,o=e||null;switch(n||l.GENERATED_ORDER){case l.GENERATED_ORDER:i=this._generatedMappings;break;case l.ORIGINAL_ORDER:i=this._originalMappings;break;default:throw new Error("Unknown order of iteration.")}var s=this.sourceRoot;i.map((function(t){var e=null===t.source?null:this._sources.at(t.source);return{source:e=r.computeSourceURL(s,e,this._sourceMapURL),generatedLine:t.generatedLine,generatedColumn:t.generatedColumn,originalLine:t.originalLine,originalColumn:t.originalColumn,name:null===t.name?null:this._names.at(t.name)}}),this).forEach(t,o)},l.prototype.allGeneratedPositionsFor=function(t){var e=r.getArg(t,"line"),n={source:r.getArg(t,"source"),originalLine:e,originalColumn:r.getArg(t,"column",0)};if(n.source=this._findSourceIndex(n.source),n.source<0)return[];var o=[],s=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",r.compareByOriginalPositions,i.LEAST_UPPER_BOUND);if(s>=0){var a=this._originalMappings[s];if(void 0===t.column)for(var l=a.originalLine;a&&a.originalLine===l;)o.push({line:r.getArg(a,"generatedLine",null),column:r.getArg(a,"generatedColumn",null),lastColumn:r.getArg(a,"lastGeneratedColumn",null)}),a=this._originalMappings[++s];else for(var u=a.originalColumn;a&&a.originalLine===e&&a.originalColumn==u;)o.push({line:r.getArg(a,"generatedLine",null),column:r.getArg(a,"generatedColumn",null),lastColumn:r.getArg(a,"lastGeneratedColumn",null)}),a=this._originalMappings[++s]}return o},e.SourceMapConsumer=l,u.prototype=Object.create(l.prototype),u.prototype.consumer=l,u.prototype._findSourceIndex=function(t){var e,n=t;if(null!=this.sourceRoot&&(n=r.relative(this.sourceRoot,n)),this._sources.has(n))return this._sources.indexOf(n);for(e=0;e<this._absoluteSources.length;++e)if(this._absoluteSources[e]==t)return e;return-1},u.fromSourceMap=function(t,e){var n=Object.create(u.prototype),i=n._names=o.fromArray(t._names.toArray(),!0),s=n._sources=o.fromArray(t._sources.toArray(),!0);n.sourceRoot=t._sourceRoot,n.sourcesContent=t._generateSourcesContent(n._sources.toArray(),n.sourceRoot),n.file=t._file,n._sourceMapURL=e,n._absoluteSources=n._sources.toArray().map((function(t){return r.computeSourceURL(n.sourceRoot,t,e)}));for(var l=t._mappings.toArray().slice(),h=n.__generatedMappings=[],f=n.__originalMappings=[],d=0,p=l.length;d<p;d++){var m=l[d],g=new c;g.generatedLine=m.generatedLine,g.generatedColumn=m.generatedColumn,m.source&&(g.source=s.indexOf(m.source),g.originalLine=m.originalLine,g.originalColumn=m.originalColumn,m.name&&(g.name=i.indexOf(m.name)),f.push(g)),h.push(g)}return a(n.__originalMappings,r.compareByOriginalPositions),n},u.prototype._version=3,Object.defineProperty(u.prototype,"sources",{get:function(){return this._absoluteSources.slice()}}),u.prototype._parseMappings=function(t,e){for(var n,i,o,l,u,h=1,f=0,d=0,p=0,m=0,g=0,y=t.length,b=0,v={},w={},x=[],_=[];b<y;)if(";"===t.charAt(b))h++,b++,f=0;else if(","===t.charAt(b))b++;else{for((n=new c).generatedLine=h,l=b;l<y&&!this._charIsMappingSeparator(t,l);l++);if(o=v[i=t.slice(b,l)])b+=i.length;else{for(o=[];b<l;)s.decode(t,b,w),u=w.value,b=w.rest,o.push(u);if(2===o.length)throw new Error("Found a source, but no line and column");if(3===o.length)throw new Error("Found a source and line, but no column");v[i]=o}n.generatedColumn=f+o[0],f=n.generatedColumn,o.length>1&&(n.source=m+o[1],m+=o[1],n.originalLine=d+o[2],d=n.originalLine,n.originalLine+=1,n.originalColumn=p+o[3],p=n.originalColumn,o.length>4&&(n.name=g+o[4],g+=o[4])),_.push(n),"number"==typeof n.originalLine&&x.push(n)}a(_,r.compareByGeneratedPositionsDeflated),this.__generatedMappings=_,a(x,r.compareByOriginalPositions),this.__originalMappings=x},u.prototype._findMapping=function(t,e,n,r,o,s){if(t[n]<=0)throw new TypeError("Line must be greater than or equal to 1, got "+t[n]);if(t[r]<0)throw new TypeError("Column must be greater than or equal to 0, got "+t[r]);return i.search(t,e,o,s)},u.prototype.computeColumnSpans=function(){for(var t=0;t<this._generatedMappings.length;++t){var e=this._generatedMappings[t];if(t+1<this._generatedMappings.length){var n=this._generatedMappings[t+1];if(e.generatedLine===n.generatedLine){e.lastGeneratedColumn=n.generatedColumn-1;continue}}e.lastGeneratedColumn=1/0}},u.prototype.originalPositionFor=function(t){var e={generatedLine:r.getArg(t,"line"),generatedColumn:r.getArg(t,"column")},n=this._findMapping(e,this._generatedMappings,"generatedLine","generatedColumn",r.compareByGeneratedPositionsDeflated,r.getArg(t,"bias",l.GREATEST_LOWER_BOUND));if(n>=0){var i=this._generatedMappings[n];if(i.generatedLine===e.generatedLine){var o=r.getArg(i,"source",null);null!==o&&(o=this._sources.at(o),o=r.computeSourceURL(this.sourceRoot,o,this._sourceMapURL));var s=r.getArg(i,"name",null);return null!==s&&(s=this._names.at(s)),{source:o,line:r.getArg(i,"originalLine",null),column:r.getArg(i,"originalColumn",null),name:s}}}return{source:null,line:null,column:null,name:null}},u.prototype.hasContentsOfAllSources=function(){return!!this.sourcesContent&&this.sourcesContent.length>=this._sources.size()&&!this.sourcesContent.some((function(t){return null==t}))},u.prototype.sourceContentFor=function(t,e){if(!this.sourcesContent)return null;var n=this._findSourceIndex(t);if(n>=0)return this.sourcesContent[n];var i,o=t;if(null!=this.sourceRoot&&(o=r.relative(this.sourceRoot,o)),null!=this.sourceRoot&&(i=r.urlParse(this.sourceRoot))){var s=o.replace(/^file:\/\//,"");if("file"==i.scheme&&this._sources.has(s))return this.sourcesContent[this._sources.indexOf(s)];if((!i.path||"/"==i.path)&&this._sources.has("/"+o))return this.sourcesContent[this._sources.indexOf("/"+o)]}if(e)return null;throw new Error('"'+o+'" is not in the SourceMap.')},u.prototype.generatedPositionFor=function(t){var e=r.getArg(t,"source");if((e=this._findSourceIndex(e))<0)return{line:null,column:null,lastColumn:null};var n={source:e,originalLine:r.getArg(t,"line"),originalColumn:r.getArg(t,"column")},i=this._findMapping(n,this._originalMappings,"originalLine","originalColumn",r.compareByOriginalPositions,r.getArg(t,"bias",l.GREATEST_LOWER_BOUND));if(i>=0){var o=this._originalMappings[i];if(o.source===n.source)return{line:r.getArg(o,"generatedLine",null),column:r.getArg(o,"generatedColumn",null),lastColumn:r.getArg(o,"lastGeneratedColumn",null)}}return{line:null,column:null,lastColumn:null}},h.prototype=Object.create(l.prototype),h.prototype.constructor=l,h.prototype._version=3,Object.defineProperty(h.prototype,"sources",{get:function(){for(var t=[],e=0;e<this._sections.length;e++)for(var n=0;n<this._sections[e].consumer.sources.length;n++)t.push(this._sections[e].consumer.sources[n]);return t}}),h.prototype.originalPositionFor=function(t){var e={generatedLine:r.getArg(t,"line"),generatedColumn:r.getArg(t,"column")},n=i.search(e,this._sections,(function(t,e){return t.generatedLine-e.generatedOffset.generatedLine||t.generatedColumn-e.generatedOffset.generatedColumn})),o=this._sections[n];return o?o.consumer.originalPositionFor({line:e.generatedLine-(o.generatedOffset.generatedLine-1),column:e.generatedColumn-(o.generatedOffset.generatedLine===e.generatedLine?o.generatedOffset.generatedColumn-1:0),bias:t.bias}):{source:null,line:null,column:null,name:null}},h.prototype.hasContentsOfAllSources=function(){return this._sections.every((function(t){return t.consumer.hasContentsOfAllSources()}))},h.prototype.sourceContentFor=function(t,e){for(var n=0;n<this._sections.length;n++){var r=this._sections[n].consumer.sourceContentFor(t,!0);if(r)return r}if(e)return null;throw new Error('"'+t+'" is not in the SourceMap.')},h.prototype.generatedPositionFor=function(t){for(var e=0;e<this._sections.length;e++){var n=this._sections[e];if(-1!==n.consumer._findSourceIndex(r.getArg(t,"source"))){var i=n.consumer.generatedPositionFor(t);if(i)return{line:i.line+(n.generatedOffset.generatedLine-1),column:i.column+(n.generatedOffset.generatedLine===i.line?n.generatedOffset.generatedColumn-1:0)}}}return{line:null,column:null}},h.prototype._parseMappings=function(t,e){this.__generatedMappings=[],this.__originalMappings=[];for(var n=0;n<this._sections.length;n++)for(var i=this._sections[n],o=i.consumer._generatedMappings,s=0;s<o.length;s++){var l=o[s],u=i.consumer._sources.at(l.source);u=r.computeSourceURL(i.consumer.sourceRoot,u,this._sourceMapURL),this._sources.add(u),u=this._sources.indexOf(u);var c=null;l.name&&(c=i.consumer._names.at(l.name),this._names.add(c),c=this._names.indexOf(c));var h={source:u,generatedLine:l.generatedLine+(i.generatedOffset.generatedLine-1),generatedColumn:l.generatedColumn+(i.generatedOffset.generatedLine===l.generatedLine?i.generatedOffset.generatedColumn-1:0),originalLine:l.originalLine,originalColumn:l.originalColumn,name:c};this.__generatedMappings.push(h),"number"==typeof h.originalLine&&this.__originalMappings.push(h)}a(this.__generatedMappings,r.compareByGeneratedPositionsDeflated),a(this.__originalMappings,r.compareByOriginalPositions)}},0:(t,e,n)=>{var r=n(685),i=n(202),o=n(524).C,s=n(799).P;function a(t){t||(t={}),this._file=i.getArg(t,"file",null),this._sourceRoot=i.getArg(t,"sourceRoot",null),this._skipValidation=i.getArg(t,"skipValidation",!1),this._sources=new o,this._names=new o,this._mappings=new s,this._sourcesContents=null}a.prototype._version=3,a.fromSourceMap=function(t){var e=t.sourceRoot,n=new a({file:t.file,sourceRoot:e});return t.eachMapping((function(t){var r={generated:{line:t.generatedLine,column:t.generatedColumn}};null!=t.source&&(r.source=t.source,null!=e&&(r.source=i.relative(e,r.source)),r.original={line:t.originalLine,column:t.originalColumn},null!=t.name&&(r.name=t.name)),n.addMapping(r)})),t.sources.forEach((function(r){var o=r;null!==e&&(o=i.relative(e,r)),n._sources.has(o)||n._sources.add(o);var s=t.sourceContentFor(r);null!=s&&n.setSourceContent(r,s)})),n},a.prototype.addMapping=function(t){var e=i.getArg(t,"generated"),n=i.getArg(t,"original",null),r=i.getArg(t,"source",null),o=i.getArg(t,"name",null);this._skipValidation||this._validateMapping(e,n,r,o),null!=r&&(r=String(r),this._sources.has(r)||this._sources.add(r)),null!=o&&(o=String(o),this._names.has(o)||this._names.add(o)),this._mappings.add({generatedLine:e.line,generatedColumn:e.column,originalLine:null!=n&&n.line,originalColumn:null!=n&&n.column,source:r,name:o})},a.prototype.setSourceContent=function(t,e){var n=t;null!=this._sourceRoot&&(n=i.relative(this._sourceRoot,n)),null!=e?(this._sourcesContents||(this._sourcesContents=Object.create(null)),this._sourcesContents[i.toSetString(n)]=e):this._sourcesContents&&(delete this._sourcesContents[i.toSetString(n)],0===Object.keys(this._sourcesContents).length&&(this._sourcesContents=null))},a.prototype.applySourceMap=function(t,e,n){var r=e;if(null==e){if(null==t.file)throw new Error('SourceMapGenerator.prototype.applySourceMap requires either an explicit source file, or the source map\'s "file" property. Both were omitted.');r=t.file}var s=this._sourceRoot;null!=s&&(r=i.relative(s,r));var a=new o,l=new o;this._mappings.unsortedForEach((function(e){if(e.source===r&&null!=e.originalLine){var o=t.originalPositionFor({line:e.originalLine,column:e.originalColumn});null!=o.source&&(e.source=o.source,null!=n&&(e.source=i.join(n,e.source)),null!=s&&(e.source=i.relative(s,e.source)),e.originalLine=o.line,e.originalColumn=o.column,null!=o.name&&(e.name=o.name))}var u=e.source;null==u||a.has(u)||a.add(u);var c=e.name;null==c||l.has(c)||l.add(c)}),this),this._sources=a,this._names=l,t.sources.forEach((function(e){var r=t.sourceContentFor(e);null!=r&&(null!=n&&(e=i.join(n,e)),null!=s&&(e=i.relative(s,e)),this.setSourceContent(e,r))}),this)},a.prototype._validateMapping=function(t,e,n,r){if(e&&"number"!=typeof e.line&&"number"!=typeof e.column)throw new Error("original.line and original.column are not numbers -- you probably meant to omit the original mapping entirely and only map the generated position. If so, pass null for the original mapping instead of an object with empty or null values.");if((!(t&&"line"in t&&"column"in t&&t.line>0&&t.column>=0)||e||n||r)&&!(t&&"line"in t&&"column"in t&&e&&"line"in e&&"column"in e&&t.line>0&&t.column>=0&&e.line>0&&e.column>=0&&n))throw new Error("Invalid mapping: "+JSON.stringify({generated:t,source:n,original:e,name:r}))},a.prototype._serializeMappings=function(){for(var t,e,n,o,s=0,a=1,l=0,u=0,c=0,h=0,f="",d=this._mappings.toArray(),p=0,m=d.length;p<m;p++){if(t="",(e=d[p]).generatedLine!==a)for(s=0;e.generatedLine!==a;)t+=";",a++;else if(p>0){if(!i.compareByGeneratedPositionsInflated(e,d[p-1]))continue;t+=","}t+=r.encode(e.generatedColumn-s),s=e.generatedColumn,null!=e.source&&(o=this._sources.indexOf(e.source),t+=r.encode(o-h),h=o,t+=r.encode(e.originalLine-1-u),u=e.originalLine-1,t+=r.encode(e.originalColumn-l),l=e.originalColumn,null!=e.name&&(n=this._names.indexOf(e.name),t+=r.encode(n-c),c=n)),f+=t}return f},a.prototype._generateSourcesContent=function(t,e){return t.map((function(t){if(!this._sourcesContents)return null;null!=e&&(t=i.relative(e,t));var n=i.toSetString(t);return Object.prototype.hasOwnProperty.call(this._sourcesContents,n)?this._sourcesContents[n]:null}),this)},a.prototype.toJSON=function(){var t={version:this._version,sources:this._sources.toArray(),names:this._names.toArray(),mappings:this._serializeMappings()};return null!=this._file&&(t.file=this._file),null!=this._sourceRoot&&(t.sourceRoot=this._sourceRoot),this._sourcesContents&&(t.sourcesContent=this._generateSourcesContent(t.sources,t.sourceRoot)),t},a.prototype.toString=function(){return JSON.stringify(this.toJSON())},e.x=a},788:(t,e,n)=>{var r=n(0).x,i=n(202),o=/(\r?\n)/,s="$$$isSourceNode$$$";function a(t,e,n,r,i){this.children=[],this.sourceContents={},this.line=null==t?null:t,this.column=null==e?null:e,this.source=null==n?null:n,this.name=null==i?null:i,this[s]=!0,null!=r&&this.add(r)}a.fromStringWithSourceMap=function(t,e,n){var r=new a,s=t.split(o),l=0,u=function(){return t()+(t()||"");function t(){return l<s.length?s[l++]:void 0}},c=1,h=0,f=null;return e.eachMapping((function(t){if(null!==f){if(!(c<t.generatedLine)){var e=(n=s[l]||"").substr(0,t.generatedColumn-h);return s[l]=n.substr(t.generatedColumn-h),h=t.generatedColumn,d(f,e),void(f=t)}d(f,u()),c++,h=0}for(;c<t.generatedLine;)r.add(u()),c++;if(h<t.generatedColumn){var n=s[l]||"";r.add(n.substr(0,t.generatedColumn)),s[l]=n.substr(t.generatedColumn),h=t.generatedColumn}f=t}),this),l<s.length&&(f&&d(f,u()),r.add(s.splice(l).join(""))),e.sources.forEach((function(t){var o=e.sourceContentFor(t);null!=o&&(null!=n&&(t=i.join(n,t)),r.setSourceContent(t,o))})),r;function d(t,e){if(null===t||void 0===t.source)r.add(e);else{var o=n?i.join(n,t.source):t.source;r.add(new a(t.originalLine,t.originalColumn,o,e,t.name))}}},a.prototype.add=function(t){if(Array.isArray(t))t.forEach((function(t){this.add(t)}),this);else{if(!t[s]&&"string"!=typeof t)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+t);t&&this.children.push(t)}return this},a.prototype.prepend=function(t){if(Array.isArray(t))for(var e=t.length-1;e>=0;e--)this.prepend(t[e]);else{if(!t[s]&&"string"!=typeof t)throw new TypeError("Expected a SourceNode, string, or an array of SourceNodes and strings. Got "+t);this.children.unshift(t)}return this},a.prototype.walk=function(t){for(var e,n=0,r=this.children.length;n<r;n++)(e=this.children[n])[s]?e.walk(t):""!==e&&t(e,{source:this.source,line:this.line,column:this.column,name:this.name})},a.prototype.join=function(t){var e,n,r=this.children.length;if(r>0){for(e=[],n=0;n<r-1;n++)e.push(this.children[n]),e.push(t);e.push(this.children[n]),this.children=e}return this},a.prototype.replaceRight=function(t,e){var n=this.children[this.children.length-1];return n[s]?n.replaceRight(t,e):"string"==typeof n?this.children[this.children.length-1]=n.replace(t,e):this.children.push("".replace(t,e)),this},a.prototype.setSourceContent=function(t,e){this.sourceContents[i.toSetString(t)]=e},a.prototype.walkSourceContents=function(t){for(var e=0,n=this.children.length;e<n;e++)this.children[e][s]&&this.children[e].walkSourceContents(t);var r=Object.keys(this.sourceContents);for(e=0,n=r.length;e<n;e++)t(i.fromSetString(r[e]),this.sourceContents[r[e]])},a.prototype.toString=function(){var t="";return this.walk((function(e){t+=e})),t},a.prototype.toStringWithSourceMap=function(t){var e={code:"",line:1,column:0},n=new r(t),i=!1,o=null,s=null,a=null,l=null;return this.walk((function(t,r){e.code+=t,null!==r.source&&null!==r.line&&null!==r.column?(o===r.source&&s===r.line&&a===r.column&&l===r.name||n.addMapping({source:r.source,original:{line:r.line,column:r.column},generated:{line:e.line,column:e.column},name:r.name}),o=r.source,s=r.line,a=r.column,l=r.name,i=!0):i&&(n.addMapping({generated:{line:e.line,column:e.column}}),o=null,i=!1);for(var u=0,c=t.length;u<c;u++)10===t.charCodeAt(u)?(e.line++,e.column=0,u+1===c?(o=null,i=!1):i&&n.addMapping({source:r.source,original:{line:r.line,column:r.column},generated:{line:e.line,column:e.column},name:r.name})):e.column++})),this.walkSourceContents((function(t,e){n.setSourceContent(t,e)})),{code:e.code,map:n}}},202:(t,e)=>{e.getArg=function(t,e,n){if(e in t)return t[e];if(3===arguments.length)return n;throw new Error('"'+e+'" is a required argument.')};var n=/^(?:([\w+\-.]+):)?\/\/(?:(\w+:\w+)@)?([\w.-]*)(?::(\d+))?(.*)$/,r=/^data:.+\,.+$/;function i(t){var e=t.match(n);return e?{scheme:e[1],auth:e[2],host:e[3],port:e[4],path:e[5]}:null}function o(t){var e="";return t.scheme&&(e+=t.scheme+":"),e+="//",t.auth&&(e+=t.auth+"@"),t.host&&(e+=t.host),t.port&&(e+=":"+t.port),t.path&&(e+=t.path),e}function s(t){var n=t,r=i(t);if(r){if(!r.path)return t;n=r.path}for(var s,a=e.isAbsolute(n),l=n.split(/\/+/),u=0,c=l.length-1;c>=0;c--)"."===(s=l[c])?l.splice(c,1):".."===s?u++:u>0&&(""===s?(l.splice(c+1,u),u=0):(l.splice(c,2),u--));return""===(n=l.join("/"))&&(n=a?"/":"."),r?(r.path=n,o(r)):n}function a(t,e){""===t&&(t="."),""===e&&(e=".");var n=i(e),a=i(t);if(a&&(t=a.path||"/"),n&&!n.scheme)return a&&(n.scheme=a.scheme),o(n);if(n||e.match(r))return e;if(a&&!a.host&&!a.path)return a.host=e,o(a);var l="/"===e.charAt(0)?e:s(t.replace(/\/+$/,"")+"/"+e);return a?(a.path=l,o(a)):l}e.urlParse=i,e.urlGenerate=o,e.normalize=s,e.join=a,e.isAbsolute=function(t){return"/"===t.charAt(0)||n.test(t)},e.relative=function(t,e){""===t&&(t="."),t=t.replace(/\/$/,"");for(var n=0;0!==e.indexOf(t+"/");){var r=t.lastIndexOf("/");if(r<0)return e;if((t=t.slice(0,r)).match(/^([^\/]+:\/)?\/*$/))return e;++n}return Array(n+1).join("../")+e.substr(t.length+1)};var l=!("__proto__"in Object.create(null));function u(t){return t}function c(t){if(!t)return!1;var e=t.length;if(e<9)return!1;if(95!==t.charCodeAt(e-1)||95!==t.charCodeAt(e-2)||111!==t.charCodeAt(e-3)||116!==t.charCodeAt(e-4)||111!==t.charCodeAt(e-5)||114!==t.charCodeAt(e-6)||112!==t.charCodeAt(e-7)||95!==t.charCodeAt(e-8)||95!==t.charCodeAt(e-9))return!1;for(var n=e-10;n>=0;n--)if(36!==t.charCodeAt(n))return!1;return!0}function h(t,e){return t===e?0:null===t?1:null===e?-1:t>e?1:-1}e.toSetString=l?u:function(t){return c(t)?"$"+t:t},e.fromSetString=l?u:function(t){return c(t)?t.slice(1):t},e.compareByOriginalPositions=function(t,e,n){var r=h(t.source,e.source);return 0!==r||0!=(r=t.originalLine-e.originalLine)||0!=(r=t.originalColumn-e.originalColumn)||n||0!=(r=t.generatedColumn-e.generatedColumn)||0!=(r=t.generatedLine-e.generatedLine)?r:h(t.name,e.name)},e.compareByGeneratedPositionsDeflated=function(t,e,n){var r=t.generatedLine-e.generatedLine;return 0!==r||0!=(r=t.generatedColumn-e.generatedColumn)||n||0!==(r=h(t.source,e.source))||0!=(r=t.originalLine-e.originalLine)||0!=(r=t.originalColumn-e.originalColumn)?r:h(t.name,e.name)},e.compareByGeneratedPositionsInflated=function(t,e){var n=t.generatedLine-e.generatedLine;return 0!==n||0!=(n=t.generatedColumn-e.generatedColumn)||0!==(n=h(t.source,e.source))||0!=(n=t.originalLine-e.originalLine)||0!=(n=t.originalColumn-e.originalColumn)?n:h(t.name,e.name)},e.parseSourceMapInput=function(t){return JSON.parse(t.replace(/^\)]}'[^\n]*\n/,""))},e.computeSourceURL=function(t,e,n){if(e=e||"",t&&("/"!==t[t.length-1]&&"/"!==e[0]&&(t+="/"),e=t+e),n){var r=i(n);if(!r)throw new Error("sourceMapURL could not be parsed");if(r.path){var l=r.path.lastIndexOf("/");l>=0&&(r.path=r.path.substring(0,l+1))}e=a(o(r),e)}return s(e)}},184:(t,e,n)=>{n(0).x,e.SourceMapConsumer=n(961).SourceMapConsumer,n(788)},355:t=>{t.exports=(t,e)=>{const n=t||[],r=[];let i={label:void 0,items:[n.first]};return n.forEach((t=>{const n=e(t);i.label!==n&&i.items.length?r.push(i={label:n,items:[t]}):i.items.push(t)})),r}},678:(t,e,n)=>{t=n.nmd(t);const r=Object,i="undefined"!=typeof window&&window.window===window&&window.navigator,o=i?null:t.require,s=t=>t[t.length-1],a=n(352),l=n(355),u=n(611),c=t=>t.replace(/\\/g,"/"),h=i?window.location.href:c(process.cwd())+"/";class f{constructor(t,e){const n=t,r=t&&t instanceof SyntaxError&&!i;if(t||(t=new Error,e=void 0===e?1:e),t instanceof Error&&(t=t.stack||""),"string"==typeof t&&(t=this.rawParse(t).slice(e).map((t=>this.extractEntryMetadata(t)))),Array.isArray(t)){if(r){const e=o("util").inspect(n).split("\n"),r=e[0].split(":"),i=r.pop(),s=r.join(":");s&&t.unshift({file:c(s),line:i,column:(e[2]||"").indexOf("^")+1,sourceLine:e[1],callee:"(syntax error)",syntaxError:!0})}this.items=t}else this.items=[]}extractEntryMetadata(t){const e=this.decomposePath(t.file||""),n=e[0],i=e[1];return r.assign(t,{calleeShort:t.calleeShort||s((t.callee||"").split(".")),fileRelative:n,fileShort:this.shortenPath(n),fileName:s((t.file||"").split("/")),thirdParty:this.isThirdParty(n,i)&&!t.index,externalDomain:i})}shortenPath(t){return t.replace(/^node_modules\//,"").replace(/^webpack\/bootstrap\//,"").replace(/^__parcel_source_root\//,"")}decomposePath(t){let e=t;i&&(e=e.replace(h,""));const n=e.match(/^(http|https)\:\/\/?([^\/]+)\/(.*)/),r=n?n[2]:void 0;return e=n?n[3]:e,i||(e=o("path").relative(h,e)),[c(e).replace(/^.*\:\/\/?\/?/,""),r]}isThirdParty(t,e){return e||"~"===t[0]||"/"===t[0]||0===t.indexOf("node_modules")||0===t.indexOf("webpack/bootstrap")}rawParse(t){return(t||"").split("\n").map((t=>{let e,n,r,o,s=[];if((r=(t=t.trim()).match(/at (.+) \(eval at .+ \((.+)\), .+\)/))||(r=t.match(/at (.+) \((.+)\)/))||"at "!==t.slice(0,3)&&(r=t.match(/(.*)@(.*)/)))e=r[1],n="native"===r[2],s=(r[2].match(/(.*):(\d+):(\d+)/)||r[2].match(/(.*):(\d+)/)||[]).slice(1);else{if(!(o=t.match(/^(at\s+)*(.+):(\d+):(\d+)/)))return;s=o.slice(2)}return e&&!s[0]&&"Array"===e.split(".")[0]&&(n=!0),{beforeParse:t,callee:e||"",index:i&&s[0]===window.location.href,native:n||!1,file:c(s[0]||""),line:parseInt(s[1]||"",10)||void 0,column:parseInt(s[2]||"",10)||void 0}})).filter((t=>void 0!==t))}withSourceAt(t){return this.items[t]&&this.withSource(this.items[t])}withSourceAsyncAt(t){return this.items[t]&&this.withSourceAsync(this.items[t])}withSource(t){if(this.shouldSkipResolving(t))return t;{let e=a(t.file||"").resolve(t);return e.sourceFile?this.withSourceResolved(t,e):t}}withSourceAsync(t){return this.shouldSkipResolving(t)?Promise.resolve(t):a.async(t.file||"").then((e=>e.resolve(t))).then((e=>this.withSourceResolved(t,e))).catch((e=>this.withSourceResolved(t,{error:e,sourceLine:""})))}shouldSkipResolving(t){return t.sourceFile||t.error||t.file&&t.file.indexOf("<")>=0}withSourceResolved(t,e){return e.sourceFile&&!e.sourceFile.error&&(e.file=c(e.sourceFile.path),e=this.extractEntryMetadata(e)),e.sourceLine.includes("// @hide")&&(e.sourceLine=e.sourceLine.replace("// @hide",""),e.hide=!0),(e.sourceLine.includes("__webpack_require__")||e.sourceLine.includes("/******/ ({"))&&(e.thirdParty=!0),r.assign({sourceLine:""},t,e)}withSources(){return this.map((t=>this.withSource(t)))}withSourcesAsync(){return Promise.all(this.items.map((t=>this.withSourceAsync(t)))).then((t=>new f(t)))}mergeRepeatedLines(){return new f(l(this.items,(t=>t.file+t.line)).map((t=>t.items.slice(1).reduce(((t,e)=>(t.callee=(t.callee||"<anonymous>")+" â†’ "+(e.callee||"<anonymous>"),t.calleeShort=(t.calleeShort||"<anonymous>")+" â†’ "+(e.calleeShort||"<anonymous>"),t)),r.assign({},t.items[0])))))}clean(){const t=this.withSources().mergeRepeatedLines();return t.filter(t.isClean.bind(t))}cleanAsync(){return this.withSourcesAsync().then((t=>(t=t.mergeRepeatedLines()).filter(t.isClean.bind(t))))}isClean(t,e){return 0===e||!(t.thirdParty||t.hide||t.native)}at(t){return r.assign({beforeParse:"",callee:"<???>",index:!1,native:!1,file:"<???>",line:0,column:0},this.items[t])}asTable(t){const e=t&&t.maxColumnWidths||this.maxColumnWidths(),n=(t,e)=>t&&(t.length>e?t.slice(0,e-1)+"â€¦":t),r=this.map((t=>{return["at "+n(t.calleeShort,e.callee),(r=t.fileShort&&t.fileShort+":"+t.line||"",i=e.file,r&&(r.length>i?"â€¦"+r.slice(-(i-1)):r)),n((t.sourceLine||"").trim()||"",e.sourceLine)];var r,i}));return u(r.items)}maxColumnWidths(){return{callee:30,file:60,sourceLine:80}}static resetCache(){a.resetCache(),a.async.resetCache()}static locationsEqual(t,e){return t.file===e.file&&t.line===e.line&&t.column===e.column}}["map","filter","slice","concat"].forEach((t=>{f.prototype[t]=function(){return new f(this.items[t].apply(this.items,arguments))}})),t.exports=f},275:(t,e,n)=>{n.d(e,{A:()=>a});var r=n(486),i=n.n(r),o=n(943),s=n.n(o)()(i());s.push([t.id,'/*\n! tailwindcss v3.4.3 | MIT License | https://tailwindcss.com\n*//*\n1. Prevent padding and border from affecting element width. (https://github.com/mozdevs/cssremedy/issues/4)\n2. Allow adding a border to an element by just adding a border-width. (https://github.com/tailwindcss/tailwindcss/pull/116)\n*/\n\n*,\n::before,\n::after {\n  box-sizing: border-box; /* 1 */\n  border-width: 0; /* 2 */\n  border-style: solid; /* 2 */\n  border-color: #e5e7eb; /* 2 */\n}\n\n::before,\n::after {\n  --tw-content: \'\';\n}\n\n/*\n1. Use a consistent sensible line-height in all browsers.\n2. Prevent adjustments of font size after orientation changes in iOS.\n3. Use a more readable tab size.\n4. Use the user\'s configured `sans` font-family by default.\n5. Use the user\'s configured `sans` font-feature-settings by default.\n6. Use the user\'s configured `sans` font-variation-settings by default.\n7. Disable tap highlights on iOS\n*/\n\nhtml,\n:host {\n  line-height: 1.5; /* 1 */\n  -webkit-text-size-adjust: 100%; /* 2 */\n  -moz-tab-size: 4; /* 3 */\n  -o-tab-size: 4;\n     tab-size: 4; /* 3 */\n  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"; /* 4 */\n  font-feature-settings: normal; /* 5 */\n  font-variation-settings: normal; /* 6 */\n  -webkit-tap-highlight-color: transparent; /* 7 */\n}\n\n/*\n1. Remove the margin in all browsers.\n2. Inherit line-height from `html` so users can set them as a class directly on the `html` element.\n*/\n\nbody {\n  margin: 0; /* 1 */\n  line-height: inherit; /* 2 */\n}\n\n/*\n1. Add the correct height in Firefox.\n2. Correct the inheritance of border color in Firefox. (https://bugzilla.mozilla.org/show_bug.cgi?id=190655)\n3. Ensure horizontal rules are visible by default.\n*/\n\nhr {\n  height: 0; /* 1 */\n  color: inherit; /* 2 */\n  border-top-width: 1px; /* 3 */\n}\n\n/*\nAdd the correct text decoration in Chrome, Edge, and Safari.\n*/\n\nabbr:where([title]) {\n  text-decoration: underline;\n  -webkit-text-decoration: underline dotted;\n          text-decoration: underline dotted;\n}\n\n/*\nRemove the default font size and weight for headings.\n*/\n\nh1,\nh2,\nh3,\nh4,\nh5,\nh6 {\n  font-size: inherit;\n  font-weight: inherit;\n}\n\n/*\nReset links to optimize for opt-in styling instead of opt-out.\n*/\n\na {\n  color: inherit;\n  text-decoration: inherit;\n}\n\n/*\nAdd the correct font weight in Edge and Safari.\n*/\n\nb,\nstrong {\n  font-weight: bolder;\n}\n\n/*\n1. Use the user\'s configured `mono` font-family by default.\n2. Use the user\'s configured `mono` font-feature-settings by default.\n3. Use the user\'s configured `mono` font-variation-settings by default.\n4. Correct the odd `em` font sizing in all browsers.\n*/\n\ncode,\nkbd,\nsamp,\npre {\n  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; /* 1 */\n  font-feature-settings: normal; /* 2 */\n  font-variation-settings: normal; /* 3 */\n  font-size: 1em; /* 4 */\n}\n\n/*\nAdd the correct font size in all browsers.\n*/\n\nsmall {\n  font-size: 80%;\n}\n\n/*\nPrevent `sub` and `sup` elements from affecting the line height in all browsers.\n*/\n\nsub,\nsup {\n  font-size: 75%;\n  line-height: 0;\n  position: relative;\n  vertical-align: baseline;\n}\n\nsub {\n  bottom: -0.25em;\n}\n\nsup {\n  top: -0.5em;\n}\n\n/*\n1. Remove text indentation from table contents in Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=999088, https://bugs.webkit.org/show_bug.cgi?id=201297)\n2. Correct table border color inheritance in all Chrome and Safari. (https://bugs.chromium.org/p/chromium/issues/detail?id=935729, https://bugs.webkit.org/show_bug.cgi?id=195016)\n3. Remove gaps between table borders by default.\n*/\n\ntable {\n  text-indent: 0; /* 1 */\n  border-color: inherit; /* 2 */\n  border-collapse: collapse; /* 3 */\n}\n\n/*\n1. Change the font styles in all browsers.\n2. Remove the margin in Firefox and Safari.\n3. Remove default padding in all browsers.\n*/\n\nbutton,\ninput,\noptgroup,\nselect,\ntextarea {\n  font-family: inherit; /* 1 */\n  font-feature-settings: inherit; /* 1 */\n  font-variation-settings: inherit; /* 1 */\n  font-size: 100%; /* 1 */\n  font-weight: inherit; /* 1 */\n  line-height: inherit; /* 1 */\n  letter-spacing: inherit; /* 1 */\n  color: inherit; /* 1 */\n  margin: 0; /* 2 */\n  padding: 0; /* 3 */\n}\n\n/*\nRemove the inheritance of text transform in Edge and Firefox.\n*/\n\nbutton,\nselect {\n  text-transform: none;\n}\n\n/*\n1. Correct the inability to style clickable types in iOS and Safari.\n2. Remove default button styles.\n*/\n\nbutton,\ninput:where([type=\'button\']),\ninput:where([type=\'reset\']),\ninput:where([type=\'submit\']) {\n  -webkit-appearance: button; /* 1 */\n  background-color: transparent; /* 2 */\n  background-image: none; /* 2 */\n}\n\n/*\nUse the modern Firefox focus style for all focusable elements.\n*/\n\n:-moz-focusring {\n  outline: auto;\n}\n\n/*\nRemove the additional `:invalid` styles in Firefox. (https://github.com/mozilla/gecko-dev/blob/2f9eacd9d3d995c937b4251a5557d95d494c9be1/layout/style/res/forms.css#L728-L737)\n*/\n\n:-moz-ui-invalid {\n  box-shadow: none;\n}\n\n/*\nAdd the correct vertical alignment in Chrome and Firefox.\n*/\n\nprogress {\n  vertical-align: baseline;\n}\n\n/*\nCorrect the cursor style of increment and decrement buttons in Safari.\n*/\n\n::-webkit-inner-spin-button,\n::-webkit-outer-spin-button {\n  height: auto;\n}\n\n/*\n1. Correct the odd appearance in Chrome and Safari.\n2. Correct the outline style in Safari.\n*/\n\n[type=\'search\'] {\n  -webkit-appearance: textfield; /* 1 */\n  outline-offset: -2px; /* 2 */\n}\n\n/*\nRemove the inner padding in Chrome and Safari on macOS.\n*/\n\n::-webkit-search-decoration {\n  -webkit-appearance: none;\n}\n\n/*\n1. Correct the inability to style clickable types in iOS and Safari.\n2. Change font properties to `inherit` in Safari.\n*/\n\n::-webkit-file-upload-button {\n  -webkit-appearance: button; /* 1 */\n  font: inherit; /* 2 */\n}\n\n/*\nAdd the correct display in Chrome and Safari.\n*/\n\nsummary {\n  display: list-item;\n}\n\n/*\nRemoves the default spacing and border for appropriate elements.\n*/\n\nblockquote,\ndl,\ndd,\nh1,\nh2,\nh3,\nh4,\nh5,\nh6,\nhr,\nfigure,\np,\npre {\n  margin: 0;\n}\n\nfieldset {\n  margin: 0;\n  padding: 0;\n}\n\nlegend {\n  padding: 0;\n}\n\nol,\nul,\nmenu {\n  list-style: none;\n  margin: 0;\n  padding: 0;\n}\n\n/*\nReset default styling for dialogs.\n*/\ndialog {\n  padding: 0;\n}\n\n/*\nPrevent resizing textareas horizontally by default.\n*/\n\ntextarea {\n  resize: vertical;\n}\n\n/*\n1. Reset the default placeholder opacity in Firefox. (https://github.com/tailwindlabs/tailwindcss/issues/3300)\n2. Set the default placeholder color to the user\'s configured gray 400 color.\n*/\n\ninput::-moz-placeholder, textarea::-moz-placeholder {\n  opacity: 1; /* 1 */\n  color: #9ca3af; /* 2 */\n}\n\ninput::placeholder,\ntextarea::placeholder {\n  opacity: 1; /* 1 */\n  color: #9ca3af; /* 2 */\n}\n\n/*\nSet the default cursor for buttons.\n*/\n\nbutton,\n[role="button"] {\n  cursor: pointer;\n}\n\n/*\nMake sure disabled buttons don\'t get the pointer cursor.\n*/\n:disabled {\n  cursor: default;\n}\n\n/*\n1. Make replaced elements `display: block` by default. (https://github.com/mozdevs/cssremedy/issues/14)\n2. Add `vertical-align: middle` to align replaced elements more sensibly by default. (https://github.com/jensimmons/cssremedy/issues/14#issuecomment-634934210)\n   This can trigger a poorly considered lint error in some tools but is included by design.\n*/\n\nimg,\nsvg,\nvideo,\ncanvas,\naudio,\niframe,\nembed,\nobject {\n  display: block; /* 1 */\n  vertical-align: middle; /* 2 */\n}\n\n/*\nConstrain images and videos to the parent width and preserve their intrinsic aspect ratio. (https://github.com/mozdevs/cssremedy/issues/14)\n*/\n\nimg,\nvideo {\n  max-width: 100%;\n  height: auto;\n}\n\n/* Make elements with the HTML hidden attribute stay hidden by default */\n[hidden] {\n  display: none;\n}\n\n:root,\n[data-theme] {\n  background-color: var(--fallback-b1,oklch(var(--b1)/1));\n  color: var(--fallback-bc,oklch(var(--bc)/1));\n}\n\n@supports not (color: oklch(0% 0 0)) {\n\n  :root {\n    --csstools-color-scheme--dark:  ;\n    color-scheme: light;\n    --fallback-p: #491eff;\n    --fallback-pc: #d4dbff;\n    --fallback-s: #ff41c7;\n    --fallback-sc: #fff9fc;\n    --fallback-a: #00cfbd;\n    --fallback-ac: #00100d;\n    --fallback-n: #2b3440;\n    --fallback-nc: #d7dde4;\n    --fallback-b1: #ffffff;\n    --fallback-b2: #e5e6e6;\n    --fallback-b3: #e5e6e6;\n    --fallback-bc: #1f2937;\n    --fallback-in: #00b3f0;\n    --fallback-inc: #000000;\n    --fallback-su: #00ca92;\n    --fallback-suc: #000000;\n    --fallback-wa: #ffc22d;\n    --fallback-wac: #000000;\n    --fallback-er: #ff6f70;\n    --fallback-erc: #000000;\n  }\n\n  @media (prefers-color-scheme: dark) {\n\n    :root {\n      --csstools-color-scheme--dark: initial;\n      color-scheme: dark;\n      --fallback-p: #7582ff;\n      --fallback-pc: #050617;\n      --fallback-s: #ff71cf;\n      --fallback-sc: #190211;\n      --fallback-a: #00c7b5;\n      --fallback-ac: #000e0c;\n      --fallback-n: #2a323c;\n      --fallback-nc: #a6adbb;\n      --fallback-b1: #1d232a;\n      --fallback-b2: #191e24;\n      --fallback-b3: #15191e;\n      --fallback-bc: #a6adbb;\n      --fallback-in: #00b3f0;\n      --fallback-inc: #000000;\n      --fallback-su: #00ca92;\n      --fallback-suc: #000000;\n      --fallback-wa: #ffc22d;\n      --fallback-wac: #000000;\n      --fallback-er: #ff6f70;\n      --fallback-erc: #000000;\n    }\n  }\n}\n\nhtml {\n  -webkit-tap-highlight-color: transparent;\n}\n\n:root {\n  --csstools-color-scheme--dark:  ;\n  color-scheme: light;\n  --in: 72.06% 0.191 231.6;\n  --su: 64.8% 0.150 160;\n  --wa: 84.71% 0.199 83.87;\n  --er: 71.76% 0.221 22.18;\n  --pc: 89.824% 0.06192 275.75;\n  --ac: 15.352% 0.0368 183.61;\n  --inc: 0% 0 0;\n  --suc: 0% 0 0;\n  --wac: 0% 0 0;\n  --erc: 0% 0 0;\n  --rounded-box: 1rem;\n  --rounded-btn: 0.5rem;\n  --rounded-badge: 1.9rem;\n  --animation-btn: 0.25s;\n  --animation-input: .2s;\n  --btn-focus-scale: 0.95;\n  --border-btn: 1px;\n  --tab-border: 1px;\n  --tab-radius: 0.5rem;\n  --p: 49.12% 0.3096 275.75;\n  --s: 69.71% 0.329 342.55;\n  --sc: 98.71% 0.0106 342.55;\n  --a: 76.76% 0.184 183.61;\n  --n: 32.1785% 0.02476 255.701624;\n  --nc: 89.4994% 0.011585 252.096176;\n  --b1: 100% 0 0;\n  --b2: 96.1151% 0 0;\n  --b3: 92.4169% 0.00108 197.137559;\n  --bc: 27.8078% 0.029596 256.847952;\n}\n\n@media (prefers-color-scheme: dark) {\n\n  :root {\n    --csstools-color-scheme--dark: initial;\n    color-scheme: dark;\n    --in: 72.06% 0.191 231.6;\n    --su: 64.8% 0.150 160;\n    --wa: 84.71% 0.199 83.87;\n    --er: 71.76% 0.221 22.18;\n    --pc: 13.138% 0.0392 275.75;\n    --sc: 14.96% 0.052 342.55;\n    --ac: 14.902% 0.0334 183.61;\n    --inc: 0% 0 0;\n    --suc: 0% 0 0;\n    --wac: 0% 0 0;\n    --erc: 0% 0 0;\n    --rounded-box: 1rem;\n    --rounded-btn: 0.5rem;\n    --rounded-badge: 1.9rem;\n    --animation-btn: 0.25s;\n    --animation-input: .2s;\n    --btn-focus-scale: 0.95;\n    --border-btn: 1px;\n    --tab-border: 1px;\n    --tab-radius: 0.5rem;\n    --p: 65.69% 0.196 275.75;\n    --s: 74.8% 0.26 342.55;\n    --a: 74.51% 0.167 183.61;\n    --n: 31.3815% 0.021108 254.139175;\n    --nc: 74.6477% 0.0216 264.435964;\n    --b1: 25.3267% 0.015896 252.417568;\n    --b2: 23.2607% 0.013807 253.100675;\n    --b3: 21.1484% 0.01165 254.087939;\n    --bc: 74.6477% 0.0216 264.435964;\n  }\n}\n\n[data-theme=light] {\n  --csstools-color-scheme--dark:  ;\n  color-scheme: light;\n  --in: 72.06% 0.191 231.6;\n  --su: 64.8% 0.150 160;\n  --wa: 84.71% 0.199 83.87;\n  --er: 71.76% 0.221 22.18;\n  --pc: 89.824% 0.06192 275.75;\n  --ac: 15.352% 0.0368 183.61;\n  --inc: 0% 0 0;\n  --suc: 0% 0 0;\n  --wac: 0% 0 0;\n  --erc: 0% 0 0;\n  --rounded-box: 1rem;\n  --rounded-btn: 0.5rem;\n  --rounded-badge: 1.9rem;\n  --animation-btn: 0.25s;\n  --animation-input: .2s;\n  --btn-focus-scale: 0.95;\n  --border-btn: 1px;\n  --tab-border: 1px;\n  --tab-radius: 0.5rem;\n  --p: 49.12% 0.3096 275.75;\n  --s: 69.71% 0.329 342.55;\n  --sc: 98.71% 0.0106 342.55;\n  --a: 76.76% 0.184 183.61;\n  --n: 32.1785% 0.02476 255.701624;\n  --nc: 89.4994% 0.011585 252.096176;\n  --b1: 100% 0 0;\n  --b2: 96.1151% 0 0;\n  --b3: 92.4169% 0.00108 197.137559;\n  --bc: 27.8078% 0.029596 256.847952;\n}\n\n[data-theme=dark] {\n  --csstools-color-scheme--dark: initial;\n  color-scheme: dark;\n  --in: 72.06% 0.191 231.6;\n  --su: 64.8% 0.150 160;\n  --wa: 84.71% 0.199 83.87;\n  --er: 71.76% 0.221 22.18;\n  --pc: 13.138% 0.0392 275.75;\n  --sc: 14.96% 0.052 342.55;\n  --ac: 14.902% 0.0334 183.61;\n  --inc: 0% 0 0;\n  --suc: 0% 0 0;\n  --wac: 0% 0 0;\n  --erc: 0% 0 0;\n  --rounded-box: 1rem;\n  --rounded-btn: 0.5rem;\n  --rounded-badge: 1.9rem;\n  --animation-btn: 0.25s;\n  --animation-input: .2s;\n  --btn-focus-scale: 0.95;\n  --border-btn: 1px;\n  --tab-border: 1px;\n  --tab-radius: 0.5rem;\n  --p: 65.69% 0.196 275.75;\n  --s: 74.8% 0.26 342.55;\n  --a: 74.51% 0.167 183.61;\n  --n: 31.3815% 0.021108 254.139175;\n  --nc: 74.6477% 0.0216 264.435964;\n  --b1: 25.3267% 0.015896 252.417568;\n  --b2: 23.2607% 0.013807 253.100675;\n  --b3: 21.1484% 0.01165 254.087939;\n  --bc: 74.6477% 0.0216 264.435964;\n}\n\n*, ::before, ::after {\n  --tw-border-spacing-x: 0;\n  --tw-border-spacing-y: 0;\n  --tw-translate-x: 0;\n  --tw-translate-y: 0;\n  --tw-rotate: 0;\n  --tw-skew-x: 0;\n  --tw-skew-y: 0;\n  --tw-scale-x: 1;\n  --tw-scale-y: 1;\n  --tw-pan-x:  ;\n  --tw-pan-y:  ;\n  --tw-pinch-zoom:  ;\n  --tw-scroll-snap-strictness: proximity;\n  --tw-gradient-from-position:  ;\n  --tw-gradient-via-position:  ;\n  --tw-gradient-to-position:  ;\n  --tw-ordinal:  ;\n  --tw-slashed-zero:  ;\n  --tw-numeric-figure:  ;\n  --tw-numeric-spacing:  ;\n  --tw-numeric-fraction:  ;\n  --tw-ring-inset:  ;\n  --tw-ring-offset-width: 0px;\n  --tw-ring-offset-color: #fff;\n  --tw-ring-color: rgba(59, 130, 246, 0.5);\n  --tw-ring-offset-shadow: 0 0 rgba(0,0,0,0);\n  --tw-ring-shadow: 0 0 rgba(0,0,0,0);\n  --tw-shadow: 0 0 rgba(0,0,0,0);\n  --tw-shadow-colored: 0 0 rgba(0,0,0,0);\n  --tw-blur:  ;\n  --tw-brightness:  ;\n  --tw-contrast:  ;\n  --tw-grayscale:  ;\n  --tw-hue-rotate:  ;\n  --tw-invert:  ;\n  --tw-saturate:  ;\n  --tw-sepia:  ;\n  --tw-drop-shadow:  ;\n  --tw-backdrop-blur:  ;\n  --tw-backdrop-brightness:  ;\n  --tw-backdrop-contrast:  ;\n  --tw-backdrop-grayscale:  ;\n  --tw-backdrop-hue-rotate:  ;\n  --tw-backdrop-invert:  ;\n  --tw-backdrop-opacity:  ;\n  --tw-backdrop-saturate:  ;\n  --tw-backdrop-sepia:  ;\n  --tw-contain-size:  ;\n  --tw-contain-layout:  ;\n  --tw-contain-paint:  ;\n  --tw-contain-style:  ;\n}\n\n::backdrop {\n  --tw-border-spacing-x: 0;\n  --tw-border-spacing-y: 0;\n  --tw-translate-x: 0;\n  --tw-translate-y: 0;\n  --tw-rotate: 0;\n  --tw-skew-x: 0;\n  --tw-skew-y: 0;\n  --tw-scale-x: 1;\n  --tw-scale-y: 1;\n  --tw-pan-x:  ;\n  --tw-pan-y:  ;\n  --tw-pinch-zoom:  ;\n  --tw-scroll-snap-strictness: proximity;\n  --tw-gradient-from-position:  ;\n  --tw-gradient-via-position:  ;\n  --tw-gradient-to-position:  ;\n  --tw-ordinal:  ;\n  --tw-slashed-zero:  ;\n  --tw-numeric-figure:  ;\n  --tw-numeric-spacing:  ;\n  --tw-numeric-fraction:  ;\n  --tw-ring-inset:  ;\n  --tw-ring-offset-width: 0px;\n  --tw-ring-offset-color: #fff;\n  --tw-ring-color: rgba(59, 130, 246, 0.5);\n  --tw-ring-offset-shadow: 0 0 rgba(0,0,0,0);\n  --tw-ring-shadow: 0 0 rgba(0,0,0,0);\n  --tw-shadow: 0 0 rgba(0,0,0,0);\n  --tw-shadow-colored: 0 0 rgba(0,0,0,0);\n  --tw-blur:  ;\n  --tw-brightness:  ;\n  --tw-contrast:  ;\n  --tw-grayscale:  ;\n  --tw-hue-rotate:  ;\n  --tw-invert:  ;\n  --tw-saturate:  ;\n  --tw-sepia:  ;\n  --tw-drop-shadow:  ;\n  --tw-backdrop-blur:  ;\n  --tw-backdrop-brightness:  ;\n  --tw-backdrop-contrast:  ;\n  --tw-backdrop-grayscale:  ;\n  --tw-backdrop-hue-rotate:  ;\n  --tw-backdrop-invert:  ;\n  --tw-backdrop-opacity:  ;\n  --tw-backdrop-saturate:  ;\n  --tw-backdrop-sepia:  ;\n  --tw-contain-size:  ;\n  --tw-contain-layout:  ;\n  --tw-contain-paint:  ;\n  --tw-contain-style:  ;\n}\n.container {\n  width: 100%;\n}\n@media (min-width: 640px) {\n\n  .container {\n    max-width: 640px;\n  }\n}\n@media (min-width: 768px) {\n\n  .container {\n    max-width: 768px;\n  }\n}\n@media (min-width: 1024px) {\n\n  .container {\n    max-width: 1024px;\n  }\n}\n@media (min-width: 1280px) {\n\n  .container {\n    max-width: 1280px;\n  }\n}\n@media (min-width: 1536px) {\n\n  .container {\n    max-width: 1536px;\n  }\n}\n.avatar.placeholder > div {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n@media (hover:hover) {\n\n  .label a:hover {\n    --tw-text-opacity: 1;\n    color: var(--fallback-bc,oklch(var(--bc)/1));\n    color: var(--fallback-bc,oklch(var(--bc)/var(--tw-text-opacity)));\n  }\n\n  .menu li > *:not(ul):not(.menu-title):not(details):not(.btn):active,\n.menu li > *:not(ul):not(.menu-title):not(details):not(.btn).active,\n.menu li > details > summary:active {\n    --tw-bg-opacity: 1;\n    background-color: var(--fallback-n,oklch(var(--n)/1));\n    background-color: var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));\n    --tw-text-opacity: 1;\n    color: var(--fallback-nc,oklch(var(--nc)/1));\n    color: var(--fallback-nc,oklch(var(--nc)/var(--tw-text-opacity)));\n  }\n\n  .table tr.hover:hover,\n  .table tr.hover:nth-child(even):hover {\n    --tw-bg-opacity: 1;\n    background-color: var(--fallback-b2,oklch(var(--b2)/1));\n    background-color: var(--fallback-b2,oklch(var(--b2)/var(--tw-bg-opacity)));\n  }\n}\n.btn {\n  display: inline-flex;\n  height: 3rem;\n  min-height: 3rem;\n  flex-shrink: 0;\n  cursor: pointer;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n          user-select: none;\n  flex-wrap: wrap;\n  align-items: center;\n  justify-content: center;\n  border-radius: 0.5rem;\n  border-radius: var(--rounded-btn, 0.5rem);\n  border-color: transparent;\n  border-color: oklch(var(--btn-color, var(--b2)) / 1);\n  border-color: oklch(var(--btn-color, var(--b2)) / var(--tw-border-opacity));\n  padding-left: 1rem;\n  padding-right: 1rem;\n  text-align: center;\n  font-size: 0.875rem;\n  line-height: 1em;\n  gap: 0.5rem;\n  font-weight: 600;\n  text-decoration-line: none;\n  transition-duration: 200ms;\n  transition-timing-function: cubic-bezier(0, 0, 0.2, 1);\n  border-width: 1px;\n  border-width: var(--border-btn, 1px);\n  transition-property: color, background-color, border-color, opacity, box-shadow, transform;\n  --tw-text-opacity: 1;\n  color: var(--fallback-bc,oklch(var(--bc)/1));\n  color: var(--fallback-bc,oklch(var(--bc)/var(--tw-text-opacity)));\n  --tw-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);\n  --tw-shadow-colored: 0 1px 2px 0 var(--tw-shadow-color);\n  box-shadow: 0 0 rgba(0,0,0,0), 0 0 rgba(0,0,0,0), 0 1px 2px 0 rgba(0, 0, 0, 0.05);\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 rgba(0,0,0,0)), var(--tw-ring-shadow, 0 0 rgba(0,0,0,0)), var(--tw-shadow);\n  outline-color: var(--fallback-bc,oklch(var(--bc)/1));\n  background-color: oklch(var(--btn-color, var(--b2)) / 1);\n  background-color: oklch(var(--btn-color, var(--b2)) / var(--tw-bg-opacity));\n  --tw-bg-opacity: 1;\n  --tw-border-opacity: 1;\n}\n.btn-disabled,\n  .btn[disabled],\n  .btn:disabled {\n  pointer-events: none;\n}\n.btn-square {\n  height: 3rem;\n  width: 3rem;\n  padding: 0px;\n}\n:where(input.btn[type="checkbox"]) {\n  width: auto;\n  -webkit-appearance: none;\n     -moz-appearance: none;\n          appearance: none;\n}\n:where(input.btn[type="radio"]) {\n  width: auto;\n  -webkit-appearance: none;\n     -moz-appearance: none;\n          appearance: none;\n}\ninput.btn[type="checkbox"]:after {\n  --tw-content: attr(aria-label);\n  content: attr(aria-label);\n  content: var(--tw-content);\n}\ninput.btn[type="radio"]:after {\n  --tw-content: attr(aria-label);\n  content: attr(aria-label);\n  content: var(--tw-content);\n}\n.checkbox {\n  flex-shrink: 0;\n  --chkbg: var(--fallback-bc,oklch(var(--bc)/1));\n  --chkfg: var(--fallback-b1,oklch(var(--b1)/1));\n  height: 1.5rem;\n  width: 1.5rem;\n  cursor: pointer;\n  -webkit-appearance: none;\n     -moz-appearance: none;\n          appearance: none;\n  border-radius: 0.5rem;\n  border-radius: var(--rounded-btn, 0.5rem);\n  border-width: 1px;\n  border-color: var(--fallback-bc,oklch(var(--bc)/0.2));\n  border-color: var(--fallback-bc,oklch(var(--bc)/var(--tw-border-opacity)));\n  --tw-border-opacity: 0.2;\n}\n.drawer {\n  position: relative;\n  display: grid;\n  grid-auto-columns: max-content auto;\n  width: 100%;\n}\n.drawer-content {\n  grid-column-start: 2;\n  grid-row-start: 1;\n  min-width: 0px;\n}\n.drawer-side {\n  pointer-events: none;\n  position: fixed;\n  left: 0px;\n  top: 0px;\n  grid-column-start: 1;\n  grid-row-start: 1;\n  display: grid;\n  width: 100%;\n  grid-template-columns: repeat(1, minmax(0, 1fr));\n  grid-template-rows: repeat(1, minmax(0, 1fr));\n  align-items: flex-start;\n  justify-items: start;\n  overflow-x: hidden;\n  overflow-y: hidden;\n  overscroll-behavior: contain;\n  height: 100vh;\n  height: 100dvh;\n}\n.drawer-side > .drawer-overlay {\n  position: sticky;\n  top: 0px;\n  align-self: stretch;\n  justify-self: stretch;\n  place-self: stretch;\n  cursor: pointer;\n  background-color: transparent;\n  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-timing-function: cubic-bezier(0, 0, 0.2, 1);\n  transition-duration: 200ms;\n}\n.drawer-side > * {\n  grid-column-start: 1;\n  grid-row-start: 1;\n}\n.drawer-side > *:not(.drawer-overlay) {\n  transition-property: transform;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-timing-function: cubic-bezier(0, 0, 0.2, 1);\n  transition-duration: 300ms;\n  will-change: transform;\n  transform: translateX(-100%);\n}\n[dir="rtl"] .drawer-side > *:not(.drawer-overlay) {\n  transform: translateX(100%);\n}\n.drawer-toggle {\n  position: fixed;\n  height: 0px;\n  width: 0px;\n  -webkit-appearance: none;\n     -moz-appearance: none;\n          appearance: none;\n  opacity: 0;\n}\n.drawer-toggle:checked ~ .drawer-side {\n  pointer-events: auto;\n  visibility: visible;\n  overflow-y: auto;\n}\n.drawer-toggle:checked ~ .drawer-side > *:not(.drawer-overlay) {\n  transform: translateX(0%);\n}\n.drawer-end .drawer-toggle ~ .drawer-content {\n  grid-column-start: 1;\n}\n.drawer-end .drawer-toggle ~ .drawer-side {\n  grid-column-start: 2;\n  justify-items: end;\n}\n.drawer-end .drawer-toggle ~ .drawer-side > *:not(.drawer-overlay) {\n  transform: translateX(100%);\n}\n[dir="rtl"] .drawer-end .drawer-toggle ~ .drawer-side > *:not(.drawer-overlay) {\n  transform: translateX(-100%);\n}\n.drawer-end .drawer-toggle:checked ~ .drawer-side > *:not(.drawer-overlay) {\n  transform: translateX(0%);\n}\n@media (hover: hover) {\n\n  .btn:hover {\n    --tw-border-opacity: 1;\n    border-color: var(--fallback-b3,oklch(var(--b3)/1));\n    border-color: var(--fallback-b3,oklch(var(--b3)/var(--tw-border-opacity)));\n    --tw-bg-opacity: 1;\n    background-color: var(--fallback-b3,oklch(var(--b3)/1));\n    background-color: var(--fallback-b3,oklch(var(--b3)/var(--tw-bg-opacity)));\n  }\n\n  @supports (color: color-mix(in oklab, black, black)) {\n\n    .btn:hover {\n      background-color: color-mix(\n            in oklab,\n            oklch(var(--btn-color, var(--b2)) / 1) 90%,\n            black\n          );\n      border-color: color-mix(\n            in oklab,\n            oklch(var(--btn-color, var(--b2)) / 1) 90%,\n            black\n          );\n    }\n\n@supports (color: color-mix(in lch, red, blue)) {\n.btn:hover {\n        background-color: color-mix(\n            in oklab,\n            oklch(var(--btn-color, var(--b2)) / var(--tw-bg-opacity, 1)) 90%,\n            black\n          );\n        border-color: color-mix(\n            in oklab,\n            oklch(var(--btn-color, var(--b2)) / var(--tw-border-opacity, 1)) 90%,\n            black\n          );\n      }\n}\n  }\n\n  @supports not (color: oklch(0% 0 0)) {\n\n    .btn:hover {\n      background-color: var(--btn-color, var(--fallback-b2));\n      border-color: var(--btn-color, var(--fallback-b2));\n    }\n  }\n\n  .btn.glass:hover {\n    --glass-opacity: 25%;\n    --glass-border-opacity: 15%;\n  }\n\n  .btn-ghost:hover {\n    border-color: transparent;\n  }\n\n  @supports (color: oklch(0% 0 0)) {\n\n    .btn-ghost:hover {\n      background-color: var(--fallback-bc,oklch(var(--bc)/0.2));\n    }\n  }\n\n  .btn-outline.btn-info:hover {\n    --tw-text-opacity: 1;\n    color: var(--fallback-inc,oklch(var(--inc)/1));\n    color: var(--fallback-inc,oklch(var(--inc)/var(--tw-text-opacity)));\n  }\n\n  @supports (color: color-mix(in oklab, black, black)) {\n\n    .btn-outline.btn-info:hover {\n      background-color: color-mix(in oklab, var(--fallback-in,oklch(var(--in)/1)) 90%, black);\n      border-color: color-mix(in oklab, var(--fallback-in,oklch(var(--in)/1)) 90%, black);\n    }\n  }\n\n  .btn-disabled:hover,\n    .btn[disabled]:hover,\n    .btn:disabled:hover {\n    --tw-border-opacity: 0;\n    background-color: var(--fallback-n,oklch(var(--n)/0.2));\n    background-color: var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));\n    --tw-bg-opacity: 0.2;\n    color: var(--fallback-bc,oklch(var(--bc)/0.2));\n    color: var(--fallback-bc,oklch(var(--bc)/var(--tw-text-opacity)));\n    --tw-text-opacity: 0.2;\n  }\n\n  @supports (color: color-mix(in oklab, black, black)) {\n\n    input.btn[type="checkbox"]:checked:hover {\n      background-color: color-mix(in oklab, var(--fallback-p,oklch(var(--p)/1)) 90%, black);\n      border-color: color-mix(in oklab, var(--fallback-p,oklch(var(--p)/1)) 90%, black);\n    }\n\n    input.btn[type="radio"]:checked:hover {\n      background-color: color-mix(in oklab, var(--fallback-p,oklch(var(--p)/1)) 90%, black);\n      border-color: color-mix(in oklab, var(--fallback-p,oklch(var(--p)/1)) 90%, black);\n    }\n  }\n\n  :where(.menu li:not(.menu-title):not(.disabled) > *:not(ul):not(details):not(.menu-title)):not(.active):not(.btn):hover, :where(.menu li:not(.menu-title):not(.disabled) > details > summary:not(.menu-title)):not(.active):not(.btn):hover {\n    cursor: pointer;\n    outline: 2px solid transparent;\n    outline-offset: 2px;\n  }\n\n  @supports (color: oklch(0% 0 0)) {\n\n    :where(.menu li:not(.menu-title):not(.disabled) > *:not(ul):not(details):not(.menu-title)):not(.active):not(.btn):hover, :where(.menu li:not(.menu-title):not(.disabled) > details > summary:not(.menu-title)):not(.active):not(.btn):hover {\n      background-color: var(--fallback-bc,oklch(var(--bc)/0.1));\n    }\n  }\n}\n.form-control {\n  display: flex;\n  flex-direction: column;\n}\n.label {\n  display: flex;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n          user-select: none;\n  align-items: center;\n  justify-content: space-between;\n  padding-left: 0.25rem;\n  padding-right: 0.25rem;\n  padding-top: 0.5rem;\n  padding-bottom: 0.5rem;\n}\n.input {\n  flex-shrink: 1;\n  -webkit-appearance: none;\n     -moz-appearance: none;\n          appearance: none;\n  height: 3rem;\n  padding-left: 1rem;\n  padding-right: 1rem;\n  font-size: 1rem;\n  line-height: 2;\n  line-height: 1.5rem;\n  border-radius: 0.5rem;\n  border-radius: var(--rounded-btn, 0.5rem);\n  border-width: 1px;\n  border-color: transparent;\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-b1,oklch(var(--b1)/1));\n  background-color: var(--fallback-b1,oklch(var(--b1)/var(--tw-bg-opacity)));\n}\n.input[type="number"]::-webkit-inner-spin-button,\n.input-md[type="number"]::-webkit-inner-spin-button {\n  margin-top: -1rem;\n  margin-bottom: -1rem;\n  margin-right: -1rem;\n}\n.join {\n  display: inline-flex;\n  align-items: stretch;\n  border-radius: 0.5rem;\n  border-radius: var(--rounded-btn, 0.5rem);\n}\n.join :where(.join-item) {\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n  border-bottom-left-radius: 0;\n  border-top-left-radius: 0;\n}\n.join .join-item:not(:first-child):not(:last-child),\n  .join *:not(:first-child):not(:last-child) .join-item {\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n  border-bottom-left-radius: 0;\n  border-top-left-radius: 0;\n}\n.join .join-item:first-child:not(:last-child),\n  .join *:first-child:not(:last-child) .join-item {\n  border-top-right-radius: 0;\n  border-bottom-right-radius: 0;\n}\n.join .dropdown .join-item:first-child:not(:last-child),\n  .join *:first-child:not(:last-child) .dropdown .join-item {\n  border-top-right-radius: inherit;\n  border-bottom-right-radius: inherit;\n}\n.join :where(.join-item:first-child:not(:last-child)),\n  .join :where(*:first-child:not(:last-child) .join-item) {\n  border-bottom-left-radius: inherit;\n  border-top-left-radius: inherit;\n}\n.join .join-item:last-child:not(:first-child),\n  .join *:last-child:not(:first-child) .join-item {\n  border-bottom-left-radius: 0;\n  border-top-left-radius: 0;\n}\n.join :where(.join-item:last-child:not(:first-child)),\n  .join :where(*:last-child:not(:first-child) .join-item) {\n  border-top-right-radius: inherit;\n  border-bottom-right-radius: inherit;\n}\n@supports not selector(:has(*)) {\n\n  :where(.join *) {\n    border-radius: inherit;\n  }\n}\n@supports selector(:has(*)) {\n\n  :where(.join *:has(.join-item)) {\n    border-radius: inherit;\n  }\n}\n.menu {\n  display: flex;\n  flex-direction: column;\n  flex-wrap: wrap;\n  font-size: 0.875rem;\n  line-height: 1.25rem;\n  padding: 0.5rem;\n}\n.menu :where(li ul) {\n  position: relative;\n  white-space: nowrap;\n  margin-left: 1rem;\n  padding-left: 0.5rem;\n}\n.menu :where(li:not(.menu-title) > *:not(ul):not(details):not(.menu-title):not(.btn)), .menu :where(li:not(.menu-title) > details > summary:not(.menu-title)) {\n  display: grid;\n  grid-auto-flow: column;\n  align-content: flex-start;\n  align-items: center;\n  grid-gap: 0.5rem;\n  gap: 0.5rem;\n  grid-auto-columns: minmax(auto, max-content) auto max-content;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n          user-select: none;\n}\n.menu li.disabled {\n  cursor: not-allowed;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n          user-select: none;\n  color: var(--fallback-bc,oklch(var(--bc)/0.3));\n}\n.menu :where(li > .menu-dropdown:not(.menu-dropdown-show)) {\n  display: none;\n}\n:where(.menu li) {\n  position: relative;\n  display: flex;\n  flex-shrink: 0;\n  flex-direction: column;\n  flex-wrap: wrap;\n  align-items: stretch;\n}\n:where(.menu li) .badge {\n  justify-self: end;\n}\n.navbar {\n  display: flex;\n  align-items: center;\n  padding: 0.5rem;\n  padding: var(--navbar-padding, 0.5rem);\n  min-height: 4rem;\n  width: 100%;\n}\n:where(.navbar > *:not(script):not(style)) {\n  display: inline-flex;\n  align-items: center;\n}\n.table {\n  position: relative;\n  width: 100%;\n  border-radius: 1rem;\n  border-radius: var(--rounded-box, 1rem);\n  text-align: left;\n  font-size: 0.875rem;\n  line-height: 1.25rem;\n}\n.table :where(.table-pin-rows thead tr) {\n  position: sticky;\n  top: 0px;\n  z-index: 1;\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-b1,oklch(var(--b1)/1));\n  background-color: var(--fallback-b1,oklch(var(--b1)/var(--tw-bg-opacity)));\n}\n.table :where(.table-pin-rows tfoot tr) {\n  position: sticky;\n  bottom: 0px;\n  z-index: 1;\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-b1,oklch(var(--b1)/1));\n  background-color: var(--fallback-b1,oklch(var(--b1)/var(--tw-bg-opacity)));\n}\n.table :where(.table-pin-cols tr th) {\n  position: sticky;\n  left: 0px;\n  right: 0px;\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-b1,oklch(var(--b1)/1));\n  background-color: var(--fallback-b1,oklch(var(--b1)/var(--tw-bg-opacity)));\n}\n.textarea {\n  min-height: 3rem;\n  flex-shrink: 1;\n  padding-left: 1rem;\n  padding-right: 1rem;\n  padding-top: 0.5rem;\n  padding-bottom: 0.5rem;\n  font-size: 0.875rem;\n  line-height: 1.25rem;\n  line-height: 2;\n  border-radius: 0.5rem;\n  border-radius: var(--rounded-btn, 0.5rem);\n  border-width: 1px;\n  border-color: transparent;\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-b1,oklch(var(--b1)/1));\n  background-color: var(--fallback-b1,oklch(var(--b1)/var(--tw-bg-opacity)));\n}\n.btm-nav > * .label {\n  font-size: 1rem;\n  line-height: 1.5rem;\n}\n@media (prefers-reduced-motion: no-preference) {\n\n  .btn {\n    animation: button-pop 0.25s ease-out;\n    animation: button-pop var(--animation-btn, 0.25s) ease-out;\n  }\n}\n.btn:active:hover,\n  .btn:active:focus {\n  animation: button-pop 0s ease-out;\n  transform: scale(0.97);\n  transform: scale(var(--btn-focus-scale, 0.97));\n}\n@supports not (color: oklch(0% 0 0)) {\n\n  .btn {\n    background-color: var(--btn-color, var(--fallback-b2));\n    border-color: var(--btn-color, var(--fallback-b2));\n  }\n\n  .btn-info {\n    --btn-color: var(--fallback-in);\n  }\n}\n@supports (color: color-mix(in oklab, black, black)) {\n\n  .btn-outline.btn-info.btn-active {\n    background-color: color-mix(in oklab, var(--fallback-in,oklch(var(--in)/1)) 90%, black);\n    border-color: color-mix(in oklab, var(--fallback-in,oklch(var(--in)/1)) 90%, black);\n  }\n}\n.btn:focus-visible {\n  outline-style: solid;\n  outline-width: 2px;\n  outline-offset: 2px;\n}\n@supports (color: oklch(0% 0 0)) {\n\n  .btn-info {\n    --btn-color: var(--in);\n  }\n}\n.btn-info {\n  --tw-text-opacity: 1;\n  color: var(--fallback-inc,oklch(var(--inc)/1));\n  color: var(--fallback-inc,oklch(var(--inc)/var(--tw-text-opacity)));\n  outline-color: var(--fallback-in,oklch(var(--in)/1));\n}\n.btn.glass {\n  --tw-shadow: 0 0 rgba(0,0,0,0);\n  --tw-shadow-colored: 0 0 rgba(0,0,0,0);\n  box-shadow: 0 0 rgba(0,0,0,0), 0 0 rgba(0,0,0,0), 0 0 rgba(0,0,0,0);\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 rgba(0,0,0,0)), var(--tw-ring-shadow, 0 0 rgba(0,0,0,0)), var(--tw-shadow);\n  outline-color: currentColor;\n}\n.btn.glass.btn-active {\n  --glass-opacity: 25%;\n  --glass-border-opacity: 15%;\n}\n.btn-ghost {\n  border-width: 1px;\n  border-color: transparent;\n  background-color: transparent;\n  color: currentColor;\n  --tw-shadow: 0 0 rgba(0,0,0,0);\n  --tw-shadow-colored: 0 0 rgba(0,0,0,0);\n  box-shadow: 0 0 rgba(0,0,0,0), 0 0 rgba(0,0,0,0), 0 0 rgba(0,0,0,0);\n  box-shadow: var(--tw-ring-offset-shadow, 0 0 rgba(0,0,0,0)), var(--tw-ring-shadow, 0 0 rgba(0,0,0,0)), var(--tw-shadow);\n  outline-color: currentColor;\n}\n.btn-ghost.btn-active {\n  border-color: transparent;\n  background-color: var(--fallback-bc,oklch(var(--bc)/0.2));\n}\n.btn-outline.btn-info {\n  --tw-text-opacity: 1;\n  color: var(--fallback-in,oklch(var(--in)/1));\n  color: var(--fallback-in,oklch(var(--in)/var(--tw-text-opacity)));\n}\n.btn-outline.btn-info.btn-active {\n  --tw-text-opacity: 1;\n  color: var(--fallback-inc,oklch(var(--inc)/1));\n  color: var(--fallback-inc,oklch(var(--inc)/var(--tw-text-opacity)));\n}\n.btn.btn-disabled,\n  .btn[disabled],\n  .btn:disabled {\n  --tw-border-opacity: 0;\n  background-color: var(--fallback-n,oklch(var(--n)/0.2));\n  background-color: var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));\n  --tw-bg-opacity: 0.2;\n  color: var(--fallback-bc,oklch(var(--bc)/0.2));\n  color: var(--fallback-bc,oklch(var(--bc)/var(--tw-text-opacity)));\n  --tw-text-opacity: 0.2;\n}\ninput.btn[type="checkbox"]:checked {\n  --tw-border-opacity: 1;\n  border-color: var(--fallback-p,oklch(var(--p)/1));\n  border-color: var(--fallback-p,oklch(var(--p)/var(--tw-border-opacity)));\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-p,oklch(var(--p)/1));\n  background-color: var(--fallback-p,oklch(var(--p)/var(--tw-bg-opacity)));\n  --tw-text-opacity: 1;\n  color: var(--fallback-pc,oklch(var(--pc)/1));\n  color: var(--fallback-pc,oklch(var(--pc)/var(--tw-text-opacity)));\n}\ninput.btn[type="radio"]:checked {\n  --tw-border-opacity: 1;\n  border-color: var(--fallback-p,oklch(var(--p)/1));\n  border-color: var(--fallback-p,oklch(var(--p)/var(--tw-border-opacity)));\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-p,oklch(var(--p)/1));\n  background-color: var(--fallback-p,oklch(var(--p)/var(--tw-bg-opacity)));\n  --tw-text-opacity: 1;\n  color: var(--fallback-pc,oklch(var(--pc)/1));\n  color: var(--fallback-pc,oklch(var(--pc)/var(--tw-text-opacity)));\n}\ninput.btn[type="checkbox"]:checked:focus-visible {\n  outline-color: var(--fallback-p,oklch(var(--p)/1));\n}\ninput.btn[type="radio"]:checked:focus-visible {\n  outline-color: var(--fallback-p,oklch(var(--p)/1));\n}\n@keyframes button-pop {\n\n  0% {\n    transform: scale(0.98);\n    transform: scale(var(--btn-focus-scale, 0.98));\n  }\n\n  40% {\n    transform: scale(1.02);\n  }\n\n  100% {\n    transform: scale(1);\n  }\n}\n.checkbox:focus {\n  box-shadow: none;\n}\n.checkbox:focus-visible {\n  outline-style: solid;\n  outline-width: 2px;\n  outline-offset: 2px;\n  outline-color: var(--fallback-bc,oklch(var(--bc)/1));\n}\n.checkbox:disabled {\n  border-width: 0px;\n  cursor: not-allowed;\n  border-color: transparent;\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-bc,oklch(var(--bc)/1));\n  background-color: var(--fallback-bc,oklch(var(--bc)/var(--tw-bg-opacity)));\n  opacity: 0.2;\n}\n.checkbox:checked,\n  .checkbox[aria-checked="true"] {\n  background-repeat: no-repeat;\n  animation: checkmark 0.2s ease-out;\n  animation: checkmark var(--animation-input, 0.2s) ease-out;\n  background-color: var(--chkbg);\n  background-image: linear-gradient(-45deg, transparent 65%, var(--chkbg) 65.99%),\n      linear-gradient(45deg, transparent 75%, var(--chkbg) 75.99%),\n      linear-gradient(-45deg, var(--chkbg) 40%, transparent 40.99%),\n      linear-gradient(\n        45deg,\n        var(--chkbg) 30%,\n        var(--chkfg) 30.99%,\n        var(--chkfg) 40%,\n        transparent 40.99%\n      ),\n      linear-gradient(-45deg, var(--chkfg) 50%, var(--chkbg) 50.99%);\n}\n.checkbox:indeterminate {\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-bc,oklch(var(--bc)/1));\n  background-color: var(--fallback-bc,oklch(var(--bc)/var(--tw-bg-opacity)));\n  background-repeat: no-repeat;\n  animation: checkmark 0.2s ease-out;\n  animation: checkmark var(--animation-input, 0.2s) ease-out;\n  background-image: linear-gradient(90deg, transparent 80%, var(--chkbg) 80%),\n      linear-gradient(-90deg, transparent 80%, var(--chkbg) 80%),\n      linear-gradient(0deg, var(--chkbg) 43%, var(--chkfg) 43%, var(--chkfg) 57%, var(--chkbg) 57%);\n}\n@keyframes checkmark {\n\n  0% {\n    background-position-y: 5px;\n  }\n\n  50% {\n    background-position-y: -2px;\n  }\n\n  100% {\n    background-position-y: 0;\n  }\n}\n.drawer-toggle:checked ~ .drawer-side > .drawer-overlay {\n  background-color: rgba(0,0,0,0.4);\n}\n.drawer-toggle:focus-visible ~ .drawer-content label.drawer-button {\n  outline-style: solid;\n  outline-width: 2px;\n  outline-offset: 2px;\n}\n.label-text {\n  font-size: 0.875rem;\n  line-height: 1.25rem;\n  --tw-text-opacity: 1;\n  color: var(--fallback-bc,oklch(var(--bc)/1));\n  color: var(--fallback-bc,oklch(var(--bc)/var(--tw-text-opacity)));\n}\n.input input {\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-p,oklch(var(--p)/1));\n  background-color: var(--fallback-p,oklch(var(--p)/var(--tw-bg-opacity)));\n  background-color: transparent;\n}\n.input input:focus {\n  outline: 2px solid transparent;\n  outline-offset: 2px;\n}\n.input[list]::-webkit-calendar-picker-indicator {\n  line-height: 1em;\n}\n.input-bordered {\n  border-color: var(--fallback-bc,oklch(var(--bc)/0.2));\n}\n.input:focus,\n  .input:focus-within {\n  box-shadow: none;\n  border-color: var(--fallback-bc,oklch(var(--bc)/0.2));\n  outline-style: solid;\n  outline-width: 2px;\n  outline-offset: 2px;\n  outline-color: var(--fallback-bc,oklch(var(--bc)/0.2));\n}\n.input:has(> input[disabled]),\n  .input-disabled,\n  .input:disabled,\n  .input[disabled] {\n  cursor: not-allowed;\n  --tw-border-opacity: 1;\n  border-color: var(--fallback-b2,oklch(var(--b2)/1));\n  border-color: var(--fallback-b2,oklch(var(--b2)/var(--tw-border-opacity)));\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-b2,oklch(var(--b2)/1));\n  background-color: var(--fallback-b2,oklch(var(--b2)/var(--tw-bg-opacity)));\n  color: var(--fallback-bc,oklch(var(--bc)/0.4));\n}\n.input:has(> input[disabled])::-moz-placeholder, .input-disabled::-moz-placeholder, .input:disabled::-moz-placeholder, .input[disabled]::-moz-placeholder {\n  color: var(--fallback-bc,oklch(var(--bc)/0.2));\n  color: var(--fallback-bc,oklch(var(--bc)/var(--tw-placeholder-opacity)));\n  --tw-placeholder-opacity: 0.2;\n}\n.input:has(> input[disabled])::placeholder,\n  .input-disabled::placeholder,\n  .input:disabled::placeholder,\n  .input[disabled]::placeholder {\n  color: var(--fallback-bc,oklch(var(--bc)/0.2));\n  color: var(--fallback-bc,oklch(var(--bc)/var(--tw-placeholder-opacity)));\n  --tw-placeholder-opacity: 0.2;\n}\n.input:has(> input[disabled]) > input[disabled] {\n  cursor: not-allowed;\n}\n.input::-webkit-date-and-time-value {\n  text-align: inherit;\n}\n.join > :where(*:not(:first-child)) {\n  margin-top: 0px;\n  margin-bottom: 0px;\n  margin-left: -1px;\n}\n:where(.menu li:empty) {\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-bc,oklch(var(--bc)/1));\n  background-color: var(--fallback-bc,oklch(var(--bc)/var(--tw-bg-opacity)));\n  opacity: 0.1;\n  margin: 0.5rem 1rem;\n  height: 1px;\n}\n.menu :where(li ul):before {\n  position: absolute;\n  bottom: 0.75rem;\n  left: 0px;\n  top: 0.75rem;\n  width: 1px;\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-bc,oklch(var(--bc)/1));\n  background-color: var(--fallback-bc,oklch(var(--bc)/var(--tw-bg-opacity)));\n  opacity: 0.1;\n  content: "";\n}\n.menu :where(li:not(.menu-title) > *:not(ul):not(details):not(.menu-title):not(.btn)),\n.menu :where(li:not(.menu-title) > details > summary:not(.menu-title)) {\n  border-radius: 0.5rem;\n  border-radius: var(--rounded-btn, 0.5rem);\n  padding-left: 1rem;\n  padding-right: 1rem;\n  padding-top: 0.5rem;\n  padding-bottom: 0.5rem;\n  text-align: left;\n  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, -webkit-backdrop-filter;\n  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;\n  transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter, -webkit-backdrop-filter;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  transition-timing-function: cubic-bezier(0, 0, 0.2, 1);\n  transition-duration: 200ms;\n  text-wrap: balance;\n}\nsummary:where(.menu li:not(.menu-title):not(.disabled) > :not(ul):not(details):not(.menu-title)):not(.active):not(.btn):focus-visible {\n  cursor: pointer;\n  background-color: var(--fallback-bc,oklch(var(--bc)/0.1));\n  --tw-text-opacity: 1;\n  color: var(--fallback-bc,oklch(var(--bc)/1));\n  color: var(--fallback-bc,oklch(var(--bc)/var(--tw-text-opacity)));\n  outline: 2px solid transparent;\n  outline-offset: 2px;\n}\nsummary:where(.menu li:not(.menu-title):not(.disabled) > details > summary:not(.menu-title)):not(.active):not(.btn):focus-visible {\n  cursor: pointer;\n  background-color: var(--fallback-bc,oklch(var(--bc)/0.1));\n  --tw-text-opacity: 1;\n  color: var(--fallback-bc,oklch(var(--bc)/1));\n  color: var(--fallback-bc,oklch(var(--bc)/var(--tw-text-opacity)));\n  outline: 2px solid transparent;\n  outline-offset: 2px;\n}\n:where(.menu li:not(.menu-title):not(.disabled) > *:not(ul):not(details):not(.menu-title)):not(summary):not(.active):not(.btn).focus, :where(.menu li:not(.menu-title):not(.disabled) > *:not(ul):not(details):not(.menu-title)):not(summary):not(.active):not(.btn):focus, :where(.menu li:not(.menu-title):not(.disabled) > details > summary:not(.menu-title)):not(summary):not(.active):not(.btn).focus, :where(.menu li:not(.menu-title):not(.disabled) > details > summary:not(.menu-title)):not(summary):not(.active):not(.btn):focus {\n  cursor: pointer;\n  background-color: var(--fallback-bc,oklch(var(--bc)/0.1));\n  --tw-text-opacity: 1;\n  color: var(--fallback-bc,oklch(var(--bc)/1));\n  color: var(--fallback-bc,oklch(var(--bc)/var(--tw-text-opacity)));\n  outline: 2px solid transparent;\n  outline-offset: 2px;\n}\n.menu li > *:not(ul):not(.menu-title):not(details):not(.btn):active,\n.menu li > *:not(ul):not(.menu-title):not(details):not(.btn).active,\n.menu li > details > summary:active {\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-n,oklch(var(--n)/1));\n  background-color: var(--fallback-n,oklch(var(--n)/var(--tw-bg-opacity)));\n  --tw-text-opacity: 1;\n  color: var(--fallback-nc,oklch(var(--nc)/1));\n  color: var(--fallback-nc,oklch(var(--nc)/var(--tw-text-opacity)));\n}\n.menu :where(li > details > summary)::-webkit-details-marker {\n  display: none;\n}\n.menu :where(li > details > summary):after,\n.menu :where(li > .menu-dropdown-toggle):after {\n  justify-self: end;\n  display: block;\n  margin-top: -0.5rem;\n  height: 0.5rem;\n  width: 0.5rem;\n  transform: rotate(45deg);\n  transition-property: transform, margin-top;\n  transition-duration: 0.3s;\n  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);\n  content: "";\n  transform-origin: 75% 75%;\n  box-shadow: 2px 2px;\n  pointer-events: none;\n}\n.menu :where(li > details[open] > summary):after,\n.menu :where(li > .menu-dropdown-toggle.menu-dropdown-show):after {\n  transform: rotate(225deg);\n  margin-top: 0;\n}\n.mockup-phone .display {\n  overflow: hidden;\n  border-radius: 40px;\n  margin-top: -25px;\n}\n.mockup-browser .mockup-browser-toolbar .input {\n  position: relative;\n  margin-left: auto;\n  margin-right: auto;\n  display: block;\n  height: 1.75rem;\n  width: 24rem;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-b2,oklch(var(--b2)/1));\n  background-color: var(--fallback-b2,oklch(var(--b2)/var(--tw-bg-opacity)));\n  padding-left: 2rem;\n  direction: ltr;\n}\n.mockup-browser .mockup-browser-toolbar .input:before {\n  content: "";\n  position: absolute;\n  left: 0.5rem;\n  top: 50%;\n  aspect-ratio: 1 / 1;\n  height: 0.75rem;\n  --tw-translate-y: -50%;\n  transform: translate(var(--tw-translate-x), -50%) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n  transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n  border-radius: 9999px;\n  border-width: 2px;\n  border-color: currentColor;\n  opacity: 0.6;\n}\n.mockup-browser .mockup-browser-toolbar .input:after {\n  content: "";\n  position: absolute;\n  left: 1.25rem;\n  top: 50%;\n  height: 0.5rem;\n  --tw-translate-y: 25%;\n  --tw-rotate: -45deg;\n  transform: translate(var(--tw-translate-x), 25%) rotate(-45deg) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n  transform: translate(var(--tw-translate-x), var(--tw-translate-y)) rotate(var(--tw-rotate)) skewX(var(--tw-skew-x)) skewY(var(--tw-skew-y)) scaleX(var(--tw-scale-x)) scaleY(var(--tw-scale-y));\n  border-radius: 9999px;\n  border-width: 1px;\n  border-color: currentColor;\n  opacity: 0.6;\n}\n@keyframes modal-pop {\n\n  0% {\n    opacity: 0;\n  }\n}\n@keyframes progress-loading {\n\n  50% {\n    background-position-x: -115%;\n  }\n}\n@keyframes radiomark {\n\n  0% {\n    box-shadow: 0 0 0 12px var(--fallback-b1,oklch(var(--b1)/1)) inset,\n      0 0 0 12px var(--fallback-b1,oklch(var(--b1)/1)) inset;\n  }\n\n  50% {\n    box-shadow: 0 0 0 3px var(--fallback-b1,oklch(var(--b1)/1)) inset,\n      0 0 0 3px var(--fallback-b1,oklch(var(--b1)/1)) inset;\n  }\n\n  100% {\n    box-shadow: 0 0 0 4px var(--fallback-b1,oklch(var(--b1)/1)) inset,\n      0 0 0 4px var(--fallback-b1,oklch(var(--b1)/1)) inset;\n  }\n}\n@keyframes rating-pop {\n\n  0% {\n    transform: translateY(-0.125em);\n  }\n\n  40% {\n    transform: translateY(-0.125em);\n  }\n\n  100% {\n    transform: translateY(0);\n  }\n}\n@keyframes skeleton {\n\n  from {\n    background-position: 150%;\n  }\n\n  to {\n    background-position: -50%;\n  }\n}\n[dir="rtl"] .table {\n  text-align: right;\n}\n.table :where(th, td) {\n  padding-left: 1rem;\n  padding-right: 1rem;\n  padding-top: 0.75rem;\n  padding-bottom: 0.75rem;\n  vertical-align: middle;\n}\n.table tr.active,\n  .table tr.active:nth-child(even),\n  .table-zebra tbody tr:nth-child(even) {\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-b2,oklch(var(--b2)/1));\n  background-color: var(--fallback-b2,oklch(var(--b2)/var(--tw-bg-opacity)));\n}\n.table :where(thead tr, tbody tr:not(:last-child),tbody tr:first-child:last-child) {\n  border-bottom-width: 1px;\n  --tw-border-opacity: 1;\n  border-bottom-color: var(--fallback-b2,oklch(var(--b2)/1));\n  border-bottom-color: var(--fallback-b2,oklch(var(--b2)/var(--tw-border-opacity)));\n}\n.table :where(thead, tfoot) {\n  white-space: nowrap;\n  font-size: 0.75rem;\n  line-height: 1rem;\n  font-weight: 700;\n  color: var(--fallback-bc,oklch(var(--bc)/0.6));\n}\n.table :where(tfoot) {\n  border-top-width: 1px;\n  --tw-border-opacity: 1;\n  border-top-color: var(--fallback-b2,oklch(var(--b2)/1));\n  border-top-color: var(--fallback-b2,oklch(var(--b2)/var(--tw-border-opacity)));\n}\n.textarea-bordered {\n  border-color: var(--fallback-bc,oklch(var(--bc)/0.2));\n}\n.textarea:focus {\n  box-shadow: none;\n  border-color: var(--fallback-bc,oklch(var(--bc)/0.2));\n  outline-style: solid;\n  outline-width: 2px;\n  outline-offset: 2px;\n  outline-color: var(--fallback-bc,oklch(var(--bc)/0.2));\n}\n.textarea-disabled,\n  .textarea:disabled,\n  .textarea[disabled] {\n  cursor: not-allowed;\n  --tw-border-opacity: 1;\n  border-color: var(--fallback-b2,oklch(var(--b2)/1));\n  border-color: var(--fallback-b2,oklch(var(--b2)/var(--tw-border-opacity)));\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-b2,oklch(var(--b2)/1));\n  background-color: var(--fallback-b2,oklch(var(--b2)/var(--tw-bg-opacity)));\n  color: var(--fallback-bc,oklch(var(--bc)/0.4));\n}\n.textarea-disabled::-moz-placeholder, .textarea:disabled::-moz-placeholder, .textarea[disabled]::-moz-placeholder {\n  color: var(--fallback-bc,oklch(var(--bc)/0.2));\n  color: var(--fallback-bc,oklch(var(--bc)/var(--tw-placeholder-opacity)));\n  --tw-placeholder-opacity: 0.2;\n}\n.textarea-disabled::placeholder,\n  .textarea:disabled::placeholder,\n  .textarea[disabled]::placeholder {\n  color: var(--fallback-bc,oklch(var(--bc)/0.2));\n  color: var(--fallback-bc,oklch(var(--bc)/var(--tw-placeholder-opacity)));\n  --tw-placeholder-opacity: 0.2;\n}\n@keyframes toast-pop {\n\n  0% {\n    transform: scale(0.9);\n    opacity: 0;\n  }\n\n  100% {\n    transform: scale(1);\n    opacity: 1;\n  }\n}\n.btn-xs {\n  height: 1.5rem;\n  min-height: 1.5rem;\n  padding-left: 0.5rem;\n  padding-right: 0.5rem;\n  font-size: 0.75rem;\n}\n.btn-square:where(.btn-xs) {\n  height: 1.5rem;\n  width: 1.5rem;\n  padding: 0px;\n}\n.btn-square:where(.btn-sm) {\n  height: 2rem;\n  width: 2rem;\n  padding: 0px;\n}\n.btn-square:where(.btn-md) {\n  height: 3rem;\n  width: 3rem;\n  padding: 0px;\n}\n.btn-square:where(.btn-lg) {\n  height: 4rem;\n  width: 4rem;\n  padding: 0px;\n}\n.btn-circle:where(.btn-xs) {\n  height: 1.5rem;\n  width: 1.5rem;\n  border-radius: 9999px;\n  padding: 0px;\n}\n.drawer-open > .drawer-toggle {\n  display: none;\n}\n.drawer-open > .drawer-toggle ~ .drawer-side {\n  pointer-events: auto;\n  visibility: visible;\n  position: sticky;\n  display: block;\n  width: auto;\n  overscroll-behavior: auto;\n}\n.drawer-open > .drawer-toggle ~ .drawer-side > *:not(.drawer-overlay) {\n  transform: translateX(0%);\n}\n[dir="rtl"] .drawer-open > .drawer-toggle ~ .drawer-side > *:not(.drawer-overlay) {\n  transform: translateX(0%);\n}\n.drawer-open > .drawer-toggle:checked ~ .drawer-side {\n  pointer-events: auto;\n  visibility: visible;\n}\n.drawer-open > .drawer-side {\n  overflow-y: auto;\n}\nhtml:has(.drawer-toggle:checked) {\n  overflow-y: hidden;\n  scrollbar-gutter: stable;\n}\nhtml:has(.drawer-open.drawer-open) {\n  overflow-y: auto;\n  scrollbar-gutter: auto;\n}\n.join.join-vertical {\n  flex-direction: column;\n}\n.join.join-vertical .join-item:first-child:not(:last-child),\n  .join.join-vertical *:first-child:not(:last-child) .join-item {\n  border-bottom-left-radius: 0;\n  border-bottom-right-radius: 0;\n  border-top-left-radius: inherit;\n  border-top-right-radius: inherit;\n}\n.join.join-vertical .join-item:last-child:not(:first-child),\n  .join.join-vertical *:last-child:not(:first-child) .join-item {\n  border-top-left-radius: 0;\n  border-top-right-radius: 0;\n  border-bottom-left-radius: inherit;\n  border-bottom-right-radius: inherit;\n}\n.join.join-horizontal {\n  flex-direction: row;\n}\n.join.join-horizontal .join-item:first-child:not(:last-child),\n  .join.join-horizontal *:first-child:not(:last-child) .join-item {\n  border-bottom-right-radius: 0;\n  border-top-right-radius: 0;\n  border-bottom-left-radius: inherit;\n  border-top-left-radius: inherit;\n}\n.join.join-horizontal .join-item:last-child:not(:first-child),\n  .join.join-horizontal *:last-child:not(:first-child) .join-item {\n  border-bottom-left-radius: 0;\n  border-top-left-radius: 0;\n  border-bottom-right-radius: inherit;\n  border-top-right-radius: inherit;\n}\n.drawer-open > .drawer-toggle ~ .drawer-side > .drawer-overlay {\n  cursor: default;\n  background-color: transparent;\n}\n.join.join-vertical > :where(*:not(:first-child)) {\n  margin-left: 0px;\n  margin-right: 0px;\n  margin-top: -1px;\n}\n.join.join-horizontal > :where(*:not(:first-child)) {\n  margin-top: 0px;\n  margin-bottom: 0px;\n  margin-left: -1px;\n}\n.mx-auto {\n  margin-left: auto;\n  margin-right: auto;\n}\n.inline-block {\n  display: inline-block;\n}\n.table {\n  display: table;\n}\n.grid {\n  display: grid;\n}\n.h-24 {\n  height: 6rem;\n}\n.h-5 {\n  height: 1.25rem;\n}\n.min-h-full {\n  min-height: 100%;\n}\n.w-5 {\n  width: 1.25rem;\n}\n.w-80 {\n  width: 20rem;\n}\n.w-full {\n  width: 100%;\n}\n.max-w-xs {\n  max-width: 20rem;\n}\n.flex-1 {\n  flex: 1 1 0%;\n}\n.flex-none {\n  flex: none;\n}\n.grid-cols-1 {\n  grid-template-columns: repeat(1, minmax(0, 1fr));\n}\n.grid-cols-3 {\n  grid-template-columns: repeat(3, minmax(0, 1fr));\n}\n.gap-4 {\n  gap: 1rem;\n}\n.bg-base-100 {\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-b1,oklch(var(--b1)/1));\n  background-color: var(--fallback-b1,oklch(var(--b1)/var(--tw-bg-opacity)));\n}\n.bg-base-200 {\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-b2,oklch(var(--b2)/1));\n  background-color: var(--fallback-b2,oklch(var(--b2)/var(--tw-bg-opacity)));\n}\n.bg-base-300 {\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-b3,oklch(var(--b3)/1));\n  background-color: var(--fallback-b3,oklch(var(--b3)/var(--tw-bg-opacity)));\n}\n.stroke-current {\n  stroke: currentColor;\n}\n.p-4 {\n  padding: 1rem;\n}\n.px-4 {\n  padding-left: 1rem;\n  padding-right: 1rem;\n}\n.px-8 {\n  padding-left: 2rem;\n  padding-right: 2rem;\n}\n.py-2 {\n  padding-top: 0.5rem;\n  padding-bottom: 0.5rem;\n}\n.py-8 {\n  padding-top: 2rem;\n  padding-bottom: 2rem;\n}\n.text-xl {\n  font-size: 1.25rem;\n  line-height: 1.75rem;\n}\n.text-base-content {\n  --tw-text-opacity: 1;\n  color: var(--fallback-bc,oklch(var(--bc)/1));\n  color: var(--fallback-bc,oklch(var(--bc)/var(--tw-text-opacity)));\n}\n.text-error {\n  --tw-text-opacity: 1;\n  color: var(--fallback-er,oklch(var(--er)/1));\n  color: var(--fallback-er,oklch(var(--er)/var(--tw-text-opacity)));\n}\n.text-success {\n  --tw-text-opacity: 1;\n  color: var(--fallback-su,oklch(var(--su)/1));\n  color: var(--fallback-su,oklch(var(--su)/var(--tw-text-opacity)));\n}\n.filter {\n  filter: var(--tw-blur) var(--tw-brightness) var(--tw-contrast) var(--tw-grayscale) var(--tw-hue-rotate) var(--tw-invert) var(--tw-saturate) var(--tw-sepia) var(--tw-drop-shadow);\n}\n\n.widget {\n}\n\n.widget-view {\n  position: relative;\n  border-radius: 0.25rem;\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-b1,oklch(var(--b1)/1));\n  background-color: var(--fallback-b1,oklch(var(--b1)/var(--tw-bg-opacity)));\n  padding: 1rem;\n}\n\n.widget-edit {\n  position: relative;\n  border-radius: 0.25rem;\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-b1,oklch(var(--b1)/1));\n  background-color: var(--fallback-b1,oklch(var(--b1)/var(--tw-bg-opacity)));\n  padding: 1rem;\n}\n\n.widget .widget-title {\n  font-weight: 700;\n}\n\n.widget .widget-value {\n  font-size: 2.25rem;\n  line-height: 2.5rem;\n  font-weight: 700;\n}\n\n@media (hover:hover) {\n\n  .widget .widget-table tr.hover:hover,.widget .widget-table tr.hover:nth-child(even):hover {\n    --tw-bg-opacity: 1;\n    background-color: var(--fallback-b2,oklch(var(--b2)/1));\n    background-color: var(--fallback-b2,oklch(var(--b2)/var(--tw-bg-opacity)));\n  }\n}\n\n.widget .widget-table {\n  position: relative;\n  width: 100%;\n  border-radius: 1rem;\n  border-radius: var(--rounded-box, 1rem);\n  text-align: left;\n  font-size: 0.875rem;\n  line-height: 1.25rem;\n}\n\n.widget .widget-table :where(.table-pin-rows thead tr) {\n  position: sticky;\n  top: 0px;\n  z-index: 1;\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-b1,oklch(var(--b1)/1));\n  background-color: var(--fallback-b1,oklch(var(--b1)/var(--tw-bg-opacity)));\n}\n\n.widget .widget-table :where(.table-pin-rows tfoot tr) {\n  position: sticky;\n  bottom: 0px;\n  z-index: 1;\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-b1,oklch(var(--b1)/1));\n  background-color: var(--fallback-b1,oklch(var(--b1)/var(--tw-bg-opacity)));\n}\n\n.widget .widget-table :where(.table-pin-cols tr th) {\n  position: sticky;\n  left: 0px;\n  right: 0px;\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-b1,oklch(var(--b1)/1));\n  background-color: var(--fallback-b1,oklch(var(--b1)/var(--tw-bg-opacity)));\n}\n\n[dir="rtl"] .widget .widget-table {\n  text-align: right;\n}\n\n.widget .widget-table :where(th, td) {\n  padding-left: 1rem;\n  padding-right: 1rem;\n  padding-top: 0.75rem;\n  padding-bottom: 0.75rem;\n  vertical-align: middle;\n}\n\n.widget .widget-table tr.active,.widget .widget-table tr.active:nth-child(even) {\n  --tw-bg-opacity: 1;\n  background-color: var(--fallback-b2,oklch(var(--b2)/1));\n  background-color: var(--fallback-b2,oklch(var(--b2)/var(--tw-bg-opacity)));\n}\n\n.widget .widget-table :where(thead tr, tbody tr:not(:last-child),tbody tr:first-child:last-child) {\n  border-bottom-width: 1px;\n  --tw-border-opacity: 1;\n  border-bottom-color: var(--fallback-b2,oklch(var(--b2)/1));\n  border-bottom-color: var(--fallback-b2,oklch(var(--b2)/var(--tw-border-opacity)));\n}\n\n.widget .widget-table :where(thead, tfoot) {\n  white-space: nowrap;\n  font-size: 0.75rem;\n  line-height: 1rem;\n  font-weight: 700;\n  color: var(--fallback-bc,oklch(var(--bc)/0.6));\n}\n\n.widget .widget-table :where(tfoot) {\n  border-top-width: 1px;\n  --tw-border-opacity: 1;\n  border-top-color: var(--fallback-b2,oklch(var(--b2)/1));\n  border-top-color: var(--fallback-b2,oklch(var(--b2)/var(--tw-border-opacity)));\n}\n\n.widget .widget-table {\n  display: table;\n}\n.widget .widget-canvas {\n  padding-top: 0.5rem;\n  padding-bottom: 0.5rem;\n}\n\n.widget .widget-benchmark {\n  display: grid;\n  font-size: 0.75rem;\n  line-height: 1rem;\n}\n\n.widget .widget-trend {\n  display: grid;\n  grid-template-columns: repeat(2, minmax(0, 1fr));\n}\n\n.widget .widget-trend .left {\n  text-align: left;\n  display: grid;\n  font-size: 0.75rem;\n  line-height: 1rem;\n}\n\n\n.widget .widget-trend .right {\n  text-align: right;\n  display: grid;\n  font-size: 0.75rem;\n  line-height: 1rem;\n}\n\n.widget-toggle {\n\ttext-align: right;\n}\n\n.widget-edit-title {\n  font-weight: 700;\n}\n\n.widget-edit {\n  padding-bottom: 0.5rem;\n}',""]);const a=s},72:t=>{var e=[];function n(t){for(var n=-1,r=0;r<e.length;r++)if(e[r].identifier===t){n=r;break}return n}function r(t,r){for(var o={},s=[],a=0;a<t.length;a++){var l=t[a],u=r.base?l[0]+r.base:l[0],c=o[u]||0,h="".concat(u," ").concat(c);o[u]=c+1;var f=n(h),d={css:l[1],media:l[2],sourceMap:l[3],supports:l[4],layer:l[5]};if(-1!==f)e[f].references++,e[f].updater(d);else{var p=i(d,r);r.byIndex=a,e.splice(a,0,{identifier:h,updater:p,references:1})}s.push(h)}return s}function i(t,e){var n=e.domAPI(e);return n.update(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;n.update(t=e)}else n.remove()}}t.exports=function(t,i){var o=r(t=t||[],i=i||{});return function(t){t=t||[];for(var s=0;s<o.length;s++){var a=n(o[s]);e[a].references--}for(var l=r(t,i),u=0;u<o.length;u++){var c=n(o[u]);0===e[c].references&&(e[c].updater(),e.splice(c,1))}o=l}}},659:t=>{var e={};t.exports=function(t,n){var r=function(t){if(void 0===e[t]){var n=document.querySelector(t);if(window.HTMLIFrameElement&&n instanceof window.HTMLIFrameElement)try{n=n.contentDocument.head}catch(t){n=null}e[t]=n}return e[t]}(t);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(n)}},540:t=>{t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},56:(t,e,n)=>{t.exports=function(t){var e=n.nc;e&&t.setAttribute("nonce",e)}},825:t=>{t.exports=function(t){if("undefined"==typeof document)return{update:function(){},remove:function(){}};var e=t.insertStyleElement(t);return{update:function(n){!function(t,e,n){var r="";n.supports&&(r+="@supports (".concat(n.supports,") {")),n.media&&(r+="@media ".concat(n.media," {"));var i=void 0!==n.layer;i&&(r+="@layer".concat(n.layer.length>0?" ".concat(n.layer):""," {")),r+=n.css,i&&(r+="}"),n.media&&(r+="}"),n.supports&&(r+="}");var o=n.sourceMap;o&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(o))))," */")),e.styleTagTransform(r,t,e.options)}(e,t,n)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},113:t=>{t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},122:t=>{var e=/("(?:[^\\"]|\\.)*")|[:,]/g;t.exports=function(t,n){var r,i,o;return n=n||{},r=JSON.stringify([1],void 0,void 0===n.indent?2:n.indent).slice(2,-3),i=""===r?1/0:void 0===n.maxLength?80:n.maxLength,o=n.replacer,function t(n,s,a){var l,u,c,h,f,d,p,m,g,y,b,v;if(n&&"function"==typeof n.toJSON&&(n=n.toJSON()),void 0===(b=JSON.stringify(n,o)))return b;if(p=i-s.length-a,b.length<=p&&(g=b.replace(e,(function(t,e){return e||t+" "}))).length<=p)return g;if(null!=o&&(n=JSON.parse(b),o=void 0),"object"==typeof n&&null!==n){if(m=s+r,c=[],u=0,Array.isArray(n))for(y="[",l="]",p=n.length;u<p;u++)c.push(t(n[u],m,u===p-1?0:1)||"null");else for(y="{",l="}",p=(d=Object.keys(n)).length;u<p;u++)h=d[u],f=JSON.stringify(h)+": ",void 0!==(v=t(n[h],m,f.length+(u===p-1?0:1)))&&c.push(f+v);if(c.length>0)return[y,r+c.join(",\n"+m),l].join("\n"+s)}return b}(t,"",0)}}},e={};function n(r){var i=e[r];if(void 0!==i)return i.exports;var o=e[r]={id:r,loaded:!1,exports:{}};return t[r](o,o.exports,n),o.loaded=!0,o.exports}n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.nmd=t=>(t.paths=[],t.children||(t.children=[]),t),n.nc=void 0,(()=>{var t={};n.r(t),n.d(t,{JsonPatchError:()=>u$,_areEquals:()=>v$,applyOperation:()=>p$,applyPatch:()=>m$,applyReducer:()=>g$,deepClone:()=>c$,getValueByPointer:()=>d$,validate:()=>b$,validator:()=>y$});var e={};n.r(e),n.d(e,{compare:()=>C$,generate:()=>E$,observe:()=>S$,unobserve:()=>k$});var r={};n.r(r),n.d(r,{aggregate:()=>Bz,bin:()=>Rz,collect:()=>zz,compare:()=>jz,countpattern:()=>Vz,cross:()=>qz,density:()=>Yz,dotbin:()=>Zz,expression:()=>tj,extent:()=>nj,facet:()=>ij,field:()=>oj,filter:()=>aj,flatten:()=>lj,fold:()=>uj,formula:()=>cj,generate:()=>hj,impute:()=>pj,joinaggregate:()=>mj,kde:()=>gj,key:()=>yj,load:()=>vj,lookup:()=>xj,multiextent:()=>_j,multivalues:()=>Sj,params:()=>Aj,pivot:()=>Cj,prefacet:()=>Dj,project:()=>Mj,proxy:()=>Oj,quantile:()=>Tj,relay:()=>Ij,sample:()=>Nj,sequence:()=>$j,sieve:()=>Fj,subflow:()=>rj,timeunit:()=>Lj,tupleindex:()=>Rj,values:()=>Pj,window:()=>qj});var i={};n.r(i),n.d(i,{interpolate:()=>JM,interpolateArray:()=>HM,interpolateBasis:()=>MD,interpolateBasisClosed:()=>OD,interpolateCubehelix:()=>Fq,interpolateCubehelixLong:()=>Lq,interpolateDate:()=>YM,interpolateDiscrete:()=>YV,interpolateHcl:()=>_q,interpolateHclLong:()=>kq,interpolateHsl:()=>ZV,interpolateHslLong:()=>tq,interpolateHue:()=>XV,interpolateLab:()=>wq,interpolateNumber:()=>FC,interpolateNumberArray:()=>qM,interpolateObject:()=>XM,interpolateRgb:()=>FD,interpolateRgbBasis:()=>BD,interpolateRgbBasisClosed:()=>RD,interpolateRound:()=>KM,interpolateString:()=>jD,interpolateTransformCss:()=>jC,interpolateTransformSvg:()=>UC,interpolateZoom:()=>KV,piecewise:()=>BV,quantize:()=>Bq});var o={};n.r(o),n.d(o,{bound:()=>$K,identifier:()=>BK,mark:()=>RK,overlap:()=>PK,render:()=>HK,viewlayout:()=>dQ});var s={};n.r(s),n.d(s,{axisticks:()=>mQ,datajoin:()=>gQ,encode:()=>bQ,legendentries:()=>vQ,linkpath:()=>SQ,pie:()=>MQ,scale:()=>IQ,sortitems:()=>LQ,stack:()=>jQ});var a={};n.r(a),n.d(a,{contour:()=>k2,geojson:()=>A2,geopath:()=>C2,geopoint:()=>D2,geoshape:()=>M2,graticule:()=>O2,heatmap:()=>T2,isocontour:()=>d2,kde2d:()=>w2,projection:()=>N2});var l={};n.r(l),n.d(l,{force:()=>i3});var u={};n.r(u),n.d(u,{nest:()=>l4,pack:()=>p4,partition:()=>g4,stratify:()=>y4,tree:()=>w4,treelinks:()=>x4,treemap:()=>S4});var c={};n.r(c),n.d(c,{label:()=>H4});var h={};n.r(h),n.d(h,{loess:()=>Y4,regression:()=>J4});var f={};n.r(f),n.d(f,{voronoi:()=>A5});var d={};n.r(d),n.d(d,{wordcloud:()=>j5});var p={};n.r(p),n.d(p,{crossfilter:()=>Y5,resolvefilter:()=>X5});var m={};n.r(m),n.d(m,{Bounds:()=>hG,CanvasHandler:()=>GX,CanvasRenderer:()=>ZX,DATE:()=>zL,DAY:()=>jL,DAYOFYEAR:()=>UL,Dataflow:()=>hP,Debug:()=>J$,Error:()=>G$,EventStream:()=>KR,Gradient:()=>mH,GroupItem:()=>dG,HOURS:()=>VL,Handler:()=>SX,HybridHandler:()=>qJ,HybridRenderer:()=>VJ,Info:()=>X$,Item:()=>fG,MILLISECONDS:()=>HL,MINUTES:()=>qL,MONTH:()=>RL,Marks:()=>lX,MultiPulse:()=>aP,None:()=>H$,Operator:()=>YR,Parameters:()=>WR,Pulse:()=>rP,QUARTER:()=>BL,RenderType:()=>YJ,Renderer:()=>AX,ResourceLoader:()=>pG,SECONDS:()=>WL,SVGHandler:()=>eJ,SVGRenderer:()=>CJ,SVGStringRenderer:()=>zJ,Scenegraph:()=>gX,TIME_UNITS:()=>GL,Transform:()=>dP,View:()=>Ltt,WEEK:()=>PL,Warn:()=>Y$,YEAR:()=>LL,accessor:()=>O$,accessorFields:()=>I$,accessorName:()=>T$,array:()=>kF,ascending:()=>DF,bandwidthNRD:()=>CP,bin:()=>DP,bootstrapCI:()=>TP,boundClip:()=>nK,boundContext:()=>FG,boundItem:()=>uX,boundMark:()=>hX,boundStroke:()=>yG,changeset:()=>VR,clampRange:()=>SF,codegenExpression:()=>C8,compare:()=>CF,constant:()=>IF,cumulativeLogNormal:()=>HP,cumulativeNormal:()=>zP,cumulativeUniform:()=>QP,dayofyear:()=>tB,debounce:()=>NF,defaultLocale:()=>tR,definition:()=>mP,densityLogNormal:()=>WP,densityNormal:()=>PP,densityUniform:()=>KP,domChild:()=>wX,domClear:()=>xX,domCreate:()=>bX,domFind:()=>vX,dotbin:()=>IP,error:()=>L$,expressionFunction:()=>F7,extend:()=>$F,extent:()=>FF,extentIndex:()=>LF,falsy:()=>q$,fastmap:()=>zF,field:()=>R$,flush:()=>jF,font:()=>tX,fontFamily:()=>ZY,fontSize:()=>YY,format:()=>ER,formatLocale:()=>HB,formats:()=>AR,hasOwnProperty:()=>RF,id:()=>P$,identity:()=>z$,inferType:()=>bR,inferTypes:()=>vR,ingest:()=>BR,inherits:()=>UF,inrange:()=>VF,interpolate:()=>RW,interpolateColors:()=>FW,interpolateRange:()=>$W,intersect:()=>KJ,intersectBoxLine:()=>HG,intersectPath:()=>UG,intersectPoint:()=>VG,intersectRule:()=>WG,isArray:()=>Q$,isBoolean:()=>qF,isDate:()=>WF,isFunction:()=>EF,isIterable:()=>HF,isNumber:()=>GF,isObject:()=>Z$,isRegExp:()=>YF,isString:()=>XF,isTuple:()=>$R,key:()=>JF,lerp:()=>KF,lineHeight:()=>XY,loader:()=>MR,locale:()=>ZB,logger:()=>K$,lruCache:()=>ZF,markup:()=>vJ,merge:()=>tL,mergeConfig:()=>eF,multiLineOffset:()=>KY,one:()=>U$,pad:()=>nL,panLinear:()=>fF,panLog:()=>dF,panPow:()=>pF,panSymlog:()=>mF,parse:()=>dot,parseExpression:()=>S8,parseSelector:()=>tet,path:()=>GU,pathCurves:()=>yH,pathEqual:()=>oK,pathParse:()=>kH,pathRectangle:()=>GH,pathRender:()=>$H,pathSymbols:()=>RH,pathTrail:()=>YH,peek:()=>iF,point:()=>kX,projection:()=>e2,quantileLogNormal:()=>GP,quantileNormal:()=>jP,quantileUniform:()=>ZP,quantiles:()=>EP,quantizeInterpolator:()=>LW,quarter:()=>xF,quartiles:()=>AP,random:()=>MP,randomInteger:()=>$P,randomKDE:()=>VP,randomLCG:()=>NP,randomLogNormal:()=>YP,randomMixture:()=>XP,randomNormal:()=>UP,randomUniform:()=>tz,read:()=>DR,regressionConstant:()=>ez,regressionExp:()=>lz,regressionLinear:()=>sz,regressionLoess:()=>mz,regressionLog:()=>az,regressionPoly:()=>hz,regressionPow:()=>uz,regressionQuad:()=>cz,renderModule:()=>JJ,repeat:()=>eL,resetDefaultLocale:()=>eR,resetSVGClipId:()=>uG,resetSVGDefIds:()=>sK,responseType:()=>CR,runtimeContext:()=>W7,sampleCurve:()=>vz,sampleLogNormal:()=>qP,sampleNormal:()=>RP,sampleUniform:()=>JP,scale:()=>SW,sceneEqual:()=>iK,sceneFromJSON:()=>pX,scenePickVisit:()=>rY,sceneToJSON:()=>dX,sceneVisit:()=>nY,sceneZOrder:()=>eY,scheme:()=>UW,serializeXML:()=>wJ,setHybridRendererOptions:()=>UJ,setRandom:()=>OP,span:()=>rL,splitAccessPath:()=>B$,stringValue:()=>iL,textMetrics:()=>UY,timeBin:()=>PB,timeFloor:()=>gB,timeFormatLocale:()=>KB,timeInterval:()=>_B,timeOffset:()=>EB,timeSequence:()=>DB,timeUnitSpecifier:()=>KL,timeUnits:()=>XL,toBoolean:()=>oL,toDate:()=>aL,toNumber:()=>oF,toSet:()=>uL,toString:()=>lL,transform:()=>gP,transforms:()=>pP,truncate:()=>cL,truthy:()=>V$,tupleid:()=>FR,typeParsers:()=>mR,utcFloor:()=>vB,utcInterval:()=>kB,utcOffset:()=>AB,utcSequence:()=>MB,utcdayofyear:()=>sB,utcquarter:()=>_F,utcweek:()=>aB,version:()=>pot,visitArray:()=>hL,week:()=>eB,writeConfig:()=>nF,zero:()=>j$,zoomLinear:()=>yF,zoomLog:()=>bF,zoomPow:()=>vF,zoomSymlog:()=>wF});var g={};n.r(g),n.d(g,{accessPathDepth:()=>ust,accessPathWithDatum:()=>rst,compile:()=>Rwt,contains:()=>Bot,deepEqual:()=>vst,deleteNestedProperty:()=>est,duplicate:()=>Tot,entries:()=>Kot,every:()=>Pot,fieldIntersection:()=>Got,flatAccessWithDatum:()=>ist,getFirstDefined:()=>cst,hasIntersection:()=>Wot,hash:()=>Fot,internalField:()=>pst,isBoolean:()=>Qot,isEmpty:()=>Yot,isEqual:()=>Vot,isInternalField:()=>mst,isNullOrFalse:()=>Lot,isNumeric:()=>yst,keys:()=>Xot,logicalExpr:()=>tst,mergeDeep:()=>zot,never:()=>Iot,normalize:()=>amt,normalizeAngle:()=>gst,omit:()=>$ot,pick:()=>Not,prefixGenerator:()=>Hot,removePathFromField:()=>lst,replaceAll:()=>ast,replacePathInField:()=>sst,resetIdCounter:()=>dst,setEqual:()=>qot,some:()=>Rot,stringify:()=>wst,titleCase:()=>nst,unique:()=>Uot,uniqueId:()=>fst,vals:()=>Jot,varName:()=>Zot,version:()=>Pwt});var y={};n.r(y),n.d(y,{carbong10:()=>Pxt,carbong100:()=>jxt,carbong90:()=>zxt,carbonwhite:()=>Rxt,dark:()=>Vwt,excel:()=>Wwt,fivethirtyeight:()=>Jwt,ggplot2:()=>Qwt,googlecharts:()=>vxt,latimes:()=>ixt,powerbi:()=>Ixt,quartz:()=>axt,urbaninstitute:()=>mxt,version:()=>Uxt,vox:()=>uxt});const b=0;function v(t){return t&&t.length>b}const w=-1;function x(t){return v(t)?t.length+w:void 0}new RegExp("").exec(""),Symbol("TO_STRING");class _ extends Error{constructor(t,e){super(t),this.expectation=e}}function k(t,e,n){if(!e(t)){const r=O.get(e),i=E.merge(r,n);if(void 0===i){const t=e.name;throw new _(`Assumption was incorrect: ${t}`,M())}throw new _(i.message(t),i)}}function S(t,e,n){return k(t,e,n),t}k.noop=()=>{},k.noop=function(){},S.noop=(t,e,n)=>t;class E{static create(t){return new E(t,void 0,void 0,void 0)}static merge(t,e){if(t||e)return t?e?new E(e.#t,e.#e??t.#e,e.#n??t.#n,e.#r??t.#r):t:e}#t;#e;#n;#r;constructor(t,e,n,r){this.#t=t,this.#e=e,this.#n=n,this.#r=r}as(t){return new E(t,this.#e,this.#n,this.#r)}update(t){const e=t.description?t.description(this.#t):this.#t,n=t.to?t.to(this.#e):this.#e,r="string"==typeof n?[D(this.#e)??"to be",n]:n,i=t.actual?t.actual(this.#n):this.#n;return new E(e,r,i,t.when?t.when(this.#r):this.#r)}toBe(t){return new E(this.#t,["to be",t],this.#n,this.#r)}toHave(t){return new E(this.#t,["to have",t],this.#n,this.#r)}butGot(t){return new E(this.#t,this.#e,"string"==typeof t?()=>t:t,this.#r)}when(t){return new E(this.#t,this.#e,this.#n,t)}message(t){let e="";return this.#r&&(e+=`When ${this.#r}: `),e+=`Expected ${this.#t??"value"}`,this.#e&&(e+=` ${D(this.#e)} ${n=this.#e,null==n?void 0:n[C]}`),this.#n&&(e+=`, but it was ${String(this.#n(t))}`),e;var n}}const A=0,C=1;function D(t){return null==t?void 0:t[A]}function M(t){return E.create(t)}M.as=M,M.toBe=t=>M().toBe(t),M.toHave=t=>M().toHave(t),M.when=t=>M().when(t),M.butGot=t=>M().butGot(t);const O=new WeakMap;function T(t){switch(typeof t){case"boolean":case"number":case"undefined":case"symbol":return String(t);case"bigint":return`${t}n`;case"string":return JSON.stringify(t);case"function":{const e=String(t);return e.startsWith("class")?`{class ${t.name}}`:e.match(/^function\s*[*]/)?`{function* ${t.name}}`:e.match(/^async\s+function/)?`{async function ${t.name}}`:t.name?`{${t.name}`:"{anonymous function}"}case"object":{if(null===t)return"null";const e=Object.getPrototypeOf(t);if(null===e||e===Object.prototype){const e=Object.entries(t).map((t=>{let[e,n]=t;return`${e}: ${T(n)}`})).join(", ");return`{ ${e} }`}return t.constructor.name?`{${t.constructor.name} instance}`:"{anonymous instance}"}}}function I(t){return null!=t}function N(t,e){throw e?Error(`unexpected types left in ${e}`):Error("unexpected types left")}function $(t){return M.associate((function(e){return Object.is(e,t)}),M.toBe(function(t){return F(t)&&Symbol.for("nodejs.util.inspect.custom")in t?JSON.stringify(t[Symbol.for("nodejs.util.inspect.custom")]()):JSON.stringify(t)}(t)).butGot(T))}function F(t){return"object"==typeof t&&null!==t}function L(t){return("object"==typeof t||"function"==typeof t)&&null!==t}M.associate=(t,e)=>(O.set(t,e),t),M.updated=(t,e)=>(O.get(t)??M()).update(e),M.associate(I,M.toBe("present")),M.associate(F,M.toBe("an object").butGot((t=>null===t?"null":typeof t))),M.associate(L,M.toBe("an object or function").butGot((t=>null===t?"null":typeof t)));const B=v;function R(t,e,n){return Object.defineProperty(t,e,{writable:!0,enumerable:!0,configurable:!0,value:n}),t}M.associate(B,M.toHave("at least one item")),R.builtin=(t,e,n)=>(Object.defineProperty(t,e,{writable:!1,enumerable:!1,configurable:!0,value:n}),t);const P={object:"an object",null:"null",undefined:"undefined",function:"a function",string:"a string",number:"a number",boolean:"a boolean",symbol:"a symbol",bigint:"a bigint"},z={object:F,null:$(null),undefined:U("undefined"),function:U("function"),string:U("string"),number:U("number"),boolean:U("boolean"),symbol:U("symbol"),bigint:U("bigint")};function j(t){return z[t]}function U(t){if("object"===t)return F;const e=R.builtin((e=>typeof e===t),"name",`is:${t}`);return R.builtin(e,Symbol.toStringTag,"Verifier"),M.associate(e,M.toBe(P[t]).butGot(V))}function V(t){return null===t?"null":typeof t}const q=k,W=S,H=Symbol.for("starbeam.UNINITIALIZED"),G=Symbol.for("starbeam.REACTIVE"),Y=Symbol.for("starbeam.COORDINATION");function X(){let t=globalThis[Y];return t||(globalThis[Y]=t={}),t}const J=X();let K=J.id;if(!K){let t=1;K=J.id={get:()=>t++}}const Q=K;function Z(){return Q.get()}const tt=X();let et=tt.now;et||(et=tt.now={timestamp:0});const nt=et;function rt(){return nt.timestamp}var it=n(678),ot=n(485);ot.nice,ot.parse,ot.strip,ot.ansicolor,ot.black,ot.bgBlack,ot.red,ot.bgRed,ot.green,ot.bgGreen,ot.yellow,ot.bgYellow,ot.blue,ot.bgBlue,ot.magenta,ot.bgMagenta,ot.cyan,ot.bgCyan,ot.lightGray,ot.bgLightGray,ot.bgDefault,ot.darkGray,ot.bgDarkGray,ot.lightRed,ot.bgLightRed,ot.lightGreen,ot.bgLightGreen,ot.lightYellow,ot.bgLightYellow,ot.lightBlue,ot.bgLightBlue,ot.lightMagenta,ot.bgLightMagenta,ot.lightCyan,ot.bgLightCyan,ot.white,ot.bgWhite,ot.bgBrightRed,ot.bgBrightGreen,ot.bgBrightYellow,ot.bgBrightBlue,ot.bgBrightMagenta,ot.bgBrightCyan,ot.bright,ot.dim,ot.italic,ot.underline,ot.inverse,ot.names,ot.rgb;const st=ot;if(void 0===globalThis.Buffer&&"function"==typeof require)try{const t=require("buffer");globalThis.Buffer=t.Buffer}catch{}function at(t,e,n){let r=t;null!=n&&n.description&&(r=`${r} [${"string"==typeof n.description?n.description:JSON.stringify(n.description)}]`);const i=class{};Object.defineProperty(i,"name",{value:r});const o=new i;for(const[t,n]of function(t){return Object.entries(t)}(e))Object.defineProperty(o,t,{value:n,enumerable:!0});return o}const lt=Symbol.for("nodejs.util.inspect.custom");Symbol("STARBEAM_DEBUG"),Symbol("STARBEAM_DEBUG_NAME");class ut{static create(t,e){return new ut(t,e)}#i;#o;constructor(t,e){this.#i=t,this.#o=e}stylize(t,e){return this.#o.stylize(t,e)}struct(t,e){return at(this.#i,t,e)}}function ct(t,e){return{define:n=>{t.prototype[lt]=function(r,i){return n(this,ut.create(e??t.name,i))}}}}function ht(t){return new pt(function(t){var e;if(t.startsWith(".")||t.startsWith("/"))return new gt(t);const n=null===(e=bt.exec(t))||void 0===e?void 0:e.groups;if(void 0===n)return new gt(t);const{scope:r,name:i,path:o}=n;return new yt(r,i,o)}(t))}class ft{#s;#a;constructor(t){let{path:e,root:n}=t;this.#s=e,this.#a=n}finish(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return new dt({path:this.#s,root:this.#a,...t})}}class dt{#l;#u;#s;#a;static#c=ct(this,"DisplayParts").define(((t,e)=>e.struct({path:t.#s,root:t.#a,action:t.#l,loc:t.#u})));constructor(t){let{path:e,root:n,action:r,loc:i}=t;this.#s=e,this.#a=n,this.#l=r,this.#u=i}get action(){return this.#l}get#h(){var t;return null!==(t=this.#a)&&void 0!==t&&t.name?`[${this.#a.name}]/${this.#s}`:this.#s}get loc(){return this.#u}get path(){return this.#s}get root(){return this.#a}display(){return this.#u&&this.#l?`${this.#l} (${this.#h}:${mt(this.#u)})`:this.#u?`${this.#h}:${mt(this.#u)}`:this.#l?`${this.#l} (${this.#h})`:this.#h}}class pt{#f;constructor(t){this.#f=t}display(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.parts(t,e).display()}parts(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=this.#f.parts(e);if(void 0===t)return n.finish();const{loc:r,action:i}=t,o=void 0!==r,s=function(t){return"string"==typeof t&&""!==t.trim()}(i);return o&&s?n.finish({action:i,loc:r}):o?n.finish({loc:r}):s?n.finish({action:i}):n.finish()}}function mt(t){return void 0===t.column?`${t.line}`:`${t.line}:${t.column}`}class gt{#s;pkg=null;type="relative";constructor(t){this.#s=t}[Symbol.for("nodejs.util.inspect.custom")](){return`DescribedModulePath(${this.#s})`}parts(t){return function(t){let{root:e,roots:n,full:r}=t;if(e&&r.startsWith(e)){const t=r.slice(e.length),n=t.startsWith("/")?t.slice(1):t;return new ft({root:{prefix:e},path:n})}if(n)for(const[t,e]of Object.entries(n))if(r.startsWith(e)){const n=r.slice(e.length),i=n.startsWith("/")?n.slice(1):n;return new ft({root:{name:t,prefix:e},path:i})}return new ft({path:r})}({...t,full:vt(this.#s)})}}class yt{#i;#s;#d;type="package";constructor(t,e,n){this.#d=t,this.#i=e,this.#s=n}get#p(){const t=[];return this.#d&&t.push(this.#d),t.push(this.#i),this.#s&&t.push(this.#s),vt(...t)}get pkg(){return vt(this.#d,this.#i)}[Symbol.for("nodejs.util.inspect.custom")](){const t=this.#s?` at ${this.#s}`:"";return this.#d?`DescribedPackage(${this.#d}/${this.#i}${t})`:`DescribedPackage(${this.#i}${t})`}parts(){return new ft({path:this.#p})}}const bt=/^(?![a-z]+:)(?:(?<scope>@[^/\\]+)[/])?(?<name>[^/\\]+)(?:[/\\](?<path>.*))?$/;function vt(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.filter(j("string")).map((t=>t.replaceAll(/[\\]/g,"/"))).join("/")}const wt=Symbol.for("starbeam.id:reuse");let xt;{class t{#m;#g;#y;#b;#v;#w;static from(e){return t.is(e)?e:t.is(e.fromUser)?e.fromUser:new t(e.id??Z(),e.type,e.api,e.fromUser,e.internal,e.stack)}static is(e){return!!(e&&e instanceof t)}constructor(t,e,n,r,i,o){this.#y=t,this.#w=e,this.#m=n,this.#g=r,this.#b=i,this.#v=o}get api(){var t;return this.#m??(null===(t=this.#x)||void 0===t?void 0:t.api)}get#_(){return"string"==typeof this.#m?{name:this.#m}:this.#m}get#k(){return"string"==typeof this.#g?{type:"value",name:this.#g}:void 0===this.#g?{type:"anonymous"}:this.#g}get frame(){var t;return null===(t=this.#v)||void 0===t?void 0:t.caller}get fromUser(){if(!this.#g)return`{anonymous ${this.type}}`;if("string"==typeof this.#g)return this.#g;switch(this.#g.type){case"member":switch(this.#g.kind){case"index":return`[${this.#g.name}]`;case"property":return`.${this.#g.name}`;case"key":return`->${this.#g.name}`}case"detail":{const t=st.dim(`->${this.#g.name}`);return this.#g.args?`${t}(${this.#g.args.map((t=>st.magenta(t))).join(", ")})`:t}case"method":return`.${this.#g.name}()`;default:N(this.#g)}}get fullName(){return void 0!==this.#g?"string"==typeof this.#g?this.#g:`${this.#g.parent.fullName}${this.fromUser}`:`{${this.#S}:anonymous ${this.type}}`}get id(){return this.#y}get#S(){return"string"==typeof this.#y||"number"==typeof this.#y?String(this.#y):this.#y.map(String).join("/")}get isAnonymous(){return void 0===this.#g}get#x(){if("object"==typeof this.#g)return this.#g.parent}get parts(){var t,e;return{type:this.#w,id:this.#y,api:this.#_,details:this.#k,userFacing:this.#E,frame:null===(t=this.#v)||void 0===t?void 0:t.caller,stack:null===(e=this.#v)||void 0===e?void 0:e.stack,internal:this.#b}}get type(){return this.#w}get userFacing(){return this.#b?this.#b.userFacing:this}get#E(){var t;return(null===(t=this.#b)||void 0===t?void 0:t.userFacing)??this}[Symbol.for("nodejs.util.inspect.custom")](){return at("Description",{id:this.#y,type:this.#w,api:this.#m,details:this.#g,internal:this.#b,stack:this.#v})}asImplementation(e){return new t(this.#y,this.#w,this.#m,this.#g,{reason:null==e?void 0:e.reason,userFacing:this.#x??this},this.#v)}#A(t){var e;const n=null===(e=this.#v)||void 0===e?void 0:e.caller;return void 0!==n?n.display(t):"<unknown>"}describe(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const e=this.#i(t);return this.#b?`${e} ${this.#b.reason?st.dim(`[${this.#b.reason}]`):st.dim("[internals]")}`:e}detail(e,n){let r,i,o;return Array.isArray(n)?(r=n,o=this.#C(e)):n?(r=n.args,i=n.note,o=this.#C(n.id??e)):o=this.#C(e),new t(o,"formula",this.#m,{type:"detail",parent:this,name:e,args:r,note:i},void 0,this.#v)}#C(t){return t===wt?this.#y:Array.isArray(this.#y)?[...this.#y,t]:[this.#y,t]}implementation(e,n){return"symbol"==typeof e&&q(e,$(wt),M("symbol passed to implementation()").toBe("REUSE_ID")),new t(this.#C(e),this.#w,this.#m,this.#g,{reason:null==n?void 0:n.reason,userFacing:(null==n?void 0:n.userFacing)??this.userFacing},(null==n?void 0:n.stack)??At())}index(e){return new t(this.#C(e),"formula",this.#m,{type:"member",parent:this,kind:"index",name:e},void 0,this.#v)}key(e,n){return new t(this.#C(null!=n&&n.id?[e,n.id]:e),"formula",this.#m,{type:"member",kind:"key",parent:this,name:e,note:null==n?void 0:n.note},void 0,this.#v)}method(e,n,r){return"symbol"==typeof e&&q(e,$(wt),M.as("symbol passed to desc.method()").toBe("REUSE_ID").butGot((t=>String(t)))),new t(this.#D(e),"formula",this.#m,{type:"method",parent:this,name:n,args:r},void 0,this.#v)}#i(t){const e=(()=>this.isAnonymous||t.source?`${this.fullName} @ ${this.#A(t)}`:this.fullName)();return!this.isAnonymous&&t.id?`${e} (${this.#S})`:e}#D(t){return t===wt?this.#y:t}property(e){return new t(this.#C(e),"formula",this.#m,{type:"member",parent:this,kind:"property",name:e},void 0,this.#v)}withId(e){return void 0===e?this:new t(e,this.#w,this.#m,this.#g,this.#b,this.#v)}withStack(e,n){return"symbol"==typeof n&&q(n,$(wt),M.as("symbol passed to withStack").toBe("REUSE_ID").butGot((t=>String(t)))),new t(this.#D(n),this.#w,this.#m,this.#g,this.#b,e)}}xt=t}const _t=xt;let kt;{Error.stackTraceLimit=1e3;class t{static empty(){return new t("","","",[])}static parse(e){let{stack:n}=e;const r=new it(n),i=r.items,[o]=i;if(void 0===o)return new t(n,n,"",[]);const s=o.beforeParse,l=n.split("\n"),u=l.findIndex((t=>t.trim()===s));if(-1===u)throw Error(`An assumption was incorrect: A line that came from StackTracey cannot be found in the original trace.\n\n== Stack ==\n\n${n}\n\n== Line ==\n\n${s}`);const c=l.slice(0,u).join("\n"),h=l.slice(u).join("\n");return new t(n,c,h,i.map((t=>a.from(r,t))))}static#c=ct(this,"ParsedStack").define(((t,e)=>e.struct({header:t.#M,frames:t.#O.map((t=>t.parts().display())),rest:t.#T})));#I;#M;#T;#O;constructor(t,e,n,r){this.#I=t,this.#M=e,this.#T=n,this.#O=r}get header(){return this.#M}get entries(){return this.#O}get stack(){return`${this.#M}\n${this.#T}`}replaceFrames(e){return new t(this.#I,this.#M,e.#T,e.#O)}slice(e){const n=this.#T.split("\n").slice(e).join("\n");return new t(this.#I,this.#M,n,this.#O.slice(e))}}const e=new WeakSet,n=0,r=1,i=1,o=2;class s{static EMPTY=new s(t.empty());static create(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;const e=Error;if("captureStackTrace"in e){const n={};return e.captureStackTrace(n,s.create),s.fromStack(n.stack).slice(t)}{const e=Error("An error created in the internals of Stack.create").stack;return s.fromStack(W(e,j("string"))).slice(t+i)}}static fromCaller(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;return s.create(t+o)}static fromStack(e){return new s(t.parse({stack:e}))}static replaceFrames(t,e){if(Ct(t)){const n=s.from(t);n.withReplacedFrames(e),t.stack=n.stack}}static from(e){return Ct(e)?new s(t.parse(e)):null}static description(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n;const r=s.fromCaller(e+i),o=t.fromUser,a=t.api??{};if("string"!=typeof a&&void 0===a.package){var l;const t=null===(l=r.caller)||void 0===l?void 0:l.starbeamCaller;t&&(a.package=t.package,a.name=t.name)}return void 0===o||"string"==typeof o?_t.from({...t,stack:r}):_t.is(o)?o.withId(t.id):_t.from({...t,stack:r})}static desc(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:n;return s.description({type:t,fromUser:e},r+i)}static id(t){return void 0===t||"string"==typeof t?Z():t.id}static callerFrame(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n;return s.fromCaller(t+i).caller}static entryPoint(t){let{internal:n=r,stack:o=s.create(i+n)}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};try{return t()}catch(t){if(Ct(t)&&!e.has(t)){const n=s.from(t).withReplacedFrames(o);t.stack=n.stack,e.add(t)}throw t}}#N;constructor(t){this.#N=t}get entries(){return this.#N.entries}get caller(){return function(t){return t[0]}(this.#N.entries)}get header(){return this.#N.header}get stack(){return this.#N.stack}withReplacedFrames(t){return new s(this.#N.replaceFrames(t.#N))}slice(t){return 0===t?this:new s(this.#N.slice(t))}}kt=s;class a{static from(t,e){return new a(t,e,null)}static#c=ct(this,"StackFrame").define(((t,e)=>e.struct({original:t.parts().display()})));#v;#$;#F;constructor(t,e,n){this.#v=t,this.#$=e,this.#F=n}get starbeamCaller(){const t=this.#L(),e=/(@starbeam\/[/]+)/.exec(t.file);if(e)return{package:e[1],name:""===t.callee?void 0:t.callee}}get action(){return this.#L().callee}get loc(){const t=this.#L();if(void 0!==t.line)return{line:t.line,column:t.column}}get debug(){return this.#L()}#L(){let t=this.#F;return t||(this.#F=t=this.#v.withSource(this.#$)),t}link(t){return null!=t&&t.complete?this.#v.items.map((t=>t.beforeParse)).join("\n"):ht(this.#L().file).display({loc:this.loc},t)}fullStack(){return this.#v.asTable()}display(t){return ht(this.#L().file).display({action:this.action,loc:this.loc},t)}parts(t){return ht(this.#L().file).parts({action:this.action,loc:this.loc},t)}}}kt.entryPoint;const St=kt.description,Et=kt.desc,At=(kt.id,kt.fromCaller);function Ct(t){return F(t)&&t instanceof Error&&"string"==typeof t.stack}let Dt;!function(t){t[t.Trace=0]="Trace",t[t.Debug=1]="Debug",t[t.Info=2]="Info",t[t.Warn=3]="Warn",t[t.Error=4]="Error",t[t.Fatal=5]="Fatal"}(Dt||(Dt={}));class Mt{#B;#R;#P;constructor(t,e,n){this.#B=t,this.#R=e,this.#P=n}log=(()=>{var t=this;return function(e){if(t.#R>=t.#P.minimum){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];t.#B.send(t.#R,{args:[e,...r]})}}})();get withStack(){return new Ot(this.#B,this.#R,this.#P)}}class Ot{#B;#R;#P;constructor(t,e,n){this.#B=t,this.#R=e,this.#P=n}log(t){if(this.#R>=this.#P.minimum){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];this.#B.send(this.#R,{args:[t,...n],stack:!0})}}}new class{#z;#P;trace;debug;info;warn;error;fatal;constructor(t,e){this.#z=t,this.#P=e,this.trace=new Mt(this,Dt.Trace,e),this.debug=new Mt(this,Dt.Debug,e),this.info=new Mt(this,Dt.Info,e),this.warn=new Mt(this,Dt.Warn,e),this.error=new Mt(this,Dt.Error,e),this.fatal=new Mt(this,Dt.Fatal,e)}set level(t){this.#P={...this.#P,minimum:t}}get isVerbose(){return this.#P.minimum===Dt.Trace}get isDebug(){return this.#P.minimum<=Dt.Debug}configure(t){Object.assign(this.#P,t)}send(t,e){let{args:n,stack:r}=e;switch(t===Dt.Trace&&(r?this.#z.trace(...n):this.#z.debug(...n)),this.#z.groupCollapsed("stack trace"),this.#z.trace(),this.#z.groupEnd(),t){case Dt.Trace:r?this.#z.trace(...n):this.#z.debug(...n);break;case Dt.Debug:this.#z.debug(...n);break;case Dt.Info:this.#z.log(...n);break;case Dt.Warn:this.#z.warn(...n);break;case Dt.Error:case Dt.Fatal:this.#z.error(...n)}}}(globalThis.console,{minimum:Dt.Warn});class Tt{#j;constructor(t){this.#j=t}get at(){return this.#j.at}get caller(){return this.#j.caller}get for(){return this.#j.for}}class It extends Tt{type="cell:consume"}class Nt extends Tt{type="cell:update"}class $t extends Tt{#U;#$;type="frame:consume";constructor(t){super(t),this.#U=t.diff,this.#$=t.frame}get diff(){return this.#U}get frame(){return this.#$}}class Ft{type="mutation";for=void 0;#V;#t;#q=new Set;#x;constructor(t,e,n){this.#V=t,this.#t=e,this.#x=n}get at(){return this.#V}add(t){this.#q.add(t)}}class Lt{#W;#H;#G=0;#Y=[];#X=null;#J=new Set;static Flush=class{constructor(t){this.history=t}for(t){const e=function(t){return t[G]}(t);return this.history.filter((t=>t.for===e))}};static DebugListener=class{#K;#Q=0;#Z;#tt;constructor(t,e,n){this.#K=t,this.#tt=e,this.#Z=n}static offset(t){return t.#Q}static create(t,e){return new Lt(t,e)}static notify(t){t.#tt()}update(t){this.#Z=t}flush(){const t=this.#K.#et(this.#Q,function(t,e){switch(t.type){case"by-reactive":{const n=e.dependencies(t.reactive);return t=>void 0!==t.for&&"mutable"===t.for.type&&[...n].includes(t.for)}case"all":return;case"none":return()=>!1;default:N()}}(this.#Z,this.#K.#H));return this.#Q=this.#K.#nt,this.#K.#rt(),t.history}detach(){this.#K.#J.delete(this)}};static create(t,e){return new Lt(t,e)}constructor(t,e){this.#W=t,this.#H=e}get#nt(){return this.#G+this.#Y.length}notify(){this.#J.forEach(Lt.DebugListener.notify)}attach(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{filter:"all"};const n="string"==typeof e.filter?{type:e.filter}:e.filter,r=new Lt.DebugListener(this,t,n);return this.#J.add(r),r}#et(t,e){let n=this.#Y.slice(t-this.#G);return e&&(n=n.filter(e)),new Lt.Flush(n)}#rt(){const t=Math.min(...[...this.#J].map(Lt.DebugListener.offset)),e=t-this.#G;this.#Y=this.#Y.slice(e),this.#G=t}#it(t){this.#X?this.#X.add(t):this.#Y.push(t)}#ot(t,e){this.#it(new It({at:this.#W.now(),for:t,caller:e}))}consumeCell(t,e){this.#ot(t,e)}consumeFrame(t,e,n){this.#st(t,e,n)}updateCell(t,e){this.#it(new Nt({at:this.#W.now(),for:t,caller:e}))}#st(t,e,n){this.#it(new $t({at:this.#W.now(),for:t[G],diff:e,caller:n,frame:t}))}mutation(t,e){const n=this.#X,r=new Ft(this.#W.now(),t,n);try{this.#X=r;const t=e();return this.#X=n,this.#it(r),t}catch(t){throw this.#X=n,t}}}const Bt="â”‚",Rt="â”œ",Pt="â•°";class zt{#a;constructor(t){this.#a=t}format(){return jt(this.#a,{depth:0})}}function jt(t,e){let{depth:n}=e;const r=x(t);return t.map(((t,e)=>function(t,e){let{depth:n,isLast:r}=e;return"string"==typeof t?function(t,e){let{depth:n,isLast:r}=e;return`${qt({depth:n,isLast:r})} ${t}`}(t,{depth:n,isLast:r}):function(t,e){let[n,...r]=t,{depth:i}=e;return`${qt({depth:i,isLast:!1})} ${n}\n${jt(r,{depth:i+Ut})}`}(t,{depth:n,isLast:r})}(t,{depth:n,isLast:e===r}))).join("\n")}const Ut=1;function Vt(t){return`${Bt} `.repeat(t)}function qt(t){let{depth:e,isLast:n}=t;return n?`${Vt(e)}${Pt}`:`${Vt(e)}${Rt}`}St({id:NaN,type:"erased",api:"anonymous"});class Wt{#at=new WeakMap;create(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(void 0===t)return e(...r);let o=this.#at.get(t);return void 0===o&&(o=e(...r),this.#at.set(t,o)),o}}class Ht{#v=[];#lt=new Wt;get current(){const t=this.#ut;if(void 0===t)throw Error("You are attempting to use a feature of Starbeam that depends on the current component, but no component is currently active.");return t}get#ut(){return function(t){return v(t)?t[x(t)]:void 0}(this.#v)}push(t){this.#v.push(t)}pop(){this.#v.pop()}exists(){return v(this.#v)}create(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return this.#lt.create(this.#ut,t,...n)}}new class{component=new Ht;#ct;#ht=new WeakMap;set app(t){this.#ct=t}get app(){if(void 0===this.#ct)throw Error("You are attempting to use a feature of Starbeam that depends on the application context, but no application context has been set.");return this.#ct}hasApp(){return void 0!==this.#ct}create(t,e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return this.#ft.create(t,e,...r)}get#ft(){const t=this.app;let e=this.#ht.get(t);return void 0===e&&(e=new Wt,this.#ht.set(t,e)),e}};class Gt{#dt;#pt;#q=new Set;#mt=!1;#gt=new Set;on={finalize:t=>(this.#gt.add(t),()=>this.#gt.delete(t))};static#c=(()=>{ct(this,"ObjectLifetime").define(((t,e)=>e.struct({finalizers:t.#gt,children:t.#q,finalized:t.#mt})))})();static create(t){return new Gt(void 0,t)}static finalize(t){t.#yt()}constructor(t,e){this.#dt=t?new WeakRef(t):void 0,this.#pt=new WeakRef(e)}get owner(){var t;return null===(t=this.#dt)||void 0===t?void 0:t.deref()}get object(){return this.#pt.deref()}setOwnedBy(t){return this.#dt=new WeakRef(t),{prev:this.#dt.deref()}}#yt(){if(!this.#mt){this.#mt=!0;for(const t of this.#gt)t();for(const t of this.#q)t.#yt()}}link(t){return this.#q.add(t),()=>this.#q.delete(t)}unlink(t){this.#q.delete(t)}}const Yt=new class{#bt=new WeakMap;#vt=new WeakMap;on={cleanup:(t,e)=>{let n=this.#bt.get(t);return n||(n=Gt.create(t),this.#bt.set(t,n)),n.on.finalize(e)}};finalize(t){const e=this.#bt.get(t);e&&Gt.finalize(e)}#wt(t){let e=this.#bt.get(t);return e||(e=Gt.create(t),this.#bt.set(t,e)),e}link(t,e,n){const r=this.#wt(t),i=this.#wt(e);if(null!=n&&n.root){const t=this.#vt.get(e);t&&(q(t.root,$(n.root),M("a root passed to link").toBe("the same as the previous root").butGot("a different root")),t.unlink());const o=r.link(i);return this.#vt.set(e,{root:n.root,unlink:o}),o}return r.link(i)}unlink(t,e){const n=this.#bt.get(t);if(n){const t=this.#bt.get(e);t&&n.unlink(t)}}};let Xt=1;const Jt=Symbol.for("nodejs.util.inspect.custom");var Kt=new WeakSet;class Qt{static#xt=rt();static now(){return new Qt(rt())}static zero(){return new Qt(Qt.#xt)}static assert(t,e){if(!Kt.has(t))throw Error(`Value passed to ${e} was unexpectedly not a timestamp`)}static debug(t){return Qt.assert(t,"Timestamp.debug"),{at:t.#W}}#W=void Kt.add(this);constructor(t){this.#W=t,this[Jt]=()=>at("Timestamp",{at:this.#W})}gt(t){return Qt.assert(t,"Timestamp#gt"),this.#W>t.#W}eq(t){return Qt.assert(t,"Timestamp#eq"),this.#W===t.#W}next(){return new ee((nt.timestamp=nt.timestamp+1,rt()))}toString=()=>`#<Timestamp ${this.#W}>`}function Zt(){return ee.zero()}function te(){return ee.now()}const ee=Qt,ne=new class{#_t=ee.now();get now(){return this.#_t}bump(){return this.#_t=this.#_t.next()}},re={description:t=>ie.description(t[G]),id:t=>ie.id(t[G]),is:(t,e)=>ie.is(t[G],e),match:(t,e)=>ie.match(t[G],e),subscribesTo(t){const e=t[G];return"delegate"===e.type?e.delegate.flatMap(re.subscribesTo):[t]},dependencies:t=>ie.dependencies(t[G]),*dependenciesInList(t){for(const e of t)yield*ie.dependencies(e[G])},lastUpdated:t=>ie.lastUpdated(t[G]),lastUpdatedIn(t){let e=Zt();for(const n of re.dependenciesInList(t))n.lastUpdated.gt(e)&&(e=n.lastUpdated);return e},log(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ie.log(t[G],e)},debug(t){let{implementation:e=!1,source:n=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return ie.debug(t[G],{implementation:e,source:n})}},ie={is:(t,e)=>t.type===e,id:t=>t.description.id,*dependencies(t){var e;switch(t.type){case"static":return;case"mutable":if(null!==(e=t.isFrozen)&&void 0!==e&&e.call(t))break;yield t;break;case"delegate":for(const e of ie.subscribesTo(t))yield*ie.dependencies(e);break;case"composite":yield*re.dependenciesInList(t.children())}},*dependenciesInList(t){for(const e of t)yield*ie.dependencies(e)},subscribesTo:t=>"delegate"===t.type?t.delegate.flatMap((t=>re.subscribesTo(t).map((t=>t[G])))):[t],lastUpdated(t){switch(t.type){case"static":return Zt();case"mutable":return t.lastUpdated;case"delegate":{const e=ie.subscribesTo(t);return ie.lastUpdatedIn(e)}case"composite":{let e=Zt();for(const n of ie.dependencies(t))n.lastUpdated.gt(e)&&(e=n.lastUpdated);return e}}},lastUpdatedIn(t){let e=Zt();for(const n of ie.dependenciesInList(t))n.lastUpdated.gt(e)&&(e=n.lastUpdated);return e},description:t=>t.description,debug(t){let{implementation:e=!1,source:n=!1,id:r=!1}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const i=[...ie.dependencies(t)],o=new Set(i.map((t=>e?t.description:t.description.userFacing)));return function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return new zt(e)}(...[...o].map((t=>(e?t:t.userFacing).describe({source:n,id:r}))).filter(I)).format()},log(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const n=ie.debug(t,e);console.group(ie.description(t).describe({id:e.id}),`(updated at ${ee.debug(ie.lastUpdated(t)).at})`),console.log(n),console.groupEnd()},match(t,e){const n=e[t.type];return"function"==typeof n?n(t):e.default(t)}},oe={is:t=>!(!t||"object"!=typeof t&&"function"!=typeof t||!(G in t)),from:(t,e)=>oe.is(t)?t:new ae(t,Et("static",e))},se=t=>!(!t||"object"!=typeof t&&"function"!=typeof t||!(G in t)||!function(t){return"read"in t&&"function"==typeof t.read}(t));class ae{#kt;[G];constructor(t,e){this.#kt=t,this[G]={type:"static",description:e}}get current(){return this.#kt}read(){return this.#kt}}class le{static create(t,e,n,r){const i=String(Xt++);return new le(i,t,{[G]:{type:"mutable",lastUpdated:n,description:r.key("initialized?").asImplementation()}},e,n,r)}static uninitialized(t,e){const n=e.id;return new le(n,H,{[G]:{type:"mutable",lastUpdated:t,description:e.detail("initialized?")}},new Set,t,e)}static value(t){return t.#kt}static isInitialized(t){return t.#kt!==H}static update(t,e,n,r){return t.#St(e,n,r)}static updateChildren(t,e){t.#q=e}#kt;#Et;#q;#mt;#t;constructor(t,e,n,r,i,o){this.#kt=e,this.#Et=n,this.#q=r,this.#mt=i,this.#t=o}get[G](){return{type:"composite",description:this.#t,children:()=>[this.#Et,...this.#q]}}get description(){return this.#t}#St(t,e,n){return Object.is(this.#kt,H)&&(this.#Et[G].lastUpdated=n),this.#kt=t,this.#q=e,this.#mt=n,this}validate(){return this.#kt===H||re.lastUpdatedIn([...this.#q]).gt(this.#mt)?{status:"invalid"}:{status:"valid",value:this.#kt}}}class ue{static create(t,e,n){return new ue(t,e,new Set,n)}#At;#Ct;#q;constructor(t,e,n,r){this.description=r,this.#At=t,this.#Ct=e,this.#q=n}add(t){this.#q.add(t)}finally(){return{prev:this.#Ct}}finalize(t,e){let n=this.#At;return n?(le.update(n,t,this.#q,te()),e.update(n)):n=le.create(t,this.#q,te(),this.description),{prev:this.#Ct,frame:n}}}class ce{#ut;#Dt;#K;static didConsumeCell(t,e,n){t.#Mt.consumeCell(e[G],n),t.#Ot(e,n)}static didConsumeFrame(t,e,n,r){t.#Mt.consumeFrame(e,n,r),t.#Ot(e,r)}static empty(t,e){return new ce(e,null,t)}constructor(t,e,n){this.#Dt=t,this.#ut=e,this.#K=n}get currentFrame(){return this.#ut}get#Mt(){return this.#K.log}create(t){let{evaluate:e,description:n}=t;const r=this.#Tt(n);if(!e)return r;try{const t=e();return this.#nt(r,t)}catch(t){throw this.finally(r),t}}#Ot(t,e){const n=this.currentFrame;if(n)n.add(t);else{const n=re.subscribesTo(t).filter((t=>re.is(t,"mutable")));for(const t of n)re.is(t,"mutable")&&this.#K.untrackedRead(t,e)}}#nt(t,e){const{prev:n,frame:r}=t.finalize(e,this.#K);return this.#ut=n,r}finally(t){this.#ut=t}#Tt(t,e){const n=this.#ut;return this.#ut=ue.create(e??null,n,t)}update(t){let{updating:e,evaluate:n}=t;const r=this.#Tt(e.description,e);if(!n)return r;try{this.#K.willEvaluate();const t=n(),e=this.#nt(r,t);return this.#Dt.update(e),e}catch(t){throw this.finally(r),t}}}function he(t,e){const n=new Set,r=new Set;for(const n of t)e.has(n)||r.add(n);for(const r of e)t.has(r)||n.add(r);return{add:n,remove:r}}const fe={add:new Set,remove:new Set};he.empty=()=>fe;class de{#It;#Nt;#$t;constructor(t,e,n){this.#It=t,this.#Nt=e,this.#$t=n}update(t){this.#It=t}get dependencies(){return this.#It}get lastNotified(){return this.#Nt}notify(t,e){this.#Nt=t,this.#$t(e)}}class pe{static create(){return new pe(new WeakMap,new WeakMap)}#Ft;#Lt;constructor(t,e){this.#Ft=t,this.#Lt=e}notify(t){const e=this.#Lt.get(t);if(e)for(const n of e)n.notify(te(),t)}register(t,e){const n=re.subscribesTo(t),r=new Set(re.dependencies(t)),i=new de(r,te(),e);for(const t of r)this.#Bt(t,i);for(const t of n)this.#Rt(t,i);return()=>{for(const t of n)this.#Pt(t,i)}}update(t){const e=this.#Ft.get(t);if(!e)return;const n=new Set(re.dependencies(t)),r=re.lastUpdated(t);for(const t of e){const e=t.dependencies,i=t.lastNotified,o=he(e,n),{add:s,remove:a}=o;for(const e of s)this.#Bt(e,t);for(const e of a)this.#zt(e,t);t.update(n),void 0===i||r.gt(i)}}#Rt(t,e){let n=this.#Ft.get(t);n||(n=new Set,this.#Ft.set(t,n)),n.add(e)}#Pt(t,e){const n=this.#Ft.get(t);n&&n.delete(e);const r=e.dependencies;for(const t of r)this.#zt(t,e)}#Bt(t,e){let n=this.#Lt.get(t);n||(n=new Set,this.#Lt.set(t,n)),n.add(e)}#zt(t,e){const n=this.#Lt.get(t);n&&n.delete(e)}}class me{#jt;#Ut=null;#$;#Vt;on={rendered:t=>(this.#jt.add(t),()=>{this.#jt.delete(t)}),change:(t,e)=>this.#Dt.register(t,e)};#qt=new Set;#Dt;static create(){return new me(pe.create(),new Set,"initial")}constructor(t,e,n){var r=this;this.#Dt=t,this.#jt=e,this.#$=ce.empty(this,t),this.#Vt=n,this.attach=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{filter:{type:"all"}};const n=r.#Mt.attach(t,e);return Yt.on.cleanup(n,(()=>{n.detach()})),n},this.untrackedReadBarrier=t=>{this.#qt.add(t)}}get#Mt(){if(!this.#Ut){const t=this.#Ut=Lt.create({now:te},re);this.on.rendered((()=>{t.notify()}))}return this.#Ut}get frame(){return this.#$}get log(){return this.#Mt}get now(){return ne.now}#Wt(t){const e=this.#Vt,n="consumed"===e||"evaluating"===e,r="consumed"===t||"evaluating"===t;return this.#Vt=t,n===r?this.now:this.next()}bump(t,e){const n=this.#Wt("bumped");return this.#Mt.updateCell(t,e),this.#Dt.notify(t),n}didConsumeCell(t,e){this.#Wt("consumed"),ce.didConsumeCell(this.#$,t,e)}didConsumeFrame(t,e,n){this.#Wt("consumed"),ce.didConsumeFrame(this.#$,t,e,n)}next(){return ne.bump()}update(t){this.#Dt.update(t)}willEvaluate(){this.#Vt="evaluating"}mutation(t,e){return this.#Mt.mutation(t,e)}untrackedRead(t,e){for(const n of this.#qt)n(t,e)}}const ge=me.create();function ye(t,e){const n=St({type:"formula",api:{package:"@starbeam/universal",name:"Formula"},fromUser:e}),r=function(t,e){const n=St({type:"formula",api:{package:"@starbeam/universal",name:"Formula"},fromUser:e}),r=le.uninitialized(ge.now,n);return{poll:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:At();return"valid"===r.validate().status?(ge.didConsumeFrame(r,he.empty(),e),r):((e=>{{const n=new Set(re.dependencies(r));ge.frame.update({updating:r,evaluate:t}),ge.update(r);const i=new Set(re.dependencies(r));ge.didConsumeFrame(r,he(n,i),e)}})(e),r)},frame:r}}(t,n),i=()=>le.value(r.poll());return Object.defineProperty(i,"read",{enumerable:!1,configurable:!0,writable:!0,value:i}),Object.defineProperty(i,"current",{enumerable:!1,configurable:!0,get:i}),Object.defineProperty(i,G,{enumerable:!1,configurable:!0,writable:!0,value:{type:"delegate",description:n,delegate:[r.frame]}}),Object.defineProperty(i,Symbol.for("nodejs.util.inspect.custom"),{enumerable:!1,configurable:!0,writable:!0,value:()=>`Formula(${n.fullName}, id=${JSON.stringify(n.id)})`}),i}class be{#Ht=!1;#Gt=ge.now;type="mutable";constructor(t){this.description=t}get lastUpdated(){return this.#Gt}isFrozen(){return this.#Ht}freeze(){this.#Ht=!0}update(t){if(this.#Ht)throw TypeError("Cannot update frozen object");this.#Gt=ge.bump(this,t)}}class ve{static create(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.is;return new ve(t,n,e)}#kt;#Yt;#Xt;constructor(t,e,n){this.#kt=t,this.#Xt=e,this.#Yt=n,this[Jt]=()=>{const{description:t,lastUpdated:e}=this.#Yt;return at(`Cell (${t.describe()})`,{value:this.#kt,updated:e})},Object.defineProperty(this,"toString",{enumerable:!1,configurable:!0,writable:!0,value:()=>`Cell (${String(this.#kt)})`})}freeze(){this.#Yt.freeze()}get current(){return this.read(At())}set current(t){this.#Jt(t,At())}read(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:At();return ge.didConsumeCell(this,t),this.#kt}set(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:At();return this.#Jt(t,e)}update(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:At();return this.#Jt(t(this.#kt),e)}initialize(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:At();return this.#kt===H&&this.#Jt(t(),e),this.#kt}#Jt(t,e){return!this.#Xt(this.#kt,t)&&(this.#kt=t,this.#Yt.update(e),!0)}get[G](){return this.#Yt}}const we=0;function xe(t,e){let n,r;return"string"==typeof e||void 0===e?(n=ke(e),r=Object.is):(n=ke(e.description),r=e.equals??Object.is),ve.create(t,function(t){return new be(t)}(n),r)}const _e=1;function ke(t){return"string"==typeof t||void 0===t?St({type:"cell",api:{package:"@starbeam/universal",name:"Cell"},fromUser:t},(arguments.length>1&&void 0!==arguments[1]?arguments[1]:we)+_e):t}function Se(t,e){const n=Et("blueprint:reactive",e);return new Ee(t,n)}xe.is=t=>function(t){return"object"==typeof t&&null!==t}(t)&&t instanceof ve,Se.is=oe.is,Se.from=oe.from;class Ee{static is(t){return F(t)&&t instanceof Ee}#Kt;#t;constructor(t,e){this.#Kt=t,this.#t=e}create(t){const e=function(t){try{return t()}catch{return new t}}(this.#Kt);return Ee.is(e)?e.create():e}isResource(){return!1}}function Ae(t,e){return Object.freeze({[G]:{type:"static",description:Et("static",e)},current:t,read:()=>t})}class Ce{static getOwner(t){return t.#dt}static NEXT_ID=0;id;#Qt;#Zt;#dt;on={cleanup:t=>Yt.on.cleanup(this,t)};constructor(t,e,n){this.#dt=t,this.#Zt=e,this.#Qt=n,this.id=Ce.NEXT_ID++}use=(t,e)=>this.#Zt.assimilateResourceReturn({resource:t,nextRun:this,desc:Et("resource",(null==e?void 0:e.description)??this.#Qt.detail("use"))})}class De{static getOwner(t){return t.#dt}static create(t,e,n,r){return new De(r,(function(t){try{return e(t)}catch(n){if(n instanceof TypeError&&/class constructor/i.exec(n.message))return new e(t);throw n}}),n,t)}#Qt;#te;#dt;#ee=void 0;reactiveConstructor;reactiveInstance;resource;constructor(t,e,n,r){let i;this.#Qt=t,this.#te=e,this.#dt=r,this.reactiveConstructor=ye((()=>this.next()),t.detail("constructor"));let o=!1;var s;Yt.on.cleanup(r,(()=>{o=!0})),this.reactiveInstance=ye((()=>(i&&o||(i=this.reactiveConstructor.read()),i)),t.detail("instance")),this.resource=(s=ye((()=>this.reactiveInstance.read().read()),t.detail("instance")),Oe.set(s,{hasLifetime:!0}),s)}next(){return this.#ne((t=>{const e=this.#te(t);return this.assimilateResourceReturn({resource:e,nextRun:t,desc:this.#Qt})}))}#ne(t){const e=this.#ee,n=new Ce(this.#dt,this,this.#Qt);this.#ee=n,Yt.link(this,n);const r=t(n);return e&&Yt.finalize(e),r}assimilateResourceReturn(t){let{resource:e,nextRun:n,desc:r}=t;return function(t){var e;return!(!L(t)||null===(e=Oe.get(t))||void 0===e||!e.hasLifetime)}(e)?(Yt.link(n,e,{root:this.#dt}),e):se(e)?e:e instanceof Me?e.use(n,this):e===H?Ae(void 0):Ae(e,r.detail("return"))}}class Me{static initial(t){const e=t.#xt.current;return e===H?void 0:e}#Kt;#xt;#re;constructor(t,e,n){this.#Kt=t,this.#re=e,this.#xt=n}create(t){return this.#ie(this.#Kt(t,this.#xt))}use(t,e){return this.#ie(this.#re(t,e,this.#xt))}initial(t){return new Me(this.#Kt,this.#re,ye(t))}#ie(t){let{state:e}=t;const n=e.resource;return Yt.link(n,e),n}root(){const t=Object.create(null);return{resource:this.create(t),owner:t}}isResource(){return!0}}const Oe=new WeakMap;Symbol.for("nodejs.util.inspect.custom");const Te=new Set(["toJSON","inspect"]);for(const t of Object.keys(Object.getOwnPropertyDescriptors(Object.prototype)))Te.add(t);!function(t,e){if(t instanceof Me||t instanceof Ee)return t;const n=Et("resource",e);new Me(((e,r)=>{const i=De.create(e,t,r,n);return Yt.link(e,i),{state:i}}),((e,r,i)=>{{const o=De.create(r,t,i,n),s=o.resource;return Yt.link(e,s,{root:De.getOwner(r)}),{state:o}}}),Ae(H))}((function(t){var e=xe(new Date),n=setInterval((function(){e.set(new Date)}),1e3);return t.on.cleanup((function(){clearInterval(n)})),ye((function(){var t=e.current;return new Intl.DateTimeFormat("en-US",{hour:"numeric",minute:"numeric",second:"numeric",hour12:!1}).format(t)}))}));const Ie=!1;let Ne,$e,Fe,Le,Be,Re,Pe,ze,je,Ue,Ve,qe,We,He=()=>{},Ge=!1;function Ye(t){if(Ie){if(Ge)throw new Error("Attempted to set the global context twice. This should only be set once.");Ge=!0}He=t.scheduleRevalidate,Ne=t.scheduleDestroy,$e=t.scheduleDestroyed,Fe=t.toIterator,Le=t.toBool,Be=t.getProp,Re=t.setProp,Pe=t.getPath,ze=t.setPath,je=t.warnIfStyleNotTrusted,Ue=t.assert,Ve=t.deprecate}Ie&&(qe=()=>{if(!1===Ge)throw new Error("The global context for Glimmer VM was not set. You must set these global context functions to let Glimmer VM know how to accomplish certain operations. You can do this by importing `setGlobalContext` from `@glimmer/global-context`")},We=t=>{let e=Ge?{scheduleRevalidate:He,scheduleDestroy:Ne,scheduleDestroyed:$e,toIterator:Fe,toBool:Le,getProp:Be,setProp:Re,getPath:Pe,setPath:ze,warnIfStyleNotTrusted:je,assert:Ue,deprecate:Ve}:null;return Ge=null!==t,He=(null==t?void 0:t.scheduleRevalidate)||void 0,Ne=(null==t?void 0:t.scheduleDestroy)||void 0,$e=(null==t?void 0:t.scheduleDestroyed)||void 0,Fe=(null==t?void 0:t.toIterator)||void 0,Le=(null==t?void 0:t.toBool)||void 0,Be=(null==t?void 0:t.getProp)||void 0,Re=(null==t?void 0:t.setProp)||void 0,Pe=(null==t?void 0:t.getPath)||void 0,ze=(null==t?void 0:t.setPath)||void 0,je=(null==t?void 0:t.warnIfStyleNotTrusted)||void 0,Ue=(null==t?void 0:t.assert)||void 0,Ve=(null==t?void 0:t.deprecate)||void 0,e});const Xe=Object.freeze([]);function Je(){return Xe}const Ke=Je();function Qe(){return Object.create(null)}function Ze(t){return null!=t}function tn(t){return"function"==typeof t||"object"==typeof t&&null!==t}Je();class en{constructor(t=[]){this.current=null,this.stack=t}get size(){return this.stack.length}push(t){this.current=t,this.stack.push(t)}pop(){let t=this.stack.pop(),e=this.stack.length;return this.current=0===e?null:this.stack[e-1],void 0===t?null:t}nth(t){let e=this.stack.length;return e<t?null:this.stack[e-t]}isEmpty(){return 0===this.stack.length}toArray(){return this.stack}}function nn(t){let e=t.firstChild;for(;e;){let n=e.nextSibling;t.removeChild(e),e=n}}let rn=Object.assign;const on="function"==typeof Proxy,sn="function"==typeof Symbol&&"symbol"==typeof Symbol()?Symbol:function(t){return function(t){let e={};e[t]=1;for(let n in e)if(n===t)return n;return t}(`__${t}${Math.floor(Math.random()*Date.now())}__`)};function an(t){return(t|=0)<0?function(t){return-536870913&t}(t):function(t){return~t}(t)}function ln(t){return(t|=0)>-536870913?function(t){return~t}(t):function(t){return 536870912|t}(t)}function un(t){if("number"==typeof t)return t;{let e=t.errors[0];throw new Error(`Compile Error: ${e.problem} @ ${e.span.start}..${e.span.end}`)}}function cn(t){if("error"===t.result)throw new Error(`Compile Error: ${t.problem} @ ${t.span.start}..${t.span.end}`);return t}[1,2,3].forEach((t=>t)),[1,-1].forEach((t=>ln(an(t))));const hn="function"==typeof WeakSet?WeakSet:class{constructor(){this._map=new WeakMap}add(t){return this._map.set(t,!0),this}delete(t){return this._map.delete(t)}has(t){return this._map.has(t)}};function fn(t){let e=null;if(Ie&&on){let n=e=>{throw new Error(`You accessed \`this.${String(e)}\` from a function passed to the ${t}, but the function itself was not bound to a valid \`this\` context. Consider updating to use a bound function (for instance, use an arrow function, \`() => {}\`).`)};e=new Proxy({},{get(t,e){n(e)},set:(t,e)=>(n(e),!1),has:(t,e)=>(n(e),!1)})}return e}let dn;if(Ie){let t=t=>{let e=t.name;if(void 0===e){let n=Function.prototype.toString.call(t).match(/function (\w+)\s*\(/);e=n&&n[1]||""}return e.replace(/^bound /,"")},e=e=>{let n,r;return e.constructor&&"function"==typeof e.constructor&&(r=t(e.constructor)),"toString"in e&&e.toString!==Object.prototype.toString&&e.toString!==Function.prototype.toString&&(n=e.toString()),n&&n.match(/<.*:ember\d+>/)&&r&&"_"!==r[0]&&r.length>2&&"Class"!==r?n.replace(/<.*:/,`<${r}:`):n||r},n=t=>String(t);dn=r=>"function"==typeof r?t(r)||"(unknown function)":"object"==typeof r&&null!==r?e(r)||"(unknown object)":n(r)}const pn=dn,mn="undefined"!=typeof Symbol?Symbol:t=>`__${t}${Math.floor(Math.random()*Date.now())}__`,gn="undefined"!=typeof Symbol?Symbol.for:t=>`__GLIMMER_VALIDATOR_SYMBOL_FOR_${t}`;function yn(t){if(null==t)throw new Error("Expected value to be present");return t}let bn,vn,wn,xn,_n,kn,Sn,En;if(Ie){let t=null,e=[],n={debugMessage(t,e){let n;return n="function"==typeof t?t.name:"object"==typeof t&&null!==t?`(an instance of ${t.constructor&&t.constructor.name||"(unknown class)"})`:void 0===t?"(an unknown tag)":String(t),`You attempted to update ${e?`\`${e}\` on \`${n}\``:`\`${n}\``}, but it had already been used previously in the same computation.  Attempting to update a value after using it in a computation can cause logical errors, infinite revalidation bugs, and performance issues, and is not supported.`}};_n=t=>Object.assign(n,t),bn=n=>{t=t||new WeakMap;let r=n||void 0,i=e[e.length-1]||null;e.push({parent:i,debugLabel:r})},vn=()=>{if(0===e.length)throw new Error("attempted to close a tracking transaction, but one was not open");e.pop(),0===e.length&&(t=null)},xn=()=>{let n="";return e.length>0&&(n=En(e[e.length-1])),e=[],t=null,n},wn=(t,e)=>{bn(e);let n=!0;try{let e=t();return n=!1,e}finally{!0!==n&&vn()}};let r=(t,e,n,r=-1)=>{let i=r;for(;n-- >0&&i++<t.length&&(i=t.indexOf(e,i),!(i<0)););return i},i=(t,e,r)=>{let i=[n.debugMessage(e,r&&String(r))];return i.push(`\`${String(r)}\` was first used:`),i.push(En(t)),i.push("Stack trace for the update:"),i.join("\n\n")};En=t=>{let n=[],r=t||e[e.length-1];if(void 0===r)return"";for(;r;)r.debugLabel&&n.unshift(r.debugLabel),r=r.parent;return n.map(((t,e)=>Array(2*e+1).join(" ")+t)).join("\n")},Sn=n=>{if(!t||t.has(n))return;t.set(n,e[e.length-1]);let r=n;r.subtag&&Sn(r.subtag),r.subtags&&r.subtags.forEach((t=>Sn(t)))},kn=(e,n,o)=>{if(null===t)return;let s=t.get(e);if(s)try{Ue(!1,i(s,n,o))}catch(t){if(t.stack){let e=t.stack.indexOf("Stack trace for the update:");if(-1!==e){let n=r(t.stack,"\n",1,e),i=r(t.stack,"\n",4,e);t.stack=t.stack.substr(0,n)+t.stack.substr(i)}}throw t}}}let An=1;const Cn=mn("TAG_COMPUTE");function Dn(t){return t[Cn]()}function Mn(t,e){return e>=t[Cn]()}const On=mn("TAG_TYPE");let Tn;Ie&&(Tn=new WeakMap);class In{constructor(t){this.revision=1,this.lastChecked=1,this.lastValue=1,this.isUpdating=!1,this.subtag=null,this.subtagBufferCache=null,this[On]=t}static combine(t){switch(t.length){case 0:return Ln;case 1:return t[0];default:let e=new In(2);return e.subtag=t,e}}[Cn](){let{lastChecked:t}=this;if(!0===this.isUpdating){if(Ie&&(this,void 0!==Tn&&!Tn.has(this)))throw new Error("Cycles in tags are not allowed");this.lastChecked=++An}else if(t!==An){this.isUpdating=!0,this.lastChecked=An;try{let{subtag:t,revision:e}=this;if(null!==t)if(Array.isArray(t))for(let n=0;n<t.length;n++){let r=t[n][Cn]();e=Math.max(r,e)}else{let n=t[Cn]();n===this.subtagBufferCache?e=Math.max(e,this.lastValue):(this.subtagBufferCache=null,e=Math.max(e,n))}this.lastValue=e}finally{this.isUpdating=!1}}return this.lastValue}static updateTag(t,e){if(Ie&&1!==t[On])throw new Error("Attempted to update a tag that was not updatable");let n=t,r=e;r===Ln?n.subtag=null:(n.subtagBufferCache=r[Cn](),n.subtag=r)}static dirtyTag(t,e){if(Ie&&1!==t[On]&&0!==t[On])throw new Error("Attempted to dirty a tag that was not dirtyable");Ie&&!0!==e&&yn(kn)(t),t.revision=++An,He()}}const Nn=In.dirtyTag,$n=In.updateTag;function Fn(){return new In(1)}const Ln=new In(3);new class{[Cn](){return NaN}};const Bn=new class{[Cn](){return An}},Rn=In.combine;let Pn=Fn(),zn=Fn(),jn=Fn();Dn(Pn),Nn(Pn),Dn(Pn),$n(Pn,Rn([zn,jn])),Dn(Pn),Nn(zn),Dn(Pn),Nn(jn),Dn(Pn),$n(Pn,jn),Dn(Pn),Nn(jn),Dn(Pn);const Un=new WeakMap;class Vn{constructor(){this.tags=new Set,this.last=null}add(t){t!==Ln&&(this.tags.add(t),Ie&&yn(Sn)(t),this.last=t)}combine(){let{tags:t}=this;if(0===t.size)return Ln;if(1===t.size)return this.last;{let e=[];return t.forEach((t=>e.push(t))),Rn(e)}}}let qn=null;const Wn=[];function Hn(t){Wn.push(qn),qn=new Vn,Ie&&yn(bn)(t)}function Gn(){let t=qn;if(Ie){if(0===Wn.length)throw new Error("attempted to close a tracking frame, but one was not open");yn(vn)()}return qn=Wn.pop()||null,yn(t).combine()}function Yn(){for(;Wn.length>0;)Wn.pop();if(qn=null,Ie)return yn(xn)()}function Xn(t){null!==qn&&qn.add(t)}function Jn(t,e){let n;Hn(e);try{t()}finally{n=Gn()}return n}function Kn(t){Wn.push(qn),qn=null;try{return t()}finally{!function(){if(Ie&&0===Wn.length)throw new Error("attempted to close a tracking frame, but one was not open");qn=Wn.pop()||null}()}}function Qn(t,e){let n=new WeakMap,r="function"==typeof e;return{getter:function(i){let o;return Xn(function(t,e,n){let r=void 0===n?function(t){let e=Un.get(t);return void 0===e&&(e=new Map,Un.set(t,e)),e}(t):n,i=r.get(e);return void 0===i&&(i=Fn(),r.set(e,i)),i}(i,t)),r&&!n.has(i)?(o=e.call(i),n.set(i,o)):o=n.get(i),o},setter:function(e,r){!function(t,e,n){if(Ie&&!function(t){return"object"==typeof t&&null!==t||"function"==typeof t}(t))throw new Error("BUG: Can't update a tag for a primitive");let r=Un.get(t);if(void 0===r)return;let i=r.get(e);void 0!==i&&(Ie&&yn(kn)(i,t,e),Nn(i,!0))}(e,t),n.set(e,r)}}}mn("CACHE_KEY"),mn("FN"),mn("LAST_VALUE"),mn("TAG"),mn("SNAPSHOT"),mn("DEBUG_LABEL");const Zn=gn("GLIMMER_VALIDATOR_REGISTRATION"),tr=function(){if("undefined"!=typeof globalThis)return globalThis;if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if(void 0!==n.g)return n.g;throw new Error("unable to locate global object")}();if(!0===tr[Zn])throw new Error("The `@glimmer/validator` library has been included twice in this application. It could be different versions of the package, or the same version included twice by mistake. `@glimmer/validator` depends on having a single copy of the package in use at any time in an application, even if they are the same version. You must dedupe your build to remove the duplicate packages in order to prevent this error.");tr[Zn]=!0;const er=sn("REFERENCE");class nr{constructor(t){this.tag=null,this.lastRevision=1,this.children=null,this.compute=null,this.update=null,this[er]=t}}function rr(t){let e=new nr(2);return e.tag=Ln,e.lastValue=t,Ie&&(e.debugLabel=String(t)),e}const ir=rr(void 0),or=rr(null),sr=rr(!0),ar=rr(!1);function lr(t,e){let n=new nr(0);return n.lastValue=t,n.tag=Ln,Ie&&(n.debugLabel=e),n}function ur(t,e=null,n="unknown"){let r=new nr(1);return r.compute=t,r.update=e,Ie&&(r.debugLabel=`(result of a \`${n}\` helper)`),r}function cr(t){return 3===t[er]}function hr(t){return t.tag===Ln}function fr(t){let e=t,{tag:n}=e;if(n===Ln)return e.lastValue;let r,{lastRevision:i}=e;if(null!==n&&Mn(n,i))r=e.lastValue;else{let{compute:t}=e;n=e.tag=Jn((()=>{r=e.lastValue=t()}),Ie&&e.debugLabel),e.lastRevision=Dn(n)}return Xn(n),r}function dr(t,e){(0,t.update)(e)}function pr(t,e){let n,r=t,i=r[er],o=r.children;if(null===o)o=r.children=new Map;else if(n=o.get(e),void 0!==n)return n;if(2===i){let t=fr(r);n=Ze(t)?function(t,e){let n=new nr(2);return n.lastValue=t,n.tag=Ln,Ie&&(n.debugLabel=e),n}(t[e],Ie&&`${r.debugLabel}.${e}`):ir}else n=ur((()=>{let t=fr(r);if(Ze(t))return Be(t,e)}),(t=>{let n=fr(r);if(Ze(n))return Re(n,e,t)})),Ie&&(n.debugLabel=`${r.debugLabel}.${e}`);return o.set(e,n),n}let mr;Ie&&(mr=(t,e)=>{let n=null!==e.update?t=>dr(e,t):null,r=ur((()=>fr(e)),n);return r[er]=e[er],r.debugLabel=t,r});const gr={},yr=(t,e)=>e,br=(t,e)=>String(e),vr=t=>null===t?gr:t;class wr{get weakMap(){return void 0===this._weakMap&&(this._weakMap=new WeakMap),this._weakMap}get primitiveMap(){return void 0===this._primitiveMap&&(this._primitiveMap=new Map),this._primitiveMap}set(t,e){tn(t)?this.weakMap.set(t,e):this.primitiveMap.set(t,e)}get(t){return tn(t)?this.weakMap.get(t):this.primitiveMap.get(t)}}const xr=new wr;function _r(t){let e=new wr;return(n,r)=>{let i=t(n,r),o=e.get(i)||0;return e.set(i,o+1),0===o?i:function(t,e){let n=xr.get(t);void 0===n&&(n=[],xr.set(t,n));let r=n[e];return void 0===r&&(r={value:t,count:e},n[e]=r),r}(i,o)}}function kr(t){let e=t,n=new In(0);return ur((()=>(Xn(n),e)),(t=>{e!==t&&(e=t,Nn(n))}))}class Sr{constructor(t,e){this.inner=t,this.keyFor=e}isEmpty(){return this.inner.isEmpty()}next(){let t=this.inner.next();return null!==t&&(t.key=this.keyFor(t.value,t.memo)),t}}class Er{constructor(t,e){this.iterator=t,this.keyFor=e,this.pos=0,0===t.length?this.current={kind:"empty"}:this.current={kind:"first",value:t[this.pos]}}isEmpty(){return"empty"===this.current.kind}next(){let t,e=this.current;if("first"===e.kind)this.current={kind:"progress"},t=e.value;else{if(this.pos>=this.iterator.length-1)return null;t=this.iterator[++this.pos]}let{keyFor:n}=this;return{key:n(t,this.pos),value:t,memo:this.pos}}}const Ar=2,Cr=3,Dr=4,Mr=8;function Or(t){return t<=Cr}var Tr,Ir;!function(t){t[t.s0=4]="s0",t[t.s1=5]="s1"}(Tr||(Tr={})),function(t){t[t.t0=6]="t0",t[t.t1=7]="t1"}(Ir||(Ir={}));class Nr{constructor(t){this.bucket=t?rn({},t):{}}get(t){return this.bucket[t]}set(t,e){return this.bucket[t]=e}child(){return new Nr(this.bucket)}}class $r{constructor(t,e,n,r,i){this.slots=t,this.owner=e,this.callerScope=n,this.evalScope=r,this.partialMap=i}static root(t,e=0,n){let r=new Array(e+1);for(let t=0;t<=e;t++)r[t]=ir;return new $r(r,n,null,null,null).init({self:t})}static sized(t=0,e){let n=new Array(t+1);for(let e=0;e<=t;e++)n[e]=ir;return new $r(n,e,null,null,null)}init({self:t}){return this.slots[0]=t,this}getSelf(){return this.get(0)}getSymbol(t){return this.get(t)}getBlock(t){let e=this.get(t);return e===ir?null:e}getEvalScope(){return this.evalScope}getPartialMap(){return this.partialMap}bind(t,e){this.set(t,e)}bindSelf(t){this.set(0,t)}bindSymbol(t,e){this.set(t,e)}bindBlock(t,e){this.set(t,e)}bindEvalScope(t){this.evalScope=t}bindPartialMap(t){this.partialMap=t}bindCallerScope(t){this.callerScope=t}getCallerScope(){return this.callerScope}child(){return new $r(this.slots.slice(),this.owner,this.callerScope,this.evalScope,this.partialMap)}get(t){if(t>=this.slots.length)throw new RangeError(`BUG: cannot get $${t} from scope; length=${this.slots.length}`);return this.slots[t]}set(t,e){if(t>=this.slots.length)throw new RangeError(`BUG: cannot get $${t} from scope; length=${this.slots.length}`);this.slots[t]=e}}const Fr=sn("INNER_VM"),Lr=sn("DESTROYABLE_STACK"),Br=sn("STACKS"),Rr=sn("REGISTERS"),Pr=sn("HEAP"),zr=sn("CONSTANTS"),jr=sn("ARGS");sn("PC");class Ur{constructor(t,e){this.element=t,this.nextSibling=e}}class Vr{constructor(t,e,n){this.parentNode=t,this.first=e,this.last=n}parentElement(){return this.parentNode}firstNode(){return this.first}lastNode(){return this.last}}class qr{constructor(t,e){this.parentNode=t,this.node=e}parentElement(){return this.parentNode}firstNode(){return this.node}lastNode(){return this.node}}function Wr(t,e){let n=t.parentElement(),r=t.firstNode(),i=t.lastNode(),o=r;for(;;){let t=o.nextSibling;if(n.insertBefore(o,e),o===i)return t;o=t}}function Hr(t){let e=t.parentElement(),n=t.firstNode(),r=t.lastNode(),i=n;for(;;){let t=i.nextSibling;if(e.removeChild(i),i===r)return t;i=t}}let Gr,Yr,Xr=new WeakMap;function Jr(t,e){return null===t?e:Array.isArray(t)?(t.push(e),t):[t,e]}function Kr(t,e){if(Array.isArray(t))for(let n=0;n<t.length;n++)e(t[n]);else null!==t&&e(t)}function Qr(t){let e=Xr.get(t);return void 0===e&&(e={parents:null,children:null,eagerDestructors:null,destructors:null,state:0},Ie&&(e.source=t),Xr.set(t,e)),e}function Zr(t,e){if(Ie&&ri(t))throw new Error("Attempted to associate a destroyable child with an object that is already destroying or destroyed");let n=Qr(t),r=Qr(e);return n.children=Jr(n.children,e),r.parents=Jr(r.parents,t),e}function ti(t,e,n=!1){if(Ie&&ri(t))throw new Error("Attempted to register a destructor with an object that is already destroying or destroyed");let r=Qr(t),i=!0===n?"eagerDestructors":"destructors";return r[i]=Jr(r[i],e),e}function ei(t){let e=Qr(t);if(e.state>=1)return;let{parents:n,children:r,eagerDestructors:i,destructors:o}=e;e.state=1,Kr(r,ei),Kr(i,(e=>e(t))),Kr(o,(e=>Ne(t,e))),$e((()=>{Kr(n,(e=>function(t,e){let n=Qr(e);0===n.state&&(n.children=function(t,e,n){if(Ie){let r=t===e,i=Array.isArray(t)&&-1!==t.indexOf(e);if(!r&&!i)throw new Error(String(n))}if(Array.isArray(t)&&t.length>1){let n=t.indexOf(e);return t.splice(n,1),t}return null}(n.children,t,Ie&&"attempted to remove child from parent, but the parent's children did not contain the child. This is likely a bug with destructors."))}(t,e))),e.state=2}))}function ni(t){let e=Xr.get(t);return void 0!==e&&null!==e.children}function ri(t){let e=Xr.get(t);return void 0!==e&&e.state>=1}if(Ie){let t=!1;Gr=()=>{if(t)throw Xr=new WeakMap,new Error("Attempted to start destroyable testing, but you did not end the previous destroyable test. Did you forget to call `assertDestroyablesDestroyed()`");t=!0,Xr=new Map},Yr=()=>{if(!t)throw new Error("Attempted to assert destroyables destroyed, but you did not start a destroyable test. Did you forget to call `enableDestroyableTracking()`");t=!1;let e=Xr;Xr=new WeakMap;let n=[];if(e.forEach((t=>{2!==t.state&&n.push(t.source)})),n.length>0){let t=n.map(pn).join("\n    "),e=new Error(`Some destroyables were not destroyed during this test:\n    ${t}`);throw e.destroyables=n,e}}}function ii(t){return oi(t)?"":String(t)}function oi(t){return null==t||"function"!=typeof t.toString}function si(t){return"object"==typeof t&&null!==t&&"function"==typeof t.toHTML}function ai(t){return"object"==typeof t&&null!==t&&"number"==typeof t.nodeType}function li(t){return"string"==typeof t}const ui={INPUT:{form:!0,autocorrect:!0,list:!0},SELECT:{form:!0},OPTION:{form:!0},TEXTAREA:{form:!0},LABEL:{form:!0},FIELDSET:{form:!0},LEGEND:{form:!0},OBJECT:{form:!0},OUTPUT:{form:!0},BUTTON:{form:!0}},ci=["javascript:","vbscript:"],hi=["A","BODY","LINK","IMG","IFRAME","BASE","FORM"],fi=["EMBED"],di=["href","src","background","action"],pi=["src"];function mi(t,e){return-1!==t.indexOf(e)}function gi(t,e){return(null===t||mi(hi,t))&&mi(di,e)}function yi(t,e){return null!==t&&mi(fi,t)&&mi(pi,e)}function bi(t,e){return gi(t,e)||yi(t,e)}let vi,wi;if("object"==typeof URL&&null!==URL&&"function"==typeof URL.parse){let t=URL;vi=e=>{let n=null;return"string"==typeof e&&(n=t.parse(e).protocol),null===n?":":n}}else if("function"==typeof URL)vi=t=>{try{return new URL(t).protocol}catch(t){return":"}};else{let t=document.createElement("a");vi=e=>(t.href=e,t.protocol)}function xi(t,e,n){let r=null;if(null==n)return n;if(si(n))return n.toHTML();r=t?t.tagName.toUpperCase():null;let i=ii(n);if(gi(r,e)){let t=vi(i);if(mi(ci,t))return`unsafe:${i}`}return yi(r,e)?`unsafe:${i}`:i}function _i(t,e,n,r=!1){let{tagName:i,namespaceURI:o}=t,s={element:t,name:e,namespace:n};if(Ie&&"style"===e&&!r)return new wi(s);if("http://www.w3.org/2000/svg"===o)return ki(i,e,s);let{type:a,normalized:l}=function(t,e){let n,r;if(e in t)r=e,n="prop";else{let i=e.toLowerCase();i in t?(n="prop",r=i):(n="attr",r=e)}return"prop"!==n||"style"!==r.toLowerCase()&&!function(t,e){let n=ui[t.toUpperCase()];return n&&n[e.toLowerCase()]||!1}(t.tagName,r)||(n="attr"),{normalized:r,type:n}}(t,e);return"attr"===a?ki(i,l,s):function(t,e,n){return bi(t,e)?new Ci(e,n):function(t,e){return("INPUT"===t||"TEXTAREA"===t)&&"value"===e}(t,e)?new Mi(e,n):function(t,e){return"OPTION"===t&&"selected"===e}(t,e)?new Oi(e,n):new Ai(e,n)}(i,l,s)}function ki(t,e,n){return bi(t,e)?new Di(n):new Ei(n)}class Si{constructor(t){this.attribute=t}}class Ei extends Si{set(t,e,n){let r=Ti(e);if(null!==r){let{name:e,namespace:n}=this.attribute;t.__setAttribute(e,r,n)}}update(t,e){let n=Ti(t),{element:r,name:i}=this.attribute;null===n?r.removeAttribute(i):r.setAttribute(i,n)}}class Ai extends Si{constructor(t,e){super(e),this.normalizedName=t}set(t,e,n){null!=e&&(this.value=e,t.__setProperty(this.normalizedName,e))}update(t,e){let{element:n}=this.attribute;this.value!==t&&(n[this.normalizedName]=this.value=t,null==t&&this.removeAttribute())}removeAttribute(){let{element:t,namespace:e}=this.attribute;e?t.removeAttributeNS(e,this.normalizedName):t.removeAttribute(this.normalizedName)}}class Ci extends Ai{set(t,e,n){let{element:r,name:i}=this.attribute,o=xi(r,i,e);super.set(t,o,n)}update(t,e){let{element:n,name:r}=this.attribute,i=xi(n,r,t);super.update(i,e)}}class Di extends Ei{set(t,e,n){let{element:r,name:i}=this.attribute,o=xi(r,i,e);super.set(t,o,n)}update(t,e){let{element:n,name:r}=this.attribute,i=xi(n,r,t);super.update(i,e)}}class Mi extends Ai{set(t,e){t.__setProperty("value",ii(e))}update(t){let e=this.attribute.element,n=e.value,r=ii(t);n!==r&&(e.value=r)}}class Oi extends Ai{set(t,e){null!=e&&!1!==e&&t.__setProperty("selected",!0)}update(t){this.attribute.element.selected=!!t}}function Ti(t){return!1===t||null==t||void 0===t.toString?null:!0===t?"":"function"==typeof t?null:String(t)}var Ii;Ie&&(wi=class extends Ei{set(t,e,n){je(e),super.set(t,e,n)}update(t,e){je(t),super.update(t,e)}});class Ni{constructor(t){this.node=t}firstNode(){return this.node}}class $i{constructor(t){this.node=t}lastNode(){return this.node}}const Fi=sn("CURSOR_STACK");class Li{constructor(t,e,n){this.constructing=null,this.operations=null,this[Ii]=new en,this.modifierStack=new en,this.blockStack=new en,this.pushElement(e,n),this.env=t,this.dom=t.getAppendOperations(),this.updateOperations=t.getDOM()}static forInitialRender(t,e){return new this(t,e.element,e.nextSibling).initialize()}static resume(t,e){let n=new this(t,e.parentElement(),e.reset(t)).initialize();return n.pushLiveBlock(e),n}initialize(){return this.pushSimpleBlock(),this}debugBlocks(){return this.blockStack.toArray()}get element(){return this[Fi].current.element}get nextSibling(){return this[Fi].current.nextSibling}get hasBlocks(){return this.blockStack.size>0}block(){return this.blockStack.current}popElement(){this[Fi].pop(),this[Fi].current}pushSimpleBlock(){return this.pushLiveBlock(new Bi(this.element))}pushUpdatableBlock(){return this.pushLiveBlock(new Pi(this.element))}pushBlockList(t){return this.pushLiveBlock(new zi(this.element,t))}pushLiveBlock(t,e=!1){let n=this.blockStack.current;return null!==n&&(e||n.didAppendBounds(t)),this.__openBlock(),this.blockStack.push(t),t}popBlock(){return this.block().finalize(this),this.__closeBlock(),this.blockStack.pop()}__openBlock(){}__closeBlock(){}openElement(t){let e=this.__openElement(t);return this.constructing=e,e}__openElement(t){return this.dom.createElement(t,this.element)}flushElement(t){let e=this.element,n=this.constructing;this.__flushElement(e,n),this.constructing=null,this.operations=null,this.pushModifiers(t),this.pushElement(n,null),this.didOpenElement(n)}__flushElement(t,e){this.dom.insertBefore(t,e,this.nextSibling)}closeElement(){return this.willCloseElement(),this.popElement(),this.popModifiers()}pushRemoteElement(t,e,n){return this.__pushRemoteElement(t,e,n)}__pushRemoteElement(t,e,n){if(this.pushElement(t,n),void 0===n)for(;t.lastChild;)t.removeChild(t.lastChild);let r=new Ri(t);return this.pushLiveBlock(r,!0)}popRemoteElement(){this.popBlock(),this.popElement()}pushElement(t,e=null){this[Fi].push(new Ur(t,e))}pushModifiers(t){this.modifierStack.push(t)}popModifiers(){return this.modifierStack.pop()}didAppendBounds(t){return this.block().didAppendBounds(t),t}didAppendNode(t){return this.block().didAppendNode(t),t}didOpenElement(t){return this.block().openElement(t),t}willCloseElement(){this.block().closeElement()}appendText(t){return this.didAppendNode(this.__appendText(t))}__appendText(t){let{dom:e,element:n,nextSibling:r}=this,i=e.createTextNode(t);return e.insertBefore(n,i,r),i}__appendNode(t){return this.dom.insertBefore(this.element,t,this.nextSibling),t}__appendFragment(t){let e=t.firstChild;if(e){let n=new Vr(this.element,e,t.lastChild);return this.dom.insertBefore(this.element,t,this.nextSibling),n}return new qr(this.element,this.__appendComment(""))}__appendHTML(t){return this.dom.insertHTMLBefore(this.element,this.nextSibling,t)}appendDynamicHTML(t){let e=this.trustedContent(t);this.didAppendBounds(e)}appendDynamicText(t){let e=this.untrustedContent(t);return this.didAppendNode(e),e}appendDynamicFragment(t){let e=this.__appendFragment(t);this.didAppendBounds(e)}appendDynamicNode(t){let e=this.__appendNode(t),n=new qr(this.element,e);this.didAppendBounds(n)}trustedContent(t){return this.__appendHTML(t)}untrustedContent(t){return this.__appendText(t)}appendComment(t){return this.didAppendNode(this.__appendComment(t))}__appendComment(t){let{dom:e,element:n,nextSibling:r}=this,i=e.createComment(t);return e.insertBefore(n,i,r),i}__setAttribute(t,e,n){this.dom.setAttribute(this.constructing,t,e,n)}__setProperty(t,e){this.constructing[t]=e}setStaticAttribute(t,e,n){this.__setAttribute(t,e,n)}setDynamicAttribute(t,e,n,r){let i=_i(this.constructing,t,r,n);return i.set(this,e,this.env),i}}Ii=Fi;class Bi{constructor(t){this.parent=t,this.first=null,this.last=null,this.nesting=0}parentElement(){return this.parent}firstNode(){return this.first.firstNode()}lastNode(){return this.last.lastNode()}openElement(t){this.didAppendNode(t),this.nesting++}closeElement(){this.nesting--}didAppendNode(t){0===this.nesting&&(this.first||(this.first=new Ni(t)),this.last=new $i(t))}didAppendBounds(t){0===this.nesting&&(this.first||(this.first=t),this.last=t)}finalize(t){null===this.first&&t.appendComment("")}}class Ri extends Bi{constructor(t){super(t),ti(this,(()=>{this.parentElement()===this.firstNode().parentNode&&Hr(this)}))}}class Pi extends Bi{reset(){ei(this);let t=Hr(this);return this.first=null,this.last=null,this.nesting=0,t}}class zi{constructor(t,e){this.parent=t,this.boundList=e,this.parent=t,this.boundList=e}parentElement(){return this.parent}firstNode(){return this.boundList[0].firstNode()}lastNode(){let t=this.boundList;return t[t.length-1].lastNode()}openElement(t){}closeElement(){}didAppendNode(t){}didAppendBounds(t){}finalize(t){}}function ji(t,e){return Li.forInitialRender(t,e)}const Ui=new class{constructor(){this.evaluateOpcode=function(t){let e=new Array(104);for(let t=0;t<104;t++)e[t]=null;return e}().slice()}add(t,e,n="syscall"){this.evaluateOpcode[t]={syscall:"machine"!==n,evaluate:e}}debugBefore(t,e){return{sp:void 0,pc:t.fetchValue(0),name:undefined,params:undefined,type:e.type,isMachine:e.isMachine,size:e.size,state:void 0}}debugAfter(t,e){let{sp:n,type:r,isMachine:i,pc:o}=e}evaluate(t,e,n){let r=this.evaluateOpcode[n];r.syscall?r.evaluate(t,e):r.evaluate(t[Fr],e)}};function Vi(t){return"function"!=typeof t.toString?"":String(t)}const qi=sn("TYPE"),Wi=sn("INNER"),Hi=sn("OWNER"),Gi=sn("ARGS"),Yi=sn("RESOLVED"),Xi=new hn;function Ji(t){return Xi.has(t)}function Ki(t,e){return Ji(t)&&t[qi]===e}class Qi{constructor(t,e,n,r,i=!1){Xi.add(this),this[qi]=t,this[Wi]=e,this[Hi]=n,this[Gi]=r,this[Yi]=i}}function Zi(t){let e,n,r,i,o,s=t;for(;;){let{[Gi]:t,[Wi]:a}=s;if(null!==t){let{named:r,positional:i}=t;i.length>0&&(e=void 0===e?i:i.concat(e)),void 0===n&&(n=[]),n.unshift(r)}if(!Ji(a)){r=a,i=s[Hi],o=s[Yi];break}s=a}return{definition:r,owner:i,resolved:o,positional:e,named:n}}function to(t,e,n,r,i=!1){return new Qi(t,e,n,r,i)}class eo{constructor(){this.stack=null,this.positional=new ro,this.named=new io,this.blocks=new ao}empty(t){let e=t[Rr][Cr]+1;return this.named.empty(t,e),this.positional.empty(t,e),this.blocks.empty(t,e),this}setup(t,e,n,r,i){this.stack=t;let o=this.named,s=e.length,a=t[Rr][Cr]-s+1;o.setup(t,a,s,e,i);let l=a-r;this.positional.setup(t,l,r);let u=this.blocks,c=n.length,h=l-3*c;u.setup(t,h,c,n)}get base(){return this.blocks.base}get length(){return this.positional.length+this.named.length+3*this.blocks.length}at(t){return this.positional.at(t)}realloc(t){let{stack:e}=this;if(t>0&&null!==e){let{positional:n,named:r}=this,i=n.base+t;for(let t=n.length+r.length-1;t>=0;t--)e.copy(t+n.base,t+i);n.base+=t,r.base+=t,e[Rr][Cr]+=t}}capture(){let t=0===this.positional.length?po:this.positional.capture();return{named:0===this.named.length?fo:this.named.capture(),positional:t}}clear(){let{stack:t,length:e}=this;e>0&&null!==t&&t.pop(e)}}const no=Je();class ro{constructor(){this.base=0,this.length=0,this.stack=null,this._references=null}empty(t,e){this.stack=t,this.base=e,this.length=0,this._references=no}setup(t,e,n){this.stack=t,this.base=e,this.length=n,this._references=0===n?no:null}at(t){let{base:e,length:n,stack:r}=this;return t<0||t>=n?ir:r.get(t,e)}capture(){return this.references}prepend(t){let e=t.length;if(e>0){let{base:n,length:r,stack:i}=this;this.base=n-=e,this.length=r+e;for(let r=0;r<e;r++)i.set(t[r],r,n);this._references=null}}get references(){let t=this._references;if(!t){let{stack:e,base:n,length:r}=this;t=this._references=e.slice(n,n+r)}return t}}class io{constructor(){this.base=0,this.length=0,this._references=null,this._names=Ke,this._atNames=Ke}empty(t,e){this.stack=t,this.base=e,this.length=0,this._references=no,this._names=Ke,this._atNames=Ke}setup(t,e,n,r,i){this.stack=t,this.base=e,this.length=n,0===n?(this._references=no,this._names=Ke,this._atNames=Ke):(this._references=null,i?(this._names=null,this._atNames=r):(this._names=r,this._atNames=null))}get names(){let t=this._names;return t||(t=this._names=this._atNames.map(this.toSyntheticName)),t}get atNames(){let t=this._atNames;return t||(t=this._atNames=this._names.map(this.toAtName)),t}has(t){return-1!==this.names.indexOf(t)}get(t,e=!1){let{base:n,stack:r}=this,i=(e?this.atNames:this.names).indexOf(t);if(-1===i)return ir;let o=r.get(i,n);return Ie?mr(e?t:`@${t}`,o):o}capture(){let{names:t,references:e}=this,n=Qe();for(let r=0;r<t.length;r++){let i=t[r];n[i]=Ie?mr(`@${i}`,e[r]):e[r]}return n}merge(t){let e=Object.keys(t);if(e.length>0){let{names:n,length:r,stack:i}=this,o=n.slice();for(let n=0;n<e.length;n++){let s=e[n];-1===o.indexOf(s)&&(r=o.push(s),i.push(t[s]))}this.length=r,this._references=null,this._names=o,this._atNames=null}}get references(){let t=this._references;if(!t){let{base:e,length:n,stack:r}=this;t=this._references=r.slice(e,e+n)}return t}toSyntheticName(t){return t.slice(1)}toAtName(t){return`@${t}`}}function oo(t){return`&${t}`}const so=Je();class ao{constructor(){this.internalValues=null,this._symbolNames=null,this.internalTag=null,this.names=Ke,this.length=0,this.base=0}empty(t,e){this.stack=t,this.names=Ke,this.base=e,this.length=0,this._symbolNames=null,this.internalTag=Ln,this.internalValues=so}setup(t,e,n,r){this.stack=t,this.names=r,this.base=e,this.length=n,this._symbolNames=null,0===n?(this.internalTag=Ln,this.internalValues=so):(this.internalTag=null,this.internalValues=null)}get values(){let t=this.internalValues;if(!t){let{base:e,length:n,stack:r}=this;t=this.internalValues=r.slice(e,e+3*n)}return t}has(t){return-1!==this.names.indexOf(t)}get(t){let e=this.names.indexOf(t);if(-1===e)return null;let{base:n,stack:r}=this,i=r.get(3*e,n),o=r.get(3*e+1,n),s=r.get(3*e+2,n);return null===s?null:[s,o,i]}capture(){return new lo(this.names,this.values)}get symbolNames(){let t=this._symbolNames;return null===t&&(t=this._symbolNames=this.names.map(oo)),t}}class lo{constructor(t,e){this.names=t,this.values=e,this.length=t.length}has(t){return-1!==this.names.indexOf(t)}get(t){let e=this.names.indexOf(t);return-1===e?null:[this.values[3*e+2],this.values[3*e+1],this.values[3*e]]}}function uo(t){let e=Qe();for(let n in t)e[n]=fr(t[n]);return e}function co(t){return t.map(fr)}function ho(t){return{named:uo(t.named),positional:co(t.positional)}}const fo=Object.freeze(Object.create(null)),po=no,mo=function(t,e){return{named:t,positional:e}}(fo,po);function go(t,e,n){let r=t.helper(e,null,!0);if(Ie&&null===r)throw new Error(`Expected a dynamic helper definition, but received an object or function that did not have a helper manager associated with it. The dynamic invocation was \`{{${n.debugLabel}}}\` or \`(${n.debugLabel})\`, and the incorrect definition is the value at the path \`${n.debugLabel}\`, which was: ${pn(e)}`);return t.getValue(r)}function yo(t){return t===ir}Ui.add(77,((t,{op1:e,op2:n})=>{let r=t.stack,i=r.pop(),o=r.pop(),s=t.getOwner(),a=t.runtime.resolver,l=!1;Ie&&(l=t[zr].getValue(n)),t.loadValue(Mr,function(t,e,n,r,i,o){let s,a;return ur((()=>{let l=fr(e);if(l===s)return a;if(Ki(l,t))a=r?to(t,l,n,r):r;else if(0===t&&"string"==typeof l&&l){if(Ie){if(o)throw new Error(`Attempted to resolve a dynamic component with a string definition, \`${l}\` in a strict mode template. In strict mode, using strings to resolve component definitions is prohibited. You can instead import the component definition and use it directly.`);if(!i.lookupComponent(l,n))throw new Error(`Attempted to resolve \`${l}\`, which was expected to be a component, but nothing was found.`)}a=to(t,l,n,r)}else a=tn(l)?to(t,l,n,r):null;return s=l,a}))}(e,i,s,o,a,l))})),Ui.add(107,(t=>{let e,n=t.stack,r=n.pop(),i=n.pop().capture(),o=t.getOwner(),s=ur((()=>{void 0!==e&&ei(e);let n=fr(r);if(Ki(n,1)){let{definition:o,owner:a,positional:l,named:u}=Zi(n),c=go(t[zr],o,r);void 0!==u&&(i.named=rn({},...u,i.named)),void 0!==l&&(i.positional=l.concat(i.positional)),e=c(i,a),Zr(s,e)}else if(tn(n)){let a=go(t[zr],n,r);e=a(i,o),ni(e)&&Zr(s,e)}else e=ir})),a=ur((()=>(fr(s),fr(e))));t.associateDestroyable(s),t.loadValue(Mr,a)})),Ui.add(16,((t,{op1:e})=>{let n=t.stack,r=t[zr].getValue(e)(n.pop().capture(),t.getOwner(),t.dynamicScope());ni(r)&&t.associateDestroyable(r),t.loadValue(Mr,r)})),Ui.add(21,((t,{op1:e})=>{let n=t.referenceForSymbol(e);t.stack.push(n)})),Ui.add(19,((t,{op1:e})=>{let n=t.stack.pop();t.scope().bindSymbol(e,n)})),Ui.add(20,((t,{op1:e})=>{let n=t.stack.pop(),r=t.stack.pop(),i=t.stack.pop();t.scope().bindBlock(e,[n,r,i])})),Ui.add(102,((t,{op1:e})=>{let n=t[zr].getValue(e),r=t.scope().getPartialMap()[n];void 0===r&&(r=pr(t.getSelf(),n)),t.stack.push(r)})),Ui.add(37,((t,{op1:e})=>{t.pushRootScope(e,t.getOwner())})),Ui.add(22,((t,{op1:e})=>{let n=t[zr].getValue(e),r=t.stack.pop();t.stack.push(pr(r,n))})),Ui.add(23,((t,{op1:e})=>{let{stack:n}=t,r=t.scope().getBlock(e);n.push(r)})),Ui.add(24,(t=>{let{stack:e}=t,n=e.pop();if(n&&!yo(n)){let[t,r,i]=n;e.push(i),e.push(r),e.push(t)}else e.push(null),e.push(null),e.push(null)})),Ui.add(25,(t=>{let{stack:e}=t,n=e.pop();n&&!yo(n)?e.push(sr):e.push(ar)})),Ui.add(26,(t=>{t.stack.pop(),t.stack.pop();let e=t.stack.pop(),n=e&&e.parameters.length;t.stack.push(n?sr:ar)})),Ui.add(27,((t,{op1:e})=>{let n=new Array(e);for(let r=e;r>0;r--)n[r-1]=t.stack.pop();var r;t.stack.push((r=n,ur((()=>{let t=new Array;for(let e=0;e<r.length;e++){let n=fr(r[e]);null!=n&&(t[e]=Vi(n))}return t.length>0?t.join(""):null}))))})),Ui.add(109,(t=>{let e=t.stack.pop(),n=t.stack.pop(),r=t.stack.pop();t.stack.push(ur((()=>!0===Le(fr(e))?fr(n):fr(r))))})),Ui.add(110,(t=>{let e=t.stack.pop();t.stack.push(ur((()=>!Le(fr(e)))))})),Ui.add(111,(t=>{let e=t.dynamicScope(),n=t.stack,r=n.pop();n.push(ur((()=>{let t=String(fr(r));return fr(e.get(t))})))})),Ui.add(112,(t=>{let{positional:e}=t.stack.pop().capture();t.loadValue(Mr,ur((()=>{console.log(...co(e))})))}));const bo=Ie?new hn:void 0;function vo(t){return Ie&&(bo.add(t),Object.freeze(t)),t}function wo(t){return(t.dynamicLayout?1:0)|(t.dynamicTag?2:0)|(t.prepareArgs?4:0)|(t.createArgs?8:0)|(t.attributeHook?16:0)|(t.elementHook?32:0)|(t.dynamicScope?64:0)|(t.createCaller?128:0)|(t.updateHook?256:0)|(t.createInstance?512:0)|(t.wrapped?1024:0)|(t.willDestroy?2048:0)|(t.hasSubOwner?4096:0)}function xo(t,e,n){return!!(e&n)}function _o(t,e){return!!(t&e)}const ko=new WeakMap;function So(t,e){ko.set(t,e)}function Eo(t){if("symbol"==typeof t)return null;const e=Number(t);return isNaN(e)?null:e%1==0?e:null}function Ao(t,e){return Jn((()=>{e in t&&fr(t[e])}))}function Co(t,e){return Jn((()=>{"[]"===e&&t.forEach(fr);const n=Eo(e);null!==n&&n<t.length&&fr(t[n])}))}let Do;class Mo{constructor(t){this.named=t}get(t,e){const n=this.named[e];if(void 0!==n)return fr(n)}has(t,e){return e in this.named}ownKeys(){return Object.keys(this.named)}isExtensible(){return!1}getOwnPropertyDescriptor(t,e){if(Ie&&!(e in this.named))throw new Error(`args proxies do not have real property descriptors, so you should never need to call getOwnPropertyDescriptor yourself. This code exists for enumerability, such as in for-in loops and Object.keys(). Attempted to get the descriptor for \`${String(e)}\``);return{enumerable:!0,configurable:!0}}}class Oo{constructor(t){this.positional=t}get(t,e){let{positional:n}=this;if("length"===e)return n.length;const r=Eo(e);return null!==r&&r<n.length?fr(n[r]):t[e]}isExtensible(){return!1}has(t,e){const n=Eo(e);return null!==n&&n<this.positional.length}}function To(t,e={}){if(Ie&&"3.23"!==t)throw new Error("Invalid helper manager compatibility specified");if(Ie&&(!e.hasValue&&!e.hasScheduledEffect||e.hasValue&&e.hasScheduledEffect))throw new Error("You must pass either the `hasValue` OR the `hasScheduledEffect` capability when defining a helper manager. Passing neither, or both, is not permitted.");if(Ie&&e.hasScheduledEffect)throw new Error("The `hasScheduledEffect` capability has not yet been implemented for helper managers. Please pass `hasValue` instead");return vo({hasValue:Boolean(e.hasValue),hasDestroyable:Boolean(e.hasDestroyable),hasScheduledEffect:Boolean(e.hasScheduledEffect)})}function Io(t){return t.capabilities.hasDestroyable}Do=on?(t,e)=>{const{named:n,positional:r}=t,i=new Mo(n),o=new Oo(r),s=Object.create(null);if(Ie){const t=function(t,e){throw new Error(`You attempted to set ${String(e)} on the arguments of a component, helper, or modifier. Arguments are immutable and cannot be updated directly; they always represent the values that are passed down. If you want to set default values, you should use a getter and local tracked state instead.`)},n=()=>{throw new Error(`Object.keys() was called on the positional arguments array for a ${e}, which is not supported. This function is a low-level function that should not need to be called for positional argument arrays. You may be attempting to iterate over the array using for...in instead of for...of.`)};i.set=t,o.set=t,o.ownKeys=n}const a=new Proxy(s,i),l=new Proxy([],o);return So(a,((t,e)=>Ao(n,e))),So(l,((t,e)=>Co(r,e))),{named:a,positional:l}}:(t,e)=>{const{named:n,positional:r}=t;let i={},o=[];return So(i,((t,e)=>Ao(n,e))),So(o,((t,e)=>Co(r,e))),Object.keys(n).forEach((t=>{Object.defineProperty(i,t,{enumerable:!0,configurable:!0,get:()=>fr(n[t])})})),r.forEach(((t,e)=>{Object.defineProperty(o,e,{enumerable:!0,configurable:!0,get:()=>fr(t)})})),Ie&&(Object.freeze(i),Object.freeze(o)),{named:i,positional:o}};class No{constructor(t){this.factory=t,this.helperManagerDelegates=new WeakMap,this.undefinedDelegate=null}getDelegateForOwner(t){let e=this.helperManagerDelegates.get(t);if(void 0===e){let{factory:n}=this;if(e=n(t),Ie&&!bo.has(e.capabilities))throw new Error(`Custom helper managers must have a \`capabilities\` property that is the result of calling the \`capabilities('3.23')\` (imported via \`import { capabilities } from '@ember/helper';\`). Received: \`${JSON.stringify(e.capabilities)}\` for: \`${e}\``);this.helperManagerDelegates.set(t,e)}return e}getDelegateFor(t){if(void 0===t){let{undefinedDelegate:t}=this;if(null===t){let{factory:e}=this;this.undefinedDelegate=t=e(void 0)}return t}return this.getDelegateForOwner(t)}getHelper(t){return(e,n)=>{var r,i;let o=this.getDelegateFor(n);const s=Do(e,"helper"),a=o.createHelper(t,s);if(function(t){return t.capabilities.hasValue}(o)){let e=ur((()=>o.getValue(a)),null,Ie&&o.getDebugName&&o.getDebugName(t));return Io(o)&&Zr(e,o.getDestroyable(a)),e}if(Io(o)){let e=lr(void 0,Ie&&(null!==(i=null===(r=o.getDebugName)||void 0===r?void 0:r.call(o,t))&&void 0!==i?i:"unknown helper"));return Zr(e,o.getDestroyable(a)),e}return ir}}}class $o{constructor(){this.capabilities=vo({hasValue:!0,hasDestroyable:!1,hasScheduledEffect:!1})}createHelper(t,e){return{fn:t,args:e}}getValue({fn:t,args:e}){return Object.keys(e.named).length>0?t(...e.positional,e.named):t(...e.positional)}getDebugName(t){return t.name?`(helper function ${t.name})`:"(anonymous helper function)"}}const Fo=new WeakMap,Lo=new WeakMap,Bo=new WeakMap,Ro=Object.getPrototypeOf;function Po(t,e,n){if(Ie&&("object"!=typeof n||null===n)&&"function"!=typeof n)throw new Error(`Attempted to set a manager on a non-object value. Managers can only be associated with objects or functions. Value was ${pn(n)}`);if(Ie&&t.has(n))throw new Error(`Attempted to set the same type of manager multiple times on a value. You can only associate one manager of each type with a given value. Value was ${pn(n)}`);return t.set(n,e),n}function zo(t,e){let n=e;for(;null!=n;){const e=t.get(n);if(void 0!==e)return e;n=Ro(n)}}function jo(t,e){return Po(Lo,t,e)}function Uo(t,e){return Po(Bo,t,e)}const Vo=new No((()=>new $o));function qo(t,e){return Po(Fo,t,e)}function Wo(t){return void 0!==zo(Fo,t)}function Ho(t){return void 0!==zo(Bo,t)}const Go={dynamicLayout:!1,dynamicTag:!1,prepareArgs:!1,createArgs:!0,attributeHook:!1,elementHook:!1,createCaller:!1,dynamicScope:!0,updateHook:!0,createInstance:!0,wrapped:!1,willDestroy:!1,hasSubOwner:!1};function Yo(t){return t.capabilities.asyncLifeCycleCallbacks}function Xo(t){return t.capabilities.updateHook}class Jo{constructor(t,e,n){this.component=t,this.delegate=e,this.args=n}}class Ko{constructor(t){this.factory=t,this.componentManagerDelegates=new WeakMap}getDelegateFor(t){let{componentManagerDelegates:e}=this,n=e.get(t);if(void 0===n){let{factory:r}=this;if(n=r(t),Ie&&!bo.has(n.capabilities))throw new Error(`Custom modifier managers must have a \`capabilities\` property that is the result of calling the \`capabilities('3.22')\` (imported via \`import { capabilities } from '@ember/modifier';\`). Received: \`${JSON.stringify(n.capabilities)}\` for: \`${n}\``);e.set(t,n)}return n}create(t,e,n,r){let i,o=this.getDelegateFor(t),s=Do(r,"modifier"),a=o.createModifier(n,s);return i={tag:Fn(),element:e,delegate:o,args:s,modifier:a},Ie&&(i.debugName="function"==typeof n?n.name:n.toString()),ti(i,(()=>o.destroyModifier(a,s))),i}getDebugName({debugName:t}){return t}getTag({tag:t}){return t}install({element:t,args:e,modifier:n,delegate:r}){let{capabilities:i}=r;!0===i.disableAutoTracking?Kn((()=>r.installModifier(n,t,e))):r.installModifier(n,t,e)}update({args:t,modifier:e,delegate:n}){let{capabilities:r}=n;!0===r.disableAutoTracking?Kn((()=>n.updateModifier(e,t))):n.updateModifier(e,t)}getDestroyable(t){return t}}function Qo(t,e){return jo(new Ko(t),e)}function Zo(t,e){return Uo(new No(t),e)}const ts=new WeakMap,es=Object.getPrototypeOf;function ns(t,e){if(Ie&&(null===e||"object"!=typeof e&&"function"!=typeof e))throw new Error(`Cannot call \`setComponentTemplate\` on \`${pn(e)}\``);if(Ie&&ts.has(e))throw new Error(`Cannot call \`setComponentTemplate\` multiple times on the same class (\`${pn(e)}\`)`);return ts.set(e,t),e}function rs(t){return"getDebugCustomRenderTree"in t}Ui.add(39,(t=>t.pushChildScope())),Ui.add(40,(t=>t.popScope())),Ui.add(59,(t=>t.pushDynamicScope())),Ui.add(60,(t=>t.popDynamicScope())),Ui.add(28,((t,{op1:e})=>{t.stack.push(t[zr].getValue(e))})),Ui.add(29,((t,{op1:e})=>{t.stack.push(lr(t[zr].getValue(e),!1))})),Ui.add(30,((t,{op1:e})=>{let n=t.stack;if(function(t){return t>=0}(e)){let r=t[zr].getValue(e);n.push(r)}else n.push(ln(e))})),Ui.add(31,(t=>{let e,n=t.stack,r=n.pop();e=void 0===r?ir:null===r?or:!0===r?sr:!1===r?ar:rr(r),n.push(e)})),Ui.add(33,((t,{op1:e,op2:n})=>{let r=t.fetchValue(e)-n;t.stack.dup(r)})),Ui.add(34,((t,{op1:e})=>{t.stack.pop(e)})),Ui.add(35,((t,{op1:e})=>{t.load(e)})),Ui.add(36,((t,{op1:e})=>{t.fetch(e)})),Ui.add(58,((t,{op1:e})=>{let n=t[zr].getArray(e);t.bindDynamicScope(n)})),Ui.add(69,((t,{op1:e})=>{t.enter(e)})),Ui.add(70,(t=>{t.exit()})),Ui.add(63,((t,{op1:e})=>{t.stack.push(t[zr].getValue(e))})),Ui.add(62,(t=>{t.stack.push(t.scope())})),Ui.add(61,(t=>{let e=t.stack,n=e.pop();n?e.push(t.compile(n)):e.push(null)})),Ui.add(64,(t=>{let{stack:e}=t,n=e.pop(),r=e.pop(),i=e.pop(),o=e.pop();if(null===i)return t.pushFrame(),void t.pushScope(null!=r?r:t.scope());let s=r;{let t=i.parameters,e=t.length;if(e>0){s=s.child();for(let n=0;n<e;n++)s.bindSymbol(t[n],o.at(n))}}t.pushFrame(),t.pushScope(s),t.call(n)})),Ui.add(65,((t,{op1:e})=>{let n=t.stack.pop(),r=Boolean(fr(n));hr(n)?!0===r&&t.goto(e):(!0===r&&t.goto(e),t.updateWith(new is(n)))})),Ui.add(66,((t,{op1:e})=>{let n=t.stack.pop(),r=Boolean(fr(n));hr(n)?!1===r&&t.goto(e):(!1===r&&t.goto(e),t.updateWith(new is(n)))})),Ui.add(67,((t,{op1:e,op2:n})=>{t.stack.peek()===n&&t.goto(e)})),Ui.add(68,(t=>{let e=t.stack.peek();!1===hr(e)&&t.updateWith(new is(e))})),Ui.add(71,(t=>{let{stack:e}=t,n=e.pop();e.push(ur((()=>Le(fr(n)))))}));class is{constructor(t){this.ref=t,this.last=fr(t)}evaluate(t){let{last:e,ref:n}=this;e!==fr(n)&&t.throw()}}class os{constructor(t,e){this.ref=t,this.filter=e,this.last=e(fr(t))}evaluate(t){let{last:e,ref:n,filter:r}=this;e!==r(fr(n))&&t.throw()}}class ss{constructor(){this.tag=Ln,this.lastRevision=1}finalize(t,e){this.target=e,this.didModify(t)}evaluate(t){let{tag:e,target:n,lastRevision:r}=this;!t.alwaysRevalidate&&Mn(e,r)&&(Xn(e),t.goto(n))}didModify(t){this.tag=t,this.lastRevision=Dn(this.tag),Xn(t)}}class as{constructor(t){this.debugLabel=t}evaluate(){Hn(this.debugLabel)}}class ls{constructor(t){this.target=t}evaluate(){let t=Gn();this.target.didModify(t)}}Ui.add(41,((t,{op1:e})=>{t.elements().appendText(t[zr].getValue(e))})),Ui.add(42,((t,{op1:e})=>{t.elements().appendComment(t[zr].getValue(e))})),Ui.add(48,((t,{op1:e})=>{t.elements().openElement(t[zr].getValue(e))})),Ui.add(49,(t=>{let e=fr(t.stack.pop());t.elements().openElement(e)})),Ui.add(50,(t=>{let e=t.stack.pop(),n=t.stack.pop(),r=t.stack.pop(),i=fr(e),o=fr(n),s=fr(r);hr(e)||t.updateWith(new is(e)),void 0===o||hr(n)||t.updateWith(new is(n));let a=t.elements().pushRemoteElement(i,s,o);a&&t.associateDestroyable(a)})),Ui.add(56,(t=>{t.elements().popRemoteElement()})),Ui.add(54,(t=>{let e=t.fetchValue(6),n=null;e&&(n=e.flush(t),t.loadValue(6,null)),t.elements().flushElement(n)})),Ui.add(55,(t=>{let e=t.elements().closeElement();e&&e.forEach((e=>{t.env.scheduleInstallModifier(e);let{manager:n,state:r}=e,i=n.getDestroyable(r);i&&t.associateDestroyable(i)}))})),Ui.add(57,((t,{op1:e})=>{if(!1===t.env.isInteractive)return;let n=t.getOwner(),r=t.stack.pop(),i=t[zr].getValue(e),{manager:o}=i,{constructing:s}=t.elements(),a=o.create(n,s,i.state,r.capture()),l={manager:o,state:a,definition:i};t.fetchValue(6).addModifier(l);let u=o.getTag(a);return null!==u?(Xn(u),t.updateWith(new us(u,l))):void 0})),Ui.add(108,(t=>{if(!1===t.env.isInteractive)return;let{stack:e,[zr]:n}=t,r=e.pop(),i=e.pop().capture(),{constructing:o}=t.elements(),s=t.getOwner(),a=ur((()=>{let t,e,a=fr(r);if(!tn(a))return;if(Ki(a,2)){let{definition:n,owner:r,positional:o,named:s}=Zi(a);e=n,t=r,void 0!==o&&(i.positional=o.concat(i.positional)),void 0!==s&&(i.named=rn({},...s,i.named))}else e=a,t=s;let l=n.modifier(e,null,!0);if(Ie&&null===l)throw new Error(`Expected a dynamic modifier definition, but received an object or function that did not have a modifier manager associated with it. The dynamic invocation was \`{{${r.debugLabel}}}\`, and the incorrect definition is the value at the path \`${r.debugLabel}\`, which was: ${pn(e)}`);let u=n.getValue(l),{manager:c}=u,h=c.create(t,o,u.state,i);return{manager:c,state:h,definition:u}})),l=fr(a),u=null;return void 0!==l&&(t.fetchValue(6).addModifier(l),u=l.manager.getTag(l.state),null!==u&&Xn(u)),!hr(r)||u?t.updateWith(new cs(u,l,a)):void 0}));class us{constructor(t,e){this.tag=t,this.modifier=e,this.lastUpdated=Dn(t)}evaluate(t){let{modifier:e,tag:n,lastUpdated:r}=this;Xn(n),Mn(n,r)||(t.env.scheduleUpdateModifier(e),this.lastUpdated=Dn(n))}}class cs{constructor(t,e,n){this.tag=t,this.instance=e,this.instanceRef=n,this.lastUpdated=Dn(null!=t?t:Bn)}evaluate(t){let{tag:e,lastUpdated:n,instance:r,instanceRef:i}=this,o=fr(i);if(o!==r){if(void 0!==r){let t=r.manager.getDestroyable(r.state);null!==t&&ei(t)}if(void 0!==o){let{manager:n,state:r}=o,i=n.getDestroyable(r);null!==i&&Zr(this,i),e=n.getTag(r),null!==e&&(this.lastUpdated=Dn(e)),this.tag=e,t.env.scheduleInstallModifier(o)}this.instance=o}else null===e||Mn(e,n)||(t.env.scheduleUpdateModifier(r),this.lastUpdated=Dn(e));null!==e&&Xn(e)}}Ui.add(51,((t,{op1:e,op2:n,op3:r})=>{let i=t[zr].getValue(e),o=t[zr].getValue(n),s=r?t[zr].getValue(r):null;t.elements().setStaticAttribute(i,o,s)})),Ui.add(52,((t,{op1:e,op2:n,op3:r})=>{let i=t[zr].getValue(e),o=t[zr].getValue(n),s=t.stack.pop(),a=fr(s),l=r?t[zr].getValue(r):null,u=t.elements().setDynamicAttribute(i,a,o,l);hr(s)||t.updateWith(new hs(s,u,t.env))}));class hs{constructor(t,e,n){let r=!1;this.updateRef=ur((()=>{let i=fr(t);!0===r?e.update(i,n):r=!0})),fr(this.updateRef)}evaluate(){fr(this.updateRef)}}Ui.add(78,((t,{op1:e})=>{let n=t[zr].getValue(e),{manager:r,capabilities:i}=n,o={definition:n,manager:r,capabilities:i,state:null,handle:null,table:null,lookup:null};t.stack.push(o)})),Ui.add(80,((t,{op1:e})=>{let n,r=t.stack,i=fr(r.pop()),o=t[zr],s=t.getOwner(),a=o.getValue(e);if(t.loadValue(7,null),"string"==typeof i){if(Ie&&a)throw new Error(`Attempted to resolve a dynamic component with a string definition, \`${i}\` in a strict mode template. In strict mode, using strings to resolve component definitions is prohibited. You can instead import the component definition and use it directly.`);let e=function(t,e,n,r){let i=t.lookupComponent(n,r);if(Ie&&!i)throw new Error(`Attempted to resolve \`${n}\`, which was expected to be a component, but nothing was found.`);return e.resolvedComponent(i,n)}(t.runtime.resolver,o,i,s);n=e}else n=Ji(i)?i:o.component(i,s);r.push(n)})),Ui.add(81,(t=>{let e,n=t.stack,r=n.pop(),i=fr(r),o=t[zr];if(Ie&&"function"!=typeof i&&("object"!=typeof i||null===i))throw new Error(`Expected a component definition, but received ${i}. You may have accidentally done <${r.debugLabel}>, where "${r.debugLabel}" was a string instead of a curried component definition. You must either use the component definition directly, or use the {{component}} helper to create a curried component definition when invoking dynamically.`);if(Ji(i))e=i;else if(e=o.component(i,t.getOwner(),!0),Ie&&null===e)throw new Error(`Expected a dynamic component definition, but received an object or function that did not have a component manager associated with it. The dynamic invocation was \`<${r.debugLabel}>\` or \`{{${r.debugLabel}}}\`, and the incorrect definition is the value at the path \`${r.debugLabel}\`, which was: ${pn(i)}`);n.push(e)})),Ui.add(79,(t=>{let e,n,{stack:r}=t,i=r.pop();Ji(i)?n=e=null:(n=i.manager,e=i.capabilities),r.push({definition:i,capabilities:e,manager:n,state:null,handle:null,table:null})})),Ui.add(82,((t,{op1:e,op2:n,op3:r})=>{let i=t.stack,o=t[zr].getArray(e),s=r>>4,a=8&r,l=7&r?t[zr].getArray(n):Ke;t[jr].setup(i,o,l,s,!!a),i.push(t[jr])})),Ui.add(83,(t=>{let{stack:e}=t;e.push(t[jr].empty(e))})),Ui.add(86,(t=>{let e=t.stack,n=e.pop().capture();e.push(n)})),Ui.add(85,((t,{op1:e})=>{let n=t.stack,r=t.fetchValue(e),i=n.pop(),{definition:o}=r;if(Ki(o,0)){let e=t[zr],{definition:n,owner:s,resolved:a,positional:l,named:u}=Zi(o);if(!0===a)o=n;else if("string"==typeof n){let r=t.runtime.resolver.lookupComponent(n,s);o=e.resolvedComponent(r,n)}else o=e.component(n,s);void 0!==u&&i.named.merge(rn({},...u)),void 0!==l&&(i.realloc(l.length),i.positional.prepend(l));let{manager:c}=o;r.definition=o,r.manager=c,r.capabilities=o.capabilities,t.loadValue(7,s)}let{manager:s,state:a}=o;if(!xo(0,r.capabilities,4))return void n.push(i);let l=i.blocks.values,u=i.blocks.names,c=s.prepareArgs(a,i);if(c){i.clear();for(let t=0;t<l.length;t++)n.push(l[t]);let{positional:t,named:e}=c,r=t.length;for(let e=0;e<r;e++)n.push(t[e]);let o=Object.keys(e);for(let t=0;t<o.length;t++)n.push(e[o[t]]);i.setup(n,o,u,r,!1)}n.push(i)})),Ui.add(87,((t,{op1:e,op2:n})=>{let r=t.fetchValue(n),{definition:i,manager:o,capabilities:s}=r;if(!xo(0,s,512))return;let a=null;xo(0,s,64)&&(a=t.dynamicScope());let l=1&e,u=null;xo(0,s,8)&&(u=t.stack.peek());let c=null;xo(0,s,128)&&(c=t.getSelf());let h=o.create(t.getOwner(),i.state,u,t.env,a,c,!!l);r.state=h,xo(0,s,256)&&t.updateWith(new ms(h,o,a))})),Ui.add(88,((t,{op1:e})=>{let{manager:n,state:r,capabilities:i}=t.fetchValue(e),o=n.getDestroyable(r);if(Ie&&!xo(0,i,2048)&&null!==o&&"string"in o)throw new Error("BUG: Destructor has willDestroy, but the willDestroy capability was not enabled for this component. Pre-destruction hooks must be explicitly opted into");o&&t.associateDestroyable(o)})),Ui.add(97,((t,{op1:e})=>{var n;let r;if(Ie){let{definition:i,manager:o}=t.fetchValue(e);r=null!==(n=i.resolvedName)&&void 0!==n?n:o.getDebugName(i.state)}t.beginCacheGroup(r),t.elements().pushSimpleBlock()})),Ui.add(89,(t=>{t.loadValue(6,new fs)})),Ui.add(53,((t,{op1:e,op2:n,op3:r})=>{let i=t[zr].getValue(e),o=t[zr].getValue(n),s=t.stack.pop(),a=r?t[zr].getValue(r):null;t.fetchValue(6).setAttribute(i,s,o,a)})),Ui.add(105,((t,{op1:e,op2:n,op3:r})=>{let i=t[zr].getValue(e),o=t[zr].getValue(n),s=r?t[zr].getValue(r):null;t.fetchValue(6).setStaticAttribute(i,o,s)}));class fs{constructor(){this.attributes=Qe(),this.classes=[],this.modifiers=[]}setAttribute(t,e,n,r){let i={value:e,namespace:r,trusting:n};"class"===t&&this.classes.push(e),this.attributes[t]=i}setStaticAttribute(t,e,n){let r={value:e,namespace:n};"class"===t&&this.classes.push(e),this.attributes[t]=r}addModifier(t){this.modifiers.push(t)}flush(t){let e,n=this.attributes;for(let i in this.attributes){if("type"===i){e=n[i];continue}let o=this.attributes[i];"class"===i?ds(t,"class",0===(r=this.classes).length?"":1===r.length?r[0]:function(t){for(let e=0;e<t.length;e++)if("string"!=typeof t[e])return!1;return!0}(r)?r.join(" "):function(t){return ur((()=>{let e=[];for(let n=0;n<t.length;n++){let r=t[n],i=ii("string"==typeof r?r:fr(t[n]));i&&e.push(i)}return 0===e.length?null:e.join(" ")}))}(r),o.namespace,o.trusting):ds(t,i,o.value,o.namespace,o.trusting)}var r;return void 0!==e&&ds(t,"type",e.value,e.namespace,e.trusting),this.modifiers}}function ds(t,e,n,r,i=!1){if("string"==typeof n)t.elements().setStaticAttribute(e,n,r);else{let o=t.elements().setDynamicAttribute(e,fr(n),i,r);hr(n)||t.updateWith(new hs(n,o,t.env))}}function ps(t,e,n,r,i){let o=n.table.symbols.indexOf(t),s=r.get(e);-1!==o&&i.scope().bindBlock(o+1,s),n.lookup&&(n.lookup[t]=s)}Ui.add(99,((t,{op1:e})=>{let{definition:n,state:r}=t.fetchValue(e),{manager:i}=n,o=t.fetchValue(6);i.didCreateElement(r,t.elements().constructing,o)})),Ui.add(90,((t,{op1:e,op2:n})=>{var r;let i=t.fetchValue(e),{definition:o,state:s}=i,{manager:a}=o,l=a.getSelf(s);if(void 0!==t.env.debugRenderTree){let i,o,a=t.fetchValue(e),{definition:u,manager:c}=a;if(t.stack.peek()===t[jr])i=t[jr].capture();else{let e=t[zr].getArray(n);t[jr].setup(t.stack,e,[],0,!0),i=t[jr].capture()}let h=u.compilable;if(null===h?(h=c.getDynamicLayout(s,t.runtime.resolver),o=null!==h?h.moduleName:"__default__.hbs"):o=h.moduleName,t.associateDestroyable(a),rs(c))c.getDebugCustomRenderTree(a.definition.state,a.state,i,o).forEach((e=>{let{bucket:n}=e;t.env.debugRenderTree.create(n,e),ti(a,(()=>{var e;null===(e=t.env.debugRenderTree)||void 0===e||e.willDestroy(n)})),t.updateWith(new ys(n))}));else{let e=null!==(r=u.resolvedName)&&void 0!==r?r:c.getDebugName(u.state);t.env.debugRenderTree.create(a,{type:"component",name:e,args:i,template:o,instance:fr(l)}),t.associateDestroyable(a),ti(a,(()=>{var e;null===(e=t.env.debugRenderTree)||void 0===e||e.willDestroy(a)})),t.updateWith(new ys(a))}}t.stack.push(l)})),Ui.add(91,((t,{op1:e})=>{let{definition:n,state:r}=t.fetchValue(e),{manager:i}=n,o=i.getTagName(r);t.stack.push(o)})),Ui.add(92,((t,{op1:e})=>{let n=t.fetchValue(e),{manager:r,definition:i}=n,{stack:o}=t,{compilable:s}=i;if(null===s){let{capabilities:e}=n;s=r.getDynamicLayout(n.state,t.runtime.resolver),null===s&&(s=xo(0,e,1024)?cn(t[zr].defaultTemplate).asWrappedLayout():cn(t[zr].defaultTemplate).asLayout())}let a=s.compile(t.context);o.push(s.symbolTable),o.push(a)})),Ui.add(75,((t,{op1:e})=>{let n=t.stack.pop(),r=t.stack.pop(),{manager:i,capabilities:o}=n,s={definition:n,manager:i,capabilities:o,state:null,handle:r.handle,table:r.symbolTable,lookup:null};t.loadValue(e,s)})),Ui.add(95,((t,{op1:e})=>{let{stack:n}=t,r=n.pop(),i=n.pop(),o=t.fetchValue(e);o.handle=r,o.table=i})),Ui.add(38,((t,{op1:e})=>{let n,{table:r,manager:i,capabilities:o,state:s}=t.fetchValue(e);xo(0,o,4096)?(n=i.getOwner(s),t.loadValue(7,null)):(n=t.fetchValue(7),null===n?n=t.getOwner():t.loadValue(7,null)),t.pushRootScope(r.symbols.length+1,n)})),Ui.add(94,((t,{op1:e})=>{let n=t.fetchValue(e);if(n.table.hasEval){let e=n.lookup=Qe();t.scope().bindEvalScope(e)}})),Ui.add(17,((t,{op1:e})=>{let n=t.fetchValue(e),r=t.scope(),i=t.stack.peek(),o=i.named.atNames;for(let t=o.length-1;t>=0;t--){let e=o[t],s=n.table.symbols.indexOf(o[t]),a=i.named.get(e,!0);-1!==s&&r.bindSymbol(s+1,a),n.lookup&&(n.lookup[e]=a)}})),Ui.add(18,((t,{op1:e})=>{let n=t.fetchValue(e),{blocks:r}=t.stack.peek();for(let e=0;e<r.names.length;e++)ps(r.symbolNames[e],r.names[e],n,r,t)})),Ui.add(96,((t,{op1:e})=>{let n=t.fetchValue(e);t.call(n.handle)})),Ui.add(100,((t,{op1:e})=>{let n=t.fetchValue(e),{manager:r,state:i,capabilities:o}=n,s=t.elements().popBlock();void 0!==t.env.debugRenderTree&&(rs(r)?r.getDebugCustomRenderTree(n.definition.state,i,mo).reverse().forEach((e=>{let{bucket:n}=e;t.env.debugRenderTree.didRender(n,s),t.updateWith(new bs(n,s))})):(t.env.debugRenderTree.didRender(n,s),t.updateWith(new bs(n,s)))),xo(0,o,512)&&(r.didRenderLayout(i,s),t.env.didCreate(n),t.updateWith(new gs(n,s)))})),Ui.add(98,(t=>{t.commitCacheGroup()}));class ms{constructor(t,e,n){this.component=t,this.manager=e,this.dynamicScope=n}evaluate(t){let{component:e,manager:n,dynamicScope:r}=this;n.update(e,r)}}class gs{constructor(t,e){this.component=t,this.bounds=e}evaluate(t){let{component:e,bounds:n}=this,{manager:r,state:i}=e;r.didUpdateLayout(i,n),t.env.didUpdate(e)}}class ys{constructor(t){this.bucket=t}evaluate(t){var e;null===(e=t.env.debugRenderTree)||void 0===e||e.update(this.bucket)}}class bs{constructor(t,e){this.bucket=t,this.bounds=e}evaluate(t){var e;null===(e=t.env.debugRenderTree)||void 0===e||e.didRender(this.bucket,this.bounds)}}class vs{constructor(t,e,n){this.node=t,this.reference=e,this.lastValue=n}evaluate(){let t,e=fr(this.reference),{lastValue:n}=this;e!==n&&(t=oi(e)?"":li(e)?e:String(e),t!==n)&&(this.node.nodeValue=this.lastValue=t)}}function ws(t){return function(t){return li(t)||oi(t)||"boolean"==typeof t||"number"==typeof t}(t)?2:Ki(t,0)||Wo(t)?0:Ki(t,1)||Ho(t)?1:si(t)?4:function(t){return ai(t)&&11===t.nodeType}(t)?5:ai(t)?6:2}function xs(t){if(!tn(t))return 2;if(Ki(t,0)||Wo(t))return 0;if(Ie&&!Ki(t,1)&&!Ho(t))throw new Error(`Attempted use a dynamic value as a component or helper, but that value did not have an associated component or helper manager. The value was: ${t}`);return 1}Ui.add(76,(t=>{let e=t.stack.peek();t.stack.push(ws(fr(e))),hr(e)||t.updateWith(new os(e,ws))})),Ui.add(106,(t=>{let e=t.stack.peek();t.stack.push(xs(fr(e))),hr(e)||t.updateWith(new os(e,xs))})),Ui.add(43,(t=>{let e=fr(t.stack.pop()),n=oi(e)?"":String(e);t.elements().appendDynamicHTML(n)})),Ui.add(44,(t=>{let e=fr(t.stack.pop()).toHTML(),n=oi(e)?"":e;t.elements().appendDynamicHTML(n)})),Ui.add(47,(t=>{let e=t.stack.pop(),n=fr(e),r=oi(n)?"":String(n),i=t.elements().appendDynamicText(r);hr(e)||t.updateWith(new vs(i,e,r))})),Ui.add(45,(t=>{let e=fr(t.stack.pop());t.elements().appendDynamicFragment(e)})),Ui.add(46,(t=>{let e=fr(t.stack.pop());t.elements().appendDynamicNode(e)}));let _s=function(t,e){console.info("Use `context`, and `get(<path>)` to debug this template."),e("this")};class ks{constructor(t,e,n){this.scope=t,this.locals=Qe();for(let r=0;r<n.length;r++){let i=n[r],o=e[i-1],s=t.getSymbol(i);this.locals[o]=s}}get(t){let e,{scope:n,locals:r}=this,i=t.split("."),[o,...s]=t.split("."),a=n.getEvalScope();return"this"===o?e=n.getSelf():r[o]?e=r[o]:0===o.indexOf("@")&&a[o]?e=a[o]:(e=this.scope.getSelf(),s=i),s.reduce(((t,e)=>pr(t,e)),e)}}Ui.add(103,((t,{op1:e,op2:n})=>{let r=t[zr].getArray(e),i=t[zr].getArray(n),o=new ks(t.scope(),r,i);_s(fr(t.getSelf()),(t=>fr(o.get(t))))})),Ui.add(72,((t,{op1:e,op2:n})=>{let r=t.stack,i=r.pop(),o=fr(r.pop()),s=function(t,e){return ur((()=>{let n=fr(t),r=function(t){switch(t){case"@key":return _r(yr);case"@index":return _r(br);case"@identity":return _r(vr);default:return function(t){if(Ie&&"@"===t[0])throw new Error(`invalid keypath: '${t}', valid keys: @index, @identity, or a path`);return _r((e=>Pe(e,t)))}(t)}}(e);if(Array.isArray(n))return new Er(n,r);let i=Fe(n);return null===i?new Er(Xe,(()=>null)):new Sr(i,r)}))}(i,null===o?"@identity":String(o)),a=fr(s);t.updateWith(new os(s,(t=>t.isEmpty()))),!0===a.isEmpty()?t.goto(n+1):(t.enterList(s,e),t.stack.push(a))})),Ui.add(73,(t=>{t.exitList()})),Ui.add(74,((t,{op1:e})=>{let n=t.stack.peek().next();null!==n?t.registerItem(t.enterItem(n)):t.goto(e)}));const Ss={dynamicLayout:!1,dynamicTag:!1,prepareArgs:!1,createArgs:!1,attributeHook:!1,elementHook:!1,createCaller:!1,dynamicScope:!1,updateHook:!1,createInstance:!1,wrapped:!1,willDestroy:!1,hasSubOwner:!1},Es=new class{getCapabilities(){return Ss}getDebugName({name:t}){return t}getSelf(){return or}getDestroyable(){return null}};qo(Es,class{constructor(t="@glimmer/component/template-only",e="(unknown template-only component)"){this.moduleName=t,this.name=e}toString(){return this.moduleName}}.prototype);const As={foreignObject:1,desc:1,title:1},Cs=Object.create(null);class Ds{constructor(t){this.document=t,this.setupUselessElement()}setupUselessElement(){this.uselessElement=this.document.createElement("div")}createElement(t,e){let n,r;if(e?(n="http://www.w3.org/2000/svg"===e.namespaceURI||"svg"===t,r=!!As[e.tagName]):(n="svg"===t,r=!1),n&&!r){if(Cs[t])throw new Error(`Cannot create a ${t} inside an SVG context`);return this.document.createElementNS("http://www.w3.org/2000/svg",t)}return this.document.createElement(t)}insertBefore(t,e,n){t.insertBefore(e,n)}insertHTMLBefore(t,e,n){if(""===n){let n=this.createComment("");return t.insertBefore(n,e),new Vr(t,n,n)}let r,i=e?e.previousSibling:t.lastChild;if(null===e)t.insertAdjacentHTML("beforeend",n),r=t.lastChild;else if(e instanceof HTMLElement)e.insertAdjacentHTML("beforebegin",n),r=e.previousSibling;else{let{uselessElement:i}=this;t.insertBefore(i,e),i.insertAdjacentHTML("beforebegin",n),r=i.previousSibling,t.removeChild(i)}let o=i?i.nextSibling:t.firstChild;return new Vr(t,o,r)}createTextNode(t){return this.document.createTextNode(t)}createComment(t){return this.document.createComment(t)}}function Ms(t,e,n){if(!t)return e;if(!function(t,e){let n=t.createElementNS(e,"svg");try{n.insertAdjacentHTML("beforeend","<circle></circle>")}catch(t){}finally{return 1!==n.childNodes.length||"http://www.w3.org/2000/svg"!==n.firstChild.namespaceURI}}(t,n))return e;let r=t.createElement("div");return class extends e{insertHTMLBefore(t,e,i){return""===i||t.namespaceURI!==n?super.insertHTMLBefore(t,e,i):function(t,e,n,r){let i;if("FOREIGNOBJECT"===t.tagName.toUpperCase()){let t="<svg><foreignObject>"+n+"</foreignObject></svg>";nn(e),e.insertAdjacentHTML("afterbegin",t),i=e.firstChild.firstChild}else{let t="<svg>"+n+"</svg>";nn(e),e.insertAdjacentHTML("afterbegin",t),i=e.firstChild}return function(t,e,n){let r=t.firstChild,i=r,o=r;for(;o;){let t=o.nextSibling;e.insertBefore(o,n),i=o,o=t}return new Vr(e,r,i)}(i,t,r)}(t,r,i,e)}}}function Os(t,e){return t&&function(t){let e=t.createElement("div");return e.appendChild(t.createTextNode("first")),e.insertAdjacentHTML("beforeend","second"),2!==e.childNodes.length}(t)?class extends e{constructor(t){super(t),this.uselessComment=t.createComment("")}insertHTMLBefore(t,e,n){if(""===n)return super.insertHTMLBefore(t,e,n);let r=!1,i=e?e.previousSibling:t.lastChild;i&&i instanceof Text&&(r=!0,t.insertBefore(this.uselessComment,e));let o=super.insertHTMLBefore(t,e,n);return r&&t.removeChild(this.uselessComment),o}}:e}["b","big","blockquote","body","br","center","code","dd","div","dl","dt","em","embed","h1","h2","h3","h4","h5","h6","head","hr","i","img","li","listing","main","meta","nobr","ol","p","pre","ruby","s","small","span","strong","strike","sub","sup","table","tt","u","ul","var"].forEach((t=>Cs[t]=1));let Ts="undefined"==typeof document?null:document;var Is;!function(t){class e extends Ds{createElementNS(t,e){return this.document.createElementNS(t,e)}setAttribute(t,e,n,r=null){r?t.setAttributeNS(r,e,n):t.setAttribute(e,n)}}t.TreeConstruction=e;let n=e;n=Os(Ts,n),n=Ms(Ts,n,"http://www.w3.org/2000/svg"),t.DOMTreeConstruction=n}(Is||(Is={}));class Ns extends Ds{constructor(t){super(t),this.document=t,this.namespace=null}setAttribute(t,e,n){t.setAttribute(e,n)}removeAttribute(t,e){t.removeAttribute(e)}insertAfter(t,e,n){this.insertBefore(t,e,n.nextSibling)}}let $s=Ns;$s=Os(Ts,$s),$s=Ms(Ts,$s,"http://www.w3.org/2000/svg");const Fs=Is.DOMTreeConstruction;class Ls{constructor(t){this.blocks=t,this.names=t?Object.keys(t):[]}get(t){return this.blocks&&this.blocks[t]||null}has(t){let{blocks:e}=this;return null!==e&&t in e}with(t,e){let{blocks:n}=this;return new Ls(n?rn({},n,{[t]:e}):{[t]:e})}get hasAny(){return null!==this.blocks}}const Bs=new Ls(null);function Rs(t){if(null===t)return Bs;let e=Qe(),[n,r]=t;for(let t=0;t<n.length;t++)e[n[t]]=r[t];return new Ls(e)}function Ps(t){return{type:1,value:t}}function zs(t){return{type:5,value:t}}function js(t){return{type:7,value:t}}function Us(t){return{type:8,value:t}}function Vs(t){return e=>{if(!function(t){return Array.isArray(t)&&2===t.length}(e))return!1;let n=e[0];return 31===n||32===n||n===t}}const qs=Vs(39),Ws=Vs(38),Hs=Vs(37),Gs=Vs(35);Vs(36);const Ys=Vs(34);function Xs(t){if(Ie){if(!t.upvars)throw new Error("Attempted to resolve a component, helper, or modifier, but no free vars were found");if(!t.owner)throw new Error("Attempted to resolve a component, helper, or modifier, but no owner was associated with the template it was being resolved from")}return t}function Js(t,e,n,r,i){let{upvars:o}=Xs(n),s=o[t[1]],a=e.lookupBuiltInHelper(s);if(Ie&&null===a)throw new Error(`Attempted to resolve a ${i} in a strict mode template, but that value was not in scope: ${n.upvars[t[1]]}`);return r.helper(a,s)}class Ks{constructor(){this.names={},this.funcs=[]}add(t,e){this.names[t]=this.funcs.push(e)-1}compile(t,e){let n=e[0],r=this.names[n];(0,this.funcs[r])(t,e)}}const Qs=new Ks;function Zs(t,e){if(void 0!==e&&0!==e.length)for(let n=0;n<e.length;n++)t(22,e[n])}function ta(t,e){Array.isArray(e)?Qs.compile(t,e):(sa(t,e),t(31))}function ea(t,e,n,r){if(null===e&&null===n)return void t(83);let i=na(t,e)<<4;r&&(i|=8);let o=Ke;if(n){o=n[0];let e=n[1];for(let n=0;n<e.length;n++)ta(t,e[n])}t(82,o,Ke,i)}function na(t,e){if(null===e)return 0;for(let n=0;n<e.length;n++)ta(t,e[n]);return e.length}function ra(t){var e,n;let[,r,,i]=t.block;return{evalSymbols:ia(t),upvars:i,scopeValues:null!==(n=null===(e=t.scope)||void 0===e?void 0:e.call(t))&&void 0!==n?n:null,isStrictMode:t.isStrictMode,moduleName:t.moduleName,owner:t.owner,size:r.length}}function ia(t){let{block:e}=t,[,n,r]=e;return r?n:null}function oa(t,e){sa(t,e),t(31)}function sa(t,e){let n=e;"number"==typeof n&&(n=function(t){return t%1==0&&t<=536870911&&t>=-536870912}(n)?an(n):function(t){return{type:6,value:t}}(n)),t(30,n)}function aa(t,e,n,r){t(0),ea(t,n,r,!1),t(16,e),t(1),t(36,Mr)}function la(t,e,n,r){t(0),ea(t,e,n,!1),t(33,Ar,1),t(107),r?(t(36,Mr),r(),t(1),t(34,1)):(t(1),t(34,1),t(36,Mr))}function ua(t,e,n,r,i){t(0),ea(t,r,i,!1),t(86),ta(t,n),t(77,e,{type:2,value:void 0}),t(1),t(36,Mr)}function ca(t,e,n){ea(t,n,null,!0),t(23,e),t(24),t(61),t(64),t(40),t(1)}function ha(t,e){!function(t,e){null!==e?t(63,js({parameters:e})):sa(t,null)}(t,e&&e[1]),t(62),pa(t,e)}function fa(t,e){t(0),pa(t,e),t(61),t(2),t(1)}function da(t,e,n){let r=e[1],i=r.length,o=Math.min(n,i);if(0!==o){if(t(0),o){t(39);for(let e=0;e<o;e++)t(33,Ar,n-e),t(19,r[e])}pa(t,e),t(61),t(2),o&&t(40),t(1)}else fa(t,e)}function pa(t,e){null===e?sa(t,null):t(28,function(t){return{type:4,value:t}}(e))}function ma(t,e,n){let r=[],i=0;n((function(t,e){r.push({match:t,callback:e,label:"CLAUSE"+i++})})),t(69,1),e(),t(1001);for(let e of r.slice(0,-1))t(67,Ps(e.label),e.match);for(let e=r.length-1;e>=0;e--){let n=r[e];t(1e3,n.label),t(34,1),n.callback(),0!==e&&t(4,Ps("END"))}t(1e3,"END"),t(1002),t(70)}function ga(t,e,n){t(1001),t(0),t(6,Ps("ENDINITIAL")),t(69,e()),n(),t(1e3,"FINALLY"),t(70),t(5),t(1e3,"ENDINITIAL"),t(1),t(1002)}function ya(t,e,n,r){return ga(t,e,(()=>{t(66,Ps("ELSE")),n(),t(4,Ps("FINALLY")),t(1e3,"ELSE"),void 0!==r&&r()}))}Qs.add(29,((t,[,e])=>{for(let n of e)ta(t,n);t(27,e.length)})),Qs.add(28,((t,[,e,n,r])=>{Hs(e)?t(1005,e,(e=>{aa(t,e,n,r)})):(ta(t,e),la(t,n,r))})),Qs.add(50,((t,[,e,n,r,i])=>{ua(t,n,e,r,i)})),Qs.add(30,((t,[,e,n])=>{t(21,e),Zs(t,n)})),Qs.add(32,((t,[,e,n])=>{t(1011,e,(e=>{t(29,e),Zs(t,n)}))})),Qs.add(31,((t,[,e,n])=>{t(1009,e,(t=>{}))})),Qs.add(34,(()=>{throw new Error("unimplemented opcode")})),Qs.add(36,((t,e)=>{t(1010,e[1],(n=>{t(1006,e,{ifHelper:e=>{aa(t,e,null,null)}})}))})),Qs.add(99,((t,e)=>{t(1010,e[1],(n=>{t(1006,e,{ifHelper:(n,r,i)=>{Ue(e[2]&&1===e[2].length,"[BUG] Missing argument name");let o=e[2][0];Ve(`The \`${r}\` helper was used in the \`${i}\` template as \`${o}={{${r}}}\`. This is ambigious between wanting the \`${o}\` argument to be the \`${r}\` helper itself, or the result of invoking the \`${r}\` helper (current behavior). This implicit invocation behavior has been deprecated.\n\nInstead, please explicitly invoke the helper with parenthesis, i.e. \`${o}={{(${r})}}\`.\n\nNote: the parenthesis are only required in this exact scenario where an ambiguity is present â€“ where \`${r}\` referes to a global helper (as opposed to a local variable), AND the \`${r}\` helper invocation does not take any arguments, AND this occurs in a named argument position of a component invocation.\n\nWe expect this combination to be quite rare, as most helpers require at least one argument. There is no need to refactor helper invocations in cases where this deprecation was not triggered.`,!1,{id:"argument-less-helper-paren-less-invocation"}),aa(t,n,null,null)}})}))})),Qs.add(27,(t=>oa(t,void 0))),Qs.add(48,((t,[,e])=>{ta(t,e),t(25)})),Qs.add(49,((t,[,e])=>{ta(t,e),t(24),t(61),t(26)})),Qs.add(52,((t,[,e,n,r])=>{ta(t,r),ta(t,n),ta(t,e),t(109)})),Qs.add(51,((t,[,e])=>{ta(t,e),t(110)})),Qs.add(53,((t,[,e])=>{ta(t,e),t(111)})),Qs.add(54,((t,[,e])=>{t(0),ea(t,e,null,!1),t(112),t(1),t(36,Mr)}));const ba="&attrs";function va(t,e,n,r,i,o){let{compilable:s,capabilities:a,handle:l}=e,u=n?[n,[]]:null,c=Array.isArray(o)||null===o?Rs(o):o;s?(t(78,l),function(t,{capabilities:e,layout:n,elementBlock:r,positional:i,named:o,blocks:s}){let{symbolTable:a}=n;if(a.hasEval||_o(e,4))return void xa(t,{capabilities:e,elementBlock:r,positional:i,named:o,atNames:!0,blocks:s,layout:n});t(36,Dr),t(33,Cr,1),t(35,Dr),t(0);let{symbols:l}=a,u=[],c=[],h=[],f=s.names;if(null!==r){let e=l.indexOf(ba);-1!==e&&(ha(t,r),u.push(e))}for(let e=0;e<f.length;e++){let n=f[e],r=l.indexOf(`&${n}`);-1!==r&&(ha(t,s.get(n)),u.push(r))}if(_o(e,8)){let e=na(t,i)<<4;e|=8;let n=Ke;if(null!==o){n=o[0];let e=o[1];for(let r=0;r<e.length;r++){let i=l.indexOf(n[r]);ta(t,e[r]),c.push(i)}}t(82,n,Ke,e),c.push(-1)}else if(null!==o){let e=o[0],n=o[1];for(let r=0;r<n.length;r++){let i=e[r],o=l.indexOf(i);-1!==o&&(ta(t,n[r]),c.push(o),h.push(i))}}t(97,Dr),_o(e,64)&&t(59),_o(e,512)&&t(87,0|s.has("default"),Dr),t(88,Dr),_o(e,8)?t(90,Dr):t(90,Dr,h),t(37,l.length+1,Object.keys(s).length>0?1:0),t(19,0);for(let e=c.length-1;e>=0;e--){let n=c[e];-1===n?t(34,1):t(19,n+1)}null!==i&&t(34,i.length);for(let e=u.length-1;e>=0;e--)t(20,u[e]+1);t(28,Us(n)),t(61),t(2),t(100,Dr),t(1),t(40),_o(e,64)&&t(60),t(98),t(35,Dr)}(t,{capabilities:a,layout:s,elementBlock:u,positional:r,named:i,blocks:c})):(t(78,l),xa(t,{capabilities:a,elementBlock:u,positional:r,named:i,atNames:!0,blocks:c}))}function wa(t,e,n,r,i,o,s,a){let l=n?[n,[]]:null,u=Array.isArray(o)||null===o?Rs(o):o;ga(t,(()=>(ta(t,e),t(33,Cr,0),2)),(()=>{t(66,Ps("ELSE")),a?t(81):t(80,{type:2,value:void 0}),t(79),xa(t,{capabilities:!0,elementBlock:l,positional:r,named:i,atNames:s,blocks:u}),t(1e3,"ELSE")}))}function xa(t,{capabilities:e,elementBlock:n,positional:r,named:i,atNames:o,blocks:s,layout:a}){let l=!!s,u=!0===e||_o(e,4)||!(!i||0===i[0].length),c=s.with("attrs",n);t(36,Dr),t(33,Cr,1),t(35,Dr),t(0),function(t,e,n,r,i){let o=r.names;for(let e=0;e<o.length;e++)ha(t,r.get(o[e]));let s=na(t,e)<<4;i&&(s|=8),r&&(s|=7);let a=Xe;if(n){a=n[0];let e=n[1];for(let n=0;n<e.length;n++)ta(t,e[n])}t(82,a,o,s)}(t,r,i,c,o),t(85,Dr),_a(t,c.has("default"),l,u,(()=>{a?(t(63,js(a.symbolTable)),t(28,Us(a)),t(61)):t(92,Dr),t(95,Dr)})),t(35,Dr)}function _a(t,e,n,r,i=null){t(97,Dr),t(59),t(87,0|e,Dr),i&&i(),t(88,Dr),t(90,Dr),t(38,Dr),t(19,0),t(94,Dr),r&&t(17,Dr),n&&t(18,Dr),t(34,1),t(96,Dr),t(100,Dr),t(1),t(40),t(60),t(98)}class ka{constructor(t,e,n,r,i){this.main=t,this.trustingGuardedAppend=e,this.cautiousGuardedAppend=n,this.trustingNonDynamicAppend=r,this.cautiousNonDynamicAppend=i}get"trusting-append"(){return this.trustingGuardedAppend}get"cautious-append"(){return this.cautiousGuardedAppend}get"trusting-non-dynamic-append"(){return this.trustingNonDynamicAppend}get"cautious-non-dynamic-append"(){return this.cautiousNonDynamicAppend}getAppend(t){return t?this.trustingGuardedAppend:this.cautiousGuardedAppend}}class Sa{constructor(t){this.buffer=t,this.size=0}encode(t,e){if(t>255)throw new Error(`Opcode type over 8-bits. Got ${t}.`);let n=t|e|arguments.length-2<<8;this.buffer.push(n);for(let t=2;t<arguments.length;t++){let e=arguments[t];if(Ie&&"number"==typeof e&&e>2147483647)throw new Error(`Operand over 32-bits. Got ${e}.`);this.buffer.push(e)}this.size=this.buffer.length}patch(t,e){if(-1!==this.buffer[t+1])throw new Error("Trying to patch operand in populated slot instead of a reserved slot.");this.buffer[t+1]=e}}function Ea(t,e){return{program:t,encoder:new Fa(t.heap,e,t.stdlib),meta:e}}const Aa=new Ks,Ca=["class","id","value","name","type","style","href"],Da=["div","span","p","a"];function Ma(t){return"string"==typeof t?t:Da[t]}function Oa(t){return"string"==typeof t?t:Ca[t]}function Ta(t){if(null===t)return null;let e=t[0].map((t=>`@${t}`));return[e,t[1]]}Aa.add(3,((t,e)=>t(42,e[1]))),Aa.add(13,(t=>t(55))),Aa.add(12,(t=>t(54))),Aa.add(4,((t,[,e,n,r])=>{Ws(e)?t(1003,e,(e=>{t(0),ea(t,n,r,!1),t(57,e),t(1)})):(ta(t,e),t(0),ea(t,n,r,!1),t(33,Ar,1),t(108),t(1))})),Aa.add(14,((t,[,e,n,r])=>{t(51,Oa(e),n,null!=r?r:null)})),Aa.add(24,((t,[,e,n,r])=>{t(105,Oa(e),n,null!=r?r:null)})),Aa.add(15,((t,[,e,n,r])=>{ta(t,n),t(52,Oa(e),!1,null!=r?r:null)})),Aa.add(22,((t,[,e,n,r])=>{ta(t,n),t(52,Oa(e),!0,null!=r?r:null)})),Aa.add(16,((t,[,e,n,r])=>{ta(t,n),t(53,Oa(e),!1,null!=r?r:null)})),Aa.add(23,((t,[,e,n,r])=>{ta(t,n),t(53,Oa(e),!0,null!=r?r:null)})),Aa.add(10,((t,[,e])=>{t(48,Ma(e))})),Aa.add(11,((t,[,e])=>{t(89),t(48,Ma(e))})),Aa.add(8,((t,[,e,n,r,i])=>{qs(e)?t(1004,e,(e=>{va(t,e,n,null,r,i)})):wa(t,e,n,null,r,i,!0,!0)})),Aa.add(18,((t,[,e,n])=>ca(t,e,n))),Aa.add(17,((t,[,e])=>ca(t,e,null))),Aa.add(26,((t,[,e])=>t(103,{type:3,value:void 0},e))),Aa.add(1,((t,[,e])=>{if(Array.isArray(e))if(Ys(e))t(1008,e,{ifComponent(e){va(t,e,null,null,null,null)},ifHelper(e){t(0),aa(t,e,null,null),t(3,zs("cautious-non-dynamic-append")),t(1)},ifValue(e){t(0),t(29,e),t(3,zs("cautious-non-dynamic-append")),t(1)}});else if(28===e[0]){let[,n,r,i]=e;Gs(n)?t(1007,n,{ifComponent(e){va(t,e,null,r,Ta(i),null)},ifHelper(e){t(0),aa(t,e,r,i),t(3,zs("cautious-non-dynamic-append")),t(1)}}):ma(t,(()=>{ta(t,n),t(106)}),(e=>{e(0,(()=>{t(81),t(79),xa(t,{capabilities:!0,elementBlock:null,positional:r,named:i,atNames:!1,blocks:Rs(null)})})),e(1,(()=>{la(t,r,i,(()=>{t(3,zs("cautious-non-dynamic-append"))}))}))}))}else t(0),ta(t,e),t(3,zs("cautious-append")),t(1);else t(41,null==e?"":String(e))})),Aa.add(2,((t,[,e])=>{Array.isArray(e)?(t(0),ta(t,e),t(3,zs("trusting-append")),t(1)):t(41,null==e?"":String(e))})),Aa.add(6,((t,[,e,n,r,i])=>{qs(e)?t(1004,e,(e=>{va(t,e,null,n,Ta(r),i)})):wa(t,e,null,n,r,i,!1,!1)})),Aa.add(40,((t,[,e,n,r,i])=>{ya(t,(()=>(ta(t,n),void 0===i?oa(t,void 0):ta(t,i),ta(t,r),t(33,Cr,0),4)),(()=>{t(50),fa(t,e),t(56)}))})),Aa.add(41,((t,[,e,n,r])=>ya(t,(()=>(ta(t,e),t(71),1)),(()=>{fa(t,n)}),r?()=>{fa(t,r)}:void 0))),Aa.add(42,((t,[,e,n,r,i])=>ga(t,(()=>(n?ta(t,n):oa(t,null),ta(t,e),2)),(()=>{t(72,Ps("BODY"),Ps("ELSE")),t(0),t(33,Ar,1),t(6,Ps("ITER")),t(1e3,"ITER"),t(74,Ps("BREAK")),t(1e3,"BODY"),da(t,r,2),t(34,2),t(4,Ps("FINALLY")),t(1e3,"BREAK"),t(1),t(73),t(4,Ps("FINALLY")),t(1e3,"ELSE"),i&&fa(t,i)})))),Aa.add(43,((t,[,e,n,r])=>{ya(t,(()=>(ta(t,e),t(33,Cr,0),t(71),2)),(()=>{da(t,n,1)}),(()=>{r&&fa(t,r)}))})),Aa.add(44,((t,[,e,n])=>{da(t,n,na(t,e))})),Aa.add(45,((t,[,e,n])=>{if(e){let[r,i]=e;na(t,i),function(t,e,n){t(59),t(58,e),n(),t(60)}(t,r,(()=>{fa(t,n)}))}else fa(t,n)})),Aa.add(46,((t,[,e,n,r,i])=>{qs(e)?t(1004,e,(e=>{va(t,e,null,n,Ta(r),i)})):wa(t,e,null,n,r,i,!1,!1)}));class Ia{constructor(t,e,n,r="plain block"){this.statements=t,this.meta=e,this.symbolTable=n,this.moduleName=r,this.compiled=null}compile(t){return function(t,e){if(null!==t.compiled)return t.compiled;t.compiled=-1;let{statements:n,meta:r}=t,i=function(t,e,n){let r=Aa,i=Ea(n,e),{encoder:o,program:{constants:s,resolver:a}}=i;function l(...t){$a(o,s,a,e,t)}for(let e=0;e<t.length;e++)r.compile(l,t[e]);return i.encoder.commit(e.size)}(n,r,e);return t.compiled=i,i}(this,t)}}class Na{constructor(){this.labels=Qe(),this.targets=[]}label(t,e){this.labels[t]=e}target(t,e){this.targets.push({at:t,target:e})}patch(t){let{targets:e,labels:n}=this;for(let r=0;r<e.length;r++){let{at:i,target:o}=e[r],s=n[o]-i;t.setbyaddr(i,s)}}}function $a(t,e,n,r,i){if(function(t){return t<1e3}(i[0])){let[n,...r]=i;t.push(e,n,...r)}else switch(i[0]){case 1e3:return t.label(i[1]);case 1001:return t.startLabels();case 1002:return t.stopLabels();case 1004:return function(t,e,n,[,r,i]){let o=r[0];if(Ie&&31===r[0])throw new Error(`Attempted to resolve a component in a strict mode template, but that value was not in scope: ${n.upvars[r[1]]}`);if(32===o){let{scopeValues:t,owner:o}=n,s=t[r[1]];i(e.component(s,o))}else{let{upvars:o,owner:s}=Xs(n),a=o[r[1]],l=t.lookupComponent(a,s);if(Ie&&("object"!=typeof l||null===l))throw new Error(`Attempted to resolve \`${a}\`, which was expected to be a component, but nothing was found.`);i(e.resolvedComponent(l,a))}}(n,e,r,i);case 1003:return function(t,e,n,[,r,i]){let o=r[0];if(32===o){let{scopeValues:t}=n,o=t[r[1]];i(e.modifier(o))}else if(31===o){let{upvars:o}=Xs(n),s=o[r[1]],a=t.lookupBuiltInModifier(s);if(Ie&&null===a)throw new Error(`Attempted to resolve a modifier in a strict mode template, but it was not in scope: ${s}`);i(e.modifier(a,s))}else{let{upvars:o,owner:s}=Xs(n),a=o[r[1]],l=t.lookupModifier(a,s);if(Ie&&null===l)throw new Error(`Attempted to resolve \`${a}\`, which was expected to be a modifier, but nothing was found.`);i(e.modifier(l,a))}}(n,e,r,i);case 1005:return function(t,e,n,[,r,i]){let o=r[0];if(32===o){let{scopeValues:t}=n,o=t[r[1]];i(e.helper(o))}else if(31===o)i(Js(r,t,n,e,"helper"));else{let{upvars:o,owner:s}=Xs(n),a=o[r[1]],l=t.lookupHelper(a,s);if(Ie&&null===l)throw new Error(`Attempted to resolve \`${a}\`, which was expected to be a helper, but nothing was found.`);i(e.helper(l,a))}}(n,e,r,i);case 1007:return function(t,e,n,[,r,{ifComponent:i,ifHelper:o}]){let s=r[0];if(32===s){let{scopeValues:t,owner:s}=n,a=t[r[1]],l=e.component(a,s,!0);if(null!==l)return void i(l);let u=e.helper(a,null,!0);if(Ie&&null===u)throw new Error(`Attempted to use a value as either a component or helper, but it did not have a component manager or helper manager associated with it. The value was: ${pn(a)}`);o(u)}else if(31===s)o(Js(r,t,n,e,"component or helper"));else{let{upvars:s,owner:a}=Xs(n),l=s[r[1]],u=t.lookupComponent(l,a);if(null!==u)i(e.resolvedComponent(u,l));else{let n=t.lookupHelper(l,a);if(Ie&&null===n)throw new Error(`Attempted to resolve \`${l}\`, which was expected to be a component or helper, but nothing was found.`);o(e.helper(n,l))}}}(n,e,r,i);case 1006:return function(t,e,n,[,r,{ifHelper:i}]){let{upvars:o,owner:s}=Xs(n),a=o[r[1]],l=t.lookupHelper(a,s);l&&i(e.helper(l,a),a,n.moduleName)}(n,e,r,i);case 1008:return function(t,e,n,[,r,{ifComponent:i,ifHelper:o,ifValue:s}]){let a=r[0];if(32===a){let{scopeValues:t,owner:a}=n,l=t[r[1]];if("function"!=typeof l&&("object"!=typeof l||null===l))return void s(e.value(l));let u=e.component(l,a,!0);if(null!==u)return void i(u);let c=e.helper(l,null,!0);if(null!==c)return void o(c);s(e.value(l))}else if(31===a)o(Js(r,t,n,e,"value"));else{let{upvars:s,owner:a}=Xs(n),l=s[r[1]],u=t.lookupComponent(l,a);if(null!==u)return void i(e.resolvedComponent(u,l));let c=t.lookupHelper(l,a);null!==c&&o(e.helper(c,l))}}(n,e,r,i);case 1010:let o=i[1],s=r.upvars[o];(0,i[2])(s,r.moduleName);break;case 1011:let[,a,l]=i,u=r.scopeValues[a];l(e.value(u));break;case 1009:if(Ie){let[,t]=i,e=r.upvars[t];throw new Error(`Attempted to resolve a value in a strict mode template, but that value was not in scope: ${e}`)}break;default:throw new Error(`Unexpected high level opcode ${i[0]}`)}}class Fa{constructor(t,e,n){this.heap=t,this.meta=e,this.stdlib=n,this.labelsStack=new en,this.encoder=new Sa([]),this.errors=[],this.handle=t.malloc()}error(t){this.encoder.encode(30,0),this.errors.push(t)}commit(t){let e=this.handle;return this.heap.push(1029),this.heap.finishMalloc(e,t),this.errors.length?{errors:this.errors,handle:e}:e}push(t,e,...n){let{heap:r}=this;if(Ie&&e>255)throw new Error(`Opcode type over 8-bits. Got ${e}.`);let i=function(t){return t>=0&&t<=15}(e)?1024:0,o=e|i|n.length<<8;r.push(o);for(let e=0;e<n.length;e++){let i=n[e];r.push(this.operand(t,i))}}operand(t,e){if("number"==typeof e)return e;if("object"==typeof e&&null!==e){if(Array.isArray(e))return t.array(e);switch(e.type){case 1:return this.currentLabels.target(this.heap.offset,e.value),-1;case 2:return t.value(this.meta.isStrictMode);case 3:return t.array(this.meta.evalSymbols||Ke);case 4:return t.value((n=e.value,r=this.meta,new Ia(n[0],r,{parameters:n[1]||Xe})));case 5:return this.stdlib[e.value];case 6:case 7:case 8:return t.value(e.value)}}var n,r;return t.value(e)}get currentLabels(){return this.labelsStack.current}label(t){this.currentLabels.label(t,this.heap.offset+1)}startLabels(){this.labelsStack.push(new Na)}stopLabels(){this.labelsStack.pop().patch(this.heap)}}function La(t,e,n){ma(t,(()=>t(76)),(r=>{r(2,(()=>{e?(t(68),t(43)):t(47)})),"number"==typeof n?(r(0,(()=>{t(81),t(79),function(t){t(36,Dr),t(33,Cr,1),t(35,Dr),t(0),t(83),t(85,Dr),_a(t,!1,!1,!0,(()=>{t(92,Dr),t(95,Dr)})),t(35,Dr)}(t)})),r(1,(()=>{la(t,null,null,(()=>{t(3,n)}))}))):(r(0,(()=>{t(47)})),r(1,(()=>{t(47)}))),r(4,(()=>{t(68),t(44)})),r(5,(()=>{t(68),t(45)})),r(6,(()=>{t(68),t(46)}))}))}const Ba={evalSymbols:null,upvars:null,moduleName:"stdlib",scopeValues:null,isStrictMode:!0,owner:null,size:0};function Ra(t,e){let{constants:n,heap:r,resolver:i}=t,o=new Fa(r,Ba);e((function(...t){$a(o,n,i,Ba,t)}));let s=o.commit(0);if("number"!=typeof s)throw new Error("Unexpected errors compiling std");return s}class Pa{constructor({constants:t,heap:e},n){this.resolver=n,this.constants=t,this.heap=e,this.stdlib=function(t){let e=Ra(t,(t=>function(t){t(75,Dr),_a(t,!1,!1,!0)}(t))),n=Ra(t,(t=>La(t,!0,null))),r=Ra(t,(t=>La(t,!1,null))),i=Ra(t,(t=>La(t,!0,n))),o=Ra(t,(t=>La(t,!1,r)));return new ka(e,i,o,n,r)}(this)}}class za{constructor(t,e){this.layout=t,this.moduleName=e,this.compiled=null;let{block:n}=t,[,r,i]=n;r=r.slice();let o=r.indexOf(ba);this.attrsBlockNumber=-1===o?r.push(ba):o+1,this.symbolTable={hasEval:i,symbols:r}}compile(t){if(null!==this.compiled)return this.compiled;let e=ra(this.layout),n=Ea(t,e),{encoder:r,program:{constants:i,resolver:o}}=n;var s,a,l;s=function(...t){$a(r,i,o,e,t)},a=this.layout,l=this.attrsBlockNumber,s(1001),function(t,e,n){t(36,5),n(),t(35,5)}(s,0,(()=>{s(91,Dr),s(31),s(33,Cr,0)})),s(66,Ps("BODY")),s(36,5),s(89),s(49),s(99,Dr),ca(s,l,null),s(54),s(1e3,"BODY"),fa(s,[a.block[0],[]]),s(36,5),s(66,Ps("END")),s(55),s(1e3,"END"),s(35,5),s(1002);let u=n.encoder.commit(e.size);return"number"!=typeof u||(this.compiled=u),u}}let ja=0,Ua={cacheHit:0,cacheMiss:0};function Va({id:t,moduleName:e,block:n,scope:r,isStrictMode:i}){let o,s=t||"client-"+ja++,a=null,l=new WeakMap,u=t=>{if(void 0===o&&(o=JSON.parse(n)),void 0===t)return null===a?(Ua.cacheMiss++,a=new qa({id:s,block:o,moduleName:e,owner:null,scope:r,isStrictMode:i})):Ua.cacheHit++,a;let u=l.get(t);return void 0===u?(Ua.cacheMiss++,u=new qa({id:s,block:o,moduleName:e,owner:t,scope:r,isStrictMode:i}),l.set(t,u)):Ua.cacheHit++,u};return u.__id=s,u.__meta={moduleName:e},u}class qa{constructor(t){this.parsedLayout=t,this.result="ok",this.layout=null,this.wrappedLayout=null}get moduleName(){return this.parsedLayout.moduleName}get id(){return this.parsedLayout.id}get referrer(){return{moduleName:this.parsedLayout.moduleName,owner:this.parsedLayout.owner}}asLayout(){return this.layout?this.layout:this.layout=function(t,e){let[n,r,i]=t.block;return new Ia(n,ra(t),{symbols:r,hasEval:i},e)}(rn({},this.parsedLayout),this.moduleName)}asWrappedLayout(){return this.wrappedLayout?this.wrappedLayout:this.wrappedLayout=new za(rn({},this.parsedLayout),this.moduleName)}}const Wa={id:"1b32f5c2-7623-43d6-a0ad-9672898920a1",moduleName:"__default__.hbs",block:JSON.stringify([[[18,1,null]],["&default"],!1,[]]),scope:null,isStrictMode:!0},Ha=Object.freeze([]),Ga=function(...t){return[!1,!0,null,void 0,...t]}(Ha),Ya=Ga.indexOf(Ha);class Xa{constructor(){this.values=Ga.slice(),this.indexMap=new Map(this.values.map(((t,e)=>[t,e])))}value(t){let e=this.indexMap,n=e.get(t);return void 0===n&&(n=this.values.push(t)-1,e.set(t,n)),n}array(t){if(0===t.length)return Ya;let e=new Array(t.length);for(let n=0;n<t.length;n++)e[n]=this.value(t[n]);return this.value(e)}toPool(){return this.values}}class Ja{constructor(t){this.heap=t,this.offset=0}get size(){return 1+((768&this.heap.getbyaddr(this.offset))>>8)}get isMachine(){return 1024&this.heap.getbyaddr(this.offset)?1:0}get type(){return 255&this.heap.getbyaddr(this.offset)}get op1(){return this.heap.getbyaddr(this.offset+1)}get op2(){return this.heap.getbyaddr(this.offset+2)}get op3(){return this.heap.getbyaddr(this.offset+3)}}const Ka=1048576;class Qa{constructor(t,e){this.constants=t,this.heap=e,this._opcode=new Ja(this.heap)}opcode(t){return this._opcode.offset=t,this._opcode}}let Za=0;class tl{constructor(t){this.id=Za++,this.value=t}get(){return this.value}release(){if(Ie&&null===this.value)throw new Error("BUG: double release?");this.value=null}toString(){let t=`Ref ${this.id}`;if(null===this.value)return`${t} (released)`;try{return`${t}: ${this.value}`}catch(e){return t}}}class el{constructor(){this.stack=new en,this.refs=new WeakMap,this.roots=new Set,this.nodes=new WeakMap}begin(){this.reset()}create(t,e){let n=rn({},e,{bounds:null,refs:new Set});this.nodes.set(t,n),this.appendChild(n,t),this.enter(t)}update(t){this.enter(t)}didRender(t,e){if(Ie&&this.stack.current!==t)throw new Error(`BUG: expecting ${this.stack.current}, got ${t}`);this.nodeFor(t).bounds=e,this.exit()}willDestroy(t){this.refs.get(t).release()}commit(){this.reset()}capture(){return this.captureRefs(this.roots)}reset(){if(0!==this.stack.size){let t=this.stack.toArray()[0],e=this.refs.get(t);for(void 0!==e&&this.roots.delete(e);!this.stack.isEmpty();)this.stack.pop()}}enter(t){this.stack.push(t)}exit(){if(Ie&&0===this.stack.size)throw new Error("BUG: unbalanced pop");this.stack.pop()}nodeFor(t){return this.nodes.get(t)}appendChild(t,e){if(Ie&&this.refs.has(e))throw new Error("BUG: child already appended");let n=this.stack.current,r=new tl(e);if(this.refs.set(e,r),n){let e=this.nodeFor(n);e.refs.add(r),t.parent=e}else this.roots.add(r)}captureRefs(t){let e=[];return t.forEach((n=>{let r=n.get();r?e.push(this.captureNode(`render-node:${n.id}`,r)):t.delete(n)})),e}captureNode(t,e){let n=this.nodeFor(e),{type:r,name:i,args:o,instance:s,refs:a}=n,l=this.captureTemplate(n),u=this.captureBounds(n),c=this.captureRefs(a);return{id:t,type:r,name:i,args:ho(o),instance:s,template:l,bounds:u,children:c}}captureTemplate({template:t}){return t||null}captureBounds(t){let e=t.bounds;return{parentElement:e.parentElement(),firstNode:e.firstNode(),lastNode:e.lastNode()}}}var nl;const rl=sn("TRANSACTION");class il{constructor(){this.scheduledInstallModifiers=[],this.scheduledUpdateModifiers=[],this.createdComponents=[],this.updatedComponents=[]}didCreate(t){this.createdComponents.push(t)}didUpdate(t){this.updatedComponents.push(t)}scheduleInstallModifier(t){this.scheduledInstallModifiers.push(t)}scheduleUpdateModifier(t){this.scheduledUpdateModifiers.push(t)}commit(){let{createdComponents:t,updatedComponents:e}=this;for(let e=0;e<t.length;e++){let{manager:n,state:r}=t[e];n.didCreate(r)}for(let t=0;t<e.length;t++){let{manager:n,state:r}=e[t];n.didUpdate(r)}let n,r,{scheduledInstallModifiers:i,scheduledUpdateModifiers:o}=this;for(let t=0;t<i.length;t++){let e=i[t];n=e.manager,r=e.state;let o=n.getTag(r);if(null!==o){let t=Jn((()=>n.install(r)),Ie&&`- While rendering:\n  (instance of a \`${e.definition.resolvedName||n.getDebugName(e.definition.state)}\` modifier)`);$n(o,t)}else n.install(r)}for(let t=0;t<o.length;t++){let e=o[t];n=e.manager,r=e.state;let i=n.getTag(r);if(null!==i){let t=Jn((()=>n.update(r)),Ie&&`- While rendering:\n  (instance of a \`${e.definition.resolvedName||n.getDebugName(e.definition.state)}\` modifier)`);$n(i,t)}else n.update(r)}}}class ol{constructor(t,e){if(this.delegate=e,this[nl]=null,this.isInteractive=this.delegate.isInteractive,this.debugRenderTree=this.delegate.enableDebugTooling?new el:void 0,t.appendOperations)this.appendOperations=t.appendOperations,this.updateOperations=t.updateOperations;else if(t.document)this.appendOperations=new Fs(t.document),this.updateOperations=new Ns(t.document);else if(Ie)throw new Error("you must pass document or appendOperations to a new runtime")}getAppendOperations(){return this.appendOperations}getDOM(){return this.updateOperations}begin(){var t;null===(t=this.debugRenderTree)||void 0===t||t.begin(),this[rl]=new il}get transaction(){return this[rl]}didCreate(t){this.transaction.didCreate(t)}didUpdate(t){this.transaction.didUpdate(t)}scheduleInstallModifier(t){this.isInteractive&&this.transaction.scheduleInstallModifier(t)}scheduleUpdateModifier(t){this.isInteractive&&this.transaction.scheduleUpdateModifier(t)}commit(){var t;let e=this.transaction;this[rl]=null,e.commit(),null===(t=this.debugRenderTree)||void 0===t||t.commit(),this.delegate.onTransactionCommit()}}nl=rl;class sl{constructor(t,e,n,r,i){this.stack=t,this.heap=e,this.program=n,this.externs=r,this.registers=i,this.currentOpSize=0}fetchRegister(t){return this.registers[t]}loadRegister(t,e){this.registers[t]=e}setPc(t){this.registers[0]=t}pushFrame(){this.stack.push(this.registers[1]),this.stack.push(this.registers[Ar]),this.registers[Ar]=this.registers[Cr]-1}popFrame(){this.registers[Cr]=this.registers[Ar]-1,this.registers[1]=this.stack.get(0),this.registers[Ar]=this.stack.get(1)}pushSmallFrame(){this.stack.push(this.registers[1])}popSmallFrame(){this.registers[1]=this.stack.pop()}goto(t){this.setPc(this.target(t))}target(t){return this.registers[0]+t-this.currentOpSize}call(t){this.registers[1]=this.registers[0],this.setPc(this.heap.getaddr(t))}returnTo(t){this.registers[1]=this.target(t)}return(){this.setPc(this.registers[1])}nextStatement(){let{registers:t,program:e}=this,n=t[0];if(-1===n)return null;let r=e.opcode(n),i=this.currentOpSize=r.size;return this.registers[0]+=i,r}evaluateOuter(t,e){this.evaluateInner(t,e)}evaluateInner(t,e){t.isMachine?this.evaluateMachine(t):this.evaluateSyscall(t,e)}evaluateMachine(t){switch(t.type){case 0:return this.pushFrame();case 1:return this.popFrame();case 3:return this.call(t.op1);case 2:return this.call(this.stack.pop());case 4:return this.goto(t.op1);case 5:return this.return();case 6:return this.returnTo(t.op1)}}evaluateSyscall(t,e){Ui.evaluate(e,t,t.type)}}class al{constructor(t,{alwaysRevalidate:e=!1}){this.frameStack=new en,this.env=t,this.dom=t.getDOM(),this.alwaysRevalidate=e}execute(t,e){if(Ie){let n=!0;try{wn((()=>this._execute(t,e)),"- While rendering:"),n=!1}finally{n&&console.error(`\n\nError occurred:\n\n${Yn()}\n\n`)}}else this._execute(t,e)}_execute(t,e){let{frameStack:n}=this;for(this.try(t,e);!n.isEmpty();){let t=this.frame.nextStatement();void 0!==t?t.evaluate(this):n.pop()}}get frame(){return this.frameStack.current}goto(t){this.frame.goto(t)}try(t,e){this.frameStack.push(new dl(t,e))}throw(){this.frame.handleException(),this.frameStack.pop()}}class ll{constructor(t,e){this.state=t,this.resumeCallback=e}resume(t,e){return this.resumeCallback(t,this.state,e)}}class ul{constructor(t,e,n,r){this.state=t,this.runtime=e,this.children=r,this.bounds=n}parentElement(){return this.bounds.parentElement()}firstNode(){return this.bounds.firstNode()}lastNode(){return this.bounds.lastNode()}evaluate(t){t.try(this.children,null)}}class cl extends ul{constructor(){super(...arguments),this.type="try"}evaluate(t){t.try(this.children,this)}handleException(){let{state:t,bounds:e,runtime:n}=this;!function(t){let{children:e}=Qr(t);Kr(e,ei)}(this);let r=Li.resume(n.env,e),i=t.resume(n,r),o=[],s=this.children=[],a=i.execute((t=>{t.pushUpdating(o),t.updateWith(this),t.pushUpdating(s)}));Zr(this,a.drop)}}class hl extends cl{constructor(t,e,n,r,i,o){super(t,e,n,[]),this.key=r,this.memo=i,this.value=o,this.retained=!1,this.index=-1}updateReferences(t){this.retained=!0,dr(this.value,t.value),dr(this.memo,t.memo)}shouldRemove(){return!this.retained}reset(){this.retained=!1}}class fl extends ul{constructor(t,e,n,r,i){super(t,e,n,r),this.iterableRef=i,this.type="list-block",this.opcodeMap=new Map,this.marker=null,this.lastIterator=fr(i)}initializeChild(t){t.index=this.children.length-1,this.opcodeMap.set(t.key,t)}evaluate(t){let e=fr(this.iterableRef);if(this.lastIterator!==e){let{bounds:n}=this,{dom:r}=t,i=this.marker=r.createComment("");r.insertAfter(n.parentElement(),i,n.lastNode()),this.sync(e),this.parentElement().removeChild(i),this.marker=null,this.lastIterator=e}super.evaluate(t)}sync(t){let{opcodeMap:e,children:n}=this,r=0,i=0;for(this.children=this.bounds.boundList=[];;){let o=t.next();if(null===o)break;let s=n[r],{key:a}=o;for(;void 0!==s&&!0===s.retained;)s=n[++r];if(void 0!==s&&s.key===a)this.retainItem(s,o),r++;else if(e.has(a)){let t=e.get(a);if(t.index<i)this.moveItem(t,o,s);else{i=t.index;let e=!1;for(let t=r+1;t<i;t++)if(!1===n[t].retained){e=!0;break}!1===e?(this.retainItem(t,o),r=i+1):(this.moveItem(t,o,s),r++)}}else this.insertItem(o,s)}for(let t=0;t<n.length;t++){let e=n[t];!1===e.retained?this.deleteItem(e):e.reset()}}retainItem(t,e){let{children:n}=this;dr(t.memo,e.memo),dr(t.value,e.value),t.retained=!0,t.index=n.length,n.push(t)}insertItem(t,e){let{opcodeMap:n,bounds:r,state:i,runtime:o,children:s}=this,{key:a}=t,l=void 0===e?this.marker:e.firstNode(),u=Li.forInitialRender(o.env,{element:r.parentElement(),nextSibling:l});i.resume(o,u).execute((e=>{e.pushUpdating();let r=e.enterItem(t);r.index=s.length,s.push(r),n.set(a,r),Zr(this,r)}))}moveItem(t,e,n){let r,i,{children:o}=this;dr(t.memo,e.memo),dr(t.value,e.value),t.retained=!0,void 0===n?Wr(t,this.marker):(r=t.lastNode().nextSibling,i=n.firstNode(),r!==i&&Wr(t,i)),t.index=o.length,o.push(t)}deleteItem(t){ei(t),Hr(t),this.opcodeMap.delete(t.key)}}class dl{constructor(t,e){this.ops=t,this.exceptionHandler=e,this.current=0}goto(t){this.current=t}nextStatement(){return this.ops[this.current++]}handleException(){this.exceptionHandler&&this.exceptionHandler.handleException()}}class pl{constructor(t,e,n,r){this.env=t,this.updating=e,this.bounds=n,this.drop=r,Zr(this,r),ti(this,(()=>Hr(this.bounds)))}rerender({alwaysRevalidate:t=!1}={alwaysRevalidate:!1}){let{env:e,updating:n}=this;new al(e,{alwaysRevalidate:t}).execute(n,this)}parentElement(){return this.bounds.parentElement()}firstNode(){return this.bounds.firstNode()}lastNode(){return this.bounds.lastNode()}handleException(){throw"this should never happen"}}class ml{constructor(t=[],e){this.stack=t,this[Rr]=e}static restore(t){return new this(t.slice(),[0,-1,t.length-1,0])}push(t){this.stack[++this[Rr][Cr]]=t}dup(t=this[Rr][Cr]){this.stack[++this[Rr][Cr]]=this.stack[t]}copy(t,e){this.stack[e]=this.stack[t]}pop(t=1){let e=this.stack[this[Rr][Cr]];return this[Rr][Cr]-=t,e}peek(t=0){return this.stack[this[Rr][Cr]-t]}get(t,e=this[Rr][Ar]){return this.stack[e+t]}set(t,e,n=this[Rr][Ar]){this.stack[n+e]=t}slice(t,e){return this.stack.slice(t,e)}capture(t){let e=this[Rr][Cr]+1,n=e-t;return this.stack.slice(n,e)}reset(){this.stack.length=0}toArray(){return this.stack.slice(this[Rr][Ar],this[Rr][Cr]+1)}}var gl,yl;class bl{constructor(){this.scope=new en,this.dynamicScope=new en,this.updating=new en,this.cache=new en,this.list=new en}}class vl{constructor(t,{pc:e,scope:n,dynamicScope:r,stack:i},o,s){this.runtime=t,this.elementStack=o,this.context=s,this[gl]=new bl,this[yl]=new en,this.s0=null,this.s1=null,this.t0=null,this.t1=null,this.v0=null,this.resume=xl(this.context),Ie&&qe();let a=ml.restore(i);a[Rr][0]=e,a[Rr][Cr]=i.length-1,a[Rr][Ar]=-1,this[Pr]=this.program.heap,this[zr]=this.program.constants,this.elementStack=o,this[Br].scope.push(n),this[Br].dynamicScope.push(r),this[jr]=new eo,this[Fr]=new sl(a,this[Pr],t.program,{debugBefore:t=>Ui.debugBefore(this,t),debugAfter:t=>{Ui.debugAfter(this,t)}},a[Rr]),this.destructor={},this[Lr].push(this.destructor)}get stack(){return this[Fr].stack}get pc(){return this[Fr].fetchRegister(0)}fetch(t){let e=this.fetchValue(t);this.stack.push(e)}load(t){let e=this.stack.pop();this.loadValue(t,e)}fetchValue(t){if(Or(t))return this[Fr].fetchRegister(t);switch(t){case Dr:return this.s0;case 5:return this.s1;case 6:return this.t0;case 7:return this.t1;case Mr:return this.v0}}loadValue(t,e){switch(Or(t)&&this[Fr].loadRegister(t,e),t){case Dr:this.s0=e;break;case 5:this.s1=e;break;case 6:this.t0=e;break;case 7:this.t1=e;break;case Mr:this.v0=e}}pushFrame(){this[Fr].pushFrame()}popFrame(){this[Fr].popFrame()}goto(t){this[Fr].goto(t)}call(t){this[Fr].call(t)}returnTo(t){this[Fr].returnTo(t)}return(){this[Fr].return()}static initial(t,e,{handle:n,self:r,dynamicScope:i,treeBuilder:o,numSymbols:s,owner:a}){let l=$r.root(r,s,a),u=wl(t.program.heap.getaddr(n),l,i),c=xl(e)(t,u,o);return c.pushUpdating(),c}static empty(t,{handle:e,treeBuilder:n,dynamicScope:r,owner:i},o){let s=xl(o)(t,wl(t.program.heap.getaddr(e),$r.root(ir,0,i),r),n);return s.pushUpdating(),s}compile(t){return un(t.compile(this.context))}get program(){return this.runtime.program}get env(){return this.runtime.env}captureState(t,e=this[Fr].fetchRegister(0)){return{pc:e,scope:this.scope(),dynamicScope:this.dynamicScope(),stack:this.stack.capture(t)}}capture(t,e=this[Fr].fetchRegister(0)){return new ll(this.captureState(t,e),this.resume)}beginCacheGroup(t){let e=this.updating(),n=new ss;e.push(n),e.push(new as(t)),this[Br].cache.push(n),Hn(t)}commitCacheGroup(){let t=this.updating(),e=this[Br].cache.pop(),n=Gn();t.push(new ls(e)),e.finalize(n,t.length)}enter(t){let e=this.capture(t),n=this.elements().pushUpdatableBlock(),r=new cl(e,this.runtime,n,[]);this.didEnter(r)}enterItem({key:t,value:e,memo:n}){let{stack:r}=this,i=kr(e),o=kr(n);r.push(i),r.push(o);let s=this.capture(2),a=this.elements().pushUpdatableBlock(),l=new hl(s,this.runtime,a,t,o,i);return this.didEnter(l),l}registerItem(t){this.listBlock().initializeChild(t)}enterList(t,e){let n=[],r=this[Fr].target(e),i=this.capture(0,r),o=this.elements().pushBlockList(n),s=new fl(i,this.runtime,o,n,t);this[Br].list.push(s),this.didEnter(s)}didEnter(t){this.associateDestroyable(t),this[Lr].push(t),this.updateWith(t),this.pushUpdating(t.children)}exit(){this[Lr].pop(),this.elements().popBlock(),this.popUpdating()}exitList(){this.exit(),this[Br].list.pop()}pushUpdating(t=[]){this[Br].updating.push(t)}popUpdating(){return this[Br].updating.pop()}updateWith(t){this.updating().push(t)}listBlock(){return this[Br].list.current}associateDestroyable(t){Zr(this[Lr].current,t)}tryUpdating(){return this[Br].updating.current}updating(){return this[Br].updating.current}elements(){return this.elementStack}scope(){return this[Br].scope.current}dynamicScope(){return this[Br].dynamicScope.current}pushChildScope(){this[Br].scope.push(this.scope().child())}pushDynamicScope(){let t=this.dynamicScope().child();return this[Br].dynamicScope.push(t),t}pushRootScope(t,e){let n=$r.sized(t,e);return this[Br].scope.push(n),n}pushScope(t){this[Br].scope.push(t)}popScope(){this[Br].scope.pop()}popDynamicScope(){this[Br].dynamicScope.pop()}getOwner(){return this.scope().owner}getSelf(){return this.scope().getSelf()}referenceForSymbol(t){return this.scope().getSymbol(t)}execute(t){if(!Ie)return this._execute(t);{let e=!0;try{let n=this._execute(t);return e=!1,n}finally{if(e){let t=this.elements();for(;t.hasBlocks;)t.popBlock();console.error(`\n\nError occurred:\n\n${Yn()}\n\n`)}}}}_execute(t){let e;for(t&&t(this);e=this.next(),!e.done;);return e.value}next(){let t,{env:e,elementStack:n}=this,r=this[Fr].nextStatement();return null!==r?(this[Fr].evaluateOuter(r,this),t={done:!1,value:null}):(this.stack.reset(),t={done:!0,value:new pl(e,this.popUpdating(),n.popBlock(),this.destructor)}),t}bindDynamicScope(t){let e=this.dynamicScope();for(let n=t.length-1;n>=0;n--){let r=t[n];e.set(r,this.stack.pop())}}}function wl(t,e,n){return{pc:t,scope:e,dynamicScope:n,stack:[]}}function xl(t){return(e,n,r)=>new vl(e,n,r,t)}gl=Br,yl=Lr;class _l{constructor(t){this.vm=t}next(){return this.vm.next()}sync(){return Ie?wn((()=>this.vm.execute()),"- While rendering:"):this.vm.execute()}}function kl(t,e,n,r,i,o={},s=new Nr){return function(t,e,n,r,i){const o=Object.keys(i).map((t=>[t,i[t]])),s=["main","else","attrs"],a=o.map((([t])=>`@${t}`));let l=t[zr].component(r,n);t.pushFrame();for(let e=0;e<3*s.length;e++)t.stack.push(null);t.stack.push(null),o.forEach((([,e])=>{t.stack.push(e)})),t[jr].setup(t.stack,a,s,0,!0);const u=l.compilable,c={handle:un(u.compile(e)),symbolTable:u.symbolTable};return t.stack.push(t[jr]),t.stack.push(c),t.stack.push(l),new _l(t)}(vl.empty(t,{treeBuilder:e,handle:n.stdlib.main,dynamicScope:s,owner:r},n),n,r,i,function(t){const e=lr(t,"args");return Object.keys(t).reduce(((t,n)=>(t[n]=pr(e,n),t)),{})}(o))}class Sl extends Ur{constructor(t,e,n){super(t,e),this.startingBlockDepth=n,this.candidate=null,this.injectedOmittedNode=!1,this.openBlockDepth=n-1}}class El extends Li{constructor(t,e,n){if(super(t,e,n),this.unmatchedAttributes=null,this.blockDepth=0,n)throw new Error("Rehydration with nextSibling not supported");let r=this.currentCursor.element.firstChild;for(;null!==r&&!Al(r);)r=r.nextSibling;this.candidate=r;const i=Dl(r);if(0!==i){const t=i-1,e=this.dom.createComment(`%+b:${t}%`);r.parentNode.insertBefore(e,this.candidate);let n=r.nextSibling;for(;null!==n&&(!Cl(n)||Dl(n)!==i);)n=n.nextSibling;const o=this.dom.createComment(`%-b:${t}%`);r.parentNode.insertBefore(o,n.nextSibling),this.candidate=e,this.startingBlockOffset=t}else this.startingBlockOffset=0}get currentCursor(){return this[Fi].current}get candidate(){return this.currentCursor?this.currentCursor.candidate:null}set candidate(t){this.currentCursor.candidate=t}disableRehydration(t){let e=this.currentCursor;e.candidate=null,e.nextSibling=t}enableRehydration(t){let e=this.currentCursor;e.candidate=t,e.nextSibling=null}pushElement(t,e=null){let n=new Sl(t,e,this.blockDepth||0);null!==this.candidate&&(n.candidate=t.firstChild,this.candidate=t.nextSibling),this[Fi].push(n)}clearMismatch(t){let e=t,n=this.currentCursor;if(null!==n){let t=n.openBlockDepth;if(t>=n.startingBlockDepth)for(;e&&!(Cl(e)&&t>=Ml(e,this.startingBlockOffset));)e=this.remove(e);else for(;null!==e;)e=this.remove(e);this.disableRehydration(e)}}__openBlock(){let{currentCursor:t}=this;if(null===t)return;let e=this.blockDepth;this.blockDepth++;let{candidate:n}=t;if(null===n)return;let{tagName:r}=t.element;Al(n)&&Ml(n,this.startingBlockOffset)===e?(this.candidate=this.remove(n),t.openBlockDepth=e):"TITLE"!==r&&"SCRIPT"!==r&&"STYLE"!==r&&this.clearMismatch(n)}__closeBlock(){let{currentCursor:t}=this;if(null===t)return;let e=t.openBlockDepth;this.blockDepth--;let{candidate:n}=t,r=!1;if(null!==n)if(r=!0,Cl(n)&&Ml(n,this.startingBlockOffset)===e){let e=this.remove(n);this.candidate=e,t.openBlockDepth--}else this.clearMismatch(n),r=!1;if(!1===r){let e=t.nextSibling;if(null!==e&&Cl(e)&&Ml(e,this.startingBlockOffset)===this.blockDepth){let n=this.remove(e);this.enableRehydration(n),t.openBlockDepth--}}}__appendNode(t){let{candidate:e}=this;return e||super.__appendNode(t)}__appendHTML(t){let e=this.markerBounds();if(e){let t=e.firstNode(),n=e.lastNode(),r=new Vr(this.element,t.nextSibling,n.previousSibling),i=this.remove(t);return this.remove(n),null!==i&&Il(i)&&(this.candidate=this.remove(i),null!==this.candidate&&this.clearMismatch(this.candidate)),r}return super.__appendHTML(t)}remove(t){let e=t.parentNode,n=t.nextSibling;return e.removeChild(t),n}markerBounds(){let t=this.candidate;if(t&&Tl(t)){let e=t,n=e.nextSibling;for(;n&&!Tl(n);)n=n.nextSibling;return new Vr(this.element,e,n)}return null}__appendText(t){let{candidate:e}=this;return e?3===e.nodeType?(e.nodeValue!==t&&(e.nodeValue=t),this.candidate=e.nextSibling,e):function(t){return 8===t.nodeType&&"%|%"===t.nodeValue}(e)||Il(e)&&""===t?(this.candidate=this.remove(e),this.__appendText(t)):(this.clearMismatch(e),super.__appendText(t)):super.__appendText(t)}__appendComment(t){let e=this.candidate;return e&&8===e.nodeType?(e.nodeValue!==t&&(e.nodeValue=t),this.candidate=e.nextSibling,e):(e&&this.clearMismatch(e),super.__appendComment(t))}__openElement(t){let e=this.candidate;if(e&&Ol(e)&&function(t,e){return"http://www.w3.org/2000/svg"===t.namespaceURI?t.tagName===e:t.tagName===e.toUpperCase()}(e,t))return this.unmatchedAttributes=[].slice.call(e.attributes),e;if(e){if(Ol(e)&&"TBODY"===e.tagName)return this.pushElement(e,null),this.currentCursor.injectedOmittedNode=!0,this.__openElement(t);this.clearMismatch(e)}return super.__openElement(t)}__setAttribute(t,e,n){let r=this.unmatchedAttributes;if(r){let n=Nl(r,t);if(n)return n.value!==e&&(n.value=e),void r.splice(r.indexOf(n),1)}return super.__setAttribute(t,e,n)}__setProperty(t,e){let n=this.unmatchedAttributes;if(n){let r=Nl(n,t);if(r)return r.value!==e&&(r.value=e),void n.splice(n.indexOf(r),1)}return super.__setProperty(t,e)}__flushElement(t,e){let{unmatchedAttributes:n}=this;if(n){for(let t=0;t<n.length;t++)this.constructing.removeAttribute(n[t].name);this.unmatchedAttributes=null}else super.__flushElement(t,e)}willCloseElement(){let{candidate:t,currentCursor:e}=this;null!==t&&this.clearMismatch(t),e&&e.injectedOmittedNode&&this.popElement(),super.willCloseElement()}getMarker(t,e){return t.querySelector(`script[glmr="${e}"]`)||null}__pushRemoteElement(t,e,n){let r=this.getMarker(t,e);if(void 0===n){for(;null!==t.firstChild&&t.firstChild!==r;)this.remove(t.firstChild);n=null}let i=new Sl(t,null,this.blockDepth);this[Fi].push(i),null===r?this.disableRehydration(n):this.candidate=this.remove(r);let o=new Ri(t);return this.pushLiveBlock(o,!0)}didAppendBounds(t){if(super.didAppendBounds(t),this.candidate){let e=t.lastNode();this.candidate=e&&e.nextSibling}return t}}function Al(t){return 8===t.nodeType&&0===t.nodeValue.lastIndexOf("%+b:",0)}function Cl(t){return 8===t.nodeType&&0===t.nodeValue.lastIndexOf("%-b:",0)}function Dl(t){return parseInt(t.nodeValue.slice(4),10)}function Ml(t,e){return Dl(t)-e}function Ol(t){return 1===t.nodeType}function Tl(t){return 8===t.nodeType&&"%glmr%"===t.nodeValue}function Il(t){return 8===t.nodeType&&"% %"===t.nodeValue}function Nl(t,e){for(let n=0;n<t.length;n++){let r=t[n];if(r.name===e)return r}}function $l(t,e){return El.forInitialRender(t,e)}const Fl=sn("OWNER");function Ll(t){return Uo(t,{})}Ie&&new WeakMap;const Bl=fn("`fn` helper"),Rl=Ll((({positional:t})=>{let e=t[0];return Ie&&Pl(e),ur((()=>(...n)=>{let[r,...i]=co(t);if(Ie&&Pl(e),cr(e)){let t=i.length>0?i[0]:n[0];return dr(e,t)}return r.call(Bl,...i,...n)}),null,"fn")}));function Pl(t){if(!t||!cr(t)&&"function"!=typeof fr(t))throw new Error(`You must pass a function as the \`fn\` helpers first argument, you passed ${t?fr(t):t}. While rendering:\n\n${null==t?void 0:t.debugLabel}`)}let zl;Ie&&(zl=t=>new Proxy(t,{set:(t,e,n)=>(Ve(`You set the '${String(e)}' property on a {{hash}} object. Setting properties on objects generated by {{hash}} is deprecated. Please update to use an object created with a tracked property or getter, or with a custom helper.`,!1,{id:"setting-on-hash"}),t[e]=n,!0)})),Ll((({named:t})=>{let e=ur((()=>{let e=uo(t);return Ie&&on&&(e=zl(e)),e}),null,"hash"),n=new Map;for(let e in t)n.set(e,t[e]);return e.children=n,e})),Ll((({positional:t})=>ur((()=>co(t)),null,"array"))),Ll((({positional:t})=>{var e,n;let r=null!==(e=t[0])&&void 0!==e?e:ir,i=null!==(n=t[1])&&void 0!==n?n:ir;return ur((()=>{let t=fr(r);if(Ze(t))return Pe(t,String(fr(i)))}),(t=>{let e=fr(r);if(Ze(e))return ze(e,String(fr(i)),t)}),"get")}));const jl=t=>(t=>null==t||"function"!=typeof t.toString)(t)?"":String(t),Ul=(Ll((({positional:t})=>ur((()=>co(t).map(jl).join("")),null,"concat"))),fn("`on` modifier")),Vl=(()=>{try{const t=document.createElement("div");let e,n=0;return t.addEventListener("click",(()=>n++),{once:!0}),"function"==typeof Event?e=new Event("click"):(e=document.createEvent("Event"),e.initEvent("click",!0,!0)),t.dispatchEvent(e),t.dispatchEvent(e),1===n}catch(t){return!1}})();class ql{constructor(t,e){this.tag=Fn(),this.shouldUpdate=!0,this.element=t,this.args=e}updateFromArgs(){let t,{args:e}=this,{once:n,passive:r,capture:i}=uo(e.named);if(n!==this.once&&(this.once=n,this.shouldUpdate=!0),r!==this.passive&&(this.passive=r,this.shouldUpdate=!0),i!==this.capture&&(this.capture=i,this.shouldUpdate=!0),n||r||i?t=this.options={once:n,passive:r,capture:i}:this.options=void 0,Ie&&(void 0===e.positional[0]||"string"!=typeof fr(e.positional[0])))throw new Error("You must pass a valid DOM event name as the first argument to the `on` modifier");let o=fr(e.positional[0]);o!==this.eventName&&(this.eventName=o,this.shouldUpdate=!0);let s=e.positional[1];if(Ie){if(void 0===e.positional[1])throw new Error("You must pass a function as the second argument to the `on` modifier.");let t=fr(s);if("function"!=typeof t)throw new Error(`You must pass a function as the second argument to the \`on\` modifier; you passed ${null===t?"null":typeof t}. While rendering:\n\n${s.debugLabel}`)}let a=fr(s);if(a!==this.userProvidedCallback&&(this.userProvidedCallback=a,this.shouldUpdate=!0),Ie&&2!==e.positional.length)throw new Error(`You can only pass two positional arguments (event name and callback) to the \`on\` modifier, but you provided ${e.positional.length}. Consider using the \`fn\` helper to provide additional arguments to the \`on\` callback.`);let l=!1===Vl&&n||Ie&&r;if(this.shouldUpdate)if(l){let e=this.callback=function(i){return Ie&&r&&(i.preventDefault=()=>{throw new Error(`You marked this listener as 'passive', meaning that you must not call 'event.preventDefault()': \n\n${a}`)}),!Vl&&n&&Gl(this,o,e,t),a.call(Ul,i)}}else this.callback=Ie?a.bind(Ul):a}}let Wl=0,Hl=0;function Gl(t,e,n,r){Hl++,Vl?t.removeEventListener(e,n,r):void 0!==r&&r.capture?t.removeEventListener(e,n,!0):t.removeEventListener(e,n)}function Yl(t,e,n,r){Wl++,Vl?t.addEventListener(e,n,r):void 0!==r&&r.capture?t.addEventListener(e,n,!0):t.addEventListener(e,n)}const Xl=jo(new class{constructor(){this.SUPPORTS_EVENT_OPTIONS=Vl}getDebugName(){return"on"}get counters(){return{adds:Wl,removes:Hl}}create(t,e,n,r){return new ql(e,r)}getTag(t){return null===t?null:t.tag}install(t){if(null===t)return;t.updateFromArgs();let{element:e,eventName:n,callback:r,options:i}=t;Yl(e,n,r,i),ti(t,(()=>Gl(e,n,r,i))),t.shouldUpdate=!1}update(t){if(null===t)return;let{element:e,eventName:n,callback:r,options:i}=t;t.updateFromArgs(),t.shouldUpdate&&(Gl(e,n,r,i),Yl(t.element,t.eventName,t.callback,t.options),t.shouldUpdate=!1)}getDestroyable(t){return t}},{});class Jl{constructor(t,e){this.iterable=t,this.result=e,this.position=0}static from(t){const e=t[Symbol.iterator](),n=e.next(),{done:r}=n;return!0===r?null:new this(e,n)}isEmpty(){return!1}next(){const{iterable:t,result:e,position:n}=this;if(e.done)return null;const r=e.value,i=n;return this.position++,this.result=t.next(),{value:r,memo:i}}}function Kl(t){return Array.isArray(t)?0!==t.length:Boolean(t)}let Ql=[],Zl=[],tu=[];class eu{constructor(){this.enableDebugTooling=!1,this.owner={}}onTransactionCommit(){for(let t=0;t<Ql.length;t++)Zl[t](Ql[t]);tu.forEach((t=>t())),Ql=[],Zl=[],tu=[]}}class nu extends eu{constructor(){super(...arguments),this.isInteractive=!0,this.uselessAnchor=self.document.createElement("a"),this.protocolForURL=t=>(this.uselessAnchor.href=t,this.uselessAnchor.protocol)}}let ru=[];const iu=async function(t,e){const n=e instanceof HTMLElement?{element:e}:e,{element:r,args:i,owner:o}=n,s=self.document,{env:a,iterator:l}=function(t,e,n,r,i={},o={},s=ji){const a=function(t,e,n,r){return{env:new ol(t,e),program:new Qa(n.constants,n.heap),resolver:r}}(n,r,lu,au);return{iterator:kl(a,s(a.env,{element:e,nextSibling:null}),uu,o,t,i),env:a.env}}(t,r,{document:s},new nu,i,o,n.rehydrate?$l:ji),u=function(t,e){let n;return function(t,e){if(t[rl])e();else{t.begin();try{e()}finally{t.commit()}}}(t,(()=>n=e.sync())),n}(a,l);ou.push(u)},ou=[];let su=!1;Ye({getProp:(t,e)=>t[e],setProp(t,e,n){t[e]=n},getPath(t,e){if(Ie&&e.includes("."))throw new Error("You attempted to get a path with a `.` in it, but Glimmer.js does not support paths with dots.");return t[e]},setPath(t,e,n){if(Ie&&e.includes("."))throw new Error("You attempted to set a path with a `.` in it, but Glimmer.js does not support paths with dots.");t[e]=n},scheduleRevalidate:function(){su||(su=!0,setTimeout((()=>{su=!1;try{!function(){for(const t of ou){const{env:e}=t;e.begin(),t.rerender(),e.commit()}}(),ru.forEach((([t])=>t()))}catch(t){ru.forEach((([,e])=>e(t)))}ru=[]}),0))},toBool:Kl,toIterator:t=>function(t){return"object"==typeof t&&null!==t&&Symbol.iterator in t}(t)?Jl.from(t):null,scheduleDestroy(t,e){Ql.push(t),Zl.push(e)},scheduleDestroyed(t){tu.push(t)},warnIfStyleNotTrusted(){},assert(t,e){if(!t)throw new Error(e)},deprecate(t,e){e||console.warn(t)}});const au=new class{lookupComponent(t,e){return null}},lu={constants:new class extends Xa{constructor(){super(...arguments),this.reifiedArrs={[Ya]:Ha},this.defaultTemplate=Va(Wa)(),this.helperDefinitionCount=0,this.modifierDefinitionCount=0,this.componentDefinitionCount=0,this.helperDefinitionCache=new WeakMap,this.modifierDefinitionCache=new WeakMap,this.componentDefinitionCache=new WeakMap}helper(t,e=null,n){let r=this.helperDefinitionCache.get(t);if(void 0===r){let e=function(t,e){if(Ie&&"function"!=typeof t&&("object"!=typeof t||null===t))throw new Error(`Attempted to use a value as a helper, but it was not an object or function. Helper definitions must be objects or functions with an associated helper manager. The value was: ${t}`);let n=zo(Bo,t);if(void 0===n&&"function"==typeof t&&(n=Vo),n)return n;if(!0===e)return null;if(Ie)throw new Error(`Attempted to load a helper, but there wasn't a helper manager associated with the definition. The definition was: ${pn(t)}`);return null}(t,n);if(null===e)return this.helperDefinitionCache.set(t,null),null;let i="function"==typeof e?e:e.getHelper(t);r=this.value(i),this.helperDefinitionCache.set(t,r),this.helperDefinitionCount++}return r}modifier(t,e=null,n){let r=this.modifierDefinitionCache.get(t);if(void 0===r){let i=function(t,e){if(Ie&&"function"!=typeof t&&("object"!=typeof t||null===t))throw new Error(`Attempted to use a value as a modifier, but it was not an object or function. Modifier definitions must be objects or functions with an associated modifier manager. The value was: ${t}`);const n=zo(Lo,t);if(void 0===n){if(!0===e)return null;if(Ie)throw new Error(`Attempted to load a modifier, but there wasn't a modifier manager associated with the definition. The definition was: ${pn(t)}`)}return n}(t,n);if(null===i)return this.modifierDefinitionCache.set(t,null),null;let o={resolvedName:e,manager:i,state:t};r=this.value(o),this.modifierDefinitionCache.set(t,r),this.modifierDefinitionCount++}return r}component(t,e,n){var r;let i=this.componentDefinitionCache.get(t);if(void 0===i){let o=function(t,e){if(Ie&&"function"!=typeof t&&("object"!=typeof t||null===t))throw new Error(`Attempted to use a value as a component, but it was not an object or function. Component definitions must be objects or functions with an associated component manager. The value was: ${t}`);const n=zo(Fo,t);if(void 0===n){if(!0===e)return null;if(Ie)throw new Error(`Attempted to load a component, but there wasn't a component manager associated with the definition. The definition was: ${pn(t)}`)}return n}(t,n);if(null===o)return this.componentDefinitionCache.set(t,null),null;let s,a=wo(o.getCapabilities(t)),l=function(t){let e=t;for(;null!==e;){let t=ts.get(e);if(void 0!==t)return t;e=es(e)}}(t),u=null;s=xo(0,a,1)?null==l?void 0:l(e):null!==(r=null==l?void 0:l(e))&&void 0!==r?r:this.defaultTemplate,void 0!==s&&(s=cn(s),u=xo(0,a,1024)?s.asWrappedLayout():s.asLayout()),i={resolvedName:null,handle:-1,manager:o,capabilities:a,state:t,compilable:u},i.handle=this.value(i),this.componentDefinitionCache.set(t,i),this.componentDefinitionCount++}return i}resolvedComponent(t,e){let n=this.componentDefinitionCache.get(t);if(void 0===n){let{manager:r,state:i,template:o}=t,s=wo(r.getCapabilities(t)),a=null;xo(0,s,1)||(o=null!=o?o:this.defaultTemplate),null!==o&&(o=cn(o),a=xo(0,s,1024)?o.asWrappedLayout():o.asLayout()),n={resolvedName:e,handle:-1,manager:r,capabilities:s,state:i,compilable:a},n.handle=this.value(n),this.componentDefinitionCache.set(t,n),this.componentDefinitionCount++}return n}getValue(t){return this.values[t]}getArray(t){let e=this.reifiedArrs,n=e[t];if(void 0===n){let r=this.getValue(t);n=new Array(r.length);for(let t=0;t<r.length;t++)n[t]=this.getValue(r[t]);e[t]=n}return n}},heap:new class{constructor(){this.offset=0,this.handle=0,this.heap=new Int32Array(Ka),this.handleTable=[],this.handleState=[]}push(t){this.sizeCheck(),this.heap[this.offset++]=t}sizeCheck(){let{heap:t}=this;if(this.offset===this.heap.length){let e=new Int32Array(t.length+Ka);e.set(t,0),this.heap=e}}getbyaddr(t){return this.heap[t]}setbyaddr(t,e){this.heap[t]=e}malloc(){return this.handleTable.push(this.offset),this.handleTable.length-1}finishMalloc(t){}size(){return this.offset}getaddr(t){return this.handleTable[t]}sizeof(t){return this.handleTable,-1}free(t){this.handleState[t]=1}compact(){let t=0,{handleTable:e,handleState:n,heap:r}=this;for(let i=0;i<length;i++){let o=e[i],s=e[i+1]-o,a=n[i];if(2!==a)if(1===a)n[i]=2,t+=s;else if(0===a){for(let e=o;e<=i+s;e++)r[e-t]=r[e];e[i]=o-t}else 3===a&&(e[i]=o-t)}this.offset=this.offset-t}capture(t=this.offset){let e=function(t,e,n){if(void 0!==t.slice)return t.slice(e,n);let r=new Int32Array(n);for(;e<n;e++)r[e]=t[e];return r}(this.heap,0,t).buffer;return{handle:this.handle,table:this.handleTable,buffer:e}}}},uu=function(t,e){return new Pa(t,e)}(lu,new class{lookupHelper(t,e){return null}lookupModifier(t,e){return null}lookupComponent(t,e){return null}lookupBuiltInHelper(t){return null}lookupBuiltInModifier(t){return null}});let cu;Ie&&(cu=()=>{throw new Error("precompileTemplate() is meant to be preprocessed with babel, using @glimmer/babel-preset. If you are seeing this error message, it means that you do not have this babel preset installed, or it is not enabled correctly")});const hu=Symbol("Services");class fu{constructor(t){this[hu]=new Map,this.services=t}lookup({type:t,name:e}){if(Ie&&"service"!==t)throw new Error("The only supported lookups are for services");if(Ie&&void 0===this.services[e])throw new Error(`Attempted to lookup service '${e}', but it did not exist. Did you pass it into renderComponent()?`);if(!this[hu].has(e)&&this.services[e]){const t=this.services[e],n=function(t){return(t&&"function"==typeof t&&t.prototype&&t.prototype.constructor)===t}(t)?new t(this):t;this[hu].set(e,n)}return this[hu].get(e)}}const du=new class{constructor(){this.capabilities=function(t,e={}){if(Ie&&"3.22"!=="3.22")throw new Error("Invalid modifier manager compatibility specified");return vo({disableAutoTracking:Boolean(e.disableAutoTracking)})}()}createModifier(t,e){return{fn:t,args:e,element:void 0,destructor:void 0}}installModifier(t,e){t.element=e,this.setupModifier(t)}updateModifier(t){this.destroyModifier(t),this.setupModifier(t)}destroyModifier(t){"function"==typeof t.destructor&&t.destructor()}setupModifier(t){const{fn:e,args:n,element:r}=t;t.destructor=e(r,...n.positional,n.named)}},pu=new class{constructor(){this.capabilities=To("3.23",{hasValue:!0})}createHelper(t,e){return{fn:t,args:e}}getValue({fn:t,args:e}){return t(...e.positional)}getDebugName(t){return t.name||"(anonymous function)"}};Qo((()=>du),Function.prototype),Zo((()=>pu),Function.prototype);const mu=new WeakMap,gu=new WeakMap;let yu;Ie&&(yu=new WeakMap);class bu{constructor(t,e){if(Ie&&(null===t||"object"!=typeof t||!yu.has(e)))throw new Error(`You must pass both the owner and args to super() in your component: ${this.constructor.name}. You can pass them directly, or use ...arguments to pass all arguments through.`);this.args=e,mu.set(this,!1),gu.set(this,!1)}get isDestroying(){return mu.get(this)||!1}get isDestroyed(){return gu.get(this)||!1}willDestroy(){}}class vu{constructor(t){this.owner=t}createComponent(t,e){return Ie&&yu.set(e.named,!0),new t(this.owner,e.named)}getContext(t){return t}}const wu=function(t,e={}){if(Ie&&"3.13"!=="3.13")throw new Error("Invalid component manager compatibility specified");let n=Boolean(e.updateHook);return vo({asyncLifeCycleCallbacks:Boolean(e.asyncLifecycleCallbacks),destructor:Boolean(e.destructor),updateHook:n})}(0,{destructor:!0});class xu extends vu{constructor(){super(...arguments),this.capabilities=wu}destroyComponent(t){!function(t){mu.set(t,!0)}(t),t.willDestroy(),function(t){gu.set(t,!0)}(t)}}class _u extends bu{constructor(t,e){if(super(t,e),Ie&&(null===t||"object"!=typeof t))throw new Error(`You must pass both the owner and args to super() in your component: ${this.constructor.name}. You can pass them directly, or use ...arguments to pass all arguments through.`);!function(t,e){t[Fl]=e}(this,t)}}var ku;ku=_u,qo(new class{constructor(t){this.factory=t,this.componentManagerDelegates=new WeakMap}getDelegateFor(t){let{componentManagerDelegates:e}=this,n=e.get(t);if(void 0===n){let{factory:r}=this;if(n=r(t),Ie&&!bo.has(n.capabilities))throw new Error(`Custom component managers must have a \`capabilities\` property that is the result of calling the \`capabilities('3.13')\` (imported via \`import { capabilities } from '@ember/component';\`). Received: \`${JSON.stringify(n.capabilities)}\` for: \`${n}\``);e.set(t,n)}return n}create(t,e,n){let r=this.getDelegateFor(t),i=Do(n.capture(),"component"),o=r.createComponent(e,i);return new Jo(o,r,i)}getDebugName(t){return"function"==typeof t?t.name:t.toString()}update(t){let{delegate:e}=t;if(Xo(e)){let{component:n,args:r}=t;e.updateComponent(n,r)}}didCreate({component:t,delegate:e}){Yo(e)&&e.didCreateComponent(t)}didUpdate({component:t,delegate:e}){(function(t){return Yo(t)&&Xo(t)})(e)&&e.didUpdateComponent(t)}didRenderLayout(){}didUpdateLayout(){}getSelf({component:t,delegate:e}){return lr(e.getContext(t),"this")}getDestroyable(t){const{delegate:e}=t;if(function(t){return t.capabilities.destructor}(e)){const{component:n}=t;return ti(t,(()=>e.destroyComponent(n))),t}return null}getCapabilities(){return Go}}((t=>new xu(t))),ku);const Su=(...t)=>{const[e,n,r]=t;if(Ie&&"string"==typeof e&&function(t){throw new Error(`You attempted to use @tracked with ${t.length>1?"arguments":"an argument"} ( @tracked(${t.map((t=>`'${t}'`)).join(", ")}) ), which is no longer necessary nor supported. Dependencies are now automatically tracked, so you can just use \`@tracked\`.`)}(t),Ie&&void 0===e&&function(){throw new Error("You attempted to use @tracked(), which is no longer necessary nor supported. Remove the parentheses and you will be good to go!")}(),Ie&&r&&r.get&&function(){throw new Error("The @tracked decorator does not need to be applied to getters. Properties implemented using a getter will recompute automatically when any tracked properties they access change.")}(),r)return Eu(0,n,r);Object.defineProperty(e,n,Eu(0,n))};function Eu(t,e,n){if(Ie&&n&&(n.value||n.get||n.set))throw new Error(`You attempted to use @tracked on ${String(e)}, but that element is not a class field. @tracked is only usable on class fields. Native getters and setters will autotrack add any tracked fields they encounter, so there is no need mark getters and setters with @tracked.`);const{getter:r,setter:i}=Qn(e,n&&n.initializer);return{enumerable:!0,configurable:!0,get(){return r(this)},set(t){i(this,t)}}}function Au(t){return()=>({enumerable:!0,configurable:!1,get(){const e=function(t){return t[Fl]}(this);return Ue(e,`Attempted to lookup the ${t} service on an instance of ${this}, but there was no owner set on that object`),e.lookup({type:"service",name:t})}})}function Cu(t,e){return"string"==typeof t?Au(t):Au(e)(t,e)}const Du=new WeakMap;function Mu(t,e,n){const r=n.value;return{enumerable:n.enumerable,configurable:n.configurable,get(){let t=Du.get(this);void 0===t&&(t=new Map,Du.set(this,t));let e=t.get(r);return void 0===e&&(e=r.bind(this),t.set(r,e)),e}}}const Ou=Array.isArray;function Tu(t){return null!=t?Ou(t)?t:[t]:[]}function Iu(t){return t<0?`count() + ${t}`:t}class Nu{constructor(t){t&&(this._params=t)}params(t){return arguments.length?(t&&(this._params={...this._params,...t}),this):this._params}reify(t){return this.__reify(this,t)}count(t){return this.__count(this,t)}derive(t,e){return this.__derive(this,t,e)}filter(t){return this.__filter(this,t)}slice(t,e){return this.filter(function(t=0,e=1/0){return`${Iu(t)} < row_number() && row_number() <= ${Iu(e)}`}(t,e)).reify()}groupby(...t){return this.__groupby(this,t.flat())}orderby(...t){return this.__orderby(this,t.flat())}relocate(t,e){return this.__relocate(this,Tu(t),e)}rename(...t){return this.__rename(this,t.flat())}rollup(t){return this.__rollup(this,t)}sample(t,e){return this.__sample(this,t,e)}select(...t){return this.__select(this,t.flat())}ungroup(){return this.__ungroup(this)}unorder(){return this.__unorder(this)}dedupe(...t){return this.__dedupe(this,t.flat())}impute(t,e){return this.__impute(this,t,e)}fold(t,e){return this.__fold(this,t,e)}pivot(t,e,n){return this.__pivot(this,t,e,n)}spread(t,e){return this.__spread(this,t,e)}unroll(t,e){return this.__unroll(this,t,e)}lookup(t,e,...n){return this.__lookup(this,t,e,n.flat())}join(t,e,n,r){return this.__join(this,t,e,n,r)}join_left(t,e,n,r){const i={...r,left:!0,right:!1};return this.__join(this,t,e,n,i)}join_right(t,e,n,r){const i={...r,left:!1,right:!0};return this.__join(this,t,e,n,i)}join_full(t,e,n,r){const i={...r,left:!0,right:!0};return this.__join(this,t,e,n,i)}cross(t,e,n){return this.__cross(this,t,e,n)}semijoin(t,e){return this.__semijoin(this,t,e)}antijoin(t,e){return this.__antijoin(this,t,e)}concat(...t){return this.__concat(this,t.flat())}union(...t){return this.__union(this,t.flat())}intersect(...t){return this.__intersect(this,t.flat())}except(...t){return this.__except(this,t.flat())}}function $u(t){throw Error(t)}function Fu(t){return"number"==typeof t}function Lu(t){return"function"==typeof t}function Bu(t,e){const n=Array(t);if(Lu(e))for(let r=0;r<t;++r)n[r]=e(r);else n.fill(e);return n}class Ru extends Nu{constructor(t,e,n,r,i,o,s){super(s),this._names=Object.freeze(t),this._data=n,this._total=e,this._nrows=r?r.count():e,this._mask=e!==this._nrows&&r||null,this._group=i||null,this._order=o||null}create(t){$u("Not implemented")}get[Symbol.toStringTag](){if(!this._names)return"Object";const t=this.numRows()+" row"+(1!==this.numRows()?"s":"");return`Table: ${this.numCols()+" col"+(1!==this.numCols()?"s":"")} x ${t}`+(this.isFiltered()?` (${this.totalRows()} backing)`:"")+(this.isGrouped()?`, ${this._group.size} groups`:"")+(this.isOrdered()?", ordered":"")}isFiltered(){return!!this._mask}isGrouped(){return!!this._group}isOrdered(){return!!this._order}data(){return this._data}mask(){return this._mask}groups(){return this._group}comparator(){return this._order}totalRows(){return this._total}numRows(){return this._nrows}get size(){return this._nrows}numCols(){return this._names.length}columnNames(t){return t?this._names.filter(t):this._names.slice()}columnName(t){return this._names[t]}columnIndex(t){return this._names.indexOf(t)}columnArray(t,e){return this.array(t,e)}array(t,e){$u("Not implemented")}*values(t){const e=this.getter(t),n=this.numRows();for(let t=0;t<n;++t)yield e(t)}get(t,e=0){$u("Not implemented")}getter(t){$u("Not implemented")}objects(t){$u("Not implemented")}object(t){$u("Not implemented")}[Symbol.iterator](){$u("Not implemented")}print(t={}){Fu(t)?t={limit:t}:null==t.limit&&(t.limit=10);const e=this.objects({...t,grouped:!1}),n=`${this[Symbol.toStringTag]}. Showing ${e.length} rows.`;return console.log(n),console.table(e),this}indices(t=!0){if(this._index)return this._index;const e=this.numRows(),n=new Uint32Array(e),r=this.isOrdered(),i=this.mask();let o=-1;if(i)for(let t=i.next(0);t>=0;t=i.next(t+1))n[++o]=t;else for(let t=0;t<e;++t)n[++o]=t;if(t&&r){const t=this._order,e=this._data;n.sort(((n,r)=>t(n,r,e)))}return!t&&r||(this._index=n),n}partitions(t=!0){if(this._partitions)return this._partitions;if(!this.isGrouped())return[this.indices(t)];const{keys:e,size:n}=this._group,r=Bu(n,(()=>[])),i=this._index,o=this.mask(),s=this.numRows();if(i&&this.isOrdered())for(let t,n=0;n<s;++n)t=i[n],r[e[t]].push(t);else if(o)for(let t=o.next(0);t>=0;t=o.next(t+1))r[e[t]].push(t);else for(let t=0;t<s;++t)r[e[t]].push(t);if(t&&!i&&this.isOrdered()){const t=this._order,e=this._data;for(let i=0;i<n;++i)r[i].sort(((n,r)=>t(n,r,e)))}return!t&&this.isOrdered()||(this._partitions=r),r}scan(t,e,n=1/0,r=0){const i=this._mask,o=this._nrows,s=this._data;let a=r||0;if(a>o)return;const l=Math.min(o,a+n),u=()=>a=this._total;if(e&&this.isOrdered()||i&&this._index){const e=this.indices(),n=this._data;for(;a<l;++a)t(e[a],n,u)}else if(i){let e=l-a+1;for(a=i.nth(a);--e&&a>-1;a=i.next(a+1))t(a,s,u)}else for(;a<l;++a)t(a,s,u)}slice(t=0,e=1/0){if(this.isGrouped())return super.slice(t,e);const n=[],r=this.numRows();return t=Math.max(0,t+(t<0?r:0)),e=Math.min(r,Math.max(0,e+(e<0?r:0))),this.scan((t=>n.push(t)),!0,e-t,t),this.reify(n)}reduce(t){return this.__reduce(this,t)}}class Pu{constructor(t){this.data=t}get length(){return this.data.length}get(t){return this.data[t]}[Symbol.iterator](){return this.data[Symbol.iterator]()}}let zu=function(t){return t&&Lu(t.get)?t:new Pu(t)};function ju(t){return t instanceof Date}function Uu(t){return t===Object(t)}function Vu(t){return t instanceof RegExp}function qu(t){return"string"==typeof t}function Wu(t,e=["key","value"]){const n=[],r=[];for(const[e,i]of t)n.push(e),r.push(i);const i={};return e[0]&&(i[e[0]]=n),e[1]&&(i[e[1]]=r),i}const{hasOwnProperty:Hu}=Object.prototype;function Gu(t,e){return Hu.call(t,e)}function Yu(t){return t?new Xu({...t.data()},t.columnNames()):new Xu}class Xu{constructor(t,e){this.data=t||{},this.names=e||[]}add(t,e){return this.has(t)||this.names.push(t+""),this.data[t]=e}has(t){return Gu(this.data,t)}new(){return this.filter=null,this.groups=this.groups||null,this.order=null,this}groupby(t){return this.groups=t,this}}const Ju=void 0,Ku=Object.getPrototypeOf(Int8Array);function Qu(t){return t instanceof Ku}function Zu(t){return Ou(t)||Qu(t)}function tc(t){return null!=t&&t==t}const ec=t=>Zu(t)||qu(t),nc={compact:t=>Zu(t)?t.filter((t=>tc(t))):t,concat:(...t)=>[].concat(...t),includes:(t,e,n)=>!!ec(t)&&t.includes(e,n),indexof:(t,e)=>ec(t)?t.indexOf(e):-1,join:(t,e)=>Zu(t)?t.join(e):Ju,lastindexof:(t,e)=>ec(t)?t.lastIndexOf(e):-1,length:t=>ec(t)?t.length:0,pluck:(t,e)=>Zu(t)?t.map((t=>tc(t)?t[e]:Ju)):Ju,reverse:t=>Zu(t)?t.slice().reverse():qu(t)?t.split("").reverse().join(""):Ju,slice:(t,e,n)=>ec(t)?t.slice(e,n):Ju};function rc(t,e,n="0"){const r=t+"",i=r.length;return i<e?Array(e-i+1).join(n)+r:r}const ic=t=>(t<10?"0":"")+t,oc=t=>t<0?"-"+rc(-t,6):t>9999?"+"+rc(t,6):rc(t,4);function sc(t,e,n,r,i,o,s,a,l){const u=a?"Z":"";return oc(t)+"-"+ic(e+1)+"-"+ic(n)+(!l||s?"T"+ic(r)+":"+ic(i)+":"+ic(o)+"."+rc(s,3)+u:o?"T"+ic(r)+":"+ic(i)+":"+ic(o)+u:i||r||!a?"T"+ic(r)+":"+ic(i)+u:"")}function ac(t,e){return isNaN(t)?"Invalid Date":sc(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds(),!1,e)}function lc(t,e){return isNaN(t)?"Invalid Date":sc(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds(),!0,e)}const uc=/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/;function cc(t){return t.match(uc)&&!isNaN(Date.parse(t))}const hc=864e5,fc=6048e5,dc=new Date,pc=new Date,mc=t=>(dc.setTime("string"==typeof t?function(t,e=Date.parse){return cc(t)?e(t):t}(t):t),dc),gc={format_date:(t,e)=>ac(mc(t),!e),format_utcdate:(t,e)=>lc(mc(t),!e),timestamp:t=>+mc(t),year:t=>mc(t).getFullYear(),quarter:t=>Math.floor(mc(t).getMonth()/3),month:t=>mc(t).getMonth(),date:t=>mc(t).getDate(),dayofweek:t=>mc(t).getDay(),hours:t=>mc(t).getHours(),minutes:t=>mc(t).getMinutes(),seconds:t=>mc(t).getSeconds(),milliseconds:t=>mc(t).getMilliseconds(),utcyear:t=>mc(t).getUTCFullYear(),utcquarter:t=>Math.floor(mc(t).getUTCMonth()/3),utcmonth:t=>mc(t).getUTCMonth(),utcdate:t=>mc(t).getUTCDate(),utcdayofweek:t=>mc(t).getUTCDay(),utchours:t=>mc(t).getUTCHours(),utcminutes:t=>mc(t).getUTCMinutes(),utcseconds:t=>mc(t).getUTCSeconds(),utcmilliseconds:t=>mc(t).getUTCMilliseconds(),datetime:function(t,e,n,r,i,o,s){return arguments.length?new Date(t,e||0,null==n?1:n,r||0,i||0,o||0,s||0):new Date(Date.now())},dayofyear:function(t){pc.setTime(+t),pc.setHours(0,0,0,0),dc.setTime(+pc),dc.setMonth(0),dc.setDate(1);const e=6e4*(pc.getTimezoneOffset()-dc.getTimezoneOffset());return Math.floor(1+(pc-dc-e)/hc)},week:function(t,e){const n=e||0;pc.setTime(+t),pc.setDate(pc.getDate()-(pc.getDay()+7-n)%7),pc.setHours(0,0,0,0),dc.setTime(+t),dc.setMonth(0),dc.setDate(1),dc.setDate(1-(dc.getDay()+7-n)%7),dc.setHours(0,0,0,0);const r=6e4*(pc.getTimezoneOffset()-dc.getTimezoneOffset());return Math.floor((pc-dc+1-r)/fc)},utcdatetime:function(t,e,n,r,i,o,s){return arguments.length?new Date(Date.UTC(t,e||0,null==n?1:n,r||0,i||0,o||0,s||0)):new Date(Date.now())},utcdayofyear:function(t){pc.setTime(+t),pc.setUTCHours(0,0,0,0);const e=Date.UTC(pc.getUTCFullYear(),0,1);return Math.floor(1+(pc-e)/hc)},utcweek:function(t,e){const n=e||0;return pc.setTime(+t),pc.setUTCDate(pc.getUTCDate()-(pc.getUTCDay()+7-n)%7),pc.setUTCHours(0,0,0,0),dc.setTime(+t),dc.setUTCMonth(0),dc.setUTCDate(1),dc.setUTCDate(1-(dc.getUTCDay()+7-n)%7),dc.setUTCHours(0,0,0,0),Math.floor((pc-dc+1)/fc)},now:Date.now};function yc(t,e){return null!=t&&null!=e&&t==t&&e==e&&(t===e||(ju(t)||ju(e)?+t==+e:Vu(t)&&Vu(e)?t+""==e+"":!(!Uu(t)||!Uu(e))&&function(t,e){if(Object.getPrototypeOf(t)!==Object.getPrototypeOf(e))return!1;if(t.length||e.length)return bc(t,e);const n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;if(n.sort(),r.sort(),!bc(n,r,((t,e)=>t===e)))return!1;const i=n.length;for(let r=0;r<i;++r){const i=n[r];if(!yc(t[i],e[i]))return!1}return!0}(t,e)))}function bc(t,e,n=yc){const r=t.length;if(r!==e.length)return!1;for(let i=0;i<r;++i)if(!n(t[i],e[i]))return!1;return!0}const vc={parse_json:t=>JSON.parse(t),to_json:t=>JSON.stringify(t)};let wc=Math.random;function xc(){return wc()}function _c(t){return t instanceof Map}function kc(t){return _c(t)||function(t){return t instanceof Set}(t)}function Sc(t){return Array.from(t)}const Ec={has:(t,e)=>kc(t)?t.has(e):null!=t&&Gu(t,e),keys:t=>_c(t)?Sc(t.keys()):null!=t?Object.keys(t):[],values:t=>kc(t)?Sc(t.values()):null!=t?Object.values(t):[],entries:t=>kc(t)?Sc(t.entries()):null!=t?Object.entries(t):[],object:t=>t?Object.fromEntries(t):Ju};function Ac(t,e,n){let r=arguments.length;t=+t,e=+e,n=r<2?(e=t,t=0,1):r<3?1:+n,r=0|Math.max(0,Math.ceil((e-t)/n));const i=new Array(r);for(let e=0;e<r;++e)i[e]=t+e*n;return i}const Cc={parse_date:t=>null==t?t:new Date(t),parse_float:t=>null==t?t:Number.parseFloat(t),parse_int:(t,e)=>null==t?t:Number.parseInt(t,e),endswith:(t,e,n)=>null!=t&&String(t).endsWith(e,n),match:(t,e,n)=>{const r=null==t?t:String(t).match(e);return null==n||null==r?r:"number"==typeof n?r[n]:r.groups?r.groups[n]:null},normalize:(t,e)=>null==t?t:String(t).normalize(e),padend:(t,e,n)=>null==t?t:String(t).padEnd(e,n),padstart:(t,e,n)=>null==t?t:String(t).padStart(e,n),upper:t=>null==t?t:String(t).toUpperCase(),lower:t=>null==t?t:String(t).toLowerCase(),repeat:(t,e)=>null==t?t:String(t).repeat(e),replace:(t,e,n)=>null==t?t:String(t).replace(e,String(n)),substring:(t,e,n)=>null==t?t:String(t).substring(e,n),split:(t,e,n)=>null==t?[]:String(t).split(e,n),startswith:(t,e,n)=>null!=t&&String(t).startsWith(e,n),trim:t=>null==t?t:String(t).trim()},Dc={bin:function(t,e,n,r,i){return null==t?null:t<e?-1/0:t>n?1/0:(t=Math.max(e,Math.min(t,n)),e+r*Math.floor(1e-14+(t-e)/r+(i||0)))},equal:yc,recode:function(t,e,n){if(e instanceof Map){if(e.has(t))return e.get(t)}else if(Gu(e,t))return e[t];return void 0!==n?n:t},sequence:Ac,...nc,...gc,...vc,random:xc,is_nan:Number.isNaN,is_finite:Number.isFinite,abs:Math.abs,cbrt:Math.cbrt,ceil:Math.ceil,clz32:Math.clz32,exp:Math.exp,expm1:Math.expm1,floor:Math.floor,fround:Math.fround,greatest:Math.max,least:Math.min,log:Math.log,log10:Math.log10,log1p:Math.log1p,log2:Math.log2,pow:Math.pow,round:Math.round,sign:Math.sign,sqrt:Math.sqrt,trunc:Math.trunc,degrees:t=>180*t/Math.PI,radians:t=>Math.PI*t/180,acos:Math.acos,acosh:Math.acosh,asin:Math.asin,asinh:Math.asinh,atan:Math.atan,atan2:Math.atan2,atanh:Math.atanh,cos:Math.cos,cosh:Math.cosh,sin:Math.sin,sinh:Math.sinh,tan:Math.tan,tanh:Math.tanh,...Ec,...Cc};function Mc(t){return"bigint"==typeof t}function Oc(t){return void 0===t?t+"":Mc(t)?t+"n":JSON.stringify(t)}function Tc(t,e=[],n=[]){return new Ic(t,Tu(e),Tu(n))}class Ic{constructor(t,e,n){this.name=t,this.fields=e,this.params=n}toString(){const t=[...this.fields.map((t=>`d[${Oc(t)}]`)),...this.params.map(Oc)];return`d => op.${this.name}(${t})`}toObject(){return{expr:this.toString(),func:!0}}}const Nc=t=>Tc("any",t),$c=()=>Tc("count"),Fc=t=>Tc("array_agg",t),Lc=t=>Tc("array_agg_distinct",t),Bc=(t,e)=>Tc("map_agg",[t,e]),Rc=(t,e)=>Tc("object_agg",[t,e]),Pc=(t,e)=>Tc("entries_agg",[t,e]),zc={...Dc,row_object:(...t)=>Tc("row_object",null,t.flat()),count:$c,any:Nc,array_agg:Fc,array_agg_distinct:Lc,object_agg:Rc,map_agg:Bc,entries_agg:Pc,valid:t=>Tc("valid",t),invalid:t=>Tc("invalid",t),distinct:t=>Tc("distinct",t),mode:t=>Tc("mode",t),sum:t=>Tc("sum",t),product:t=>Tc("product",t),mean:t=>Tc("mean",t),average:t=>Tc("average",t),variance:t=>Tc("variance",t),variancep:t=>Tc("variancep",t),stdev:t=>Tc("stdev",t),stdevp:t=>Tc("stdevp",t),min:t=>Tc("min",t),max:t=>Tc("max",t),quantile:(t,e)=>Tc("quantile",t,e),median:t=>Tc("median",t),covariance:(t,e)=>Tc("covariance",[t,e]),covariancep:(t,e)=>Tc("covariancep",[t,e]),corr:(t,e)=>Tc("corr",[t,e]),bins:(t,e,n,r)=>Tc("bins",t,[e,n,r]),row_number:()=>Tc("row_number"),rank:()=>Tc("rank"),avg_rank:()=>Tc("avg_rank"),dense_rank:()=>Tc("dense_rank"),percent_rank:()=>Tc("percent_rank"),cume_dist:()=>Tc("cume_dist"),ntile:t=>Tc("ntile",null,t),lag:(t,e,n)=>Tc("lag",t,[e,n]),lead:(t,e,n)=>Tc("lead",t,[e,n]),first_value:t=>Tc("first_value",t),last_value:t=>Tc("last_value",t),nth_value:(t,e)=>Tc("nth_value",t,e),fill_down:(t,e)=>Tc("fill_down",t,e),fill_up:(t,e)=>Tc("fill_up",t,e)};const jc="ArrowFunctionExpression",Uc="FunctionExpression",Vc="Identifier",qc="Literal",Wc="MemberExpression",Hc="ObjectExpression",Gc="ObjectPattern",Yc="Property",Xc="Column",Jc="Constant",Kc="Dictionary",Qc="Parameter",Zc="Op",th=(t,e)=>{const n=ah[t.type];return n?n(t,e):$u(`Unsupported expression construct: ${t.type}`)},eh=(t,e)=>"("+th(t.left,e)+" "+t.operator+" "+th(t.right,e)+")",nh=(t,e)=>"("+ih(t.params,e)+")=>"+th(t.body,e),rh=(t,e)=>th(t.callee,e)+"("+ih(t.arguments,e)+")",ih=(t,e,n=",")=>t.map((t=>th(t,e))).join(n),oh=t=>t.computed?`[${Oc(t.name)}]`:`.${t.name}`,sh=(t,e,n)=>{const r=t.table||"";return`data${r}${oh(t)}.${n}(${e.index}${r})`},ah={Constant:t=>t.raw,Column:(t,e)=>sh(t,e,"get"),Dictionary:(t,e)=>sh(t,e,"key"),Function:t=>`fn.${t.name}`,Parameter:t=>`$${oh(t)}`,Op:(t,e)=>`op(${Oc(t.name)},${e.op||e.index})`,Literal:t=>t.raw,Identifier:t=>t.name,TemplateLiteral:(t,e)=>{const{quasis:n,expressions:r}=t,i=r.length;let o=n[0].value.raw;for(let t=0;t<i;)o+="${"+th(r[t],e)+"}"+n[++t].value.raw;return"`"+o+"`"},MemberExpression:(t,e)=>{const n=!t.computed,r=th(t.object,e),i=th(t.property,e);return r+(n?"."+i:"["+i+"]")},CallExpression:rh,NewExpression:(t,e)=>"new "+rh(t,e),ArrayExpression:(t,e)=>"["+ih(t.elements,e)+"]",AssignmentExpression:eh,BinaryExpression:eh,LogicalExpression:eh,UnaryExpression:(t,e)=>"("+t.operator+th(t.argument,e)+")",ConditionalExpression:(t,e)=>"("+th(t.test,e)+"?"+th(t.consequent,e)+":"+th(t.alternate,e)+")",ObjectExpression:(t,e)=>"({"+ih(t.properties,e)+"})",Property:(t,e)=>{const n=th(t.key,e);return(t.computed?`[${n}]`:n)+":"+th(t.value,e)},ArrowFunctionExpression:nh,FunctionExpression:nh,FunctionDeclaration:nh,ArrayPattern:(t,e)=>"["+ih(t.elements,e)+"]",ObjectPattern:(t,e)=>"{"+ih(t.properties,e)+"}",VariableDeclaration:(t,e)=>t.kind+" "+ih(t.declarations,e,","),VariableDeclarator:(t,e)=>th(t.id,e)+"="+th(t.init,e),SpreadElement:(t,e)=>"..."+th(t.argument,e),BlockStatement:(t,e)=>"{"+ih(t.body,e,";")+";}",BreakStatement:()=>"break",ExpressionStatement:(t,e)=>th(t.expression,e),IfStatement:(t,e)=>"if ("+th(t.test,e)+")"+th(t.consequent,e)+(t.alternate?" else "+th(t.alternate,e):""),SwitchStatement:(t,e)=>"switch ("+th(t.discriminant,e)+") {"+ih(t.cases,e,"")+"}",SwitchCase:(t,e)=>(t.test?"case "+th(t.test,e):"default")+": "+ih(t.consequent,e,";")+";",ReturnStatement:(t,e)=>"return "+th(t.argument,e),Program:(t,e)=>th(t.body[0],e)};function lh(t,e={index:"row"}){return th(t,e)}function uh(t){const e=typeof t;return"string"===e?`"${t}"`:"object"===e&&t?ju(t)?+t:Ou(t)||Qu(t)?`[${t.map(uh)}]`:Vu(t)?t+"":function(t){let e="{",n=-1;for(const r in t)++n>0&&(e+=","),e+=`"${r}":${uh(t[r])}`;return e+="}",e}(t):t}function ch(t,e){const n=t.length;return 1===n?(e,n)=>uh(t[0](e,n)):(r,i)=>{let o="";for(let s=0;s<n;++s){s>0&&(o+="|");const n=t[s](r,i);if(e&&(null==n||n!=n))return null;o+=uh(n)}return o}}function hh(){}function fh(t){return t.init=t.init||hh,t.add=t.add||hh,t.rem=t.rem||hh,t}function dh(t,e){return t.product_v=!1,t.product=e}const ph={count:{create:()=>fh({value:t=>t.count}),param:[]},array_agg:{create:()=>fh({init:t=>t.values=!0,value:t=>t.list.values(t.stream)}),param:[1]},object_agg:{create:()=>fh({init:t=>t.values=!0,value:t=>Object.fromEntries(t.list.values())}),param:[2]},map_agg:{create:()=>fh({init:t=>t.values=!0,value:t=>new Map(t.list.values())}),param:[2]},entries_agg:{create:()=>fh({init:t=>t.values=!0,value:t=>t.list.values(t.stream)}),param:[2]},any:{create:()=>fh({add:(t,e)=>{null==t.any&&(t.any=e)},value:t=>t.valid?t.any:Ju}),param:[1]},valid:{create:()=>fh({value:t=>t.valid}),param:[1]},invalid:{create:()=>fh({value:t=>t.count-t.valid}),param:[1]},distinct:{create:()=>({init:t=>t.distinct=function(){const t=new Map;return{count:()=>t.size,values:()=>Array.from(t.values(),(t=>t.v)),increment(e){const n=uh(e),r=t.get(n);r?++r.n:t.set(n,{v:e,n:1})},decrement(e){const n=uh(e),r=t.get(n);1===r.n?t.delete(n):--r.n},forEach(e){t.forEach((({v:t,n})=>e(t,n)))}}}(),value:t=>t.distinct.count()+(t.valid===t.count?0:1),add:(t,e)=>t.distinct.increment(e),rem:(t,e)=>t.distinct.decrement(e)}),param:[1]},array_agg_distinct:{create:()=>fh({value:t=>t.distinct.values()}),param:[1],req:["distinct"]},mode:{create:()=>fh({value:t=>{let e=Ju,n=0;return t.distinct.forEach(((t,r)=>{r>n&&(n=r,e=t)})),e}}),param:[1],req:["distinct"]},sum:{create:()=>({init:t=>t.sum=0,value:t=>t.valid?t.sum:Ju,add:(t,e)=>Mc(e)?0===t.sum?t.sum=e:t.sum+=e:t.sum+=+e,rem:(t,e)=>t.sum-=e}),param:[1]},product:{create:()=>({init:t=>dh(t,1),value:t=>t.valid?t.product_v?dh(t,function(t,e=0,n=t.length){let r=t[e++];for(let i=e;i<n;++i)r*=t[i];return r}(t.list.values())):t.product:void 0,add:(t,e)=>Mc(e)&&1===t.product?t.product=e:t.product*=e,rem:(t,e)=>0==e||e===1/0||e===-1/0?t.product_v=!0:t.product/=e}),param:[1],stream:["array_agg"]},mean:{create:()=>({init:t=>t.mean=0,value:t=>t.valid?t.mean:Ju,add:(t,e)=>{t.mean_d=e-t.mean,t.mean+=t.mean_d/t.valid},rem:(t,e)=>{t.mean_d=e-t.mean,t.mean-=t.valid?t.mean_d/t.valid:t.mean}}),param:[1]},average:{create:()=>fh({value:t=>t.valid?t.mean:Ju}),param:[1],req:["mean"]},variance:{create:()=>({init:t=>t.dev=0,value:t=>t.valid>1?t.dev/(t.valid-1):Ju,add:(t,e)=>t.dev+=t.mean_d*(e-t.mean),rem:(t,e)=>t.dev-=t.mean_d*(e-t.mean)}),param:[1],req:["mean"]},variancep:{create:()=>fh({value:t=>t.valid>1?t.dev/t.valid:Ju}),param:[1],req:["variance"]},stdev:{create:()=>fh({value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid-1)):Ju}),param:[1],req:["variance"]},stdevp:{create:()=>fh({value:t=>t.valid>1?Math.sqrt(t.dev/t.valid):Ju}),param:[1],req:["variance"]},min:{create:()=>({init:t=>t.min=Ju,value:t=>t.min=Number.isNaN(t.min)?t.list.min():t.min,add:(t,e)=>{(e<t.min||t.min===Ju)&&(t.min=e)},rem:(t,e)=>{e<=t.min&&(t.min=NaN)}}),param:[1],stream:["array_agg"]},max:{create:()=>({init:t=>t.max=Ju,value:t=>t.max=Number.isNaN(t.max)?t.list.max():t.max,add:(t,e)=>{(e>t.max||t.max===Ju)&&(t.max=e)},rem:(t,e)=>{e>=t.max&&(t.max=NaN)}}),param:[1],stream:["array_agg"]},quantile:{create:t=>fh({value:e=>e.list.quantile(t)}),param:[1,1],req:["array_agg"]},median:{create:()=>fh({value:t=>t.list.quantile(.5)}),param:[1],req:["array_agg"]},covariance:{create:()=>({init:t=>{t.cov=t.mean_x=t.mean_y=t.dev_x=t.dev_y=0},value:t=>t.valid>1?t.cov/(t.valid-1):Ju,add:(t,e,n)=>{const r=e-t.mean_x,i=n-t.mean_y;t.mean_x+=r/t.valid,t.mean_y+=i/t.valid;const o=n-t.mean_y;t.dev_x+=r*(e-t.mean_x),t.dev_y+=i*o,t.cov+=r*o},rem:(t,e,n)=>{const r=e-t.mean_x,i=n-t.mean_y;t.mean_x-=t.valid?r/t.valid:t.mean_x,t.mean_y-=t.valid?i/t.valid:t.mean_y;const o=n-t.mean_y;t.dev_x-=r*(e-t.mean_x),t.dev_y-=i*o,t.cov-=r*o}}),param:[2]},covariancep:{create:()=>fh({value:t=>t.valid>1?t.cov/t.valid:Ju}),param:[2],req:["covariance"]},corr:{create:()=>fh({value:t=>t.valid>1?t.cov/(Math.sqrt(t.dev_x)*Math.sqrt(t.dev_y)):Ju}),param:[2],req:["covariance"]},bins:{create:(t,e,n,r)=>fh({value:i=>function(t,e,n=15,r=!0,i=0,o){const s=Math.LN10;if(null==o){const r=Math.ceil(Math.log(n)/s),a=e-t||Math.abs(t)||1,l=[5,2];for(o=Math.max(i,Math.pow(10,Math.round(Math.log(a)/s)-r));Math.ceil(a/o)>n;)o*=10;const u=l.length;for(let t=0;t<u;++t){const e=o/l[t];e>=i&&a/e<=n&&(o=e)}}if(r){let n=Math.log(o);const r=n>=0?0:1+~~(-n/s),i=Math.pow(10,-r-1);n=Math.floor(t/o+i)*o,t=t<n?n-o:n,e=Math.ceil(e/o)*o}return[t,e===t?t+o:e,o]}(i.min,i.max,t,e,n,r)}),param:[1,4],req:["min","max"]}},mh={create(){let t;return{init:()=>t=1,value:e=>{const n=e.index;return n&&!e.peer(n)?t=n+1:t}}},param:[]},gh={create(){let t;return{init:()=>t=0,value:e=>{const{index:n,peer:r,size:i}=e;let o=n;if(t<o){for(;o+1<i&&r(o+1);)++o;t=o}return(1+t)/i}}},param:[]},yh={row_number:{create:()=>({init:hh,value:t=>t.index+1}),param:[]},rank:mh,avg_rank:{create(){let t,e;return{init:()=>(t=-1,e=1),value:n=>{const r=n.index;if(r>=t){for(e=t=r+1;n.peer(t);e+=++t);e/=t-r}return e}}},param:[]},dense_rank:{create(){let t;return{init:()=>t=1,value:e=>{const n=e.index;return n&&!e.peer(n)?++t:t}}},param:[]},percent_rank:{create(){const{init:t,value:e}=mh.create();return{init:t,value:t=>(e(t)-1)/(t.size-1)}},param:[]},cume_dist:gh,ntile:{create(t){(t=+t)>0||$u("ntile num must be greater than zero.");const{init:e,value:n}=gh.create();return{init:e,value:e=>Math.ceil(t*n(e))}},param:[0,1]},lag:{create:(t,e=Ju)=>(t=+t||1,{init:hh,value:(n,r)=>{const i=n.index-t;return i>=0?n.value(i,r):e}}),param:[1,2]},lead:{create:(t,e=Ju)=>(t=+t||1,{init:hh,value:(n,r)=>{const i=n.index+t;return i<n.size?n.value(i,r):e}}),param:[1,2]},first_value:{create:()=>({init:hh,value:(t,e)=>t.value(t.i0,e)}),param:[1]},last_value:{create:()=>({init:hh,value:(t,e)=>t.value(t.i1-1,e)}),param:[1]},nth_value:{create:t=>((t=+t)>0||$u("nth_value nth must be greater than zero."),{init:hh,value:(e,n)=>{const r=e.i0+(t-1);return r<e.i1?e.value(r,n):Ju}}),param:[1,1]},fill_down:{create(t=Ju){let e;return{init:()=>e=t,value:(t,n)=>{const r=t.value(t.index,n);return tc(r)?e=r:e}}},param:[1,1]},fill_up:{create(t=Ju){let e,n;return{init:()=>(e=t,n=-1),value:(r,i)=>r.index<=n?e:(n=function(t,e,n){for(const r=t.size;n<r;++n)if(tc(t.value(n,e)))return n;return-1}(r,i,r.index))>=0?e=r.value(n,i):(n=r.size,e=t)}},param:[1,1]}};function bh(t){return Gu(ph,t)}function vh(t){return Gu(yh,t)}function wh(t){return Gu(Dc,t)||"row_object"===t}function xh(t){return bh(t)&&ph[t]}function _h(t){return vh(t)&&yh[t]}function kh(t,e,n){return t=`"use strict"; return ${t};`,Function("fn","$",t)(e,n)}const Sh={escape:(t,e,n)=>kh(t,e,n),expr:(t,e)=>kh(`(row,data,op)=>${t}`,Dc,e),expr2:(t,e)=>kh(`(row0,data0,row,data)=>${t}`,Dc,e),join:(t,e)=>kh(`(row1,data1,row2,data2)=>${t}`,Dc,e),param:(t,e)=>kh(t,Dc,e)},Eh={"==":1,"!=":1,"===":1,"!==":1};function Ah(t,e,n=0,r,i){if(t.type=Xc,t.name=e,t.table=n,i&&r&&Lu(r.keyFor)){const e=Eh[i.operator]?i.left===t?i.right:i.left:i.callee&&"equal"===i.callee.name?i.arguments[i.arguments[0]===t?1:0]:null;e&&e.type===qc&&function(t,e,n,r){r<0?(t.type=qc,t.value=!1,t.raw="false"):(e.type=Kc,n.value=r,n.raw=r+"")}(i,t,e,r.keyFor(e.value))}return t}function Ch(t){return Ou(t)?t:_c(t)?t.entries():t?Object.entries(t):[]}const Dh="row_object";function Mh(t,e){t.type=Hc;const n=t.properties=[];for(const t of Ch(e)){const[e,r]=Ou(t)?t:[t,t];n.push({type:Yc,key:{type:qc,raw:Oc(r)},value:Ah({computed:!0},e)})}return t}function Oh(t){return lh(Mh({},t))}function Th(t){return Sh.expr(Oh(t))}var Ih,Nh,$h,Fh,Lh,Bh,Rh,Ph,zh;!function(t){t[t.V1=0]="V1",t[t.V2=1]="V2",t[t.V3=2]="V3",t[t.V4=3]="V4",t[t.V5=4]="V5"}(Ih||(Ih={})),function(t){t[t.Sparse=0]="Sparse",t[t.Dense=1]="Dense"}(Nh||(Nh={})),function(t){t[t.HALF=0]="HALF",t[t.SINGLE=1]="SINGLE",t[t.DOUBLE=2]="DOUBLE"}($h||($h={})),function(t){t[t.DAY=0]="DAY",t[t.MILLISECOND=1]="MILLISECOND"}(Fh||(Fh={})),function(t){t[t.SECOND=0]="SECOND",t[t.MILLISECOND=1]="MILLISECOND",t[t.MICROSECOND=2]="MICROSECOND",t[t.NANOSECOND=3]="NANOSECOND"}(Lh||(Lh={})),function(t){t[t.YEAR_MONTH=0]="YEAR_MONTH",t[t.DAY_TIME=1]="DAY_TIME",t[t.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"}(Bh||(Bh={})),function(t){t[t.NONE=0]="NONE",t[t.Schema=1]="Schema",t[t.DictionaryBatch=2]="DictionaryBatch",t[t.RecordBatch=3]="RecordBatch",t[t.Tensor=4]="Tensor",t[t.SparseTensor=5]="SparseTensor"}(Rh||(Rh={})),function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.Float=3]="Float",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct=13]="Struct",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Duration=18]="Duration",t[t.Dictionary=-1]="Dictionary",t[t.Int8=-2]="Int8",t[t.Int16=-3]="Int16",t[t.Int32=-4]="Int32",t[t.Int64=-5]="Int64",t[t.Uint8=-6]="Uint8",t[t.Uint16=-7]="Uint16",t[t.Uint32=-8]="Uint32",t[t.Uint64=-9]="Uint64",t[t.Float16=-10]="Float16",t[t.Float32=-11]="Float32",t[t.Float64=-12]="Float64",t[t.DateDay=-13]="DateDay",t[t.DateMillisecond=-14]="DateMillisecond",t[t.TimestampSecond=-15]="TimestampSecond",t[t.TimestampMillisecond=-16]="TimestampMillisecond",t[t.TimestampMicrosecond=-17]="TimestampMicrosecond",t[t.TimestampNanosecond=-18]="TimestampNanosecond",t[t.TimeSecond=-19]="TimeSecond",t[t.TimeMillisecond=-20]="TimeMillisecond",t[t.TimeMicrosecond=-21]="TimeMicrosecond",t[t.TimeNanosecond=-22]="TimeNanosecond",t[t.DenseUnion=-23]="DenseUnion",t[t.SparseUnion=-24]="SparseUnion",t[t.IntervalDayTime=-25]="IntervalDayTime",t[t.IntervalYearMonth=-26]="IntervalYearMonth",t[t.DurationSecond=-27]="DurationSecond",t[t.DurationMillisecond=-28]="DurationMillisecond",t[t.DurationMicrosecond=-29]="DurationMicrosecond",t[t.DurationNanosecond=-30]="DurationNanosecond"}(Ph||(Ph={})),function(t){t[t.OFFSET=0]="OFFSET",t[t.DATA=1]="DATA",t[t.VALIDITY=2]="VALIDITY",t[t.TYPE=3]="TYPE"}(zh||(zh={}));const jh=void 0;function Uh(t){if(null===t)return"null";if(t===jh)return"undefined";switch(typeof t){case"number":case"bigint":return`${t}`;case"string":return`"${t}"`}return"function"==typeof t[Symbol.toPrimitive]?t[Symbol.toPrimitive]("string"):ArrayBuffer.isView(t)?t instanceof BigInt64Array||t instanceof BigUint64Array?`[${[...t].map((t=>Uh(t)))}]`:`[${t}]`:ArrayBuffer.isView(t)?`[${t}]`:JSON.stringify(t,((t,e)=>"bigint"==typeof e?`${e}`:e))}function Vh(t,e,n,r){return new(n||(n=Promise))((function(i,o){function s(t){try{l(r.next(t))}catch(t){o(t)}}function a(t){try{l(r.throw(t))}catch(t){o(t)}}function l(t){t.done?i(t.value):function(t){return t instanceof n?t:new n((function(e){e(t)}))}(t.value).then(s,a)}l((r=r.apply(t,e||[])).next())}))}function qh(t){return this instanceof qh?(this.v=t,this):new qh(t)}function Wh(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r,i=n.apply(t,e||[]),o=[];return r={},s("next"),s("throw"),s("return"),r[Symbol.asyncIterator]=function(){return this},r;function s(t){i[t]&&(r[t]=function(e){return new Promise((function(n,r){o.push([t,e,n,r])>1||a(t,e)}))})}function a(t,e){try{(n=i[t](e)).value instanceof qh?Promise.resolve(n.value.v).then(l,u):c(o[0][2],n)}catch(t){c(o[0][3],t)}var n}function l(t){a("next",t)}function u(t){a("throw",t)}function c(t,e){t(e),o.shift(),o.length&&a(o[0][0],o[0][1])}}function Hh(t){var e,n;return e={},r("next"),r("throw",(function(t){throw t})),r("return"),e[Symbol.iterator]=function(){return this},e;function r(r,i){e[r]=t[r]?function(e){return(n=!n)?{value:qh(t[r](e)),done:!1}:i?i(e):e}:i}}function Gh(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e,n=t[Symbol.asyncIterator];return n?n.call(t):(t=function(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),e={},r("next"),r("throw"),r("return"),e[Symbol.asyncIterator]=function(){return this},e);function r(n){e[n]=t[n]&&function(e){return new Promise((function(r,i){!function(t,e,n,r){Promise.resolve(r).then((function(e){t({value:e,done:n})}),e)}(r,i,(e=t[n](e)).done,e.value)}))}}}Object.create,Object.create,"function"==typeof SuppressedError&&SuppressedError;const Yh=new TextDecoder("utf-8"),Xh=t=>Yh.decode(t),Jh=new TextEncoder,Kh=t=>Jh.encode(t),Qh=t=>"boolean"==typeof t,Zh=t=>"function"==typeof t,tf=t=>null!=t&&Object(t)===t,ef=t=>tf(t)&&Zh(t.then),nf=t=>tf(t)&&Zh(t[Symbol.iterator]),rf=t=>tf(t)&&Zh(t[Symbol.asyncIterator]),of=t=>tf(t)&&tf(t.schema),sf=t=>tf(t)&&"done"in t&&"value"in t,af=t=>tf(t)&&Zh(t.stat)&&(t=>"number"==typeof t)(t.fd),lf=t=>tf(t)&&cf(t.body),uf=t=>"_getDOMStream"in t&&"_getNodeStream"in t,cf=t=>tf(t)&&Zh(t.cancel)&&Zh(t.getReader)&&!uf(t),hf=t=>tf(t)&&Zh(t.read)&&Zh(t.pipe)&&Qh(t.readable)&&!uf(t),ff=t=>tf(t)&&Zh(t.clear)&&Zh(t.bytes)&&Zh(t.position)&&Zh(t.setPosition)&&Zh(t.capacity)&&Zh(t.getBufferIdentifier)&&Zh(t.createLong),df="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;function pf(t,e,n=0,r=e.byteLength){const i=t.byteLength,o=new Uint8Array(t.buffer,t.byteOffset,i),s=new Uint8Array(e.buffer,e.byteOffset,Math.min(r,i));return o.set(s,n),t}function mf(t,e){const n=function(t){const e=t[0]?[t[0]]:[];let n,r,i,o;for(let s,a,l=0,u=0,c=t.length;++l<c;)s=e[u],a=t[l],!s||!a||s.buffer!==a.buffer||a.byteOffset<s.byteOffset?a&&(e[++u]=a):(({byteOffset:n,byteLength:i}=s),({byteOffset:r,byteLength:o}=a),n+i<r||r+o<n?a&&(e[++u]=a):e[u]=new Uint8Array(s.buffer,n,r-n+o));return e}(t),r=n.reduce(((t,e)=>t+e.byteLength),0);let i,o,s,a=0,l=-1;const u=Math.min(e||Number.POSITIVE_INFINITY,r);for(const t=n.length;++l<t;){if(i=n[l],o=i.subarray(0,Math.min(i.length,u-a)),u<=a+o.length){o.length<i.length?n[l]=i.subarray(o.length):o.length===i.length&&l++,s?pf(s,o,a):s=o;break}pf(s||(s=new Uint8Array(u)),o,a),a+=o.length}return[s||new Uint8Array(0),n.slice(l),r-(s?s.byteLength:0)]}function gf(t,e){let n=sf(e)?e.value:e;return n instanceof t?t===Uint8Array?new t(n.buffer,n.byteOffset,n.byteLength):n:n?("string"==typeof n&&(n=Kh(n)),n instanceof ArrayBuffer||n instanceof df?new t(n):ff(n)?gf(t,n.bytes()):ArrayBuffer.isView(n)?n.byteLength<=0?new t(0):new t(n.buffer,n.byteOffset,n.byteLength/t.BYTES_PER_ELEMENT):t.from(n)):new t(0)}const yf=t=>gf(Int32Array,t),bf=t=>gf(Uint8Array,t),vf=t=>(t.next(),t);function wf(t,e){return Wh(this,arguments,(function*(){if(ef(e))return yield qh(yield qh(yield*Hh(Gh(wf(t,yield qh(e))))));const n=function(t){return Wh(this,arguments,(function*(){yield yield qh(yield qh(t))}))},r="string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof df?n(e):nf(e)?function(t){return Wh(this,arguments,(function*(){yield qh(yield*Hh(Gh(vf(function*(t){let e=null;do{e=t.next(yield null==e?void 0:e.value)}while(!e.done)}(t[Symbol.iterator]())))))}))}(e):rf(e)?e:n(e);return yield qh(yield*Hh(Gh(vf(function(e){return Wh(this,arguments,(function*(){let n=null;do{n=yield qh(e.next(yield yield qh(gf(t,n))))}while(!n.done)}))}(r[Symbol.asyncIterator]()))))),yield qh(new t)}))}function xf(t,e,n){if(0!==t)for(let r=-1,i=(n=n.slice(0,e)).length;++r<i;)n[r]+=t;return n.subarray(0,e)}const _f=Symbol.for("isArrowBigNum");function kf(t,...e){return 0===e.length?Object.setPrototypeOf(gf(this.TypedArray,t),this.constructor.prototype):Object.setPrototypeOf(new this.TypedArray(t,...e),this.constructor.prototype)}function Sf(...t){return kf.apply(this,t)}function Ef(...t){return kf.apply(this,t)}function Af(...t){return kf.apply(this,t)}function Cf(t){const{buffer:e,byteOffset:n,length:r,signed:i}=t,o=new BigUint64Array(e,n,r),s=i&&o.at(-1)&BigInt(1)<<BigInt(63);let a=s?BigInt(1):BigInt(0),l=BigInt(0);if(s){for(const t of o)a+=~t*(BigInt(1)<<BigInt(32)*l++);a*=BigInt(-1)}else for(const t of o)a+=t*(BigInt(1)<<BigInt(32)*l++);return a}kf.prototype[_f]=!0,kf.prototype.toJSON=function(){return`"${Df(this)}"`},kf.prototype.valueOf=function(){return Cf(this)},kf.prototype.toString=function(){return Df(this)},kf.prototype[Symbol.toPrimitive]=function(t="default"){switch(t){case"number":return Cf(this);case"string":return Df(this);case"default":return Mf(this)}return Df(this)},Object.setPrototypeOf(Sf.prototype,Object.create(Int32Array.prototype)),Object.setPrototypeOf(Ef.prototype,Object.create(Uint32Array.prototype)),Object.setPrototypeOf(Af.prototype,Object.create(Uint32Array.prototype)),Object.assign(Sf.prototype,kf.prototype,{constructor:Sf,signed:!0,TypedArray:Int32Array,BigIntArray:BigInt64Array}),Object.assign(Ef.prototype,kf.prototype,{constructor:Ef,signed:!1,TypedArray:Uint32Array,BigIntArray:BigUint64Array}),Object.assign(Af.prototype,kf.prototype,{constructor:Af,signed:!0,TypedArray:Uint32Array,BigIntArray:BigUint64Array});const Df=t=>{if(8===t.byteLength)return`${new t.BigIntArray(t.buffer,t.byteOffset,1)[0]}`;if(!t.signed)return Of(t);let e=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2);if(new Int16Array([e.at(-1)])[0]>=0)return Of(t);e=e.slice();let n=1;for(let t=0;t<e.length;t++){const r=e[t],i=~r+n;e[t]=i,n&=0===r?1:0}return`-${Of(e)}`},Mf=t=>8===t.byteLength?new t.BigIntArray(t.buffer,t.byteOffset,1)[0]:Df(t);function Of(t){let e="";const n=new Uint32Array(2);let r=new Uint16Array(t.buffer,t.byteOffset,t.byteLength/2);const i=new Uint32Array((r=new Uint16Array(r).reverse()).buffer);let o=-1;const s=r.length-1;do{for(n[0]=r[o=0];o<s;)r[o++]=n[1]=n[0]/10,n[0]=(n[0]-10*n[1]<<16)+r[o];r[o]=n[1]=n[0]/10,n[0]=n[0]-10*n[1],e=`${n[0]}${e}`}while(i[0]||i[1]||i[2]||i[3]);return null!=e?e:"0"}class Tf{static new(t,e){switch(e){case!0:return new Sf(t);case!1:return new Ef(t)}switch(t.constructor){case Int8Array:case Int16Array:case Int32Array:case BigInt64Array:return new Sf(t)}return 16===t.byteLength?new Af(t):new Ef(t)}static signed(t){return new Sf(t)}static unsigned(t){return new Ef(t)}static decimal(t){return new Af(t)}constructor(t,e){return Tf.new(t,e)}}function If(t){if("bigint"==typeof t&&(t<Number.MIN_SAFE_INTEGER||t>Number.MAX_SAFE_INTEGER))throw new TypeError(`${t} is not safe to convert to a number.`);return Number(t)}var Nf,$f,Ff,Lf,Bf,Rf,Pf,zf,jf,Uf,Vf,qf,Wf,Hf,Gf,Yf,Xf,Jf,Kf,Qf,Zf;class td{static isNull(t){return(null==t?void 0:t.typeId)===Ph.Null}static isInt(t){return(null==t?void 0:t.typeId)===Ph.Int}static isFloat(t){return(null==t?void 0:t.typeId)===Ph.Float}static isBinary(t){return(null==t?void 0:t.typeId)===Ph.Binary}static isUtf8(t){return(null==t?void 0:t.typeId)===Ph.Utf8}static isBool(t){return(null==t?void 0:t.typeId)===Ph.Bool}static isDecimal(t){return(null==t?void 0:t.typeId)===Ph.Decimal}static isDate(t){return(null==t?void 0:t.typeId)===Ph.Date}static isTime(t){return(null==t?void 0:t.typeId)===Ph.Time}static isTimestamp(t){return(null==t?void 0:t.typeId)===Ph.Timestamp}static isInterval(t){return(null==t?void 0:t.typeId)===Ph.Interval}static isDuration(t){return(null==t?void 0:t.typeId)===Ph.Duration}static isList(t){return(null==t?void 0:t.typeId)===Ph.List}static isStruct(t){return(null==t?void 0:t.typeId)===Ph.Struct}static isUnion(t){return(null==t?void 0:t.typeId)===Ph.Union}static isFixedSizeBinary(t){return(null==t?void 0:t.typeId)===Ph.FixedSizeBinary}static isFixedSizeList(t){return(null==t?void 0:t.typeId)===Ph.FixedSizeList}static isMap(t){return(null==t?void 0:t.typeId)===Ph.Map}static isDictionary(t){return(null==t?void 0:t.typeId)===Ph.Dictionary}static isDenseUnion(t){return td.isUnion(t)&&t.mode===Nh.Dense}static isSparseUnion(t){return td.isUnion(t)&&t.mode===Nh.Sparse}get typeId(){return Ph.NONE}}Nf=Symbol.toStringTag,td[Nf]=((Zf=td.prototype).children=null,Zf.ArrayType=Array,Zf[Symbol.toStringTag]="DataType");class ed extends td{toString(){return"Null"}get typeId(){return Ph.Null}}$f=Symbol.toStringTag,ed[$f]=(t=>t[Symbol.toStringTag]="Null")(ed.prototype);class nd extends td{constructor(t,e){super(),this.isSigned=t,this.bitWidth=e}get typeId(){return Ph.Int}get ArrayType(){switch(this.bitWidth){case 8:return this.isSigned?Int8Array:Uint8Array;case 16:return this.isSigned?Int16Array:Uint16Array;case 32:return this.isSigned?Int32Array:Uint32Array;case 64:return this.isSigned?BigInt64Array:BigUint64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`${this.isSigned?"I":"Ui"}nt${this.bitWidth}`}}Ff=Symbol.toStringTag,nd[Ff]=(t=>(t.isSigned=null,t.bitWidth=null,t[Symbol.toStringTag]="Int"))(nd.prototype);class rd extends nd{constructor(){super(!0,8)}get ArrayType(){return Int8Array}}class id extends nd{constructor(){super(!0,16)}get ArrayType(){return Int16Array}}class od extends nd{constructor(){super(!0,32)}get ArrayType(){return Int32Array}}class sd extends nd{constructor(){super(!0,64)}get ArrayType(){return BigInt64Array}}class ad extends nd{constructor(){super(!1,8)}get ArrayType(){return Uint8Array}}class ld extends nd{constructor(){super(!1,16)}get ArrayType(){return Uint16Array}}class ud extends nd{constructor(){super(!1,32)}get ArrayType(){return Uint32Array}}class cd extends nd{constructor(){super(!1,64)}get ArrayType(){return BigUint64Array}}Object.defineProperty(rd.prototype,"ArrayType",{value:Int8Array}),Object.defineProperty(id.prototype,"ArrayType",{value:Int16Array}),Object.defineProperty(od.prototype,"ArrayType",{value:Int32Array}),Object.defineProperty(sd.prototype,"ArrayType",{value:BigInt64Array}),Object.defineProperty(ad.prototype,"ArrayType",{value:Uint8Array}),Object.defineProperty(ld.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(ud.prototype,"ArrayType",{value:Uint32Array}),Object.defineProperty(cd.prototype,"ArrayType",{value:BigUint64Array});class hd extends td{constructor(t){super(),this.precision=t}get typeId(){return Ph.Float}get ArrayType(){switch(this.precision){case $h.HALF:return Uint16Array;case $h.SINGLE:return Float32Array;case $h.DOUBLE:return Float64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}toString(){return`Float${this.precision<<5||16}`}}Lf=Symbol.toStringTag,hd[Lf]=(t=>(t.precision=null,t[Symbol.toStringTag]="Float"))(hd.prototype);class fd extends hd{constructor(){super($h.HALF)}}class dd extends hd{constructor(){super($h.SINGLE)}}class pd extends hd{constructor(){super($h.DOUBLE)}}Object.defineProperty(fd.prototype,"ArrayType",{value:Uint16Array}),Object.defineProperty(dd.prototype,"ArrayType",{value:Float32Array}),Object.defineProperty(pd.prototype,"ArrayType",{value:Float64Array});class md extends td{constructor(){super()}get typeId(){return Ph.Binary}toString(){return"Binary"}}Bf=Symbol.toStringTag,md[Bf]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Binary"))(md.prototype);class gd extends td{constructor(){super()}get typeId(){return Ph.Utf8}toString(){return"Utf8"}}Rf=Symbol.toStringTag,gd[Rf]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Utf8"))(gd.prototype);class yd extends td{constructor(){super()}get typeId(){return Ph.Bool}toString(){return"Bool"}}Pf=Symbol.toStringTag,yd[Pf]=(t=>(t.ArrayType=Uint8Array,t[Symbol.toStringTag]="Bool"))(yd.prototype);class bd extends td{constructor(t,e,n=128){super(),this.scale=t,this.precision=e,this.bitWidth=n}get typeId(){return Ph.Decimal}toString(){return`Decimal[${this.precision}e${this.scale>0?"+":""}${this.scale}]`}}zf=Symbol.toStringTag,bd[zf]=(t=>(t.scale=null,t.precision=null,t.ArrayType=Uint32Array,t[Symbol.toStringTag]="Decimal"))(bd.prototype);class vd extends td{constructor(t){super(),this.unit=t}get typeId(){return Ph.Date}toString(){return`Date${32*(this.unit+1)}<${Fh[this.unit]}>`}}jf=Symbol.toStringTag,vd[jf]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Date"))(vd.prototype);class wd extends vd{constructor(){super(Fh.DAY)}}class xd extends vd{constructor(){super(Fh.MILLISECOND)}}class _d extends td{constructor(t,e){super(),this.unit=t,this.bitWidth=e}get typeId(){return Ph.Time}toString(){return`Time${this.bitWidth}<${Lh[this.unit]}>`}get ArrayType(){switch(this.bitWidth){case 32:return Int32Array;case 64:return BigInt64Array}throw new Error(`Unrecognized ${this[Symbol.toStringTag]} type`)}}Uf=Symbol.toStringTag,_d[Uf]=(t=>(t.unit=null,t.bitWidth=null,t[Symbol.toStringTag]="Time"))(_d.prototype);class kd extends _d{constructor(){super(Lh.SECOND,32)}}class Sd extends _d{constructor(){super(Lh.MILLISECOND,32)}}class Ed extends _d{constructor(){super(Lh.MICROSECOND,64)}}class Ad extends _d{constructor(){super(Lh.NANOSECOND,64)}}class Cd extends td{constructor(t,e){super(),this.unit=t,this.timezone=e}get typeId(){return Ph.Timestamp}toString(){return`Timestamp<${Lh[this.unit]}${this.timezone?`, ${this.timezone}`:""}>`}}Vf=Symbol.toStringTag,Cd[Vf]=(t=>(t.unit=null,t.timezone=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Timestamp"))(Cd.prototype);class Dd extends td{constructor(t){super(),this.unit=t}get typeId(){return Ph.Interval}toString(){return`Interval<${Bh[this.unit]}>`}}qf=Symbol.toStringTag,Dd[qf]=(t=>(t.unit=null,t.ArrayType=Int32Array,t[Symbol.toStringTag]="Interval"))(Dd.prototype);class Md extends Dd{constructor(){super(Bh.DAY_TIME)}}class Od extends Dd{constructor(){super(Bh.YEAR_MONTH)}}class Td extends td{constructor(t){super(),this.unit=t}get typeId(){return Ph.Duration}toString(){return`Duration<${Lh[this.unit]}>`}}Wf=Symbol.toStringTag,Td[Wf]=(t=>(t.unit=null,t.ArrayType=BigInt64Array,t[Symbol.toStringTag]="Duration"))(Td.prototype);class Id extends td{constructor(t){super(),this.children=[t]}get typeId(){return Ph.List}toString(){return`List<${this.valueType}>`}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}}Hf=Symbol.toStringTag,Id[Hf]=(t=>(t.children=null,t[Symbol.toStringTag]="List"))(Id.prototype);class Nd extends td{constructor(t){super(),this.children=t}get typeId(){return Ph.Struct}toString(){return`Struct<{${this.children.map((t=>`${t.name}:${t.type}`)).join(", ")}}>`}}Gf=Symbol.toStringTag,Nd[Gf]=(t=>(t.children=null,t[Symbol.toStringTag]="Struct"))(Nd.prototype);class $d extends td{constructor(t,e,n){super(),this.mode=t,this.children=n,this.typeIds=e=Int32Array.from(e),this.typeIdToChildIndex=e.reduce(((t,e,n)=>(t[e]=n)&&t||t),Object.create(null))}get typeId(){return Ph.Union}toString(){return`${this[Symbol.toStringTag]}<${this.children.map((t=>`${t.type}`)).join(" | ")}>`}}Yf=Symbol.toStringTag,$d[Yf]=(t=>(t.mode=null,t.typeIds=null,t.children=null,t.typeIdToChildIndex=null,t.ArrayType=Int8Array,t[Symbol.toStringTag]="Union"))($d.prototype);class Fd extends td{constructor(t){super(),this.byteWidth=t}get typeId(){return Ph.FixedSizeBinary}toString(){return`FixedSizeBinary[${this.byteWidth}]`}}Xf=Symbol.toStringTag,Fd[Xf]=(t=>(t.byteWidth=null,t.ArrayType=Uint8Array,t[Symbol.toStringTag]="FixedSizeBinary"))(Fd.prototype);class Ld extends td{constructor(t,e){super(),this.listSize=t,this.children=[e]}get typeId(){return Ph.FixedSizeList}get valueType(){return this.children[0].type}get valueField(){return this.children[0]}get ArrayType(){return this.valueType.ArrayType}toString(){return`FixedSizeList[${this.listSize}]<${this.valueType}>`}}Jf=Symbol.toStringTag,Ld[Jf]=(t=>(t.children=null,t.listSize=null,t[Symbol.toStringTag]="FixedSizeList"))(Ld.prototype);class Bd extends td{constructor(t,e=!1){var n,r,i;if(super(),this.children=[t],this.keysSorted=e,t&&(t.name="entries",null===(n=null==t?void 0:t.type)||void 0===n?void 0:n.children)){const e=null===(r=null==t?void 0:t.type)||void 0===r?void 0:r.children[0];e&&(e.name="key");const n=null===(i=null==t?void 0:t.type)||void 0===i?void 0:i.children[1];n&&(n.name="value")}}get typeId(){return Ph.Map}get keyType(){return this.children[0].type.children[0].type}get valueType(){return this.children[0].type.children[1].type}get childType(){return this.children[0].type}toString(){return`Map<{${this.children[0].type.children.map((t=>`${t.name}:${t.type}`)).join(", ")}}>`}}Kf=Symbol.toStringTag,Bd[Kf]=(t=>(t.children=null,t.keysSorted=null,t[Symbol.toStringTag]="Map_"))(Bd.prototype);const Rd=(Pd=-1,()=>++Pd);var Pd;class zd extends td{constructor(t,e,n,r){super(),this.indices=e,this.dictionary=t,this.isOrdered=r||!1,this.id=null==n?Rd():If(n)}get typeId(){return Ph.Dictionary}get children(){return this.dictionary.children}get valueType(){return this.dictionary}get ArrayType(){return this.dictionary.ArrayType}toString(){return`Dictionary<${this.indices}, ${this.dictionary}>`}}function jd(t){const e=t;switch(t.typeId){case Ph.Decimal:return t.bitWidth/32;case Ph.Timestamp:return 2;case Ph.Date:case Ph.Interval:return 1+e.unit;case Ph.FixedSizeList:return e.listSize;case Ph.FixedSizeBinary:return e.byteWidth;default:return 1}}Qf=Symbol.toStringTag,zd[Qf]=(t=>(t.id=null,t.indices=null,t.isOrdered=null,t.dictionary=null,t[Symbol.toStringTag]="Dictionary"))(zd.prototype);class Ud{visitMany(t,...e){return t.map(((t,n)=>this.visit(t,...e.map((t=>t[n])))))}visit(...t){return this.getVisitFn(t[0],!1).apply(this,t)}getVisitFn(t,e=!0){return function(t,e,n=!0){return"number"==typeof e?Vd(t,e,n):"string"==typeof e&&e in Ph?Vd(t,Ph[e],n):e&&e instanceof td?Vd(t,qd(e),n):(null==e?void 0:e.type)&&e.type instanceof td?Vd(t,qd(e.type),n):Vd(t,Ph.NONE,n)}(this,t,e)}getVisitFnByTypeId(t,e=!0){return Vd(this,t,e)}visitNull(t,...e){return null}visitBool(t,...e){return null}visitInt(t,...e){return null}visitFloat(t,...e){return null}visitUtf8(t,...e){return null}visitBinary(t,...e){return null}visitFixedSizeBinary(t,...e){return null}visitDate(t,...e){return null}visitTimestamp(t,...e){return null}visitTime(t,...e){return null}visitDecimal(t,...e){return null}visitList(t,...e){return null}visitStruct(t,...e){return null}visitUnion(t,...e){return null}visitDictionary(t,...e){return null}visitInterval(t,...e){return null}visitDuration(t,...e){return null}visitFixedSizeList(t,...e){return null}visitMap(t,...e){return null}}function Vd(t,e,n=!0){let r=null;switch(e){case Ph.Null:r=t.visitNull;break;case Ph.Bool:r=t.visitBool;break;case Ph.Int:r=t.visitInt;break;case Ph.Int8:r=t.visitInt8||t.visitInt;break;case Ph.Int16:r=t.visitInt16||t.visitInt;break;case Ph.Int32:r=t.visitInt32||t.visitInt;break;case Ph.Int64:r=t.visitInt64||t.visitInt;break;case Ph.Uint8:r=t.visitUint8||t.visitInt;break;case Ph.Uint16:r=t.visitUint16||t.visitInt;break;case Ph.Uint32:r=t.visitUint32||t.visitInt;break;case Ph.Uint64:r=t.visitUint64||t.visitInt;break;case Ph.Float:r=t.visitFloat;break;case Ph.Float16:r=t.visitFloat16||t.visitFloat;break;case Ph.Float32:r=t.visitFloat32||t.visitFloat;break;case Ph.Float64:r=t.visitFloat64||t.visitFloat;break;case Ph.Utf8:r=t.visitUtf8;break;case Ph.Binary:r=t.visitBinary;break;case Ph.FixedSizeBinary:r=t.visitFixedSizeBinary;break;case Ph.Date:r=t.visitDate;break;case Ph.DateDay:r=t.visitDateDay||t.visitDate;break;case Ph.DateMillisecond:r=t.visitDateMillisecond||t.visitDate;break;case Ph.Timestamp:r=t.visitTimestamp;break;case Ph.TimestampSecond:r=t.visitTimestampSecond||t.visitTimestamp;break;case Ph.TimestampMillisecond:r=t.visitTimestampMillisecond||t.visitTimestamp;break;case Ph.TimestampMicrosecond:r=t.visitTimestampMicrosecond||t.visitTimestamp;break;case Ph.TimestampNanosecond:r=t.visitTimestampNanosecond||t.visitTimestamp;break;case Ph.Time:r=t.visitTime;break;case Ph.TimeSecond:r=t.visitTimeSecond||t.visitTime;break;case Ph.TimeMillisecond:r=t.visitTimeMillisecond||t.visitTime;break;case Ph.TimeMicrosecond:r=t.visitTimeMicrosecond||t.visitTime;break;case Ph.TimeNanosecond:r=t.visitTimeNanosecond||t.visitTime;break;case Ph.Decimal:r=t.visitDecimal;break;case Ph.List:r=t.visitList;break;case Ph.Struct:r=t.visitStruct;break;case Ph.Union:r=t.visitUnion;break;case Ph.DenseUnion:r=t.visitDenseUnion||t.visitUnion;break;case Ph.SparseUnion:r=t.visitSparseUnion||t.visitUnion;break;case Ph.Dictionary:r=t.visitDictionary;break;case Ph.Interval:r=t.visitInterval;break;case Ph.IntervalDayTime:r=t.visitIntervalDayTime||t.visitInterval;break;case Ph.IntervalYearMonth:r=t.visitIntervalYearMonth||t.visitInterval;break;case Ph.Duration:r=t.visitDuration;break;case Ph.DurationSecond:r=t.visitDurationSecond||t.visitDuration;break;case Ph.DurationMillisecond:r=t.visitDurationMillisecond||t.visitDuration;break;case Ph.DurationMicrosecond:r=t.visitDurationMicrosecond||t.visitDuration;break;case Ph.DurationNanosecond:r=t.visitDurationNanosecond||t.visitDuration;break;case Ph.FixedSizeList:r=t.visitFixedSizeList;break;case Ph.Map:r=t.visitMap}if("function"==typeof r)return r;if(!n)return()=>null;throw new Error(`Unrecognized type '${Ph[e]}'`)}function qd(t){switch(t.typeId){case Ph.Null:return Ph.Null;case Ph.Int:{const{bitWidth:e,isSigned:n}=t;switch(e){case 8:return n?Ph.Int8:Ph.Uint8;case 16:return n?Ph.Int16:Ph.Uint16;case 32:return n?Ph.Int32:Ph.Uint32;case 64:return n?Ph.Int64:Ph.Uint64}return Ph.Int}case Ph.Float:switch(t.precision){case $h.HALF:return Ph.Float16;case $h.SINGLE:return Ph.Float32;case $h.DOUBLE:return Ph.Float64}return Ph.Float;case Ph.Binary:return Ph.Binary;case Ph.Utf8:return Ph.Utf8;case Ph.Bool:return Ph.Bool;case Ph.Decimal:return Ph.Decimal;case Ph.Time:switch(t.unit){case Lh.SECOND:return Ph.TimeSecond;case Lh.MILLISECOND:return Ph.TimeMillisecond;case Lh.MICROSECOND:return Ph.TimeMicrosecond;case Lh.NANOSECOND:return Ph.TimeNanosecond}return Ph.Time;case Ph.Timestamp:switch(t.unit){case Lh.SECOND:return Ph.TimestampSecond;case Lh.MILLISECOND:return Ph.TimestampMillisecond;case Lh.MICROSECOND:return Ph.TimestampMicrosecond;case Lh.NANOSECOND:return Ph.TimestampNanosecond}return Ph.Timestamp;case Ph.Date:switch(t.unit){case Fh.DAY:return Ph.DateDay;case Fh.MILLISECOND:return Ph.DateMillisecond}return Ph.Date;case Ph.Interval:switch(t.unit){case Bh.DAY_TIME:return Ph.IntervalDayTime;case Bh.YEAR_MONTH:return Ph.IntervalYearMonth}return Ph.Interval;case Ph.Duration:switch(t.unit){case Lh.SECOND:return Ph.DurationSecond;case Lh.MILLISECOND:return Ph.DurationMillisecond;case Lh.MICROSECOND:return Ph.DurationMicrosecond;case Lh.NANOSECOND:return Ph.DurationNanosecond}return Ph.Duration;case Ph.Map:return Ph.Map;case Ph.List:return Ph.List;case Ph.Struct:return Ph.Struct;case Ph.Union:switch(t.mode){case Nh.Dense:return Ph.DenseUnion;case Nh.Sparse:return Ph.SparseUnion}return Ph.Union;case Ph.FixedSizeBinary:return Ph.FixedSizeBinary;case Ph.FixedSizeList:return Ph.FixedSizeList;case Ph.Dictionary:return Ph.Dictionary}throw new Error(`Unrecognized type '${Ph[t.typeId]}'`)}Ud.prototype.visitInt8=null,Ud.prototype.visitInt16=null,Ud.prototype.visitInt32=null,Ud.prototype.visitInt64=null,Ud.prototype.visitUint8=null,Ud.prototype.visitUint16=null,Ud.prototype.visitUint32=null,Ud.prototype.visitUint64=null,Ud.prototype.visitFloat16=null,Ud.prototype.visitFloat32=null,Ud.prototype.visitFloat64=null,Ud.prototype.visitDateDay=null,Ud.prototype.visitDateMillisecond=null,Ud.prototype.visitTimestampSecond=null,Ud.prototype.visitTimestampMillisecond=null,Ud.prototype.visitTimestampMicrosecond=null,Ud.prototype.visitTimestampNanosecond=null,Ud.prototype.visitTimeSecond=null,Ud.prototype.visitTimeMillisecond=null,Ud.prototype.visitTimeMicrosecond=null,Ud.prototype.visitTimeNanosecond=null,Ud.prototype.visitDenseUnion=null,Ud.prototype.visitSparseUnion=null,Ud.prototype.visitIntervalDayTime=null,Ud.prototype.visitIntervalYearMonth=null,Ud.prototype.visitDuration=null,Ud.prototype.visitDurationSecond=null,Ud.prototype.visitDurationMillisecond=null,Ud.prototype.visitDurationMicrosecond=null,Ud.prototype.visitDurationNanosecond=null;const Wd=new Float64Array(1),Hd=new Uint32Array(Wd.buffer);function Gd(t){const e=(31744&t)>>10,n=(1023&t)/1024,r=Math.pow(-1,(32768&t)>>15);switch(e){case 31:return r*(n?Number.NaN:1/0);case 0:return r*(n?6103515625e-14*n:0)}return r*Math.pow(2,e-15)*(1+n)}function Yd(t){if(t!=t)return 32256;Wd[0]=t;const e=(2147483648&Hd[1])>>16&65535;let n=2146435072&Hd[1],r=0;return n>=1089470464?Hd[0]>0?n=31744:(n=(2080374784&n)>>16,r=(1048575&Hd[1])>>10):n<=1056964608?(r=1048576+(1048575&Hd[1]),r=1048576+(r<<(n>>20)-998)>>21,n=0):(n=n-1056964608>>10,r=512+(1048575&Hd[1])>>10),e|n|65535&r}class Xd extends Ud{}function Jd(t){return(e,n,r)=>{if(e.setValid(n,null!=r))return t(e,n,r)}}const Kd=(t,e,n)=>{t[e]=Math.trunc(n%4294967296),t[e+1]=Math.trunc(n/4294967296)},Qd=(t,e,n,r)=>{if(n+1<e.length){const{[n]:i,[n+1]:o}=e;t.set(r.subarray(0,o-i),i)}},Zd=({values:t},e,n)=>{t[e]=n},tp=({values:t},e,n)=>{t[e]=n},ep=({values:t},e,n)=>{t[e]=Yd(n)},np=({values:t},e,n)=>{((t,e,n)=>{t[e]=Math.trunc(n/864e5)})(t,e,n.valueOf())},rp=({values:t},e,n)=>{Kd(t,2*e,n.valueOf())},ip=({stride:t,values:e},n,r)=>{e.set(r.subarray(0,t),t*n)},op=(t,e,n)=>{t.type.unit===Fh.DAY?np(t,e,n):rp(t,e,n)},sp=({values:t},e,n)=>Kd(t,2*e,n/1e3),ap=({values:t},e,n)=>Kd(t,2*e,n),lp=({values:t},e,n)=>((t,e,n)=>{t[e]=Math.trunc(1e3*n%4294967296),t[e+1]=Math.trunc(1e3*n/4294967296)})(t,2*e,n),up=({values:t},e,n)=>((t,e,n)=>{t[e]=Math.trunc(1e6*n%4294967296),t[e+1]=Math.trunc(1e6*n/4294967296)})(t,2*e,n),cp=(t,e,n)=>{switch(t.type.unit){case Lh.SECOND:return sp(t,e,n);case Lh.MILLISECOND:return ap(t,e,n);case Lh.MICROSECOND:return lp(t,e,n);case Lh.NANOSECOND:return up(t,e,n)}},hp=({values:t},e,n)=>{t[e]=n},fp=({values:t},e,n)=>{t[e]=n},dp=({values:t},e,n)=>{t[e]=n},pp=({values:t},e,n)=>{t[e]=n},mp=(t,e,n)=>{switch(t.type.unit){case Lh.SECOND:return hp(t,e,n);case Lh.MILLISECOND:return fp(t,e,n);case Lh.MICROSECOND:return dp(t,e,n);case Lh.NANOSECOND:return pp(t,e,n)}},gp=({values:t,stride:e},n,r)=>{t.set(r.subarray(0,e),e*n)},yp=(t,e,n)=>{const r=t.type.typeIdToChildIndex[t.typeIds[e]],i=t.children[r];Cp.visit(i,t.valueOffsets[e],n)},bp=(t,e,n)=>{const r=t.type.typeIdToChildIndex[t.typeIds[e]],i=t.children[r];Cp.visit(i,e,n)},vp=(t,e,n)=>{t.type.unit===Bh.DAY_TIME?wp(t,e,n):xp(t,e,n)},wp=({values:t},e,n)=>{t.set(n.subarray(0,2),2*e)},xp=({values:t},e,n)=>{t[e]=12*n[0]+n[1]%12},_p=({values:t},e,n)=>{t[e]=n},kp=({values:t},e,n)=>{t[e]=n},Sp=({values:t},e,n)=>{t[e]=n},Ep=({values:t},e,n)=>{t[e]=n},Ap=(t,e,n)=>{switch(t.type.unit){case Lh.SECOND:return _p(t,e,n);case Lh.MILLISECOND:return kp(t,e,n);case Lh.MICROSECOND:return Sp(t,e,n);case Lh.NANOSECOND:return Ep(t,e,n)}};Xd.prototype.visitBool=Jd((({offset:t,values:e},n,r)=>{const i=t+n;r?e[i>>3]|=1<<i%8:e[i>>3]&=~(1<<i%8)})),Xd.prototype.visitInt=Jd(Zd),Xd.prototype.visitInt8=Jd(Zd),Xd.prototype.visitInt16=Jd(Zd),Xd.prototype.visitInt32=Jd(Zd),Xd.prototype.visitInt64=Jd(Zd),Xd.prototype.visitUint8=Jd(Zd),Xd.prototype.visitUint16=Jd(Zd),Xd.prototype.visitUint32=Jd(Zd),Xd.prototype.visitUint64=Jd(Zd),Xd.prototype.visitFloat=Jd(((t,e,n)=>{switch(t.type.precision){case $h.HALF:return ep(t,e,n);case $h.SINGLE:case $h.DOUBLE:return tp(t,e,n)}})),Xd.prototype.visitFloat16=Jd(ep),Xd.prototype.visitFloat32=Jd(tp),Xd.prototype.visitFloat64=Jd(tp),Xd.prototype.visitUtf8=Jd((({values:t,valueOffsets:e},n,r)=>{Qd(t,e,n,Kh(r))})),Xd.prototype.visitBinary=Jd((({values:t,valueOffsets:e},n,r)=>Qd(t,e,n,r))),Xd.prototype.visitFixedSizeBinary=Jd(ip),Xd.prototype.visitDate=Jd(op),Xd.prototype.visitDateDay=Jd(np),Xd.prototype.visitDateMillisecond=Jd(rp),Xd.prototype.visitTimestamp=Jd(cp),Xd.prototype.visitTimestampSecond=Jd(sp),Xd.prototype.visitTimestampMillisecond=Jd(ap),Xd.prototype.visitTimestampMicrosecond=Jd(lp),Xd.prototype.visitTimestampNanosecond=Jd(up),Xd.prototype.visitTime=Jd(mp),Xd.prototype.visitTimeSecond=Jd(hp),Xd.prototype.visitTimeMillisecond=Jd(fp),Xd.prototype.visitTimeMicrosecond=Jd(dp),Xd.prototype.visitTimeNanosecond=Jd(pp),Xd.prototype.visitDecimal=Jd(gp),Xd.prototype.visitList=Jd(((t,e,n)=>{const r=t.children[0],i=t.valueOffsets,o=Cp.getVisitFn(r);if(Array.isArray(n))for(let t=-1,s=i[e],a=i[e+1];s<a;)o(r,s++,n[++t]);else for(let t=-1,s=i[e],a=i[e+1];s<a;)o(r,s++,n.get(++t))})),Xd.prototype.visitStruct=Jd(((t,e,n)=>{const r=t.type.children.map((t=>Cp.getVisitFn(t.type))),i=n instanceof Map?(o=e,s=n,(t,e,n,r)=>e&&t(e,o,s.get(n.name))):n instanceof Ym?((t,e)=>(n,r,i,o)=>r&&n(r,t,e.get(o)))(e,n):Array.isArray(n)?((t,e)=>(n,r,i,o)=>r&&n(r,t,e[o]))(e,n):((t,e)=>(n,r,i,o)=>r&&n(r,t,e[i.name]))(e,n);var o,s;t.type.children.forEach(((e,n)=>i(r[n],t.children[n],e,n)))})),Xd.prototype.visitUnion=Jd(((t,e,n)=>{t.type.mode===Nh.Dense?yp(t,e,n):bp(t,e,n)})),Xd.prototype.visitDenseUnion=Jd(yp),Xd.prototype.visitSparseUnion=Jd(bp),Xd.prototype.visitDictionary=Jd(((t,e,n)=>{var r;null===(r=t.dictionary)||void 0===r||r.set(t.values[e],n)})),Xd.prototype.visitInterval=Jd(vp),Xd.prototype.visitIntervalDayTime=Jd(wp),Xd.prototype.visitIntervalYearMonth=Jd(xp),Xd.prototype.visitDuration=Jd(Ap),Xd.prototype.visitDurationSecond=Jd(_p),Xd.prototype.visitDurationMillisecond=Jd(kp),Xd.prototype.visitDurationMicrosecond=Jd(Sp),Xd.prototype.visitDurationNanosecond=Jd(Ep),Xd.prototype.visitFixedSizeList=Jd(((t,e,n)=>{const{stride:r}=t,i=t.children[0],o=Cp.getVisitFn(i);if(Array.isArray(n))for(let t=-1,s=e*r;++t<r;)o(i,s+t,n[t]);else for(let t=-1,s=e*r;++t<r;)o(i,s+t,n.get(t))})),Xd.prototype.visitMap=Jd(((t,e,n)=>{const r=t.children[0],{valueOffsets:i}=t,o=Cp.getVisitFn(r);let{[e]:s,[e+1]:a}=i;const l=n instanceof Map?n.entries():Object.entries(n);for(const t of l)if(o(r,s,t),++s>=a)break}));const Cp=new Xd,Dp=Symbol.for("parent"),Mp=Symbol.for("rowIndex");class Op{constructor(t,e){return this[Dp]=t,this[Mp]=e,new Proxy(this,new Ip)}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[Mp],e=this[Dp],n=e.type.children,r={};for(let i=-1,o=n.length;++i<o;)r[n[i].name]=im.visit(e.children[i],t);return r}toString(){return`{${[...this].map((([t,e])=>`${Uh(t)}: ${Uh(e)}`)).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}[Symbol.iterator](){return new Tp(this[Dp],this[Mp])}}class Tp{constructor(t,e){this.childIndex=0,this.children=t.children,this.rowIndex=e,this.childFields=t.type.children,this.numChildren=this.childFields.length}[Symbol.iterator](){return this}next(){const t=this.childIndex;return t<this.numChildren?(this.childIndex=t+1,{done:!1,value:[this.childFields[t].name,im.visit(this.children[t],this.rowIndex)]}):{done:!0,value:null}}}Object.defineProperties(Op.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[Dp]:{writable:!0,enumerable:!1,configurable:!1,value:null},[Mp]:{writable:!0,enumerable:!1,configurable:!1,value:-1}});class Ip{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[Dp].type.children.map((t=>t.name))}has(t,e){return-1!==t[Dp].type.children.findIndex((t=>t.name===e))}getOwnPropertyDescriptor(t,e){if(-1!==t[Dp].type.children.findIndex((t=>t.name===e)))return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];const n=t[Dp].type.children.findIndex((t=>t.name===e));if(-1!==n){const r=im.visit(t[Dp].children[n],t[Mp]);return Reflect.set(t,e,r),r}}set(t,e,n){const r=t[Dp].type.children.findIndex((t=>t.name===e));return-1!==r?(Cp.visit(t[Dp].children[r],t[Mp],n),Reflect.set(t,e,n)):!(!Reflect.has(t,e)&&"symbol"!=typeof e)&&Reflect.set(t,e,n)}}class Np extends Ud{}function $p(t){return(e,n)=>e.getValid(n)?t(e,n):null}const Fp=(t,e)=>4294967296*t[e+1]+(t[e]>>>0),Lp=t=>new Date(t),Bp=(t,e,n)=>{if(n+1>=e.length)return null;const r=e[n],i=e[n+1];return t.subarray(r,i)},Rp=({values:t},e)=>((t,e)=>Lp(((t,e)=>864e5*t[e])(t,e)))(t,e),Pp=({values:t},e)=>((t,e)=>Lp(Fp(t,e)))(t,2*e),zp=({stride:t,values:e},n)=>e[t*n],jp=({values:t},e)=>t[e],Up=({values:t},e)=>1e3*Fp(t,2*e),Vp=({values:t},e)=>Fp(t,2*e),qp=({values:t},e)=>((t,e)=>t[e+1]/1e3*4294967296+(t[e]>>>0)/1e3)(t,2*e),Wp=({values:t},e)=>((t,e)=>t[e+1]/1e6*4294967296+(t[e]>>>0)/1e6)(t,2*e),Hp=({values:t},e)=>t[e],Gp=({values:t},e)=>t[e],Yp=({values:t},e)=>t[e],Xp=({values:t},e)=>t[e],Jp=(t,e)=>{const n=t.type.typeIdToChildIndex[t.typeIds[e]],r=t.children[n];return im.visit(r,t.valueOffsets[e])},Kp=(t,e)=>{const n=t.type.typeIdToChildIndex[t.typeIds[e]],r=t.children[n];return im.visit(r,e)},Qp=({values:t},e)=>t.subarray(2*e,2*(e+1)),Zp=({values:t},e)=>{const n=t[e],r=new Int32Array(2);return r[0]=Math.trunc(n/12),r[1]=Math.trunc(n%12),r},tm=({values:t},e)=>t[e],em=({values:t},e)=>t[e],nm=({values:t},e)=>t[e],rm=({values:t},e)=>t[e];Np.prototype.visitNull=$p(((t,e)=>null)),Np.prototype.visitBool=$p((({offset:t,values:e},n)=>{const r=t+n;return!!(e[r>>3]&1<<r%8)})),Np.prototype.visitInt=$p((({values:t},e)=>t[e])),Np.prototype.visitInt8=$p(zp),Np.prototype.visitInt16=$p(zp),Np.prototype.visitInt32=$p(zp),Np.prototype.visitInt64=$p(jp),Np.prototype.visitUint8=$p(zp),Np.prototype.visitUint16=$p(zp),Np.prototype.visitUint32=$p(zp),Np.prototype.visitUint64=$p(jp),Np.prototype.visitFloat=$p((({type:t,values:e},n)=>t.precision!==$h.HALF?e[n]:Gd(e[n]))),Np.prototype.visitFloat16=$p((({stride:t,values:e},n)=>Gd(e[t*n]))),Np.prototype.visitFloat32=$p(zp),Np.prototype.visitFloat64=$p(zp),Np.prototype.visitUtf8=$p((({values:t,valueOffsets:e},n)=>{const r=Bp(t,e,n);return null!==r?Xh(r):null})),Np.prototype.visitBinary=$p((({values:t,valueOffsets:e},n)=>Bp(t,e,n))),Np.prototype.visitFixedSizeBinary=$p((({stride:t,values:e},n)=>e.subarray(t*n,t*(n+1)))),Np.prototype.visitDate=$p(((t,e)=>t.type.unit===Fh.DAY?Rp(t,e):Pp(t,e))),Np.prototype.visitDateDay=$p(Rp),Np.prototype.visitDateMillisecond=$p(Pp),Np.prototype.visitTimestamp=$p(((t,e)=>{switch(t.type.unit){case Lh.SECOND:return Up(t,e);case Lh.MILLISECOND:return Vp(t,e);case Lh.MICROSECOND:return qp(t,e);case Lh.NANOSECOND:return Wp(t,e)}})),Np.prototype.visitTimestampSecond=$p(Up),Np.prototype.visitTimestampMillisecond=$p(Vp),Np.prototype.visitTimestampMicrosecond=$p(qp),Np.prototype.visitTimestampNanosecond=$p(Wp),Np.prototype.visitTime=$p(((t,e)=>{switch(t.type.unit){case Lh.SECOND:return Hp(t,e);case Lh.MILLISECOND:return Gp(t,e);case Lh.MICROSECOND:return Yp(t,e);case Lh.NANOSECOND:return Xp(t,e)}})),Np.prototype.visitTimeSecond=$p(Hp),Np.prototype.visitTimeMillisecond=$p(Gp),Np.prototype.visitTimeMicrosecond=$p(Yp),Np.prototype.visitTimeNanosecond=$p(Xp),Np.prototype.visitDecimal=$p((({values:t,stride:e},n)=>Tf.decimal(t.subarray(e*n,e*(n+1))))),Np.prototype.visitList=$p(((t,e)=>{const{valueOffsets:n,stride:r,children:i}=t,{[e*r]:o,[e*r+1]:s}=n,a=i[0].slice(o,s-o);return new Ym([a])})),Np.prototype.visitStruct=$p(((t,e)=>new Op(t,e))),Np.prototype.visitUnion=$p(((t,e)=>t.type.mode===Nh.Dense?Jp(t,e):Kp(t,e))),Np.prototype.visitDenseUnion=$p(Jp),Np.prototype.visitSparseUnion=$p(Kp),Np.prototype.visitDictionary=$p(((t,e)=>{var n;return null===(n=t.dictionary)||void 0===n?void 0:n.get(t.values[e])})),Np.prototype.visitInterval=$p(((t,e)=>t.type.unit===Bh.DAY_TIME?Qp(t,e):Zp(t,e))),Np.prototype.visitIntervalDayTime=$p(Qp),Np.prototype.visitIntervalYearMonth=$p(Zp),Np.prototype.visitDuration=$p(((t,e)=>{switch(t.type.unit){case Lh.SECOND:return tm(t,e);case Lh.MILLISECOND:return em(t,e);case Lh.MICROSECOND:return nm(t,e);case Lh.NANOSECOND:return rm(t,e)}})),Np.prototype.visitDurationSecond=$p(tm),Np.prototype.visitDurationMillisecond=$p(em),Np.prototype.visitDurationMicrosecond=$p(nm),Np.prototype.visitDurationNanosecond=$p(rm),Np.prototype.visitFixedSizeList=$p(((t,e)=>{const{stride:n,children:r}=t,i=r[0].slice(e*n,n);return new Ym([i])})),Np.prototype.visitMap=$p(((t,e)=>{const{valueOffsets:n,children:r}=t,{[e]:i,[e+1]:o}=n,s=r[0];return new am(s.slice(i,o-i))}));const im=new Np,om=Symbol.for("keys"),sm=Symbol.for("vals");class am{constructor(t){return this[om]=new Ym([t.children[0]]).memoize(),this[sm]=t.children[1],new Proxy(this,new um)}[Symbol.iterator](){return new lm(this[om],this[sm])}get size(){return this[om].length}toArray(){return Object.values(this.toJSON())}toJSON(){const t=this[om],e=this[sm],n={};for(let r=-1,i=t.length;++r<i;)n[t.get(r)]=im.visit(e,r);return n}toString(){return`{${[...this].map((([t,e])=>`${Uh(t)}: ${Uh(e)}`)).join(", ")}}`}[Symbol.for("nodejs.util.inspect.custom")](){return this.toString()}}class lm{constructor(t,e){this.keys=t,this.vals=e,this.keyIndex=0,this.numKeys=t.length}[Symbol.iterator](){return this}next(){const t=this.keyIndex;return t===this.numKeys?{done:!0,value:null}:(this.keyIndex++,{done:!1,value:[this.keys.get(t),im.visit(this.vals,t)]})}}class um{isExtensible(){return!1}deleteProperty(){return!1}preventExtensions(){return!0}ownKeys(t){return t[om].toArray().map(String)}has(t,e){return t[om].includes(e)}getOwnPropertyDescriptor(t,e){if(-1!==t[om].indexOf(e))return{writable:!0,enumerable:!0,configurable:!0}}get(t,e){if(Reflect.has(t,e))return t[e];const n=t[om].indexOf(e);if(-1!==n){const r=im.visit(Reflect.get(t,sm),n);return Reflect.set(t,e,r),r}}set(t,e,n){const r=t[om].indexOf(e);return-1!==r?(Cp.visit(Reflect.get(t,sm),r,n),Reflect.set(t,e,n)):!!Reflect.has(t,e)&&Reflect.set(t,e,n)}}let cm;function hm(t,e,n,r){const{length:i=0}=t;let o="number"!=typeof e?0:e,s="number"!=typeof n?i:n;return o<0&&(o=(o%i+i)%i),s<0&&(s=(s%i+i)%i),s<o&&(cm=o,o=s,s=cm),s>i&&(s=i),r?r(t,o,s):[o,s]}Object.defineProperties(am.prototype,{[Symbol.toStringTag]:{enumerable:!1,configurable:!1,value:"Row"},[om]:{writable:!0,enumerable:!1,configurable:!1,value:null},[sm]:{writable:!0,enumerable:!1,configurable:!1,value:null}});const fm=t=>t!=t;function dm(t){if("object"!=typeof t||null===t)return fm(t)?fm:e=>e===t;if(t instanceof Date){const e=t.valueOf();return t=>t instanceof Date&&t.valueOf()===e}return ArrayBuffer.isView(t)?e=>!!e&&function(t,e){let n=0;const r=t.length;if(r!==e.length)return!1;if(r>0)do{if(t[n]!==e[n])return!1}while(++n<r);return!0}(t,e):t instanceof Map?function(t){let e=-1;const n=[];for(const r of t.values())n[++e]=dm(r);return pm(n)}(t):Array.isArray(t)?function(t){const e=[];for(let n=-1,r=t.length;++n<r;)e[n]=dm(t[n]);return pm(e)}(t):t instanceof Ym?function(t){const e=[];for(let n=-1,r=t.length;++n<r;)e[n]=dm(t.get(n));return pm(e)}(t):function(t,e=!1){const n=Object.keys(t);if(!e&&0===n.length)return()=>!1;const r=[];for(let e=-1,i=n.length;++e<i;)r[e]=dm(t[n[e]]);return pm(r,n)}(t,!0)}function pm(t,e){return n=>{if(!n||"object"!=typeof n)return!1;switch(n.constructor){case Array:return function(t,e){const n=t.length;if(e.length!==n)return!1;for(let r=-1;++r<n;)if(!t[r](e[r]))return!1;return!0}(t,n);case Map:return mm(t,n,n.keys());case am:case Op:case Object:case void 0:return mm(t,n,e||Object.keys(n))}return n instanceof Ym&&function(t,e){const n=t.length;if(e.length!==n)return!1;for(let r=-1;++r<n;)if(!t[r](e.get(r)))return!1;return!0}(t,n)}}function mm(t,e,n){const r=n[Symbol.iterator](),i=e instanceof Map?e.keys():Object.keys(e)[Symbol.iterator](),o=e instanceof Map?e.values():Object.values(e)[Symbol.iterator]();let s=0;const a=t.length;let l=o.next(),u=r.next(),c=i.next();for(;s<a&&!u.done&&!c.done&&!l.done&&u.value===c.value&&t[s](l.value);++s,u=r.next(),c=i.next(),l=o.next());return!!(s===a&&u.done&&c.done&&l.done)||(r.return&&r.return(),i.return&&i.return(),o.return&&o.return(),!1)}class gm{constructor(t=0,e){this.numChunks=t,this.getChunkIterator=e,this.chunkIndex=0,this.chunkIterator=this.getChunkIterator(0)}next(){for(;this.chunkIndex<this.numChunks;){const t=this.chunkIterator.next();if(!t.done)return t;++this.chunkIndex<this.numChunks&&(this.chunkIterator=this.getChunkIterator(this.chunkIndex))}return{done:!0,value:null}}[Symbol.iterator](){return this}}function ym(t){return t.reduce(((t,e)=>t+e.nullCount),0)}function bm(t){return t.reduce(((t,e,n)=>(t[n+1]=t[n]+e.length,t)),new Uint32Array(t.length+1))}function vm(t,e,n,r){const i=[];for(let o=-1,s=t.length;++o<s;){const s=t[o],a=e[o],{length:l}=s;if(a>=r)break;if(n>=a+l)continue;if(a>=n&&a+l<=r){i.push(s);continue}const u=Math.max(0,n-a),c=Math.min(r-a,l);i.push(s.slice(u,c-u))}return 0===i.length&&i.push(t[0].slice(0,0)),i}function wm(t,e,n,r){let i=0,o=0,s=e.length-1;do{if(i>=s-1)return n<e[s]?r(t,i,n-e[i]):null;o=i+Math.trunc(.5*(s-i)),n<e[o]?s=o:i=o}while(i<s)}function xm(t,e){return t.getValid(e)}function _m(t){function e(e,n,r){return t(e[n],r)}return function(t){return wm(this.data,this._offsets,t,e)}}function km(t){let e;function n(n,r,i){return t(n[r],i,e)}return function(t,r){const i=this.data;e=r;const o=wm(i,this._offsets,t,n);return e=void 0,o}}function Sm(t){let e;function n(n,r,i){let o=i,s=0,a=0;for(let i=r-1,l=n.length;++i<l;){const r=n[i];if(~(s=t(r,e,o)))return a+s;o=0,a+=r.length}return-1}return function(t,r){e=t;const i=this.data,o="number"!=typeof r?n(i,0,0):wm(i,this._offsets,r,n);return e=void 0,o}}function Em(t,e,n,r){return!!(n&1<<r)}function Am(t,e,n,r){return(n&1<<r)>>r}function Cm(t,e,n){const r=n.byteLength+7&-8;if(t>0||n.byteLength<r){const i=new Uint8Array(r);return i.set(t%8==0?n.subarray(t>>3):Dm(new Mm(n,t,e,null,Em)).subarray(0,r)),i}return n}function Dm(t){const e=[];let n=0,r=0,i=0;for(const o of t)o&&(i|=1<<r),8==++r&&(e[n++]=i,i=r=0);(0===n||r>0)&&(e[n++]=i);const o=new Uint8Array(e.length+7&-8);return o.set(e),o}class Mm{constructor(t,e,n,r,i){this.bytes=t,this.length=n,this.context=r,this.get=i,this.bit=e%8,this.byteIndex=e>>3,this.byte=t[this.byteIndex++],this.index=0}next(){return this.index<this.length?(8===this.bit&&(this.bit=0,this.byte=this.bytes[this.byteIndex++]),{value:this.get(this.context,this.index++,this.byte,this.bit++)}):{done:!0,value:null}}[Symbol.iterator](){return this}}function Om(t,e,n){if(n-e<=0)return 0;if(n-e<8){let r=0;for(const i of new Mm(t,e,n-e,t,Am))r+=i;return r}const r=n>>3<<3,i=e+(e%8==0?0:8-e%8);return Om(t,e,i)+Om(t,r,n)+function(t,e,n){let r=0,i=Math.trunc(e);const o=new DataView(t.buffer,t.byteOffset,t.byteLength),s=void 0===n?t.byteLength:i+n;for(;s-i>=4;)r+=Tm(o.getUint32(i)),i+=4;for(;s-i>=2;)r+=Tm(o.getUint16(i)),i+=2;for(;s-i>=1;)r+=Tm(o.getUint8(i)),i+=1;return r}(t,i>>3,r-i>>3)}function Tm(t){let e=Math.trunc(t);return e-=e>>>1&1431655765,e=(858993459&e)+(e>>>2&858993459),16843009*(e+(e>>>4)&252645135)>>>24}class Im extends Ud{}function Nm(t,e,n){if(void 0===e)return-1;if(null===e)switch(t.typeId){case Ph.Union:case Ph.Dictionary:break;default:return function(t,e){const{nullBitmap:n}=t;if(!n||t.nullCount<=0)return-1;let r=0;for(const i of new Mm(n,t.offset+(e||0),t.length,n,Em)){if(!i)return r;++r}return-1}(t,n)}const r=im.getVisitFn(t),i=dm(e);for(let e=(n||0)-1,o=t.length;++e<o;)if(i(r(t,e)))return e;return-1}function $m(t,e,n){const r=im.getVisitFn(t),i=dm(e);for(let e=(n||0)-1,o=t.length;++e<o;)if(i(r(t,e)))return e;return-1}Im.prototype.visitNull=function(t,e){return null===e&&t.length>0?0:-1},Im.prototype.visitBool=Nm,Im.prototype.visitInt=Nm,Im.prototype.visitInt8=Nm,Im.prototype.visitInt16=Nm,Im.prototype.visitInt32=Nm,Im.prototype.visitInt64=Nm,Im.prototype.visitUint8=Nm,Im.prototype.visitUint16=Nm,Im.prototype.visitUint32=Nm,Im.prototype.visitUint64=Nm,Im.prototype.visitFloat=Nm,Im.prototype.visitFloat16=Nm,Im.prototype.visitFloat32=Nm,Im.prototype.visitFloat64=Nm,Im.prototype.visitUtf8=Nm,Im.prototype.visitBinary=Nm,Im.prototype.visitFixedSizeBinary=Nm,Im.prototype.visitDate=Nm,Im.prototype.visitDateDay=Nm,Im.prototype.visitDateMillisecond=Nm,Im.prototype.visitTimestamp=Nm,Im.prototype.visitTimestampSecond=Nm,Im.prototype.visitTimestampMillisecond=Nm,Im.prototype.visitTimestampMicrosecond=Nm,Im.prototype.visitTimestampNanosecond=Nm,Im.prototype.visitTime=Nm,Im.prototype.visitTimeSecond=Nm,Im.prototype.visitTimeMillisecond=Nm,Im.prototype.visitTimeMicrosecond=Nm,Im.prototype.visitTimeNanosecond=Nm,Im.prototype.visitDecimal=Nm,Im.prototype.visitList=Nm,Im.prototype.visitStruct=Nm,Im.prototype.visitUnion=Nm,Im.prototype.visitDenseUnion=$m,Im.prototype.visitSparseUnion=$m,Im.prototype.visitDictionary=Nm,Im.prototype.visitInterval=Nm,Im.prototype.visitIntervalDayTime=Nm,Im.prototype.visitIntervalYearMonth=Nm,Im.prototype.visitDuration=Nm,Im.prototype.visitDurationSecond=Nm,Im.prototype.visitDurationMillisecond=Nm,Im.prototype.visitDurationMicrosecond=Nm,Im.prototype.visitDurationNanosecond=Nm,Im.prototype.visitFixedSizeList=Nm,Im.prototype.visitMap=Nm;const Fm=new Im;class Lm extends Ud{}function Bm(t){const{type:e}=t;if(0===t.nullCount&&1===t.stride&&(e.typeId===Ph.Timestamp||e instanceof nd&&64!==e.bitWidth||e instanceof _d&&64!==e.bitWidth||e instanceof hd&&e.precision!==$h.HALF))return new gm(t.data.length,(e=>{const n=t.data[e];return n.values.subarray(0,n.length)[Symbol.iterator]()}));let n=0;return new gm(t.data.length,(e=>{const r=t.data[e].length,i=t.slice(n,n+r);return n+=r,new Rm(i)}))}class Rm{constructor(t){this.vector=t,this.index=0}next(){return this.index<this.vector.length?{value:this.vector.get(this.index++)}:{done:!0,value:null}}[Symbol.iterator](){return this}}Lm.prototype.visitNull=Bm,Lm.prototype.visitBool=Bm,Lm.prototype.visitInt=Bm,Lm.prototype.visitInt8=Bm,Lm.prototype.visitInt16=Bm,Lm.prototype.visitInt32=Bm,Lm.prototype.visitInt64=Bm,Lm.prototype.visitUint8=Bm,Lm.prototype.visitUint16=Bm,Lm.prototype.visitUint32=Bm,Lm.prototype.visitUint64=Bm,Lm.prototype.visitFloat=Bm,Lm.prototype.visitFloat16=Bm,Lm.prototype.visitFloat32=Bm,Lm.prototype.visitFloat64=Bm,Lm.prototype.visitUtf8=Bm,Lm.prototype.visitBinary=Bm,Lm.prototype.visitFixedSizeBinary=Bm,Lm.prototype.visitDate=Bm,Lm.prototype.visitDateDay=Bm,Lm.prototype.visitDateMillisecond=Bm,Lm.prototype.visitTimestamp=Bm,Lm.prototype.visitTimestampSecond=Bm,Lm.prototype.visitTimestampMillisecond=Bm,Lm.prototype.visitTimestampMicrosecond=Bm,Lm.prototype.visitTimestampNanosecond=Bm,Lm.prototype.visitTime=Bm,Lm.prototype.visitTimeSecond=Bm,Lm.prototype.visitTimeMillisecond=Bm,Lm.prototype.visitTimeMicrosecond=Bm,Lm.prototype.visitTimeNanosecond=Bm,Lm.prototype.visitDecimal=Bm,Lm.prototype.visitList=Bm,Lm.prototype.visitStruct=Bm,Lm.prototype.visitUnion=Bm,Lm.prototype.visitDenseUnion=Bm,Lm.prototype.visitSparseUnion=Bm,Lm.prototype.visitDictionary=Bm,Lm.prototype.visitInterval=Bm,Lm.prototype.visitIntervalDayTime=Bm,Lm.prototype.visitIntervalYearMonth=Bm,Lm.prototype.visitDuration=Bm,Lm.prototype.visitDurationSecond=Bm,Lm.prototype.visitDurationMillisecond=Bm,Lm.prototype.visitDurationMicrosecond=Bm,Lm.prototype.visitDurationNanosecond=Bm,Lm.prototype.visitFixedSizeList=Bm,Lm.prototype.visitMap=Bm;const Pm=new Lm,zm=(t,e)=>t+e;class jm extends Ud{visitNull(t,e){return 0}visitInt(t,e){return t.type.bitWidth/8}visitFloat(t,e){return t.type.ArrayType.BYTES_PER_ELEMENT}visitBool(t,e){return 1/8}visitDecimal(t,e){return t.type.bitWidth/8}visitDate(t,e){return 4*(t.type.unit+1)}visitTime(t,e){return t.type.bitWidth/8}visitTimestamp(t,e){return t.type.unit===Lh.SECOND?4:8}visitInterval(t,e){return 4*(t.type.unit+1)}visitDuration(t,e){return 8}visitStruct(t,e){return t.children.reduce(((t,n)=>t+qm.visit(n,e)),0)}visitFixedSizeBinary(t,e){return t.type.byteWidth}visitMap(t,e){return 8+t.children.reduce(((t,n)=>t+qm.visit(n,e)),0)}visitDictionary(t,e){var n;return t.type.indices.bitWidth/8+((null===(n=t.dictionary)||void 0===n?void 0:n.getByteLength(t.values[e]))||0)}}const Um=({type:t,children:e,typeIds:n,valueOffsets:r},i)=>{const o=t.typeIdToChildIndex[n[i]];return 8+qm.visit(e[o],r[i])},Vm=({children:t},e)=>4+qm.visitMany(t,t.map((()=>e))).reduce(zm,0);jm.prototype.visitUtf8=({valueOffsets:t},e)=>t[e+1]-t[e]+8,jm.prototype.visitBinary=({valueOffsets:t},e)=>t[e+1]-t[e]+8,jm.prototype.visitList=({valueOffsets:t,stride:e,children:n},r)=>{const i=n[0],{[r*e]:o}=t,{[r*e+1]:s}=t,a=qm.getVisitFn(i.type),l=i.slice(o,s-o);let u=8;for(let t=-1,e=s-o;++t<e;)u+=a(l,t);return u},jm.prototype.visitFixedSizeList=({stride:t,children:e},n)=>{const r=e[0],i=r.slice(n*t,t),o=qm.getVisitFn(r.type);let s=0;for(let t=-1,e=i.length;++t<e;)s+=o(i,t);return s},jm.prototype.visitUnion=(t,e)=>t.type.mode===Nh.Dense?Um(t,e):Vm(t,e),jm.prototype.visitDenseUnion=Um,jm.prototype.visitSparseUnion=Vm;const qm=new jm;var Wm;const Hm={},Gm={};class Ym{constructor(t){var e,n,r;const i=t[0]instanceof Ym?t.flatMap((t=>t.data)):t;if(0===i.length||i.some((t=>!(t instanceof Jm))))throw new TypeError("Vector constructor expects an Array of Data instances.");const o=null===(e=i[0])||void 0===e?void 0:e.type;switch(i.length){case 0:this._offsets=[0];break;case 1:{const{get:t,set:e,indexOf:n,byteLength:r}=Hm[o.typeId],s=i[0];this.isValid=t=>xm(s,t),this.get=e=>t(s,e),this.set=(t,n)=>e(s,t,n),this.indexOf=t=>n(s,t),this.getByteLength=t=>r(s,t),this._offsets=[0,s.length];break}default:Object.setPrototypeOf(this,Gm[o.typeId]),this._offsets=bm(i)}this.data=i,this.type=o,this.stride=jd(o),this.numChildren=null!==(r=null===(n=o.children)||void 0===n?void 0:n.length)&&void 0!==r?r:0,this.length=this._offsets.at(-1)}get byteLength(){return this.data.reduce(((t,e)=>t+e.byteLength),0)}get nullCount(){return ym(this.data)}get ArrayType(){return this.type.ArrayType}get[Symbol.toStringTag](){return`${this.VectorName}<${this.type[Symbol.toStringTag]}>`}get VectorName(){return`${Ph[this.type.typeId]}Vector`}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}includes(t,e){return this.indexOf(t,e)>-1}getByteLength(t){return 0}[Symbol.iterator](){return Pm.visit(this)}concat(...t){return new Ym(this.data.concat(t.flatMap((t=>t.data)).flat(Number.POSITIVE_INFINITY)))}slice(t,e){return new Ym(hm(this,t,e,(({data:t,_offsets:e},n,r)=>vm(t,e,n,r))))}toJSON(){return[...this]}toArray(){const{type:t,data:e,length:n,stride:r,ArrayType:i}=this;switch(t.typeId){case Ph.Int:case Ph.Float:case Ph.Decimal:case Ph.Time:case Ph.Timestamp:switch(e.length){case 0:return new i;case 1:return e[0].values.subarray(0,n*r);default:return e.reduce(((t,{values:e,length:n})=>(t.array.set(e.subarray(0,n*r),t.offset),t.offset+=n*r,t)),{array:new i(n*r),offset:0}).array}}return[...this]}toString(){return`[${[...this].join(",")}]`}getChild(t){var e;return this.getChildAt(null===(e=this.type.children)||void 0===e?void 0:e.findIndex((e=>e.name===t)))}getChildAt(t){return t>-1&&t<this.numChildren?new Ym(this.data.map((({children:e})=>e[t]))):null}get isMemoized(){return!!td.isDictionary(this.type)&&this.data[0].dictionary.isMemoized}memoize(){if(td.isDictionary(this.type)){const t=new Xm(this.data[0].dictionary),e=this.data.map((e=>{const n=e.clone();return n.dictionary=t,n}));return new Ym(e)}return new Xm(this)}unmemoize(){if(td.isDictionary(this.type)&&this.isMemoized){const t=this.data[0].dictionary.unmemoize(),e=this.data.map((e=>{const n=e.clone();return n.dictionary=t,n}));return new Ym(e)}return this}}Wm=Symbol.toStringTag,Ym[Wm]=(t=>{t.type=td.prototype,t.data=[],t.length=0,t.stride=1,t.numChildren=0,t._offsets=new Uint32Array([0]),t[Symbol.isConcatSpreadable]=!0;const e=Object.keys(Ph).map((t=>Ph[t])).filter((t=>"number"==typeof t&&t!==Ph.NONE));for(const n of e){const e=im.getVisitFnByTypeId(n),r=Cp.getVisitFnByTypeId(n),i=Fm.getVisitFnByTypeId(n),o=qm.getVisitFnByTypeId(n);Hm[n]={get:e,set:r,indexOf:i,byteLength:o},Gm[n]=Object.create(t,{isValid:{value:_m(xm)},get:{value:_m(im.getVisitFnByTypeId(n))},set:{value:km(Cp.getVisitFnByTypeId(n))},indexOf:{value:Sm(Fm.getVisitFnByTypeId(n))},getByteLength:{value:_m(qm.getVisitFnByTypeId(n))}})}return"Vector"})(Ym.prototype);class Xm extends Ym{constructor(t){super(t.data);const e=this.get,n=this.set,r=this.slice,i=new Array(this.length);Object.defineProperty(this,"get",{value(t){const n=i[t];if(void 0!==n)return n;const r=e.call(this,t);return i[t]=r,r}}),Object.defineProperty(this,"set",{value(t,e){n.call(this,t,e),i[t]=e}}),Object.defineProperty(this,"slice",{value:(t,e)=>new Xm(r.call(this,t,e))}),Object.defineProperty(this,"isMemoized",{value:!0}),Object.defineProperty(this,"unmemoize",{value:()=>new Ym(this.data)}),Object.defineProperty(this,"memoize",{value:()=>this})}}class Jm{get typeId(){return this.type.typeId}get ArrayType(){return this.type.ArrayType}get buffers(){return[this.valueOffsets,this.values,this.nullBitmap,this.typeIds]}get nullable(){if(0!==this._nullCount){const{type:t}=this;return td.isSparseUnion(t)||td.isDenseUnion(t)?this.children.some((t=>t.nullable)):this.nullBitmap&&this.nullBitmap.byteLength>0}return!0}get byteLength(){let t=0;const{valueOffsets:e,values:n,nullBitmap:r,typeIds:i}=this;return e&&(t+=e.byteLength),n&&(t+=n.byteLength),r&&(t+=r.byteLength),i&&(t+=i.byteLength),this.children.reduce(((t,e)=>t+e.byteLength),t)}get nullCount(){if(td.isUnion(this.type))return this.children.reduce(((t,e)=>t+e.nullCount),0);let t,e=this._nullCount;return e<=-1&&(t=this.nullBitmap)&&(this._nullCount=e=this.length-Om(t,this.offset,this.offset+this.length)),e}constructor(t,e,n,r,i,o=[],s){let a;this.type=t,this.children=o,this.dictionary=s,this.offset=Math.floor(Math.max(e||0,0)),this.length=Math.floor(Math.max(n||0,0)),this._nullCount=Math.floor(Math.max(r||0,-1)),i instanceof Jm?(this.stride=i.stride,this.values=i.values,this.typeIds=i.typeIds,this.nullBitmap=i.nullBitmap,this.valueOffsets=i.valueOffsets):(this.stride=jd(t),i&&((a=i[0])&&(this.valueOffsets=a),(a=i[1])&&(this.values=a),(a=i[2])&&(this.nullBitmap=a),(a=i[3])&&(this.typeIds=a)))}getValid(t){const{type:e}=this;if(td.isUnion(e)){const n=e,r=this.children[n.typeIdToChildIndex[this.typeIds[t]]],i=n.mode===Nh.Dense?this.valueOffsets[t]:t;return r.getValid(i)}if(this.nullable&&this.nullCount>0){const e=this.offset+t;return!!(this.nullBitmap[e>>3]&1<<e%8)}return!0}setValid(t,e){let n;const{type:r}=this;if(td.isUnion(r)){const i=r,o=this.children[i.typeIdToChildIndex[this.typeIds[t]]],s=i.mode===Nh.Dense?this.valueOffsets[t]:t;n=o.getValid(s),o.setValid(s,e)}else{let{nullBitmap:r}=this;const{offset:i,length:o}=this,s=i+t,a=1<<s%8,l=s>>3;(!r||r.byteLength<=l)&&(r=new Uint8Array((i+o+63&-64)>>3).fill(255),this.nullCount>0&&r.set(Cm(i,o,this.nullBitmap),0),Object.assign(this,{nullBitmap:r,_nullCount:-1}));const u=r[l];n=!!(u&a),r[l]=e?u|a:u&~a}return n!==!!e&&(this._nullCount=this.nullCount+(e?-1:1)),e}clone(t=this.type,e=this.offset,n=this.length,r=this._nullCount,i=this,o=this.children){return new Jm(t,e,n,r,i,o,this.dictionary)}slice(t,e){const{stride:n,typeId:r,children:i}=this,o=+(0===this._nullCount)-1,s=16===r?n:1,a=this._sliceBuffers(t,e,n,r);return this.clone(this.type,this.offset+t,e,o,a,0===i.length||this.valueOffsets?i:this._sliceChildren(i,s*t,s*e))}_changeLengthAndBackfillNullBitmap(t){if(this.typeId===Ph.Null)return this.clone(this.type,0,t,0);const{length:e,nullCount:n}=this,r=new Uint8Array((t+63&-64)>>3).fill(255,0,e>>3);r[e>>3]=(1<<e-(-8&e))-1,n>0&&r.set(Cm(this.offset,e,this.nullBitmap),0);const i=this.buffers;return i[zh.VALIDITY]=r,this.clone(this.type,0,t,n+(t-e),i)}_sliceBuffers(t,e,n,r){let i;const{buffers:o}=this;return(i=o[zh.TYPE])&&(o[zh.TYPE]=i.subarray(t,t+e)),(i=o[zh.OFFSET])&&(o[zh.OFFSET]=i.subarray(t,t+e+1))||(i=o[zh.DATA])&&(o[zh.DATA]=6===r?i:i.subarray(n*t,n*(t+e))),o}_sliceChildren(t,e,n){return t.map((t=>t.slice(e,n)))}}Jm.prototype.children=Object.freeze([]);class Km extends Ud{visit(t){return this.getVisitFn(t.type).call(this,t)}visitNull(t){const{type:e,offset:n=0,length:r=0}=t;return new Jm(e,n,r,r)}visitBool(t){const{type:e,offset:n=0}=t,r=bf(t.nullBitmap),i=gf(e.ArrayType,t.data),{length:o=i.length>>3,nullCount:s=(t.nullBitmap?-1:0)}=t;return new Jm(e,n,o,s,[void 0,i,r])}visitInt(t){const{type:e,offset:n=0}=t,r=bf(t.nullBitmap),i=gf(e.ArrayType,t.data),{length:o=i.length,nullCount:s=(t.nullBitmap?-1:0)}=t;return new Jm(e,n,o,s,[void 0,i,r])}visitFloat(t){const{type:e,offset:n=0}=t,r=bf(t.nullBitmap),i=gf(e.ArrayType,t.data),{length:o=i.length,nullCount:s=(t.nullBitmap?-1:0)}=t;return new Jm(e,n,o,s,[void 0,i,r])}visitUtf8(t){const{type:e,offset:n=0}=t,r=bf(t.data),i=bf(t.nullBitmap),o=yf(t.valueOffsets),{length:s=o.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new Jm(e,n,s,a,[o,r,i])}visitBinary(t){const{type:e,offset:n=0}=t,r=bf(t.data),i=bf(t.nullBitmap),o=yf(t.valueOffsets),{length:s=o.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new Jm(e,n,s,a,[o,r,i])}visitFixedSizeBinary(t){const{type:e,offset:n=0}=t,r=bf(t.nullBitmap),i=gf(e.ArrayType,t.data),{length:o=i.length/jd(e),nullCount:s=(t.nullBitmap?-1:0)}=t;return new Jm(e,n,o,s,[void 0,i,r])}visitDate(t){const{type:e,offset:n=0}=t,r=bf(t.nullBitmap),i=gf(e.ArrayType,t.data),{length:o=i.length/jd(e),nullCount:s=(t.nullBitmap?-1:0)}=t;return new Jm(e,n,o,s,[void 0,i,r])}visitTimestamp(t){const{type:e,offset:n=0}=t,r=bf(t.nullBitmap),i=gf(e.ArrayType,t.data),{length:o=i.length/jd(e),nullCount:s=(t.nullBitmap?-1:0)}=t;return new Jm(e,n,o,s,[void 0,i,r])}visitTime(t){const{type:e,offset:n=0}=t,r=bf(t.nullBitmap),i=gf(e.ArrayType,t.data),{length:o=i.length/jd(e),nullCount:s=(t.nullBitmap?-1:0)}=t;return new Jm(e,n,o,s,[void 0,i,r])}visitDecimal(t){const{type:e,offset:n=0}=t,r=bf(t.nullBitmap),i=gf(e.ArrayType,t.data),{length:o=i.length/jd(e),nullCount:s=(t.nullBitmap?-1:0)}=t;return new Jm(e,n,o,s,[void 0,i,r])}visitList(t){const{type:e,offset:n=0,child:r}=t,i=bf(t.nullBitmap),o=yf(t.valueOffsets),{length:s=o.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new Jm(e,n,s,a,[o,void 0,i],[r])}visitStruct(t){const{type:e,offset:n=0,children:r=[]}=t,i=bf(t.nullBitmap),{length:o=r.reduce(((t,{length:e})=>Math.max(t,e)),0),nullCount:s=(t.nullBitmap?-1:0)}=t;return new Jm(e,n,o,s,[void 0,void 0,i],r)}visitUnion(t){const{type:e,offset:n=0,children:r=[]}=t,i=gf(e.ArrayType,t.typeIds),{length:o=i.length,nullCount:s=-1}=t;if(td.isSparseUnion(e))return new Jm(e,n,o,s,[void 0,void 0,void 0,i],r);const a=yf(t.valueOffsets);return new Jm(e,n,o,s,[a,void 0,void 0,i],r)}visitDictionary(t){const{type:e,offset:n=0}=t,r=bf(t.nullBitmap),i=gf(e.indices.ArrayType,t.data),{dictionary:o=new Ym([(new Km).visit({type:e.dictionary})])}=t,{length:s=i.length,nullCount:a=(t.nullBitmap?-1:0)}=t;return new Jm(e,n,s,a,[void 0,i,r],[],o)}visitInterval(t){const{type:e,offset:n=0}=t,r=bf(t.nullBitmap),i=gf(e.ArrayType,t.data),{length:o=i.length/jd(e),nullCount:s=(t.nullBitmap?-1:0)}=t;return new Jm(e,n,o,s,[void 0,i,r])}visitDuration(t){const{type:e,offset:n=0}=t,r=bf(t.nullBitmap),i=gf(e.ArrayType,t.data),{length:o=i.length,nullCount:s=(t.nullBitmap?-1:0)}=t;return new Jm(e,n,o,s,[void 0,i,r])}visitFixedSizeList(t){const{type:e,offset:n=0,child:r=(new Km).visit({type:e.valueType})}=t,i=bf(t.nullBitmap),{length:o=r.length/jd(e),nullCount:s=(t.nullBitmap?-1:0)}=t;return new Jm(e,n,o,s,[void 0,void 0,i],[r])}visitMap(t){const{type:e,offset:n=0,child:r=(new Km).visit({type:e.childType})}=t,i=bf(t.nullBitmap),o=yf(t.valueOffsets),{length:s=o.length-1,nullCount:a=(t.nullBitmap?-1:0)}=t;return new Jm(e,n,s,a,[o,void 0,i],[r])}}const Qm=new Km;function Zm(t){return Qm.visit(t)}function tg(t,e=1){return(t*e+63&-64||64)/e}function eg(t,e,n=t.BYTES_PER_ELEMENT){return new t(tg(e,n))}function ng(t){return t instanceof Jm?t:new Jm(t.type,0,t.length,t.nulls,t.buffers,null,t.dict)}const rg=new TextEncoder,ig=rg.encodeInto?function(t,e,n){return rg.encodeInto(n,t.subarray(e)).written}:function(t,e,n){const r=rg.encode(n);return t.set(r,e),r.length};function og(t,e){const n=eg(t.ArrayType,e);return{set(t,e){n[e]=t},data:()=>({type:t,length:e,buffers:[null,n]})}}function sg(t,e){const n=eg(t.ArrayType,e/8);return{set(t,e){t&&(n[e>>3]|=1<<e%8)},data:()=>({type:t,length:e,buffers:[null,n]})}}function ag(t,e){const n=eg(t.ArrayType,e);return{set(t,e){n[e]=t/864e5|0},data:()=>({type:t,length:e,buffers:[null,n]})}}function lg(t,e){const n=eg(t.ArrayType,e<<1);return{set(t,e){const r=e<<1;n[r]=t%4294967296|0,n[r+1]=t/4294967296|0},data:()=>({type:t,length:e,buffers:[null,n]})}}const ug=(t,e)=>(Math.ceil(t)*e+63&-64||64)/e;class cg{constructor(t,e=1){this.buffer=t,this.stride=e,this.BYTES_PER_ELEMENT=t.BYTES_PER_ELEMENT,this.ArrayType=t.constructor,this._resize(this.length=Math.ceil(t.length/e))}get byteLength(){return Math.ceil(this.length*this.stride)*this.BYTES_PER_ELEMENT}get reservedLength(){return this.buffer.length/this.stride}get reservedByteLength(){return this.buffer.byteLength}set(t,e){return this}append(t){return this.set(this.length,t)}reserve(t){if(t>0){this.length+=t;const e=this.stride,n=this.length*e,r=this.buffer.length;n>=r&&this._resize(ug(0===r?1*n:2*n,this.BYTES_PER_ELEMENT))}return this}flush(t=this.length){t=ug(t*this.stride,this.BYTES_PER_ELEMENT);const e=((t,e=0)=>t.length>=e?t.subarray(0,e):pf(new t.constructor(e),t,0))(this.buffer,t);return this.clear(),e}clear(){return this.length=0,this._resize(0),this}_resize(t){return this.buffer=pf(new this.ArrayType(t),this.buffer)}}cg.prototype.offset=0;class hg extends cg{last(){return this.get(this.length-1)}get(t){return this.buffer[t]}set(t,e){return this.reserve(t-this.length+1),this.buffer[t*this.stride]=e,this}}class fg extends hg{constructor(t=new Uint8Array(0)){super(t,1/8),this.numValid=0}get numInvalid(){return this.length-this.numValid}get(t){return this.buffer[t>>3]>>t%8&1}set(t,e){const{buffer:n}=this.reserve(t-this.length+1),r=t>>3,i=t%8,o=n[r]>>i&1;return e?0===o&&(n[r]|=1<<i,++this.numValid):1===o&&(n[r]&=~(1<<i),--this.numValid),this}clear(){return this.numValid=0,super.clear()}}class dg extends hg{constructor(t=new Int32Array(1)){super(t,1)}append(t){return this.set(this.length-1,t)}set(t,e){const n=this.length-1,r=this.reserve(t-n+1).buffer;return n<t++&&r.fill(r[n],n,t),r[t]=r[t-1]+e,this}flush(t=this.length-1){return t>this.length&&this.set(t-1,0),super.flush(t+1)}}class pg{static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t){throw new Error('"throughDOM" not available in this environment')}constructor({type:t,nullValues:e}){this.length=0,this.finished=!1,this.type=t,this.children=[],this.nullValues=e,this.stride=jd(t),this._nulls=new fg,e&&e.length>0&&(this._isValid=function(t){if(!t||t.length<=0)return function(t){return!0};let e="";const n=t.filter((t=>t==t));return n.length>0&&(e=`\n    switch (x) {${n.map((t=>`\n        case ${function(t){return"bigint"!=typeof t?Uh(t):`${Uh(t)}n`}(t)}:`)).join("")}\n            return false;\n    }`),t.length!==n.length&&(e=`if (x !== x) return false;\n${e}`),new Function("x",`${e}\nreturn true;`)}(e))}toVector(){return new Ym([this.flush()])}get ArrayType(){return this.type.ArrayType}get nullCount(){return this._nulls.numInvalid}get numChildren(){return this.children.length}get byteLength(){let t=0;const{_offsets:e,_values:n,_nulls:r,_typeIds:i,children:o}=this;return e&&(t+=e.byteLength),n&&(t+=n.byteLength),r&&(t+=r.byteLength),i&&(t+=i.byteLength),o.reduce(((t,e)=>t+e.byteLength),t)}get reservedLength(){return this._nulls.reservedLength}get reservedByteLength(){let t=0;return this._offsets&&(t+=this._offsets.reservedByteLength),this._values&&(t+=this._values.reservedByteLength),this._nulls&&(t+=this._nulls.reservedByteLength),this._typeIds&&(t+=this._typeIds.reservedByteLength),this.children.reduce(((t,e)=>t+e.reservedByteLength),t)}get valueOffsets(){return this._offsets?this._offsets.buffer:null}get values(){return this._values?this._values.buffer:null}get nullBitmap(){return this._nulls?this._nulls.buffer:null}get typeIds(){return this._typeIds?this._typeIds.buffer:null}append(t){return this.set(this.length,t)}isValid(t){return this._isValid(t)}set(t,e){return this.setValid(t,this.isValid(e))&&this.setValue(t,e),this}setValue(t,e){this._setValue(this,t,e)}setValid(t,e){return this.length=this._nulls.set(t,+e).length,e}addChild(t,e=`${this.numChildren}`){throw new Error(`Cannot append children to non-nested type "${this.type}"`)}getChildAt(t){return this.children[t]||null}flush(){let t,e,n,r;const{type:i,length:o,nullCount:s,_typeIds:a,_offsets:l,_values:u,_nulls:c}=this;(e=null==a?void 0:a.flush(o))?r=null==l?void 0:l.flush(o):t=(r=null==l?void 0:l.flush(o))?null==u?void 0:u.flush(l.last()):null==u?void 0:u.flush(o),s>0&&(n=null==c?void 0:c.flush(o));const h=this.children.map((t=>t.flush()));return this.clear(),Zm({type:i,length:o,nullCount:s,children:h,child:h[0],data:t,typeIds:e,nullBitmap:n,valueOffsets:r})}finish(){this.finished=!0;for(const t of this.children)t.finish();return this}clear(){var t,e,n,r;this.length=0,null===(t=this._nulls)||void 0===t||t.clear(),null===(e=this._values)||void 0===e||e.clear(),null===(n=this._offsets)||void 0===n||n.clear(),null===(r=this._typeIds)||void 0===r||r.clear();for(const t of this.children)t.clear();return this}}pg.prototype.length=1,pg.prototype.stride=1,pg.prototype.children=null,pg.prototype.finished=!1,pg.prototype.nullValues=null,pg.prototype._isValid=()=>!0;class mg extends pg{constructor(t){super(t),this._values=new hg(new this.ArrayType(0),this.stride)}setValue(t,e){const n=this._values;return n.reserve(t-n.length+1),super.setValue(t,e)}}class gg extends pg{constructor(t){super(t),this._pendingLength=0,this._offsets=new dg}setValue(t,e){const n=this._pending||(this._pending=new Map),r=n.get(t);r&&(this._pendingLength-=r.length),this._pendingLength+=e instanceof am?e[om].length:e.length,n.set(t,e)}setValid(t,e){return!!super.setValid(t,e)||((this._pending||(this._pending=new Map)).set(t,void 0),!1)}clear(){return this._pendingLength=0,this._pending=void 0,super.clear()}flush(){return this._flush(),super.flush()}finish(){return this._flush(),super.finish()}_flush(){const t=this._pending,e=this._pendingLength;return this._pendingLength=0,this._pending=void 0,t&&t.size>0&&this._flushPending(t,e),this}}class yg extends gg{constructor(t){super(t),this._values=new cg(new Uint8Array(0))}get byteLength(){let t=this._pendingLength+4*this.length;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,e){return super.setValue(t,bf(e))}_flushPending(t,e){const n=this._offsets,r=this._values.reserve(e).buffer;let i=0;for(const[e,o]of t)if(void 0===o)n.set(e,0);else{const t=o.length;r.set(o,i),n.set(e,t),i+=t}}}class bg extends pg{constructor(t){super(t),this._values=new fg}setValue(t,e){this._values.set(t,+e)}}class vg extends mg{}vg.prototype._setValue=op;class wg extends vg{}wg.prototype._setValue=np;class xg extends vg{}xg.prototype._setValue=rp;class _g extends mg{}_g.prototype._setValue=gp;class kg extends pg{constructor({type:t,nullValues:e,dictionaryHashFunction:n}){super({type:new zd(t.dictionary,t.indices,t.id,t.isOrdered)}),this._nulls=null,this._dictionaryOffset=0,this._keysToIndices=Object.create(null),this.indices=gy({type:this.type.indices,nullValues:e}),this.dictionary=gy({type:this.type.dictionary,nullValues:null}),"function"==typeof n&&(this.valueToKey=n)}get values(){return this.indices.values}get nullCount(){return this.indices.nullCount}get nullBitmap(){return this.indices.nullBitmap}get byteLength(){return this.indices.byteLength+this.dictionary.byteLength}get reservedLength(){return this.indices.reservedLength+this.dictionary.reservedLength}get reservedByteLength(){return this.indices.reservedByteLength+this.dictionary.reservedByteLength}isValid(t){return this.indices.isValid(t)}setValid(t,e){const n=this.indices;return e=n.setValid(t,e),this.length=n.length,e}setValue(t,e){const n=this._keysToIndices,r=this.valueToKey(e);let i=n[r];return void 0===i&&(n[r]=i=this._dictionaryOffset+this.dictionary.append(e).length-1),this.indices.setValue(t,i)}flush(){const t=this.type,e=this._dictionary,n=this.dictionary.toVector(),r=this.indices.flush().clone(t);return r.dictionary=e?e.concat(n):n,this.finished||(this._dictionaryOffset+=n.length),this._dictionary=r.dictionary,this.clear(),r}finish(){return this.indices.finish(),this.dictionary.finish(),this._dictionaryOffset=0,this._keysToIndices=Object.create(null),super.finish()}clear(){return this.indices.clear(),this.dictionary.clear(),super.clear()}valueToKey(t){return"string"==typeof t?t:`${t}`}}class Sg extends mg{}Sg.prototype._setValue=ip;class Eg{constructor(t=[],e,n,r=Ih.V5){this.fields=t||[],this.metadata=e||new Map,n||(n=Dg(t)),this.dictionaries=n,this.metadataVersion=r}get[Symbol.toStringTag](){return"Schema"}get names(){return this.fields.map((t=>t.name))}toString(){return`Schema<{ ${this.fields.map(((t,e)=>`${e}: ${t}`)).join(", ")} }>`}select(t){const e=new Set(t),n=this.fields.filter((t=>e.has(t.name)));return new Eg(n,this.metadata)}selectAt(t){const e=t.map((t=>this.fields[t])).filter(Boolean);return new Eg(e,this.metadata)}assign(...t){const e=t[0]instanceof Eg?t[0]:Array.isArray(t[0])?new Eg(t[0]):new Eg(t),n=[...this.fields],r=Cg(Cg(new Map,this.metadata),e.metadata),i=e.fields.filter((t=>{const e=n.findIndex((e=>e.name===t.name));return!~e||(n[e]=t.clone({metadata:Cg(Cg(new Map,n[e].metadata),t.metadata)}))&&!1})),o=Dg(i,new Map);return new Eg([...n,...i],r,new Map([...this.dictionaries,...o]))}}Eg.prototype.fields=null,Eg.prototype.metadata=null,Eg.prototype.dictionaries=null;class Ag{static new(...t){let[e,n,r,i]=t;return t[0]&&"object"==typeof t[0]&&(({name:e}=t[0]),void 0===n&&(n=t[0].type),void 0===r&&(r=t[0].nullable),void 0===i&&(i=t[0].metadata)),new Ag(`${e}`,n,r,i)}constructor(t,e,n=!1,r){this.name=t,this.type=e,this.nullable=n,this.metadata=r||new Map}get typeId(){return this.type.typeId}get[Symbol.toStringTag](){return"Field"}toString(){return`${this.name}: ${this.type}`}clone(...t){let[e,n,r,i]=t;return t[0]&&"object"==typeof t[0]?({name:e=this.name,type:n=this.type,nullable:r=this.nullable,metadata:i=this.metadata}=t[0]):[e=this.name,n=this.type,r=this.nullable,i=this.metadata]=t,Ag.new(e,n,r,i)}}function Cg(t,e){return new Map([...t||new Map,...e||new Map])}function Dg(t,e=new Map){for(let n=-1,r=t.length;++n<r;){const r=t[n].type;if(td.isDictionary(r))if(e.has(r.id)){if(e.get(r.id)!==r.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}else e.set(r.id,r.dictionary);r.children&&r.children.length>0&&Dg(r.children,e)}return e}Ag.prototype.type=null,Ag.prototype.name=null,Ag.prototype.nullable=null,Ag.prototype.metadata=null;class Mg extends pg{setValue(t,e){const[n]=this.children,r=t*this.stride;for(let t=-1,i=e.length;++t<i;)n.set(r+t,e[t])}addChild(t,e="0"){if(this.numChildren>0)throw new Error("FixedSizeListBuilder can only have one child.");const n=this.children.push(t);return this.type=new Ld(this.type.listSize,new Ag(e,t.type,!0)),n}}class Og extends mg{setValue(t,e){this._values.set(t,e)}}class Tg extends Og{setValue(t,e){super.setValue(t,Yd(e))}}class Ig extends Og{}class Ng extends Og{}class $g extends mg{}$g.prototype._setValue=vp;class Fg extends $g{}Fg.prototype._setValue=wp;class Lg extends $g{}Lg.prototype._setValue=xp;class Bg extends mg{}Bg.prototype._setValue=Ap;class Rg extends Bg{}Rg.prototype._setValue=_p;class Pg extends Bg{}Pg.prototype._setValue=kp;class zg extends Bg{}zg.prototype._setValue=Sp;class jg extends Bg{}jg.prototype._setValue=Ep;class Ug extends mg{setValue(t,e){this._values.set(t,e)}}class Vg extends Ug{}class qg extends Ug{}class Wg extends Ug{}class Hg extends Ug{}class Gg extends Ug{}class Yg extends Ug{}class Xg extends Ug{}class Jg extends Ug{}class Kg extends gg{constructor(t){super(t),this._offsets=new dg}addChild(t,e="0"){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=t,this.type=new Id(new Ag(e,t.type,!0)),this.numChildren-1}_flushPending(t){const e=this._offsets,[n]=this.children;for(const[r,i]of t)if(void 0===i)e.set(r,0);else{const t=i,o=t.length,s=e.set(r,o).buffer[r];for(let e=-1;++e<o;)n.set(s+e,t[e])}}}class Qg extends gg{set(t,e){return super.set(t,e)}setValue(t,e){const n=e instanceof Map?e:new Map(Object.entries(e)),r=this._pending||(this._pending=new Map),i=r.get(t);i&&(this._pendingLength-=i.size),this._pendingLength+=n.size,r.set(t,n)}addChild(t,e=`${this.numChildren}`){if(this.numChildren>0)throw new Error("ListBuilder can only have one child.");return this.children[this.numChildren]=t,this.type=new Bd(new Ag(e,t.type,!0),this.type.keysSorted),this.numChildren-1}_flushPending(t){const e=this._offsets,[n]=this.children;for(const[r,i]of t)if(void 0===i)e.set(r,0);else{let{[r]:t,[r+1]:o}=e.set(r,i.size).buffer;for(const e of i.entries())if(n.set(t,e),++t>=o)break}}}class Zg extends pg{setValue(t,e){}setValid(t,e){return this.length=Math.max(t+1,this.length),e}}class ty extends pg{setValue(t,e){const{children:n,type:r}=this;switch(Array.isArray(e)||e.constructor){case!0:return r.children.forEach(((r,i)=>n[i].set(t,e[i])));case Map:return r.children.forEach(((r,i)=>n[i].set(t,e.get(r.name))));default:return r.children.forEach(((r,i)=>n[i].set(t,e[r.name])))}}setValid(t,e){return super.setValid(t,e)||this.children.forEach((n=>n.setValid(t,e))),e}addChild(t,e=`${this.numChildren}`){const n=this.children.push(t);return this.type=new Nd([...this.type.children,new Ag(e,t.type,!0)]),n}}class ey extends mg{}ey.prototype._setValue=cp;class ny extends ey{}ny.prototype._setValue=sp;class ry extends ey{}ry.prototype._setValue=ap;class iy extends ey{}iy.prototype._setValue=lp;class oy extends ey{}oy.prototype._setValue=up;class sy extends mg{}sy.prototype._setValue=mp;class ay extends sy{}ay.prototype._setValue=hp;class ly extends sy{}ly.prototype._setValue=fp;class uy extends sy{}uy.prototype._setValue=dp;class cy extends sy{}cy.prototype._setValue=pp;class hy extends pg{constructor(t){super(t),this._typeIds=new hg(new Int8Array(0),1),"function"==typeof t.valueToChildTypeId&&(this._valueToChildTypeId=t.valueToChildTypeId)}get typeIdToChildIndex(){return this.type.typeIdToChildIndex}append(t,e){return this.set(this.length,t,e)}set(t,e,n){return void 0===n&&(n=this._valueToChildTypeId(this,e,t)),this.setValue(t,e,n),this}setValue(t,e,n){this._typeIds.set(t,n);const r=this.type.typeIdToChildIndex[n],i=this.children[r];null==i||i.set(t,e)}addChild(t,e=`${this.children.length}`){const n=this.children.push(t),{type:{children:r,mode:i,typeIds:o}}=this,s=[...r,new Ag(e,t.type)];return this.type=new $d(i,[...o,n],s),n}_valueToChildTypeId(t,e,n){throw new Error("Cannot map UnionBuilder value to child typeId. Pass the `childTypeId` as the second argument to unionBuilder.append(), or supply a `valueToChildTypeId` function as part of the UnionBuilder constructor options.")}}class fy extends hy{}class dy extends hy{constructor(t){super(t),this._offsets=new hg(new Int32Array(0))}setValue(t,e,n){const r=this._typeIds.set(t,n).buffer[t],i=this.getChildAt(this.type.typeIdToChildIndex[r]),o=this._offsets.set(t,i.length).buffer[t];null==i||i.set(o,e)}}class py extends gg{constructor(t){super(t),this._values=new cg(new Uint8Array(0))}get byteLength(){let t=this._pendingLength+4*this.length;return this._offsets&&(t+=this._offsets.byteLength),this._values&&(t+=this._values.byteLength),this._nulls&&(t+=this._nulls.byteLength),t}setValue(t,e){return super.setValue(t,Kh(e))}_flushPending(t,e){}}py.prototype._flushPending=yg.prototype._flushPending;const my=new class extends Ud{visitNull(){return Zg}visitBool(){return bg}visitInt(){return Ug}visitInt8(){return Vg}visitInt16(){return qg}visitInt32(){return Wg}visitInt64(){return Hg}visitUint8(){return Gg}visitUint16(){return Yg}visitUint32(){return Xg}visitUint64(){return Jg}visitFloat(){return Og}visitFloat16(){return Tg}visitFloat32(){return Ig}visitFloat64(){return Ng}visitUtf8(){return py}visitBinary(){return yg}visitFixedSizeBinary(){return Sg}visitDate(){return vg}visitDateDay(){return wg}visitDateMillisecond(){return xg}visitTimestamp(){return ey}visitTimestampSecond(){return ny}visitTimestampMillisecond(){return ry}visitTimestampMicrosecond(){return iy}visitTimestampNanosecond(){return oy}visitTime(){return sy}visitTimeSecond(){return ay}visitTimeMillisecond(){return ly}visitTimeMicrosecond(){return uy}visitTimeNanosecond(){return cy}visitDecimal(){return _g}visitList(){return Kg}visitStruct(){return ty}visitUnion(){return hy}visitDenseUnion(){return dy}visitSparseUnion(){return fy}visitDictionary(){return kg}visitInterval(){return $g}visitIntervalDayTime(){return Fg}visitIntervalYearMonth(){return Lg}visitDuration(){return Bg}visitDurationSecond(){return Rg}visitDurationMillisecond(){return Pg}visitDurationMicrosecond(){return zg}visistDurationNanosecond(){return jg}visitFixedSizeList(){return Mg}visitMap(){return Qg}};function gy(t){const e=t.type,n=new(my.getVisitFn(e)())(t);if(e.children&&e.children.length>0){const r=t.children||[],i={nullValues:t.nullValues},o=Array.isArray(r)?(t,e)=>r[e]||i:({name:t})=>r[t]||i;for(const[t,r]of e.children.entries()){const{type:e}=r,i=o(r,t);n.children.push(gy(Object.assign(Object.assign({},i),{type:e})))}}return n}function yy(t,e){const n=[],r=eg(t.indices.ArrayType,e),i=Object.create(null);let o=-1,s=0;return{set(t,e){const a=String(t);let l=i[a];void 0===l&&(s+=a.length,i[a]=l=++o,n.push(a)),r[e]=l},data:()=>({type:t,length:e,buffers:[null,r],dict:by(t.dictionary,n,s)})}}function by(t,e,n){const r=function(t,e,n){const r=eg(Int32Array,e+1),i=eg(Uint8Array,3*n);let o=0;return{set(t,e){o+=ig(i,o,t),r[e+1]=o},data:()=>{const n=tg(o),s=i.length>n?i.subarray(0,n):i;return{type:t,length:e,buffers:[r,s]}}}}(t,e.length,n);return e.forEach(r.set),function(t){return new Ym([ng(t)])}(r.data())}function vy(t,e,n,r,i=!0){const o=function(t,e,n=!0){let r;switch(t.typeId){case Ph.Int:r=t.bitWidth<64?og:null;break;case Ph.Float:r=t.precision>0?og:null;break;case Ph.Dictionary:r=t.dictionary.typeId===Ph.Utf8&&t.indices.typeId===Ph.Int&&t.indices.bitWidth<64?yy:null;break;case Ph.Bool:r=sg;break;case Ph.Date:r=t.unit?lg:ag}return null==r?function(t){const e=gy({type:t,nullValues:[null,void 0]});return{set(t,n){e.set(n,t)},data:()=>e.finish().flush()}}(t):n?function(t,e){const n=eg(Uint8Array,e/8);let r=0;return{set(e,i){null==e?++r:(t.set(e,i),n[i>>3]|=1<<i%8)},data:()=>{const e=t.data();return r&&(e.nulls=r,e.buffers[2]=n),e}}}(r(t,e),e):r(t,e)}(r,t,i);return e(n,o.set),ng(o.data())}function wy(t){if(t instanceof td||null==t)return t;switch(t){case Ph.Binary:return new md;case Ph.Bool:return new yd;case Ph.DateDay:return new wd;case Ph.DateMillisecond:case Ph.Date:return new xd;case Ph.Dictionary:return new zd(new gd,new od);case Ph.Float16:return new fd;case Ph.Float32:return new dd;case Ph.Float64:case Ph.Float:return new pd;case Ph.Int8:return new rd;case Ph.Int16:return new id;case Ph.Int32:case Ph.Int:return new od;case Ph.Int64:return new sd;case Ph.IntervalDayTime:return new Md;case Ph.Interval:case Ph.IntervalYearMonth:return new Od;case Ph.Null:return new ed;case Ph.TimeMicrosecond:return new Ed;case Ph.TimeMillisecond:case Ph.Time:return new Sd;case Ph.TimeNanosecond:return new Ad;case Ph.TimeSecond:return new kd;case Ph.Uint8:return new ad;case Ph.Uint16:return new ld;case Ph.Uint32:return new ud;case Ph.Uint64:return new cd;case Ph.Utf8:return new gd;default:$u(`Unsupported type code: ${Oc(t)}. Use a data type constructor instead?`)}}function xy(t,e){const n=_y();return t(e,n.add),n}function _y(){const t={count:0,nulls:0,bools:0,nums:0,ints:0,bigints:0,min:1/0,max:-1/0,digits:0,dates:0,utcdays:0,strings:0,strlen:0,arrays:0,minlen:1/0,maxlen:0,structs:0,add(e){if(++t.count,null==e)return void++t.nulls;const n=typeof e;if("string"===n)++t.strings;else if("number"===n)++t.nums,e<t.min&&(t.min=e),e>t.max&&(t.max=e),Number.isInteger(e)&&++t.ints;else if("boolean"===n)++t.bools;else if("object"===n)if(ju(e))++t.dates,0===(r=e).getUTCHours()&&0===r.getUTCMinutes()&&0===r.getUTCSeconds()&&0===r.getUTCMilliseconds()&&++t.utcdays;else if(Zu(e)){++t.arrays,e.length<t.minlen&&(t.minlen=e.length),e.length>t.maxlen&&(t.maxlen=e.length);const n=t.array_prof||(t.array_prof=_y());e.forEach(n.add)}else{++t.structs;const n=t.struct_prof||(t.struct_prof={});for(const t in e)(n[t]||(n[t]=_y())).add(e[t])}else"bigint"===n&&(++t.bigints,e<t.min&&(t.min=e),e>t.max&&(t.max=e));var r},type:()=>wy(function(t){const e=t.count-t.nulls;if(0===e)return Ph.Null;if(t.ints===e){const e=Math.max(Math.abs(t.min)-1,t.max);return t.min<0?e>=2**31?Ph.Float64:e<128?Ph.Int8:e<32768?Ph.Int16:Ph.Int32:e>=2**32?Ph.Float64:e<256?Ph.Uint8:e<65536?Ph.Uint16:Ph.Uint32}if(t.nums===e)return Ph.Float64;if(t.bigints===e){const e=-t.min>t.max?-t.min-1n:t.max;return t.min<0?e<2**63?Ph.Int64:$u(`BigInt exceeds 64 bits: ${e}`):t.max<2**64?Ph.Uint64:$u(`BigInt exceeds 64 bits: ${t.max}`)}if(t.bools===e)return Ph.Bool;if(t.utcdays===e)return Ph.DateDay;if(t.dates===e)return Ph.DateMillisecond;if(t.arrays===e){const e=Ag.new("value",t.array_prof.type(),!0);return t.minlen===t.maxlen?new Ld(t.minlen,e):new Id(e)}if(t.structs===e){const e=t.struct_prof;return new Nd(Object.keys(e).map((t=>Ag.new(t,e[t].type(),!0))))}if(t.strings>0)return Ph.Dictionary;$u("Type inference failure")}(t))};return t}function ky(t,e,n,r,i,o=!0){if(!(i=wy(i))){const t=xy(r,e);o=t.nulls>0,i=t.type()}return vy(n,r,e,i,o)}function Sy(t,e,n,r,i,o=!0){i=wy(i);const s=t.column(e),a=!(t.isFiltered()||t.isOrdered()),l=function(t){return t instanceof Ym?t:t.vector instanceof Ym?t.vector:null}(s);if(l&&a&&Ey(l.type,i))return l;const u=s.data;if(Qu(u)){const t=function(t){const e={Float32Array:dd,Float64Array:pd,Int8Array:rd,Int16Array:id,Int32Array:od,Uint8Array:ad,Uint16Array:ld,Uint32Array:ud,BigInt64Array:sd,BigUint64Array:cd}[t.constructor.name];return e?new e:null}(u);if(a&&t&&Ey(t,i))return function(t,e){const n=t.length,r=tg(n,t.BYTES_PER_ELEMENT);let i=t;return n!==r&&(i=new t.constructor(r),i.set(t)),ng({type:e,length:n,buffers:[null,i]})}(u,t);i=i||t,o=!1}if(!i){const t=xy(r,s);o=t.nulls>0,i=t.type()}return vy(n,r,s,i,o)}function Ey(t,e){return!t||!e||t.compareTo(e)}function Ay(t,e,n){const r=Math.min(t.length,n+e);return(e,i)=>{for(let o=n;o<r;++o)i(t[o][e],o)}}function Cy(t,e,n){const r=0===n&&t.numRows()<=e&&!t.isFiltered()&&!t.isOrdered();return(i,o)=>{let s=-1;r&&Zu(i.data)?i.data.forEach(o):t.scan((t=>o(i.get(t),++s)),!0,e,n)}}class Dy extends Ud{compareSchemas(t,e){return t===e||e instanceof t.constructor&&this.compareManyFields(t.fields,e.fields)}compareManyFields(t,e){return t===e||Array.isArray(t)&&Array.isArray(e)&&t.length===e.length&&t.every(((t,n)=>this.compareFields(t,e[n])))}compareFields(t,e){return t===e||e instanceof t.constructor&&t.name===e.name&&t.nullable===e.nullable&&this.visit(t.type,e.type)}}function My(t,e){return e instanceof t.constructor}function Oy(t,e){return t===e||My(t,e)}function Ty(t,e){return t===e||My(t,e)&&t.bitWidth===e.bitWidth&&t.isSigned===e.isSigned}function Iy(t,e){return t===e||My(t,e)&&t.precision===e.precision}function Ny(t,e){return t===e||My(t,e)&&t.unit===e.unit}function $y(t,e){return t===e||My(t,e)&&t.unit===e.unit&&t.timezone===e.timezone}function Fy(t,e){return t===e||My(t,e)&&t.unit===e.unit&&t.bitWidth===e.bitWidth}function Ly(t,e){return t===e||My(t,e)&&t.mode===e.mode&&t.typeIds.every(((t,n)=>t===e.typeIds[n]))&&Py.compareManyFields(t.children,e.children)}function By(t,e){return t===e||My(t,e)&&t.unit===e.unit}function Ry(t,e){return t===e||My(t,e)&&t.unit===e.unit}Dy.prototype.visitNull=Oy,Dy.prototype.visitBool=Oy,Dy.prototype.visitInt=Ty,Dy.prototype.visitInt8=Ty,Dy.prototype.visitInt16=Ty,Dy.prototype.visitInt32=Ty,Dy.prototype.visitInt64=Ty,Dy.prototype.visitUint8=Ty,Dy.prototype.visitUint16=Ty,Dy.prototype.visitUint32=Ty,Dy.prototype.visitUint64=Ty,Dy.prototype.visitFloat=Iy,Dy.prototype.visitFloat16=Iy,Dy.prototype.visitFloat32=Iy,Dy.prototype.visitFloat64=Iy,Dy.prototype.visitUtf8=Oy,Dy.prototype.visitBinary=Oy,Dy.prototype.visitFixedSizeBinary=function(t,e){return t===e||My(t,e)&&t.byteWidth===e.byteWidth},Dy.prototype.visitDate=Ny,Dy.prototype.visitDateDay=Ny,Dy.prototype.visitDateMillisecond=Ny,Dy.prototype.visitTimestamp=$y,Dy.prototype.visitTimestampSecond=$y,Dy.prototype.visitTimestampMillisecond=$y,Dy.prototype.visitTimestampMicrosecond=$y,Dy.prototype.visitTimestampNanosecond=$y,Dy.prototype.visitTime=Fy,Dy.prototype.visitTimeSecond=Fy,Dy.prototype.visitTimeMillisecond=Fy,Dy.prototype.visitTimeMicrosecond=Fy,Dy.prototype.visitTimeNanosecond=Fy,Dy.prototype.visitDecimal=Oy,Dy.prototype.visitList=function(t,e){return t===e||My(t,e)&&t.children.length===e.children.length&&Py.compareManyFields(t.children,e.children)},Dy.prototype.visitStruct=function(t,e){return t===e||My(t,e)&&t.children.length===e.children.length&&Py.compareManyFields(t.children,e.children)},Dy.prototype.visitUnion=Ly,Dy.prototype.visitDenseUnion=Ly,Dy.prototype.visitSparseUnion=Ly,Dy.prototype.visitDictionary=function(t,e){return t===e||My(t,e)&&t.id===e.id&&t.isOrdered===e.isOrdered&&Py.visit(t.indices,e.indices)&&Py.visit(t.dictionary,e.dictionary)},Dy.prototype.visitInterval=By,Dy.prototype.visitIntervalDayTime=By,Dy.prototype.visitIntervalYearMonth=By,Dy.prototype.visitDuration=Ry,Dy.prototype.visitDurationSecond=Ry,Dy.prototype.visitDurationMillisecond=Ry,Dy.prototype.visitDurationMicrosecond=Ry,Dy.prototype.visitDurationNanosecond=Ry,Dy.prototype.visitFixedSizeList=function(t,e){return t===e||My(t,e)&&t.listSize===e.listSize&&t.children.length===e.children.length&&Py.compareManyFields(t.children,e.children)},Dy.prototype.visitMap=function(t,e){return t===e||My(t,e)&&t.keysSorted===e.keysSorted&&t.children.length===e.children.length&&Py.compareManyFields(t.children,e.children)};const Py=new Dy;function zy(t,e){return Py.compareSchemas(t,e)}var jy,Uy;class Vy{constructor(...t){switch(t.length){case 2:if([this.schema]=t,!(this.schema instanceof Eg))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");if([,this.data=Zm({nullCount:0,type:new Nd(this.schema.fields),children:this.schema.fields.map((t=>Zm({type:t.type,nullCount:0})))})]=t,!(this.data instanceof Jm))throw new TypeError("RecordBatch constructor expects a [Schema, Data] pair.");[this.schema,this.data]=qy(this.schema,this.data.children);break;case 1:{const[e]=t,{fields:n,children:r,length:i}=Object.keys(e).reduce(((t,n,r)=>(t.children[r]=e[n],t.length=Math.max(t.length,e[n].length),t.fields[r]=Ag.new({name:n,type:e[n].type,nullable:!0}),t)),{length:0,fields:new Array,children:new Array}),o=new Eg(n),s=Zm({type:new Nd(n),length:i,children:r,nullCount:0});[this.schema,this.data]=qy(o,s.children,i);break}default:throw new TypeError("RecordBatch constructor expects an Object mapping names to child Data, or a [Schema, Data] pair.")}}get dictionaries(){return this._dictionaries||(this._dictionaries=Wy(this.schema.fields,this.data.children))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.length}get nullCount(){return this.data.nullCount}isValid(t){return this.data.getValid(t)}get(t){return im.visit(this.data,t)}set(t,e){return Cp.visit(this.data,t,e)}indexOf(t,e){return Fm.visit(this.data,t,e)}getByteLength(t){return qm.visit(this.data,t)}[Symbol.iterator](){return Pm.visit(new Ym([this.data]))}toArray(){return[...this]}concat(...t){return new Xy(this.schema,[this,...t])}slice(t,e){const[n]=new Ym([this.data]).slice(t,e).data;return new Vy(this.schema,n)}getChild(t){var e;return this.getChildAt(null===(e=this.schema.fields)||void 0===e?void 0:e.findIndex((e=>e.name===t)))}getChildAt(t){return t>-1&&t<this.schema.fields.length?new Ym([this.data.children[t]]):null}setChild(t,e){var n;return this.setChildAt(null===(n=this.schema.fields)||void 0===n?void 0:n.findIndex((e=>e.name===t)),e)}setChildAt(t,e){let n=this.schema,r=this.data;if(t>-1&&t<this.numCols){e||(e=new Ym([Zm({type:new ed,length:this.numRows})]));const i=n.fields.slice(),o=r.children.slice(),s=i[t].clone({type:e.type});[i[t],o[t]]=[s,e.data[0]],n=new Eg(i,new Map(this.schema.metadata)),r=Zm({type:new Nd(i),children:o})}return new Vy(n,r)}select(t){const e=this.schema.select(t),n=new Nd(e.fields),r=[];for(const e of t){const t=this.schema.fields.findIndex((t=>t.name===e));~t&&(r[t]=this.data.children[t])}return new Vy(e,Zm({type:n,length:this.numRows,children:r}))}selectAt(t){const e=this.schema.selectAt(t),n=t.map((t=>this.data.children[t])).filter(Boolean),r=Zm({type:new Nd(e.fields),length:this.numRows,children:n});return new Vy(e,r)}}function qy(t,e,n=e.reduce(((t,e)=>Math.max(t,e.length)),0)){var r;const i=[...t.fields],o=[...e],s=(n+63&-64)>>3;for(const[a,l]of t.fields.entries()){const t=e[a];t&&t.length===n||(i[a]=l.clone({nullable:!0}),o[a]=null!==(r=null==t?void 0:t._changeLengthAndBackfillNullBitmap(n))&&void 0!==r?r:Zm({type:l.type,length:n,nullCount:n,nullBitmap:new Uint8Array(s)}))}return[t.assign(i),Zm({type:new Nd(i),length:n,children:o})]}function Wy(t,e,n=new Map){var r,i;if((null!==(r=null==t?void 0:t.length)&&void 0!==r?r:0)>0&&(null==t?void 0:t.length)===(null==e?void 0:e.length))for(let r=-1,o=t.length;++r<o;){const{type:o}=t[r],s=e[r];for(const t of[s,...(null===(i=null==s?void 0:s.dictionary)||void 0===i?void 0:i.data)||[]])Wy(o.children,null==t?void 0:t.children,n);if(td.isDictionary(o)){const{id:t}=o;if(n.has(t)){if(n.get(t)!==s.dictionary)throw new Error("Cannot create Schema containing two different dictionaries with the same Id")}else(null==s?void 0:s.dictionary)&&n.set(t,s.dictionary)}}return n}jy=Symbol.toStringTag,Vy[jy]=(t=>(t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,"RecordBatch"))(Vy.prototype);class Hy extends Vy{constructor(t){const e=t.fields.map((t=>Zm({type:t.type})));super(t,Zm({type:new Nd(t.fields),nullCount:0,children:e}))}}function Gy(t,e){return function(t,e){const n=[...t.fields],r=[],i={numBatches:e.reduce(((t,e)=>Math.max(t,e.length)),0)};let o=0,s=0,a=-1;const l=e.length;let u,c=[];for(;i.numBatches-- >0;){for(s=Number.POSITIVE_INFINITY,a=-1;++a<l;)c[a]=u=e[a].shift(),s=Math.min(s,u?u.length:s);Number.isFinite(s)&&(c=Yy(n,s,c,e,i),s>0&&(r[o++]=Zm({type:new Nd(n),length:s,nullCount:0,children:c.slice()})))}return[t=t.assign(n),r.map((e=>new Vy(t,e)))]}(t,e.map((t=>t.data.concat())))}function Yy(t,e,n,r,i){var o;const s=(e+63&-64)>>3;for(let a=-1,l=r.length;++a<l;){const l=n[a],u=null==l?void 0:l.length;if(u>=e)u===e?n[a]=l:(n[a]=l.slice(0,e),i.numBatches=Math.max(i.numBatches,r[a].unshift(l.slice(e,u-e))));else{const r=t[a];t[a]=r.clone({nullable:!0}),n[a]=null!==(o=null==l?void 0:l._changeLengthAndBackfillNullBitmap(e))&&void 0!==o?o:Zm({type:r.type,length:e,nullCount:e,nullBitmap:new Uint8Array(s)})}}return n}class Xy{constructor(...t){var e,n;if(0===t.length)return this.batches=[],this.schema=new Eg([]),this._offsets=[0],this;let r,i;t[0]instanceof Eg&&(r=t.shift()),t.at(-1)instanceof Uint32Array&&(i=t.pop());const o=t=>{if(t){if(t instanceof Vy)return[t];if(t instanceof Xy)return t.batches;if(t instanceof Jm){if(t.type instanceof Nd)return[new Vy(new Eg(t.type.children),t)]}else{if(Array.isArray(t))return t.flatMap((t=>o(t)));if("function"==typeof t[Symbol.iterator])return[...t].flatMap((t=>o(t)));if("object"==typeof t){const e=Object.keys(t),n=e.map((e=>new Ym([t[e]]))),r=new Eg(e.map(((t,e)=>new Ag(String(t),n[e].type)))),[,i]=Gy(r,n);return 0===i.length?[new Vy(t)]:i}}}return[]},s=t.flatMap((t=>o(t)));if(r=null!==(n=null!=r?r:null===(e=s[0])||void 0===e?void 0:e.schema)&&void 0!==n?n:new Eg([]),!(r instanceof Eg))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");for(const t of s){if(!(t instanceof Vy))throw new TypeError("Table constructor expects a [Schema, RecordBatch[]] pair.");if(!zy(r,t.schema))throw new TypeError("Table and inner RecordBatch schemas must be equivalent.")}this.schema=r,this.batches=s,this._offsets=null!=i?i:bm(this.data)}get data(){return this.batches.map((({data:t})=>t))}get numCols(){return this.schema.fields.length}get numRows(){return this.data.reduce(((t,e)=>t+e.length),0)}get nullCount(){return-1===this._nullCount&&(this._nullCount=ym(this.data)),this._nullCount}isValid(t){return!1}get(t){return null}set(t,e){}indexOf(t,e){return-1}getByteLength(t){return 0}[Symbol.iterator](){return this.batches.length>0?Pm.visit(new Ym(this.data)):new Array(0)[Symbol.iterator]()}toArray(){return[...this]}toString(){return`[\n  ${this.toArray().join(",\n  ")}\n]`}concat(...t){const e=this.schema,n=this.data.concat(t.flatMap((({data:t})=>t)));return new Xy(e,n.map((t=>new Vy(e,t))))}slice(t,e){const n=this.schema;[t,e]=hm({length:this.numRows},t,e);const r=vm(this.data,this._offsets,t,e);return new Xy(n,r.map((t=>new Vy(n,t))))}getChild(t){return this.getChildAt(this.schema.fields.findIndex((e=>e.name===t)))}getChildAt(t){if(t>-1&&t<this.schema.fields.length){const e=this.data.map((e=>e.children[t]));if(0===e.length){const{type:n}=this.schema.fields[t],r=Zm({type:n,length:0,nullCount:0});e.push(r._changeLengthAndBackfillNullBitmap(this.numRows))}return new Ym(e)}return null}setChild(t,e){var n;return this.setChildAt(null===(n=this.schema.fields)||void 0===n?void 0:n.findIndex((e=>e.name===t)),e)}setChildAt(t,e){let n=this.schema,r=[...this.batches];if(t>-1&&t<this.numCols){e||(e=new Ym([Zm({type:new ed,length:this.numRows})]));const i=n.fields.slice(),o=i[t].clone({type:e.type}),s=this.schema.fields.map(((t,e)=>this.getChildAt(e)));[i[t],s[t]]=[o,e],[n,r]=Gy(n,s)}return new Xy(n,r)}select(t){const e=this.schema.fields.reduce(((t,e,n)=>t.set(e.name,n)),new Map);return this.selectAt(t.map((t=>e.get(t))).filter((t=>t>-1)))}selectAt(t){const e=this.schema.selectAt(t),n=this.batches.map((e=>e.selectAt(t)));return new Xy(e,n)}assign(t){const e=this.schema.fields,[n,r]=t.schema.fields.reduce(((t,n,r)=>{const[i,o]=t,s=e.findIndex((t=>t.name===n.name));return~s?o[s]=r:i.push(r),t}),[[],[]]),i=this.schema.assign(t.schema),o=[...e.map(((t,e)=>[e,r[e]])).map((([e,n])=>void 0===n?this.getChildAt(e):t.getChildAt(n))),...n.map((e=>t.getChildAt(e)))].filter(Boolean);return new Xy(...Gy(i,o))}}Uy=Symbol.toStringTag,Xy[Uy]=(t=>(t.schema=null,t.batches=[],t._offsets=new Uint32Array([0]),t._nullCount=-1,t[Symbol.isConcatSpreadable]=!0,t.isValid=_m(xm),t.get=_m(im.getVisitFn(Ph.Struct)),t.set=km(Cp.getVisitFn(Ph.Struct)),t.indexOf=Sm(Fm.getVisitFn(Ph.Struct)),t.getByteLength=_m(qm.getVisitFn(Ph.Struct)),"Table"))(Xy.prototype);class Jy{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}metaDataLength(){return this.bb.readInt32(this.bb_pos+8)}bodyLength(){return this.bb.readInt64(this.bb_pos+16)}static sizeOf(){return 24}static createBlock(t,e,n,r){return t.prep(8,24),t.writeInt64(BigInt(null!=r?r:0)),t.pad(4),t.writeInt32(n),t.writeInt64(BigInt(null!=e?e:0)),t.offset()}}const Ky=new Int32Array(2),Qy=new Float32Array(Ky.buffer),Zy=new Float64Array(Ky.buffer),tb=1===new Uint16Array(new Uint8Array([1,0]).buffer)[0];var eb,nb,rb,ib,ob;!function(t){t[t.UTF8_BYTES=1]="UTF8_BYTES",t[t.UTF16_STRING=2]="UTF16_STRING"}(eb||(eb={}));class sb{constructor(t){this.bytes_=t,this.position_=0,this.text_decoder_=new TextDecoder}static allocate(t){return new sb(new Uint8Array(t))}clear(){this.position_=0}bytes(){return this.bytes_}position(){return this.position_}setPosition(t){this.position_=t}capacity(){return this.bytes_.length}readInt8(t){return this.readUint8(t)<<24>>24}readUint8(t){return this.bytes_[t]}readInt16(t){return this.readUint16(t)<<16>>16}readUint16(t){return this.bytes_[t]|this.bytes_[t+1]<<8}readInt32(t){return this.bytes_[t]|this.bytes_[t+1]<<8|this.bytes_[t+2]<<16|this.bytes_[t+3]<<24}readUint32(t){return this.readInt32(t)>>>0}readInt64(t){return BigInt.asIntN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readUint64(t){return BigInt.asUintN(64,BigInt(this.readUint32(t))+(BigInt(this.readUint32(t+4))<<BigInt(32)))}readFloat32(t){return Ky[0]=this.readInt32(t),Qy[0]}readFloat64(t){return Ky[tb?0:1]=this.readInt32(t),Ky[tb?1:0]=this.readInt32(t+4),Zy[0]}writeInt8(t,e){this.bytes_[t]=e}writeUint8(t,e){this.bytes_[t]=e}writeInt16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeUint16(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8}writeInt32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeUint32(t,e){this.bytes_[t]=e,this.bytes_[t+1]=e>>8,this.bytes_[t+2]=e>>16,this.bytes_[t+3]=e>>24}writeInt64(t,e){this.writeInt32(t,Number(BigInt.asIntN(32,e))),this.writeInt32(t+4,Number(BigInt.asIntN(32,e>>BigInt(32))))}writeUint64(t,e){this.writeUint32(t,Number(BigInt.asUintN(32,e))),this.writeUint32(t+4,Number(BigInt.asUintN(32,e>>BigInt(32))))}writeFloat32(t,e){Qy[0]=e,this.writeInt32(t,Ky[0])}writeFloat64(t,e){Zy[0]=e,this.writeInt32(t,Ky[tb?0:1]),this.writeInt32(t+4,Ky[tb?1:0])}getBufferIdentifier(){if(this.bytes_.length<this.position_+4+4)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");let t="";for(let e=0;e<4;e++)t+=String.fromCharCode(this.readInt8(this.position_+4+e));return t}__offset(t,e){const n=t-this.readInt32(t);return e<this.readInt16(n)?this.readInt16(n+e):0}__union(t,e){return t.bb_pos=e+this.readInt32(e),t.bb=this,t}__string(t,e){t+=this.readInt32(t);const n=this.readInt32(t);t+=4;const r=this.bytes_.subarray(t,t+n);return e===eb.UTF8_BYTES?r:this.text_decoder_.decode(r)}__union_with_string(t,e){return"string"==typeof t?this.__string(e):this.__union(t,e)}__indirect(t){return t+this.readInt32(t)}__vector(t){return t+this.readInt32(t)+4}__vector_len(t){return this.readInt32(t+this.readInt32(t))}__has_identifier(t){if(4!=t.length)throw new Error("FlatBuffers: file identifier must be length 4");for(let e=0;e<4;e++)if(t.charCodeAt(e)!=this.readInt8(this.position()+4+e))return!1;return!0}createScalarList(t,e){const n=[];for(let r=0;r<e;++r){const e=t(r);null!==e&&n.push(e)}return n}createObjList(t,e){const n=[];for(let r=0;r<e;++r){const e=t(r);null!==e&&n.push(e.unpack())}return n}}class ab{constructor(t){let e;this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null,this.text_encoder=new TextEncoder,e=t||1024,this.bb=sb.allocate(e),this.space=e}clear(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1,this.string_maps=null}forceDefaults(t){this.force_defaults=t}dataBuffer(){return this.bb}asUint8Array(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())}prep(t,e){t>this.minalign&&(this.minalign=t);const n=1+~(this.bb.capacity()-this.space+e)&t-1;for(;this.space<n+t+e;){const t=this.bb.capacity();this.bb=ab.growByteBuffer(this.bb),this.space+=this.bb.capacity()-t}this.pad(n)}pad(t){for(let e=0;e<t;e++)this.bb.writeInt8(--this.space,0)}writeInt8(t){this.bb.writeInt8(this.space-=1,t)}writeInt16(t){this.bb.writeInt16(this.space-=2,t)}writeInt32(t){this.bb.writeInt32(this.space-=4,t)}writeInt64(t){this.bb.writeInt64(this.space-=8,t)}writeFloat32(t){this.bb.writeFloat32(this.space-=4,t)}writeFloat64(t){this.bb.writeFloat64(this.space-=8,t)}addInt8(t){this.prep(1,0),this.writeInt8(t)}addInt16(t){this.prep(2,0),this.writeInt16(t)}addInt32(t){this.prep(4,0),this.writeInt32(t)}addInt64(t){this.prep(8,0),this.writeInt64(t)}addFloat32(t){this.prep(4,0),this.writeFloat32(t)}addFloat64(t){this.prep(8,0),this.writeFloat64(t)}addFieldInt8(t,e,n){(this.force_defaults||e!=n)&&(this.addInt8(e),this.slot(t))}addFieldInt16(t,e,n){(this.force_defaults||e!=n)&&(this.addInt16(e),this.slot(t))}addFieldInt32(t,e,n){(this.force_defaults||e!=n)&&(this.addInt32(e),this.slot(t))}addFieldInt64(t,e,n){(this.force_defaults||e!==n)&&(this.addInt64(e),this.slot(t))}addFieldFloat32(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat32(e),this.slot(t))}addFieldFloat64(t,e,n){(this.force_defaults||e!=n)&&(this.addFloat64(e),this.slot(t))}addFieldOffset(t,e,n){(this.force_defaults||e!=n)&&(this.addOffset(e),this.slot(t))}addFieldStruct(t,e,n){e!=n&&(this.nested(e),this.slot(t))}nested(t){if(t!=this.offset())throw new TypeError("FlatBuffers: struct must be serialized inline.")}notNested(){if(this.isNested)throw new TypeError("FlatBuffers: object serialization must not be nested.")}slot(t){null!==this.vtable&&(this.vtable[t]=this.offset())}offset(){return this.bb.capacity()-this.space}static growByteBuffer(t){const e=t.capacity();if(3221225472&e)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");const n=e<<1,r=sb.allocate(n);return r.setPosition(n-e),r.bytes().set(t.bytes(),n-e),r}addOffset(t){this.prep(4,0),this.writeInt32(this.offset()-t+4)}startObject(t){this.notNested(),null==this.vtable&&(this.vtable=[]),this.vtable_in_use=t;for(let e=0;e<t;e++)this.vtable[e]=0;this.isNested=!0,this.object_start=this.offset()}endObject(){if(null==this.vtable||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);const t=this.offset();let e=this.vtable_in_use-1;for(;e>=0&&0==this.vtable[e];e--);const n=e+1;for(;e>=0;e--)this.addInt16(0!=this.vtable[e]?t-this.vtable[e]:0);this.addInt16(t-this.object_start);const r=2*(n+2);this.addInt16(r);let i=0;const o=this.space;t:for(e=0;e<this.vtables.length;e++){const t=this.bb.capacity()-this.vtables[e];if(r==this.bb.readInt16(t)){for(let e=2;e<r;e+=2)if(this.bb.readInt16(o+e)!=this.bb.readInt16(t+e))continue t;i=this.vtables[e];break}}return i?(this.space=this.bb.capacity()-t,this.bb.writeInt32(this.space,i-t)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-t,this.offset()-t)),this.isNested=!1,t}finish(t,e,n){const r=n?4:0;if(e){const t=e;if(this.prep(this.minalign,8+r),4!=t.length)throw new TypeError("FlatBuffers: file identifier must be length 4");for(let e=3;e>=0;e--)this.writeInt8(t.charCodeAt(e))}this.prep(this.minalign,4+r),this.addOffset(t),r&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)}finishSizePrefixed(t,e){this.finish(t,e,!0)}requiredField(t,e){const n=this.bb.capacity()-t,r=n-this.bb.readInt32(n);if(!(e<this.bb.readInt16(r)&&0!=this.bb.readInt16(r+e)))throw new TypeError("FlatBuffers: field "+e+" must be set")}startVector(t,e,n){this.notNested(),this.vector_num_elems=e,this.prep(4,t*e),this.prep(n,t*e)}endVector(){return this.writeInt32(this.vector_num_elems),this.offset()}createSharedString(t){if(!t)return 0;if(this.string_maps||(this.string_maps=new Map),this.string_maps.has(t))return this.string_maps.get(t);const e=this.createString(t);return this.string_maps.set(t,e),e}createString(t){if(null==t)return 0;let e;e=t instanceof Uint8Array?t:this.text_encoder.encode(t),this.addInt8(0),this.startVector(1,e.length,1),this.bb.setPosition(this.space-=e.length);for(let t=0,n=this.space,r=this.bb.bytes();t<e.length;t++)r[n++]=e[t];return this.endVector()}createObjectOffset(t){return null===t?0:"string"==typeof t?this.createString(t):t.pack(this)}createObjectOffsetList(t){const e=[];for(let n=0;n<t.length;++n){const r=t[n];if(null===r)throw new TypeError("FlatBuffers: Argument for createObjectOffsetList cannot contain null.");e.push(this.createObjectOffset(r))}return e}createStructOffsetList(t,e){return e(this,t.length),this.createObjectOffsetList(t.slice().reverse()),this.endVector()}}class lb{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsKeyValue(t,e){return(e||new lb).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsKeyValue(t,e){return t.setPosition(t.position()+4),(e||new lb).__init(t.readInt32(t.position())+t.position(),t)}key(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}value(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startKeyValue(t){t.startObject(2)}static addKey(t,e){t.addFieldOffset(0,e,0)}static addValue(t,e){t.addFieldOffset(1,e,0)}static endKeyValue(t){return t.endObject()}static createKeyValue(t,e,n){return lb.startKeyValue(t),lb.addKey(t,e),lb.addValue(t,n),lb.endKeyValue(t)}}!function(t){t[t.V1=0]="V1",t[t.V2=1]="V2",t[t.V3=2]="V3",t[t.V4=3]="V4",t[t.V5=4]="V5"}(nb||(nb={})),function(t){t[t.Little=0]="Little",t[t.Big=1]="Big"}(rb||(rb={})),function(t){t[t.DenseArray=0]="DenseArray"}(ib||(ib={}));class ub{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInt(t,e){return(e||new ub).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInt(t,e){return t.setPosition(t.position()+4),(e||new ub).__init(t.readInt32(t.position())+t.position(),t)}bitWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}isSigned(){const t=this.bb.__offset(this.bb_pos,6);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}static startInt(t){t.startObject(2)}static addBitWidth(t,e){t.addFieldInt32(0,e,0)}static addIsSigned(t,e){t.addFieldInt8(1,+e,0)}static endInt(t){return t.endObject()}static createInt(t,e,n){return ub.startInt(t),ub.addBitWidth(t,e),ub.addIsSigned(t,n),ub.endInt(t)}}class cb{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryEncoding(t,e){return(e||new cb).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryEncoding(t,e){return t.setPosition(t.position()+4),(e||new cb).__init(t.readInt32(t.position())+t.position(),t)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}indexType(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new ub).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isOrdered(){const t=this.bb.__offset(this.bb_pos,8);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}dictionaryKind(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt16(this.bb_pos+t):ib.DenseArray}static startDictionaryEncoding(t){t.startObject(4)}static addId(t,e){t.addFieldInt64(0,e,BigInt("0"))}static addIndexType(t,e){t.addFieldOffset(1,e,0)}static addIsOrdered(t,e){t.addFieldInt8(2,+e,0)}static addDictionaryKind(t,e){t.addFieldInt16(3,e,ib.DenseArray)}static endDictionaryEncoding(t){return t.endObject()}}!function(t){t[t.NONE=0]="NONE",t[t.Null=1]="Null",t[t.Int=2]="Int",t[t.FloatingPoint=3]="FloatingPoint",t[t.Binary=4]="Binary",t[t.Utf8=5]="Utf8",t[t.Bool=6]="Bool",t[t.Decimal=7]="Decimal",t[t.Date=8]="Date",t[t.Time=9]="Time",t[t.Timestamp=10]="Timestamp",t[t.Interval=11]="Interval",t[t.List=12]="List",t[t.Struct_=13]="Struct_",t[t.Union=14]="Union",t[t.FixedSizeBinary=15]="FixedSizeBinary",t[t.FixedSizeList=16]="FixedSizeList",t[t.Map=17]="Map",t[t.Duration=18]="Duration",t[t.LargeBinary=19]="LargeBinary",t[t.LargeUtf8=20]="LargeUtf8",t[t.LargeList=21]="LargeList",t[t.RunEndEncoded=22]="RunEndEncoded"}(ob||(ob={}));class hb{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsField(t,e){return(e||new hb).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsField(t,e){return t.setPosition(t.position()+4),(e||new hb).__init(t.readInt32(t.position())+t.position(),t)}name(t){const e=this.bb.__offset(this.bb_pos,4);return e?this.bb.__string(this.bb_pos+e,t):null}nullable(){const t=this.bb.__offset(this.bb_pos,6);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}typeType(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readUint8(this.bb_pos+t):ob.NONE}type(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.__union(t,this.bb_pos+e):null}dictionary(t){const e=this.bb.__offset(this.bb_pos,12);return e?(t||new cb).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}children(t,e){const n=this.bb.__offset(this.bb_pos,14);return n?(e||new hb).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}childrenLength(){const t=this.bb.__offset(this.bb_pos,14);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,16);return n?(e||new lb).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,16);return t?this.bb.__vector_len(this.bb_pos+t):0}static startField(t){t.startObject(7)}static addName(t,e){t.addFieldOffset(0,e,0)}static addNullable(t,e){t.addFieldInt8(1,+e,0)}static addTypeType(t,e){t.addFieldInt8(2,e,ob.NONE)}static addType(t,e){t.addFieldOffset(3,e,0)}static addDictionary(t,e){t.addFieldOffset(4,e,0)}static addChildren(t,e){t.addFieldOffset(5,e,0)}static createChildrenVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startChildrenVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(6,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endField(t){return t.endObject()}}class fb{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsSchema(t,e){return(e||new fb).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsSchema(t,e){return t.setPosition(t.position()+4),(e||new fb).__init(t.readInt32(t.position())+t.position(),t)}endianness(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):rb.Little}fields(t,e){const n=this.bb.__offset(this.bb_pos,6);return n?(e||new hb).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}fieldsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new lb).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}features(t){const e=this.bb.__offset(this.bb_pos,10);return e?this.bb.readInt64(this.bb.__vector(this.bb_pos+e)+8*t):BigInt(0)}featuresLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}static startSchema(t){t.startObject(4)}static addEndianness(t,e){t.addFieldInt16(0,e,rb.Little)}static addFields(t,e){t.addFieldOffset(1,e,0)}static createFieldsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startFieldsVector(t,e){t.startVector(4,e,4)}static addCustomMetadata(t,e){t.addFieldOffset(2,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static addFeatures(t,e){t.addFieldOffset(3,e,0)}static createFeaturesVector(t,e){t.startVector(8,e.length,8);for(let n=e.length-1;n>=0;n--)t.addInt64(e[n]);return t.endVector()}static startFeaturesVector(t,e){t.startVector(8,e,8)}static endSchema(t){return t.endObject()}static finishSchemaBuffer(t,e){t.finish(e)}static finishSizePrefixedSchemaBuffer(t,e){t.finish(e,void 0,!0)}static createSchema(t,e,n,r,i){return fb.startSchema(t),fb.addEndianness(t,e),fb.addFields(t,n),fb.addCustomMetadata(t,r),fb.addFeatures(t,i),fb.endSchema(t)}}class db{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFooter(t,e){return(e||new db).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFooter(t,e){return t.setPosition(t.position()+4),(e||new db).__init(t.readInt32(t.position())+t.position(),t)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):nb.V1}schema(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new fb).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}dictionaries(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new Jy).__init(this.bb.__vector(this.bb_pos+n)+24*t,this.bb):null}dictionariesLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}recordBatches(t,e){const n=this.bb.__offset(this.bb_pos,10);return n?(e||new Jy).__init(this.bb.__vector(this.bb_pos+n)+24*t,this.bb):null}recordBatchesLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.__vector_len(this.bb_pos+t):0}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,12);return n?(e||new lb).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startFooter(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,nb.V1)}static addSchema(t,e){t.addFieldOffset(1,e,0)}static addDictionaries(t,e){t.addFieldOffset(2,e,0)}static startDictionariesVector(t,e){t.startVector(24,e,8)}static addRecordBatches(t,e){t.addFieldOffset(3,e,0)}static startRecordBatchesVector(t,e){t.startVector(24,e,8)}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endFooter(t){return t.endObject()}static finishFooterBuffer(t,e){t.finish(e)}static finishSizePrefixedFooterBuffer(t,e){t.finish(e,void 0,!0)}}var pb=ab,mb=sb;class gb{static decode(t){t=new mb(bf(t));const e=db.getRootAsFooter(t),n=Eg.decode(e.schema(),new Map,e.version());return new yb(n,e)}static encode(t){const e=new pb,n=Eg.encode(e,t.schema);db.startRecordBatchesVector(e,t.numRecordBatches);for(const n of[...t.recordBatches()].slice().reverse())bb.encode(e,n);const r=e.endVector();db.startDictionariesVector(e,t.numDictionaries);for(const n of[...t.dictionaryBatches()].slice().reverse())bb.encode(e,n);const i=e.endVector();return db.startFooter(e),db.addSchema(e,n),db.addVersion(e,Ih.V5),db.addRecordBatches(e,r),db.addDictionaries(e,i),db.finishFooterBuffer(e,db.endFooter(e)),e.asUint8Array()}get numRecordBatches(){return this._recordBatches.length}get numDictionaries(){return this._dictionaryBatches.length}constructor(t,e=Ih.V5,n,r){this.schema=t,this.version=e,n&&(this._recordBatches=n),r&&(this._dictionaryBatches=r)}*recordBatches(){for(let t,e=-1,n=this.numRecordBatches;++e<n;)(t=this.getRecordBatch(e))&&(yield t)}*dictionaryBatches(){for(let t,e=-1,n=this.numDictionaries;++e<n;)(t=this.getDictionaryBatch(e))&&(yield t)}getRecordBatch(t){return t>=0&&t<this.numRecordBatches&&this._recordBatches[t]||null}getDictionaryBatch(t){return t>=0&&t<this.numDictionaries&&this._dictionaryBatches[t]||null}}class yb extends gb{get numRecordBatches(){return this._footer.recordBatchesLength()}get numDictionaries(){return this._footer.dictionariesLength()}constructor(t,e){super(t,e.version()),this._footer=e}getRecordBatch(t){if(t>=0&&t<this.numRecordBatches){const e=this._footer.recordBatches(t);if(e)return bb.decode(e)}return null}getDictionaryBatch(t){if(t>=0&&t<this.numDictionaries){const e=this._footer.dictionaries(t);if(e)return bb.decode(e)}return null}}class bb{static decode(t){return new bb(t.metaDataLength(),t.bodyLength(),t.offset())}static encode(t,e){const{metaDataLength:n}=e,r=BigInt(e.offset),i=BigInt(e.bodyLength);return Jy.createBlock(t,r,n,i)}constructor(t,e,n){this.metaDataLength=t,this.offset=If(n),this.bodyLength=If(e)}}const vb={fromIterable:t=>wb(function*(t){let e,n,r,i,o=!1,s=[],a=0;({cmd:r,size:i}=yield null);const l=(u=t,function*(t,e){const n=function*(t){yield t},r="string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof df?n(e):nf(e)?e:n(e);return yield*vf(function*(e){let n=null;do{n=e.next(yield gf(t,n))}while(!n.done)}(r[Symbol.iterator]())),new t}(Uint8Array,u))[Symbol.iterator]();var u;try{do{if(({done:e,value:n}=Number.isNaN(i-a)?l.next():l.next(i-a)),!e&&n.byteLength>0&&(s.push(n),a+=n.byteLength),e||i<=a)do{({cmd:r,size:i}=yield"peek"===r?mf(s,i)[0]:([n,s,a]=mf(s,i),n))}while(i<a)}while(!e)}catch(t){(o=!0)&&"function"==typeof l.throw&&l.throw(t)}finally{!1===o&&"function"==typeof l.return&&l.return(null)}return null}(t)),fromAsyncIterable:t=>wb(function(t){return Wh(this,arguments,(function*(){let e,n,r,i,o=!1,s=[],a=0;({cmd:r,size:i}=yield yield qh(null));const l=(u=t,wf(Uint8Array,u))[Symbol.asyncIterator]();var u;try{do{if(({done:e,value:n}=Number.isNaN(i-a)?yield qh(l.next()):yield qh(l.next(i-a))),!e&&n.byteLength>0&&(s.push(n),a+=n.byteLength),e||i<=a)do{({cmd:r,size:i}=yield yield qh("peek"===r?mf(s,i)[0]:([n,s,a]=mf(s,i),n)))}while(i<a)}while(!e)}catch(t){(o=!0)&&"function"==typeof l.throw&&(yield qh(l.throw(t)))}finally{!1===o&&"function"==typeof l.return&&(yield qh(l.return(new Uint8Array(0))))}return yield qh(null)}))}(t)),fromDOMStream:t=>wb(function(t){return Wh(this,arguments,(function*(){let e,n,r,i=!1,o=!1,s=[],a=0;({cmd:n,size:r}=yield yield qh(null));const l=new xb(t);try{do{if(({done:i,value:e}=Number.isNaN(r-a)?yield qh(l.read()):yield qh(l.read(r-a))),!i&&e.byteLength>0&&(s.push(bf(e)),a+=e.byteLength),i||r<=a)do{({cmd:n,size:r}=yield yield qh("peek"===n?mf(s,r)[0]:([e,s,a]=mf(s,r),e)))}while(r<a)}while(!i)}catch(t){(o=!0)&&(yield qh(l.cancel(t)))}finally{!1===o?yield qh(l.cancel()):t.locked&&l.releaseLock()}return yield qh(null)}))}(t)),fromNodeStream:t=>wb(function(t){return Wh(this,arguments,(function*(){const e=[];let n,r,i,o="error",s=!1,a=null,l=0,u=[];if(({cmd:n,size:r}=yield yield qh(null)),t.isTTY)return yield yield qh(new Uint8Array(0)),yield qh(null);try{e[0]=_b(t,"end"),e[1]=_b(t,"error");do{if(e[2]=_b(t,"readable"),[o,a]=yield qh(Promise.race(e.map((t=>t[2])))),"error"===o)break;if((s="end"===o)||(Number.isFinite(r-l)?(i=bf(t.read(r-l)),i.byteLength<r-l&&(i=bf(t.read()))):i=bf(t.read()),i.byteLength>0&&(u.push(i),l+=i.byteLength)),s||r<=l)do{({cmd:n,size:r}=yield yield qh("peek"===n?mf(u,r)[0]:([i,u,l]=mf(u,r),i)))}while(r<l)}while(!s)}finally{yield qh(function(e,n){return i=u=null,new Promise(((r,i)=>{for(const[n,r]of e)t.off(n,r);try{const e=t.destroy;e&&e.call(t,n),n=void 0}catch(t){n=t||n}finally{null!=n?i(n):r()}}))}(e,"error"===o?a:null))}return yield qh(null)}))}(t)),toDOMStream(t,e){throw new Error('"toDOMStream" not available in this environment')},toNodeStream(t,e){throw new Error('"toNodeStream" not available in this environment')}},wb=t=>(t.next(),t);class xb{constructor(t){this.source=t,this.reader=null,this.reader=this.source.getReader(),this.reader.closed.catch((()=>{}))}get closed(){return this.reader?this.reader.closed.catch((()=>{})):Promise.resolve()}releaseLock(){this.reader&&this.reader.releaseLock(),this.reader=null}cancel(t){return Vh(this,void 0,void 0,(function*(){const{reader:e,source:n}=this;e&&(yield e.cancel(t).catch((()=>{}))),n&&n.locked&&this.releaseLock()}))}read(t){return Vh(this,void 0,void 0,(function*(){if(0===t)return{done:null==this.reader,value:new Uint8Array(0)};const e=yield this.reader.read();return!e.done&&(e.value=bf(e)),e}))}}const _b=(t,e)=>{const n=t=>r([e,t]);let r;return[e,n,new Promise((i=>(r=i)&&t.once(e,n)))]},kb=Object.freeze({done:!0,value:void 0});class Sb{constructor(t){this._json=t}get schema(){return this._json.schema}get batches(){return this._json.batches||[]}get dictionaries(){return this._json.dictionaries||[]}}class Eb{tee(){return this._getDOMStream().tee()}pipe(t,e){return this._getNodeStream().pipe(t,e)}pipeTo(t,e){return this._getDOMStream().pipeTo(t,e)}pipeThrough(t,e){return this._getDOMStream().pipeThrough(t,e)}_getDOMStream(){return this._DOMStream||(this._DOMStream=this.toDOMStream())}_getNodeStream(){return this._nodeStream||(this._nodeStream=this.toNodeStream())}}class Ab extends Eb{constructor(){super(),this._values=[],this.resolvers=[],this._closedPromise=new Promise((t=>this._closedPromiseResolve=t))}get closed(){return this._closedPromise}cancel(t){return Vh(this,void 0,void 0,(function*(){yield this.return(t)}))}write(t){this._ensureOpen()&&(this.resolvers.length<=0?this._values.push(t):this.resolvers.shift().resolve({done:!1,value:t}))}abort(t){this._closedPromiseResolve&&(this.resolvers.length<=0?this._error={error:t}:this.resolvers.shift().reject({done:!0,value:t}))}close(){if(this._closedPromiseResolve){const{resolvers:t}=this;for(;t.length>0;)t.shift().resolve(kb);this._closedPromiseResolve(),this._closedPromiseResolve=void 0}}[Symbol.asyncIterator](){return this}toDOMStream(t){return vb.toDOMStream(this._closedPromiseResolve||this._error?this:this._values,t)}toNodeStream(t){return vb.toNodeStream(this._closedPromiseResolve||this._error?this:this._values,t)}throw(t){return Vh(this,void 0,void 0,(function*(){return yield this.abort(t),kb}))}return(t){return Vh(this,void 0,void 0,(function*(){return yield this.close(),kb}))}read(t){return Vh(this,void 0,void 0,(function*(){return(yield this.next(t,"read")).value}))}peek(t){return Vh(this,void 0,void 0,(function*(){return(yield this.next(t,"peek")).value}))}next(...t){return this._values.length>0?Promise.resolve({done:!1,value:this._values.shift()}):this._error?Promise.reject({done:!0,value:this._error.error}):this._closedPromiseResolve?new Promise(((t,e)=>{this.resolvers.push({resolve:t,reject:e})})):Promise.resolve(kb)}_ensureOpen(){if(this._closedPromiseResolve)return!0;throw new Error("AsyncQueue is closed")}}class Cb extends Ab{write(t){if((t=bf(t)).byteLength>0)return super.write(t)}toString(t=!1){return t?Xh(this.toUint8Array(!0)):this.toUint8Array(!1).then(Xh)}toUint8Array(t=!1){return t?mf(this._values)[0]:(()=>Vh(this,void 0,void 0,(function*(){var t,e,n,r;const i=[];let o=0;try{for(var s,a=!0,l=Gh(this);!(t=(s=yield l.next()).done);a=!0){r=s.value,a=!1;const t=r;i.push(t),o+=t.byteLength}}catch(t){e={error:t}}finally{try{a||t||!(n=l.return)||(yield n.call(l))}finally{if(e)throw e.error}}return mf(i,o)[0]})))()}}class Db{constructor(t){t&&(this.source=new Ob(vb.fromIterable(t)))}[Symbol.iterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class Mb{constructor(t){t instanceof Mb?this.source=t.source:t instanceof Cb?this.source=new Tb(vb.fromAsyncIterable(t)):hf(t)?this.source=new Tb(vb.fromNodeStream(t)):cf(t)?this.source=new Tb(vb.fromDOMStream(t)):lf(t)?this.source=new Tb(vb.fromDOMStream(t.body)):nf(t)?this.source=new Tb(vb.fromIterable(t)):(ef(t)||rf(t))&&(this.source=new Tb(vb.fromAsyncIterable(t)))}[Symbol.asyncIterator](){return this}next(t){return this.source.next(t)}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}get closed(){return this.source.closed}cancel(t){return this.source.cancel(t)}peek(t){return this.source.peek(t)}read(t){return this.source.read(t)}}class Ob{constructor(t){this.source=t}cancel(t){this.return(t)}peek(t){return this.next(t,"peek").value}read(t){return this.next(t,"read").value}next(t,e="read"){return this.source.next({cmd:e,size:t})}throw(t){return Object.create(this.source.throw&&this.source.throw(t)||kb)}return(t){return Object.create(this.source.return&&this.source.return(t)||kb)}}class Tb{constructor(t){this.source=t,this._closedPromise=new Promise((t=>this._closedPromiseResolve=t))}cancel(t){return Vh(this,void 0,void 0,(function*(){yield this.return(t)}))}get closed(){return this._closedPromise}read(t){return Vh(this,void 0,void 0,(function*(){return(yield this.next(t,"read")).value}))}peek(t){return Vh(this,void 0,void 0,(function*(){return(yield this.next(t,"peek")).value}))}next(t,e="read"){return Vh(this,void 0,void 0,(function*(){return yield this.source.next({cmd:e,size:t})}))}throw(t){return Vh(this,void 0,void 0,(function*(){const e=this.source.throw&&(yield this.source.throw(t))||kb;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)}))}return(t){return Vh(this,void 0,void 0,(function*(){const e=this.source.return&&(yield this.source.return(t))||kb;return this._closedPromiseResolve&&this._closedPromiseResolve(),this._closedPromiseResolve=void 0,Object.create(e)}))}}class Ib extends Db{constructor(t,e){super(),this.position=0,this.buffer=bf(t),this.size=void 0===e?this.buffer.byteLength:e}readInt32(t){const{buffer:e,byteOffset:n}=this.readAt(t,4);return new DataView(e,n).getInt32(0,!0)}seek(t){return this.position=Math.min(t,this.size),t<this.size}read(t){const{buffer:e,size:n,position:r}=this;return e&&r<n?("number"!=typeof t&&(t=Number.POSITIVE_INFINITY),this.position=Math.min(n,r+Math.min(n-r,t)),e.subarray(r,this.position)):null}readAt(t,e){const n=this.buffer,r=Math.min(this.size,t+e);return n?n.subarray(t,r):new Uint8Array(e)}close(){this.buffer&&(this.buffer=null)}throw(t){return this.close(),{done:!0,value:t}}return(t){return this.close(),{done:!0,value:t}}}class Nb extends Mb{constructor(t,e){super(),this.position=0,this._handle=t,"number"==typeof e?this.size=e:this._pending=(()=>Vh(this,void 0,void 0,(function*(){this.size=(yield t.stat()).size,delete this._pending})))()}readInt32(t){return Vh(this,void 0,void 0,(function*(){const{buffer:e,byteOffset:n}=yield this.readAt(t,4);return new DataView(e,n).getInt32(0,!0)}))}seek(t){return Vh(this,void 0,void 0,(function*(){return this._pending&&(yield this._pending),this.position=Math.min(t,this.size),t<this.size}))}read(t){return Vh(this,void 0,void 0,(function*(){this._pending&&(yield this._pending);const{_handle:e,size:n,position:r}=this;if(e&&r<n){"number"!=typeof t&&(t=Number.POSITIVE_INFINITY);let i=r,o=0,s=0;const a=Math.min(n,i+Math.min(n-i,t)),l=new Uint8Array(Math.max(0,(this.position=a)-i));for(;(i+=s)<a&&(o+=s)<l.byteLength;)({bytesRead:s}=yield e.read(l,o,l.byteLength-o,i));return l}return null}))}readAt(t,e){return Vh(this,void 0,void 0,(function*(){this._pending&&(yield this._pending);const{_handle:n,size:r}=this;if(n&&t+e<r){const i=Math.min(r,t+e),o=new Uint8Array(i-t);return(yield n.read(o,0,e,t)).buffer}return new Uint8Array(e)}))}close(){return Vh(this,void 0,void 0,(function*(){const t=this._handle;this._handle=null,t&&(yield t.close())}))}throw(t){return Vh(this,void 0,void 0,(function*(){return yield this.close(),{done:!0,value:t}}))}return(t){return Vh(this,void 0,void 0,(function*(){return yield this.close(),{done:!0,value:t}}))}}function $b(t){return t<0&&(t=4294967295+t+1),`0x${t.toString(16)}`}const Fb=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8];class Lb{constructor(t){this.buffer=t}high(){return this.buffer[1]}low(){return this.buffer[0]}_times(t){const e=new Uint32Array([this.buffer[1]>>>16,65535&this.buffer[1],this.buffer[0]>>>16,65535&this.buffer[0]]),n=new Uint32Array([t.buffer[1]>>>16,65535&t.buffer[1],t.buffer[0]>>>16,65535&t.buffer[0]]);let r=e[3]*n[3];this.buffer[0]=65535&r;let i=r>>>16;return r=e[2]*n[3],i+=r,r=e[3]*n[2]>>>0,i+=r,this.buffer[0]+=i<<16,this.buffer[1]=i>>>0<r?65536:0,this.buffer[1]+=i>>>16,this.buffer[1]+=e[1]*n[3]+e[2]*n[2]+e[3]*n[1],this.buffer[1]+=e[0]*n[3]+e[1]*n[2]+e[2]*n[1]+e[3]*n[0]<<16,this}_plus(t){const e=this.buffer[0]+t.buffer[0]>>>0;this.buffer[1]+=t.buffer[1],e<this.buffer[0]>>>0&&++this.buffer[1],this.buffer[0]=e}lessThan(t){return this.buffer[1]<t.buffer[1]||this.buffer[1]===t.buffer[1]&&this.buffer[0]<t.buffer[0]}equals(t){return this.buffer[1]===t.buffer[1]&&this.buffer[0]==t.buffer[0]}greaterThan(t){return t.lessThan(this)}hex(){return`${$b(this.buffer[1])} ${$b(this.buffer[0])}`}}class Bb extends Lb{times(t){return this._times(t),this}plus(t){return this._plus(t),this}static from(t,e=new Uint32Array(2)){return Bb.fromString("string"==typeof t?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(2)){return Bb.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(2)){const n=t.length,r=new Bb(e);for(let e=0;e<n;){const i=8<n-e?8:n-e,o=new Bb(new Uint32Array([Number.parseInt(t.slice(e,e+i),10),0])),s=new Bb(new Uint32Array([Fb[i],0]));r.times(s),r.plus(o),e+=i}return r}static convertArray(t){const e=new Uint32Array(2*t.length);for(let n=-1,r=t.length;++n<r;)Bb.from(t[n],new Uint32Array(e.buffer,e.byteOffset+2*n*4,2));return e}static multiply(t,e){return new Bb(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new Bb(new Uint32Array(t.buffer)).plus(e)}}class Rb extends Lb{negate(){return this.buffer[0]=1+~this.buffer[0],this.buffer[1]=~this.buffer[1],0==this.buffer[0]&&++this.buffer[1],this}times(t){return this._times(t),this}plus(t){return this._plus(t),this}lessThan(t){const e=0|this.buffer[1],n=0|t.buffer[1];return e<n||e===n&&this.buffer[0]<t.buffer[0]}static from(t,e=new Uint32Array(2)){return Rb.fromString("string"==typeof t?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(2)){return Rb.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(2)){const n=t.startsWith("-"),r=t.length,i=new Rb(e);for(let e=n?1:0;e<r;){const n=8<r-e?8:r-e,o=new Rb(new Uint32Array([Number.parseInt(t.slice(e,e+n),10),0])),s=new Rb(new Uint32Array([Fb[n],0]));i.times(s),i.plus(o),e+=n}return n?i.negate():i}static convertArray(t){const e=new Uint32Array(2*t.length);for(let n=-1,r=t.length;++n<r;)Rb.from(t[n],new Uint32Array(e.buffer,e.byteOffset+2*n*4,2));return e}static multiply(t,e){return new Rb(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new Rb(new Uint32Array(t.buffer)).plus(e)}}class Pb{constructor(t){this.buffer=t}high(){return new Rb(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2))}low(){return new Rb(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset,2))}negate(){return this.buffer[0]=1+~this.buffer[0],this.buffer[1]=~this.buffer[1],this.buffer[2]=~this.buffer[2],this.buffer[3]=~this.buffer[3],0==this.buffer[0]&&++this.buffer[1],0==this.buffer[1]&&++this.buffer[2],0==this.buffer[2]&&++this.buffer[3],this}times(t){const e=new Bb(new Uint32Array([this.buffer[3],0])),n=new Bb(new Uint32Array([this.buffer[2],0])),r=new Bb(new Uint32Array([this.buffer[1],0])),i=new Bb(new Uint32Array([this.buffer[0],0])),o=new Bb(new Uint32Array([t.buffer[3],0])),s=new Bb(new Uint32Array([t.buffer[2],0])),a=new Bb(new Uint32Array([t.buffer[1],0])),l=new Bb(new Uint32Array([t.buffer[0],0]));let u=Bb.multiply(i,l);this.buffer[0]=u.low();const c=new Bb(new Uint32Array([u.high(),0]));return u=Bb.multiply(r,l),c.plus(u),u=Bb.multiply(i,a),c.plus(u),this.buffer[1]=c.low(),this.buffer[3]=c.lessThan(u)?1:0,this.buffer[2]=c.high(),new Bb(new Uint32Array(this.buffer.buffer,this.buffer.byteOffset+8,2)).plus(Bb.multiply(n,l)).plus(Bb.multiply(r,a)).plus(Bb.multiply(i,s)),this.buffer[3]+=Bb.multiply(e,l).plus(Bb.multiply(n,a)).plus(Bb.multiply(r,s)).plus(Bb.multiply(i,o)).low(),this}plus(t){const e=new Uint32Array(4);return e[3]=this.buffer[3]+t.buffer[3]>>>0,e[2]=this.buffer[2]+t.buffer[2]>>>0,e[1]=this.buffer[1]+t.buffer[1]>>>0,e[0]=this.buffer[0]+t.buffer[0]>>>0,e[0]<this.buffer[0]>>>0&&++e[1],e[1]<this.buffer[1]>>>0&&++e[2],e[2]<this.buffer[2]>>>0&&++e[3],this.buffer[3]=e[3],this.buffer[2]=e[2],this.buffer[1]=e[1],this.buffer[0]=e[0],this}hex(){return`${$b(this.buffer[3])} ${$b(this.buffer[2])} ${$b(this.buffer[1])} ${$b(this.buffer[0])}`}static multiply(t,e){return new Pb(new Uint32Array(t.buffer)).times(e)}static add(t,e){return new Pb(new Uint32Array(t.buffer)).plus(e)}static from(t,e=new Uint32Array(4)){return Pb.fromString("string"==typeof t?t:t.toString(),e)}static fromNumber(t,e=new Uint32Array(4)){return Pb.fromString(t.toString(),e)}static fromString(t,e=new Uint32Array(4)){const n=t.startsWith("-"),r=t.length,i=new Pb(e);for(let e=n?1:0;e<r;){const n=8<r-e?8:r-e,o=new Pb(new Uint32Array([Number.parseInt(t.slice(e,e+n),10),0,0,0])),s=new Pb(new Uint32Array([Fb[n],0,0,0]));i.times(s),i.plus(o),e+=n}return n?i.negate():i}static convertArray(t){const e=new Uint32Array(4*t.length);for(let n=-1,r=t.length;++n<r;)Pb.from(t[n],new Uint32Array(e.buffer,e.byteOffset+16*n,4));return e}}class zb extends Ud{constructor(t,e,n,r,i=Ih.V5){super(),this.nodesIndex=-1,this.buffersIndex=-1,this.bytes=t,this.nodes=e,this.buffers=n,this.dictionaries=r,this.metadataVersion=i}visit(t){return super.visit(t instanceof Ag?t.type:t)}visitNull(t,{length:e}=this.nextFieldNode()){return Zm({type:t,length:e})}visitBool(t,{length:e,nullCount:n}=this.nextFieldNode()){return Zm({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitInt(t,{length:e,nullCount:n}=this.nextFieldNode()){return Zm({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitFloat(t,{length:e,nullCount:n}=this.nextFieldNode()){return Zm({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitUtf8(t,{length:e,nullCount:n}=this.nextFieldNode()){return Zm({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitBinary(t,{length:e,nullCount:n}=this.nextFieldNode()){return Zm({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),data:this.readData(t)})}visitFixedSizeBinary(t,{length:e,nullCount:n}=this.nextFieldNode()){return Zm({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitDate(t,{length:e,nullCount:n}=this.nextFieldNode()){return Zm({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitTimestamp(t,{length:e,nullCount:n}=this.nextFieldNode()){return Zm({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitTime(t,{length:e,nullCount:n}=this.nextFieldNode()){return Zm({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitDecimal(t,{length:e,nullCount:n}=this.nextFieldNode()){return Zm({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitList(t,{length:e,nullCount:n}=this.nextFieldNode()){return Zm({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}visitStruct(t,{length:e,nullCount:n}=this.nextFieldNode()){return Zm({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),children:this.visitMany(t.children)})}visitUnion(t,{length:e,nullCount:n}=this.nextFieldNode()){return this.metadataVersion<Ih.V5&&this.readNullBitmap(t,n),t.mode===Nh.Sparse?this.visitSparseUnion(t,{length:e,nullCount:n}):this.visitDenseUnion(t,{length:e,nullCount:n})}visitDenseUnion(t,{length:e,nullCount:n}=this.nextFieldNode()){return Zm({type:t,length:e,nullCount:n,typeIds:this.readTypeIds(t),valueOffsets:this.readOffsets(t),children:this.visitMany(t.children)})}visitSparseUnion(t,{length:e,nullCount:n}=this.nextFieldNode()){return Zm({type:t,length:e,nullCount:n,typeIds:this.readTypeIds(t),children:this.visitMany(t.children)})}visitDictionary(t,{length:e,nullCount:n}=this.nextFieldNode()){return Zm({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t.indices),dictionary:this.readDictionary(t)})}visitInterval(t,{length:e,nullCount:n}=this.nextFieldNode()){return Zm({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitDuration(t,{length:e,nullCount:n}=this.nextFieldNode()){return Zm({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),data:this.readData(t)})}visitFixedSizeList(t,{length:e,nullCount:n}=this.nextFieldNode()){return Zm({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),child:this.visit(t.children[0])})}visitMap(t,{length:e,nullCount:n}=this.nextFieldNode()){return Zm({type:t,length:e,nullCount:n,nullBitmap:this.readNullBitmap(t,n),valueOffsets:this.readOffsets(t),child:this.visit(t.children[0])})}nextFieldNode(){return this.nodes[++this.nodesIndex]}nextBufferRange(){return this.buffers[++this.buffersIndex]}readNullBitmap(t,e,n=this.nextBufferRange()){return e>0&&this.readData(t,n)||new Uint8Array(0)}readOffsets(t,e){return this.readData(t,e)}readTypeIds(t,e){return this.readData(t,e)}readData(t,{length:e,offset:n}=this.nextBufferRange()){return this.bytes.subarray(n,n+e)}readDictionary(t){return this.dictionaries.get(t.id)}}class jb extends zb{constructor(t,e,n,r,i){super(new Uint8Array(0),e,n,r,i),this.sources=t}readNullBitmap(t,e,{offset:n}=this.nextBufferRange()){return e<=0?new Uint8Array(0):Dm(this.sources[n])}readOffsets(t,{offset:e}=this.nextBufferRange()){return gf(Uint8Array,gf(Int32Array,this.sources[e]))}readTypeIds(t,{offset:e}=this.nextBufferRange()){return gf(Uint8Array,gf(t.ArrayType,this.sources[e]))}readData(t,{offset:e}=this.nextBufferRange()){const{sources:n}=this;return td.isTimestamp(t)||(td.isInt(t)||td.isTime(t))&&64===t.bitWidth||td.isDuration(t)||td.isDate(t)&&t.unit===Fh.MILLISECOND?gf(Uint8Array,Rb.convertArray(n[e])):td.isDecimal(t)?gf(Uint8Array,Pb.convertArray(n[e])):td.isBinary(t)||td.isFixedSizeBinary(t)?function(t){const e=t.join(""),n=new Uint8Array(e.length/2);for(let t=0;t<e.length;t+=2)n[t>>1]=Number.parseInt(e.slice(t,t+2),16);return n}(n[e]):td.isBool(t)?Dm(n[e]):td.isUtf8(t)?Kh(n[e].join("")):gf(Uint8Array,gf(t.ArrayType,n[e].map((t=>+t))))}}var Ub,Vb,qb,Wb,Hb,Gb,Yb,Xb;!function(t){t[t.BUFFER=0]="BUFFER"}(Ub||(Ub={})),function(t){t[t.LZ4_FRAME=0]="LZ4_FRAME",t[t.ZSTD=1]="ZSTD"}(Vb||(Vb={}));class Jb{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBodyCompression(t,e){return(e||new Jb).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBodyCompression(t,e){return t.setPosition(t.position()+4),(e||new Jb).__init(t.readInt32(t.position())+t.position(),t)}codec(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt8(this.bb_pos+t):Vb.LZ4_FRAME}method(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt8(this.bb_pos+t):Ub.BUFFER}static startBodyCompression(t){t.startObject(2)}static addCodec(t,e){t.addFieldInt8(0,e,Vb.LZ4_FRAME)}static addMethod(t,e){t.addFieldInt8(1,e,Ub.BUFFER)}static endBodyCompression(t){return t.endObject()}static createBodyCompression(t,e,n){return Jb.startBodyCompression(t),Jb.addCodec(t,e),Jb.addMethod(t,n),Jb.endBodyCompression(t)}}class Kb{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}offset(){return this.bb.readInt64(this.bb_pos)}length(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createBuffer(t,e,n){return t.prep(8,16),t.writeInt64(BigInt(null!=n?n:0)),t.writeInt64(BigInt(null!=e?e:0)),t.offset()}}class Qb{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}length(){return this.bb.readInt64(this.bb_pos)}nullCount(){return this.bb.readInt64(this.bb_pos+8)}static sizeOf(){return 16}static createFieldNode(t,e,n){return t.prep(8,16),t.writeInt64(BigInt(null!=n?n:0)),t.writeInt64(BigInt(null!=e?e:0)),t.offset()}}class Zb{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsRecordBatch(t,e){return(e||new Zb).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsRecordBatch(t,e){return t.setPosition(t.position()+4),(e||new Zb).__init(t.readInt32(t.position())+t.position(),t)}length(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}nodes(t,e){const n=this.bb.__offset(this.bb_pos,6);return n?(e||new Qb).__init(this.bb.__vector(this.bb_pos+n)+16*t,this.bb):null}nodesLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}buffers(t,e){const n=this.bb.__offset(this.bb_pos,8);return n?(e||new Kb).__init(this.bb.__vector(this.bb_pos+n)+16*t,this.bb):null}buffersLength(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.__vector_len(this.bb_pos+t):0}compression(t){const e=this.bb.__offset(this.bb_pos,10);return e?(t||new Jb).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}static startRecordBatch(t){t.startObject(4)}static addLength(t,e){t.addFieldInt64(0,e,BigInt("0"))}static addNodes(t,e){t.addFieldOffset(1,e,0)}static startNodesVector(t,e){t.startVector(16,e,8)}static addBuffers(t,e){t.addFieldOffset(2,e,0)}static startBuffersVector(t,e){t.startVector(16,e,8)}static addCompression(t,e){t.addFieldOffset(3,e,0)}static endRecordBatch(t){return t.endObject()}}class tv{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDictionaryBatch(t,e){return(e||new tv).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDictionaryBatch(t,e){return t.setPosition(t.position()+4),(e||new tv).__init(t.readInt32(t.position())+t.position(),t)}id(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}data(t){const e=this.bb.__offset(this.bb_pos,6);return e?(t||new Zb).__init(this.bb.__indirect(this.bb_pos+e),this.bb):null}isDelta(){const t=this.bb.__offset(this.bb_pos,8);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}static startDictionaryBatch(t){t.startObject(3)}static addId(t,e){t.addFieldInt64(0,e,BigInt("0"))}static addData(t,e){t.addFieldOffset(1,e,0)}static addIsDelta(t,e){t.addFieldInt8(2,+e,0)}static endDictionaryBatch(t){return t.endObject()}}!function(t){t[t.HALF=0]="HALF",t[t.SINGLE=1]="SINGLE",t[t.DOUBLE=2]="DOUBLE"}(qb||(qb={}));class ev{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFloatingPoint(t,e){return(e||new ev).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFloatingPoint(t,e){return t.setPosition(t.position()+4),(e||new ev).__init(t.readInt32(t.position())+t.position(),t)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):qb.HALF}static startFloatingPoint(t){t.startObject(1)}static addPrecision(t,e){t.addFieldInt16(0,e,qb.HALF)}static endFloatingPoint(t){return t.endObject()}static createFloatingPoint(t,e){return ev.startFloatingPoint(t),ev.addPrecision(t,e),ev.endFloatingPoint(t)}}class nv{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDecimal(t,e){return(e||new nv).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDecimal(t,e){return t.setPosition(t.position()+4),(e||new nv).__init(t.readInt32(t.position())+t.position(),t)}precision(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}scale(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):0}bitWidth(){const t=this.bb.__offset(this.bb_pos,8);return t?this.bb.readInt32(this.bb_pos+t):128}static startDecimal(t){t.startObject(3)}static addPrecision(t,e){t.addFieldInt32(0,e,0)}static addScale(t,e){t.addFieldInt32(1,e,0)}static addBitWidth(t,e){t.addFieldInt32(2,e,128)}static endDecimal(t){return t.endObject()}static createDecimal(t,e,n,r){return nv.startDecimal(t),nv.addPrecision(t,e),nv.addScale(t,n),nv.addBitWidth(t,r),nv.endDecimal(t)}}!function(t){t[t.DAY=0]="DAY",t[t.MILLISECOND=1]="MILLISECOND"}(Wb||(Wb={}));class rv{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDate(t,e){return(e||new rv).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDate(t,e){return t.setPosition(t.position()+4),(e||new rv).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Wb.MILLISECOND}static startDate(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,Wb.MILLISECOND)}static endDate(t){return t.endObject()}static createDate(t,e){return rv.startDate(t),rv.addUnit(t,e),rv.endDate(t)}}!function(t){t[t.SECOND=0]="SECOND",t[t.MILLISECOND=1]="MILLISECOND",t[t.MICROSECOND=2]="MICROSECOND",t[t.NANOSECOND=3]="NANOSECOND"}(Hb||(Hb={}));class iv{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTime(t,e){return(e||new iv).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTime(t,e){return t.setPosition(t.position()+4),(e||new iv).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Hb.MILLISECOND}bitWidth(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readInt32(this.bb_pos+t):32}static startTime(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,Hb.MILLISECOND)}static addBitWidth(t,e){t.addFieldInt32(1,e,32)}static endTime(t){return t.endObject()}static createTime(t,e,n){return iv.startTime(t),iv.addUnit(t,e),iv.addBitWidth(t,n),iv.endTime(t)}}class ov{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsTimestamp(t,e){return(e||new ov).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsTimestamp(t,e){return t.setPosition(t.position()+4),(e||new ov).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Hb.SECOND}timezone(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.__string(this.bb_pos+e,t):null}static startTimestamp(t){t.startObject(2)}static addUnit(t,e){t.addFieldInt16(0,e,Hb.SECOND)}static addTimezone(t,e){t.addFieldOffset(1,e,0)}static endTimestamp(t){return t.endObject()}static createTimestamp(t,e,n){return ov.startTimestamp(t),ov.addUnit(t,e),ov.addTimezone(t,n),ov.endTimestamp(t)}}!function(t){t[t.YEAR_MONTH=0]="YEAR_MONTH",t[t.DAY_TIME=1]="DAY_TIME",t[t.MONTH_DAY_NANO=2]="MONTH_DAY_NANO"}(Gb||(Gb={}));class sv{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsInterval(t,e){return(e||new sv).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsInterval(t,e){return t.setPosition(t.position()+4),(e||new sv).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Gb.YEAR_MONTH}static startInterval(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,Gb.YEAR_MONTH)}static endInterval(t){return t.endObject()}static createInterval(t,e){return sv.startInterval(t),sv.addUnit(t,e),sv.endInterval(t)}}class av{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsDuration(t,e){return(e||new av).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsDuration(t,e){return t.setPosition(t.position()+4),(e||new av).__init(t.readInt32(t.position())+t.position(),t)}unit(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Hb.MILLISECOND}static startDuration(t){t.startObject(1)}static addUnit(t,e){t.addFieldInt16(0,e,Hb.MILLISECOND)}static endDuration(t){return t.endObject()}static createDuration(t,e){return av.startDuration(t),av.addUnit(t,e),av.endDuration(t)}}!function(t){t[t.Sparse=0]="Sparse",t[t.Dense=1]="Dense"}(Yb||(Yb={}));class lv{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUnion(t,e){return(e||new lv).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUnion(t,e){return t.setPosition(t.position()+4),(e||new lv).__init(t.readInt32(t.position())+t.position(),t)}mode(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):Yb.Sparse}typeIds(t){const e=this.bb.__offset(this.bb_pos,6);return e?this.bb.readInt32(this.bb.__vector(this.bb_pos+e)+4*t):0}typeIdsLength(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.__vector_len(this.bb_pos+t):0}typeIdsArray(){const t=this.bb.__offset(this.bb_pos,6);return t?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+t),this.bb.__vector_len(this.bb_pos+t)):null}static startUnion(t){t.startObject(2)}static addMode(t,e){t.addFieldInt16(0,e,Yb.Sparse)}static addTypeIds(t,e){t.addFieldOffset(1,e,0)}static createTypeIdsVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addInt32(e[n]);return t.endVector()}static startTypeIdsVector(t,e){t.startVector(4,e,4)}static endUnion(t){return t.endObject()}static createUnion(t,e,n){return lv.startUnion(t),lv.addMode(t,e),lv.addTypeIds(t,n),lv.endUnion(t)}}class uv{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeBinary(t,e){return(e||new uv).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeBinary(t,e){return t.setPosition(t.position()+4),(e||new uv).__init(t.readInt32(t.position())+t.position(),t)}byteWidth(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeBinary(t){t.startObject(1)}static addByteWidth(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeBinary(t){return t.endObject()}static createFixedSizeBinary(t,e){return uv.startFixedSizeBinary(t),uv.addByteWidth(t,e),uv.endFixedSizeBinary(t)}}class cv{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsFixedSizeList(t,e){return(e||new cv).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsFixedSizeList(t,e){return t.setPosition(t.position()+4),(e||new cv).__init(t.readInt32(t.position())+t.position(),t)}listSize(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt32(this.bb_pos+t):0}static startFixedSizeList(t){t.startObject(1)}static addListSize(t,e){t.addFieldInt32(0,e,0)}static endFixedSizeList(t){return t.endObject()}static createFixedSizeList(t,e){return cv.startFixedSizeList(t),cv.addListSize(t,e),cv.endFixedSizeList(t)}}class hv{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMap(t,e){return(e||new hv).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMap(t,e){return t.setPosition(t.position()+4),(e||new hv).__init(t.readInt32(t.position())+t.position(),t)}keysSorted(){const t=this.bb.__offset(this.bb_pos,4);return!!t&&!!this.bb.readInt8(this.bb_pos+t)}static startMap(t){t.startObject(1)}static addKeysSorted(t,e){t.addFieldInt8(0,+e,0)}static endMap(t){return t.endObject()}static createMap(t,e){return hv.startMap(t),hv.addKeysSorted(t,e),hv.endMap(t)}}!function(t){t[t.NONE=0]="NONE",t[t.Schema=1]="Schema",t[t.DictionaryBatch=2]="DictionaryBatch",t[t.RecordBatch=3]="RecordBatch",t[t.Tensor=4]="Tensor",t[t.SparseTensor=5]="SparseTensor"}(Xb||(Xb={}));class fv{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsMessage(t,e){return(e||new fv).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsMessage(t,e){return t.setPosition(t.position()+4),(e||new fv).__init(t.readInt32(t.position())+t.position(),t)}version(){const t=this.bb.__offset(this.bb_pos,4);return t?this.bb.readInt16(this.bb_pos+t):nb.V1}headerType(){const t=this.bb.__offset(this.bb_pos,6);return t?this.bb.readUint8(this.bb_pos+t):Xb.NONE}header(t){const e=this.bb.__offset(this.bb_pos,8);return e?this.bb.__union(t,this.bb_pos+e):null}bodyLength(){const t=this.bb.__offset(this.bb_pos,10);return t?this.bb.readInt64(this.bb_pos+t):BigInt("0")}customMetadata(t,e){const n=this.bb.__offset(this.bb_pos,12);return n?(e||new lb).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+n)+4*t),this.bb):null}customMetadataLength(){const t=this.bb.__offset(this.bb_pos,12);return t?this.bb.__vector_len(this.bb_pos+t):0}static startMessage(t){t.startObject(5)}static addVersion(t,e){t.addFieldInt16(0,e,nb.V1)}static addHeaderType(t,e){t.addFieldInt8(1,e,Xb.NONE)}static addHeader(t,e){t.addFieldOffset(2,e,0)}static addBodyLength(t,e){t.addFieldInt64(3,e,BigInt("0"))}static addCustomMetadata(t,e){t.addFieldOffset(4,e,0)}static createCustomMetadataVector(t,e){t.startVector(4,e.length,4);for(let n=e.length-1;n>=0;n--)t.addOffset(e[n]);return t.endVector()}static startCustomMetadataVector(t,e){t.startVector(4,e,4)}static endMessage(t){return t.endObject()}static finishMessageBuffer(t,e){t.finish(e)}static finishSizePrefixedMessageBuffer(t,e){t.finish(e,void 0,!0)}static createMessage(t,e,n,r,i,o){return fv.startMessage(t),fv.addVersion(t,e),fv.addHeaderType(t,n),fv.addHeader(t,r),fv.addBodyLength(t,i),fv.addCustomMetadata(t,o),fv.endMessage(t)}}class dv{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsNull(t,e){return(e||new dv).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsNull(t,e){return t.setPosition(t.position()+4),(e||new dv).__init(t.readInt32(t.position())+t.position(),t)}static startNull(t){t.startObject(0)}static endNull(t){return t.endObject()}static createNull(t){return dv.startNull(t),dv.endNull(t)}}class pv{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBinary(t,e){return(e||new pv).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBinary(t,e){return t.setPosition(t.position()+4),(e||new pv).__init(t.readInt32(t.position())+t.position(),t)}static startBinary(t){t.startObject(0)}static endBinary(t){return t.endObject()}static createBinary(t){return pv.startBinary(t),pv.endBinary(t)}}class mv{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsBool(t,e){return(e||new mv).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsBool(t,e){return t.setPosition(t.position()+4),(e||new mv).__init(t.readInt32(t.position())+t.position(),t)}static startBool(t){t.startObject(0)}static endBool(t){return t.endObject()}static createBool(t){return mv.startBool(t),mv.endBool(t)}}class gv{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsUtf8(t,e){return(e||new gv).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsUtf8(t,e){return t.setPosition(t.position()+4),(e||new gv).__init(t.readInt32(t.position())+t.position(),t)}static startUtf8(t){t.startObject(0)}static endUtf8(t){return t.endObject()}static createUtf8(t){return gv.startUtf8(t),gv.endUtf8(t)}}class yv{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsList(t,e){return(e||new yv).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsList(t,e){return t.setPosition(t.position()+4),(e||new yv).__init(t.readInt32(t.position())+t.position(),t)}static startList(t){t.startObject(0)}static endList(t){return t.endObject()}static createList(t){return yv.startList(t),yv.endList(t)}}class bv{constructor(){this.bb=null,this.bb_pos=0}__init(t,e){return this.bb_pos=t,this.bb=e,this}static getRootAsStruct_(t,e){return(e||new bv).__init(t.readInt32(t.position())+t.position(),t)}static getSizePrefixedRootAsStruct_(t,e){return t.setPosition(t.position()+4),(e||new bv).__init(t.readInt32(t.position())+t.position(),t)}static startStruct_(t){t.startObject(0)}static endStruct_(t){return t.endObject()}static createStruct_(t){return bv.startStruct_(t),bv.endStruct_(t)}}const vv=new class extends Ud{visit(t,e){return null==t||null==e?void 0:super.visit(t,e)}visitNull(t,e){return dv.startNull(e),dv.endNull(e)}visitInt(t,e){return ub.startInt(e),ub.addBitWidth(e,t.bitWidth),ub.addIsSigned(e,t.isSigned),ub.endInt(e)}visitFloat(t,e){return ev.startFloatingPoint(e),ev.addPrecision(e,t.precision),ev.endFloatingPoint(e)}visitBinary(t,e){return pv.startBinary(e),pv.endBinary(e)}visitBool(t,e){return mv.startBool(e),mv.endBool(e)}visitUtf8(t,e){return gv.startUtf8(e),gv.endUtf8(e)}visitDecimal(t,e){return nv.startDecimal(e),nv.addScale(e,t.scale),nv.addPrecision(e,t.precision),nv.addBitWidth(e,t.bitWidth),nv.endDecimal(e)}visitDate(t,e){return rv.startDate(e),rv.addUnit(e,t.unit),rv.endDate(e)}visitTime(t,e){return iv.startTime(e),iv.addUnit(e,t.unit),iv.addBitWidth(e,t.bitWidth),iv.endTime(e)}visitTimestamp(t,e){const n=t.timezone&&e.createString(t.timezone)||void 0;return ov.startTimestamp(e),ov.addUnit(e,t.unit),void 0!==n&&ov.addTimezone(e,n),ov.endTimestamp(e)}visitInterval(t,e){return sv.startInterval(e),sv.addUnit(e,t.unit),sv.endInterval(e)}visitDuration(t,e){return av.startDuration(e),av.addUnit(e,t.unit),av.endDuration(e)}visitList(t,e){return yv.startList(e),yv.endList(e)}visitStruct(t,e){return bv.startStruct_(e),bv.endStruct_(e)}visitUnion(t,e){lv.startTypeIdsVector(e,t.typeIds.length);const n=lv.createTypeIdsVector(e,t.typeIds);return lv.startUnion(e),lv.addMode(e,t.mode),lv.addTypeIds(e,n),lv.endUnion(e)}visitDictionary(t,e){const n=this.visit(t.indices,e);return cb.startDictionaryEncoding(e),cb.addId(e,BigInt(t.id)),cb.addIsOrdered(e,t.isOrdered),void 0!==n&&cb.addIndexType(e,n),cb.endDictionaryEncoding(e)}visitFixedSizeBinary(t,e){return uv.startFixedSizeBinary(e),uv.addByteWidth(e,t.byteWidth),uv.endFixedSizeBinary(e)}visitFixedSizeList(t,e){return cv.startFixedSizeList(e),cv.addListSize(e,t.listSize),cv.endFixedSizeList(e)}visitMap(t,e){return hv.startMap(e),hv.addKeysSorted(e,t.keysSorted),hv.endMap(e)}};function wv(t){return new Ov(t.count,_v(t.columns),kv(t.columns))}function xv(t,e){return(t.children||[]).filter(Boolean).map((t=>Ag.fromJSON(t,e)))}function _v(t){return(t||[]).reduce(((t,e)=>{return[...t,new Nv(e.count,(n=e.VALIDITY,(n||[]).reduce(((t,e)=>t+ +(0===e)),0))),..._v(e.children)];var n}),[])}function kv(t,e=[]){for(let n=-1,r=(t||[]).length;++n<r;){const r=t[n];r.VALIDITY&&e.push(new Iv(e.length,r.VALIDITY.length)),r.TYPE_ID&&e.push(new Iv(e.length,r.TYPE_ID.length)),r.OFFSET&&e.push(new Iv(e.length,r.OFFSET.length)),r.DATA&&e.push(new Iv(e.length,r.DATA.length)),e=kv(r.children,e)}return e}function Sv(t=[]){return new Map(t.map((({key:t,value:e})=>[t,e])))}function Ev(t){return new nd(t.isSigned,t.bitWidth)}function Av(t,e){const n=t.type.name;switch(n){case"NONE":case"null":return new ed;case"binary":return new md;case"utf8":return new gd;case"bool":return new yd;case"list":return new Id((e||[])[0]);case"struct":case"struct_":return new Nd(e||[])}switch(n){case"int":{const e=t.type;return new nd(e.isSigned,e.bitWidth)}case"floatingpoint":{const e=t.type;return new hd($h[e.precision])}case"decimal":{const e=t.type;return new bd(e.scale,e.precision,e.bitWidth)}case"date":{const e=t.type;return new vd(Fh[e.unit])}case"time":{const e=t.type;return new _d(Lh[e.unit],e.bitWidth)}case"timestamp":{const e=t.type;return new Cd(Lh[e.unit],e.timezone)}case"interval":{const e=t.type;return new Dd(Bh[e.unit])}case"duration":{const e=t.type;return new Td(Lh[e.unit])}case"union":{const n=t.type,[r,...i]=(n.mode+"").toLowerCase(),o=r.toUpperCase()+i.join("");return new $d(Nh[o],n.typeIds||[],e||[])}case"fixedsizebinary":{const e=t.type;return new Fd(e.byteWidth)}case"fixedsizelist":{const n=t.type;return new Ld(n.listSize,(e||[])[0])}case"map":{const n=t.type;return new Bd((e||[])[0],n.keysSorted)}}throw new Error(`Unrecognized type: "${n}"`)}var Cv=ab,Dv=sb;class Mv{static fromJSON(t,e){const n=new Mv(0,Ih.V5,e);return n._createHeader=function(t,e){return()=>{switch(e){case Rh.Schema:return Eg.fromJSON(t);case Rh.RecordBatch:return Ov.fromJSON(t);case Rh.DictionaryBatch:return Tv.fromJSON(t)}throw new Error(`Unrecognized Message type: { name: ${Rh[e]}, type: ${e} }`)}}(t,e),n}static decode(t){t=new Dv(bf(t));const e=fv.getRootAsMessage(t),n=e.bodyLength(),r=e.version(),i=e.headerType(),o=new Mv(n,r,i);return o._createHeader=function(t,e){return()=>{switch(e){case Rh.Schema:return Eg.decode(t.header(new fb),new Map,t.version());case Rh.RecordBatch:return Ov.decode(t.header(new Zb),t.version());case Rh.DictionaryBatch:return Tv.decode(t.header(new tv),t.version())}throw new Error(`Unrecognized Message type: { name: ${Rh[e]}, type: ${e} }`)}}(e,i),o}static encode(t){const e=new Cv;let n=-1;return t.isSchema()?n=Eg.encode(e,t.header()):t.isRecordBatch()?n=Ov.encode(e,t.header()):t.isDictionaryBatch()&&(n=Tv.encode(e,t.header())),fv.startMessage(e),fv.addVersion(e,Ih.V5),fv.addHeader(e,n),fv.addHeaderType(e,t.headerType),fv.addBodyLength(e,BigInt(t.bodyLength)),fv.finishMessageBuffer(e,fv.endMessage(e)),e.asUint8Array()}static from(t,e=0){if(t instanceof Eg)return new Mv(0,Ih.V5,Rh.Schema,t);if(t instanceof Ov)return new Mv(e,Ih.V5,Rh.RecordBatch,t);if(t instanceof Tv)return new Mv(e,Ih.V5,Rh.DictionaryBatch,t);throw new Error(`Unrecognized Message header: ${t}`)}get type(){return this.headerType}get version(){return this._version}get headerType(){return this._headerType}get bodyLength(){return this._bodyLength}header(){return this._createHeader()}isSchema(){return this.headerType===Rh.Schema}isRecordBatch(){return this.headerType===Rh.RecordBatch}isDictionaryBatch(){return this.headerType===Rh.DictionaryBatch}constructor(t,e,n,r){this._version=e,this._headerType=n,this.body=new Uint8Array(0),r&&(this._createHeader=()=>r),this._bodyLength=If(t)}}class Ov{get nodes(){return this._nodes}get length(){return this._length}get buffers(){return this._buffers}constructor(t,e,n){this._nodes=e,this._buffers=n,this._length=If(t)}}class Tv{get id(){return this._id}get data(){return this._data}get isDelta(){return this._isDelta}get length(){return this.data.length}get nodes(){return this.data.nodes}get buffers(){return this.data.buffers}constructor(t,e,n=!1){this._data=t,this._isDelta=n,this._id=If(e)}}class Iv{constructor(t,e){this.offset=If(t),this.length=If(e)}}class Nv{constructor(t,e){this.length=If(t),this.nullCount=If(e)}}function $v(t,e){const n=[];for(let r,i=-1,o=-1,s=t.childrenLength();++i<s;)(r=t.children(i))&&(n[++o]=Ag.decode(r,e));return n}function Fv(t){const e=new Map;if(t)for(let n,r,i=-1,o=Math.trunc(t.customMetadataLength());++i<o;)(n=t.customMetadata(i))&&null!=(r=n.key())&&e.set(r,n.value());return e}function Lv(t){return new nd(t.isSigned(),t.bitWidth())}function Bv(t,e){const n=t.typeType();switch(n){case ob.NONE:case ob.Null:return new ed;case ob.Binary:return new md;case ob.Utf8:return new gd;case ob.Bool:return new yd;case ob.List:return new Id((e||[])[0]);case ob.Struct_:return new Nd(e||[])}switch(n){case ob.Int:{const e=t.type(new ub);return new nd(e.isSigned(),e.bitWidth())}case ob.FloatingPoint:{const e=t.type(new ev);return new hd(e.precision())}case ob.Decimal:{const e=t.type(new nv);return new bd(e.scale(),e.precision(),e.bitWidth())}case ob.Date:{const e=t.type(new rv);return new vd(e.unit())}case ob.Time:{const e=t.type(new iv);return new _d(e.unit(),e.bitWidth())}case ob.Timestamp:{const e=t.type(new ov);return new Cd(e.unit(),e.timezone())}case ob.Interval:{const e=t.type(new sv);return new Dd(e.unit())}case ob.Duration:{const e=t.type(new av);return new Td(e.unit())}case ob.Union:{const n=t.type(new lv);return new $d(n.mode(),n.typeIdsArray()||[],e||[])}case ob.FixedSizeBinary:{const e=t.type(new uv);return new Fd(e.byteWidth())}case ob.FixedSizeList:{const n=t.type(new cv);return new Ld(n.listSize(),(e||[])[0])}case ob.Map:{const n=t.type(new hv);return new Bd((e||[])[0],n.keysSorted())}}throw new Error(`Unrecognized type: "${ob[n]}" (${n})`)}Ag.encode=function(t,e){let n=-1,r=-1,i=-1;const o=e.type;let s=e.typeId;td.isDictionary(o)?(s=o.dictionary.typeId,i=vv.visit(o,t),r=vv.visit(o.dictionary,t)):r=vv.visit(o,t);const a=(o.children||[]).map((e=>Ag.encode(t,e))),l=hb.createChildrenVector(t,a),u=e.metadata&&e.metadata.size>0?hb.createCustomMetadataVector(t,[...e.metadata].map((([e,n])=>{const r=t.createString(`${e}`),i=t.createString(`${n}`);return lb.startKeyValue(t),lb.addKey(t,r),lb.addValue(t,i),lb.endKeyValue(t)}))):-1;return e.name&&(n=t.createString(e.name)),hb.startField(t),hb.addType(t,r),hb.addTypeType(t,s),hb.addChildren(t,l),hb.addNullable(t,!!e.nullable),-1!==n&&hb.addName(t,n),-1!==i&&hb.addDictionary(t,i),-1!==u&&hb.addCustomMetadata(t,u),hb.endField(t)},Ag.decode=function(t,e){let n,r,i,o,s,a;return e&&(a=t.dictionary())?e.has(n=If(a.id()))?(o=(o=a.indexType())?Lv(o):new od,s=new zd(e.get(n),o,n,a.isOrdered()),r=new Ag(t.name(),s,t.nullable(),Fv(t))):(o=(o=a.indexType())?Lv(o):new od,e.set(n,i=Bv(t,$v(t,e))),s=new zd(i,o,n,a.isOrdered()),r=new Ag(t.name(),s,t.nullable(),Fv(t))):(i=Bv(t,$v(t,e)),r=new Ag(t.name(),i,t.nullable(),Fv(t))),r||null},Ag.fromJSON=function(t,e){let n,r,i,o,s,a;return e&&(o=t.dictionary)?e.has(n=o.id)?(r=(r=o.indexType)?Ev(r):new od,a=new zd(e.get(n),r,n,o.isOrdered),i=new Ag(t.name,a,t.nullable,Sv(t.metadata))):(r=(r=o.indexType)?Ev(r):new od,e.set(n,s=Av(t,xv(t,e))),a=new zd(s,r,n,o.isOrdered),i=new Ag(t.name,a,t.nullable,Sv(t.metadata))):(s=Av(t,xv(t,e)),i=new Ag(t.name,s,t.nullable,Sv(t.metadata))),i||null},Eg.encode=function(t,e){const n=e.fields.map((e=>Ag.encode(t,e)));fb.startFieldsVector(t,n.length);const r=fb.createFieldsVector(t,n),i=e.metadata&&e.metadata.size>0?fb.createCustomMetadataVector(t,[...e.metadata].map((([e,n])=>{const r=t.createString(`${e}`),i=t.createString(`${n}`);return lb.startKeyValue(t),lb.addKey(t,r),lb.addValue(t,i),lb.endKeyValue(t)}))):-1;return fb.startSchema(t),fb.addFields(t,r),fb.addEndianness(t,Rv?rb.Little:rb.Big),-1!==i&&fb.addCustomMetadata(t,i),fb.endSchema(t)},Eg.decode=function(t,e=new Map,n=Ih.V5){const r=function(t,e){const n=[];for(let r,i=-1,o=-1,s=t.fieldsLength();++i<s;)(r=t.fields(i))&&(n[++o]=Ag.decode(r,e));return n}(t,e);return new Eg(r,Fv(t),e,n)},Eg.fromJSON=function(t,e=new Map){return new Eg(function(t,e){return(t.fields||[]).filter(Boolean).map((t=>Ag.fromJSON(t,e)))}(t,e),Sv(t.metadata),e)},Ov.encode=function(t,e){const n=e.nodes||[],r=e.buffers||[];Zb.startNodesVector(t,n.length);for(const e of n.slice().reverse())Nv.encode(t,e);const i=t.endVector();Zb.startBuffersVector(t,r.length);for(const e of r.slice().reverse())Iv.encode(t,e);const o=t.endVector();return Zb.startRecordBatch(t),Zb.addLength(t,BigInt(e.length)),Zb.addNodes(t,i),Zb.addBuffers(t,o),Zb.endRecordBatch(t)},Ov.decode=function(t,e=Ih.V5){if(null!==t.compression())throw new Error("Record batch compression not implemented");return new Ov(t.length(),function(t){const e=[];for(let n,r=-1,i=-1,o=t.nodesLength();++r<o;)(n=t.nodes(r))&&(e[++i]=Nv.decode(n));return e}(t),function(t,e){const n=[];for(let r,i=-1,o=-1,s=t.buffersLength();++i<s;)(r=t.buffers(i))&&(e<Ih.V4&&(r.bb_pos+=8*(i+1)),n[++o]=Iv.decode(r));return n}(t,e))},Ov.fromJSON=wv,Tv.encode=function(t,e){const n=Ov.encode(t,e.data);return tv.startDictionaryBatch(t),tv.addId(t,BigInt(e.id)),tv.addIsDelta(t,e.isDelta),tv.addData(t,n),tv.endDictionaryBatch(t)},Tv.decode=function(t,e=Ih.V5){return new Tv(Ov.decode(t.data(),e),t.id(),t.isDelta())},Tv.fromJSON=function(t){return new Tv(wv(t.data),t.id,t.isDelta)},Nv.encode=function(t,e){return Qb.createFieldNode(t,BigInt(e.length),BigInt(e.nullCount))},Nv.decode=function(t){return new Nv(t.length(),t.nullCount())},Iv.encode=function(t,e){return Kb.createBuffer(t,BigInt(e.offset),BigInt(e.length))},Iv.decode=function(t){return new Iv(t.offset(),t.length())};const Rv=(()=>{const t=new ArrayBuffer(2);return new DataView(t).setInt16(0,256,!0),256===new Int16Array(t)[0]})(),Pv=t=>`Expected ${Rh[t]} Message in stream, but was null or length 0.`,zv=t=>`Header pointer of flatbuffer-encoded ${Rh[t]} Message is null or length 0.`,jv=(t,e)=>`Expected to read ${t} metadata bytes, but only read ${e}.`,Uv=(t,e)=>`Expected to read ${t} bytes for message body, but only read ${e}.`;class Vv{constructor(t){this.source=t instanceof Db?t:new Db(t)}[Symbol.iterator](){return this}next(){let t;return(t=this.readMetadataLength()).done||-1===t.value&&(t=this.readMetadataLength()).done||(t=this.readMetadata(t.value)).done?kb:t}throw(t){return this.source.throw(t)}return(t){return this.source.return(t)}readMessage(t){let e;if((e=this.next()).done)return null;if(null!=t&&e.value.headerType!==t)throw new Error(Pv(t));return e.value}readMessageBody(t){if(t<=0)return new Uint8Array(0);const e=bf(this.source.read(t));if(e.byteLength<t)throw new Error(Uv(t,e.byteLength));return e.byteOffset%8==0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()}readSchema(t=!1){const e=Rh.Schema,n=this.readMessage(e),r=null==n?void 0:n.header();if(t&&!r)throw new Error(zv(e));return r}readMetadataLength(){const t=this.source.read(Hv),e=t&&new sb(t),n=(null==e?void 0:e.readInt32(0))||0;return{done:0===n,value:n}}readMetadata(t){const e=this.source.read(t);if(!e)return kb;if(e.byteLength<t)throw new Error(jv(t,e.byteLength));return{done:!1,value:Mv.decode(e)}}}class qv{constructor(t,e){this.source=t instanceof Mb?t:af(t)?new Nb(t,e):new Mb(t)}[Symbol.asyncIterator](){return this}next(){return Vh(this,void 0,void 0,(function*(){let t;return(t=yield this.readMetadataLength()).done||-1===t.value&&(t=yield this.readMetadataLength()).done||(t=yield this.readMetadata(t.value)).done?kb:t}))}throw(t){return Vh(this,void 0,void 0,(function*(){return yield this.source.throw(t)}))}return(t){return Vh(this,void 0,void 0,(function*(){return yield this.source.return(t)}))}readMessage(t){return Vh(this,void 0,void 0,(function*(){let e;if((e=yield this.next()).done)return null;if(null!=t&&e.value.headerType!==t)throw new Error(Pv(t));return e.value}))}readMessageBody(t){return Vh(this,void 0,void 0,(function*(){if(t<=0)return new Uint8Array(0);const e=bf(yield this.source.read(t));if(e.byteLength<t)throw new Error(Uv(t,e.byteLength));return e.byteOffset%8==0&&e.byteOffset+e.byteLength<=e.buffer.byteLength?e:e.slice()}))}readSchema(t=!1){return Vh(this,void 0,void 0,(function*(){const e=Rh.Schema,n=yield this.readMessage(e),r=null==n?void 0:n.header();if(t&&!r)throw new Error(zv(e));return r}))}readMetadataLength(){return Vh(this,void 0,void 0,(function*(){const t=yield this.source.read(Hv),e=t&&new sb(t),n=(null==e?void 0:e.readInt32(0))||0;return{done:0===n,value:n}}))}readMetadata(t){return Vh(this,void 0,void 0,(function*(){const e=yield this.source.read(t);if(!e)return kb;if(e.byteLength<t)throw new Error(jv(t,e.byteLength));return{done:!1,value:Mv.decode(e)}}))}}class Wv extends Vv{constructor(t){super(new Uint8Array(0)),this._schema=!1,this._body=[],this._batchIndex=0,this._dictionaryIndex=0,this._json=t instanceof Sb?t:new Sb(t)}next(){const{_json:t}=this;if(!this._schema)return this._schema=!0,{done:!1,value:Mv.fromJSON(t.schema,Rh.Schema)};if(this._dictionaryIndex<t.dictionaries.length){const e=t.dictionaries[this._dictionaryIndex++];return this._body=e.data.columns,{done:!1,value:Mv.fromJSON(e,Rh.DictionaryBatch)}}if(this._batchIndex<t.batches.length){const e=t.batches[this._batchIndex++];return this._body=e.columns,{done:!1,value:Mv.fromJSON(e,Rh.RecordBatch)}}return this._body=[],kb}readMessageBody(t){return function t(e){return(e||[]).reduce(((e,n)=>[...e,...n.VALIDITY&&[n.VALIDITY]||[],...n.TYPE_ID&&[n.TYPE_ID]||[],...n.OFFSET&&[n.OFFSET]||[],...n.DATA&&[n.DATA]||[],...t(n.children)]),[])}(this._body)}readMessage(t){let e;if((e=this.next()).done)return null;if(null!=t&&e.value.headerType!==t)throw new Error(Pv(t));return e.value}readSchema(){const t=Rh.Schema,e=this.readMessage(t),n=null==e?void 0:e.header();if(!e||!n)throw new Error(zv(t));return n}}const Hv=4,Gv=new Uint8Array(6);for(let t=0;t<6;t+=1)Gv[t]="ARROW1".codePointAt(t);function Yv(t,e=0){for(let n=-1,r=Gv.length;++n<r;)if(Gv[n]!==t[e+n])return!1;return!0}const Xv=Gv.length,Jv=Xv+Hv,Kv=2*Xv+Hv;class Qv extends Eb{constructor(t){super(),this._impl=t}get closed(){return this._impl.closed}get schema(){return this._impl.schema}get autoDestroy(){return this._impl.autoDestroy}get dictionaries(){return this._impl.dictionaries}get numDictionaries(){return this._impl.numDictionaries}get numRecordBatches(){return this._impl.numRecordBatches}get footer(){return this._impl.isFile()?this._impl.footer:null}isSync(){return this._impl.isSync()}isAsync(){return this._impl.isAsync()}isFile(){return this._impl.isFile()}isStream(){return this._impl.isStream()}next(){return this._impl.next()}throw(t){return this._impl.throw(t)}return(t){return this._impl.return(t)}cancel(){return this._impl.cancel()}reset(t){return this._impl.reset(t),this._DOMStream=void 0,this._nodeStream=void 0,this}open(t){const e=this._impl.open(t);return ef(e)?e.then((()=>this)):this}readRecordBatch(t){return this._impl.isFile()?this._impl.readRecordBatch(t):null}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}toDOMStream(){return vb.toDOMStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this})}toNodeStream(){return vb.toNodeStream(this.isSync()?{[Symbol.iterator]:()=>this}:{[Symbol.asyncIterator]:()=>this},{objectMode:!0})}static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,e){throw new Error('"throughDOM" not available in this environment')}static from(t){return t instanceof Qv?t:of(t)?function(t){return new Zv(new lw(t))}(t):af(t)?function(t){return Vh(this,void 0,void 0,(function*(){const{size:e}=yield t.stat(),n=new Nb(t,e);return e>=Kv&&Yv(yield n.readAt(0,Xv+7&-8))?new nw(new aw(n)):new tw(new ow(n))}))}(t):ef(t)?(()=>Vh(this,void 0,void 0,(function*(){return yield Qv.from(yield t)})))():lf(t)||cf(t)||hf(t)||rf(t)?function(t){return Vh(this,void 0,void 0,(function*(){const e=yield t.peek(Xv+7&-8);return e&&e.byteLength>=4?Yv(e)?new ew(new sw(yield t.read())):new tw(new ow(t)):new tw(new ow(function(){return Wh(this,arguments,(function*(){}))}()))}))}(new Mb(t)):function(t){const e=t.peek(Xv+7&-8);return e&&e.byteLength>=4?Yv(e)?new ew(new sw(t.read())):new Zv(new iw(t)):new Zv(new iw(function*(){}()))}(new Db(t))}static readAll(t){return t instanceof Qv?t.isSync()?cw(t):hw(t):of(t)||ArrayBuffer.isView(t)||nf(t)||sf(t)?cw(t):hw(t)}}class Zv extends Qv{constructor(t){super(t),this._impl=t}readAll(){return[...this]}[Symbol.iterator](){return this._impl[Symbol.iterator]()}[Symbol.asyncIterator](){return Wh(this,arguments,(function*(){yield qh(yield*Hh(Gh(this[Symbol.iterator]())))}))}}class tw extends Qv{constructor(t){super(t),this._impl=t}readAll(){var t,e,n,r;return Vh(this,void 0,void 0,(function*(){const i=new Array;try{for(var o,s=!0,a=Gh(this);o=yield a.next(),!(t=o.done);s=!0){r=o.value,s=!1;const t=r;i.push(t)}}catch(t){e={error:t}}finally{try{s||t||!(n=a.return)||(yield n.call(a))}finally{if(e)throw e.error}}return i}))}[Symbol.iterator](){throw new Error("AsyncRecordBatchStreamReader is not Iterable")}[Symbol.asyncIterator](){return this._impl[Symbol.asyncIterator]()}}class ew extends Zv{constructor(t){super(t),this._impl=t}}class nw extends tw{constructor(t){super(t),this._impl=t}}class rw{get numDictionaries(){return this._dictionaryIndex}get numRecordBatches(){return this._recordBatchIndex}constructor(t=new Map){this.closed=!1,this.autoDestroy=!0,this._dictionaryIndex=0,this._recordBatchIndex=0,this.dictionaries=t}isSync(){return!1}isAsync(){return!1}isFile(){return!1}isStream(){return!1}reset(t){return this._dictionaryIndex=0,this._recordBatchIndex=0,this.schema=t,this.dictionaries=new Map,this}_loadRecordBatch(t,e){const n=this._loadVectors(t,e,this.schema.fields),r=Zm({type:new Nd(this.schema.fields),length:t.length,children:n});return new Vy(this.schema,r)}_loadDictionaryBatch(t,e){const{id:n,isDelta:r}=t,{dictionaries:i,schema:o}=this,s=i.get(n);if(r||!s){const i=o.dictionaries.get(n),a=this._loadVectors(t.data,e,[i]);return(s&&r?s.concat(new Ym(a)):new Ym(a)).memoize()}return s.memoize()}_loadVectors(t,e,n){return new zb(e,t.nodes,t.buffers,this.dictionaries,this.schema.metadataVersion).visitMany(n)}}class iw extends rw{constructor(t,e){super(e),this._reader=of(t)?new Wv(this._handle=t):new Vv(this._handle=t)}isSync(){return!0}isStream(){return!0}[Symbol.iterator](){return this}cancel(){!this.closed&&(this.closed=!0)&&(this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}open(t){return this.closed||(this.autoDestroy=uw(this,t),this.schema||(this.schema=this._reader.readSchema())||this.cancel()),this}throw(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.throw(t):kb}return(t){return!this.closed&&this.autoDestroy&&(this.closed=!0)?this.reset()._reader.return(t):kb}next(){if(this.closed)return kb;let t;const{_reader:e}=this;for(;t=this._readNextMessageAndValidate();)if(t.isSchema())this.reset(t.header());else{if(t.isRecordBatch()){this._recordBatchIndex++;const n=t.header(),r=e.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(n,r)}}if(t.isDictionaryBatch()){this._dictionaryIndex++;const n=t.header(),r=e.readMessageBody(t.bodyLength),i=this._loadDictionaryBatch(n,r);this.dictionaries.set(n.id,i)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new Hy(this.schema)}):this.return()}_readNextMessageAndValidate(t){return this._reader.readMessage(t)}}class ow extends rw{constructor(t,e){super(e),this._reader=new qv(this._handle=t)}isAsync(){return!0}isStream(){return!0}[Symbol.asyncIterator](){return this}cancel(){return Vh(this,void 0,void 0,(function*(){!this.closed&&(this.closed=!0)&&(yield this.reset()._reader.return(),this._reader=null,this.dictionaries=null)}))}open(t){return Vh(this,void 0,void 0,(function*(){return this.closed||(this.autoDestroy=uw(this,t),this.schema||(this.schema=yield this._reader.readSchema())||(yield this.cancel())),this}))}throw(t){return Vh(this,void 0,void 0,(function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.throw(t):kb}))}return(t){return Vh(this,void 0,void 0,(function*(){return!this.closed&&this.autoDestroy&&(this.closed=!0)?yield this.reset()._reader.return(t):kb}))}next(){return Vh(this,void 0,void 0,(function*(){if(this.closed)return kb;let t;const{_reader:e}=this;for(;t=yield this._readNextMessageAndValidate();)if(t.isSchema())yield this.reset(t.header());else{if(t.isRecordBatch()){this._recordBatchIndex++;const n=t.header(),r=yield e.readMessageBody(t.bodyLength);return{done:!1,value:this._loadRecordBatch(n,r)}}if(t.isDictionaryBatch()){this._dictionaryIndex++;const n=t.header(),r=yield e.readMessageBody(t.bodyLength),i=this._loadDictionaryBatch(n,r);this.dictionaries.set(n.id,i)}}return this.schema&&0===this._recordBatchIndex?(this._recordBatchIndex++,{done:!1,value:new Hy(this.schema)}):yield this.return()}))}_readNextMessageAndValidate(t){return Vh(this,void 0,void 0,(function*(){return yield this._reader.readMessage(t)}))}}class sw extends iw{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(t,e){super(t instanceof Ib?t:new Ib(t),e)}isSync(){return!0}isFile(){return!0}open(t){if(!this.closed&&!this._footer){this.schema=(this._footer=this._readFooter()).schema;for(const t of this._footer.dictionaryBatches())t&&this._readDictionaryBatch(this._dictionaryIndex++)}return super.open(t)}readRecordBatch(t){var e;if(this.closed)return null;this._footer||this.open();const n=null===(e=this._footer)||void 0===e?void 0:e.getRecordBatch(t);if(n&&this._handle.seek(n.offset)){const t=this._reader.readMessage(Rh.RecordBatch);if(null==t?void 0:t.isRecordBatch()){const e=t.header(),n=this._reader.readMessageBody(t.bodyLength);return this._loadRecordBatch(e,n)}}return null}_readDictionaryBatch(t){var e;const n=null===(e=this._footer)||void 0===e?void 0:e.getDictionaryBatch(t);if(n&&this._handle.seek(n.offset)){const t=this._reader.readMessage(Rh.DictionaryBatch);if(null==t?void 0:t.isDictionaryBatch()){const e=t.header(),n=this._reader.readMessageBody(t.bodyLength),r=this._loadDictionaryBatch(e,n);this.dictionaries.set(e.id,r)}}}_readFooter(){const{_handle:t}=this,e=t.size-Jv,n=t.readInt32(e),r=t.readAt(e-n,n);return gb.decode(r)}_readNextMessageAndValidate(t){var e;if(this._footer||this.open(),this._footer&&this._recordBatchIndex<this.numRecordBatches){const n=null===(e=this._footer)||void 0===e?void 0:e.getRecordBatch(this._recordBatchIndex);if(n&&this._handle.seek(n.offset))return this._reader.readMessage(t)}return null}}class aw extends ow{get footer(){return this._footer}get numDictionaries(){return this._footer?this._footer.numDictionaries:0}get numRecordBatches(){return this._footer?this._footer.numRecordBatches:0}constructor(t,...e){const n="number"!=typeof e[0]?e.shift():void 0,r=e[0]instanceof Map?e.shift():void 0;super(t instanceof Nb?t:new Nb(t,n),r)}isFile(){return!0}isAsync(){return!0}open(t){const e=Object.create(null,{open:{get:()=>super.open}});return Vh(this,void 0,void 0,(function*(){if(!this.closed&&!this._footer){this.schema=(this._footer=yield this._readFooter()).schema;for(const t of this._footer.dictionaryBatches())t&&(yield this._readDictionaryBatch(this._dictionaryIndex++))}return yield e.open.call(this,t)}))}readRecordBatch(t){var e;return Vh(this,void 0,void 0,(function*(){if(this.closed)return null;this._footer||(yield this.open());const n=null===(e=this._footer)||void 0===e?void 0:e.getRecordBatch(t);if(n&&(yield this._handle.seek(n.offset))){const t=yield this._reader.readMessage(Rh.RecordBatch);if(null==t?void 0:t.isRecordBatch()){const e=t.header(),n=yield this._reader.readMessageBody(t.bodyLength);return this._loadRecordBatch(e,n)}}return null}))}_readDictionaryBatch(t){var e;return Vh(this,void 0,void 0,(function*(){const n=null===(e=this._footer)||void 0===e?void 0:e.getDictionaryBatch(t);if(n&&(yield this._handle.seek(n.offset))){const t=yield this._reader.readMessage(Rh.DictionaryBatch);if(null==t?void 0:t.isDictionaryBatch()){const e=t.header(),n=yield this._reader.readMessageBody(t.bodyLength),r=this._loadDictionaryBatch(e,n);this.dictionaries.set(e.id,r)}}}))}_readFooter(){return Vh(this,void 0,void 0,(function*(){const{_handle:t}=this;t._pending&&(yield t._pending);const e=t.size-Jv,n=yield t.readInt32(e),r=yield t.readAt(e-n,n);return gb.decode(r)}))}_readNextMessageAndValidate(t){return Vh(this,void 0,void 0,(function*(){if(this._footer||(yield this.open()),this._footer&&this._recordBatchIndex<this.numRecordBatches){const e=this._footer.getRecordBatch(this._recordBatchIndex);if(e&&(yield this._handle.seek(e.offset)))return yield this._reader.readMessage(t)}return null}))}}class lw extends iw{constructor(t,e){super(t,e)}_loadVectors(t,e,n){return new jb(e,t.nodes,t.buffers,this.dictionaries,this.schema.metadataVersion).visitMany(n)}}function uw(t,e){return e&&"boolean"==typeof e.autoDestroy?e.autoDestroy:t.autoDestroy}function*cw(t){const e=Qv.from(t);try{if(!e.open({autoDestroy:!1}).closed)do{yield e}while(!e.reset().open().closed)}finally{e.cancel()}}function hw(t){return Wh(this,arguments,(function*(){const e=yield qh(Qv.from(t));try{if(!(yield qh(e.open({autoDestroy:!1}))).closed)do{yield yield qh(e)}while(!(yield qh(e.reset().open())).closed)}finally{yield qh(e.cancel())}}))}class fw extends Ud{static assemble(...t){const e=t=>t.flatMap((t=>Array.isArray(t)?e(t):t instanceof Vy?t.data.children:t.data)),n=new fw;return n.visitMany(e(t)),n}constructor(){super(),this._byteLength=0,this._nodes=[],this._buffers=[],this._bufferRegions=[]}visit(t){if(t instanceof Ym)return this.visitMany(t.data),this;const{type:e}=t;if(!td.isDictionary(e)){const{length:n}=t;if(n>2147483647)throw new RangeError("Cannot write arrays larger than 2^31 - 1 in length");if(td.isUnion(e))this.nodes.push(new Nv(n,0));else{const{nullCount:r}=t;td.isNull(e)||dw.call(this,r<=0?new Uint8Array(0):Cm(t.offset,n,t.nullBitmap)),this.nodes.push(new Nv(n,r))}}return super.visit(t)}visitNull(t){return this}visitDictionary(t){return this.visit(t.clone(t.type.indices))}get nodes(){return this._nodes}get buffers(){return this._buffers}get byteLength(){return this._byteLength}get bufferRegions(){return this._bufferRegions}}function dw(t){const e=t.byteLength+7&-8;return this.buffers.push(t),this.bufferRegions.push(new Iv(this._byteLength,e)),this._byteLength+=e,this}function pw(t){return dw.call(this,t.values.subarray(0,t.length*t.stride))}function mw(t){const{length:e,values:n,valueOffsets:r}=t,{0:i,[e]:o}=r,s=Math.min(o-i,n.byteLength-i);return dw.call(this,xf(-i,e+1,r)),dw.call(this,n.subarray(i,i+s)),this}function gw(t){const{length:e,valueOffsets:n}=t;if(n){const{0:r,[e]:i}=n;return dw.call(this,xf(-r,e+1,n)),this.visit(t.children[0].slice(r,i-r))}return this.visit(t.children[0])}function yw(t){return this.visitMany(t.type.children.map(((e,n)=>t.children[n])).filter(Boolean))[0]}fw.prototype.visitBool=function(t){let e;return t.nullCount>=t.length?dw.call(this,new Uint8Array(0)):(e=t.values)instanceof Uint8Array?dw.call(this,Cm(t.offset,t.length,e)):dw.call(this,Dm(t.values))},fw.prototype.visitInt=pw,fw.prototype.visitFloat=pw,fw.prototype.visitUtf8=mw,fw.prototype.visitBinary=mw,fw.prototype.visitFixedSizeBinary=pw,fw.prototype.visitDate=pw,fw.prototype.visitTimestamp=pw,fw.prototype.visitTime=pw,fw.prototype.visitDecimal=pw,fw.prototype.visitList=gw,fw.prototype.visitStruct=yw,fw.prototype.visitUnion=function(t){var e;const{type:n,length:r,typeIds:i,valueOffsets:o}=t;if(dw.call(this,i),n.mode===Nh.Sparse)return yw.call(this,t);if(n.mode===Nh.Dense){if(t.offset<=0)return dw.call(this,o),yw.call(this,t);{const s=new Int32Array(r),a=Object.create(null),l=Object.create(null);for(let t,n,u=-1;++u<r;)void 0!==(t=i[u])&&(void 0===(n=a[t])&&(n=a[t]=o[u]),s[u]=o[u]-n,l[t]=(null!==(e=l[t])&&void 0!==e?e:0)+1);dw.call(this,s),this.visitMany(t.children.map(((t,e)=>{const i=n.typeIds[e],o=a[i],s=l[i];return t.slice(o,Math.min(r,s))})))}}return this},fw.prototype.visitInterval=pw,fw.prototype.visitDuration=pw,fw.prototype.visitFixedSizeList=gw,fw.prototype.visitMap=gw;class bw extends Eb{static throughNode(t){throw new Error('"throughNode" not available in this environment')}static throughDOM(t,e){throw new Error('"throughDOM" not available in this environment')}constructor(t){super(),this._position=0,this._started=!1,this._sink=new Cb,this._schema=null,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,tf(t)||(t={autoDestroy:!0,writeLegacyIpcFormat:!1}),this._autoDestroy="boolean"!=typeof t.autoDestroy||t.autoDestroy,this._writeLegacyIpcFormat="boolean"==typeof t.writeLegacyIpcFormat&&t.writeLegacyIpcFormat}toString(t=!1){return this._sink.toString(t)}toUint8Array(t=!1){return this._sink.toUint8Array(t)}writeAll(t){return ef(t)?t.then((t=>this.writeAll(t))):rf(t)?_w(this,t):xw(this,t)}get closed(){return this._sink.closed}[Symbol.asyncIterator](){return this._sink[Symbol.asyncIterator]()}toDOMStream(t){return this._sink.toDOMStream(t)}toNodeStream(t){return this._sink.toNodeStream(t)}close(){return this.reset()._sink.close()}abort(t){return this.reset()._sink.abort(t)}finish(){return this._autoDestroy?this.close():this.reset(this._sink,this._schema),this}reset(t=this._sink,e=null){return t===this._sink||t instanceof Cb?this._sink=t:(this._sink=new Cb,t&&(t=>tf(t)&&Zh(t.abort)&&Zh(t.getWriter)&&!uf(t))(t)?this.toDOMStream({type:"bytes"}).pipeTo(t):t&&(t=>tf(t)&&Zh(t.end)&&Zh(t.write)&&Qh(t.writable)&&!uf(t))(t)&&this.toNodeStream({objectMode:!1}).pipe(t)),this._started&&this._schema&&this._writeFooter(this._schema),this._started=!1,this._dictionaryBlocks=[],this._recordBatchBlocks=[],this._dictionaryDeltaOffsets=new Map,e&&zy(e,this._schema)||(null==e?(this._position=0,this._schema=null):(this._started=!0,this._schema=e,this._writeSchema(e))),this}write(t){let e=null;if(!this._sink)throw new Error("RecordBatchWriter is closed");if(null==t)return this.finish()&&void 0;if(t instanceof Xy&&!(e=t.schema))return this.finish()&&void 0;if(t instanceof Vy&&!(e=t.schema))return this.finish()&&void 0;if(e&&!zy(e,this._schema)){if(this._started&&this._autoDestroy)return this.close();this.reset(this._sink,e)}t instanceof Vy?t instanceof Hy||this._writeRecordBatch(t):t instanceof Xy?this.writeAll(t.batches):nf(t)&&this.writeAll(t)}_writeMessage(t,e=8){const n=e-1,r=Mv.encode(t),i=r.byteLength,o=this._writeLegacyIpcFormat?4:8,s=i+o+n&~n,a=s-i-o;return t.headerType===Rh.RecordBatch?this._recordBatchBlocks.push(new bb(s,t.bodyLength,this._position)):t.headerType===Rh.DictionaryBatch&&this._dictionaryBlocks.push(new bb(s,t.bodyLength,this._position)),this._writeLegacyIpcFormat||this._write(Int32Array.of(-1)),this._write(Int32Array.of(s-o)),i>0&&this._write(r),this._writePadding(a)}_write(t){if(this._started){const e=bf(t);e&&e.byteLength>0&&(this._sink.write(e),this._position+=e.byteLength)}return this}_writeSchema(t){return this._writeMessage(Mv.from(t))}_writeFooter(t){return this._writeLegacyIpcFormat?this._write(Int32Array.of(0)):this._write(Int32Array.of(-1,0))}_writeMagic(){return this._write(Gv)}_writePadding(t){return t>0?this._write(new Uint8Array(t)):this}_writeRecordBatch(t){const{byteLength:e,nodes:n,bufferRegions:r,buffers:i}=fw.assemble(t),o=new Ov(t.numRows,n,r),s=Mv.from(o,e);return this._writeDictionaries(t)._writeMessage(s)._writeBodyBuffers(i)}_writeDictionaryBatch(t,e,n=!1){this._dictionaryDeltaOffsets.set(e,t.length+(this._dictionaryDeltaOffsets.get(e)||0));const{byteLength:r,nodes:i,bufferRegions:o,buffers:s}=fw.assemble(new Ym([t])),a=new Ov(t.length,i,o),l=new Tv(a,e,n),u=Mv.from(l,r);return this._writeMessage(u)._writeBodyBuffers(s)}_writeBodyBuffers(t){let e,n,r;for(let i=-1,o=t.length;++i<o;)(e=t[i])&&(n=e.byteLength)>0&&(this._write(e),(r=(n+7&-8)-n)>0&&this._writePadding(r));return this}_writeDictionaries(t){for(let[e,n]of t.dictionaries){let t=this._dictionaryDeltaOffsets.get(e)||0;if(0===t||(n=null==n?void 0:n.slice(t)).length>0)for(const r of n.data)this._writeDictionaryBatch(r,e,t>0),t+=r.length}return this}}class vw extends bw{static writeAll(t,e){const n=new vw(e);return ef(t)?t.then((t=>n.writeAll(t))):rf(t)?_w(n,t):xw(n,t)}}class ww extends bw{static writeAll(t){const e=new ww;return ef(t)?t.then((t=>e.writeAll(t))):rf(t)?_w(e,t):xw(e,t)}constructor(){super(),this._autoDestroy=!0}_writeSchema(t){return this._writeMagic()._writePadding(2)}_writeFooter(t){const e=gb.encode(new gb(t,Ih.V5,this._recordBatchBlocks,this._dictionaryBlocks));return super._writeFooter(t)._write(e)._write(Int32Array.of(e.byteLength))._writeMagic()}}function xw(t,e){let n=e;e instanceof Xy&&(n=e.batches,t.reset(void 0,e.schema));for(const e of n)t.write(e);return t.finish()}function _w(t,e){var n,r,i,o,s,a,l;return Vh(this,void 0,void 0,(function*(){try{for(n=!0,r=Gh(e);i=yield r.next(),!(o=i.done);n=!0){l=i.value,n=!1;const e=l;t.write(e)}}catch(t){s={error:t}}finally{try{n||o||!(a=r.return)||(yield a.call(r))}finally{if(s)throw s.error}}return t.finish()}))}function kw(t){const e=Qv.from(t);return ef(e)?e.then((t=>kw(t))):e.isAsync()?e.readAll().then((t=>new Xy(t))):new Xy(e.readAll())}const Sw=()=>$u("Apache Arrow not imported, see https://github.com/uwdata/arquero#usage");function Ew(t,e={}){const{types:n={}}=e,{dataFrom:r,names:i,nrows:o,scan:s}=function(t,e){const{columns:n,limit:r=1/0,offset:i=0}=e,o=Lu(n)?n(t):Ou(n)?n:null;return Ou(t)?{dataFrom:ky,names:o||Object.keys(t[0]),nrows:Math.min(r,t.length-i),scan:Ay(t,r,i)}:function(t){return t&&Lu(t.reify)}(t)?{dataFrom:Sy,names:o||t.columnNames(),nrows:Math.min(r,t.numRows()-i),scan:Cy(t,r,i)}:void $u("Unsupported input data type")}(t,e),a={};return i.forEach((e=>{const i=r(t,e,o,s,n[e]);i.length!==o&&$u("Column length mismatch"),a[e]=i})),new(function(){try{return Xy}catch(t){Sw()}}())(a)}const Aw=Ew;function Cw(t,e){return Lu(e)?e(t):e||t.columnNames()}function Dw(t,e,n){const r=n.format||{},i=n.align||{},o={},s={};return e.forEach((e=>{const a=function(t,e={}){let n=0,r=0,i=0,o=0,s=0,a=0;return t((t=>{if(++n,null==t)return void++r;const e=typeof t;if("object"===e&&ju(t))++i,0===(l=t).getUTCHours()&&0===l.getUTCMinutes()&&0===l.getUTCSeconds()&&0===l.getUTCMilliseconds()&&++o;else if("number"===e&&(++s,t==t&&(0|t)!==t)){const e=t+"",n=e.indexOf(".");if(n>=0){const t=e.indexOf("e"),r=t>0?t:e.length;a=Math.max(a,r-n-1)}}var l})),{align:(r+s+i)/n>.5?"r":"l",format:{utc:i===o,digits:Math.min(a,e.maxdigits||6)}}}(function(t,e){const n=t.column(e);return e=>t.scan((t=>e(n.get(t))))}(t,e),n);s[e]=i[e]||a.align,o[e]=r[e]||a.format})),{align:s,format:o}}function Mw(t,e,n=100,r,i){const o=t.data(),s=e.length;t.scan((t=>{i.row(t);for(let n=0;n<s;++n){const r=e[n];i.cell(o[e[n]].get(t),r,n)}}),!0,n,r)}function Ow(t,e={}){if(Lu(e))return e(t)+"";const n=typeof t;if("object"===n){if(ju(t))return e.utc?lc(t):ac(t);{const n=JSON.stringify(t,((t,e)=>Qu(e)?Array.from(e):e)),r=e.maxlen||30;return n.length>r?n.slice(0,28)+"â€¦"+("["===n[0]?"]":"}"):n}}if("number"===n){const n=e.digits||0;let r;return 0!==t&&((r=Math.abs(t))>=1e18||r<Math.pow(10,-n))?t.toExponential(n):t.toFixed(n)}return t+""}function Tw(t,e,n={}){for(const r in t)n[r]=e(t[r],r);return n}const Iw=t=>ju(t)?lc(t,!0):t;function Nw(t,e){for(const[n,r]of Ch(e))t.set(n,r);return t}function $w(t,e,n=new Map){return qu(e=Fu(e)?t.columnName(e):e)?n.set(e,e):Ou(e)?e.forEach((e=>$w(t,e,n))):Lu(e)?$w(t,e(t),n):Uu(e)?Nw(n,e):$u(`Invalid column selection: ${Oc(e)}`),n}function Fw(t,e){return t.toObject=e,t}function Lw(t){return Ou(t)?t.map(Lw):t&&t.toObject?t.toObject():t}function Bw(){return Fw((t=>t.columnNames()),(()=>({all:[]})))}function Rw(...t){return t=t.flat(),Fw((e=>{const n=$w(e,t);return e.columnNames((t=>!n.has(t)))}),(()=>({not:Lw(t)})))}class Pw extends Ru{static from(t,e){return new Pw(function(t,e){const n=e=>$u(`Illegal argument type: ${e||typeof t}`);return t instanceof Map?Wu(t.entries(),e):ju(t)?n("Date"):Vu(t)?n("RegExp"):qu(t)?n():Ou(t)?function(t,e){const n=t.length,r={},i=t=>r[t]=Array(n);if(n){const r=(e=e||Object.keys(t[0])).map(i),o=r.length;for(let i=0;i<n;++i){const n=t[i];for(let t=0;t<o;++t)r[t][i]=n[e[t]]}}else e&&e.forEach(i);return r}(t,e):Lu(t[Symbol.iterator])?function(t,e){const n={},r=t=>n[t]=[];let i,o;for(const n of t){i||(i=(e=e||Object.keys(n)).map(r),o=i.length);for(let t=0;t<o;++t)i[t].push(n[e[t]])}return!i&&e&&e.forEach(r),n}(t,e):Uu(t)?Wu(Object.entries(t),e):n()}(t,e),e)}static new(t,e){if(t instanceof Pw)return t;const n={},r=[];for(const[e,i]of Ch(t))n[e]=i,r.push(e);return new Pw(n,e||r)}constructor(t,e,n,r,i,o){Tw(t,zu,t),super(e=e||Object.keys(t),e.length?t[e[0]].length:0,t,n,r,i,o)}create({data:t,names:e,filter:n,groups:r,order:i}){const o=void 0!==n?n:this.mask();return new Pw(t||this._data,e||(t?null:this._names),o,void 0!==r?r:function(t,e){if(!t||!e)return t;const{keys:n,rows:r,size:i}=t,o=new Int32Array(i);e.scan((t=>o[n[t]]=1));const s=o.reduce(((t,e)=>t+e),0);if(s===i)return t;const a=Array(s);let l=0;for(let t=0;t<i;++t)o[t]&&(a[o[t]=l++]=r[t]);const u=new Uint32Array(n.length);return e.scan((t=>u[t]=o[n[t]])),{...t,keys:u,rows:a,size:l}}(this._group,n&&o),void 0!==i?i:this._order,this._params)}assign(...t){const e=this.numRows(),n=this.reify(),r=Yu(n).groupby(n.groups());return t.forEach((t=>{(t=Pw.new(t)).numRows()!==e&&$u("Assign row counts do not match"),(t=t.reify()).columnNames((e=>r.add(e,t.column(e))))})),this.create(r.new())}columns(){return this._data}column(t){return this._data[t]}columnAt(t){return this._data[this._names[t]]}array(t,e=Array){const n=this.column(t),r=new e(this.numRows());let i=-1;return this.scan((t=>r[++i]=n.get(t)),!0),r}get(t,e=0){const n=this.column(t);return this.isFiltered()||this.isOrdered()?n.get(this.indices()[e]):n.get(e)}getter(t){const e=this.column(t),n=this.isFiltered()||this.isOrdered()?this.indices():null;return n?t=>e.get(n[t]):e?t=>e.get(t):$u(`Unrecognized column: ${t}`)}object(t=0){return zw(this)(t)}objects(t={}){const{grouped:e,limit:n,offset:r}=t,i=Th($w(this,t.columns||Bw())),o=[];if(this.scan(((t,e)=>o.push(i(t,e))),!0,n,r),e&&this.isGrouped()){const t=[];return this.scan((e=>t.push(e)),!0,n,r),function(t,e,n,r){const i="map"===r||!0===r?Bc:"entries"===r?Pc:"object"===r?Rc:$u('groups option must be "map", "entries", or "object".'),{names:o}=t.groups(),s=function(t,e){t=kc(t)?t:new Set(t);let n="_",r=0;for(;t.has(n);)n="_"+ ++r;return n}(t.columnNames());let a=t.select().reify(e).create({data:{[s]:n}}).rollup({[s]:Fc(s)});for(let t=o.length;--t>=0;)a=a.groupby(o.slice(0,t)).rollup({[s]:i(o[t],s)});return a.get(s)}(this,t,o,e)}return o}*[Symbol.iterator](){const t=zw(this),e=this.numRows();for(let n=0;n<e;++n)yield t(n)}reify(t){const e=t?t.length:this.numRows(),n=this._names;let r,i;if(!t&&!this.isOrdered()){if(!this.isFiltered())return this;e===this.totalRows()&&(r=this.data())}if(!r){const s=t?e=>t.forEach(e):t=>this.scan(t,!0),a=n.length;r={};for(let t=0;t<a;++t){const i=n[t],a=this.column(i),l=r[i]=new(Qu((o=a).data)?o.data.constructor:Array)(e);let u=-1;s((t=>l[++u]=a.get(t)))}this.isGrouped()&&(i=function(t,e,n,r){const{keys:i,rows:o,size:s}=t;let a=o,l=s,u=null;if(n){u=new Int32Array(s),e((t=>u[i[t]]=1));const t=u.reduce(((t,e)=>t+e),0);if(t!==s){a=Array(t),l=0;for(let t=0;t<s;++t)u[t]&&(a[u[t]=l++]=o[t])}}let c=-1;const h=new Uint32Array(r);return e(l!==s?t=>h[++c]=u[i[t]]:t=>h[++c]=i[t]),{...t,keys:h,rows:a,size:l}}(this.groups(),s,!!t,e))}var o;return this.create({data:r,names:n,groups:i,filter:null,order:null})}transform(...t){return t.flat().reduce(((t,e)=>e(t)),this)}toArrow(t){return Aw(this,t)}toArrowBuffer(t){return function(t,e={}){const{format:n,...r}=e;if(!["stream","file"].includes(n||"stream"))throw Error("Unrecognised output format");return function(t,e="stream"){return("stream"===e?vw:ww).writeAll(t).toUint8Array(!0)}(Ew(t,r),n)}(this,t)}toCSV(t){return function(t,e={}){const n=Cw(t,e.columns),r=e.format||{},i=e.delimiter||",",o=new RegExp(`["${i}\n\r]`),s=t=>null==t?"":ju(t)?lc(t,!0):o.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t,a=n.map(s);let l="";return Mw(t,n,e.limit||1/0,e.offset,{row(){l+=a.join(i)+"\n"},cell(t,e,n){a[n]=s(r[e]?r[e](t):t)}}),l+a.join(i)}(this,t)}toHTML(t){return function(t,e={}){const n=Cw(t,e.columns),{align:r,format:i}=Dw(t,n,e),o=function(t){return Tw(t.style,(t=>Lu(t)?t:()=>t))}(e),s=e.null,a=(t,e)=>Ow(t,e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),l=s?(t,e)=>null==t?s(t):a(t,e):a;let u=-1,c=-1;const h=(t,e,n)=>{const i=n?(t=>"c"===t?"center":"r"===t?"right":"left")(r[e]):"",s=o[t]&&o[t](e,c,u)||"",a=(i?`text-align: ${i};`+(s?" ":""):"")+s;return`<${t}${a?` style="${a}"`:""}>`};let f=h("table")+h("thead")+h("tr",u)+n.map((t=>`${h("th",t,1)}${t}</th>`)).join("")+"</tr></thead>"+h("tbody");return Mw(t,n,e.limit,e.offset,{row(t){u=t,f+=(++c?"</tr>":"")+h("tr")},cell(t,e){f+=h("td",e,1)+l(t,i[e])+"</td>"}}),f+"</tr></tbody></table>"}(this,t)}toJSON(t){return function(t,e={}){const n=function(t,e=!0,n=!1){return void 0===t||t?e:n}(e.schema),r=e.format||{},i=Cw(t,e.columns);let o="{";return n&&(o+='"schema":{"fields":'+JSON.stringify(i.map((t=>({name:t}))))+'},"data":{'),i.forEach(((n,i)=>{o+=(i?",":"")+JSON.stringify(n)+":[";const s=t.column(n),a=r[n]||Iw;let l=-1;t.scan((t=>{const e=s.get(t);o+=(++l?",":"")+JSON.stringify(a(e))}),!0,e.limit,e.offset),o+="]"})),o+"}"+(n?"}":"")}(this,t)}toMarkdown(t){return function(t,e={}){const n=Cw(t,e.columns),{align:r,format:i}=Dw(t,n,e),o=t=>t.replace(/\|/g,"\\|");let s="|"+n.map(o).join("|")+"|\n|"+n.map((t=>{return"c"===(e=r[t])?":-:":"r"===e?"-:":":-";var e})).join("|")+"|";return Mw(t,n,e.limit,e.offset,{row(){s+="\n|"},cell(t,e){s+=o(Ow(t,i[e]))+"|"}}),s+"\n"}(this,t)}}function zw(t){let e=t._builder;if(!e){const n=Th(t.columnNames()),r=t.data();if(t.isOrdered()||t.isFiltered()){const i=t.indices();e=t=>n(i[t],r)}else e=t=>n(t,r);t._builder=e}return e}class jw{constructor(t){this._outputs=t}size(){return this._outputs.length}outputs(){return this._outputs}init(){return{}}add(){}rem(){}write(){}}function Uw(t,e,n,r){const i=n[t.type]||n.Default;if(i&&!1===i(t,e,r))return;const o=Xw[t.type];o&&o(t,e,n)}const Vw=(t,e,n)=>{Uw(t.argument,e,n,t)},qw=(t,e,n)=>{Uw(t.left,e,n,t),Uw(t.right,e,n,t)},Ww=(t,e,n)=>{Uw(t.test,e,n,t),Uw(t.consequent,e,n,t),t.alternate&&Uw(t.alternate,e,n,t)},Hw=(t,e,n)=>{Yw(t.params,e,n,t),Uw(t.body,e,n,t)},Gw=(t,e,n)=>{Uw(t.callee,e,n,t),Yw(t.arguments,e,n,t)},Yw=(t,e,n,r)=>{t.forEach((t=>Uw(t,e,n,r)))},Xw={TemplateLiteral:(t,e,n)=>{Yw(t.expressions,e,n,t),Yw(t.quasis,e,n,t)},MemberExpression:(t,e,n)=>{Uw(t.object,e,n,t),Uw(t.property,e,n,t)},CallExpression:Gw,NewExpression:Gw,ArrayExpression:(t,e,n)=>{Yw(t.elements,e,n,t)},AssignmentExpression:qw,AwaitExpression:Vw,BinaryExpression:qw,LogicalExpression:qw,UnaryExpression:Vw,UpdateExpression:Vw,ConditionalExpression:Ww,ObjectExpression:(t,e,n)=>{Yw(t.properties,e,n,t)},Property:(t,e,n)=>{Uw(t.key,e,n,t),Uw(t.value,e,n,t)},ArrowFunctionExpression:Hw,FunctionExpression:Hw,FunctionDeclaration:Hw,VariableDeclaration:(t,e,n)=>{Yw(t.declarations,e,n,t)},VariableDeclarator:(t,e,n)=>{Uw(t.id,e,n,t),Uw(t.init,e,n,t)},SpreadElement:(t,e,n)=>{Uw(t.argument,e,n,t)},BlockStatement:(t,e,n)=>{Yw(t.body,e,n,t)},ExpressionStatement:(t,e,n)=>{Uw(t.expression,e,n,t)},IfStatement:Ww,ForStatement:(t,e,n)=>{Uw(t.init,e,n,t),Uw(t.test,e,n,t),Uw(t.update,e,n,t),Uw(t.body,e,n,t)},WhileStatement:(t,e,n)=>{Uw(t.test,e,n,t),Uw(t.body,e,n,t)},DoWhileStatement:(t,e,n)=>{Uw(t.body,e,n,t),Uw(t.test,e,n,t)},SwitchStatement:(t,e,n)=>{Uw(t.discriminant,e,n,t),Yw(t.cases,e,n,t)},SwitchCase:(t,e,n)=>{t.test&&Uw(t.test,e,n,t),Yw(t.consequent,e,n,t)},ReturnStatement:Vw,Program:(t,e,n)=>{Uw(t.body[0],e,n,t)}};function Jw(t){delete t.start,delete t.end,delete t.optional}function Kw(t){Jw(t),delete t.object,delete t.property,delete t.computed,t.table||delete t.table}function Qw(t,e){return e&&e.type===t}function Zw(t){return Lu(t)?t:()=>t}const tx="Escaped functions are not valid as rollup or pivot values.";function ex(t,e,n){t.aggronly&&$u(tx);const r="(row,data)=>fn("+Oh(t.table.columnNames())+",$)";return{escape:Sh.escape(r,Zw(e.expr),n)}}var nx=[509,0,227,0,150,4,294,9,1368,2,2,1,6,3,41,2,5,0,166,1,574,3,9,9,370,1,81,2,71,10,50,3,123,2,54,14,32,10,3,1,11,3,46,10,8,0,46,9,7,2,37,13,2,9,6,1,45,0,13,2,49,13,9,3,2,11,83,11,7,0,3,0,158,11,6,9,7,3,56,1,2,6,3,1,3,2,10,0,11,1,3,6,4,4,193,17,10,9,5,0,82,19,13,9,214,6,3,8,28,1,83,16,16,9,82,12,9,9,84,14,5,9,243,14,166,9,71,5,2,1,3,3,2,0,2,1,13,9,120,6,3,6,4,0,29,9,41,6,2,3,9,0,10,10,47,15,406,7,2,7,17,9,57,21,2,13,123,5,4,0,2,1,2,6,2,0,9,9,49,4,2,1,2,4,9,9,330,3,10,1,2,0,49,6,4,4,14,9,5351,0,7,14,13835,9,87,9,39,4,60,6,26,9,1014,0,2,54,8,3,82,0,12,1,19628,1,4706,45,3,22,543,4,4,5,9,7,3,6,31,3,149,2,1418,49,513,54,5,49,9,0,15,0,23,4,2,14,1361,6,2,16,3,6,2,1,2,4,101,0,161,6,10,9,357,0,62,13,499,13,983,6,110,6,6,9,4759,9,787719,239],rx=[0,11,2,25,2,18,2,1,2,14,3,13,35,122,70,52,268,28,4,48,48,31,14,29,6,37,11,29,3,35,5,7,2,4,43,157,19,35,5,35,5,39,9,51,13,10,2,14,2,6,2,1,2,10,2,14,2,6,2,1,68,310,10,21,11,7,25,5,2,41,2,8,70,5,3,0,2,43,2,1,4,0,3,22,11,22,10,30,66,18,2,1,11,21,11,25,71,55,7,1,65,0,16,3,2,2,2,28,43,28,4,28,36,7,2,27,28,53,11,21,11,18,14,17,111,72,56,50,14,50,14,35,349,41,7,1,79,28,11,0,9,21,43,17,47,20,28,22,13,52,58,1,3,0,14,44,33,24,27,35,30,0,3,0,9,34,4,0,13,47,15,3,22,0,2,0,36,17,2,24,20,1,64,6,2,0,2,3,2,14,2,9,8,46,39,7,3,1,3,21,2,6,2,1,2,4,4,0,19,0,13,4,159,52,19,3,21,2,31,47,21,1,2,0,185,46,42,3,37,47,21,0,60,42,14,0,72,26,38,6,186,43,117,63,32,7,3,0,3,7,2,1,2,23,16,0,2,0,95,7,3,38,17,0,2,0,29,0,11,39,8,0,22,0,12,45,20,0,19,72,264,8,2,36,18,0,50,29,113,6,2,1,2,37,22,0,26,5,2,1,2,31,15,0,328,18,16,0,2,12,2,33,125,0,80,921,103,110,18,195,2637,96,16,1071,18,5,4026,582,8634,568,8,30,18,78,18,29,19,47,17,3,32,20,6,18,689,63,129,74,6,0,67,12,65,1,2,0,29,6135,9,1237,43,8,8936,3,2,6,2,1,2,290,16,0,30,2,3,0,15,3,9,395,2309,106,6,12,4,8,8,9,5991,84,2,70,2,1,3,0,3,1,3,3,2,11,2,0,2,6,2,64,2,3,3,7,2,6,2,27,2,3,2,4,2,0,4,6,2,339,3,24,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,30,2,24,2,7,1845,30,7,5,262,61,147,44,11,6,17,0,322,29,19,43,485,27,757,6,2,3,2,1,2,14,2,196,60,67,8,0,1205,3,2,26,2,1,2,0,3,0,2,9,2,3,2,0,2,0,7,0,5,0,2,0,2,0,2,2,2,1,2,0,3,0,2,0,2,0,2,0,2,0,2,1,2,0,3,3,2,6,2,3,2,3,2,0,2,9,2,16,6,2,2,4,2,16,4421,42719,33,4153,7,221,3,5761,15,7472,16,621,2467,541,1507,4938,6,4191],ix="ÂªÂµÂºÃ€-Ã–Ã˜-Ã¶Ã¸-ËË†-Ë‘Ë -Ë¤Ë¬Ë®Í°-Í´Í¶Í·Íº-Í½Í¿Î†Îˆ-ÎŠÎŒÎŽ-Î¡Î£-ÏµÏ·-ÒÒŠ-Ô¯Ô±-Õ–Õ™Õ -Öˆ×-×ª×¯-×²Ø -ÙŠÙ®Ù¯Ù±-Û“Û•Û¥Û¦Û®Û¯Ûº-Û¼Û¿ÜÜ’-Ü¯Ý-Þ¥Þ±ßŠ-ßªß´ßµßºà €-à •à šà ¤à ¨à¡€-à¡˜à¡ -à¡ªà¡°-à¢‡à¢‰-à¢Žà¢ -à£‰à¤„-à¤¹à¤½à¥à¥˜-à¥¡à¥±-à¦€à¦…-à¦Œà¦à¦à¦“-à¦¨à¦ª-à¦°à¦²à¦¶-à¦¹à¦½à§Žà§œà§à§Ÿ-à§¡à§°à§±à§¼à¨…-à¨Šà¨à¨à¨“-à¨¨à¨ª-à¨°à¨²à¨³à¨µà¨¶à¨¸à¨¹à©™-à©œà©žà©²-à©´àª…-àªàª-àª‘àª“-àª¨àªª-àª°àª²àª³àªµ-àª¹àª½à«à« à«¡à«¹à¬…-à¬Œà¬à¬à¬“-à¬¨à¬ª-à¬°à¬²à¬³à¬µ-à¬¹à¬½à­œà­à­Ÿ-à­¡à­±à®ƒà®…-à®Šà®Ž-à®à®’-à®•à®™à®šà®œà®žà®Ÿà®£à®¤à®¨-à®ªà®®-à®¹à¯à°…-à°Œà°Ž-à°à°’-à°¨à°ª-à°¹à°½à±˜-à±šà±à± à±¡à²€à²…-à²Œà²Ž-à²à²’-à²¨à²ª-à²³à²µ-à²¹à²½à³à³žà³ à³¡à³±à³²à´„-à´Œà´Ž-à´à´’-à´ºà´½àµŽàµ”-àµ–àµŸ-àµ¡àµº-àµ¿à¶…-à¶–à¶š-à¶±à¶³-à¶»à¶½à·€-à·†à¸-à¸°à¸²à¸³à¹€-à¹†àºàº‚àº„àº†-àºŠàºŒ-àº£àº¥àº§-àº°àº²àº³àº½à»€-à»„à»†à»œ-à»Ÿà¼€à½€-à½‡à½‰-à½¬à¾ˆ-à¾Œá€€-á€ªá€¿á-á•áš-áá¡á¥á¦á®-á°áµ-á‚á‚Žá‚ -áƒ…áƒ‡áƒáƒ-áƒºáƒ¼-á‰ˆá‰Š-á‰á‰-á‰–á‰˜á‰š-á‰á‰ -áŠˆáŠŠ-áŠáŠ-áŠ°áŠ²-áŠµáŠ¸-áŠ¾á‹€á‹‚-á‹…á‹ˆ-á‹–á‹˜-áŒáŒ’-áŒ•áŒ˜-ášáŽ€-áŽáŽ -áµá¸-á½á-á™¬á™¯-á™¿áš-áššáš -á›ªá›®-á›¸áœ€-áœ‘áœŸ-áœ±á€-á‘á -á¬á®-á°áž€-áž³áŸ—áŸœá  -á¡¸á¢€-á¢¨á¢ªá¢°-á£µá¤€-á¤žá¥-á¥­á¥°-á¥´á¦€-á¦«á¦°-á§‰á¨€-á¨–á¨ -á©”áª§á¬…-á¬³á­…-á­Œá®ƒ-á® á®®á®¯á®º-á¯¥á°€-á°£á±-á±á±š-á±½á²€-á²ˆá²-á²ºá²½-á²¿á³©-á³¬á³®-á³³á³µá³¶á³ºá´€-á¶¿á¸€-á¼•á¼˜-á¼á¼ -á½…á½ˆ-á½á½-á½—á½™á½›á½á½Ÿ-á½½á¾€-á¾´á¾¶-á¾¼á¾¾á¿‚-á¿„á¿†-á¿Œá¿-á¿“á¿–-á¿›á¿ -á¿¬á¿²-á¿´á¿¶-á¿¼â±â¿â‚-â‚œâ„‚â„‡â„Š-â„“â„•â„˜-â„â„¤â„¦â„¨â„ª-â„¹â„¼-â„¿â……-â…‰â…Žâ… -â†ˆâ°€-â³¤â³«-â³®â³²â³³â´€-â´¥â´§â´­â´°-âµ§âµ¯â¶€-â¶–â¶ -â¶¦â¶¨-â¶®â¶°-â¶¶â¶¸-â¶¾â·€-â·†â·ˆ-â·Žâ·-â·–â·˜-â·žã€…-ã€‡ã€¡-ã€©ã€±-ã€µã€¸-ã€¼ã-ã‚–ã‚›-ã‚Ÿã‚¡-ãƒºãƒ¼-ãƒ¿ã„…-ã„¯ã„±-ã†Žã† -ã†¿ã‡°-ã‡¿ã€-ä¶¿ä¸€-ê’Œê“-ê“½ê”€-ê˜Œê˜-ê˜Ÿê˜ªê˜«ê™€-ê™®ê™¿-êšêš -ê›¯êœ—-êœŸêœ¢-êžˆêž‹-êŸŠêŸêŸ‘êŸ“êŸ•-êŸ™êŸ²-ê ê ƒ-ê …ê ‡-ê Šê Œ-ê ¢ê¡€-ê¡³ê¢‚-ê¢³ê£²-ê£·ê£»ê£½ê£¾ê¤Š-ê¤¥ê¤°-ê¥†ê¥ -ê¥¼ê¦„-ê¦²ê§ê§ -ê§¤ê§¦-ê§¯ê§º-ê§¾ê¨€-ê¨¨ê©€-ê©‚ê©„-ê©‹ê© -ê©¶ê©ºê©¾-êª¯êª±êªµêª¶êª¹-êª½ê«€ê«‚ê«›-ê«ê« -ê«ªê«²-ê«´ê¬-ê¬†ê¬‰-ê¬Žê¬‘-ê¬–ê¬ -ê¬¦ê¬¨-ê¬®ê¬°-ê­šê­œ-ê­©ê­°-ê¯¢ê°€-íž£íž°-íŸ†íŸ‹-íŸ»ï¤€-ï©­ï©°-ï«™ï¬€-ï¬†ï¬“-ï¬—ï¬ï¬Ÿ-ï¬¨ï¬ª-ï¬¶ï¬¸-ï¬¼ï¬¾ï­€ï­ï­ƒï­„ï­†-ï®±ï¯“-ï´½ïµ-ï¶ï¶’-ï·‡ï·°-ï·»ï¹°-ï¹´ï¹¶-ï»¼ï¼¡-ï¼ºï½-ï½šï½¦-ï¾¾ï¿‚-ï¿‡ï¿Š-ï¿ï¿’-ï¿—ï¿š-ï¿œ",ox={3:"abstract boolean byte char class double enum export extends final float goto implements import int interface long native package private protected public short static super synchronized throws transient volatile",5:"class enum extends super const export import",6:"enum",strict:"implements interface let package private protected public static yield",strictBind:"eval arguments"},sx="break case catch continue debugger default do else finally for function if return switch throw try var while with null true false instanceof typeof void delete new in this",ax={5:sx,"5module":sx+" export import",6:sx+" const class extends export import super"},lx=/^in(stanceof)?$/,ux=new RegExp("["+ix+"]"),cx=new RegExp("["+ix+"â€Œâ€Â·Ì€-Í¯Î‡Òƒ-Ò‡Ö‘-Ö½Ö¿××‚×„×…×‡Ø-ØšÙ‹-Ù©Ù°Û–-ÛœÛŸ-Û¤Û§Û¨Ûª-Û­Û°-Û¹Ü‘Ü°-ÝŠÞ¦-Þ°ß€-ß‰ß«-ß³ß½à –-à ™à ›-à £à ¥-à §à ©-à ­à¡™-à¡›à¢˜-à¢Ÿà£Š-à£¡à££-à¤ƒà¤º-à¤¼à¤¾-à¥à¥‘-à¥—à¥¢à¥£à¥¦-à¥¯à¦-à¦ƒà¦¼à¦¾-à§„à§‡à§ˆà§‹-à§à§—à§¢à§£à§¦-à§¯à§¾à¨-à¨ƒà¨¼à¨¾-à©‚à©‡à©ˆà©‹-à©à©‘à©¦-à©±à©µàª-àªƒàª¼àª¾-à«…à«‡-à«‰à«‹-à«à«¢à«£à«¦-à«¯à«º-à«¿à¬-à¬ƒà¬¼à¬¾-à­„à­‡à­ˆà­‹-à­à­•-à­—à­¢à­£à­¦-à­¯à®‚à®¾-à¯‚à¯†-à¯ˆà¯Š-à¯à¯—à¯¦-à¯¯à°€-à°„à°¼à°¾-à±„à±†-à±ˆà±Š-à±à±•à±–à±¢à±£à±¦-à±¯à²-à²ƒà²¼à²¾-à³„à³†-à³ˆà³Š-à³à³•à³–à³¢à³£à³¦-à³¯à³³à´€-à´ƒà´»à´¼à´¾-àµ„àµ†-àµˆàµŠ-àµàµ—àµ¢àµ£àµ¦-àµ¯à¶-à¶ƒà·Šà·-à·”à·–à·˜-à·Ÿà·¦-à·¯à·²à·³à¸±à¸´-à¸ºà¹‡-à¹Žà¹-à¹™àº±àº´-àº¼à»ˆ-à»Žà»-à»™à¼˜à¼™à¼ -à¼©à¼µà¼·à¼¹à¼¾à¼¿à½±-à¾„à¾†à¾‡à¾-à¾—à¾™-à¾¼à¿†á€«-á€¾á€-á‰á–-á™áž-á á¢-á¤á§-á­á±-á´á‚‚-á‚á‚-á‚á-áŸá©-á±áœ’-áœ•áœ²-áœ´á’á“á²á³áž´-áŸ“áŸáŸ -áŸ©á ‹-á á -á ™á¢©á¤ -á¤«á¤°-á¤»á¥†-á¥á§-á§šá¨—-á¨›á©•-á©žá© -á©¼á©¿-áª‰áª-áª™áª°-áª½áª¿-á«Žá¬€-á¬„á¬´-á­„á­-á­™á­«-á­³á®€-á®‚á®¡-á®­á®°-á®¹á¯¦-á¯³á°¤-á°·á±€-á±‰á±-á±™á³-á³’á³”-á³¨á³­á³´á³·-á³¹á·€-á·¿â€Œâ€â€¿â€â”âƒ-âƒœâƒ¡âƒ¥-âƒ°â³¯-â³±âµ¿â· -â·¿ã€ª-ã€¯ã‚™ã‚šãƒ»ê˜ -ê˜©ê™¯ê™´-ê™½êšžêšŸê›°ê›±ê ‚ê †ê ‹ê £-ê §ê ¬ê¢€ê¢ê¢´-ê£…ê£-ê£™ê£ -ê£±ê£¿-ê¤‰ê¤¦-ê¤­ê¥‡-ê¥“ê¦€-ê¦ƒê¦³-ê§€ê§-ê§™ê§¥ê§°-ê§¹ê¨©-ê¨¶ê©ƒê©Œê©ê©-ê©™ê©»-ê©½êª°êª²-êª´êª·êª¸êª¾êª¿ê«ê««-ê«¯ê«µê«¶ê¯£-ê¯ªê¯¬ê¯­ê¯°-ê¯¹ï¬žï¸€-ï¸ï¸ -ï¸¯ï¸³ï¸´ï¹-ï¹ï¼-ï¼™ï¼¿ï½¥]");function hx(t,e){for(var n=65536,r=0;r<e.length;r+=2){if((n+=e[r])>t)return!1;if((n+=e[r+1])>=t)return!0}return!1}function fx(t,e){return t<65?36===t:t<91||(t<97?95===t:t<123||(t<=65535?t>=170&&ux.test(String.fromCharCode(t)):!1!==e&&hx(t,rx)))}function dx(t,e){return t<48?36===t:t<58||!(t<65)&&(t<91||(t<97?95===t:t<123||(t<=65535?t>=170&&cx.test(String.fromCharCode(t)):!1!==e&&(hx(t,rx)||hx(t,nx)))))}var px=function(t,e){void 0===e&&(e={}),this.label=t,this.keyword=e.keyword,this.beforeExpr=!!e.beforeExpr,this.startsExpr=!!e.startsExpr,this.isLoop=!!e.isLoop,this.isAssign=!!e.isAssign,this.prefix=!!e.prefix,this.postfix=!!e.postfix,this.binop=e.binop||null,this.updateContext=null};function mx(t,e){return new px(t,{beforeExpr:!0,binop:e})}var gx={beforeExpr:!0},yx={startsExpr:!0},bx={};function vx(t,e){return void 0===e&&(e={}),e.keyword=t,bx[t]=new px(t,e)}var wx={num:new px("num",yx),regexp:new px("regexp",yx),string:new px("string",yx),name:new px("name",yx),privateId:new px("privateId",yx),eof:new px("eof"),bracketL:new px("[",{beforeExpr:!0,startsExpr:!0}),bracketR:new px("]"),braceL:new px("{",{beforeExpr:!0,startsExpr:!0}),braceR:new px("}"),parenL:new px("(",{beforeExpr:!0,startsExpr:!0}),parenR:new px(")"),comma:new px(",",gx),semi:new px(";",gx),colon:new px(":",gx),dot:new px("."),question:new px("?",gx),questionDot:new px("?."),arrow:new px("=>",gx),template:new px("template"),invalidTemplate:new px("invalidTemplate"),ellipsis:new px("...",gx),backQuote:new px("`",yx),dollarBraceL:new px("${",{beforeExpr:!0,startsExpr:!0}),eq:new px("=",{beforeExpr:!0,isAssign:!0}),assign:new px("_=",{beforeExpr:!0,isAssign:!0}),incDec:new px("++/--",{prefix:!0,postfix:!0,startsExpr:!0}),prefix:new px("!/~",{beforeExpr:!0,prefix:!0,startsExpr:!0}),logicalOR:mx("||",1),logicalAND:mx("&&",2),bitwiseOR:mx("|",3),bitwiseXOR:mx("^",4),bitwiseAND:mx("&",5),equality:mx("==/!=/===/!==",6),relational:mx("</>/<=/>=",7),bitShift:mx("<</>>/>>>",8),plusMin:new px("+/-",{beforeExpr:!0,binop:9,prefix:!0,startsExpr:!0}),modulo:mx("%",10),star:mx("*",10),slash:mx("/",10),starstar:new px("**",{beforeExpr:!0}),coalesce:mx("??",1),_break:vx("break"),_case:vx("case",gx),_catch:vx("catch"),_continue:vx("continue"),_debugger:vx("debugger"),_default:vx("default",gx),_do:vx("do",{isLoop:!0,beforeExpr:!0}),_else:vx("else",gx),_finally:vx("finally"),_for:vx("for",{isLoop:!0}),_function:vx("function",yx),_if:vx("if"),_return:vx("return",gx),_switch:vx("switch"),_throw:vx("throw",gx),_try:vx("try"),_var:vx("var"),_const:vx("const"),_while:vx("while",{isLoop:!0}),_with:vx("with"),_new:vx("new",{beforeExpr:!0,startsExpr:!0}),_this:vx("this",yx),_super:vx("super",yx),_class:vx("class",yx),_extends:vx("extends",gx),_export:vx("export"),_import:vx("import",yx),_null:vx("null",yx),_true:vx("true",yx),_false:vx("false",yx),_in:vx("in",{beforeExpr:!0,binop:7}),_instanceof:vx("instanceof",{beforeExpr:!0,binop:7}),_typeof:vx("typeof",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_void:vx("void",{beforeExpr:!0,prefix:!0,startsExpr:!0}),_delete:vx("delete",{beforeExpr:!0,prefix:!0,startsExpr:!0})},xx=/\r\n?|\n|\u2028|\u2029/,_x=new RegExp(xx.source,"g");function kx(t){return 10===t||13===t||8232===t||8233===t}function Sx(t,e,n){void 0===n&&(n=t.length);for(var r=e;r<n;r++){var i=t.charCodeAt(r);if(kx(i))return r<n-1&&13===i&&10===t.charCodeAt(r+1)?r+2:r+1}return-1}var Ex=/[\u1680\u2000-\u200a\u202f\u205f\u3000\ufeff]/,Ax=/(?:\s|\/\/.*|\/\*[^]*?\*\/)*/g,Cx=Object.prototype,Dx=Cx.hasOwnProperty,Mx=Cx.toString,Ox=Object.hasOwn||function(t,e){return Dx.call(t,e)},Tx=Array.isArray||function(t){return"[object Array]"===Mx.call(t)},Ix=Object.create(null);function Nx(t){return Ix[t]||(Ix[t]=new RegExp("^(?:"+t.replace(/ /g,"|")+")$"))}function $x(t){return t<=65535?String.fromCharCode(t):(t-=65536,String.fromCharCode(55296+(t>>10),56320+(1023&t)))}var Fx=/(?:[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])/,Lx=function(t,e){this.line=t,this.column=e};Lx.prototype.offset=function(t){return new Lx(this.line,this.column+t)};var Bx=function(t,e,n){this.start=e,this.end=n,null!==t.sourceFile&&(this.source=t.sourceFile)};function Rx(t,e){for(var n=1,r=0;;){var i=Sx(t,r,e);if(i<0)return new Lx(n,e-r);++n,r=i}}var Px={ecmaVersion:null,sourceType:"script",onInsertedSemicolon:null,onTrailingComma:null,allowReserved:null,allowReturnOutsideFunction:!1,allowImportExportEverywhere:!1,allowAwaitOutsideFunction:null,allowSuperOutsideMethod:null,allowHashBang:!1,checkPrivateFields:!0,locations:!1,onToken:null,onComment:null,ranges:!1,program:null,sourceFile:null,directSourceFile:null,preserveParens:!1},zx=!1;function jx(t,e){return 2|(t?4:0)|(e?8:0)}var Ux=function(t,e,n){this.options=t=function(t){var e={};for(var n in Px)e[n]=t&&Ox(t,n)?t[n]:Px[n];if("latest"===e.ecmaVersion?e.ecmaVersion=1e8:null==e.ecmaVersion?(!zx&&"object"==typeof console&&console.warn&&(zx=!0,console.warn("Since Acorn 8.0.0, options.ecmaVersion is required.\nDefaulting to 2020, but this will stop working in the future.")),e.ecmaVersion=11):e.ecmaVersion>=2015&&(e.ecmaVersion-=2009),null==e.allowReserved&&(e.allowReserved=e.ecmaVersion<5),t&&null!=t.allowHashBang||(e.allowHashBang=e.ecmaVersion>=14),Tx(e.onToken)){var r=e.onToken;e.onToken=function(t){return r.push(t)}}return Tx(e.onComment)&&(e.onComment=function(t,e){return function(n,r,i,o,s,a){var l={type:n?"Block":"Line",value:r,start:i,end:o};t.locations&&(l.loc=new Bx(this,s,a)),t.ranges&&(l.range=[i,o]),e.push(l)}}(e,e.onComment)),e}(t),this.sourceFile=t.sourceFile,this.keywords=Nx(ax[t.ecmaVersion>=6?6:"module"===t.sourceType?"5module":5]);var r="";!0!==t.allowReserved&&(r=ox[t.ecmaVersion>=6?6:5===t.ecmaVersion?5:3],"module"===t.sourceType&&(r+=" await")),this.reservedWords=Nx(r);var i=(r?r+" ":"")+ox.strict;this.reservedWordsStrict=Nx(i),this.reservedWordsStrictBind=Nx(i+" "+ox.strictBind),this.input=String(e),this.containsEsc=!1,n?(this.pos=n,this.lineStart=this.input.lastIndexOf("\n",n-1)+1,this.curLine=this.input.slice(0,this.lineStart).split(xx).length):(this.pos=this.lineStart=0,this.curLine=1),this.type=wx.eof,this.value=null,this.start=this.end=this.pos,this.startLoc=this.endLoc=this.curPosition(),this.lastTokEndLoc=this.lastTokStartLoc=null,this.lastTokStart=this.lastTokEnd=this.pos,this.context=this.initialContext(),this.exprAllowed=!0,this.inModule="module"===t.sourceType,this.strict=this.inModule||this.strictDirective(this.pos),this.potentialArrowAt=-1,this.potentialArrowInForAwait=!1,this.yieldPos=this.awaitPos=this.awaitIdentPos=0,this.labels=[],this.undefinedExports=Object.create(null),0===this.pos&&t.allowHashBang&&"#!"===this.input.slice(0,2)&&this.skipLineComment(2),this.scopeStack=[],this.enterScope(1),this.regexpState=null,this.privateNameStack=[]},Vx={inFunction:{configurable:!0},inGenerator:{configurable:!0},inAsync:{configurable:!0},canAwait:{configurable:!0},allowSuper:{configurable:!0},allowDirectSuper:{configurable:!0},treatFunctionsAsVar:{configurable:!0},allowNewDotTarget:{configurable:!0},inClassStaticBlock:{configurable:!0}};Ux.prototype.parse=function(){var t=this.options.program||this.startNode();return this.nextToken(),this.parseTopLevel(t)},Vx.inFunction.get=function(){return(2&this.currentVarScope().flags)>0},Vx.inGenerator.get=function(){return(8&this.currentVarScope().flags)>0&&!this.currentVarScope().inClassFieldInit},Vx.inAsync.get=function(){return(4&this.currentVarScope().flags)>0&&!this.currentVarScope().inClassFieldInit},Vx.canAwait.get=function(){for(var t=this.scopeStack.length-1;t>=0;t--){var e=this.scopeStack[t];if(e.inClassFieldInit||256&e.flags)return!1;if(2&e.flags)return(4&e.flags)>0}return this.inModule&&this.options.ecmaVersion>=13||this.options.allowAwaitOutsideFunction},Vx.allowSuper.get=function(){var t=this.currentThisScope(),e=t.flags,n=t.inClassFieldInit;return(64&e)>0||n||this.options.allowSuperOutsideMethod},Vx.allowDirectSuper.get=function(){return(128&this.currentThisScope().flags)>0},Vx.treatFunctionsAsVar.get=function(){return this.treatFunctionsAsVarInScope(this.currentScope())},Vx.allowNewDotTarget.get=function(){var t=this.currentThisScope(),e=t.flags,n=t.inClassFieldInit;return(258&e)>0||n},Vx.inClassStaticBlock.get=function(){return(256&this.currentVarScope().flags)>0},Ux.extend=function(){for(var t=[],e=arguments.length;e--;)t[e]=arguments[e];for(var n=this,r=0;r<t.length;r++)n=t[r](n);return n},Ux.parse=function(t,e){return new this(e,t).parse()},Ux.parseExpressionAt=function(t,e,n){var r=new this(n,t,e);return r.nextToken(),r.parseExpression()},Ux.tokenizer=function(t,e){return new this(e,t)},Object.defineProperties(Ux.prototype,Vx);var qx=Ux.prototype,Wx=/^(?:'((?:\\.|[^'\\])*?)'|"((?:\\.|[^"\\])*?)")/;qx.strictDirective=function(t){if(this.options.ecmaVersion<5)return!1;for(;;){Ax.lastIndex=t,t+=Ax.exec(this.input)[0].length;var e=Wx.exec(this.input.slice(t));if(!e)return!1;if("use strict"===(e[1]||e[2])){Ax.lastIndex=t+e[0].length;var n=Ax.exec(this.input),r=n.index+n[0].length,i=this.input.charAt(r);return";"===i||"}"===i||xx.test(n[0])&&!(/[(`.[+\-/*%<>=,?^&]/.test(i)||"!"===i&&"="===this.input.charAt(r+1))}t+=e[0].length,Ax.lastIndex=t,t+=Ax.exec(this.input)[0].length,";"===this.input[t]&&t++}},qx.eat=function(t){return this.type===t&&(this.next(),!0)},qx.isContextual=function(t){return this.type===wx.name&&this.value===t&&!this.containsEsc},qx.eatContextual=function(t){return!!this.isContextual(t)&&(this.next(),!0)},qx.expectContextual=function(t){this.eatContextual(t)||this.unexpected()},qx.canInsertSemicolon=function(){return this.type===wx.eof||this.type===wx.braceR||xx.test(this.input.slice(this.lastTokEnd,this.start))},qx.insertSemicolon=function(){if(this.canInsertSemicolon())return this.options.onInsertedSemicolon&&this.options.onInsertedSemicolon(this.lastTokEnd,this.lastTokEndLoc),!0},qx.semicolon=function(){this.eat(wx.semi)||this.insertSemicolon()||this.unexpected()},qx.afterTrailingComma=function(t,e){if(this.type===t)return this.options.onTrailingComma&&this.options.onTrailingComma(this.lastTokStart,this.lastTokStartLoc),e||this.next(),!0},qx.expect=function(t){this.eat(t)||this.unexpected()},qx.unexpected=function(t){this.raise(null!=t?t:this.start,"Unexpected token")};var Hx=function(){this.shorthandAssign=this.trailingComma=this.parenthesizedAssign=this.parenthesizedBind=this.doubleProto=-1};qx.checkPatternErrors=function(t,e){if(t){t.trailingComma>-1&&this.raiseRecoverable(t.trailingComma,"Comma is not permitted after the rest element");var n=e?t.parenthesizedAssign:t.parenthesizedBind;n>-1&&this.raiseRecoverable(n,e?"Assigning to rvalue":"Parenthesized pattern")}},qx.checkExpressionErrors=function(t,e){if(!t)return!1;var n=t.shorthandAssign,r=t.doubleProto;if(!e)return n>=0||r>=0;n>=0&&this.raise(n,"Shorthand property assignments are valid only in destructuring patterns"),r>=0&&this.raiseRecoverable(r,"Redefinition of __proto__ property")},qx.checkYieldAwaitInDefaultParams=function(){this.yieldPos&&(!this.awaitPos||this.yieldPos<this.awaitPos)&&this.raise(this.yieldPos,"Yield expression cannot be a default value"),this.awaitPos&&this.raise(this.awaitPos,"Await expression cannot be a default value")},qx.isSimpleAssignTarget=function(t){return"ParenthesizedExpression"===t.type?this.isSimpleAssignTarget(t.expression):"Identifier"===t.type||"MemberExpression"===t.type};var Gx=Ux.prototype;Gx.parseTopLevel=function(t){var e=Object.create(null);for(t.body||(t.body=[]);this.type!==wx.eof;){var n=this.parseStatement(null,!0,e);t.body.push(n)}if(this.inModule)for(var r=0,i=Object.keys(this.undefinedExports);r<i.length;r+=1){var o=i[r];this.raiseRecoverable(this.undefinedExports[o].start,"Export '"+o+"' is not defined")}return this.adaptDirectivePrologue(t.body),this.next(),t.sourceType=this.options.sourceType,this.finishNode(t,"Program")};var Yx={kind:"loop"},Xx={kind:"switch"};Gx.isLet=function(t){if(this.options.ecmaVersion<6||!this.isContextual("let"))return!1;Ax.lastIndex=this.pos;var e=Ax.exec(this.input),n=this.pos+e[0].length,r=this.input.charCodeAt(n);if(91===r||92===r)return!0;if(t)return!1;if(123===r||r>55295&&r<56320)return!0;if(fx(r,!0)){for(var i=n+1;dx(r=this.input.charCodeAt(i),!0);)++i;if(92===r||r>55295&&r<56320)return!0;var o=this.input.slice(n,i);if(!lx.test(o))return!0}return!1},Gx.isAsyncFunction=function(){if(this.options.ecmaVersion<8||!this.isContextual("async"))return!1;Ax.lastIndex=this.pos;var t,e=Ax.exec(this.input),n=this.pos+e[0].length;return!(xx.test(this.input.slice(this.pos,n))||"function"!==this.input.slice(n,n+8)||n+8!==this.input.length&&(dx(t=this.input.charCodeAt(n+8))||t>55295&&t<56320))},Gx.parseStatement=function(t,e,n){var r,i=this.type,o=this.startNode();switch(this.isLet(t)&&(i=wx._var,r="let"),i){case wx._break:case wx._continue:return this.parseBreakContinueStatement(o,i.keyword);case wx._debugger:return this.parseDebuggerStatement(o);case wx._do:return this.parseDoStatement(o);case wx._for:return this.parseForStatement(o);case wx._function:return t&&(this.strict||"if"!==t&&"label"!==t)&&this.options.ecmaVersion>=6&&this.unexpected(),this.parseFunctionStatement(o,!1,!t);case wx._class:return t&&this.unexpected(),this.parseClass(o,!0);case wx._if:return this.parseIfStatement(o);case wx._return:return this.parseReturnStatement(o);case wx._switch:return this.parseSwitchStatement(o);case wx._throw:return this.parseThrowStatement(o);case wx._try:return this.parseTryStatement(o);case wx._const:case wx._var:return r=r||this.value,t&&"var"!==r&&this.unexpected(),this.parseVarStatement(o,r);case wx._while:return this.parseWhileStatement(o);case wx._with:return this.parseWithStatement(o);case wx.braceL:return this.parseBlock(!0,o);case wx.semi:return this.parseEmptyStatement(o);case wx._export:case wx._import:if(this.options.ecmaVersion>10&&i===wx._import){Ax.lastIndex=this.pos;var s=Ax.exec(this.input),a=this.pos+s[0].length,l=this.input.charCodeAt(a);if(40===l||46===l)return this.parseExpressionStatement(o,this.parseExpression())}return this.options.allowImportExportEverywhere||(e||this.raise(this.start,"'import' and 'export' may only appear at the top level"),this.inModule||this.raise(this.start,"'import' and 'export' may appear only with 'sourceType: module'")),i===wx._import?this.parseImport(o):this.parseExport(o,n);default:if(this.isAsyncFunction())return t&&this.unexpected(),this.next(),this.parseFunctionStatement(o,!0,!t);var u=this.value,c=this.parseExpression();return i===wx.name&&"Identifier"===c.type&&this.eat(wx.colon)?this.parseLabeledStatement(o,u,c,t):this.parseExpressionStatement(o,c)}},Gx.parseBreakContinueStatement=function(t,e){var n="break"===e;this.next(),this.eat(wx.semi)||this.insertSemicolon()?t.label=null:this.type!==wx.name?this.unexpected():(t.label=this.parseIdent(),this.semicolon());for(var r=0;r<this.labels.length;++r){var i=this.labels[r];if(null==t.label||i.name===t.label.name){if(null!=i.kind&&(n||"loop"===i.kind))break;if(t.label&&n)break}}return r===this.labels.length&&this.raise(t.start,"Unsyntactic "+e),this.finishNode(t,n?"BreakStatement":"ContinueStatement")},Gx.parseDebuggerStatement=function(t){return this.next(),this.semicolon(),this.finishNode(t,"DebuggerStatement")},Gx.parseDoStatement=function(t){return this.next(),this.labels.push(Yx),t.body=this.parseStatement("do"),this.labels.pop(),this.expect(wx._while),t.test=this.parseParenExpression(),this.options.ecmaVersion>=6?this.eat(wx.semi):this.semicolon(),this.finishNode(t,"DoWhileStatement")},Gx.parseForStatement=function(t){this.next();var e=this.options.ecmaVersion>=9&&this.canAwait&&this.eatContextual("await")?this.lastTokStart:-1;if(this.labels.push(Yx),this.enterScope(0),this.expect(wx.parenL),this.type===wx.semi)return e>-1&&this.unexpected(e),this.parseFor(t,null);var n=this.isLet();if(this.type===wx._var||this.type===wx._const||n){var r=this.startNode(),i=n?"let":this.value;return this.next(),this.parseVar(r,!0,i),this.finishNode(r,"VariableDeclaration"),(this.type===wx._in||this.options.ecmaVersion>=6&&this.isContextual("of"))&&1===r.declarations.length?(this.options.ecmaVersion>=9&&(this.type===wx._in?e>-1&&this.unexpected(e):t.await=e>-1),this.parseForIn(t,r)):(e>-1&&this.unexpected(e),this.parseFor(t,r))}var o=this.isContextual("let"),s=!1,a=new Hx,l=this.parseExpression(!(e>-1)||"await",a);return this.type===wx._in||(s=this.options.ecmaVersion>=6&&this.isContextual("of"))?(this.options.ecmaVersion>=9&&(this.type===wx._in?e>-1&&this.unexpected(e):t.await=e>-1),o&&s&&this.raise(l.start,"The left-hand side of a for-of loop may not start with 'let'."),this.toAssignable(l,!1,a),this.checkLValPattern(l),this.parseForIn(t,l)):(this.checkExpressionErrors(a,!0),e>-1&&this.unexpected(e),this.parseFor(t,l))},Gx.parseFunctionStatement=function(t,e,n){return this.next(),this.parseFunction(t,Kx|(n?0:Qx),!1,e)},Gx.parseIfStatement=function(t){return this.next(),t.test=this.parseParenExpression(),t.consequent=this.parseStatement("if"),t.alternate=this.eat(wx._else)?this.parseStatement("if"):null,this.finishNode(t,"IfStatement")},Gx.parseReturnStatement=function(t){return this.inFunction||this.options.allowReturnOutsideFunction||this.raise(this.start,"'return' outside of function"),this.next(),this.eat(wx.semi)||this.insertSemicolon()?t.argument=null:(t.argument=this.parseExpression(),this.semicolon()),this.finishNode(t,"ReturnStatement")},Gx.parseSwitchStatement=function(t){var e;this.next(),t.discriminant=this.parseParenExpression(),t.cases=[],this.expect(wx.braceL),this.labels.push(Xx),this.enterScope(0);for(var n=!1;this.type!==wx.braceR;)if(this.type===wx._case||this.type===wx._default){var r=this.type===wx._case;e&&this.finishNode(e,"SwitchCase"),t.cases.push(e=this.startNode()),e.consequent=[],this.next(),r?e.test=this.parseExpression():(n&&this.raiseRecoverable(this.lastTokStart,"Multiple default clauses"),n=!0,e.test=null),this.expect(wx.colon)}else e||this.unexpected(),e.consequent.push(this.parseStatement(null));return this.exitScope(),e&&this.finishNode(e,"SwitchCase"),this.next(),this.labels.pop(),this.finishNode(t,"SwitchStatement")},Gx.parseThrowStatement=function(t){return this.next(),xx.test(this.input.slice(this.lastTokEnd,this.start))&&this.raise(this.lastTokEnd,"Illegal newline after throw"),t.argument=this.parseExpression(),this.semicolon(),this.finishNode(t,"ThrowStatement")};var Jx=[];Gx.parseCatchClauseParam=function(){var t=this.parseBindingAtom(),e="Identifier"===t.type;return this.enterScope(e?32:0),this.checkLValPattern(t,e?4:2),this.expect(wx.parenR),t},Gx.parseTryStatement=function(t){if(this.next(),t.block=this.parseBlock(),t.handler=null,this.type===wx._catch){var e=this.startNode();this.next(),this.eat(wx.parenL)?e.param=this.parseCatchClauseParam():(this.options.ecmaVersion<10&&this.unexpected(),e.param=null,this.enterScope(0)),e.body=this.parseBlock(!1),this.exitScope(),t.handler=this.finishNode(e,"CatchClause")}return t.finalizer=this.eat(wx._finally)?this.parseBlock():null,t.handler||t.finalizer||this.raise(t.start,"Missing catch or finally clause"),this.finishNode(t,"TryStatement")},Gx.parseVarStatement=function(t,e,n){return this.next(),this.parseVar(t,!1,e,n),this.semicolon(),this.finishNode(t,"VariableDeclaration")},Gx.parseWhileStatement=function(t){return this.next(),t.test=this.parseParenExpression(),this.labels.push(Yx),t.body=this.parseStatement("while"),this.labels.pop(),this.finishNode(t,"WhileStatement")},Gx.parseWithStatement=function(t){return this.strict&&this.raise(this.start,"'with' in strict mode"),this.next(),t.object=this.parseParenExpression(),t.body=this.parseStatement("with"),this.finishNode(t,"WithStatement")},Gx.parseEmptyStatement=function(t){return this.next(),this.finishNode(t,"EmptyStatement")},Gx.parseLabeledStatement=function(t,e,n,r){for(var i=0,o=this.labels;i<o.length;i+=1)o[i].name===e&&this.raise(n.start,"Label '"+e+"' is already declared");for(var s=this.type.isLoop?"loop":this.type===wx._switch?"switch":null,a=this.labels.length-1;a>=0;a--){var l=this.labels[a];if(l.statementStart!==t.start)break;l.statementStart=this.start,l.kind=s}return this.labels.push({name:e,kind:s,statementStart:this.start}),t.body=this.parseStatement(r?-1===r.indexOf("label")?r+"label":r:"label"),this.labels.pop(),t.label=n,this.finishNode(t,"LabeledStatement")},Gx.parseExpressionStatement=function(t,e){return t.expression=e,this.semicolon(),this.finishNode(t,"ExpressionStatement")},Gx.parseBlock=function(t,e,n){for(void 0===t&&(t=!0),void 0===e&&(e=this.startNode()),e.body=[],this.expect(wx.braceL),t&&this.enterScope(0);this.type!==wx.braceR;){var r=this.parseStatement(null);e.body.push(r)}return n&&(this.strict=!1),this.next(),t&&this.exitScope(),this.finishNode(e,"BlockStatement")},Gx.parseFor=function(t,e){return t.init=e,this.expect(wx.semi),t.test=this.type===wx.semi?null:this.parseExpression(),this.expect(wx.semi),t.update=this.type===wx.parenR?null:this.parseExpression(),this.expect(wx.parenR),t.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(t,"ForStatement")},Gx.parseForIn=function(t,e){var n=this.type===wx._in;return this.next(),"VariableDeclaration"===e.type&&null!=e.declarations[0].init&&(!n||this.options.ecmaVersion<8||this.strict||"var"!==e.kind||"Identifier"!==e.declarations[0].id.type)&&this.raise(e.start,(n?"for-in":"for-of")+" loop variable declaration may not have an initializer"),t.left=e,t.right=n?this.parseExpression():this.parseMaybeAssign(),this.expect(wx.parenR),t.body=this.parseStatement("for"),this.exitScope(),this.labels.pop(),this.finishNode(t,n?"ForInStatement":"ForOfStatement")},Gx.parseVar=function(t,e,n,r){for(t.declarations=[],t.kind=n;;){var i=this.startNode();if(this.parseVarId(i,n),this.eat(wx.eq)?i.init=this.parseMaybeAssign(e):r||"const"!==n||this.type===wx._in||this.options.ecmaVersion>=6&&this.isContextual("of")?r||"Identifier"===i.id.type||e&&(this.type===wx._in||this.isContextual("of"))?i.init=null:this.raise(this.lastTokEnd,"Complex binding patterns require an initialization value"):this.unexpected(),t.declarations.push(this.finishNode(i,"VariableDeclarator")),!this.eat(wx.comma))break}return t},Gx.parseVarId=function(t,e){t.id=this.parseBindingAtom(),this.checkLValPattern(t.id,"var"===e?1:2,!1)};var Kx=1,Qx=2;function Zx(t,e){var n=e.key.name,r=t[n],i="true";return"MethodDefinition"!==e.type||"get"!==e.kind&&"set"!==e.kind||(i=(e.static?"s":"i")+e.kind),"iget"===r&&"iset"===i||"iset"===r&&"iget"===i||"sget"===r&&"sset"===i||"sset"===r&&"sget"===i?(t[n]="true",!1):!!r||(t[n]=i,!1)}function t_(t,e){var n=t.computed,r=t.key;return!n&&("Identifier"===r.type&&r.name===e||"Literal"===r.type&&r.value===e)}Gx.parseFunction=function(t,e,n,r,i){this.initFunction(t),(this.options.ecmaVersion>=9||this.options.ecmaVersion>=6&&!r)&&(this.type===wx.star&&e&Qx&&this.unexpected(),t.generator=this.eat(wx.star)),this.options.ecmaVersion>=8&&(t.async=!!r),e&Kx&&(t.id=4&e&&this.type!==wx.name?null:this.parseIdent(),!t.id||e&Qx||this.checkLValSimple(t.id,this.strict||t.generator||t.async?this.treatFunctionsAsVar?1:2:3));var o=this.yieldPos,s=this.awaitPos,a=this.awaitIdentPos;return this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(jx(t.async,t.generator)),e&Kx||(t.id=this.type===wx.name?this.parseIdent():null),this.parseFunctionParams(t),this.parseFunctionBody(t,n,!1,i),this.yieldPos=o,this.awaitPos=s,this.awaitIdentPos=a,this.finishNode(t,e&Kx?"FunctionDeclaration":"FunctionExpression")},Gx.parseFunctionParams=function(t){this.expect(wx.parenL),t.params=this.parseBindingList(wx.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams()},Gx.parseClass=function(t,e){this.next();var n=this.strict;this.strict=!0,this.parseClassId(t,e),this.parseClassSuper(t);var r=this.enterClassBody(),i=this.startNode(),o=!1;for(i.body=[],this.expect(wx.braceL);this.type!==wx.braceR;){var s=this.parseClassElement(null!==t.superClass);s&&(i.body.push(s),"MethodDefinition"===s.type&&"constructor"===s.kind?(o&&this.raiseRecoverable(s.start,"Duplicate constructor in the same class"),o=!0):s.key&&"PrivateIdentifier"===s.key.type&&Zx(r,s)&&this.raiseRecoverable(s.key.start,"Identifier '#"+s.key.name+"' has already been declared"))}return this.strict=n,this.next(),t.body=this.finishNode(i,"ClassBody"),this.exitClassBody(),this.finishNode(t,e?"ClassDeclaration":"ClassExpression")},Gx.parseClassElement=function(t){if(this.eat(wx.semi))return null;var e=this.options.ecmaVersion,n=this.startNode(),r="",i=!1,o=!1,s="method",a=!1;if(this.eatContextual("static")){if(e>=13&&this.eat(wx.braceL))return this.parseClassStaticBlock(n),n;this.isClassElementNameStart()||this.type===wx.star?a=!0:r="static"}if(n.static=a,!r&&e>=8&&this.eatContextual("async")&&(!this.isClassElementNameStart()&&this.type!==wx.star||this.canInsertSemicolon()?r="async":o=!0),!r&&(e>=9||!o)&&this.eat(wx.star)&&(i=!0),!r&&!o&&!i){var l=this.value;(this.eatContextual("get")||this.eatContextual("set"))&&(this.isClassElementNameStart()?s=l:r=l)}if(r?(n.computed=!1,n.key=this.startNodeAt(this.lastTokStart,this.lastTokStartLoc),n.key.name=r,this.finishNode(n.key,"Identifier")):this.parseClassElementName(n),e<13||this.type===wx.parenL||"method"!==s||i||o){var u=!n.static&&t_(n,"constructor"),c=u&&t;u&&"method"!==s&&this.raise(n.key.start,"Constructor can't have get/set modifier"),n.kind=u?"constructor":s,this.parseClassMethod(n,i,o,c)}else this.parseClassField(n);return n},Gx.isClassElementNameStart=function(){return this.type===wx.name||this.type===wx.privateId||this.type===wx.num||this.type===wx.string||this.type===wx.bracketL||this.type.keyword},Gx.parseClassElementName=function(t){this.type===wx.privateId?("constructor"===this.value&&this.raise(this.start,"Classes can't have an element named '#constructor'"),t.computed=!1,t.key=this.parsePrivateIdent()):this.parsePropertyName(t)},Gx.parseClassMethod=function(t,e,n,r){var i=t.key;"constructor"===t.kind?(e&&this.raise(i.start,"Constructor can't be a generator"),n&&this.raise(i.start,"Constructor can't be an async method")):t.static&&t_(t,"prototype")&&this.raise(i.start,"Classes may not have a static property named prototype");var o=t.value=this.parseMethod(e,n,r);return"get"===t.kind&&0!==o.params.length&&this.raiseRecoverable(o.start,"getter should have no params"),"set"===t.kind&&1!==o.params.length&&this.raiseRecoverable(o.start,"setter should have exactly one param"),"set"===t.kind&&"RestElement"===o.params[0].type&&this.raiseRecoverable(o.params[0].start,"Setter cannot use rest params"),this.finishNode(t,"MethodDefinition")},Gx.parseClassField=function(t){if(t_(t,"constructor")?this.raise(t.key.start,"Classes can't have a field named 'constructor'"):t.static&&t_(t,"prototype")&&this.raise(t.key.start,"Classes can't have a static field named 'prototype'"),this.eat(wx.eq)){var e=this.currentThisScope(),n=e.inClassFieldInit;e.inClassFieldInit=!0,t.value=this.parseMaybeAssign(),e.inClassFieldInit=n}else t.value=null;return this.semicolon(),this.finishNode(t,"PropertyDefinition")},Gx.parseClassStaticBlock=function(t){t.body=[];var e=this.labels;for(this.labels=[],this.enterScope(320);this.type!==wx.braceR;){var n=this.parseStatement(null);t.body.push(n)}return this.next(),this.exitScope(),this.labels=e,this.finishNode(t,"StaticBlock")},Gx.parseClassId=function(t,e){this.type===wx.name?(t.id=this.parseIdent(),e&&this.checkLValSimple(t.id,2,!1)):(!0===e&&this.unexpected(),t.id=null)},Gx.parseClassSuper=function(t){t.superClass=this.eat(wx._extends)?this.parseExprSubscripts(null,!1):null},Gx.enterClassBody=function(){var t={declared:Object.create(null),used:[]};return this.privateNameStack.push(t),t.declared},Gx.exitClassBody=function(){var t=this.privateNameStack.pop(),e=t.declared,n=t.used;if(this.options.checkPrivateFields)for(var r=this.privateNameStack.length,i=0===r?null:this.privateNameStack[r-1],o=0;o<n.length;++o){var s=n[o];Ox(e,s.name)||(i?i.used.push(s):this.raiseRecoverable(s.start,"Private field '#"+s.name+"' must be declared in an enclosing class"))}},Gx.parseExportAllDeclaration=function(t,e){return this.options.ecmaVersion>=11&&(this.eatContextual("as")?(t.exported=this.parseModuleExportName(),this.checkExport(e,t.exported,this.lastTokStart)):t.exported=null),this.expectContextual("from"),this.type!==wx.string&&this.unexpected(),t.source=this.parseExprAtom(),this.semicolon(),this.finishNode(t,"ExportAllDeclaration")},Gx.parseExport=function(t,e){if(this.next(),this.eat(wx.star))return this.parseExportAllDeclaration(t,e);if(this.eat(wx._default))return this.checkExport(e,"default",this.lastTokStart),t.declaration=this.parseExportDefaultDeclaration(),this.finishNode(t,"ExportDefaultDeclaration");if(this.shouldParseExportStatement())t.declaration=this.parseExportDeclaration(t),"VariableDeclaration"===t.declaration.type?this.checkVariableExport(e,t.declaration.declarations):this.checkExport(e,t.declaration.id,t.declaration.id.start),t.specifiers=[],t.source=null;else{if(t.declaration=null,t.specifiers=this.parseExportSpecifiers(e),this.eatContextual("from"))this.type!==wx.string&&this.unexpected(),t.source=this.parseExprAtom();else{for(var n=0,r=t.specifiers;n<r.length;n+=1){var i=r[n];this.checkUnreserved(i.local),this.checkLocalExport(i.local),"Literal"===i.local.type&&this.raise(i.local.start,"A string literal cannot be used as an exported binding without `from`.")}t.source=null}this.semicolon()}return this.finishNode(t,"ExportNamedDeclaration")},Gx.parseExportDeclaration=function(t){return this.parseStatement(null)},Gx.parseExportDefaultDeclaration=function(){var t;if(this.type===wx._function||(t=this.isAsyncFunction())){var e=this.startNode();return this.next(),t&&this.next(),this.parseFunction(e,4|Kx,!1,t)}if(this.type===wx._class){var n=this.startNode();return this.parseClass(n,"nullableID")}var r=this.parseMaybeAssign();return this.semicolon(),r},Gx.checkExport=function(t,e,n){t&&("string"!=typeof e&&(e="Identifier"===e.type?e.name:e.value),Ox(t,e)&&this.raiseRecoverable(n,"Duplicate export '"+e+"'"),t[e]=!0)},Gx.checkPatternExport=function(t,e){var n=e.type;if("Identifier"===n)this.checkExport(t,e,e.start);else if("ObjectPattern"===n)for(var r=0,i=e.properties;r<i.length;r+=1){var o=i[r];this.checkPatternExport(t,o)}else if("ArrayPattern"===n)for(var s=0,a=e.elements;s<a.length;s+=1){var l=a[s];l&&this.checkPatternExport(t,l)}else"Property"===n?this.checkPatternExport(t,e.value):"AssignmentPattern"===n?this.checkPatternExport(t,e.left):"RestElement"===n&&this.checkPatternExport(t,e.argument)},Gx.checkVariableExport=function(t,e){if(t)for(var n=0,r=e;n<r.length;n+=1){var i=r[n];this.checkPatternExport(t,i.id)}},Gx.shouldParseExportStatement=function(){return"var"===this.type.keyword||"const"===this.type.keyword||"class"===this.type.keyword||"function"===this.type.keyword||this.isLet()||this.isAsyncFunction()},Gx.parseExportSpecifier=function(t){var e=this.startNode();return e.local=this.parseModuleExportName(),e.exported=this.eatContextual("as")?this.parseModuleExportName():e.local,this.checkExport(t,e.exported,e.exported.start),this.finishNode(e,"ExportSpecifier")},Gx.parseExportSpecifiers=function(t){var e=[],n=!0;for(this.expect(wx.braceL);!this.eat(wx.braceR);){if(n)n=!1;else if(this.expect(wx.comma),this.afterTrailingComma(wx.braceR))break;e.push(this.parseExportSpecifier(t))}return e},Gx.parseImport=function(t){return this.next(),this.type===wx.string?(t.specifiers=Jx,t.source=this.parseExprAtom()):(t.specifiers=this.parseImportSpecifiers(),this.expectContextual("from"),t.source=this.type===wx.string?this.parseExprAtom():this.unexpected()),this.semicolon(),this.finishNode(t,"ImportDeclaration")},Gx.parseImportSpecifier=function(){var t=this.startNode();return t.imported=this.parseModuleExportName(),this.eatContextual("as")?t.local=this.parseIdent():(this.checkUnreserved(t.imported),t.local=t.imported),this.checkLValSimple(t.local,2),this.finishNode(t,"ImportSpecifier")},Gx.parseImportDefaultSpecifier=function(){var t=this.startNode();return t.local=this.parseIdent(),this.checkLValSimple(t.local,2),this.finishNode(t,"ImportDefaultSpecifier")},Gx.parseImportNamespaceSpecifier=function(){var t=this.startNode();return this.next(),this.expectContextual("as"),t.local=this.parseIdent(),this.checkLValSimple(t.local,2),this.finishNode(t,"ImportNamespaceSpecifier")},Gx.parseImportSpecifiers=function(){var t=[],e=!0;if(this.type===wx.name&&(t.push(this.parseImportDefaultSpecifier()),!this.eat(wx.comma)))return t;if(this.type===wx.star)return t.push(this.parseImportNamespaceSpecifier()),t;for(this.expect(wx.braceL);!this.eat(wx.braceR);){if(e)e=!1;else if(this.expect(wx.comma),this.afterTrailingComma(wx.braceR))break;t.push(this.parseImportSpecifier())}return t},Gx.parseModuleExportName=function(){if(this.options.ecmaVersion>=13&&this.type===wx.string){var t=this.parseLiteral(this.value);return Fx.test(t.value)&&this.raise(t.start,"An export name cannot include a lone surrogate."),t}return this.parseIdent(!0)},Gx.adaptDirectivePrologue=function(t){for(var e=0;e<t.length&&this.isDirectiveCandidate(t[e]);++e)t[e].directive=t[e].expression.raw.slice(1,-1)},Gx.isDirectiveCandidate=function(t){return this.options.ecmaVersion>=5&&"ExpressionStatement"===t.type&&"Literal"===t.expression.type&&"string"==typeof t.expression.value&&('"'===this.input[t.start]||"'"===this.input[t.start])};var e_=Ux.prototype;e_.toAssignable=function(t,e,n){if(this.options.ecmaVersion>=6&&t)switch(t.type){case"Identifier":this.inAsync&&"await"===t.name&&this.raise(t.start,"Cannot use 'await' as identifier inside an async function");break;case"ObjectPattern":case"ArrayPattern":case"AssignmentPattern":case"RestElement":break;case"ObjectExpression":t.type="ObjectPattern",n&&this.checkPatternErrors(n,!0);for(var r=0,i=t.properties;r<i.length;r+=1){var o=i[r];this.toAssignable(o,e),"RestElement"!==o.type||"ArrayPattern"!==o.argument.type&&"ObjectPattern"!==o.argument.type||this.raise(o.argument.start,"Unexpected token")}break;case"Property":"init"!==t.kind&&this.raise(t.key.start,"Object pattern can't contain getter or setter"),this.toAssignable(t.value,e);break;case"ArrayExpression":t.type="ArrayPattern",n&&this.checkPatternErrors(n,!0),this.toAssignableList(t.elements,e);break;case"SpreadElement":t.type="RestElement",this.toAssignable(t.argument,e),"AssignmentPattern"===t.argument.type&&this.raise(t.argument.start,"Rest elements cannot have a default value");break;case"AssignmentExpression":"="!==t.operator&&this.raise(t.left.end,"Only '=' operator can be used for specifying default value."),t.type="AssignmentPattern",delete t.operator,this.toAssignable(t.left,e);break;case"ParenthesizedExpression":this.toAssignable(t.expression,e,n);break;case"ChainExpression":this.raiseRecoverable(t.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":if(!e)break;default:this.raise(t.start,"Assigning to rvalue")}else n&&this.checkPatternErrors(n,!0);return t},e_.toAssignableList=function(t,e){for(var n=t.length,r=0;r<n;r++){var i=t[r];i&&this.toAssignable(i,e)}if(n){var o=t[n-1];6===this.options.ecmaVersion&&e&&o&&"RestElement"===o.type&&"Identifier"!==o.argument.type&&this.unexpected(o.argument.start)}return t},e_.parseSpread=function(t){var e=this.startNode();return this.next(),e.argument=this.parseMaybeAssign(!1,t),this.finishNode(e,"SpreadElement")},e_.parseRestBinding=function(){var t=this.startNode();return this.next(),6===this.options.ecmaVersion&&this.type!==wx.name&&this.unexpected(),t.argument=this.parseBindingAtom(),this.finishNode(t,"RestElement")},e_.parseBindingAtom=function(){if(this.options.ecmaVersion>=6)switch(this.type){case wx.bracketL:var t=this.startNode();return this.next(),t.elements=this.parseBindingList(wx.bracketR,!0,!0),this.finishNode(t,"ArrayPattern");case wx.braceL:return this.parseObj(!0)}return this.parseIdent()},e_.parseBindingList=function(t,e,n,r){for(var i=[],o=!0;!this.eat(t);)if(o?o=!1:this.expect(wx.comma),e&&this.type===wx.comma)i.push(null);else{if(n&&this.afterTrailingComma(t))break;if(this.type===wx.ellipsis){var s=this.parseRestBinding();this.parseBindingListItem(s),i.push(s),this.type===wx.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.expect(t);break}i.push(this.parseAssignableListItem(r))}return i},e_.parseAssignableListItem=function(t){var e=this.parseMaybeDefault(this.start,this.startLoc);return this.parseBindingListItem(e),e},e_.parseBindingListItem=function(t){return t},e_.parseMaybeDefault=function(t,e,n){if(n=n||this.parseBindingAtom(),this.options.ecmaVersion<6||!this.eat(wx.eq))return n;var r=this.startNodeAt(t,e);return r.left=n,r.right=this.parseMaybeAssign(),this.finishNode(r,"AssignmentPattern")},e_.checkLValSimple=function(t,e,n){void 0===e&&(e=0);var r=0!==e;switch(t.type){case"Identifier":this.strict&&this.reservedWordsStrictBind.test(t.name)&&this.raiseRecoverable(t.start,(r?"Binding ":"Assigning to ")+t.name+" in strict mode"),r&&(2===e&&"let"===t.name&&this.raiseRecoverable(t.start,"let is disallowed as a lexically bound name"),n&&(Ox(n,t.name)&&this.raiseRecoverable(t.start,"Argument name clash"),n[t.name]=!0),5!==e&&this.declareName(t.name,e,t.start));break;case"ChainExpression":this.raiseRecoverable(t.start,"Optional chaining cannot appear in left-hand side");break;case"MemberExpression":r&&this.raiseRecoverable(t.start,"Binding member expression");break;case"ParenthesizedExpression":return r&&this.raiseRecoverable(t.start,"Binding parenthesized expression"),this.checkLValSimple(t.expression,e,n);default:this.raise(t.start,(r?"Binding":"Assigning to")+" rvalue")}},e_.checkLValPattern=function(t,e,n){switch(void 0===e&&(e=0),t.type){case"ObjectPattern":for(var r=0,i=t.properties;r<i.length;r+=1){var o=i[r];this.checkLValInnerPattern(o,e,n)}break;case"ArrayPattern":for(var s=0,a=t.elements;s<a.length;s+=1){var l=a[s];l&&this.checkLValInnerPattern(l,e,n)}break;default:this.checkLValSimple(t,e,n)}},e_.checkLValInnerPattern=function(t,e,n){switch(void 0===e&&(e=0),t.type){case"Property":this.checkLValInnerPattern(t.value,e,n);break;case"AssignmentPattern":this.checkLValPattern(t.left,e,n);break;case"RestElement":this.checkLValPattern(t.argument,e,n);break;default:this.checkLValPattern(t,e,n)}};var n_=function(t,e,n,r,i){this.token=t,this.isExpr=!!e,this.preserveSpace=!!n,this.override=r,this.generator=!!i},r_={b_stat:new n_("{",!1),b_expr:new n_("{",!0),b_tmpl:new n_("${",!1),p_stat:new n_("(",!1),p_expr:new n_("(",!0),q_tmpl:new n_("`",!0,!0,(function(t){return t.tryReadTemplateToken()})),f_stat:new n_("function",!1),f_expr:new n_("function",!0),f_expr_gen:new n_("function",!0,!1,null,!0),f_gen:new n_("function",!1,!1,null,!0)},i_=Ux.prototype;i_.initialContext=function(){return[r_.b_stat]},i_.curContext=function(){return this.context[this.context.length-1]},i_.braceIsBlock=function(t){var e=this.curContext();return e===r_.f_expr||e===r_.f_stat||(t!==wx.colon||e!==r_.b_stat&&e!==r_.b_expr?t===wx._return||t===wx.name&&this.exprAllowed?xx.test(this.input.slice(this.lastTokEnd,this.start)):t===wx._else||t===wx.semi||t===wx.eof||t===wx.parenR||t===wx.arrow||(t===wx.braceL?e===r_.b_stat:t!==wx._var&&t!==wx._const&&t!==wx.name&&!this.exprAllowed):!e.isExpr)},i_.inGeneratorContext=function(){for(var t=this.context.length-1;t>=1;t--){var e=this.context[t];if("function"===e.token)return e.generator}return!1},i_.updateContext=function(t){var e,n=this.type;n.keyword&&t===wx.dot?this.exprAllowed=!1:(e=n.updateContext)?e.call(this,t):this.exprAllowed=n.beforeExpr},i_.overrideContext=function(t){this.curContext()!==t&&(this.context[this.context.length-1]=t)},wx.parenR.updateContext=wx.braceR.updateContext=function(){if(1!==this.context.length){var t=this.context.pop();t===r_.b_stat&&"function"===this.curContext().token&&(t=this.context.pop()),this.exprAllowed=!t.isExpr}else this.exprAllowed=!0},wx.braceL.updateContext=function(t){this.context.push(this.braceIsBlock(t)?r_.b_stat:r_.b_expr),this.exprAllowed=!0},wx.dollarBraceL.updateContext=function(){this.context.push(r_.b_tmpl),this.exprAllowed=!0},wx.parenL.updateContext=function(t){var e=t===wx._if||t===wx._for||t===wx._with||t===wx._while;this.context.push(e?r_.p_stat:r_.p_expr),this.exprAllowed=!0},wx.incDec.updateContext=function(){},wx._function.updateContext=wx._class.updateContext=function(t){!t.beforeExpr||t===wx._else||t===wx.semi&&this.curContext()!==r_.p_stat||t===wx._return&&xx.test(this.input.slice(this.lastTokEnd,this.start))||(t===wx.colon||t===wx.braceL)&&this.curContext()===r_.b_stat?this.context.push(r_.f_stat):this.context.push(r_.f_expr),this.exprAllowed=!1},wx.colon.updateContext=function(){"function"===this.curContext().token&&this.context.pop(),this.exprAllowed=!0},wx.backQuote.updateContext=function(){this.curContext()===r_.q_tmpl?this.context.pop():this.context.push(r_.q_tmpl),this.exprAllowed=!1},wx.star.updateContext=function(t){if(t===wx._function){var e=this.context.length-1;this.context[e]===r_.f_expr?this.context[e]=r_.f_expr_gen:this.context[e]=r_.f_gen}this.exprAllowed=!0},wx.name.updateContext=function(t){var e=!1;this.options.ecmaVersion>=6&&t!==wx.dot&&("of"===this.value&&!this.exprAllowed||"yield"===this.value&&this.inGeneratorContext())&&(e=!0),this.exprAllowed=e};var o_=Ux.prototype;function s_(t){return"MemberExpression"===t.type&&"PrivateIdentifier"===t.property.type||"ChainExpression"===t.type&&s_(t.expression)}o_.checkPropClash=function(t,e,n){if(!(this.options.ecmaVersion>=9&&"SpreadElement"===t.type||this.options.ecmaVersion>=6&&(t.computed||t.method||t.shorthand))){var r,i=t.key;switch(i.type){case"Identifier":r=i.name;break;case"Literal":r=String(i.value);break;default:return}var o=t.kind;if(this.options.ecmaVersion>=6)"__proto__"===r&&"init"===o&&(e.proto&&(n?n.doubleProto<0&&(n.doubleProto=i.start):this.raiseRecoverable(i.start,"Redefinition of __proto__ property")),e.proto=!0);else{var s=e[r="$"+r];s?("init"===o?this.strict&&s.init||s.get||s.set:s.init||s[o])&&this.raiseRecoverable(i.start,"Redefinition of property"):s=e[r]={init:!1,get:!1,set:!1},s[o]=!0}}},o_.parseExpression=function(t,e){var n=this.start,r=this.startLoc,i=this.parseMaybeAssign(t,e);if(this.type===wx.comma){var o=this.startNodeAt(n,r);for(o.expressions=[i];this.eat(wx.comma);)o.expressions.push(this.parseMaybeAssign(t,e));return this.finishNode(o,"SequenceExpression")}return i},o_.parseMaybeAssign=function(t,e,n){if(this.isContextual("yield")){if(this.inGenerator)return this.parseYield(t);this.exprAllowed=!1}var r=!1,i=-1,o=-1,s=-1;e?(i=e.parenthesizedAssign,o=e.trailingComma,s=e.doubleProto,e.parenthesizedAssign=e.trailingComma=-1):(e=new Hx,r=!0);var a=this.start,l=this.startLoc;this.type!==wx.parenL&&this.type!==wx.name||(this.potentialArrowAt=this.start,this.potentialArrowInForAwait="await"===t);var u=this.parseMaybeConditional(t,e);if(n&&(u=n.call(this,u,a,l)),this.type.isAssign){var c=this.startNodeAt(a,l);return c.operator=this.value,this.type===wx.eq&&(u=this.toAssignable(u,!1,e)),r||(e.parenthesizedAssign=e.trailingComma=e.doubleProto=-1),e.shorthandAssign>=u.start&&(e.shorthandAssign=-1),this.type===wx.eq?this.checkLValPattern(u):this.checkLValSimple(u),c.left=u,this.next(),c.right=this.parseMaybeAssign(t),s>-1&&(e.doubleProto=s),this.finishNode(c,"AssignmentExpression")}return r&&this.checkExpressionErrors(e,!0),i>-1&&(e.parenthesizedAssign=i),o>-1&&(e.trailingComma=o),u},o_.parseMaybeConditional=function(t,e){var n=this.start,r=this.startLoc,i=this.parseExprOps(t,e);if(this.checkExpressionErrors(e))return i;if(this.eat(wx.question)){var o=this.startNodeAt(n,r);return o.test=i,o.consequent=this.parseMaybeAssign(),this.expect(wx.colon),o.alternate=this.parseMaybeAssign(t),this.finishNode(o,"ConditionalExpression")}return i},o_.parseExprOps=function(t,e){var n=this.start,r=this.startLoc,i=this.parseMaybeUnary(e,!1,!1,t);return this.checkExpressionErrors(e)||i.start===n&&"ArrowFunctionExpression"===i.type?i:this.parseExprOp(i,n,r,-1,t)},o_.parseExprOp=function(t,e,n,r,i){var o=this.type.binop;if(null!=o&&(!i||this.type!==wx._in)&&o>r){var s=this.type===wx.logicalOR||this.type===wx.logicalAND,a=this.type===wx.coalesce;a&&(o=wx.logicalAND.binop);var l=this.value;this.next();var u=this.start,c=this.startLoc,h=this.parseExprOp(this.parseMaybeUnary(null,!1,!1,i),u,c,o,i),f=this.buildBinary(e,n,t,h,l,s||a);return(s&&this.type===wx.coalesce||a&&(this.type===wx.logicalOR||this.type===wx.logicalAND))&&this.raiseRecoverable(this.start,"Logical expressions and coalesce expressions cannot be mixed. Wrap either by parentheses"),this.parseExprOp(f,e,n,r,i)}return t},o_.buildBinary=function(t,e,n,r,i,o){"PrivateIdentifier"===r.type&&this.raise(r.start,"Private identifier can only be left side of binary expression");var s=this.startNodeAt(t,e);return s.left=n,s.operator=i,s.right=r,this.finishNode(s,o?"LogicalExpression":"BinaryExpression")},o_.parseMaybeUnary=function(t,e,n,r){var i,o=this.start,s=this.startLoc;if(this.isContextual("await")&&this.canAwait)i=this.parseAwait(r),e=!0;else if(this.type.prefix){var a=this.startNode(),l=this.type===wx.incDec;a.operator=this.value,a.prefix=!0,this.next(),a.argument=this.parseMaybeUnary(null,!0,l,r),this.checkExpressionErrors(t,!0),l?this.checkLValSimple(a.argument):this.strict&&"delete"===a.operator&&"Identifier"===a.argument.type?this.raiseRecoverable(a.start,"Deleting local variable in strict mode"):"delete"===a.operator&&s_(a.argument)?this.raiseRecoverable(a.start,"Private fields can not be deleted"):e=!0,i=this.finishNode(a,l?"UpdateExpression":"UnaryExpression")}else if(e||this.type!==wx.privateId){if(i=this.parseExprSubscripts(t,r),this.checkExpressionErrors(t))return i;for(;this.type.postfix&&!this.canInsertSemicolon();){var u=this.startNodeAt(o,s);u.operator=this.value,u.prefix=!1,u.argument=i,this.checkLValSimple(i),this.next(),i=this.finishNode(u,"UpdateExpression")}}else(r||0===this.privateNameStack.length)&&this.options.checkPrivateFields&&this.unexpected(),i=this.parsePrivateIdent(),this.type!==wx._in&&this.unexpected();return n||!this.eat(wx.starstar)?i:e?void this.unexpected(this.lastTokStart):this.buildBinary(o,s,i,this.parseMaybeUnary(null,!1,!1,r),"**",!1)},o_.parseExprSubscripts=function(t,e){var n=this.start,r=this.startLoc,i=this.parseExprAtom(t,e);if("ArrowFunctionExpression"===i.type&&")"!==this.input.slice(this.lastTokStart,this.lastTokEnd))return i;var o=this.parseSubscripts(i,n,r,!1,e);return t&&"MemberExpression"===o.type&&(t.parenthesizedAssign>=o.start&&(t.parenthesizedAssign=-1),t.parenthesizedBind>=o.start&&(t.parenthesizedBind=-1),t.trailingComma>=o.start&&(t.trailingComma=-1)),o},o_.parseSubscripts=function(t,e,n,r,i){for(var o=this.options.ecmaVersion>=8&&"Identifier"===t.type&&"async"===t.name&&this.lastTokEnd===t.end&&!this.canInsertSemicolon()&&t.end-t.start==5&&this.potentialArrowAt===t.start,s=!1;;){var a=this.parseSubscript(t,e,n,r,o,s,i);if(a.optional&&(s=!0),a===t||"ArrowFunctionExpression"===a.type){if(s){var l=this.startNodeAt(e,n);l.expression=a,a=this.finishNode(l,"ChainExpression")}return a}t=a}},o_.shouldParseAsyncArrow=function(){return!this.canInsertSemicolon()&&this.eat(wx.arrow)},o_.parseSubscriptAsyncArrow=function(t,e,n,r){return this.parseArrowExpression(this.startNodeAt(t,e),n,!0,r)},o_.parseSubscript=function(t,e,n,r,i,o,s){var a=this.options.ecmaVersion>=11,l=a&&this.eat(wx.questionDot);r&&l&&this.raise(this.lastTokStart,"Optional chaining cannot appear in the callee of new expressions");var u=this.eat(wx.bracketL);if(u||l&&this.type!==wx.parenL&&this.type!==wx.backQuote||this.eat(wx.dot)){var c=this.startNodeAt(e,n);c.object=t,u?(c.property=this.parseExpression(),this.expect(wx.bracketR)):this.type===wx.privateId&&"Super"!==t.type?c.property=this.parsePrivateIdent():c.property=this.parseIdent("never"!==this.options.allowReserved),c.computed=!!u,a&&(c.optional=l),t=this.finishNode(c,"MemberExpression")}else if(!r&&this.eat(wx.parenL)){var h=new Hx,f=this.yieldPos,d=this.awaitPos,p=this.awaitIdentPos;this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0;var m=this.parseExprList(wx.parenR,this.options.ecmaVersion>=8,!1,h);if(i&&!l&&this.shouldParseAsyncArrow())return this.checkPatternErrors(h,!1),this.checkYieldAwaitInDefaultParams(),this.awaitIdentPos>0&&this.raise(this.awaitIdentPos,"Cannot use 'await' as identifier inside an async function"),this.yieldPos=f,this.awaitPos=d,this.awaitIdentPos=p,this.parseSubscriptAsyncArrow(e,n,m,s);this.checkExpressionErrors(h,!0),this.yieldPos=f||this.yieldPos,this.awaitPos=d||this.awaitPos,this.awaitIdentPos=p||this.awaitIdentPos;var g=this.startNodeAt(e,n);g.callee=t,g.arguments=m,a&&(g.optional=l),t=this.finishNode(g,"CallExpression")}else if(this.type===wx.backQuote){(l||o)&&this.raise(this.start,"Optional chaining cannot appear in the tag of tagged template expressions");var y=this.startNodeAt(e,n);y.tag=t,y.quasi=this.parseTemplate({isTagged:!0}),t=this.finishNode(y,"TaggedTemplateExpression")}return t},o_.parseExprAtom=function(t,e,n){this.type===wx.slash&&this.readRegexp();var r,i=this.potentialArrowAt===this.start;switch(this.type){case wx._super:return this.allowSuper||this.raise(this.start,"'super' keyword outside a method"),r=this.startNode(),this.next(),this.type!==wx.parenL||this.allowDirectSuper||this.raise(r.start,"super() call outside constructor of a subclass"),this.type!==wx.dot&&this.type!==wx.bracketL&&this.type!==wx.parenL&&this.unexpected(),this.finishNode(r,"Super");case wx._this:return r=this.startNode(),this.next(),this.finishNode(r,"ThisExpression");case wx.name:var o=this.start,s=this.startLoc,a=this.containsEsc,l=this.parseIdent(!1);if(this.options.ecmaVersion>=8&&!a&&"async"===l.name&&!this.canInsertSemicolon()&&this.eat(wx._function))return this.overrideContext(r_.f_expr),this.parseFunction(this.startNodeAt(o,s),0,!1,!0,e);if(i&&!this.canInsertSemicolon()){if(this.eat(wx.arrow))return this.parseArrowExpression(this.startNodeAt(o,s),[l],!1,e);if(this.options.ecmaVersion>=8&&"async"===l.name&&this.type===wx.name&&!a&&(!this.potentialArrowInForAwait||"of"!==this.value||this.containsEsc))return l=this.parseIdent(!1),!this.canInsertSemicolon()&&this.eat(wx.arrow)||this.unexpected(),this.parseArrowExpression(this.startNodeAt(o,s),[l],!0,e)}return l;case wx.regexp:var u=this.value;return(r=this.parseLiteral(u.value)).regex={pattern:u.pattern,flags:u.flags},r;case wx.num:case wx.string:return this.parseLiteral(this.value);case wx._null:case wx._true:case wx._false:return(r=this.startNode()).value=this.type===wx._null?null:this.type===wx._true,r.raw=this.type.keyword,this.next(),this.finishNode(r,"Literal");case wx.parenL:var c=this.start,h=this.parseParenAndDistinguishExpression(i,e);return t&&(t.parenthesizedAssign<0&&!this.isSimpleAssignTarget(h)&&(t.parenthesizedAssign=c),t.parenthesizedBind<0&&(t.parenthesizedBind=c)),h;case wx.bracketL:return r=this.startNode(),this.next(),r.elements=this.parseExprList(wx.bracketR,!0,!0,t),this.finishNode(r,"ArrayExpression");case wx.braceL:return this.overrideContext(r_.b_expr),this.parseObj(!1,t);case wx._function:return r=this.startNode(),this.next(),this.parseFunction(r,0);case wx._class:return this.parseClass(this.startNode(),!1);case wx._new:return this.parseNew();case wx.backQuote:return this.parseTemplate();case wx._import:return this.options.ecmaVersion>=11?this.parseExprImport(n):this.unexpected();default:return this.parseExprAtomDefault()}},o_.parseExprAtomDefault=function(){this.unexpected()},o_.parseExprImport=function(t){var e=this.startNode();if(this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword import"),this.next(),this.type===wx.parenL&&!t)return this.parseDynamicImport(e);if(this.type===wx.dot){var n=this.startNodeAt(e.start,e.loc&&e.loc.start);return n.name="import",e.meta=this.finishNode(n,"Identifier"),this.parseImportMeta(e)}this.unexpected()},o_.parseDynamicImport=function(t){if(this.next(),t.source=this.parseMaybeAssign(),!this.eat(wx.parenR)){var e=this.start;this.eat(wx.comma)&&this.eat(wx.parenR)?this.raiseRecoverable(e,"Trailing comma is not allowed in import()"):this.unexpected(e)}return this.finishNode(t,"ImportExpression")},o_.parseImportMeta=function(t){this.next();var e=this.containsEsc;return t.property=this.parseIdent(!0),"meta"!==t.property.name&&this.raiseRecoverable(t.property.start,"The only valid meta property for import is 'import.meta'"),e&&this.raiseRecoverable(t.start,"'import.meta' must not contain escaped characters"),"module"===this.options.sourceType||this.options.allowImportExportEverywhere||this.raiseRecoverable(t.start,"Cannot use 'import.meta' outside a module"),this.finishNode(t,"MetaProperty")},o_.parseLiteral=function(t){var e=this.startNode();return e.value=t,e.raw=this.input.slice(this.start,this.end),110===e.raw.charCodeAt(e.raw.length-1)&&(e.bigint=e.raw.slice(0,-1).replace(/_/g,"")),this.next(),this.finishNode(e,"Literal")},o_.parseParenExpression=function(){this.expect(wx.parenL);var t=this.parseExpression();return this.expect(wx.parenR),t},o_.shouldParseArrow=function(t){return!this.canInsertSemicolon()},o_.parseParenAndDistinguishExpression=function(t,e){var n,r=this.start,i=this.startLoc,o=this.options.ecmaVersion>=8;if(this.options.ecmaVersion>=6){this.next();var s,a=this.start,l=this.startLoc,u=[],c=!0,h=!1,f=new Hx,d=this.yieldPos,p=this.awaitPos;for(this.yieldPos=0,this.awaitPos=0;this.type!==wx.parenR;){if(c?c=!1:this.expect(wx.comma),o&&this.afterTrailingComma(wx.parenR,!0)){h=!0;break}if(this.type===wx.ellipsis){s=this.start,u.push(this.parseParenItem(this.parseRestBinding())),this.type===wx.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element");break}u.push(this.parseMaybeAssign(!1,f,this.parseParenItem))}var m=this.lastTokEnd,g=this.lastTokEndLoc;if(this.expect(wx.parenR),t&&this.shouldParseArrow(u)&&this.eat(wx.arrow))return this.checkPatternErrors(f,!1),this.checkYieldAwaitInDefaultParams(),this.yieldPos=d,this.awaitPos=p,this.parseParenArrowList(r,i,u,e);u.length&&!h||this.unexpected(this.lastTokStart),s&&this.unexpected(s),this.checkExpressionErrors(f,!0),this.yieldPos=d||this.yieldPos,this.awaitPos=p||this.awaitPos,u.length>1?((n=this.startNodeAt(a,l)).expressions=u,this.finishNodeAt(n,"SequenceExpression",m,g)):n=u[0]}else n=this.parseParenExpression();if(this.options.preserveParens){var y=this.startNodeAt(r,i);return y.expression=n,this.finishNode(y,"ParenthesizedExpression")}return n},o_.parseParenItem=function(t){return t},o_.parseParenArrowList=function(t,e,n,r){return this.parseArrowExpression(this.startNodeAt(t,e),n,!1,r)};var a_=[];o_.parseNew=function(){this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword new");var t=this.startNode();if(this.next(),this.options.ecmaVersion>=6&&this.type===wx.dot){var e=this.startNodeAt(t.start,t.loc&&t.loc.start);e.name="new",t.meta=this.finishNode(e,"Identifier"),this.next();var n=this.containsEsc;return t.property=this.parseIdent(!0),"target"!==t.property.name&&this.raiseRecoverable(t.property.start,"The only valid meta property for new is 'new.target'"),n&&this.raiseRecoverable(t.start,"'new.target' must not contain escaped characters"),this.allowNewDotTarget||this.raiseRecoverable(t.start,"'new.target' can only be used in functions and class static block"),this.finishNode(t,"MetaProperty")}var r=this.start,i=this.startLoc;return t.callee=this.parseSubscripts(this.parseExprAtom(null,!1,!0),r,i,!0,!1),this.eat(wx.parenL)?t.arguments=this.parseExprList(wx.parenR,this.options.ecmaVersion>=8,!1):t.arguments=a_,this.finishNode(t,"NewExpression")},o_.parseTemplateElement=function(t){var e=t.isTagged,n=this.startNode();return this.type===wx.invalidTemplate?(e||this.raiseRecoverable(this.start,"Bad escape sequence in untagged template literal"),n.value={raw:this.value,cooked:null}):n.value={raw:this.input.slice(this.start,this.end).replace(/\r\n?/g,"\n"),cooked:this.value},this.next(),n.tail=this.type===wx.backQuote,this.finishNode(n,"TemplateElement")},o_.parseTemplate=function(t){void 0===t&&(t={});var e=t.isTagged;void 0===e&&(e=!1);var n=this.startNode();this.next(),n.expressions=[];var r=this.parseTemplateElement({isTagged:e});for(n.quasis=[r];!r.tail;)this.type===wx.eof&&this.raise(this.pos,"Unterminated template literal"),this.expect(wx.dollarBraceL),n.expressions.push(this.parseExpression()),this.expect(wx.braceR),n.quasis.push(r=this.parseTemplateElement({isTagged:e}));return this.next(),this.finishNode(n,"TemplateLiteral")},o_.isAsyncProp=function(t){return!t.computed&&"Identifier"===t.key.type&&"async"===t.key.name&&(this.type===wx.name||this.type===wx.num||this.type===wx.string||this.type===wx.bracketL||this.type.keyword||this.options.ecmaVersion>=9&&this.type===wx.star)&&!xx.test(this.input.slice(this.lastTokEnd,this.start))},o_.parseObj=function(t,e){var n=this.startNode(),r=!0,i={};for(n.properties=[],this.next();!this.eat(wx.braceR);){if(r)r=!1;else if(this.expect(wx.comma),this.options.ecmaVersion>=5&&this.afterTrailingComma(wx.braceR))break;var o=this.parseProperty(t,e);t||this.checkPropClash(o,i,e),n.properties.push(o)}return this.finishNode(n,t?"ObjectPattern":"ObjectExpression")},o_.parseProperty=function(t,e){var n,r,i,o,s=this.startNode();if(this.options.ecmaVersion>=9&&this.eat(wx.ellipsis))return t?(s.argument=this.parseIdent(!1),this.type===wx.comma&&this.raiseRecoverable(this.start,"Comma is not permitted after the rest element"),this.finishNode(s,"RestElement")):(s.argument=this.parseMaybeAssign(!1,e),this.type===wx.comma&&e&&e.trailingComma<0&&(e.trailingComma=this.start),this.finishNode(s,"SpreadElement"));this.options.ecmaVersion>=6&&(s.method=!1,s.shorthand=!1,(t||e)&&(i=this.start,o=this.startLoc),t||(n=this.eat(wx.star)));var a=this.containsEsc;return this.parsePropertyName(s),!t&&!a&&this.options.ecmaVersion>=8&&!n&&this.isAsyncProp(s)?(r=!0,n=this.options.ecmaVersion>=9&&this.eat(wx.star),this.parsePropertyName(s)):r=!1,this.parsePropertyValue(s,t,n,r,i,o,e,a),this.finishNode(s,"Property")},o_.parseGetterSetter=function(t){t.kind=t.key.name,this.parsePropertyName(t),t.value=this.parseMethod(!1);var e="get"===t.kind?0:1;if(t.value.params.length!==e){var n=t.value.start;"get"===t.kind?this.raiseRecoverable(n,"getter should have no params"):this.raiseRecoverable(n,"setter should have exactly one param")}else"set"===t.kind&&"RestElement"===t.value.params[0].type&&this.raiseRecoverable(t.value.params[0].start,"Setter cannot use rest params")},o_.parsePropertyValue=function(t,e,n,r,i,o,s,a){(n||r)&&this.type===wx.colon&&this.unexpected(),this.eat(wx.colon)?(t.value=e?this.parseMaybeDefault(this.start,this.startLoc):this.parseMaybeAssign(!1,s),t.kind="init"):this.options.ecmaVersion>=6&&this.type===wx.parenL?(e&&this.unexpected(),t.kind="init",t.method=!0,t.value=this.parseMethod(n,r)):e||a||!(this.options.ecmaVersion>=5)||t.computed||"Identifier"!==t.key.type||"get"!==t.key.name&&"set"!==t.key.name||this.type===wx.comma||this.type===wx.braceR||this.type===wx.eq?this.options.ecmaVersion>=6&&!t.computed&&"Identifier"===t.key.type?((n||r)&&this.unexpected(),this.checkUnreserved(t.key),"await"!==t.key.name||this.awaitIdentPos||(this.awaitIdentPos=i),t.kind="init",e?t.value=this.parseMaybeDefault(i,o,this.copyNode(t.key)):this.type===wx.eq&&s?(s.shorthandAssign<0&&(s.shorthandAssign=this.start),t.value=this.parseMaybeDefault(i,o,this.copyNode(t.key))):t.value=this.copyNode(t.key),t.shorthand=!0):this.unexpected():((n||r)&&this.unexpected(),this.parseGetterSetter(t))},o_.parsePropertyName=function(t){if(this.options.ecmaVersion>=6){if(this.eat(wx.bracketL))return t.computed=!0,t.key=this.parseMaybeAssign(),this.expect(wx.bracketR),t.key;t.computed=!1}return t.key=this.type===wx.num||this.type===wx.string?this.parseExprAtom():this.parseIdent("never"!==this.options.allowReserved)},o_.initFunction=function(t){t.id=null,this.options.ecmaVersion>=6&&(t.generator=t.expression=!1),this.options.ecmaVersion>=8&&(t.async=!1)},o_.parseMethod=function(t,e,n){var r=this.startNode(),i=this.yieldPos,o=this.awaitPos,s=this.awaitIdentPos;return this.initFunction(r),this.options.ecmaVersion>=6&&(r.generator=t),this.options.ecmaVersion>=8&&(r.async=!!e),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,this.enterScope(64|jx(e,r.generator)|(n?128:0)),this.expect(wx.parenL),r.params=this.parseBindingList(wx.parenR,!1,this.options.ecmaVersion>=8),this.checkYieldAwaitInDefaultParams(),this.parseFunctionBody(r,!1,!0,!1),this.yieldPos=i,this.awaitPos=o,this.awaitIdentPos=s,this.finishNode(r,"FunctionExpression")},o_.parseArrowExpression=function(t,e,n,r){var i=this.yieldPos,o=this.awaitPos,s=this.awaitIdentPos;return this.enterScope(16|jx(n,!1)),this.initFunction(t),this.options.ecmaVersion>=8&&(t.async=!!n),this.yieldPos=0,this.awaitPos=0,this.awaitIdentPos=0,t.params=this.toAssignableList(e,!0),this.parseFunctionBody(t,!0,!1,r),this.yieldPos=i,this.awaitPos=o,this.awaitIdentPos=s,this.finishNode(t,"ArrowFunctionExpression")},o_.parseFunctionBody=function(t,e,n,r){var i=e&&this.type!==wx.braceL,o=this.strict,s=!1;if(i)t.body=this.parseMaybeAssign(r),t.expression=!0,this.checkParams(t,!1);else{var a=this.options.ecmaVersion>=7&&!this.isSimpleParamList(t.params);o&&!a||(s=this.strictDirective(this.end))&&a&&this.raiseRecoverable(t.start,"Illegal 'use strict' directive in function with non-simple parameter list");var l=this.labels;this.labels=[],s&&(this.strict=!0),this.checkParams(t,!o&&!s&&!e&&!n&&this.isSimpleParamList(t.params)),this.strict&&t.id&&this.checkLValSimple(t.id,5),t.body=this.parseBlock(!1,void 0,s&&!o),t.expression=!1,this.adaptDirectivePrologue(t.body.body),this.labels=l}this.exitScope()},o_.isSimpleParamList=function(t){for(var e=0,n=t;e<n.length;e+=1)if("Identifier"!==n[e].type)return!1;return!0},o_.checkParams=function(t,e){for(var n=Object.create(null),r=0,i=t.params;r<i.length;r+=1){var o=i[r];this.checkLValInnerPattern(o,1,e?null:n)}},o_.parseExprList=function(t,e,n,r){for(var i=[],o=!0;!this.eat(t);){if(o)o=!1;else if(this.expect(wx.comma),e&&this.afterTrailingComma(t))break;var s=void 0;n&&this.type===wx.comma?s=null:this.type===wx.ellipsis?(s=this.parseSpread(r),r&&this.type===wx.comma&&r.trailingComma<0&&(r.trailingComma=this.start)):s=this.parseMaybeAssign(!1,r),i.push(s)}return i},o_.checkUnreserved=function(t){var e=t.start,n=t.end,r=t.name;this.inGenerator&&"yield"===r&&this.raiseRecoverable(e,"Cannot use 'yield' as identifier inside a generator"),this.inAsync&&"await"===r&&this.raiseRecoverable(e,"Cannot use 'await' as identifier inside an async function"),this.currentThisScope().inClassFieldInit&&"arguments"===r&&this.raiseRecoverable(e,"Cannot use 'arguments' in class field initializer"),!this.inClassStaticBlock||"arguments"!==r&&"await"!==r||this.raise(e,"Cannot use "+r+" in class static initialization block"),this.keywords.test(r)&&this.raise(e,"Unexpected keyword '"+r+"'"),this.options.ecmaVersion<6&&-1!==this.input.slice(e,n).indexOf("\\")||(this.strict?this.reservedWordsStrict:this.reservedWords).test(r)&&(this.inAsync||"await"!==r||this.raiseRecoverable(e,"Cannot use keyword 'await' outside an async function"),this.raiseRecoverable(e,"The keyword '"+r+"' is reserved"))},o_.parseIdent=function(t){var e=this.parseIdentNode();return this.next(!!t),this.finishNode(e,"Identifier"),t||(this.checkUnreserved(e),"await"!==e.name||this.awaitIdentPos||(this.awaitIdentPos=e.start)),e},o_.parseIdentNode=function(){var t=this.startNode();return this.type===wx.name?t.name=this.value:this.type.keyword?(t.name=this.type.keyword,"class"!==t.name&&"function"!==t.name||this.lastTokEnd===this.lastTokStart+1&&46===this.input.charCodeAt(this.lastTokStart)||this.context.pop(),this.type=wx.name):this.unexpected(),t},o_.parsePrivateIdent=function(){var t=this.startNode();return this.type===wx.privateId?t.name=this.value:this.unexpected(),this.next(),this.finishNode(t,"PrivateIdentifier"),this.options.checkPrivateFields&&(0===this.privateNameStack.length?this.raise(t.start,"Private field '#"+t.name+"' must be declared in an enclosing class"):this.privateNameStack[this.privateNameStack.length-1].used.push(t)),t},o_.parseYield=function(t){this.yieldPos||(this.yieldPos=this.start);var e=this.startNode();return this.next(),this.type===wx.semi||this.canInsertSemicolon()||this.type!==wx.star&&!this.type.startsExpr?(e.delegate=!1,e.argument=null):(e.delegate=this.eat(wx.star),e.argument=this.parseMaybeAssign(t)),this.finishNode(e,"YieldExpression")},o_.parseAwait=function(t){this.awaitPos||(this.awaitPos=this.start);var e=this.startNode();return this.next(),e.argument=this.parseMaybeUnary(null,!0,!1,t),this.finishNode(e,"AwaitExpression")};var l_=Ux.prototype;l_.raise=function(t,e){var n=Rx(this.input,t);e+=" ("+n.line+":"+n.column+")";var r=new SyntaxError(e);throw r.pos=t,r.loc=n,r.raisedAt=this.pos,r},l_.raiseRecoverable=l_.raise,l_.curPosition=function(){if(this.options.locations)return new Lx(this.curLine,this.pos-this.lineStart)};var u_=Ux.prototype,c_=function(t){this.flags=t,this.var=[],this.lexical=[],this.functions=[],this.inClassFieldInit=!1};u_.enterScope=function(t){this.scopeStack.push(new c_(t))},u_.exitScope=function(){this.scopeStack.pop()},u_.treatFunctionsAsVarInScope=function(t){return 2&t.flags||!this.inModule&&1&t.flags},u_.declareName=function(t,e,n){var r=!1;if(2===e){var i=this.currentScope();r=i.lexical.indexOf(t)>-1||i.functions.indexOf(t)>-1||i.var.indexOf(t)>-1,i.lexical.push(t),this.inModule&&1&i.flags&&delete this.undefinedExports[t]}else if(4===e)this.currentScope().lexical.push(t);else if(3===e){var o=this.currentScope();r=this.treatFunctionsAsVar?o.lexical.indexOf(t)>-1:o.lexical.indexOf(t)>-1||o.var.indexOf(t)>-1,o.functions.push(t)}else for(var s=this.scopeStack.length-1;s>=0;--s){var a=this.scopeStack[s];if(a.lexical.indexOf(t)>-1&&!(32&a.flags&&a.lexical[0]===t)||!this.treatFunctionsAsVarInScope(a)&&a.functions.indexOf(t)>-1){r=!0;break}if(a.var.push(t),this.inModule&&1&a.flags&&delete this.undefinedExports[t],259&a.flags)break}r&&this.raiseRecoverable(n,"Identifier '"+t+"' has already been declared")},u_.checkLocalExport=function(t){-1===this.scopeStack[0].lexical.indexOf(t.name)&&-1===this.scopeStack[0].var.indexOf(t.name)&&(this.undefinedExports[t.name]=t)},u_.currentScope=function(){return this.scopeStack[this.scopeStack.length-1]},u_.currentVarScope=function(){for(var t=this.scopeStack.length-1;;t--){var e=this.scopeStack[t];if(259&e.flags)return e}},u_.currentThisScope=function(){for(var t=this.scopeStack.length-1;;t--){var e=this.scopeStack[t];if(259&e.flags&&!(16&e.flags))return e}};var h_=function(t,e,n){this.type="",this.start=e,this.end=0,t.options.locations&&(this.loc=new Bx(t,n)),t.options.directSourceFile&&(this.sourceFile=t.options.directSourceFile),t.options.ranges&&(this.range=[e,0])},f_=Ux.prototype;function d_(t,e,n,r){return t.type=e,t.end=n,this.options.locations&&(t.loc.end=r),this.options.ranges&&(t.range[1]=n),t}f_.startNode=function(){return new h_(this,this.start,this.startLoc)},f_.startNodeAt=function(t,e){return new h_(this,t,e)},f_.finishNode=function(t,e){return d_.call(this,t,e,this.lastTokEnd,this.lastTokEndLoc)},f_.finishNodeAt=function(t,e,n,r){return d_.call(this,t,e,n,r)},f_.copyNode=function(t){var e=new h_(this,t.start,this.startLoc);for(var n in t)e[n]=t[n];return e};var p_,m_,g_="ASCII ASCII_Hex_Digit AHex Alphabetic Alpha Any Assigned Bidi_Control Bidi_C Bidi_Mirrored Bidi_M Case_Ignorable CI Cased Changes_When_Casefolded CWCF Changes_When_Casemapped CWCM Changes_When_Lowercased CWL Changes_When_NFKC_Casefolded CWKCF Changes_When_Titlecased CWT Changes_When_Uppercased CWU Dash Default_Ignorable_Code_Point DI Deprecated Dep Diacritic Dia Emoji Emoji_Component Emoji_Modifier Emoji_Modifier_Base Emoji_Presentation Extender Ext Grapheme_Base Gr_Base Grapheme_Extend Gr_Ext Hex_Digit Hex IDS_Binary_Operator IDSB IDS_Trinary_Operator IDST ID_Continue IDC ID_Start IDS Ideographic Ideo Join_Control Join_C Logical_Order_Exception LOE Lowercase Lower Math Noncharacter_Code_Point NChar Pattern_Syntax Pat_Syn Pattern_White_Space Pat_WS Quotation_Mark QMark Radical Regional_Indicator RI Sentence_Terminal STerm Soft_Dotted SD Terminal_Punctuation Term Unified_Ideograph UIdeo Uppercase Upper Variation_Selector VS White_Space space XID_Continue XIDC XID_Start XIDS",y_=g_+" Extended_Pictographic",b_=y_+" EBase EComp EMod EPres ExtPict",v_={9:g_,10:y_,11:y_,12:b_,13:b_,14:b_},w_={9:"",10:"",11:"",12:"",13:"",14:"Basic_Emoji Emoji_Keycap_Sequence RGI_Emoji_Modifier_Sequence RGI_Emoji_Flag_Sequence RGI_Emoji_Tag_Sequence RGI_Emoji_ZWJ_Sequence RGI_Emoji"},x_="Cased_Letter LC Close_Punctuation Pe Connector_Punctuation Pc Control Cc cntrl Currency_Symbol Sc Dash_Punctuation Pd Decimal_Number Nd digit Enclosing_Mark Me Final_Punctuation Pf Format Cf Initial_Punctuation Pi Letter L Letter_Number Nl Line_Separator Zl Lowercase_Letter Ll Mark M Combining_Mark Math_Symbol Sm Modifier_Letter Lm Modifier_Symbol Sk Nonspacing_Mark Mn Number N Open_Punctuation Ps Other C Other_Letter Lo Other_Number No Other_Punctuation Po Other_Symbol So Paragraph_Separator Zp Private_Use Co Punctuation P punct Separator Z Space_Separator Zs Spacing_Mark Mc Surrogate Cs Symbol S Titlecase_Letter Lt Unassigned Cn Uppercase_Letter Lu",__="Adlam Adlm Ahom Anatolian_Hieroglyphs Hluw Arabic Arab Armenian Armn Avestan Avst Balinese Bali Bamum Bamu Bassa_Vah Bass Batak Batk Bengali Beng Bhaiksuki Bhks Bopomofo Bopo Brahmi Brah Braille Brai Buginese Bugi Buhid Buhd Canadian_Aboriginal Cans Carian Cari Caucasian_Albanian Aghb Chakma Cakm Cham Cham Cherokee Cher Common Zyyy Coptic Copt Qaac Cuneiform Xsux Cypriot Cprt Cyrillic Cyrl Deseret Dsrt Devanagari Deva Duployan Dupl Egyptian_Hieroglyphs Egyp Elbasan Elba Ethiopic Ethi Georgian Geor Glagolitic Glag Gothic Goth Grantha Gran Greek Grek Gujarati Gujr Gurmukhi Guru Han Hani Hangul Hang Hanunoo Hano Hatran Hatr Hebrew Hebr Hiragana Hira Imperial_Aramaic Armi Inherited Zinh Qaai Inscriptional_Pahlavi Phli Inscriptional_Parthian Prti Javanese Java Kaithi Kthi Kannada Knda Katakana Kana Kayah_Li Kali Kharoshthi Khar Khmer Khmr Khojki Khoj Khudawadi Sind Lao Laoo Latin Latn Lepcha Lepc Limbu Limb Linear_A Lina Linear_B Linb Lisu Lisu Lycian Lyci Lydian Lydi Mahajani Mahj Malayalam Mlym Mandaic Mand Manichaean Mani Marchen Marc Masaram_Gondi Gonm Meetei_Mayek Mtei Mende_Kikakui Mend Meroitic_Cursive Merc Meroitic_Hieroglyphs Mero Miao Plrd Modi Mongolian Mong Mro Mroo Multani Mult Myanmar Mymr Nabataean Nbat New_Tai_Lue Talu Newa Newa Nko Nkoo Nushu Nshu Ogham Ogam Ol_Chiki Olck Old_Hungarian Hung Old_Italic Ital Old_North_Arabian Narb Old_Permic Perm Old_Persian Xpeo Old_South_Arabian Sarb Old_Turkic Orkh Oriya Orya Osage Osge Osmanya Osma Pahawh_Hmong Hmng Palmyrene Palm Pau_Cin_Hau Pauc Phags_Pa Phag Phoenician Phnx Psalter_Pahlavi Phlp Rejang Rjng Runic Runr Samaritan Samr Saurashtra Saur Sharada Shrd Shavian Shaw Siddham Sidd SignWriting Sgnw Sinhala Sinh Sora_Sompeng Sora Soyombo Soyo Sundanese Sund Syloti_Nagri Sylo Syriac Syrc Tagalog Tglg Tagbanwa Tagb Tai_Le Tale Tai_Tham Lana Tai_Viet Tavt Takri Takr Tamil Taml Tangut Tang Telugu Telu Thaana Thaa Thai Thai Tibetan Tibt Tifinagh Tfng Tirhuta Tirh Ugaritic Ugar Vai Vaii Warang_Citi Wara Yi Yiii Zanabazar_Square Zanb",k_=__+" Dogra Dogr Gunjala_Gondi Gong Hanifi_Rohingya Rohg Makasar Maka Medefaidrin Medf Old_Sogdian Sogo Sogdian Sogd",S_=k_+" Elymaic Elym Nandinagari Nand Nyiakeng_Puachue_Hmong Hmnp Wancho Wcho",E_=S_+" Chorasmian Chrs Diak Dives_Akuru Khitan_Small_Script Kits Yezi Yezidi",A_=E_+" Cypro_Minoan Cpmn Old_Uyghur Ougr Tangsa Tnsa Toto Vithkuqi Vith",C_={9:__,10:k_,11:S_,12:E_,13:A_,14:A_+" Hrkt Katakana_Or_Hiragana Kawi Nag_Mundari Nagm Unknown Zzzz"},D_={};for(var M_=0,O_=[9,10,11,12,13,14];M_<O_.length;M_+=1)m_=void 0,(m_=D_[p_=O_[M_]]={binary:Nx(v_[p_]+" "+x_),binaryOfStrings:Nx(w_[p_]),nonBinary:{General_Category:Nx(x_),Script:Nx(C_[p_])}}).nonBinary.Script_Extensions=m_.nonBinary.Script,m_.nonBinary.gc=m_.nonBinary.General_Category,m_.nonBinary.sc=m_.nonBinary.Script,m_.nonBinary.scx=m_.nonBinary.Script_Extensions;var T_=Ux.prototype,I_=function(t){this.parser=t,this.validFlags="gim"+(t.options.ecmaVersion>=6?"uy":"")+(t.options.ecmaVersion>=9?"s":"")+(t.options.ecmaVersion>=13?"d":"")+(t.options.ecmaVersion>=15?"v":""),this.unicodeProperties=D_[t.options.ecmaVersion>=14?14:t.options.ecmaVersion],this.source="",this.flags="",this.start=0,this.switchU=!1,this.switchV=!1,this.switchN=!1,this.pos=0,this.lastIntValue=0,this.lastStringValue="",this.lastAssertionIsQuantifiable=!1,this.numCapturingParens=0,this.maxBackReference=0,this.groupNames=[],this.backReferenceNames=[]};function N_(t){return 36===t||t>=40&&t<=43||46===t||63===t||t>=91&&t<=94||t>=123&&t<=125}function $_(t){return t>=65&&t<=90||t>=97&&t<=122}function F_(t){return $_(t)||95===t}function L_(t){return F_(t)||B_(t)}function B_(t){return t>=48&&t<=57}function R_(t){return t>=48&&t<=57||t>=65&&t<=70||t>=97&&t<=102}function P_(t){return t>=65&&t<=70?t-65+10:t>=97&&t<=102?t-97+10:t-48}function z_(t){return t>=48&&t<=55}I_.prototype.reset=function(t,e,n){var r=-1!==n.indexOf("v"),i=-1!==n.indexOf("u");this.start=0|t,this.source=e+"",this.flags=n,r&&this.parser.options.ecmaVersion>=15?(this.switchU=!0,this.switchV=!0,this.switchN=!0):(this.switchU=i&&this.parser.options.ecmaVersion>=6,this.switchV=!1,this.switchN=i&&this.parser.options.ecmaVersion>=9)},I_.prototype.raise=function(t){this.parser.raiseRecoverable(this.start,"Invalid regular expression: /"+this.source+"/: "+t)},I_.prototype.at=function(t,e){void 0===e&&(e=!1);var n=this.source,r=n.length;if(t>=r)return-1;var i=n.charCodeAt(t);if(!e&&!this.switchU||i<=55295||i>=57344||t+1>=r)return i;var o=n.charCodeAt(t+1);return o>=56320&&o<=57343?(i<<10)+o-56613888:i},I_.prototype.nextIndex=function(t,e){void 0===e&&(e=!1);var n=this.source,r=n.length;if(t>=r)return r;var i,o=n.charCodeAt(t);return!e&&!this.switchU||o<=55295||o>=57344||t+1>=r||(i=n.charCodeAt(t+1))<56320||i>57343?t+1:t+2},I_.prototype.current=function(t){return void 0===t&&(t=!1),this.at(this.pos,t)},I_.prototype.lookahead=function(t){return void 0===t&&(t=!1),this.at(this.nextIndex(this.pos,t),t)},I_.prototype.advance=function(t){void 0===t&&(t=!1),this.pos=this.nextIndex(this.pos,t)},I_.prototype.eat=function(t,e){return void 0===e&&(e=!1),this.current(e)===t&&(this.advance(e),!0)},I_.prototype.eatChars=function(t,e){void 0===e&&(e=!1);for(var n=this.pos,r=0,i=t;r<i.length;r+=1){var o=i[r],s=this.at(n,e);if(-1===s||s!==o)return!1;n=this.nextIndex(n,e)}return this.pos=n,!0},T_.validateRegExpFlags=function(t){for(var e=t.validFlags,n=t.flags,r=!1,i=!1,o=0;o<n.length;o++){var s=n.charAt(o);-1===e.indexOf(s)&&this.raise(t.start,"Invalid regular expression flag"),n.indexOf(s,o+1)>-1&&this.raise(t.start,"Duplicate regular expression flag"),"u"===s&&(r=!0),"v"===s&&(i=!0)}this.options.ecmaVersion>=15&&r&&i&&this.raise(t.start,"Invalid regular expression flag")},T_.validateRegExpPattern=function(t){this.regexp_pattern(t),!t.switchN&&this.options.ecmaVersion>=9&&t.groupNames.length>0&&(t.switchN=!0,this.regexp_pattern(t))},T_.regexp_pattern=function(t){t.pos=0,t.lastIntValue=0,t.lastStringValue="",t.lastAssertionIsQuantifiable=!1,t.numCapturingParens=0,t.maxBackReference=0,t.groupNames.length=0,t.backReferenceNames.length=0,this.regexp_disjunction(t),t.pos!==t.source.length&&(t.eat(41)&&t.raise("Unmatched ')'"),(t.eat(93)||t.eat(125))&&t.raise("Lone quantifier brackets")),t.maxBackReference>t.numCapturingParens&&t.raise("Invalid escape");for(var e=0,n=t.backReferenceNames;e<n.length;e+=1){var r=n[e];-1===t.groupNames.indexOf(r)&&t.raise("Invalid named capture referenced")}},T_.regexp_disjunction=function(t){for(this.regexp_alternative(t);t.eat(124);)this.regexp_alternative(t);this.regexp_eatQuantifier(t,!0)&&t.raise("Nothing to repeat"),t.eat(123)&&t.raise("Lone quantifier brackets")},T_.regexp_alternative=function(t){for(;t.pos<t.source.length&&this.regexp_eatTerm(t););},T_.regexp_eatTerm=function(t){return this.regexp_eatAssertion(t)?(t.lastAssertionIsQuantifiable&&this.regexp_eatQuantifier(t)&&t.switchU&&t.raise("Invalid quantifier"),!0):!!(t.switchU?this.regexp_eatAtom(t):this.regexp_eatExtendedAtom(t))&&(this.regexp_eatQuantifier(t),!0)},T_.regexp_eatAssertion=function(t){var e=t.pos;if(t.lastAssertionIsQuantifiable=!1,t.eat(94)||t.eat(36))return!0;if(t.eat(92)){if(t.eat(66)||t.eat(98))return!0;t.pos=e}if(t.eat(40)&&t.eat(63)){var n=!1;if(this.options.ecmaVersion>=9&&(n=t.eat(60)),t.eat(61)||t.eat(33))return this.regexp_disjunction(t),t.eat(41)||t.raise("Unterminated group"),t.lastAssertionIsQuantifiable=!n,!0}return t.pos=e,!1},T_.regexp_eatQuantifier=function(t,e){return void 0===e&&(e=!1),!!this.regexp_eatQuantifierPrefix(t,e)&&(t.eat(63),!0)},T_.regexp_eatQuantifierPrefix=function(t,e){return t.eat(42)||t.eat(43)||t.eat(63)||this.regexp_eatBracedQuantifier(t,e)},T_.regexp_eatBracedQuantifier=function(t,e){var n=t.pos;if(t.eat(123)){var r=0,i=-1;if(this.regexp_eatDecimalDigits(t)&&(r=t.lastIntValue,t.eat(44)&&this.regexp_eatDecimalDigits(t)&&(i=t.lastIntValue),t.eat(125)))return-1!==i&&i<r&&!e&&t.raise("numbers out of order in {} quantifier"),!0;t.switchU&&!e&&t.raise("Incomplete quantifier"),t.pos=n}return!1},T_.regexp_eatAtom=function(t){return this.regexp_eatPatternCharacters(t)||t.eat(46)||this.regexp_eatReverseSolidusAtomEscape(t)||this.regexp_eatCharacterClass(t)||this.regexp_eatUncapturingGroup(t)||this.regexp_eatCapturingGroup(t)},T_.regexp_eatReverseSolidusAtomEscape=function(t){var e=t.pos;if(t.eat(92)){if(this.regexp_eatAtomEscape(t))return!0;t.pos=e}return!1},T_.regexp_eatUncapturingGroup=function(t){var e=t.pos;if(t.eat(40)){if(t.eat(63)&&t.eat(58)){if(this.regexp_disjunction(t),t.eat(41))return!0;t.raise("Unterminated group")}t.pos=e}return!1},T_.regexp_eatCapturingGroup=function(t){if(t.eat(40)){if(this.options.ecmaVersion>=9?this.regexp_groupSpecifier(t):63===t.current()&&t.raise("Invalid group"),this.regexp_disjunction(t),t.eat(41))return t.numCapturingParens+=1,!0;t.raise("Unterminated group")}return!1},T_.regexp_eatExtendedAtom=function(t){return t.eat(46)||this.regexp_eatReverseSolidusAtomEscape(t)||this.regexp_eatCharacterClass(t)||this.regexp_eatUncapturingGroup(t)||this.regexp_eatCapturingGroup(t)||this.regexp_eatInvalidBracedQuantifier(t)||this.regexp_eatExtendedPatternCharacter(t)},T_.regexp_eatInvalidBracedQuantifier=function(t){return this.regexp_eatBracedQuantifier(t,!0)&&t.raise("Nothing to repeat"),!1},T_.regexp_eatSyntaxCharacter=function(t){var e=t.current();return!!N_(e)&&(t.lastIntValue=e,t.advance(),!0)},T_.regexp_eatPatternCharacters=function(t){for(var e=t.pos,n=0;-1!==(n=t.current())&&!N_(n);)t.advance();return t.pos!==e},T_.regexp_eatExtendedPatternCharacter=function(t){var e=t.current();return!(-1===e||36===e||e>=40&&e<=43||46===e||63===e||91===e||94===e||124===e||(t.advance(),0))},T_.regexp_groupSpecifier=function(t){if(t.eat(63)){if(this.regexp_eatGroupName(t))return-1!==t.groupNames.indexOf(t.lastStringValue)&&t.raise("Duplicate capture group name"),void t.groupNames.push(t.lastStringValue);t.raise("Invalid group")}},T_.regexp_eatGroupName=function(t){if(t.lastStringValue="",t.eat(60)){if(this.regexp_eatRegExpIdentifierName(t)&&t.eat(62))return!0;t.raise("Invalid capture group name")}return!1},T_.regexp_eatRegExpIdentifierName=function(t){if(t.lastStringValue="",this.regexp_eatRegExpIdentifierStart(t)){for(t.lastStringValue+=$x(t.lastIntValue);this.regexp_eatRegExpIdentifierPart(t);)t.lastStringValue+=$x(t.lastIntValue);return!0}return!1},T_.regexp_eatRegExpIdentifierStart=function(t){var e=t.pos,n=this.options.ecmaVersion>=11,r=t.current(n);return t.advance(n),92===r&&this.regexp_eatRegExpUnicodeEscapeSequence(t,n)&&(r=t.lastIntValue),function(t){return fx(t,!0)||36===t||95===t}(r)?(t.lastIntValue=r,!0):(t.pos=e,!1)},T_.regexp_eatRegExpIdentifierPart=function(t){var e=t.pos,n=this.options.ecmaVersion>=11,r=t.current(n);return t.advance(n),92===r&&this.regexp_eatRegExpUnicodeEscapeSequence(t,n)&&(r=t.lastIntValue),function(t){return dx(t,!0)||36===t||95===t||8204===t||8205===t}(r)?(t.lastIntValue=r,!0):(t.pos=e,!1)},T_.regexp_eatAtomEscape=function(t){return!!(this.regexp_eatBackReference(t)||this.regexp_eatCharacterClassEscape(t)||this.regexp_eatCharacterEscape(t)||t.switchN&&this.regexp_eatKGroupName(t))||(t.switchU&&(99===t.current()&&t.raise("Invalid unicode escape"),t.raise("Invalid escape")),!1)},T_.regexp_eatBackReference=function(t){var e=t.pos;if(this.regexp_eatDecimalEscape(t)){var n=t.lastIntValue;if(t.switchU)return n>t.maxBackReference&&(t.maxBackReference=n),!0;if(n<=t.numCapturingParens)return!0;t.pos=e}return!1},T_.regexp_eatKGroupName=function(t){if(t.eat(107)){if(this.regexp_eatGroupName(t))return t.backReferenceNames.push(t.lastStringValue),!0;t.raise("Invalid named reference")}return!1},T_.regexp_eatCharacterEscape=function(t){return this.regexp_eatControlEscape(t)||this.regexp_eatCControlLetter(t)||this.regexp_eatZero(t)||this.regexp_eatHexEscapeSequence(t)||this.regexp_eatRegExpUnicodeEscapeSequence(t,!1)||!t.switchU&&this.regexp_eatLegacyOctalEscapeSequence(t)||this.regexp_eatIdentityEscape(t)},T_.regexp_eatCControlLetter=function(t){var e=t.pos;if(t.eat(99)){if(this.regexp_eatControlLetter(t))return!0;t.pos=e}return!1},T_.regexp_eatZero=function(t){return 48===t.current()&&!B_(t.lookahead())&&(t.lastIntValue=0,t.advance(),!0)},T_.regexp_eatControlEscape=function(t){var e=t.current();return 116===e?(t.lastIntValue=9,t.advance(),!0):110===e?(t.lastIntValue=10,t.advance(),!0):118===e?(t.lastIntValue=11,t.advance(),!0):102===e?(t.lastIntValue=12,t.advance(),!0):114===e&&(t.lastIntValue=13,t.advance(),!0)},T_.regexp_eatControlLetter=function(t){var e=t.current();return!!$_(e)&&(t.lastIntValue=e%32,t.advance(),!0)},T_.regexp_eatRegExpUnicodeEscapeSequence=function(t,e){void 0===e&&(e=!1);var n=t.pos,r=e||t.switchU;if(t.eat(117)){if(this.regexp_eatFixedHexDigits(t,4)){var i=t.lastIntValue;if(r&&i>=55296&&i<=56319){var o=t.pos;if(t.eat(92)&&t.eat(117)&&this.regexp_eatFixedHexDigits(t,4)){var s=t.lastIntValue;if(s>=56320&&s<=57343)return t.lastIntValue=1024*(i-55296)+(s-56320)+65536,!0}t.pos=o,t.lastIntValue=i}return!0}if(r&&t.eat(123)&&this.regexp_eatHexDigits(t)&&t.eat(125)&&function(t){return t>=0&&t<=1114111}(t.lastIntValue))return!0;r&&t.raise("Invalid unicode escape"),t.pos=n}return!1},T_.regexp_eatIdentityEscape=function(t){if(t.switchU)return!!this.regexp_eatSyntaxCharacter(t)||!!t.eat(47)&&(t.lastIntValue=47,!0);var e=t.current();return!(99===e||t.switchN&&107===e||(t.lastIntValue=e,t.advance(),0))},T_.regexp_eatDecimalEscape=function(t){t.lastIntValue=0;var e=t.current();if(e>=49&&e<=57){do{t.lastIntValue=10*t.lastIntValue+(e-48),t.advance()}while((e=t.current())>=48&&e<=57);return!0}return!1},T_.regexp_eatCharacterClassEscape=function(t){var e=t.current();if(function(t){return 100===t||68===t||115===t||83===t||119===t||87===t}(e))return t.lastIntValue=-1,t.advance(),1;var n=!1;if(t.switchU&&this.options.ecmaVersion>=9&&((n=80===e)||112===e)){var r;if(t.lastIntValue=-1,t.advance(),t.eat(123)&&(r=this.regexp_eatUnicodePropertyValueExpression(t))&&t.eat(125))return n&&2===r&&t.raise("Invalid property name"),r;t.raise("Invalid property name")}return 0},T_.regexp_eatUnicodePropertyValueExpression=function(t){var e=t.pos;if(this.regexp_eatUnicodePropertyName(t)&&t.eat(61)){var n=t.lastStringValue;if(this.regexp_eatUnicodePropertyValue(t)){var r=t.lastStringValue;return this.regexp_validateUnicodePropertyNameAndValue(t,n,r),1}}if(t.pos=e,this.regexp_eatLoneUnicodePropertyNameOrValue(t)){var i=t.lastStringValue;return this.regexp_validateUnicodePropertyNameOrValue(t,i)}return 0},T_.regexp_validateUnicodePropertyNameAndValue=function(t,e,n){Ox(t.unicodeProperties.nonBinary,e)||t.raise("Invalid property name"),t.unicodeProperties.nonBinary[e].test(n)||t.raise("Invalid property value")},T_.regexp_validateUnicodePropertyNameOrValue=function(t,e){return t.unicodeProperties.binary.test(e)?1:t.switchV&&t.unicodeProperties.binaryOfStrings.test(e)?2:void t.raise("Invalid property name")},T_.regexp_eatUnicodePropertyName=function(t){var e=0;for(t.lastStringValue="";F_(e=t.current());)t.lastStringValue+=$x(e),t.advance();return""!==t.lastStringValue},T_.regexp_eatUnicodePropertyValue=function(t){var e=0;for(t.lastStringValue="";L_(e=t.current());)t.lastStringValue+=$x(e),t.advance();return""!==t.lastStringValue},T_.regexp_eatLoneUnicodePropertyNameOrValue=function(t){return this.regexp_eatUnicodePropertyValue(t)},T_.regexp_eatCharacterClass=function(t){if(t.eat(91)){var e=t.eat(94),n=this.regexp_classContents(t);return t.eat(93)||t.raise("Unterminated character class"),e&&2===n&&t.raise("Negated character class may contain strings"),!0}return!1},T_.regexp_classContents=function(t){return 93===t.current()?1:t.switchV?this.regexp_classSetExpression(t):(this.regexp_nonEmptyClassRanges(t),1)},T_.regexp_nonEmptyClassRanges=function(t){for(;this.regexp_eatClassAtom(t);){var e=t.lastIntValue;if(t.eat(45)&&this.regexp_eatClassAtom(t)){var n=t.lastIntValue;!t.switchU||-1!==e&&-1!==n||t.raise("Invalid character class"),-1!==e&&-1!==n&&e>n&&t.raise("Range out of order in character class")}}},T_.regexp_eatClassAtom=function(t){var e=t.pos;if(t.eat(92)){if(this.regexp_eatClassEscape(t))return!0;if(t.switchU){var n=t.current();(99===n||z_(n))&&t.raise("Invalid class escape"),t.raise("Invalid escape")}t.pos=e}var r=t.current();return 93!==r&&(t.lastIntValue=r,t.advance(),!0)},T_.regexp_eatClassEscape=function(t){var e=t.pos;if(t.eat(98))return t.lastIntValue=8,!0;if(t.switchU&&t.eat(45))return t.lastIntValue=45,!0;if(!t.switchU&&t.eat(99)){if(this.regexp_eatClassControlLetter(t))return!0;t.pos=e}return this.regexp_eatCharacterClassEscape(t)||this.regexp_eatCharacterEscape(t)},T_.regexp_classSetExpression=function(t){var e,n=1;if(this.regexp_eatClassSetRange(t));else if(e=this.regexp_eatClassSetOperand(t)){2===e&&(n=2);for(var r=t.pos;t.eatChars([38,38]);)38!==t.current()&&(e=this.regexp_eatClassSetOperand(t))?2!==e&&(n=1):t.raise("Invalid character in character class");if(r!==t.pos)return n;for(;t.eatChars([45,45]);)this.regexp_eatClassSetOperand(t)||t.raise("Invalid character in character class");if(r!==t.pos)return n}else t.raise("Invalid character in character class");for(;;)if(!this.regexp_eatClassSetRange(t)){if(!(e=this.regexp_eatClassSetOperand(t)))return n;2===e&&(n=2)}},T_.regexp_eatClassSetRange=function(t){var e=t.pos;if(this.regexp_eatClassSetCharacter(t)){var n=t.lastIntValue;if(t.eat(45)&&this.regexp_eatClassSetCharacter(t)){var r=t.lastIntValue;return-1!==n&&-1!==r&&n>r&&t.raise("Range out of order in character class"),!0}t.pos=e}return!1},T_.regexp_eatClassSetOperand=function(t){return this.regexp_eatClassSetCharacter(t)?1:this.regexp_eatClassStringDisjunction(t)||this.regexp_eatNestedClass(t)},T_.regexp_eatNestedClass=function(t){var e=t.pos;if(t.eat(91)){var n=t.eat(94),r=this.regexp_classContents(t);if(t.eat(93))return n&&2===r&&t.raise("Negated character class may contain strings"),r;t.pos=e}if(t.eat(92)){var i=this.regexp_eatCharacterClassEscape(t);if(i)return i;t.pos=e}return null},T_.regexp_eatClassStringDisjunction=function(t){var e=t.pos;if(t.eatChars([92,113])){if(t.eat(123)){var n=this.regexp_classStringDisjunctionContents(t);if(t.eat(125))return n}else t.raise("Invalid escape");t.pos=e}return null},T_.regexp_classStringDisjunctionContents=function(t){for(var e=this.regexp_classString(t);t.eat(124);)2===this.regexp_classString(t)&&(e=2);return e},T_.regexp_classString=function(t){for(var e=0;this.regexp_eatClassSetCharacter(t);)e++;return 1===e?1:2},T_.regexp_eatClassSetCharacter=function(t){var e=t.pos;if(t.eat(92))return!(!this.regexp_eatCharacterEscape(t)&&!this.regexp_eatClassSetReservedPunctuator(t)&&(t.eat(98)?(t.lastIntValue=8,0):(t.pos=e,1)));var n=t.current();return!(n<0||n===t.lookahead()&&function(t){return 33===t||t>=35&&t<=38||t>=42&&t<=44||46===t||t>=58&&t<=64||94===t||96===t||126===t}(n)||function(t){return 40===t||41===t||45===t||47===t||t>=91&&t<=93||t>=123&&t<=125}(n)||(t.advance(),t.lastIntValue=n,0))},T_.regexp_eatClassSetReservedPunctuator=function(t){var e=t.current();return!!function(t){return 33===t||35===t||37===t||38===t||44===t||45===t||t>=58&&t<=62||64===t||96===t||126===t}(e)&&(t.lastIntValue=e,t.advance(),!0)},T_.regexp_eatClassControlLetter=function(t){var e=t.current();return!(!B_(e)&&95!==e||(t.lastIntValue=e%32,t.advance(),0))},T_.regexp_eatHexEscapeSequence=function(t){var e=t.pos;if(t.eat(120)){if(this.regexp_eatFixedHexDigits(t,2))return!0;t.switchU&&t.raise("Invalid escape"),t.pos=e}return!1},T_.regexp_eatDecimalDigits=function(t){var e=t.pos,n=0;for(t.lastIntValue=0;B_(n=t.current());)t.lastIntValue=10*t.lastIntValue+(n-48),t.advance();return t.pos!==e},T_.regexp_eatHexDigits=function(t){var e=t.pos,n=0;for(t.lastIntValue=0;R_(n=t.current());)t.lastIntValue=16*t.lastIntValue+P_(n),t.advance();return t.pos!==e},T_.regexp_eatLegacyOctalEscapeSequence=function(t){if(this.regexp_eatOctalDigit(t)){var e=t.lastIntValue;if(this.regexp_eatOctalDigit(t)){var n=t.lastIntValue;e<=3&&this.regexp_eatOctalDigit(t)?t.lastIntValue=64*e+8*n+t.lastIntValue:t.lastIntValue=8*e+n}else t.lastIntValue=e;return!0}return!1},T_.regexp_eatOctalDigit=function(t){var e=t.current();return z_(e)?(t.lastIntValue=e-48,t.advance(),!0):(t.lastIntValue=0,!1)},T_.regexp_eatFixedHexDigits=function(t,e){var n=t.pos;t.lastIntValue=0;for(var r=0;r<e;++r){var i=t.current();if(!R_(i))return t.pos=n,!1;t.lastIntValue=16*t.lastIntValue+P_(i),t.advance()}return!0};var j_=function(t){this.type=t.type,this.value=t.value,this.start=t.start,this.end=t.end,t.options.locations&&(this.loc=new Bx(t,t.startLoc,t.endLoc)),t.options.ranges&&(this.range=[t.start,t.end])},U_=Ux.prototype;function V_(t){return"function"!=typeof BigInt?null:BigInt(t.replace(/_/g,""))}U_.next=function(t){!t&&this.type.keyword&&this.containsEsc&&this.raiseRecoverable(this.start,"Escape sequence in keyword "+this.type.keyword),this.options.onToken&&this.options.onToken(new j_(this)),this.lastTokEnd=this.end,this.lastTokStart=this.start,this.lastTokEndLoc=this.endLoc,this.lastTokStartLoc=this.startLoc,this.nextToken()},U_.getToken=function(){return this.next(),new j_(this)},"undefined"!=typeof Symbol&&(U_[Symbol.iterator]=function(){var t=this;return{next:function(){var e=t.getToken();return{done:e.type===wx.eof,value:e}}}}),U_.nextToken=function(){var t=this.curContext();return t&&t.preserveSpace||this.skipSpace(),this.start=this.pos,this.options.locations&&(this.startLoc=this.curPosition()),this.pos>=this.input.length?this.finishToken(wx.eof):t.override?t.override(this):void this.readToken(this.fullCharCodeAtPos())},U_.readToken=function(t){return fx(t,this.options.ecmaVersion>=6)||92===t?this.readWord():this.getTokenFromCode(t)},U_.fullCharCodeAtPos=function(){var t=this.input.charCodeAt(this.pos);if(t<=55295||t>=56320)return t;var e=this.input.charCodeAt(this.pos+1);return e<=56319||e>=57344?t:(t<<10)+e-56613888},U_.skipBlockComment=function(){var t=this.options.onComment&&this.curPosition(),e=this.pos,n=this.input.indexOf("*/",this.pos+=2);if(-1===n&&this.raise(this.pos-2,"Unterminated comment"),this.pos=n+2,this.options.locations)for(var r=void 0,i=e;(r=Sx(this.input,i,this.pos))>-1;)++this.curLine,i=this.lineStart=r;this.options.onComment&&this.options.onComment(!0,this.input.slice(e+2,n),e,this.pos,t,this.curPosition())},U_.skipLineComment=function(t){for(var e=this.pos,n=this.options.onComment&&this.curPosition(),r=this.input.charCodeAt(this.pos+=t);this.pos<this.input.length&&!kx(r);)r=this.input.charCodeAt(++this.pos);this.options.onComment&&this.options.onComment(!1,this.input.slice(e+t,this.pos),e,this.pos,n,this.curPosition())},U_.skipSpace=function(){t:for(;this.pos<this.input.length;){var t=this.input.charCodeAt(this.pos);switch(t){case 32:case 160:++this.pos;break;case 13:10===this.input.charCodeAt(this.pos+1)&&++this.pos;case 10:case 8232:case 8233:++this.pos,this.options.locations&&(++this.curLine,this.lineStart=this.pos);break;case 47:switch(this.input.charCodeAt(this.pos+1)){case 42:this.skipBlockComment();break;case 47:this.skipLineComment(2);break;default:break t}break;default:if(!(t>8&&t<14||t>=5760&&Ex.test(String.fromCharCode(t))))break t;++this.pos}}},U_.finishToken=function(t,e){this.end=this.pos,this.options.locations&&(this.endLoc=this.curPosition());var n=this.type;this.type=t,this.value=e,this.updateContext(n)},U_.readToken_dot=function(){var t=this.input.charCodeAt(this.pos+1);if(t>=48&&t<=57)return this.readNumber(!0);var e=this.input.charCodeAt(this.pos+2);return this.options.ecmaVersion>=6&&46===t&&46===e?(this.pos+=3,this.finishToken(wx.ellipsis)):(++this.pos,this.finishToken(wx.dot))},U_.readToken_slash=function(){var t=this.input.charCodeAt(this.pos+1);return this.exprAllowed?(++this.pos,this.readRegexp()):61===t?this.finishOp(wx.assign,2):this.finishOp(wx.slash,1)},U_.readToken_mult_modulo_exp=function(t){var e=this.input.charCodeAt(this.pos+1),n=1,r=42===t?wx.star:wx.modulo;return this.options.ecmaVersion>=7&&42===t&&42===e&&(++n,r=wx.starstar,e=this.input.charCodeAt(this.pos+2)),61===e?this.finishOp(wx.assign,n+1):this.finishOp(r,n)},U_.readToken_pipe_amp=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?this.options.ecmaVersion>=12&&61===this.input.charCodeAt(this.pos+2)?this.finishOp(wx.assign,3):this.finishOp(124===t?wx.logicalOR:wx.logicalAND,2):61===e?this.finishOp(wx.assign,2):this.finishOp(124===t?wx.bitwiseOR:wx.bitwiseAND,1)},U_.readToken_caret=function(){return 61===this.input.charCodeAt(this.pos+1)?this.finishOp(wx.assign,2):this.finishOp(wx.bitwiseXOR,1)},U_.readToken_plus_min=function(t){var e=this.input.charCodeAt(this.pos+1);return e===t?45!==e||this.inModule||62!==this.input.charCodeAt(this.pos+2)||0!==this.lastTokEnd&&!xx.test(this.input.slice(this.lastTokEnd,this.pos))?this.finishOp(wx.incDec,2):(this.skipLineComment(3),this.skipSpace(),this.nextToken()):61===e?this.finishOp(wx.assign,2):this.finishOp(wx.plusMin,1)},U_.readToken_lt_gt=function(t){var e=this.input.charCodeAt(this.pos+1),n=1;return e===t?(n=62===t&&62===this.input.charCodeAt(this.pos+2)?3:2,61===this.input.charCodeAt(this.pos+n)?this.finishOp(wx.assign,n+1):this.finishOp(wx.bitShift,n)):33!==e||60!==t||this.inModule||45!==this.input.charCodeAt(this.pos+2)||45!==this.input.charCodeAt(this.pos+3)?(61===e&&(n=2),this.finishOp(wx.relational,n)):(this.skipLineComment(4),this.skipSpace(),this.nextToken())},U_.readToken_eq_excl=function(t){var e=this.input.charCodeAt(this.pos+1);return 61===e?this.finishOp(wx.equality,61===this.input.charCodeAt(this.pos+2)?3:2):61===t&&62===e&&this.options.ecmaVersion>=6?(this.pos+=2,this.finishToken(wx.arrow)):this.finishOp(61===t?wx.eq:wx.prefix,1)},U_.readToken_question=function(){var t=this.options.ecmaVersion;if(t>=11){var e=this.input.charCodeAt(this.pos+1);if(46===e){var n=this.input.charCodeAt(this.pos+2);if(n<48||n>57)return this.finishOp(wx.questionDot,2)}if(63===e)return t>=12&&61===this.input.charCodeAt(this.pos+2)?this.finishOp(wx.assign,3):this.finishOp(wx.coalesce,2)}return this.finishOp(wx.question,1)},U_.readToken_numberSign=function(){var t=35;if(this.options.ecmaVersion>=13&&(++this.pos,fx(t=this.fullCharCodeAtPos(),!0)||92===t))return this.finishToken(wx.privateId,this.readWord1());this.raise(this.pos,"Unexpected character '"+$x(t)+"'")},U_.getTokenFromCode=function(t){switch(t){case 46:return this.readToken_dot();case 40:return++this.pos,this.finishToken(wx.parenL);case 41:return++this.pos,this.finishToken(wx.parenR);case 59:return++this.pos,this.finishToken(wx.semi);case 44:return++this.pos,this.finishToken(wx.comma);case 91:return++this.pos,this.finishToken(wx.bracketL);case 93:return++this.pos,this.finishToken(wx.bracketR);case 123:return++this.pos,this.finishToken(wx.braceL);case 125:return++this.pos,this.finishToken(wx.braceR);case 58:return++this.pos,this.finishToken(wx.colon);case 96:if(this.options.ecmaVersion<6)break;return++this.pos,this.finishToken(wx.backQuote);case 48:var e=this.input.charCodeAt(this.pos+1);if(120===e||88===e)return this.readRadixNumber(16);if(this.options.ecmaVersion>=6){if(111===e||79===e)return this.readRadixNumber(8);if(98===e||66===e)return this.readRadixNumber(2)}case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return this.readNumber(!1);case 34:case 39:return this.readString(t);case 47:return this.readToken_slash();case 37:case 42:return this.readToken_mult_modulo_exp(t);case 124:case 38:return this.readToken_pipe_amp(t);case 94:return this.readToken_caret();case 43:case 45:return this.readToken_plus_min(t);case 60:case 62:return this.readToken_lt_gt(t);case 61:case 33:return this.readToken_eq_excl(t);case 63:return this.readToken_question();case 126:return this.finishOp(wx.prefix,1);case 35:return this.readToken_numberSign()}this.raise(this.pos,"Unexpected character '"+$x(t)+"'")},U_.finishOp=function(t,e){var n=this.input.slice(this.pos,this.pos+e);return this.pos+=e,this.finishToken(t,n)},U_.readRegexp=function(){for(var t,e,n=this.pos;;){this.pos>=this.input.length&&this.raise(n,"Unterminated regular expression");var r=this.input.charAt(this.pos);if(xx.test(r)&&this.raise(n,"Unterminated regular expression"),t)t=!1;else{if("["===r)e=!0;else if("]"===r&&e)e=!1;else if("/"===r&&!e)break;t="\\"===r}++this.pos}var i=this.input.slice(n,this.pos);++this.pos;var o=this.pos,s=this.readWord1();this.containsEsc&&this.unexpected(o);var a=this.regexpState||(this.regexpState=new I_(this));a.reset(n,i,s),this.validateRegExpFlags(a),this.validateRegExpPattern(a);var l=null;try{l=new RegExp(i,s)}catch(t){}return this.finishToken(wx.regexp,{pattern:i,flags:s,value:l})},U_.readInt=function(t,e,n){for(var r=this.options.ecmaVersion>=12&&void 0===e,i=n&&48===this.input.charCodeAt(this.pos),o=this.pos,s=0,a=0,l=0,u=null==e?1/0:e;l<u;++l,++this.pos){var c=this.input.charCodeAt(this.pos),h=void 0;if(r&&95===c)i&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed in legacy octal numeric literals"),95===a&&this.raiseRecoverable(this.pos,"Numeric separator must be exactly one underscore"),0===l&&this.raiseRecoverable(this.pos,"Numeric separator is not allowed at the first of digits"),a=c;else{if((h=c>=97?c-97+10:c>=65?c-65+10:c>=48&&c<=57?c-48:1/0)>=t)break;a=c,s=s*t+h}}return r&&95===a&&this.raiseRecoverable(this.pos-1,"Numeric separator is not allowed at the last of digits"),this.pos===o||null!=e&&this.pos-o!==e?null:s},U_.readRadixNumber=function(t){var e=this.pos;this.pos+=2;var n=this.readInt(t);return null==n&&this.raise(this.start+2,"Expected number in radix "+t),this.options.ecmaVersion>=11&&110===this.input.charCodeAt(this.pos)?(n=V_(this.input.slice(e,this.pos)),++this.pos):fx(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(wx.num,n)},U_.readNumber=function(t){var e=this.pos;t||null!==this.readInt(10,void 0,!0)||this.raise(e,"Invalid number");var n=this.pos-e>=2&&48===this.input.charCodeAt(e);n&&this.strict&&this.raise(e,"Invalid number");var r=this.input.charCodeAt(this.pos);if(!n&&!t&&this.options.ecmaVersion>=11&&110===r){var i=V_(this.input.slice(e,this.pos));return++this.pos,fx(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number"),this.finishToken(wx.num,i)}n&&/[89]/.test(this.input.slice(e,this.pos))&&(n=!1),46!==r||n||(++this.pos,this.readInt(10),r=this.input.charCodeAt(this.pos)),69!==r&&101!==r||n||(43!==(r=this.input.charCodeAt(++this.pos))&&45!==r||++this.pos,null===this.readInt(10)&&this.raise(e,"Invalid number")),fx(this.fullCharCodeAtPos())&&this.raise(this.pos,"Identifier directly after number");var o,s=(o=this.input.slice(e,this.pos),n?parseInt(o,8):parseFloat(o.replace(/_/g,"")));return this.finishToken(wx.num,s)},U_.readCodePoint=function(){var t;if(123===this.input.charCodeAt(this.pos)){this.options.ecmaVersion<6&&this.unexpected();var e=++this.pos;t=this.readHexChar(this.input.indexOf("}",this.pos)-this.pos),++this.pos,t>1114111&&this.invalidStringToken(e,"Code point out of bounds")}else t=this.readHexChar(4);return t},U_.readString=function(t){for(var e="",n=++this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated string constant");var r=this.input.charCodeAt(this.pos);if(r===t)break;92===r?(e+=this.input.slice(n,this.pos),e+=this.readEscapedChar(!1),n=this.pos):8232===r||8233===r?(this.options.ecmaVersion<10&&this.raise(this.start,"Unterminated string constant"),++this.pos,this.options.locations&&(this.curLine++,this.lineStart=this.pos)):(kx(r)&&this.raise(this.start,"Unterminated string constant"),++this.pos)}return e+=this.input.slice(n,this.pos++),this.finishToken(wx.string,e)};var q_={};U_.tryReadTemplateToken=function(){this.inTemplateElement=!0;try{this.readTmplToken()}catch(t){if(t!==q_)throw t;this.readInvalidTemplateToken()}this.inTemplateElement=!1},U_.invalidStringToken=function(t,e){if(this.inTemplateElement&&this.options.ecmaVersion>=9)throw q_;this.raise(t,e)},U_.readTmplToken=function(){for(var t="",e=this.pos;;){this.pos>=this.input.length&&this.raise(this.start,"Unterminated template");var n=this.input.charCodeAt(this.pos);if(96===n||36===n&&123===this.input.charCodeAt(this.pos+1))return this.pos!==this.start||this.type!==wx.template&&this.type!==wx.invalidTemplate?(t+=this.input.slice(e,this.pos),this.finishToken(wx.template,t)):36===n?(this.pos+=2,this.finishToken(wx.dollarBraceL)):(++this.pos,this.finishToken(wx.backQuote));if(92===n)t+=this.input.slice(e,this.pos),t+=this.readEscapedChar(!0),e=this.pos;else if(kx(n)){switch(t+=this.input.slice(e,this.pos),++this.pos,n){case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:t+="\n";break;default:t+=String.fromCharCode(n)}this.options.locations&&(++this.curLine,this.lineStart=this.pos),e=this.pos}else++this.pos}},U_.readInvalidTemplateToken=function(){for(;this.pos<this.input.length;this.pos++)switch(this.input[this.pos]){case"\\":++this.pos;break;case"$":if("{"!==this.input[this.pos+1])break;case"`":return this.finishToken(wx.invalidTemplate,this.input.slice(this.start,this.pos))}this.raise(this.start,"Unterminated template")},U_.readEscapedChar=function(t){var e=this.input.charCodeAt(++this.pos);switch(++this.pos,e){case 110:return"\n";case 114:return"\r";case 120:return String.fromCharCode(this.readHexChar(2));case 117:return $x(this.readCodePoint());case 116:return"\t";case 98:return"\b";case 118:return"\v";case 102:return"\f";case 13:10===this.input.charCodeAt(this.pos)&&++this.pos;case 10:return this.options.locations&&(this.lineStart=this.pos,++this.curLine),"";case 56:case 57:if(this.strict&&this.invalidStringToken(this.pos-1,"Invalid escape sequence"),t){var n=this.pos-1;this.invalidStringToken(n,"Invalid escape sequence in template string")}default:if(e>=48&&e<=55){var r=this.input.substr(this.pos-1,3).match(/^[0-7]+/)[0],i=parseInt(r,8);return i>255&&(r=r.slice(0,-1),i=parseInt(r,8)),this.pos+=r.length-1,e=this.input.charCodeAt(this.pos),"0"===r&&56!==e&&57!==e||!this.strict&&!t||this.invalidStringToken(this.pos-1-r.length,t?"Octal literal in template string":"Octal literal in strict mode"),String.fromCharCode(i)}return kx(e)?"":String.fromCharCode(e)}},U_.readHexChar=function(t){var e=this.pos,n=this.readInt(16,t);return null===n&&this.invalidStringToken(e,"Bad character escape sequence"),n},U_.readWord1=function(){this.containsEsc=!1;for(var t="",e=!0,n=this.pos,r=this.options.ecmaVersion>=6;this.pos<this.input.length;){var i=this.fullCharCodeAtPos();if(dx(i,r))this.pos+=i<=65535?1:2;else{if(92!==i)break;this.containsEsc=!0,t+=this.input.slice(n,this.pos);var o=this.pos;117!==this.input.charCodeAt(++this.pos)&&this.invalidStringToken(this.pos,"Expecting Unicode escape sequence \\uXXXX"),++this.pos;var s=this.readCodePoint();(e?fx:dx)(s,r)||this.invalidStringToken(o,"Invalid Unicode escape"),t+=$x(s),n=this.pos}e=!1}return t+this.input.slice(n,this.pos)},U_.readWord=function(){var t=this.readWord1(),e=wx.name;return this.keywords.test(t)&&(e=bx[t]),this.finishToken(e,t)},Ux.acorn={Parser:Ux,version:"8.11.3",defaultOptions:Px,Position:Lx,SourceLocation:Bx,getLineInfo:Rx,Node:h_,TokenType:px,tokTypes:wx,keywordTypes:bx,TokContext:n_,tokContexts:r_,isIdentifierChar:dx,isIdentifierStart:fx,Token:j_,isNewLine:kx,lineBreak:xx,lineBreakG:_x,nonASCIIwhitespace:Ex};const W_={undefined:"void(0)",Infinity:"Number.POSITIVE_INFINITY",NaN:"Number.NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2"},H_={ecmaVersion:11},G_="$",Y_="d",X_="d1",J_="d2",K_=t=>(e,n)=>n.error(e,t+" not allowed"),Q_=K_("Aggregate function"),Z_=K_("Window function"),tk="Invalid argument",ek="Invalid column reference",nk=ek+" (must be input to an aggregate function)",rk="Invalid function call",ik="Unsupported destructuring pattern",ok="Table expressions do not support closures",sk="Use aq.escape(fn) to use a function as-is (including closures)",ak=`\nNote: ${ok}. ${sk}, or use table.params({ name: value }) to define dynamic parameters.`,lk=`\nNote: ${ok}. ${sk}, or use aq.addFunction(name, fn) to add new op functions.`,uk=`The ${Dh} method is not valid in multi-table expressions.`;function ck(t,e){const n=function(t){try{return function(t,e){return Ux.parse(t,e)}(`expr=(${t.field?function(t){const e=JSON.stringify(t+"");return t.table?`(a,b)=>b[${e}]`:`d=>d[${e}]`}(t):Ou(t)?Oc(t):t})`,H_).body[0].expression.right}catch(e){$u("Expression parse error: "+t)}}(e);let r=t.root=n;return t.spec=e,t.tuple=null,t.tuple1=null,t.tuple2=null,t.$param=null,t.$op=0,t.scope=new Set,t.paramsRef=new Map,t.columnRef=new Map,function(t){return Qw(Uc,t)||Qw(jc,t)}(r)?(function(t,e){t.generator&&K_("Generator functions")(t,e),t.async&&K_("Async functions")(t,e);const{params:n}=t,r=n.length,i=t=>(n,r)=>e.columnRef.set(n,[r,t]),o=(t,n)=>e.paramsRef.set(t,n);r&&(e.join?(pk(e,n[0],"tuple1",i(1)),r>1&&pk(e,n[1],"tuple2",i(2)),r>2&&pk(e,n[2],"$param",o)):(pk(e,n[0],"tuple",i(0)),r>1&&pk(e,n[1],"$param",o))),e.root=t.body}(r,t),r=r.body):t.join?(t.scope.add(t.tuple1=X_),t.scope.add(t.tuple2=J_),t.scope.add(t.$param=G_)):(t.scope.add(t.tuple=Y_),t.scope.add(t.$param=G_)),Uw(r,t,hk),t.root}const hk={FunctionDeclaration:K_("Function definitions"),ForStatement:K_("For loops"),ForOfStatement:K_("For-of loops"),ForInStatement:K_("For-in loops"),WhileStatement:K_("While loops"),DoWhileStatement:K_("Do-while loops"),AwaitExpression:K_("Await expressions"),ArrowFunctionExpression:K_("Function definitions"),AssignmentExpression:K_("Assignments"),FunctionExpression:K_("Function definitions"),NewExpression:K_('Use of "new"'),UpdateExpression:K_("Update expressions"),VariableDeclarator(t,e){Sk(t.id,e)},Identifier(t,e,n){yk(t,e,n)&&!e.scope.has(t.name)&&e.error(t,"Invalid variable reference",ak)},CallExpression(t,e){const n=mk(t.callee),r=xh(n)||_h(n);if(r){if((e.join||!1===e.aggregate)&&bh(n)&&Q_(t,e),(e.join||!1===e.window)&&vh(n)&&Z_(t,e),e.$op=1,e.ast)kk(t,n,e),t.arguments.forEach((t=>Uw(t,e,dk)));else{const i=e.op(function(t,e,n,r){const i=[],o=[],s=e.param[0]||0,a=s+(e.param[1]||0);return r.forEach(((e,n)=>{n<s?(Uw(e,t,dk),i.push(t.field(e))):n<a?(Uw(e,t,dk),o.push(t.param(e))):t.error(e,"Invalid operator parameter")})),{name:n,fields:i,params:o,...t.spec.window||{}}}(e,r,n,t.arguments));Object.assign(t,{type:"Op",name:i.id})}return e.$op=0,!1}wh(n)?kk(t,n,e):e.error(t,rk,lk)},MemberExpression(t,e,n){const{object:r,property:i}=t;if(!Qw(Vc,r))return;const{name:o}=r;if(gk(t)&&Qw(Vc,i)&&Gu(W_,i.name))return void _k(t,i.name);const s=o===e.tuple?0:o===e.tuple1?1:o===e.tuple2?2:-1;return s>=0?fk(t,s,e,bk,n):o===e.$param?fk(t,s,e,wk):void(e.paramsRef.has(o)?xk(t,e.paramsRef.get(o)):e.columnRef.has(o)?vk(r,o,e,t):Gu(e.params,o)&&xk(r,o))}};function fk(t,e,n,r,i){const{property:o,computed:s}=t;let a;if(s)if(Qw(qc,o))a=o.value;else try{Uw(o,n,hk,t),a=n.param(o)}catch(e){n.error(t,"Invalid member expression")}else a=o.name;return r(t,a,e,n,i),!1}const dk={...hk,VariableDeclarator:K_("Variable declaration in operator call"),Identifier(t,e,n){yk(t,e,n)&&e.error(t,"Variable not accessible in operator call")},CallExpression(t,e){const n=mk(t.callee);wh(n)?kk(t,n,e):e.error(t,rk,lk)}};function pk(t,e,n,r){Qw(Vc,e)?(t.scope.add(e.name),t[n]=e.name):Qw(Gc,e)&&e.properties.forEach((e=>{const n=Qw(Vc,e.key)?e.key.name:Qw(qc,e.key)?e.key.value:t.error(e,tk);Qw(Vc,e.value)||t.error(e.value,ik),r(e.value.name,n)}))}function mk(t){return Qw(Vc,t)?t.name:Qw(Wc,t)?gk(t)?"max"===(e=t.property.name)?"greatest":"min"===e?"least":e:t.property.name:null;var e}function gk(t){return Qw(Vc,t.object)&&"Math"===t.object.name}function yk(t,e,n){const{name:r}=t;if(Qw(Wc,n)&&n.property===t);else if(Qw(Yc,n)&&n.key===t);else if(e.paramsRef.has(r))xk(t,e.paramsRef.get(r));else if(e.columnRef.has(r))vk(t,r,e,n);else if(Gu(e.params,r))xk(t,r);else{if(!Gu(W_,r))return!0;_k(t,r)}}function bk(t,e,n,r,i){const o=0===n?r.table:n>0?r.join[n-1]:null,s=o&&o.column(e);o&&!s&&r.error(t,ek),r.aggronly&&!r.$op&&r.error(t,nk),Ah(t,e,n,s,i)}function vk(t,e,n,r){const[i,o]=n.columnRef.get(e);bk(t,i,o,n,r)}function wk(t,e,n,r){r.params&&!Gu(r.params,e)&&r.error(t,"Invalid param reference"),xk(t,e)}function xk(t,e){t.type=Qc,t.name=e}function _k(t,e){t.type=Jc,t.name=e,t.raw=W_[e]}function kk(t,e,n){if(e===Dh){const e=n.table;e||n.error(t,uk),Mh(t,t.arguments.length?t.arguments.map((t=>{const r=n.param(t),i=Fu(r)?e.columnName(r):r;return e.column(i)||n.error(t,ek),i})):e.columnNames())}else t.callee={type:"Function",name:e}}function Sk(t,e){Qw(Vc,t)?e.scope.add(t.name):Qw("ArrayPattern",t)?t.elements.forEach((t=>Sk(t,e))):Qw(Gc,t)?t.properties.forEach((t=>Sk(t.value,e))):e.error(t.id,"Unsupported variable declaration")}const Ek={[Xc]:1,[Zc]:1};function Ak(t,e={}){const n=e.generate||lh,r=e.compiler||Sh,i=function(t){return(t.table?Ck(t.table):t.join?{...Ck(t.join[1]),...Ck(t.join[0])}:{})||{}}(e),o={},s={},a=[],l=[];let u=0,c=-1;const h=e.join?r.join:1==e.index?r.expr2:r.expr,f={op(t){const e=function(t){let e=`${t.name}(${t.fields.concat(t.params).join(",")})`;if(t.frame){e+=`[${t.frame.map((t=>Number.isFinite(t)?Math.abs(t):-1))},${!!t.peers}]`}return e}(t);return s[e]||(t.id=++c,s[e]=t)},field(t){const e=n(t);return o[e]||(o[e]=++u)},param:t=>Qw(qc,t)?t.value:r.param(n(t),i),value(t,r){a.push(t);const o=r.escape||(e.ast?function(t){return Uw(t,null,{Column:Kw,Constant:Kw,Default:Jw}),t}(r):h(n(r),i));l.push(o),Ek[r.type]&&o!==r&&Uu(o)&&(o.field=r.name)},error(t,e,n=""){const r=t.start-6,i=t.end-6;$u(`${e}: "${String(f.spec).slice(r,i)}"${n}`)}};Object.assign(f,e,{params:i});for(const[e,n]of Ch(t))f.value(e+"",n.escape?ex(f,n,i):ck(f,n));if(e.ast)return{names:a,exprs:l};const d=[];for(const t in o)d[o[t]]=r.expr(t,i);const p=Object.values(s);return p.forEach((t=>t.fields=t.fields.map((t=>d[t])))),{names:a,exprs:l,ops:p}}function Ck(t){return t&&Lu(t.params)?t.params():{}}const Dk="Expr",Mk="ExprList",Ok="ExprNumber",Tk="ExprObject",Ik="JoinKeys",Nk="JoinValues",$k="Options",Fk="OrderKeys",Lk="SelectionList",Bk="TableRef",Rk="TableRefList",Pk="Descending",zk="Selection",jk="Window";function Uk(t,e){return t&&t.expr?new Vk({...t,...e}):new Vk(e,t)}class Vk{constructor(t,e){this.expr=e,Object.assign(this,t)}toString(){return String(this.expr)}toObject(){return{...this,expr:this.toString(),...Lu(this.expr)?{func:!0}:{}}}}function qk(t,e,n=0){const r=n?{field:!0,table:n}:{field:!0};return Uk(t,e?{expr:e,...r}:r)}function Wk(t,e){return(e=e&&Lu(e.query)?e.query():e)&&Lu(e.evaluate)?e.evaluate(null,t):t(e)}function Hk(t){return Uu(t)&&(Ou(t.all)||Ou(t.matches)||Ou(t.not)||Ou(t.range))}function Gk(t){return t&&Lu(t.toObject)?t.toObject():Lu(t)?{expr:String(t),func:!0}:Ou(t)?t.map(Gk):Uu(t)?Tw(t,(t=>Gk(t))):t}function Yk(t){return Ou(t)?t.map(Yk):Uu(t)?Ou(t.verbs)?cS.from(t):Ou(t.all)?Bw():Ou(t.range)?function(t,e){return Fw((n=>{let r=Fu(t)?t:n.columnIndex(t),i=Fu(e)?e:n.columnIndex(e);if(i<r){const t=i;i=r,r=t}return n.columnNames().slice(r,i+1)}),(()=>({range:[t,e]})))}(...t.range):Ou(t.match)?(qu(e=RegExp(...t.match))&&(e=RegExp(e.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&"))),Fw((t=>t.columnNames((t=>e.test(t)))),(()=>({matches:[e.source,e.flags]})))):Ou(t.not)?Rw(t.not.map(Gk)):function(t){let e=t,n=t.expr;if(null!=n){if(!0===t.field?e=n=qk(n):!0===t.func&&(e=n=function(t){const e=t=>t;return e.toString=()=>t,e}(n)),Uu(t.window)){const{frame:r,peers:i}=t.window;e=n=function(t,e,n){return Uk(t,{window:{frame:e||[-1/0,0],peers:!!n}})}(n,r,i)}!0===t.desc&&(e=function(t){return Uk(t,{desc:!0})}(n))}return t===e?Tw(t,(t=>Yk(t))):e}(t):t;var e}function Xk(t){const e=[];return Tu(t).forEach((t=>{Fu(t)?e.push(t):qu(t)?e.push(qk(t,null)):Uu(t)&&t.expr||Lu(t)?e.push(t):$u("Invalid key value: "+t)})),e}function Jk(t,e){return e<2?Tu(t):t}const Kk={[Dk]:iS,[Mk]:oS,[Ok]:function(t){return Fu(t)?t:eS(t)},[Tk]:eS,[Ik]:function(t){return Ou(t)?t.map(oS):eS(t,{join:!0})},[Nk]:function(t){return Ou(t)?t.map(((t,e)=>e<2?oS(t):eS(t,{join:!0}))):eS(t,{join:!0})},[Fk]:oS,[Lk]:function(t){return Tu(t).map(rS).flat()}};function Qk(t,e,n){return e===$k?t?function(t,e={}){const n={};for(const r in t){const i=t[r];n[r]=e[r]?Qk(i,e[r]):i}return n}(t,n):t:Kk[e](t)}function Zk(t){return{type:Xc,name:t}}function tS(t){return{type:Xc,index:t}}function eS(t,e){if(qu(t))return function(t,e){return Ak({expr:t},{...e,ast:!0}).exprs[0]}(t,e);if(t.expr){let n;if(!0===t.field?n=Zk(t.expr):!0===t.func&&(n=eS(t.expr,e)),n)return t.desc&&(n={type:Pk,expr:n}),t.window&&(n={type:jk,expr:n,...t.window}),n}return Object.keys(t).map((n=>({...eS(t[n],e),as:n})))}function nS(t){const e=zk;return t.all?{type:e,operator:"all"}:t.not?{type:e,operator:"not",arguments:oS(t.not)}:t.range?{type:e,operator:"range",arguments:oS(t.range)}:t.matches?{type:e,operator:"matches",arguments:t.matches}:$u("Invalid input")}function rS(t){return Hk(t)?nS(t):Fu(t)?tS(t):qu(t)?Zk(t):Uu(t)?Object.keys(t).map((e=>({type:Xc,name:e,as:t[e]}))):$u("Invalid input")}function iS(t){return Hk(t)?nS(t):Fu(t)?tS(t):qu(t)?Zk(t):Uu(t)?eS(t):$u("Invalid input")}function oS(t){return Tu(t).map(iS).flat()}function sS(t){return t&&Lu(t.toAST)?t.toAST():t}class aS{constructor(t,e=[],n=[]){this.verb=t,this.schema=e,e.forEach(((t,e)=>{const r=t.type,i=n[e],o=r===Ik?Ou(a=i)?a.map(Xk):a:r===Nk?Ou(s=i)?s.map(Jk):s:r===Fk?function(t){const e=[];return t.forEach((t=>{const n=null!=t.expr?t.expr:t;if(Uu(n)&&!Lu(n))for(const t in n)e.push(n[t]);else t=Fu(n)?n:qu(n)?qk(t):Lu(n)?t:$u("Invalid orderby field: "+t),e.push(t)})),e}(i):i;var s,a;this[t.name]=void 0!==o?o:t.default}))}static from(t){const e=uS[t.verb];return e(...(e.schema||[]).map((({name:e})=>Yk(t[e]))))}evaluate(t,e){const n=this.schema.map((({name:t,type:n})=>{const r=this[t];return n===Bk?Wk(e,r):n===Rk?r.map((t=>Wk(e,t))):r}));return t[this.verb](...n)}toObject(){const t={verb:this.verb};return this.schema.forEach((({name:e})=>{t[e]=Gk(this[e])})),t}toAST(){const t={type:"Verb",verb:this.verb};return this.schema.forEach((({name:e,type:n,props:r})=>{t[e]=function(t,e,n){return e===Bk?sS(t):e===Rk?t.map(sS):Qk(Gk(t),e,n)}(this[e],n,r)})),t}}function lS(t,e){return Object.assign(((...n)=>new aS(t,e,n)),{schema:e})}const uS={count:lS("count",[{name:"options",type:$k}]),derive:lS("derive",[{name:"values",type:Tk},{name:"options",type:$k,props:{before:Lk,after:Lk}}]),filter:lS("filter",[{name:"criteria",type:Tk}]),groupby:lS("groupby",[{name:"keys",type:Mk}]),orderby:lS("orderby",[{name:"keys",type:Fk}]),relocate:lS("relocate",[{name:"columns",type:Lk},{name:"options",type:$k,props:{before:Lk,after:Lk}}]),rename:lS("rename",[{name:"columns",type:Lk}]),rollup:lS("rollup",[{name:"values",type:Tk}]),sample:lS("sample",[{name:"size",type:Ok},{name:"options",type:$k,props:{weight:Dk}}]),select:lS("select",[{name:"columns",type:Lk}]),ungroup:lS("ungroup"),unorder:lS("unorder"),reify:lS("reify"),dedupe:lS("dedupe",[{name:"keys",type:Mk,default:[]}]),impute:lS("impute",[{name:"values",type:Tk},{name:"options",type:$k,props:{expand:Mk}}]),fold:lS("fold",[{name:"values",type:Mk},{name:"options",type:$k}]),pivot:lS("pivot",[{name:"keys",type:Mk},{name:"values",type:Mk},{name:"options",type:$k}]),spread:lS("spread",[{name:"values",type:Mk},{name:"options",type:$k}]),unroll:lS("unroll",[{name:"values",type:Mk},{name:"options",type:$k,props:{drop:Mk}}]),lookup:lS("lookup",[{name:"table",type:Bk},{name:"on",type:Ik},{name:"values",type:Mk}]),join:lS("join",[{name:"table",type:Bk},{name:"on",type:Ik},{name:"values",type:Nk},{name:"options",type:$k}]),cross:lS("cross",[{name:"table",type:Bk},{name:"values",type:Nk},{name:"options",type:$k}]),semijoin:lS("semijoin",[{name:"table",type:Bk},{name:"on",type:Ik}]),antijoin:lS("antijoin",[{name:"table",type:Bk},{name:"on",type:Ik}]),concat:lS("concat",[{name:"tables",type:Rk}]),union:lS("union",[{name:"tables",type:Rk}]),intersect:lS("intersect",[{name:"tables",type:Rk}]),except:lS("except",[{name:"tables",type:Rk}])};class cS extends Nu{constructor(t,e,n){super(e),this._verbs=t||[],this._table=n}static from({verbs:t,table:e,params:n}){return new cS(t.map(aS.from),n,e)}get[Symbol.toStringTag](){return this._verbs?`Query: ${this._verbs.length} verbs`+(this._table?` on '${this._table}'`:""):"Object"}get length(){return this._verbs.length}get tableName(){return this._table}params(t){return arguments.length?(this._params={...this._params,...t},this):this._params}evaluate(t,e){t=t||e(this._table);for(const n of this._verbs)t=n.evaluate(t.params(this._params),e);return t}toObject(){return hS(this,"toObject")}toJSON(){return this.toObject()}toAST(){return hS(this,"toAST",{type:"Query"})}}function hS(t,e,n){return{...n,verbs:t._verbs.map((t=>t[e]())),...t._params?{params:t._params}:null,...t._table?{table:t._table}:null}}function fS(t,e){return new cS(t._verbs.concat(e),t._params,t._table)}for(const t in uS){const e=uS[t];cS.prototype["__"+t]=function(t,...n){return fS(t,e(...n))}}function dS(t,e,...n){const r=["_","$"],i=r.slice(0,n.length);return i.push('"use strict"; const '+n.map(((t,e)=>t.map(((t,n)=>`${r[e]}${n} = ${r[e]}[${n}]`)).join(", "))).join(", ")+`; return (${t}) => ${e};`),Function(...i)(...n)}const pS=({typeId:t})=>-1===t,mS=({typeId:t})=>5===t;function gS(t,e){const{type:n,length:r,numChildren:i}=t;if(pS(n))return function(t){const{data:e,length:n,nullCount:r}=t,i=e[e.length-1].dictionary,o=i.length,s=function(t,e,n,r){const i=t.length>1||n?function(t,e,n){const r=new n.ArrayType(e),i=t.length;for(let e,n=0,o=0;n<i;++n)e=t[n].length,r.set(t[n].values.subarray(0,e),o),o+=e;return r}(t,e,t[0].type.indices):t[0].values;return n?function(t,e,n){const r=t.length;for(let i,o,s,a,l=0,u=0;l<r;++l){if(s=t[l].nullBitmap,i=t[l].length>>3,s&&s.length)for(let t=0;t<=i;++t)255!==(a=s[t])&&(o=u+(t<<3),1&a||(e[o+0]=n),2&a||(e[o+1]=n),4&a||(e[o+2]=n),8&a||(e[o+3]=n),16&a||(e[o+4]=n),32&a||(e[o+5]=n),64&a||(e[o+6]=n),128&a||(e[o+7]=n));u+=t[l].length}return e}(t,i,r):i}(e||[t],n,r,o),a=Array(o),l=t=>null==t||t<0||t>=o?null:void 0!==a[t]?a[t]:a[t]=i.get(t);return{vector:t,length:n,get:t=>l(s[t]),key:t=>s[t],keyFor(t){if(null===t)return r?o:-1;for(let e=0;e<o;++e)if(void 0===a[e]&&(a[e]=i.get(e)),a[e]===t)return e;return-1},groups(t){const e=o+(r?1:0);return{keys:s,get:[l],names:t,rows:Ac(0,e),size:e}},[Symbol.iterator]:()=>t[Symbol.iterator]()}}(t);const o=i&&e?vS(t):i?yS(vS(t)):mS(n)?yS((e=>t.get(e))):null;return o?{vector:t,length:r,get:o,[Symbol.iterator]:()=>function*(t,e){for(let n=0;n<t;++n)yield e(n)}(r,o)}:t}function yS(t){const e=[];return n=>{const r=e[n];return void 0!==r?r:e[n]=t(n)}}const bS=t=>t.numChildren?Bu(t.length,vS(t)):t.nullCount?[...t]:t.toArray(),vS=t=>(t=>(({typeId:t})=>12===t)(t)||(({typeId:t})=>16===t)(t))(t.type)?wS(t):(({typeId:t})=>13===t)(t.type)?function(t){const e=[],n=[];t.type.children.forEach(((r,i)=>{e.push(gS(t.getChildAt(i),!0)),n.push(`${Oc(r.name)}:_${i}.get(row)`)}));const r=dS("row","({"+n+"})",e);return t.nullCount?e=>t.isValid(e)?r(e):null:r}(t):$u(`Unsupported Arrow type: ${Oc(t.VectorName)}`),wS=t=>t.nullCount?e=>t.isValid(e)?bS(t.get(e)):null:e=>bS(t.get(e));function xS(t,e={}){t&&!t.batches&&(t=function(){try{return kw}catch(t){Sw()}}()(t));const n=t.schema.fields.map((t=>t.name)),r=$w({columnNames:t=>t?n.filter(t):n.slice(),columnIndex:t=>n.indexOf(t)},e.columns||Bw()),i=Yu();return r.forEach(((e,n)=>{i.add(e,gS(t.getChild(n)))})),new Pw(i.data,i.names)}const _S=t=>t,kS=[t=>"true"===t||"false"===t,t=>"false"!==t],SS=[t=>"NaN"===t||(t=+t)===t,t=>+t],ES=[cc,t=>new Date(Date.parse(t))];function AS(t){const{decimal:e}=t;return e&&"."!==e?SS.map((t=>n=>t(n&&n.replace(e,".")))):SS}function CS(t,e){const n=t.length;for(let r=0;r<n;++r){const n=t[r];if(null!=n&&!e(n))return!1}return!0}function DS(t,e=0){return Bu(t-e,(t=>`col${t+e+1}`))}const MS={},OS={},TS=34,IS=10,NS=13;function $S(t,e={}){const n=function(t,{delimiter:e=",",skip:n,comment:r}){1!==e.length&&$u(`Text "delimiter" should be a single character, found "${e}"`);const i=e.charCodeAt(0);let o,s=t.length,a=0,l=s<=0,u=!1;function c(){if(l)return OS;if(u)return u=!1,MS;const e=a;let n,r;if(t.charCodeAt(e)===TS){for(;a++<s&&t.charCodeAt(a)!==TS||t.charCodeAt(++a)===TS;);return(n=a)>=s?l=!0:(r=t.charCodeAt(a++))===IS?u=!0:r===NS&&(u=!0,t.charCodeAt(a)===IS&&++a),t.slice(e+1,n-1).replace(/""/g,'"')}for(;a<s;){if((r=t.charCodeAt(n=a++))===IS)u=!0;else if(r===NS)u=!0,t.charCodeAt(a)===IS&&++a;else if(r!==i)continue;return t.slice(e,n)}return l=!0,t.slice(e,s)}return t.charCodeAt(s-1)===IS&&--s,t.charCodeAt(s-1)===NS&&--s,function(t,e,n){let r=+e||0;for(;--r>=0;)t();return n?()=>{let e;for(;!e;){if(!n(e=t()))return e;e=null}}:t}((function(){if((o=c())!==OS){const t=[];for(;o!==MS&&o!==OS;)t.push(o),o=c();return t}}),n,r&&(t=>(t&&t[0]||"").startsWith(r)))}(t,e);return function(t,e,n){let r=t();const i=r.length,o=+n.autoMax||1e3,s=Bu(i,(()=>[]));e=e?e.length<i?[...e,DS(i,e.length)]:e:DS(i);let a=0;for(;a<o&&r;++a,r=t())for(let t=0;t<i;++t)s[t].push(""===r[t]?null:r[t]);const l=function(t,e,n){const{parse:r={}}=n,i=!1===n.autoType;return t.map(((t,o)=>Lu(r[t])?r[t]:i?_S:function(t,e){const n=[kS,AS(e),ES],r=n.length;for(let e=0;e<r;++e){const[r,i]=n[e];if(CS(t,r))return i}return _S}(e[o],n)))}(e,s,n);for(l.forEach(((t,e)=>{if(t===_S)return;const n=s[e];for(let e=0;e<a;++e)null!=n[e]&&(n[e]=t(n[e]))}));r;r=t())for(let t=0;t<i;++t)s[t].push(r[t]?l[t](r[t]):null);const u={};return e.forEach(((t,e)=>u[t]=s[e])),new Pw(u,e)}(n,!1!==e.header?n():e.names,e)}function FS(t,e){const n=Yu();return e.forEach(((e,r)=>{const i=qu(e)?e:r;if(i){const e=t.column(r)||$u(`Unrecognized column: ${r}`);n.add(i,e)}})),t.create(n)}function LS(t,e,{before:n,after:r}={}){const i=null!=n,o=null!=r;i||o||$u("relocate requires a before or after option."),i&&o&&$u("relocate accepts only one of the before or after options."),e=$w(t,e);const s=[...$w(t,i?n:r).keys()],a=i?s[0]:s.pop(),l=new Map;return t.columnNames().forEach((t=>{const n=!e.has(t);if(t===a){o&&n&&l.set(t,t);for(const[t,n]of e)l.set(t,n);if(o)return}n&&l.set(t,t)})),FS(t,l)}function BS(t,e=(t=>t),n=""){const r=t.length;if(!r)return"";let i=e(t[0],0);for(let o=1;o<r;++o)i+=n+e(t[o],o);return i}function RS(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function PS(t){return Mc(t)?t:+t}class zS{constructor(t){this._values=t||[],this._sorted=null,this._start=0}values(t){return this._start&&(this._values=this._values.slice(this._start),this._start=0),t?this._values.slice():this._values}add(t){this._values.push(t),this._sorted=null}rem(){this._start+=1,this._sorted=null}min(){return this._sorted&&this._sorted.length?this._sorted[0]:function(t,e=0,n=t.length){let r=n?t[e++]:Ju;for(let i=e;i<n;++i)r>t[i]&&(r=t[i]);return r}(this._values,this._start)}max(){return this._sorted&&this._sorted.length?this._sorted[this._sorted.length-1]:function(t,e=0,n=t.length){let r=n?t[e++]:Ju;for(let i=e;i<n;++i)r<t[i]&&(r=t[i]);return r}(this._values,this._start)}quantile(t){return this._sorted||(this._sorted=this.values(!0),this._sorted.sort(RS)),function(t,e){const n=t.length;if(!n)return Ju;if((e=+e)<=0||n<2)return PS(t[0]);if(e>=1)return PS(t[n-1]);const r=(n-1)*e,i=Math.floor(r),o=PS(t[i]);return Mc(o)?o:o+(PS(t[i+1])-o)*(r-i)}(this._sorted,t)}}const jS=(t,e,n)=>dS(e,"{"+BS(t,((t,r)=>`_${r}.${n}(${e});`))+"}",t);function US(t,e){const{ops:n,output:r}=function(t,e){const n={},r=[];function i(t,o=[]){const s=t+":"+o;if(n[s])return n[s];const a=xh(t),l=a.create(...o);return e<0&&a.stream&&a.stream.forEach((t=>i(t,[]))),a.req&&a.req.forEach((t=>i(t,[]))),n[s]=l,r.push(l),l}const o=t.map((t=>{const e=i(t.name,t.params);return e.output=t.id,e}));return{ops:r,output:o}}(t,e),i=t[0].fields,o=i.length;return new(0===o?VS:1===o?qS:2===o?WS:$u("Unsupported field count: "+o))(i,n,r,e)}class VS extends jw{constructor(t,e,n,r){super(n),this._op=e,this._fields=t,this._stream=!!r}init(){const t={count:0,valid:0,stream:this._stream};return this._op.forEach((e=>e.init(t))),t.values&&(t.list=new zS),t}write(t,e,n){const r=this._outputs,i=r.length;for(let o=0;o<i;++o)e[r[o].output][n]=r[o].value(t);return 1}_add(){}_rem(){}add(t){++t.count}rem(t){--t.count}}class qS extends VS{constructor(t,e,n,r){super(t,e,n,r);const i=["state","v1","v2"];this._add=jS(e,i,"add"),this._rem=jS(e,i,"rem")}add(t,e,n){const r=this._fields[0](e,n);++t.count,tc(r)&&(++t.valid,t.list&&t.list.add(r),this._add(t,r))}rem(t,e,n){const r=this._fields[0](e,n);--t.count,tc(r)&&(--t.valid,t.list&&t.list.rem(),this._rem(t,r))}}class WS extends VS{constructor(t,e,n,r){super(t,e,n,r);const i=["state","v1","v2"];this._add=jS(e,i,"add"),this._rem=jS(e,i,"rem")}add(t,e,n){const r=this._fields[0](e,n),i=this._fields[1](e,n);++t.count,tc(r)&&tc(i)&&(++t.valid,t.list&&t.list.add([r,i]),this._add(t,r,i))}rem(t,e,n){const r=this._fields[0](e,n),i=this._fields[1](e,n);--t.count,tc(r)&&tc(i)&&(--t.valid,t.list&&t.list.rem(),this._rem(t,r,i))}}function HS(t,e,n){if(e.length){const r=t.data(),{keys:i}=t.groups()||{},o=GS(t,e),s=i?(t,e)=>o[t][i[e]]:t=>o[t][0];n=n.map((t=>e=>t(e,r,s)))}return n}function GS(t,e,n){if(!e.length)return n;const r=YS(e),i=t.groups(),o=i?i.size:1;return n=n||Bu(e.length,(()=>Array(o))),o>1?r.forEach((e=>{const r=JS(t,e,i);for(let t=0;t<o;++t)e.write(r[t],n,t)})):r.forEach((e=>{const r=XS(t,e);e.write(r,n,0)})),n}function YS(t,e){const n=[],r={};for(const e of t){const t=e.fields.map((t=>t+"")).join(",");(r[t]||(r[t]=[])).push(e)}for(const t in r)n.push(US(r[t],e));return n}function XS(t,e){const n=e.init(),r=t.totalRows(),i=t.data(),o=t.mask();if(t.isOrdered()){const o=t.indices();for(let t=0;t<r;++t)e.add(n,o[t],i)}else if(o)for(let t=o.next(0);t>=0;t=o.next(t+1))e.add(n,t,i);else for(let t=0;t<r;++t)e.add(n,t,i);return n}function JS(t,e,n){const{keys:r,size:i}=n,o=Bu(i,(()=>e.init())),s=t.data();if(t.isOrdered()){const n=t.indices(),i=n.length;for(let t=0;t<i;++t){const i=n[t];e.add(o[r[i]],i,s)}}else if(t.isFiltered()){const n=t.mask();for(let t=n.next(0);t>=0;t=n.next(t+1))e.add(o[r[t]],t,s)}else{const n=t.totalRows();for(let t=0;t<n;++t)e.add(o[r[t]],t,s)}return o}function KS(t,e){const{get:n,names:r,rows:i,size:o}=e,s=r.length;for(let e=0;e<s;++e){const s=t.add(r[e],Array(o)),a=n[e];for(let t=0;t<o;++t)s[t]=a(i[t])}}function QS(t){return{left(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){const o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right(e,n,r,i){for(null==r&&(r=0),null==i&&(i=e.length);r<i;){const o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}}const ZS=QS(RS),tE=t=>(t.frame||[null,null]).map((t=>Number.isFinite(t)?Math.abs(t):null)),eE=t=>!!t.peers;function nE(t){return vh(t.name)||t.frame&&(Number.isFinite(t.frame[0])||Number.isFinite(t.frame[1]))}function rE(t,{names:e,exprs:n,ops:r},i={}){const o=t.totalRows(),s=Yu(i.drop?null:t),a=e.map((t=>s.add(t,Array(o)))),[l,u]=function(t){const e=[],n=[],r=t.length;for(let i=0;i<r;++i){const r=t[i];r.id=i,(nE(r)?n:e).push(r)}return[e,n]}(r),c=t.isGrouped()?t.groups().size:1,h=GS(t,l,Bu(r.length,(()=>Array(c))));return u.length?function(t,e,n,r={},i){const o=t.data(),s=function(t,e){const n={};return t.forEach((t=>{const e=tE(t),r=eE(t),i=`${e},${r}`,{aggOps:o,winOps:s}=n[i]||(n[i]={frame:e,peers:r,aggOps:[],winOps:[]});bh(t.name)?o.push(t):s.push(function(t){const{id:e,name:n,fields:r=[],params:i=[]}=t,o=_h(n).create(...i);return r.length&&(o.get=r[0]),o.id=e,o}(t))})),Object.values(n).map((t=>function(t,e,n,r,i){let o,s,a,l,u;const c=t=>s[t-1]===s[t],h=r.length,f=i.length,d=r.length?dS(["w","r","k"],"{"+BS(r,((t,e)=>`r[_${e}.id][k]=_${e}.value(w,_${e}.get);`))+"}",r):()=>{},p={i0:0,i1:0,index:0,size:0,peer:c,init(t,e,n,c){p.index=p.i0=p.i1=0,p.size=e.length,o=t,s=e,l=n,u=c,a=i?i.map((t=>t.init())):null;for(let t=0;t<h;++t)r[t].init();return p},value:(e,n)=>n(o[e],t),step(r){const[h,m]=e,g=p.size,y=p.i0,b=p.i1;p.i0=null!=h?Math.max(0,r-Math.abs(h)):0,p.i1=null!=m?Math.min(g,r+Math.abs(m)+1):g,p.index=r,n&&(p.i0>0&&c(p.i0)&&(p.i0=ZS.left(s,s[p.i0])),p.i1<g&&c(p.i1)&&(p.i1=ZS.right(s,s[p.i1-1])));for(let e=0;e<f;++e){const n=i[e],r=a[e];for(let e=y;e<p.i0;++e)n.rem(r,o[e],t);for(let e=b;e<p.i1;++e)n.add(r,o[e],t);n.write(r,l,u)}return d(p,l,u),l}};return p}(e,t.frame,t.peers,t.winOps,YS(t.aggOps,null!=t.frame[0]?-1:1))))}(i,o),a=s.length,l=dS(["r","d","op"],"{"+BS(e,((t,e)=>`_${e}[r] = $${e}(r, d, op);`))+"}",e,n);t.partitions().forEach(((e,n)=>{const i=e.length,u=function(t,e){if(t.isOrdered()){const n=t.comparator(),r=t.data(),i=e.length,o=new Uint32Array(i);for(let t=1,s=0;t<i;++t)o[t]=n(e[t-1],e[t],r)?++s:s;return o}return e}(t,e);for(let t=0;t<a;++t)s[t].init(e,u,r,n);const c=t=>r[t][n];for(let t=0;t<i;++t){for(let e=0;e<a;++e)s[e].step(t);l(e[t],o,c)}}))}(t,a,n,h,u):function(t,e,n,r){const i=t.mask(),o=t.data(),{keys:s}=t.groups()||{},a=s?(t,e)=>r[t][s[e]]:t=>r[t][0],l=e.length;for(let r=0;r<l;++r){const s=n[r],l=e[r];if(i)for(let t=i.next(0);t>=0;t=i.next(t+1))l[t]=s(t,o,a);else{const e=t.totalRows();for(let t=0;t<e;++t)l[t]=s(t,o,a)}}}(t,a,n,h),t.create(s)}const iE=2147483648;class oE{constructor(t){this._size=t,this._bits=new Uint32Array(Math.ceil(t/32))}get length(){return this._size}count(){const t=this._bits.length;let e=0;for(let n=0;n<t;++n)for(let t=this._bits[n];t;++e)t&=t-1;return e}get(t){return this._bits[t>>5]&iE>>>t}set(t){this._bits[t>>5]|=iE>>>t}clear(t){this._bits[t>>5]&=~(iE>>>t)}scan(t){for(let e=this.next(0);e>=0;e=this.next(e+1))t(e)}next(t){const e=this._bits,n=e.length;let r=t>>5,i=e[r]&4294967295>>>t;for(;r<n;i=e[++r])if(0!==i)return(r<<5)+Math.clz32(i);return-1}nth(t){let e=this.next(0);for(;t--&&e>=0;)e=this.next(e+1);return e}not(){const t=this._bits,e=t.length;for(let n=0;n<e;++n)t[n]=~t[n];const n=this._size%32;return n&&(t[e-1]&=iE>>n-1),this}and(t){if(t){const e=this._bits,n=t._bits,r=e.length;for(let t=0;t<r;++t)e[t]&=n[t]}return this}or(t){if(t){const e=this._bits,n=t._bits,r=e.length;for(let t=0;t<r;++t)e[t]|=n[t]}return this}}function sE(t,{names:e=[],exprs:n=[],ops:r=[]},i={}){if(!e.length)return t;const o=i.limit>0?+i.limit:1/0,s=i.index?!0===i.index?"index":i.index+"":null,a=new Set(i.drop),l=HS(t,r,n),u=Yu(),c=new Set(e),h=[],f=[],d=[];t.columnNames().forEach((e=>{if(!a.has(e)){const n=u.add(e,[]);c.has(e)||(h.push(t.column(e)),f.push(n))}})),e.forEach((t=>{a.has(t)||(u.has(t)||u.add(t,[]),d.push(u.data[t]))}));const p=s?u.add(s,[]):null;let m=0;const g=h.length,y=d.length,b=(t,e)=>{for(let n=0;n<g;++n)f[n].length=m+e,f[n].fill(h[n].get(t),m,m+e)},v=p?(t,e)=>{for(let n=0;n<e;++n)p[t+n]=n}:()=>{};if(1===y){const e=l[0],n=d[0];t.scan(((t,r)=>{const i=Tu(e(t,r)),s=Math.min(i.length,o);b(t,s);for(let t=0;t<s;++t)n[m+t]=i[t];v(m,s),m+=s}))}else t.scan(((t,e)=>{let n=0;const r=l.map((r=>{const i=Tu(r(t,e));return n=Math.min(Math.max(n,i.length),o),i}));b(t,n);for(let t=0;t<y;++t){const e=d[t],i=r[t];for(let t=0;t<n;++t)e[m+t]=i[t]}v(m,n),m+=n}));return t.create(u.new())}function aE(t,e,n,r={window:!1}){const i=new Map,o=n=>{qu(n=Fu(n)?e.columnName(n):n)?i.set(n,qk(n)):Lu(n)?$w(e,n).forEach(o):Uu(n)?Nw(i,n):$u(`Invalid ${t} value: ${n+""}`)};return Tu(n).forEach(o),r.preparse&&r.preparse(i),Ak(i,{table:e,...r})}function lE(t,e,n,r){const i=n&&n.length;return function(t,{names:e,exprs:n,ops:r},i){const o=HS(t,r,n),s=i?null:Yu(t),a=t.totalRows();return e.forEach(((e,n)=>{const r=t.column(e),l=i?r.data:s.add(e,Array(a)),u=o[n];t.scan((t=>{const e=r.get(t);l[t]=tc(e)?e:u(t)}))})),i?t:t.create(s)}(i?function(t,e,n){const r=t.groups(),i=t.data(),o=(r?r.names:[]).concat(e),s=(r?r.get:[]).concat(e.map((e=>t.getter(e)))),a=new Set,l=ch(s);t.scan(((t,e)=>a.add(l(t,e))));const u=t.columnNames(),c=Yu(),h=u.map((t=>c.add(t,[])));u.forEach(((e,n)=>{const r=i[e],o=h[n];t.scan((t=>o.push(r.get(t))))}));const f=ch(s.map(((t,e)=>t=>t[e]))),d=dS("v","{"+h.map(((t,e)=>`_${e}.push(v[$${e}]);`)).join("")+"}",h,u.map((t=>o.indexOf(t))));if(r){let t=r.keys.length;const e=n.reduce(((t,e)=>t*e.length),r.size),i=new Uint32Array(e+(t-a.size));i.set(r.keys),uE(r,n,((e,n)=>{a.has(f(e))||(d(e),i[t++]=n[0])})),c.groupby({...r,keys:i})}else uE(r,n,(t=>{a.has(f(t))||d(t)}));return t.create(c.new())}(t,n,r):t,e,i)}function uE(t,e,n){const r=t?t.get.length:0,i=t?1:0,o=i+e.length,s=new Int32Array(o),a=new Int32Array(o),l=[];if(t){const{get:e,rows:n,size:i}=t;s[0]=i,l.push(((t,i)=>{const o=n[i];for(let n=0;n<r;++n)t[n]=e[n](o)}))}e.forEach(((t,e)=>{const n=e+r;s[e+i]=t.length,l.push(((e,r)=>e[n]=t[r]))}));const u=Array(r+e.length);for(let t=0;t<o;++t)l[t](u,0);n(u,a);for(let t=o-1;t>=0;){const e=++a[t];e<s[t]?(l[t](u,e),n(u,a),t=o-1):(a[t]=0,l[t](u,0),--t)}}function cE(t,{names:e,exprs:n,ops:r}){const i=Yu(),o=t.groups();return o&&KS(i,o),function(t,e,n,r=[],i){if(!e.length)return;const o=n?n.size:1,s=(t,e)=>r[t][e],a=t.length;for(let n=0;n<a;++n){const a=e[n];if(null!=a.field)i.add(t[n],r[a.field]);else if(o>1){const e=i.add(t[n],Array(o));for(let t=0;t<o;++t)e[t]=a(t,null,s)}else i.add(t[n],[a(0,null,s)])}}(e,n,o,GS(t,r),i),t.create(i.new())}function hE(t){t.forEach(((e,n)=>e.field?t.set(n,Lc(e+"")):0))}function fE(t,e){const n=new Map;return t.scan(((t,r)=>{const i=e(t,r);null!=i&&i==i&&n.set(i,t)})),n}function dE(t,e,n,{names:r,exprs:i},o={}){const s=t.data(),a=t.indices(!1),l=a.length,u=new Int32Array(l),c=e.data(),h=e.indices(!1),f=h.length,d=new Int32Array(f),p=r.length,m=Yu(),g=Array(p),y=Array(p);for(let t=0;t<r.length;++t)g[t]=m.add(r[t],[]),y[t]=i[t];const b=function(t,e){const n=["i","a","j","b"];return dS(n,"{"+BS(t,((t,e)=>`_${e}.push($${e}(${n}));`))+"}",t,e)}(g,y);if((Ou(n)?mE:pE)(b,n,s,c,a,h,u,d,l,f),o.left)for(let t=0;t<l;++t)u[t]||b(a[t],s,-1,c);if(o.right)for(let t=0;t<f;++t)d[t]||b(-1,s,h[t],c);return t.create(m.new())}function pE(t,e,n,r,i,o,s,a,l,u){for(let c=0;c<l;++c){const l=i[c];for(let i=0;i<u;++i){const u=o[i];e(l,n,u,r)&&(t(l,n,u,r),s[c]=1,a[i]=1)}}}function mE(t,[e,n],r,i,o,s,a,l,u,c){let h,f,d,p,m,g,y,b,v=t;u>=c?(h=r,f=e,d=a,p=o,m=i,g=n,y=l,b=s):(h=i,f=n,d=l,p=s,m=r,g=e,y=a,b=o,v=(e,n,r,i)=>t(r,i,e,n));const w=function(t,e,n){const r=new Map,i=t.length;for(let o=0;o<i;++o){const i=n(t[o],e);null!=i&&i==i&&(r.has(i)?r.get(i).push(o):r.set(i,[o]))}return r}(b,m,g),x=p.length;for(let t=0;t<x;++t){const e=p[t],n=w.get(f(e,h));if(n){const r=n.length;for(let t=0;t<r;++t){const r=n[t];v(e,h,b[r],m),y[r]=1}d[t]=1}}}function gE(t,e,n){const r=new Map;return Tu(n).forEach(((n,i)=>{qu(n=Fu(n)?e.columnName(n):n)?r.set(i,qk(n)):Lu(n)||Uu(n)&&n.expr?r.set(i,n):$u(`Invalid ${t} key value: ${n+""}`)})),ch(Ak(r,{table:e,aggregate:!1,window:!1}).exprs,!0)}function yE(t,e,n){if(n)qu(n)?n=[n,n]:Ou(n)&&1===n.length&&(n=[n[0],n[0]]);else{const r=function(t,e){const n=new Set(e);return t.filter((t=>n.has(t)))}(t.columnNames(),e.columnNames());r.length||$u("Natural join requires shared column names."),n=[r,r]}return n}function bE(t,e,n,r){return n.length!==r.length&&$u("Mismatched number of join keys"),[gE("join",t,n),gE("join",e,r)]}const vE={aggregate:!1,window:!1,index:1};function wE(t,e,n,r,i={}){n=yE(t,e,n);const o={join:[t,e]};let s;if(Ou(n)){const[o,a]=n.map(Tu);s=bE(t,e,o,a),r||(r=function(t,e,n,r){const i=[];e.forEach(((t,e)=>qu(t)&&t===n[e]?i.push(t):0));const o=Rw(i);if(r.left&&r.right){const e=new Set(i);return[t.columnNames().map((t=>{const n=`[${Oc(t)}]`;return e.has(t)?{[t]:`(a, b) => a${n} == null ? b${n} : a${n}`}:t})),o]}return r.right?[o,Bw()]:[Bw(),o]}(t,o,a,i))}else s=Ak({on:n},o).exprs[0],r||(r=[Bw(),Bw()]);return dE(t,e,s,function(t,e,n,r,i=[]){if(Ou(n)){let o,s,a,l=n.length;o=s=a={names:[],exprs:[]},l--&&(o=aE("join",t,n[0],r)),l--&&(s=aE("join",e,n[1],vE)),l--&&(a=Ak(n[2],r));const u=new Set,c=new Set(o.names);return s.names.forEach((t=>{c.has(t)&&u.add(t)})),u.size&&(""!==i[0]&&xE(o.names,u,i[0]||"_1"),""!==i[1]&&xE(s.names,u,i[1]||"_2")),{names:o.names.concat(s.names,a.names),exprs:o.exprs.concat(s.exprs,a.exprs)}}return Ak(n,r)}(t,e,r,o,i&&i.suffix),i)}function xE(t,e,n){t.forEach(((r,i)=>e.has(r)?t[i]=r+n:0))}function _E(t,e,n,[r,i]){const o=fE(n,i);e.scan(((e,n)=>{o.get(r(e,n))>=0&&t.set(e)}))}function kE(t,e,n,r){const i=e.numRows(),o=n.numRows(),s=e.data(),a=n.data();if(e.isFiltered()||n.isFiltered()){const l=e.indices(!1),u=n.indices(!1);for(let e=0;e<i;++e){const n=l[e];for(let e=0;e<o;++e)if(r(n,s,u[e],a)){t.set(n);break}}}else for(let e=0;e<i;++e)for(let n=0;n<o;++n)if(r(e,s,n,a)){t.set(e);break}}function SE(t,e,n,r){return n=yE(t,e,n),function(t,e,n,r={}){const i=new oE(t.totalRows());return(Ou(n)?_E:kE)(i,t,e,n),r.anti&&i.not().and(t.mask()),t.create({filter:i})}(t,e,Ou(n)?bE(t,e,...n.map(Tu)):Ak({on:n},{join:[t,e]}).exprs[0],r)}const EE=(t,e)=>null!=t?t:e;function AE(t){t.forEach(((e,n)=>e.field?t.set(n,Nc(e+"")):0))}function CE(t,e){return cE(t,Ak(e,{table:t,aggronly:!0,window:!1}))}function DE(t,e,n,r){return(e?r?OE:ME:r?IE:TE)(t.length,t,n,r)}function ME(t,e,n){const r=n.length;for(let i=0;i<t;++i)e[i]=n[r*xc()|0];return e}function OE(t,e,n,r){const i=n.length,o=new Float64Array(i);let s=0;for(let t=0;t<i;++t)o[t]=s+=r(n[t]);const a=QS(RS).right;for(let r=0;r<t;++r)e[r]=n[a(o,s*xc())];return e}function TE(t,e,n){const r=n.length;if(t>=r)return n;for(let r=0;r<t;++r)e[r]=n[r];for(let i=t;i<r;++i){const r=i*xc();r<t&&(e[0|r]=n[i])}return e}function IE(t,e,n,r){const i=n.length;if(t>=i)return n;const o=new Float32Array(i),s=new Uint32Array(i);for(let t=0;t<i;++t)s[t]=t,o[t]=-Math.log(xc())/r(n[t]);s.sort(((t,e)=>o[t]-o[e]));for(let r=0;r<t;++r)e[r]=n[s[r]];return e}const NE=t=>e=>t.get(e)||0;function $E(t,{names:e=[],exprs:n=[],ops:r=[]}){const i=e.length;if(0===i)return null;if(1===i&&!t.isFiltered()&&n[0].field){const r=t.column(n[0].field);if(r.groups)return r.groups(e)}let o=HS(t,r,n);const s=ch(o),a=t.totalRows(),l=new Uint32Array(a),u={},c=[],h=t.data(),f=t.mask();if(f)for(let t=f.next(0);t>=0;t=f.next(t+1)){const e=s(t,h)+"",n=u[e];l[t]=null!=n?n:u[e]=c.push(t)-1}else for(let t=0;t<a;++t){const e=s(t,h)+"",n=u[e];l[t]=null!=n?n:u[e]=c.push(t)-1}return r.length||(o=o.map((t=>e=>t(e,h)))),{keys:l,get:o,names:e,rows:c,size:c.length}}const FE=(t,e,n,r)=>`((u = ${t}) < (v = ${e}) || u == null) && v != null ? ${n}\n    : (u > v || v == null) && u != null ? ${r}\n    : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}\n    : v !== v && u === u ? ${r} : `,LE={__antijoin:(t,e,n)=>SE(t,e,n,{anti:!0}),__count:(t,e={})=>CE(t,{[e.as||"count"]:$c()}),__cross:(t,e,n,r)=>wE(t,e,(()=>!0),n,{...r,left:!0,right:!0}),__concat:function(t,e){const n=t.numRows(),r=n+e.reduce(((t,e)=>t+e.numRows()),0);if(n===r)return t;const i=[t,...e],o=Yu();return t.columnNames().forEach((t=>{const e=Array(r);let n=0;i.forEach((r=>{const i=r.column(t)||{get:()=>Ju};r.scan((t=>e[n++]=i.get(t)))})),o.add(t,e)})),t.create(o.new())},__dedupe:function(t,e=[]){return t.groupby(e.length?e:t.columnNames()).filter("row_number() === 1").ungroup().reify()},__derive:function(t,e,n={}){const r=rE(t,Ak(e,{table:t}),n);return n.drop||null==n.before&&null==n.after?r:LS(r,Object.keys(e).filter((e=>!t.column(e))),n)},__except:function(t,e){if(0===e.length)return t;const n=t.columnNames();return e.reduce(((t,e)=>t.antijoin(e.select(n))),t).dedupe()},__filter:function(t,e){const n=Ak({p:e},{table:t});let r=n.exprs[0];if(n.ops.length){const{data:e}=rE(t,n,{drop:!0}).column("p");r=t=>e[t]}return function(t,e){const n=t.totalRows(),r=t.mask(),i=t.data(),o=new oE(n);if(r)for(let t=r.next(0);t>=0;t=r.next(t+1))e(t,i)&&o.set(t);else for(let t=0;t<n;++t)e(t,i)&&o.set(t);return t.create({filter:o})}(t,r)},__fold:function(t,e,n){return function(t,{names:e=[],exprs:n=[],ops:r=[]},i={}){if(0===e.length)return t;const[o="key",s="value"]=i.as||[],a=HS(t,r,n);return sE(t,{names:[o,s],exprs:[()=>e,(t,e)=>a.map((n=>n(t,e)))]},{...i,drop:e})}(t,aE("fold",t,e),n)},__impute:function(t,e,n={}){if((e=Ak(e,{table:t})).names.forEach((e=>t.column(e)?0:$u(`Invalid impute column ${Oc(e)}`))),n.expand){const r={preparse:hE,aggronly:!0},i=aE("impute",t,n.expand,r),o=cE(t.ungroup(),i);return lE(t,e,i.names,i.names.map((t=>o.get(t,0))))}return lE(t,e)},__intersect:function(t,e){const n=t.columnNames();return e.length?e.reduce(((t,e)=>t.semijoin(e.select(n))),t).dedupe():t.reify([])},__join:wE,__lookup:function(t,e,n,r){return function(t,e,[n,r],{names:i,exprs:o,ops:s}){const a=Yu(t),l=t.totalRows();i.forEach((t=>a.add(t,Array(l).fill(Ju))));const u=fE(e,r),c=dS(["lr","rr","data"],"{"+BS(i,((t,e)=>`_[${e}][lr] = $[${e}](rr, data);`))+"}",i.map((t=>a.data[t])),HS(e,s,o)),h=e.data();return t.scan(((t,e)=>{const r=u.get(n(t,e));r>=0&&c(t,r,h)})),t.create(a)}(t,e,[gE("lookup",t,(n=yE(t,e,n))[0]),gE("lookup",e,n[1])],aE("lookup",e,r))},__pivot:function(t,e,n,r){return function(t,e,n,r={}){const{keys:i,keyColumn:o}=function(t,e,n){const r=n.limit>0?+n.limit:1/0,i=EE(n.sort,!0),o=EE(n.keySeparator,"_"),s=HS(t,e.ops,e.exprs),a=1===s.length?s[0]:(t,e)=>s.map((n=>n(t,e))).join(o),l=Array(t.totalRows());t.scan(((t,e)=>l[t]=a(t,e)));const u=GS(t.ungroup(),[{id:0,name:"array_agg_distinct",fields:[t=>l[t]],params:[]}])[0][0],c=i?u.sort():u;return{keys:Number.isFinite(r)?c.slice(0,r):c,keyColumn:l}}(t,e,r),s=EE(r.valueSeparator,"_"),a=n.names.length>1?(t,e)=>e+s+i[t]:t=>i[t],l=i.map((e=>GS(t,n.ops.map((t=>{if("count"===t.name){const n=t=>e===o[t]?1:NaN;return n.toString=()=>e+":1",{...t,name:"sum",fields:[n]}}const n=t.fields.map((t=>{const n=(n,r)=>e===o[n]?t(n,r):NaN;return n.toString=()=>e+":"+t,n}));return{...t,fields:n}})))));return t.create(function({names:t,exprs:e},n,r,i){const o=r?r.size:1,s=Yu(),a=i.length,l=t.length;let u;const c=(t,e)=>u[t][e];r&&KS(s,r);for(let r=0;r<l;++r){const l=e[r];if(null!=l.field)for(let e=0;e<a;++e)s.add(n(e,t[r]),i[e][l.field]);else if(o>1)for(let e=0;e<a;++e){u=i[e];const a=s.add(n(e,t[r]),Array(o));for(let t=0;t<o;++t)a[t]=l(t,null,c)}else for(let e=0;e<a;++e)u=i[e],s.add(n(e,t[r]),[l(0,null,c)])}return s.new()}(n,a,t.groups(),l))}(t,aE("fold",t,e),aE("fold",t,n,{preparse:AE,aggronly:!0}),r)},__relocate:LS,__rename:function(t,e){const n=new Map;return t.columnNames((t=>(n.set(t,t),0))),FS(t,$w(t,e,n))},__rollup:CE,__sample:function(t,e,n={}){return function(t,e,n,r={}){const{replace:i,shuffle:o}=r,s=t.partitions(!1);let a=0;e=s.map(((t,n)=>{let r=e(n);return a+=r=i?r:Math.min(t.length,r),r}));const l=new Uint32Array(a);let u=0;return s.forEach(((t,r)=>{const o=e[r],s=l.subarray(u,u+=o);i||o!==t.length?DE(s,i,t,n):s.set(t)})),!1!==o&&(s.length>1||!i)&&function(t,e=0,n=t.length){let r=n-(e=+e);for(;r;){const n=xc()*r--|0,i=t[r+e];t[r+e]=t[n+e],t[n+e]=i}}(l),t.reify(l)}(t,function(t,e){return Fu(e)?()=>e:NE(cE(t,Ak({size:e},{table:t,window:!1})).column("size"))}(t,e),function(t,e){return null==e?null:(e=Fu(e)?t.columnName(e):e,NE(qu(e)?t.column(e):rE(t,Ak({w:e},{table:t}),{drop:!0}).column("w")))}(t,n.weight),n)},__select:function(t,e){return FS(t,$w(t,e))},__semijoin:SE,__spread:function(t,e,n){return function(t,{names:e,exprs:n,ops:r=[]},i={}){if(0===e.length)return t;const o=1===e.length&&i.as||[],s=null==i.drop||!!i.drop,a=null==i.limit?o.length||1/0:Math.max(1,+i.limit||1),l=HS(t,r,n),u=Yu(),c=e.reduce(((t,e,n)=>t.set(e,n)),new Map),h=(e,n)=>{const r=function(t,e,n){const r=t.totalRows(),i=[];return t.scan(((t,o)=>{const s=Tu(e(t,o)),a=Math.min(s.length,n);for(;i.length<a;)i.push(Array(r).fill(Ju));for(let e=0;e<a;++e)i[e][t]=s[e]})),i}(t,l[e],a),i=r.length;for(let t=0;t<i;++t)u.add(o[t]||`${n}_${t+1}`,r[t])};return t.columnNames().forEach((e=>{c.has(e)?(s||u.add(e,t.column(e)),h(c.get(e),e),c.delete(e)):u.add(e,t.column(e))})),c.forEach(h),t.create(u)}(t,aE("spread",t,e),n)},__union:function(t,e){return t.concat(e).dedupe()},__unroll:function(t,e,n){return sE(t,aE("unroll",t,e),n&&n.drop?{...n,drop:aE("unroll",t,n.drop).names}:n)},__groupby:function(t,e){return function(t,e){return t.create({groups:$E(t,e)})}(t,aE("groupby",t,e))},__orderby:function(t,e){return function(t,e){return t.create({order:e})}(t,function(t,e){let n=-1;const r=new Map,i=t=>r.set(++n+"",t);return e.forEach((e=>{const n=null!=e.expr?e.expr:e;if(Uu(n)&&!Lu(n))for(const t in n)i(n[t]);else i(Fu(n)?qk(e,t.columnName(n)):qu(n)?qk(e):Lu(n)?e:$u("Invalid orderby field: "+e))})),function(t,e){const n=[],r=[],i=[];let o=null,s="0",a="0";t.isGrouped()&&(o=t.groups().keys,s="ka",a="kb");const{ops:l}=Ak(e,{table:t,value:(t,e)=>{if(n.push(t),e.escape){const t=t=>`fn[${i.length}](${t}, data)`;r.push([t("a"),t("b")]),i.push(e.escape)}else r.push([lh(e,{index:"a",op:s}),lh(e,{index:"b",op:a})])},window:!1}),u=GS(t,l),c=(t,e)=>u[t][e],h=n.length;let f="return (a, b) => {"+(c&&t.isGrouped()?"const ka = keys[a], kb = keys[b];":"")+"let u, v; return ";for(let t=0;t<h;++t){const i=e.get(n[t]).desc?-1:1,[o,s]=r[t];f+=FE(o,s,-i,i)}return f+="0;};",Function("op","keys","fn","data",f)(c,o,i,t.data())}(t,r)}(t,e))},__ungroup:function(t){return t.isGrouped()?t.create({groups:null}):t},__unorder:function(t){return t.isOrdered()?t.create({order:null}):t},__reduce:function(t,e){const n=Yu(),r=t.groups(),{get:i,names:o=[],rows:s,size:a=1}=r||{},l=new Uint32Array(a+1);o.forEach((t=>n.add(t,null)));const u=r?JS(t,e,r):[XS(t,e)];e.outputs().map((t=>n.add(t,[])));const c=l.length-1;let h=0;for(let t=0;t<c;++t)h+=l[t+1]=e.write(u[t],n.data,l[t]);if(r){const e=t.data();o.forEach(((t,r)=>{const o=n.data[t]=Array(h),u=i[r];for(let t=0,n=0;t<a;++t)o.fill(u(s[t],e),n,n+=l[t+1])}))}return t.create(n.new())}};function BE(t,e){return function(t,e={}){const n=e.using||$S;return fetch(t,e.fetch).then((t=>t[e.as||"text"]())).then((t=>n(t,e)))}(t,{...e,as:"arrayBuffer",using:xS})}function RE(t,e){return t.ungroup().rollup({_:e}).get("_")}Object.assign(Pw.prototype,LE),Pw.prototype;class PE{constructor(t){this.owner=t,this.capabilities=To("3.23",{hasValue:!0})}createHelper(t,e){const{owner:n}=this,r=new Proxy({},{get:(t,e)=>n&&n.lookup({type:"service",name:e})});return{fn:t,args:e,ownerProxy:r}}getValue({fn:t,args:e,ownerProxy:n}){return t(e.positional,e.named,{services:n})}getDebugName(t){return t.name||"(anonymous function)"}}const zE=t=>new PE(t);function jE(t){return Zo(zE,t),t}const UE=Rl;function VE(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n<e||void 0===n&&e>=e)&&(n=e);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n<i||void 0===n&&i>=i)&&(n=i)}return n}function qE(){}function WE(t){return null==t?qE:function(){return this.querySelector(t)}}function HE(){return[]}function GE(t){return null==t?HE:function(){return this.querySelectorAll(t)}}function YE(t){return function(){return this.matches(t)}}function XE(t){return function(e){return e.matches(t)}}var JE=Array.prototype.find;function KE(){return this.firstElementChild}var QE=Array.prototype.filter;function ZE(){return Array.from(this.children)}function tA(t){return new Array(t.length)}function eA(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function nA(t,e,n,r,i,o){for(var s,a=0,l=e.length,u=o.length;a<u;++a)(s=e[a])?(s.__data__=o[a],r[a]=s):n[a]=new eA(t,o[a]);for(;a<l;++a)(s=e[a])&&(i[a]=s)}function rA(t,e,n,r,i,o,s){var a,l,u,c=new Map,h=e.length,f=o.length,d=new Array(h);for(a=0;a<h;++a)(l=e[a])&&(d[a]=u=s.call(l,l.__data__,a,e)+"",c.has(u)?i[a]=l:c.set(u,l));for(a=0;a<f;++a)u=s.call(t,o[a],a,o)+"",(l=c.get(u))?(r[a]=l,l.__data__=o[a],c.delete(u)):n[a]=new eA(t,o[a]);for(a=0;a<h;++a)(l=e[a])&&c.get(d[a])===l&&(i[a]=l)}function iA(t){return t.__data__}function oA(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function sA(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}eA.prototype={constructor:eA,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};var aA="http://www.w3.org/1999/xhtml";const lA={svg:"http://www.w3.org/2000/svg",xhtml:aA,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function uA(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),lA.hasOwnProperty(e)?{space:lA[e],local:t}:t}function cA(t){return function(){this.removeAttribute(t)}}function hA(t){return function(){this.removeAttributeNS(t.space,t.local)}}function fA(t,e){return function(){this.setAttribute(t,e)}}function dA(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function pA(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}}function mA(t,e){return function(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function gA(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function yA(t){return function(){this.style.removeProperty(t)}}function bA(t,e,n){return function(){this.style.setProperty(t,e,n)}}function vA(t,e,n){return function(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function wA(t,e){return t.style.getPropertyValue(e)||gA(t).getComputedStyle(t,null).getPropertyValue(e)}function xA(t){return function(){delete this[t]}}function _A(t,e){return function(){this[t]=e}}function kA(t,e){return function(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}}function SA(t){return t.trim().split(/^|\s+/)}function EA(t){return t.classList||new AA(t)}function AA(t){this._node=t,this._names=SA(t.getAttribute("class")||"")}function CA(t,e){for(var n=EA(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function DA(t,e){for(var n=EA(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function MA(t){return function(){CA(this,t)}}function OA(t){return function(){DA(this,t)}}function TA(t,e){return function(){(e.apply(this,arguments)?CA:DA)(this,t)}}function IA(){this.textContent=""}function NA(t){return function(){this.textContent=t}}function $A(t){return function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}}function FA(){this.innerHTML=""}function LA(t){return function(){this.innerHTML=t}}function BA(t){return function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}}function RA(){this.nextSibling&&this.parentNode.appendChild(this)}function PA(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function zA(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===aA&&e.documentElement.namespaceURI===aA?e.createElement(t):e.createElementNS(n,t)}}function jA(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function UA(t){var e=uA(t);return(e.local?jA:zA)(e)}function VA(){return null}function qA(){var t=this.parentNode;t&&t.removeChild(this)}function WA(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function HA(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function GA(t){return function(){var e=this.__on;if(e){for(var n,r=0,i=-1,o=e.length;r<o;++r)n=e[r],t.type&&n.type!==t.type||n.name!==t.name?e[++i]=n:this.removeEventListener(n.type,n.listener,n.options);++i?e.length=i:delete this.__on}}}function YA(t,e,n){return function(){var r,i=this.__on,o=function(t){return function(e){t.call(this,e,this.__data__)}}(e);if(i)for(var s=0,a=i.length;s<a;++s)if((r=i[s]).type===t.type&&r.name===t.name)return this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),void(r.value=e);this.addEventListener(t.type,o,n),r={type:t.type,name:t.name,value:e,listener:o,options:n},i?i.push(r):this.__on=[r]}}function XA(t,e,n){var r=gA(t),i=r.CustomEvent;"function"==typeof i?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function JA(t,e){return function(){return XA(this,t,e)}}function KA(t,e){return function(){return XA(this,t,e.apply(this,arguments))}}AA.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var QA=[null];function ZA(t,e){this._groups=t,this._parents=e}function tC(){return new ZA([[document.documentElement]],QA)}ZA.prototype=tC.prototype={constructor:ZA,select:function(t){"function"!=typeof t&&(t=WE(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,s,a=e[i],l=a.length,u=r[i]=new Array(l),c=0;c<l;++c)(o=a[c])&&(s=t.call(o,o.__data__,c,a))&&("__data__"in o&&(s.__data__=o.__data__),u[c]=s);return new ZA(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return function(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}(t.apply(this,arguments))}}(t):GE(t);for(var e=this._groups,n=e.length,r=[],i=[],o=0;o<n;++o)for(var s,a=e[o],l=a.length,u=0;u<l;++u)(s=a[u])&&(r.push(t.call(s,s.__data__,u,a)),i.push(s));return new ZA(r,i)},selectChild:function(t){return this.select(null==t?KE:function(t){return function(){return JE.call(this.children,t)}}("function"==typeof t?t:XE(t)))},selectChildren:function(t){return this.selectAll(null==t?ZE:function(t){return function(){return QE.call(this.children,t)}}("function"==typeof t?t:XE(t)))},filter:function(t){"function"!=typeof t&&(t=YE(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,s=e[i],a=s.length,l=r[i]=[],u=0;u<a;++u)(o=s[u])&&t.call(o,o.__data__,u,s)&&l.push(o);return new ZA(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,iA);var n=e?rA:nA,r=this._parents,i=this._groups;"function"!=typeof t&&(t=function(t){return function(){return t}}(t));for(var o=i.length,s=new Array(o),a=new Array(o),l=new Array(o),u=0;u<o;++u){var c=r[u],h=i[u],f=h.length,d=oA(t.call(c,c&&c.__data__,u,r)),p=d.length,m=a[u]=new Array(p),g=s[u]=new Array(p);n(c,h,m,g,l[u]=new Array(f),d,e);for(var y,b,v=0,w=0;v<p;++v)if(y=m[v]){for(v>=w&&(w=v+1);!(b=g[w])&&++w<p;);y._next=b||null}}return(s=new ZA(s,r))._enter=a,s._exit=l,s},enter:function(){return new ZA(this._enter||this._groups.map(tA),this._parents)},exit:function(){return new ZA(this._exit||this._groups.map(tA),this._parents)},join:function(t,e,n){var r=this.enter(),i=this,o=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(i=e(i))&&(i=i.selection()),null==n?o.remove():n(o),r&&i?r.merge(i).order():i},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,o=r.length,s=Math.min(i,o),a=new Array(i),l=0;l<s;++l)for(var u,c=n[l],h=r[l],f=c.length,d=a[l]=new Array(f),p=0;p<f;++p)(u=c[p]||h[p])&&(d[p]=u);for(;l<i;++l)a[l]=n[l];return new ZA(a,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,i=t[e],o=i.length-1,s=i[o];--o>=0;)(r=i[o])&&(s&&4^r.compareDocumentPosition(s)&&s.parentNode.insertBefore(r,s),s=r);return this},sort:function(t){function e(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}t||(t=sA);for(var n=this._groups,r=n.length,i=new Array(r),o=0;o<r;++o){for(var s,a=n[o],l=a.length,u=i[o]=new Array(l),c=0;c<l;++c)(s=a[c])&&(u[c]=s);u.sort(e)}return new ZA(i,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,o=r.length;i<o;++i){var s=r[i];if(s)return s}return null},size:function(){let t=0;for(const e of this)++t;return t},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i,o=e[n],s=0,a=o.length;s<a;++s)(i=o[s])&&t.call(i,i.__data__,s,o);return this},attr:function(t,e){var n=uA(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?hA:cA:"function"==typeof e?n.local?mA:pA:n.local?dA:fA)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?yA:"function"==typeof e?vA:bA)(t,e,null==n?"":n)):wA(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?xA:"function"==typeof e?kA:_A)(t,e)):this.node()[t]},classed:function(t,e){var n=SA(t+"");if(arguments.length<2){for(var r=EA(this.node()),i=-1,o=n.length;++i<o;)if(!r.contains(n[i]))return!1;return!0}return this.each(("function"==typeof e?TA:e?MA:OA)(n,e))},text:function(t){return arguments.length?this.each(null==t?IA:("function"==typeof t?$A:NA)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?FA:("function"==typeof t?BA:LA)(t)):this.node().innerHTML},raise:function(){return this.each(RA)},lower:function(){return this.each(PA)},append:function(t){var e="function"==typeof t?t:UA(t);return this.select((function(){return this.appendChild(e.apply(this,arguments))}))},insert:function(t,e){var n="function"==typeof t?t:UA(t),r=null==e?VA:"function"==typeof e?e:WE(e);return this.select((function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)}))},remove:function(){return this.each(qA)},clone:function(t){return this.select(t?HA:WA)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,i,o=function(t){return t.trim().split(/^|\s+/).map((function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}}))}(t+""),s=o.length;if(!(arguments.length<2)){for(a=e?YA:GA,r=0;r<s;++r)this.each(a(o[r],e,n));return this}var a=this.node().__on;if(a)for(var l,u=0,c=a.length;u<c;++u)for(r=0,l=a[u];r<s;++r)if((i=o[r]).type===l.type&&i.name===l.name)return l.value},dispatch:function(t,e){return this.each(("function"==typeof e?KA:JA)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,i=t[e],o=0,s=i.length;o<s;++o)(r=i[o])&&(yield r)}};const eC=tC;var nC={value:()=>{}};function rC(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new iC(r)}function iC(t){this._=t}function oC(t,e){for(var n,r=0,i=t.length;r<i;++r)if((n=t[r]).name===e)return n.value}function sC(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=nC,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}iC.prototype=rC.prototype={constructor:iC,on:function(t,e){var n,r=this._,i=function(t,e){return t.trim().split(/^|\s+/).map((function(t){var n="",r=t.indexOf(".");if(r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:n}}))}(t+"",r),o=-1,s=i.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++o<s;)if(n=(t=i[o]).type)r[n]=sC(r[n],t.name,e);else if(null==e)for(n in r)r[n]=sC(r[n],t.name,null);return this}for(;++o<s;)if((n=(t=i[o]).type)&&(n=oC(r[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new iC(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,i=new Array(n),o=0;o<n;++o)i[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,i)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,o=r.length;i<o;++i)r[i].value.apply(e,n)}};const aC=rC;var lC,uC,cC=0,hC=0,fC=0,dC=1e3,pC=0,mC=0,gC=0,yC="object"==typeof performance&&performance.now?performance:Date,bC="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function vC(){return mC||(bC(wC),mC=yC.now()+gC)}function wC(){mC=0}function xC(){this._call=this._time=this._next=null}function _C(t,e,n){var r=new xC;return r.restart(t,e,n),r}function kC(){mC=(pC=yC.now())+gC,cC=hC=0;try{!function(){vC(),++cC;for(var t,e=lC;e;)(t=mC-e._time)>=0&&e._call.call(void 0,t),e=e._next;--cC}()}finally{cC=0,function(){for(var t,e,n=lC,r=1/0;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:lC=e);uC=t,EC(r)}(),mC=0}}function SC(){var t=yC.now(),e=t-pC;e>dC&&(gC-=e,pC=t)}function EC(t){cC||(hC&&(hC=clearTimeout(hC)),t-mC>24?(t<1/0&&(hC=setTimeout(kC,t-yC.now()-gC)),fC&&(fC=clearInterval(fC))):(fC||(pC=yC.now(),fC=setInterval(SC,dC)),cC=1,bC(kC)))}function AC(t,e,n){var r=new xC;return e=null==e?0:+e,r.restart((n=>{r.stop(),t(n+e)}),e,n),r}xC.prototype=_C.prototype={constructor:xC,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?vC():+n)+(null==e?0:+e),this._next||uC===this||(uC?uC._next=this:lC=this,uC=this),this._call=t,this._time=n,EC()},stop:function(){this._call&&(this._call=null,this._time=1/0,EC())}};var CC=aC("start","end","cancel","interrupt"),DC=[],MC=0,OC=3;function TC(t,e,n,r,i,o){var s=t.__transition;if(s){if(n in s)return}else t.__transition={};!function(t,e,n){var r,i=t.__transition;function o(l){var u,c,h,f;if(1!==n.state)return a();for(u in i)if((f=i[u]).name===n.name){if(f.state===OC)return AC(o);4===f.state?(f.state=6,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete i[u]):+u<e&&(f.state=6,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete i[u])}if(AC((function(){n.state===OC&&(n.state=4,n.timer.restart(s,n.delay,n.time),s(l))})),n.state=2,n.on.call("start",t,t.__data__,n.index,n.group),2===n.state){for(n.state=OC,r=new Array(h=n.tween.length),u=0,c=-1;u<h;++u)(f=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++c]=f);r.length=c+1}}function s(e){for(var i=e<n.duration?n.ease.call(null,e/n.duration):(n.timer.restart(a),n.state=5,1),o=-1,s=r.length;++o<s;)r[o].call(t,i);5===n.state&&(n.on.call("end",t,t.__data__,n.index,n.group),a())}function a(){for(var r in n.state=6,n.timer.stop(),delete i[e],i)return;delete t.__transition}i[e]=n,n.timer=_C((function(t){n.state=1,n.timer.restart(o,n.delay,n.time),n.delay<=t&&o(t-n.delay)}),0,n.time)}(t,n,{name:e,index:r,group:i,on:CC,tween:DC,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:MC})}function IC(t,e){var n=$C(t,e);if(n.state>MC)throw new Error("too late; already scheduled");return n}function NC(t,e){var n=$C(t,e);if(n.state>OC)throw new Error("too late; already running");return n}function $C(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function FC(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var LC,BC=180/Math.PI,RC={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function PC(t,e,n,r,i,o){var s,a,l;return(s=Math.sqrt(t*t+e*e))&&(t/=s,e/=s),(l=t*n+e*r)&&(n-=t*l,r-=e*l),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,l/=a),t*r<e*n&&(t=-t,e=-e,l=-l,s=-s),{translateX:i,translateY:o,rotate:Math.atan2(e,t)*BC,skewX:Math.atan(l)*BC,scaleX:s,scaleY:a}}function zC(t,e,n,r){function i(t){return t.length?t.pop()+" ":""}return function(o,s){var a=[],l=[];return o=t(o),s=t(s),function(t,r,i,o,s,a){if(t!==i||r!==o){var l=s.push("translate(",null,e,null,n);a.push({i:l-4,x:FC(t,i)},{i:l-2,x:FC(r,o)})}else(i||o)&&s.push("translate("+i+e+o+n)}(o.translateX,o.translateY,s.translateX,s.translateY,a,l),function(t,e,n,o){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),o.push({i:n.push(i(n)+"rotate(",null,r)-2,x:FC(t,e)})):e&&n.push(i(n)+"rotate("+e+r)}(o.rotate,s.rotate,a,l),function(t,e,n,o){t!==e?o.push({i:n.push(i(n)+"skewX(",null,r)-2,x:FC(t,e)}):e&&n.push(i(n)+"skewX("+e+r)}(o.skewX,s.skewX,a,l),function(t,e,n,r,o,s){if(t!==n||e!==r){var a=o.push(i(o)+"scale(",null,",",null,")");s.push({i:a-4,x:FC(t,n)},{i:a-2,x:FC(e,r)})}else 1===n&&1===r||o.push(i(o)+"scale("+n+","+r+")")}(o.scaleX,o.scaleY,s.scaleX,s.scaleY,a,l),o=s=null,function(t){for(var e,n=-1,r=l.length;++n<r;)a[(e=l[n]).i]=e.x(t);return a.join("")}}}var jC=zC((function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?RC:PC(e.a,e.b,e.c,e.d,e.e,e.f)}),"px, ","px)","deg)"),UC=zC((function(t){return null==t?RC:(LC||(LC=document.createElementNS("http://www.w3.org/2000/svg","g")),LC.setAttribute("transform",t),(t=LC.transform.baseVal.consolidate())?PC((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):RC)}),", ",")",")");function VC(t,e){var n,r;return function(){var i=NC(this,t),o=i.tween;if(o!==n)for(var s=0,a=(r=n=o).length;s<a;++s)if(r[s].name===e){(r=r.slice()).splice(s,1);break}i.tween=r}}function qC(t,e,n){var r,i;if("function"!=typeof n)throw new Error;return function(){var o=NC(this,t),s=o.tween;if(s!==r){i=(r=s).slice();for(var a={name:e,value:n},l=0,u=i.length;l<u;++l)if(i[l].name===e){i[l]=a;break}l===u&&i.push(a)}o.tween=i}}function WC(t,e,n){var r=t._id;return t.each((function(){var t=NC(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)})),function(t){return $C(t,r).value[e]}}function HC(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function GC(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function YC(){}var XC=.7,JC=1/XC,KC="\\s*([+-]?\\d+)\\s*",QC="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",ZC="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",tD=/^#([0-9a-f]{3,8})$/,eD=new RegExp(`^rgb\\(${KC},${KC},${KC}\\)$`),nD=new RegExp(`^rgb\\(${ZC},${ZC},${ZC}\\)$`),rD=new RegExp(`^rgba\\(${KC},${KC},${KC},${QC}\\)$`),iD=new RegExp(`^rgba\\(${ZC},${ZC},${ZC},${QC}\\)$`),oD=new RegExp(`^hsl\\(${QC},${ZC},${ZC}\\)$`),sD=new RegExp(`^hsla\\(${QC},${ZC},${ZC},${QC}\\)$`),aD={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function lD(){return this.rgb().formatHex()}function uD(){return this.rgb().formatRgb()}function cD(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=tD.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?hD(e):3===n?new mD(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?fD(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?fD(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=eD.exec(t))?new mD(e[1],e[2],e[3],1):(e=nD.exec(t))?new mD(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=rD.exec(t))?fD(e[1],e[2],e[3],e[4]):(e=iD.exec(t))?fD(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=oD.exec(t))?xD(e[1],e[2]/100,e[3]/100,1):(e=sD.exec(t))?xD(e[1],e[2]/100,e[3]/100,e[4]):aD.hasOwnProperty(t)?hD(aD[t]):"transparent"===t?new mD(NaN,NaN,NaN,0):null}function hD(t){return new mD(t>>16&255,t>>8&255,255&t,1)}function fD(t,e,n,r){return r<=0&&(t=e=n=NaN),new mD(t,e,n,r)}function dD(t){return t instanceof YC||(t=cD(t)),t?new mD((t=t.rgb()).r,t.g,t.b,t.opacity):new mD}function pD(t,e,n,r){return 1===arguments.length?dD(t):new mD(t,e,n,null==r?1:r)}function mD(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function gD(){return`#${wD(this.r)}${wD(this.g)}${wD(this.b)}`}function yD(){const t=bD(this.opacity);return`${1===t?"rgb(":"rgba("}${vD(this.r)}, ${vD(this.g)}, ${vD(this.b)}${1===t?")":`, ${t})`}`}function bD(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function vD(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function wD(t){return((t=vD(t))<16?"0":"")+t.toString(16)}function xD(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new SD(t,e,n,r)}function _D(t){if(t instanceof SD)return new SD(t.h,t.s,t.l,t.opacity);if(t instanceof YC||(t=cD(t)),!t)return new SD;if(t instanceof SD)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),o=Math.max(e,n,r),s=NaN,a=o-i,l=(o+i)/2;return a?(s=e===o?(n-r)/a+6*(n<r):n===o?(r-e)/a+2:(e-n)/a+4,a/=l<.5?o+i:2-o-i,s*=60):a=l>0&&l<1?0:s,new SD(s,a,l,t.opacity)}function kD(t,e,n,r){return 1===arguments.length?_D(t):new SD(t,e,n,null==r?1:r)}function SD(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function ED(t){return(t=(t||0)%360)<0?t+360:t}function AD(t){return Math.max(0,Math.min(1,t||0))}function CD(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}function DD(t,e,n,r,i){var o=t*t,s=o*t;return((1-3*t+3*o-s)*e+(4-6*o+3*s)*n+(1+3*t+3*o-3*s)*r+s*i)/6}function MD(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],o=t[r+1],s=r>0?t[r-1]:2*i-o,a=r<e-1?t[r+2]:2*o-i;return DD((n-r/e)*e,s,i,o,a)}}function OD(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],o=t[r%e],s=t[(r+1)%e],a=t[(r+2)%e];return DD((n-r/e)*e,i,o,s,a)}}HC(YC,cD,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:lD,formatHex:lD,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return _D(this).formatHsl()},formatRgb:uD,toString:uD}),HC(mD,pD,GC(YC,{brighter(t){return t=null==t?JC:Math.pow(JC,t),new mD(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?XC:Math.pow(XC,t),new mD(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new mD(vD(this.r),vD(this.g),vD(this.b),bD(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:gD,formatHex:gD,formatHex8:function(){return`#${wD(this.r)}${wD(this.g)}${wD(this.b)}${wD(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:yD,toString:yD})),HC(SD,kD,GC(YC,{brighter(t){return t=null==t?JC:Math.pow(JC,t),new SD(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?XC:Math.pow(XC,t),new SD(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new mD(CD(t>=240?t-240:t+120,i,r),CD(t,i,r),CD(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new SD(ED(this.h),AD(this.s),AD(this.l),bD(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=bD(this.opacity);return`${1===t?"hsl(":"hsla("}${ED(this.h)}, ${100*AD(this.s)}%, ${100*AD(this.l)}%${1===t?")":`, ${t})`}`}}));const TD=t=>()=>t;function ID(t,e){return function(n){return t+n*e}}function ND(t,e){var n=e-t;return n?ID(t,n>180||n<-180?n-360*Math.round(n/360):n):TD(isNaN(t)?e:t)}function $D(t,e){var n=e-t;return n?ID(t,n):TD(isNaN(t)?e:t)}const FD=function t(e){var n=function(t){return 1==(t=+t)?$D:function(e,n){return n-e?function(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}(e,n,t):TD(isNaN(e)?n:e)}}(e);function r(t,e){var r=n((t=pD(t)).r,(e=pD(e)).r),i=n(t.g,e.g),o=n(t.b,e.b),s=$D(t.opacity,e.opacity);return function(e){return t.r=r(e),t.g=i(e),t.b=o(e),t.opacity=s(e),t+""}}return r.gamma=t,r}(1);function LD(t){return function(e){var n,r,i=e.length,o=new Array(i),s=new Array(i),a=new Array(i);for(n=0;n<i;++n)r=pD(e[n]),o[n]=r.r||0,s[n]=r.g||0,a[n]=r.b||0;return o=t(o),s=t(s),a=t(a),r.opacity=1,function(t){return r.r=o(t),r.g=s(t),r.b=a(t),r+""}}}var BD=LD(MD),RD=LD(OD),PD=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,zD=new RegExp(PD.source,"g");function jD(t,e){var n,r,i,o=PD.lastIndex=zD.lastIndex=0,s=-1,a=[],l=[];for(t+="",e+="";(n=PD.exec(t))&&(r=zD.exec(e));)(i=r.index)>o&&(i=e.slice(o,i),a[s]?a[s]+=i:a[++s]=i),(n=n[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,l.push({i:s,x:FC(n,r)})),o=zD.lastIndex;return o<e.length&&(i=e.slice(o),a[s]?a[s]+=i:a[++s]=i),a.length<2?l[0]?function(t){return function(e){return t(e)+""}}(l[0].x):function(t){return function(){return t}}(e):(e=l.length,function(t){for(var n,r=0;r<e;++r)a[(n=l[r]).i]=n.x(t);return a.join("")})}function UD(t,e){var n;return("number"==typeof e?FC:e instanceof cD?FD:(n=cD(e))?(e=n,FD):jD)(t,e)}function VD(t){return function(){this.removeAttribute(t)}}function qD(t){return function(){this.removeAttributeNS(t.space,t.local)}}function WD(t,e,n){var r,i,o=n+"";return function(){var s=this.getAttribute(t);return s===o?null:s===r?i:i=e(r=s,n)}}function HD(t,e,n){var r,i,o=n+"";return function(){var s=this.getAttributeNS(t.space,t.local);return s===o?null:s===r?i:i=e(r=s,n)}}function GD(t,e,n){var r,i,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttribute(t))===(a=l+"")?null:s===r&&a===i?o:(i=a,o=e(r=s,l));this.removeAttribute(t)}}function YD(t,e,n){var r,i,o;return function(){var s,a,l=n(this);if(null!=l)return(s=this.getAttributeNS(t.space,t.local))===(a=l+"")?null:s===r&&a===i?o:(i=a,o=e(r=s,l));this.removeAttributeNS(t.space,t.local)}}function XD(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}(t,i)),n}return i._value=e,i}function JD(t,e){var n,r;function i(){var i=e.apply(this,arguments);return i!==r&&(n=(r=i)&&function(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}(t,i)),n}return i._value=e,i}function KD(t,e){return function(){IC(this,t).delay=+e.apply(this,arguments)}}function QD(t,e){return e=+e,function(){IC(this,t).delay=e}}function ZD(t,e){return function(){NC(this,t).duration=+e.apply(this,arguments)}}function tM(t,e){return e=+e,function(){NC(this,t).duration=e}}var eM=eC.prototype.constructor;function nM(t){return function(){this.style.removeProperty(t)}}var rM=0;function iM(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function oM(){return++rM}var sM=eC.prototype;iM.prototype=function(t){return eC().transition(t)}.prototype={constructor:iM,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=WE(t));for(var r=this._groups,i=r.length,o=new Array(i),s=0;s<i;++s)for(var a,l,u=r[s],c=u.length,h=o[s]=new Array(c),f=0;f<c;++f)(a=u[f])&&(l=t.call(a,a.__data__,f,u))&&("__data__"in a&&(l.__data__=a.__data__),h[f]=l,TC(h[f],e,n,f,h,$C(a,n)));return new iM(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=GE(t));for(var r=this._groups,i=r.length,o=[],s=[],a=0;a<i;++a)for(var l,u=r[a],c=u.length,h=0;h<c;++h)if(l=u[h]){for(var f,d=t.call(l,l.__data__,h,u),p=$C(l,n),m=0,g=d.length;m<g;++m)(f=d[m])&&TC(f,e,n,m,d,p);o.push(d),s.push(l)}return new iM(o,s,e,n)},selectChild:sM.selectChild,selectChildren:sM.selectChildren,filter:function(t){"function"!=typeof t&&(t=YE(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var o,s=e[i],a=s.length,l=r[i]=[],u=0;u<a;++u)(o=s[u])&&t.call(o,o.__data__,u,s)&&l.push(o);return new iM(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,o=Math.min(r,i),s=new Array(r),a=0;a<o;++a)for(var l,u=e[a],c=n[a],h=u.length,f=s[a]=new Array(h),d=0;d<h;++d)(l=u[d]||c[d])&&(f[d]=l);for(;a<r;++a)s[a]=e[a];return new iM(s,this._parents,this._name,this._id)},selection:function(){return new eM(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=oM(),r=this._groups,i=r.length,o=0;o<i;++o)for(var s,a=r[o],l=a.length,u=0;u<l;++u)if(s=a[u]){var c=$C(s,e);TC(s,t,n,u,a,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new iM(r,this._parents,t,n)},call:sM.call,nodes:sM.nodes,node:sM.node,size:sM.size,empty:sM.empty,each:sM.each,on:function(t,e){var n=this._id;return arguments.length<2?$C(this.node(),n).on.on(t):this.each(function(t,e,n){var r,i,o=function(t){return(t+"").trim().split(/^|\s+/).every((function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t}))}(e)?IC:NC;return function(){var s=o(this,t),a=s.on;a!==r&&(i=(r=a).copy()).on(e,n),s.on=i}}(n,t,e))},attr:function(t,e){var n=uA(t),r="transform"===n?UC:UD;return this.attrTween(t,"function"==typeof e?(n.local?YD:GD)(n,r,WC(this,"attr."+t,e)):null==e?(n.local?qD:VD)(n):(n.local?HD:WD)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=uA(t);return this.tween(n,(r.local?XD:JD)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?jC:UD;return null==e?this.styleTween(t,function(t,e){var n,r,i;return function(){var o=wA(this,t),s=(this.style.removeProperty(t),wA(this,t));return o===s?null:o===n&&s===r?i:i=e(n=o,r=s)}}(t,r)).on("end.style."+t,nM(t)):"function"==typeof e?this.styleTween(t,function(t,e,n){var r,i,o;return function(){var s=wA(this,t),a=n(this),l=a+"";return null==a&&(this.style.removeProperty(t),l=a=wA(this,t)),s===l?null:s===r&&l===i?o:(i=l,o=e(r=s,a))}}(t,r,WC(this,"style."+t,e))).each(function(t,e){var n,r,i,o,s="style."+e,a="end."+s;return function(){var l=NC(this,t),u=l.on,c=null==l.value[s]?o||(o=nM(e)):void 0;u===n&&i===c||(r=(n=u).copy()).on(a,i=c),l.on=r}}(this._id,t)):this.styleTween(t,function(t,e,n){var r,i,o=n+"";return function(){var s=wA(this,t);return s===o?null:s===r?i:i=e(r=s,n)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,function(t,e,n){var r,i;function o(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&function(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}(t,o,n)),r}return o._value=e,o}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(t){return function(){var e=t(this);this.textContent=null==e?"":e}}(WC(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(t){var e,n;function r(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&function(t){return function(e){this.textContent=t.call(this,e)}}(r)),e}return r._value=t,r}(t))},remove:function(){return this.on("end.remove",function(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,i=$C(this.node(),n).tween,o=0,s=i.length;o<s;++o)if((r=i[o]).name===t)return r.value;return null}return this.each((null==e?VC:qC)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?KD:QD)(e,t)):$C(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?ZD:tM)(e,t)):$C(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){NC(this,t).ease=e}}(e,t)):$C(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(t,e){return function(){var n=e.apply(this,arguments);if("function"!=typeof n)throw new Error;NC(this,t).ease=n}}(this._id,t))},end:function(){var t,e,n=this,r=n._id,i=n.size();return new Promise((function(o,s){var a={value:s},l={value:function(){0==--i&&o()}};n.each((function(){var n=NC(this,r),i=n.on;i!==t&&((e=(t=i).copy())._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),n.on=e})),0===i&&o()}))},[Symbol.iterator]:sM[Symbol.iterator]};var aM={time:null,delay:0,duration:250,ease:function(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function lM(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}eC.prototype.interrupt=function(t){return this.each((function(){!function(t,e){var n,r,i,o=t.__transition,s=!0;if(o){for(i in e=null==e?null:e+"",o)(n=o[i]).name===e?(r=n.state>2&&n.state<5,n.state=6,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[i]):s=!1;s&&delete t.__transition}}(this,t)}))},eC.prototype.transition=function(t){var e,n;t instanceof iM?(e=t._id,t=t._name):(e=oM(),(n=aM).time=vC(),t=null==t?null:t+"");for(var r=this._groups,i=r.length,o=0;o<i;++o)for(var s,a=r[o],l=a.length,u=0;u<l;++u)(s=a[u])&&TC(s,t,e,u,a,n||lM(s,e));return new iM(r,this._parents,t,e)};const{abs:uM,max:cM,min:hM}=Math;function fM(t){return{type:t}}function dM(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function pM(t){return(t=dM(Math.abs(t)))?t[1]:NaN}["w","e"].map(fM),["n","s"].map(fM),["n","w","e","s","nw","ne","sw","se"].map(fM);var mM,gM=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function yM(t){if(!(e=gM.exec(t)))throw new Error("invalid format: "+t);var e;return new bM({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function bM(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function vM(t,e){var n=dM(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}yM.prototype=bM.prototype,bM.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};const wM={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>vM(100*t,e),r:vM,s:function(t,e){var n=dM(t,e);if(!n)return t+"";var r=n[0],i=n[1],o=i-(mM=3*Math.max(-8,Math.min(8,Math.floor(i/3))))+1,s=r.length;return o===s?r:o>s?r+new Array(o-s+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+dM(t,Math.max(0,e+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function xM(t){return t}var _M,kM,SM,EM=Array.prototype.map,AM=["y","z","a","f","p","n","Âµ","m","","k","M","G","T","P","E","Z","Y"];function CM(t){var e,n,r=void 0===t.grouping||void 0===t.thousands?xM:(e=EM.call(t.grouping,Number),n=t.thousands+"",function(t,r){for(var i=t.length,o=[],s=0,a=e[0],l=0;i>0&&a>0&&(l+a+1>r&&(a=Math.max(1,r-l)),o.push(t.substring(i-=a,i+a)),!((l+=a+1)>r));)a=e[s=(s+1)%e.length];return o.reverse().join(n)}),i=void 0===t.currency?"":t.currency[0]+"",o=void 0===t.currency?"":t.currency[1]+"",s=void 0===t.decimal?".":t.decimal+"",a=void 0===t.numerals?xM:function(t){return function(e){return e.replace(/[0-9]/g,(function(e){return t[+e]}))}}(EM.call(t.numerals,String)),l=void 0===t.percent?"%":t.percent+"",u=void 0===t.minus?"âˆ’":t.minus+"",c=void 0===t.nan?"NaN":t.nan+"";function h(t){var e=(t=yM(t)).fill,n=t.align,h=t.sign,f=t.symbol,d=t.zero,p=t.width,m=t.comma,g=t.precision,y=t.trim,b=t.type;"n"===b?(m=!0,b="g"):wM[b]||(void 0===g&&(g=12),y=!0,b="g"),(d||"0"===e&&"="===n)&&(d=!0,e="0",n="=");var v="$"===f?i:"#"===f&&/[boxX]/.test(b)?"0"+b.toLowerCase():"",w="$"===f?o:/[%p]/.test(b)?l:"",x=wM[b],_=/[defgprs%]/.test(b);function k(t){var i,o,l,f=v,k=w;if("c"===b)k=x(t)+k,t="";else{var S=(t=+t)<0||1/t<0;if(t=isNaN(t)?c:x(Math.abs(t),g),y&&(t=function(t){t:for(var e,n=t.length,r=1,i=-1;r<n;++r)switch(t[r]){case".":i=e=r;break;case"0":0===i&&(i=r),e=r;break;default:if(!+t[r])break t;i>0&&(i=0)}return i>0?t.slice(0,i)+t.slice(e+1):t}(t)),S&&0==+t&&"+"!==h&&(S=!1),f=(S?"("===h?h:u:"-"===h||"("===h?"":h)+f,k=("s"===b?AM[8+mM/3]:"")+k+(S&&"("===h?")":""),_)for(i=-1,o=t.length;++i<o;)if(48>(l=t.charCodeAt(i))||l>57){k=(46===l?s+t.slice(i+1):t.slice(i))+k,t=t.slice(0,i);break}}m&&!d&&(t=r(t,1/0));var E=f.length+t.length+k.length,A=E<p?new Array(p-E+1).join(e):"";switch(m&&d&&(t=r(A+t,A.length?p-k.length:1/0),A=""),n){case"<":t=f+t+k+A;break;case"=":t=f+A+t+k;break;case"^":t=A.slice(0,E=A.length>>1)+f+t+k+A.slice(E);break;default:t=A+f+t+k}return a(t)}return g=void 0===g?6:/[gprs]/.test(b)?Math.max(1,Math.min(21,g)):Math.max(0,Math.min(20,g)),k.toString=function(){return t+""},k}return{format:h,formatPrefix:function(t,e){var n=h(((t=yM(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(pM(e)/3))),i=Math.pow(10,-r),o=AM[8+r/3];return function(t){return n(i*t)+o}}}}_M=CM({thousands:",",grouping:[3],currency:["$",""]}),kM=_M.format,SM=_M.formatPrefix;const DM=Math.sqrt(50),MM=Math.sqrt(10),OM=Math.sqrt(2);function TM(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),o=r/Math.pow(10,i),s=o>=DM?10:o>=MM?5:o>=OM?2:1;let a,l,u;return i<0?(u=Math.pow(10,-i)/s,a=Math.round(t*u),l=Math.round(e*u),a/u<t&&++a,l/u>e&&--l,u=-u):(u=Math.pow(10,i)*s,a=Math.round(t/u),l=Math.round(e/u),a*u<t&&++a,l*u>e&&--l),l<a&&.5<=n&&n<2?TM(t,e,2*n):[a,l,u]}function IM(t,e,n){if(!((n=+n)>0))return[];if((t=+t)==(e=+e))return[t];const r=e<t,[i,o,s]=r?TM(e,t,n):TM(t,e,n);if(!(o>=i))return[];const a=o-i+1,l=new Array(a);if(r)if(s<0)for(let t=0;t<a;++t)l[t]=(o-t)/-s;else for(let t=0;t<a;++t)l[t]=(o-t)*s;else if(s<0)for(let t=0;t<a;++t)l[t]=(i+t)/-s;else for(let t=0;t<a;++t)l[t]=(i+t)*s;return l}function NM(t,e,n){return TM(t=+t,e=+e,n=+n)[2]}function $M(t,e,n){n=+n;const r=(e=+e)<(t=+t),i=r?NM(e,t,n):NM(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function FM(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function LM(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function BM(t){let e,n,r;function i(t,r,i=0,o=t.length){if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<0?i=e+1:o=e}while(i<o)}return i}return 2!==t.length?(e=FM,n=(e,n)=>FM(t(e),n),r=(e,n)=>t(e)-n):(e=t===FM||t===LM?t:RM,n=t,r=t),{left:i,center:function(t,e,n=0,o=t.length){const s=i(t,e,n,o-1);return s>n&&r(t[s-1],e)>-r(t[s],e)?s-1:s},right:function(t,r,i=0,o=t.length){if(i<o){if(0!==e(r,r))return o;do{const e=i+o>>>1;n(t[e],r)<=0?i=e+1:o=e}while(i<o)}return i}}}function RM(){return 0}function PM(t){return null===t?NaN:+t}const zM=BM(FM),jM=zM.right,UM=zM.left,VM=(BM(PM).center,jM);function qM(t,e){e||(e=[]);var n,r=t?Math.min(e.length,t.length):0,i=e.slice();return function(o){for(n=0;n<r;++n)i[n]=t[n]*(1-o)+e[n]*o;return i}}function WM(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function HM(t,e){return(WM(e)?qM:GM)(t,e)}function GM(t,e){var n,r=e?e.length:0,i=t?Math.min(r,t.length):0,o=new Array(i),s=new Array(r);for(n=0;n<i;++n)o[n]=JM(t[n],e[n]);for(;n<r;++n)s[n]=e[n];return function(t){for(n=0;n<i;++n)s[n]=o[n](t);return s}}function YM(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function XM(t,e){var n,r={},i={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=JM(t[n],e[n]):i[n]=e[n];return function(t){for(n in r)i[n]=r[n](t);return i}}function JM(t,e){var n,r=typeof e;return null==e||"boolean"===r?TD(e):("number"===r?FC:"string"===r?(n=cD(e))?(e=n,FD):jD:e instanceof cD?FD:e instanceof Date?YM:WM(e)?qM:Array.isArray(e)?GM:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?XM:FC)(t,e)}function KM(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}function QM(t){return+t}var ZM=[0,1];function tO(t){return t}function eO(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:function(t){return function(){return t}}(isNaN(e)?NaN:.5)}function nO(t,e,n){var r=t[0],i=t[1],o=e[0],s=e[1];return i<r?(r=eO(i,r),o=n(s,o)):(r=eO(r,i),o=n(o,s)),function(t){return o(r(t))}}function rO(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),o=new Array(r),s=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<r;)i[s]=eO(t[s],t[s+1]),o[s]=n(e[s],e[s+1]);return function(e){var n=VM(t,e,1,r)-1;return o[n](i[n](e))}}function iO(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function oO(){var t,e,n,r,i,o,s=ZM,a=ZM,l=JM,u=tO;function c(){var t=Math.min(s.length,a.length);return u!==tO&&(u=function(t,e){var n;return t>e&&(n=t,t=e,e=n),function(n){return Math.max(t,Math.min(e,n))}}(s[0],s[t-1])),r=t>2?rO:nO,i=o=null,h}function h(e){return null==e||isNaN(e=+e)?n:(i||(i=r(s.map(t),a,l)))(t(u(e)))}return h.invert=function(n){return u(e((o||(o=r(a,s.map(t),FC)))(n)))},h.domain=function(t){return arguments.length?(s=Array.from(t,QM),c()):s.slice()},h.range=function(t){return arguments.length?(a=Array.from(t),c()):a.slice()},h.rangeRound=function(t){return a=Array.from(t),l=KM,c()},h.clamp=function(t){return arguments.length?(u=!!t||tO,c()):u!==tO},h.interpolate=function(t){return arguments.length?(l=t,c()):l},h.unknown=function(t){return arguments.length?(n=t,h):n},function(n,r){return t=n,e=r,c()}}function sO(){return oO()(tO,tO)}function aO(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function lO(t,e){switch(arguments.length){case 0:break;case 1:"function"==typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"==typeof e?this.interpolator(e):this.range(e)}return this}function uO(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(pM(e)/3)))-pM(Math.abs(t)))}function cO(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,pM(e)-pM(t))+1}function hO(t){return Math.max(0,-pM(Math.abs(t)))}function fO(t,e,n,r){var i,o=$M(t,e,n);switch((r=yM(null==r?",f":r)).type){case"s":var s=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(i=uO(o,s))||(r.precision=i),SM(r,s);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(i=cO(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=i-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(i=hO(o))||(r.precision=i-2*("%"===r.type))}return kM(r)}function dO(t){var e=t.domain;return t.ticks=function(t){var n=e();return IM(n[0],n[n.length-1],null==t?10:t)},t.tickFormat=function(t,n){var r=e();return fO(r[0],r[r.length-1],null==t?10:t,n)},t.nice=function(n){null==n&&(n=10);var r,i,o=e(),s=0,a=o.length-1,l=o[s],u=o[a],c=10;for(u<l&&(i=l,l=u,u=i,i=s,s=a,a=i);c-- >0;){if((i=NM(l,u,n))===r)return o[s]=l,o[a]=u,e(o);if(i>0)l=Math.floor(l/i)*i,u=Math.ceil(u/i)*i;else{if(!(i<0))break;l=Math.ceil(l*i)/i,u=Math.floor(u*i)/i}r=i}return t},t}function pO(){var t=sO();return t.copy=function(){return iO(t,pO())},aO.apply(t,arguments),dO(t)}const mO=new Date,gO=new Date;function yO(t,e,n,r){function i(e){return t(e=0===arguments.length?new Date:new Date(+e)),e}return i.floor=e=>(t(e=new Date(+e)),e),i.ceil=n=>(t(n=new Date(n-1)),e(n,1),t(n),n),i.round=t=>{const e=i(t),n=i.ceil(t);return t-e<n-t?e:n},i.offset=(t,n)=>(e(t=new Date(+t),null==n?1:Math.floor(n)),t),i.range=(n,r,o)=>{const s=[];if(n=i.ceil(n),o=null==o?1:Math.floor(o),!(n<r&&o>0))return s;let a;do{s.push(a=new Date(+n)),e(n,o),t(n)}while(a<n&&n<r);return s},i.filter=n=>yO((e=>{if(e>=e)for(;t(e),!n(e);)e.setTime(e-1)}),((t,r)=>{if(t>=t)if(r<0)for(;++r<=0;)for(;e(t,-1),!n(t););else for(;--r>=0;)for(;e(t,1),!n(t););})),n&&(i.count=(e,r)=>(mO.setTime(+e),gO.setTime(+r),t(mO),t(gO),Math.floor(n(mO,gO))),i.every=t=>(t=Math.floor(t),isFinite(t)&&t>0?t>1?i.filter(r?e=>r(e)%t==0:e=>i.count(0,e)%t==0):i:null)),i}const bO=1e3,vO=6e4,wO=36e5,xO=864e5,_O=6048e5,kO=31536e6;function SO(t){return yO((e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)}),((t,e)=>{t.setDate(t.getDate()+7*e)}),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*vO)/_O))}const EO=SO(0),AO=SO(1),CO=SO(2),DO=SO(3),MO=SO(4),OO=SO(5),TO=SO(6);function IO(t){return yO((e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+7*e)}),((t,e)=>(e-t)/_O))}EO.range,AO.range,CO.range,DO.range,MO.range,OO.range,TO.range;const NO=IO(0),$O=IO(1),FO=IO(2),LO=IO(3),BO=IO(4),RO=IO(5),PO=IO(6),zO=(NO.range,$O.range,FO.range,LO.range,BO.range,RO.range,PO.range,yO((t=>t.setHours(0,0,0,0)),((t,e)=>t.setDate(t.getDate()+e)),((t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*vO)/xO),(t=>t.getDate()-1))),jO=(zO.range,yO((t=>{t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+e)}),((t,e)=>(e-t)/xO),(t=>t.getUTCDate()-1))),UO=(jO.range,yO((t=>{t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCDate(t.getUTCDate()+e)}),((t,e)=>(e-t)/xO),(t=>Math.floor(t/xO)))),VO=(UO.range,yO((t=>{t.setMonth(0,1),t.setHours(0,0,0,0)}),((t,e)=>{t.setFullYear(t.getFullYear()+e)}),((t,e)=>e.getFullYear()-t.getFullYear()),(t=>t.getFullYear())));VO.every=t=>isFinite(t=Math.floor(t))&&t>0?yO((e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)}),((e,n)=>{e.setFullYear(e.getFullYear()+n*t)})):null,VO.range;const qO=yO((t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)}),((t,e)=>e.getUTCFullYear()-t.getUTCFullYear()),(t=>t.getUTCFullYear()));function WO(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function HO(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function GO(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function YO(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,o=t.days,s=t.shortDays,a=t.months,l=t.shortMonths,u=sT(i),c=aT(i),h=sT(o),f=aT(o),d=sT(s),p=aT(s),m=sT(a),g=aT(a),y=sT(l),b=aT(l),v={a:function(t){return s[t.getDay()]},A:function(t){return o[t.getDay()]},b:function(t){return l[t.getMonth()]},B:function(t){return a[t.getMonth()]},c:null,d:DT,e:DT,f:NT,g:qT,G:HT,H:MT,I:OT,j:TT,L:IT,m:$T,M:FT,p:function(t){return i[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:mI,s:gI,S:LT,u:BT,U:RT,V:zT,w:jT,W:UT,x:null,X:null,y:VT,Y:WT,Z:GT,"%":pI},w={a:function(t){return s[t.getUTCDay()]},A:function(t){return o[t.getUTCDay()]},b:function(t){return l[t.getUTCMonth()]},B:function(t){return a[t.getUTCMonth()]},c:null,d:YT,e:YT,f:ZT,g:cI,G:fI,H:XT,I:JT,j:KT,L:QT,m:tI,M:eI,p:function(t){return i[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:mI,s:gI,S:nI,u:rI,U:iI,V:sI,w:aI,W:lI,x:null,X:null,y:uI,Y:hI,Z:dI,"%":pI},x={a:function(t,e,n){var r=d.exec(e.slice(n));return r?(t.w=p.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.w=f.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(t,e,n){var r=y.exec(e.slice(n));return r?(t.m=b.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(t,e,n){var r=m.exec(e.slice(n));return r?(t.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(t,n,r){return S(t,e,n,r)},d:bT,e:bT,f:ST,g:pT,G:dT,H:wT,I:wT,j:vT,L:kT,m:yT,M:xT,p:function(t,e,n){var r=u.exec(e.slice(n));return r?(t.p=c.get(r[0].toLowerCase()),n+r[0].length):-1},q:gT,Q:AT,s:CT,S:_T,u:uT,U:cT,V:hT,w:lT,W:fT,x:function(t,e,r){return S(t,n,e,r)},X:function(t,e,n){return S(t,r,e,n)},y:pT,Y:dT,Z:mT,"%":ET};function _(t,e){return function(n){var r,i,o,s=[],a=-1,l=0,u=t.length;for(n instanceof Date||(n=new Date(+n));++a<u;)37===t.charCodeAt(a)&&(s.push(t.slice(l,a)),null!=(i=tT[r=t.charAt(++a)])?r=t.charAt(++a):i="e"===r?" ":"0",(o=e[r])&&(r=o(n,i)),s.push(r),l=a+1);return s.push(t.slice(l,a)),s.join("")}}function k(t,e){return function(n){var r,i,o=GO(1900,void 0,1);if(S(o,t,n+="",0)!=n.length)return null;if("Q"in o)return new Date(o.Q);if("s"in o)return new Date(1e3*o.s+("L"in o?o.L:0));if(e&&!("Z"in o)&&(o.Z=0),"p"in o&&(o.H=o.H%12+12*o.p),void 0===o.m&&(o.m="q"in o?o.q:0),"V"in o){if(o.V<1||o.V>53)return null;"w"in o||(o.w=1),"Z"in o?(i=(r=HO(GO(o.y,0,1))).getUTCDay(),r=i>4||0===i?$O.ceil(r):$O(r),r=jO.offset(r,7*(o.V-1)),o.y=r.getUTCFullYear(),o.m=r.getUTCMonth(),o.d=r.getUTCDate()+(o.w+6)%7):(i=(r=WO(GO(o.y,0,1))).getDay(),r=i>4||0===i?AO.ceil(r):AO(r),r=zO.offset(r,7*(o.V-1)),o.y=r.getFullYear(),o.m=r.getMonth(),o.d=r.getDate()+(o.w+6)%7)}else("W"in o||"U"in o)&&("w"in o||(o.w="u"in o?o.u%7:"W"in o?1:0),i="Z"in o?HO(GO(o.y,0,1)).getUTCDay():WO(GO(o.y,0,1)).getDay(),o.m=0,o.d="W"in o?(o.w+6)%7+7*o.W-(i+5)%7:o.w+7*o.U-(i+6)%7);return"Z"in o?(o.H+=o.Z/100|0,o.M+=o.Z%100,HO(o)):WO(o)}}function S(t,e,n,r){for(var i,o,s=0,a=e.length,l=n.length;s<a;){if(r>=l)return-1;if(37===(i=e.charCodeAt(s++))){if(i=e.charAt(s++),!(o=x[i in tT?e.charAt(s++):i])||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}return v.x=_(n,v),v.X=_(r,v),v.c=_(e,v),w.x=_(n,w),w.X=_(r,w),w.c=_(e,w),{format:function(t){var e=_(t+="",v);return e.toString=function(){return t},e},parse:function(t){var e=k(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=_(t+="",w);return e.toString=function(){return t},e},utcParse:function(t){var e=k(t+="",!0);return e.toString=function(){return t},e}}}qO.every=t=>isFinite(t=Math.floor(t))&&t>0?yO((e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)}),((e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)})):null,qO.range;var XO,JO,KO,QO,ZO,tT={"-":"",_:" ",0:"0"},eT=/^\s*\d+/,nT=/^%/,rT=/[\\^$*+?|[\]().{}]/g;function iT(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",o=i.length;return r+(o<n?new Array(n-o+1).join(e)+i:i)}function oT(t){return t.replace(rT,"\\$&")}function sT(t){return new RegExp("^(?:"+t.map(oT).join("|")+")","i")}function aT(t){return new Map(t.map(((t,e)=>[t.toLowerCase(),e])))}function lT(t,e,n){var r=eT.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function uT(t,e,n){var r=eT.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function cT(t,e,n){var r=eT.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function hT(t,e,n){var r=eT.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function fT(t,e,n){var r=eT.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function dT(t,e,n){var r=eT.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function pT(t,e,n){var r=eT.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function mT(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function gT(t,e,n){var r=eT.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function yT(t,e,n){var r=eT.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function bT(t,e,n){var r=eT.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function vT(t,e,n){var r=eT.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function wT(t,e,n){var r=eT.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function xT(t,e,n){var r=eT.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function _T(t,e,n){var r=eT.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function kT(t,e,n){var r=eT.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function ST(t,e,n){var r=eT.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function ET(t,e,n){var r=nT.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function AT(t,e,n){var r=eT.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function CT(t,e,n){var r=eT.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function DT(t,e){return iT(t.getDate(),e,2)}function MT(t,e){return iT(t.getHours(),e,2)}function OT(t,e){return iT(t.getHours()%12||12,e,2)}function TT(t,e){return iT(1+zO.count(VO(t),t),e,3)}function IT(t,e){return iT(t.getMilliseconds(),e,3)}function NT(t,e){return IT(t,e)+"000"}function $T(t,e){return iT(t.getMonth()+1,e,2)}function FT(t,e){return iT(t.getMinutes(),e,2)}function LT(t,e){return iT(t.getSeconds(),e,2)}function BT(t){var e=t.getDay();return 0===e?7:e}function RT(t,e){return iT(EO.count(VO(t)-1,t),e,2)}function PT(t){var e=t.getDay();return e>=4||0===e?MO(t):MO.ceil(t)}function zT(t,e){return t=PT(t),iT(MO.count(VO(t),t)+(4===VO(t).getDay()),e,2)}function jT(t){return t.getDay()}function UT(t,e){return iT(AO.count(VO(t)-1,t),e,2)}function VT(t,e){return iT(t.getFullYear()%100,e,2)}function qT(t,e){return iT((t=PT(t)).getFullYear()%100,e,2)}function WT(t,e){return iT(t.getFullYear()%1e4,e,4)}function HT(t,e){var n=t.getDay();return iT((t=n>=4||0===n?MO(t):MO.ceil(t)).getFullYear()%1e4,e,4)}function GT(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+iT(e/60|0,"0",2)+iT(e%60,"0",2)}function YT(t,e){return iT(t.getUTCDate(),e,2)}function XT(t,e){return iT(t.getUTCHours(),e,2)}function JT(t,e){return iT(t.getUTCHours()%12||12,e,2)}function KT(t,e){return iT(1+jO.count(qO(t),t),e,3)}function QT(t,e){return iT(t.getUTCMilliseconds(),e,3)}function ZT(t,e){return QT(t,e)+"000"}function tI(t,e){return iT(t.getUTCMonth()+1,e,2)}function eI(t,e){return iT(t.getUTCMinutes(),e,2)}function nI(t,e){return iT(t.getUTCSeconds(),e,2)}function rI(t){var e=t.getUTCDay();return 0===e?7:e}function iI(t,e){return iT(NO.count(qO(t)-1,t),e,2)}function oI(t){var e=t.getUTCDay();return e>=4||0===e?BO(t):BO.ceil(t)}function sI(t,e){return t=oI(t),iT(BO.count(qO(t),t)+(4===qO(t).getUTCDay()),e,2)}function aI(t){return t.getUTCDay()}function lI(t,e){return iT($O.count(qO(t)-1,t),e,2)}function uI(t,e){return iT(t.getUTCFullYear()%100,e,2)}function cI(t,e){return iT((t=oI(t)).getUTCFullYear()%100,e,2)}function hI(t,e){return iT(t.getUTCFullYear()%1e4,e,4)}function fI(t,e){var n=t.getUTCDay();return iT((t=n>=4||0===n?BO(t):BO.ceil(t)).getUTCFullYear()%1e4,e,4)}function dI(){return"+0000"}function pI(){return"%"}function mI(t){return+t}function gI(t){return Math.floor(+t/1e3)}function yI(t,e,n){this.k=t,this.x=e,this.y=n}function bI(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}XO=YO({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}),JO=XO.format,KO=XO.parse,QO=XO.utcFormat,ZO=XO.utcParse,yI.prototype={constructor:yI,scale:function(t){return 1===t?this:new yI(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new yI(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}},new yI(1,0,0),yI.prototype;var vI=kM(",.1f");const wI=jE((function(t){var e,n,r=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,s,a=[],l=!0,u=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(t){u=!0,i=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}(e,n)||function(t,e){if(t){if("string"==typeof t)return bI(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?bI(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=r[0];return r[1],vI(i)}));function xI(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}const _I=jE((function(t){var e,n,r=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,s,a=[],l=!0,u=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(t){u=!0,i=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}(e,n)||function(t,e){if(t){if("string"==typeof t)return xI(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?xI(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());return r[0],r[1],"Wochen"}));function kI(t){return kI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},kI(t)}function SI(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function EI(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,AI(r.key),r)}}function AI(t){var e=function(t,e){if("object"!=kI(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=kI(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==kI(e)?e:e+""}const CI=Qo((function(t){return{createModifier:function(t,e){return new t},installModifier:function(t,e,n){t.element=e,t.install(n)},updateModifier:function(t,e){t.modify(e)},destroyModifier:function(t,e){t.destroy(e)},capabilities:function(){return{disableAutoTracking:!0}}}}),function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"install",value:function(t){this.resizeObserver=new ResizeObserver(function(e){var n,r=function(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=function(t,e){if(t){if("string"==typeof t)return SI(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?SI(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(console.log(i),i.contentRect){this.element.width=i.contentRect.width,console.log(i.contentRect.width);var o=this.element;(0,t.positional[0])(o)}}}catch(t){r.e(t)}finally{r.f()}}.bind(this)),this.resizeObserver.observe(this.element.parentElement);var e=this.element;(0,t.positional[0])(e)}},{key:"modify",value:function(t){var e=this.element;(0,t.positional[0])(e)}},{key:"destroy",value:function(t){this.resizeObserver.unobserve(this.element)}}],e&&EI(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}());function DI(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}const MI=jE((function(t){return(e=t,n=1,function(t){if(Array.isArray(t))return t}(e)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,s,a=[],l=!0,u=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(t){u=!0,i=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}(e,n)||function(t,e){if(t){if("string"==typeof t)return DI(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?DI(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0]<0?"text-error":"text-success";var e,n}));function OI(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var TI=kM(",.1%");const II=jE((function(t){var e,n,r=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,s,a=[],l=!0,u=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(t){u=!0,i=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}(e,n)||function(t,e){if(t){if("string"==typeof t)return OI(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?OI(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=r[0];return r[1],TI(i)}));function NI(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}var $I=QO("%d.%m.%Y");const FI=jE((function(t){var e,n,r=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,s,a=[],l=!0,u=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(t){u=!0,i=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}(e,n)||function(t,e){if(t){if("string"==typeof t)return NI(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?NI(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),i=r[0],o=(r[1],new Date(Date.parse(i)));return $I(o)}));function LI(t){return LI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},LI(t)}var BI;function RI(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,PI(r.key),r)}}function PI(t){var e=function(t,e){if("object"!=LI(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=LI(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==LI(e)?e:e+""}function zI(t,e,n){return e=UI(e),function(t,e){if(e&&("object"==LI(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,jI()?Reflect.construct(e,n||[],UI(t).constructor):e.apply(t,n))}function jI(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(jI=function(){return!!t})()}function UI(t){return UI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},UI(t)}function VI(t,e){return VI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},VI(t,e)}var qI=(BI=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),zI(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&VI(t,e)}(e,t),n=e,(r=[{key:"update",value:function(t){this.args.onInput&&this.args.onInput(t.target.value)}}])&&RI(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(_u),function(t,e,n,r,i){var o={};Object.keys(r).forEach((function(t){o[t]=r[t]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(t,e,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(t,e,o),o=null)}(BI.prototype,"update",[Mu],Object.getOwnPropertyDescriptor(BI.prototype,"update"),BI.prototype),BI);ns(Va({id:"pgto2Qqs",block:'[[[1,"\\n"],[10,"label"],[14,0,"form-control w-full max-w-xs"],[12],[1,"\\n  "],[10,0],[14,0,"label"],[12],[1,"\\n    "],[10,1],[14,0,"label-text"],[12],[1,[30,1]],[13],[1,"\\n  "],[13],[1,"\\n  "],[11,"input"],[16,2,[30,2]],[24,"placeholder",""],[24,0,"input input-bordered w-full max-w-xs"],[24,4,"text"],[4,[32,0],["input",[30,0,["update"]]],null],[12],[13],[1,"\\n"],[13],[1,"    "]],["@title","@value"],false,[]]',moduleName:"(unknown template module)",scope:function(){return[Xl]},isStrictMode:!0}),qI);const WI=qI;function HI(t){return HI="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},HI(t)}var GI;function YI(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,XI(r.key),r)}}function XI(t){var e=function(t,e){if("object"!=HI(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=HI(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==HI(e)?e:e+""}function JI(t,e,n){return e=QI(e),function(t,e){if(e&&("object"==HI(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,KI()?Reflect.construct(e,n||[],QI(t).constructor):e.apply(t,n))}function KI(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(KI=function(){return!!t})()}function QI(t){return QI=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},QI(t)}function ZI(t,e){return ZI=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},ZI(t,e)}var tN=(GI=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),JI(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&ZI(t,e)}(e,t),n=e,(r=[{key:"update",value:function(t){this.args.onInput&&this.args.onInput(t.target.value)}}])&&YI(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(_u),function(t,e,n,r,i){var o={};Object.keys(r).forEach((function(t){o[t]=r[t]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(t,e,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(t,e,o),o=null)}(GI.prototype,"update",[Mu],Object.getOwnPropertyDescriptor(GI.prototype,"update"),GI.prototype),GI);ns(Va({id:"kKPsph2o",block:'[[[1,"\\n"],[10,"label"],[14,0,"form-control"],[12],[1,"\\n  "],[10,0],[14,0,"label"],[12],[1,"\\n    "],[10,1],[14,0,"label-text"],[12],[1,[30,1]],[13],[1,"\\n  "],[13],[1,"\\n  "],[11,"textarea"],[24,0,"textarea textarea-bordered h-24"],[24,"placeholder",""],[4,[32,0],["input",[30,0,["update"]]],null],[12],[1,[30,2]],[13],[1,"\\n"],[13]],["@title","@value"],false,[]]',moduleName:"(unknown template module)",scope:function(){return[Xl]},isStrictMode:!0}),tN);const eN=tN;function nN(t){return nN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nN(t)}var rN,iN,oN,sN,aN,lN;function uN(t,e,n,r){n&&Object.defineProperty(t,e,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function cN(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,mN(r.key),r)}}function hN(t,e,n){return e=dN(e),function(t,e){if(e&&("object"==nN(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,fN()?Reflect.construct(e,n||[],dN(t).constructor):e.apply(t,n))}function fN(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(fN=function(){return!!t})()}function dN(t){return dN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},dN(t)}function pN(t,e){return pN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},pN(t,e)}function mN(t){var e=function(t,e){if("object"!=nN(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=nN(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==nN(e)?e:e+""}function gN(t,e,n,r,i){var o={};return Object.keys(r).forEach((function(t){o[t]=r[t]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(t,e,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(t,e,o),o=null),o}var yN=(rN=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return uN(t=hN(this,e,[].concat(r)),"data",iN,t),uN(t,"dateCalc",oN,t),uN(t,"_dateColumn",sN,t),uN(t,"_valueColumn",aN,t),uN(t,"editMode",lN,t),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&pN(t,e)}(e,t),n=e,r=[{key:"title",get:function(){return this.args.title}},{key:"dateColumn",get:function(){return this._dateColumn||this.args.dateColumn||"date"}},{key:"valueColumn",get:function(){return this._valueColumn||this.args.valueColumn||"value"}},{key:"date",get:function(){try{return RE(this.data.groupedTable,zc.max(this.dateColumn))}catch(t){return null}}},{key:"display",get:function(){return this.args.display||"isoweek"}},{key:"totalsFilter",get:function(){return this.args.totalsFilter}},{key:"totalsFilterParams",get:function(){return this.args.totalsFilterParams}},{key:"showBenchmark",get:function(){return void 0===this.args.showBenchmark||this.args.showBenchmark}},{key:"showTrend",get:function(){return void 0===this.args.showTrend||this.args.showTrend}},{key:"benchmarkTitle",get:function(){return this.args.benchmarkTitle}},{key:"totalTable",get:function(){try{var t=this.data.groupedTable.reify();return this.date&&(t=t.params({dateSet:[this.date],dateColumn:this.dateColumn}).filter((function(t,e){return zc.includes(e.dateSet,t[e.dateColumn])}))),this.totalsFilter&&(t=t.params(this.totalsFilterParams).filter(this.totalsFilter)),this.data.rollup&&(t=t.rollup(this.data.rollup)),this.data.derive&&(t=t.derive(this.data.derive)),t}catch(t){return console.log("totalTable failed: "+t),null}}},{key:"trendTable",get:function(){try{if(null==this.date)return null;var t=this.data.groupedTable.reify().groupby(this.dateColumn);if(this.totalsFilter&&(t=t.params(this.totalsFilterParams).filter(this.totalsFilter)),t=t.params({dateSet:["2024-07-01","2024-04-01","2024-01-01"],dateColumn:this.dateColumn}).filter((function(t,e){return zc.includes(e.dateSet,t[e.dateColumn])})),this.data.rollup)t=t.rollup(this.data.rollup);else{var e={};e[this.valueColumn]=zc.sum(this.valueColumn),t=t.rollup(e)}return this.data.derive&&(t=t.derive(this.data.derive)),t}catch(t){return console.log("trendTable failed: "+t),null}}},{key:"summarizedTable",get:function(){try{var t=this.data.groupedTable.reify();return this.date&&(t=t.params({dateSet:[this.date],dateColumn:this.dateColumn}).filter((function(t,e){return zc.includes(e.dateSet,t[e.dateColumn])}))),this.totalsFilter&&(totalTable=totalTable.params(this.totalsFilterParams).filter(this.totalsFilter)),this.data.rollup&&(t=t.rollup(this.data.rollup)),this.data.derive&&(t=t.derive(this.data.derive)),t}catch(t){return console.log("summarytable failed: "+t),null}}},{key:"value",get:function(){return this.totalTable&&this.totalTable.columnIndex(this.valueColumn)>-1?RE(this.totalTable,zc.sum(this.valueColumn)):null}},{key:"median",get:function(){return this.summarizedTable&&this.summarizedTable.columnIndex(this.valueColumn)>-1?RE(this.summarizedTable,zc.median(this.valueColumn)):null}},{key:"q25",get:function(){return this.summarizedTable&&this.summarizedTable.columnIndex(this.valueColumn)>-1?RE(this.summarizedTable,zc.quantile(this.valueColumn,.25)):null}},{key:"q75",get:function(){return this.summarizedTable&&this.summarizedTable.columnIndex(this.valueColumn)>-1?RE(this.summarizedTable,zc.quantile(this.valueColumn,.75)):null}},{key:"trend",get:function(){return this.value/this.comparison-1}},{key:"comparison",get:function(){return this.trendTable&&this.trendTable.columnIndex(this.valueColumn)>-1?RE(this.trendTable,zc.mean(this.valueColumn)):null}},{key:"previousDate",get:function(){return this.dateCalc.previousDate(this.date,this.display,1)}},{key:"drawCanvas",value:function(t){var e=t.getContext("2d"),n=t.width,r=t.height,i=pO([0,1.1*VE([0,this.value,this.median,this.q25,this.q75])],[0,n]);e.fillStyle="#F2F2F2",e.fillRect(0,0,n,r-0-20),this.showBenchmark&&(e.fillStyle="#D7DDE4",e.fillRect(i(this.q25),0,i(this.q75)-i(this.q25),r-20-0),e.fillStyle="#2B3440",e.fillRect(i(this.median)-2,0,4,r-20-0)),e.fillStyle="rgb(31, 119, 180)",e.fillRect(0,6,i(this.value),r-26-6),this.showTrend&&(e.fillStyle="rgb(174, 199, 232)",e.fillRect(i(this.comparison)-2,0,4,r-20-0));var o=t.height-20,s=i.ticks();e.strokeStyle="#1f2937",e.beginPath(),s.forEach((function(t){e.moveTo(i(t),o),e.lineTo(i(t),o+6)})),e.stroke(),e.beginPath(),e.moveTo(0,o+6),e.lineTo(0,o),e.lineTo(n,o),e.lineTo(n,o+6),e.stroke(),e.textAlign="center",e.textBaseline="top",e.fillStyle="black",s.forEach((function(t){e.beginPath(),e.fillText(vI(t),i(t),o+6)}))}},{key:"updateDateColumn",value:function(t){try{this._dateColumn=t}catch(t){this._dateColumn=null}}},{key:"updateValueColumn",value:function(t){try{this._valueColumn=t}catch(t){this._valueColumn=null}}},{key:"toggleEditMode",value:function(){this.editMode=!this.editMode}}],r&&cN(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(_u),iN=gN(rN.prototype,"data",[Cu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),oN=gN(rN.prototype,"dateCalc",[Cu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),sN=gN(rN.prototype,"_dateColumn",[Su],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),aN=gN(rN.prototype,"_valueColumn",[Su],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),lN=gN(rN.prototype,"editMode",[Su],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),gN(rN.prototype,"drawCanvas",[Mu],Object.getOwnPropertyDescriptor(rN.prototype,"drawCanvas"),rN.prototype),gN(rN.prototype,"updateDateColumn",[Mu],Object.getOwnPropertyDescriptor(rN.prototype,"updateDateColumn"),rN.prototype),gN(rN.prototype,"updateValueColumn",[Mu],Object.getOwnPropertyDescriptor(rN.prototype,"updateValueColumn"),rN.prototype),gN(rN.prototype,"toggleEditMode",[Mu],Object.getOwnPropertyDescriptor(rN.prototype,"toggleEditMode"),rN.prototype),rN);ns(Va({id:"0Fbv26jH",block:'[[[1,"\\n      "],[10,0],[14,0,"widget"],[12],[1,"\\n"],[41,[51,[30,0,["editMode"]]],[[[1,"      \\t"],[10,0],[14,0,"widget-view"],[12],[1,"\\n\\t\\t\\t"],[10,0],[14,0,"widget-date"],[12],[1,[28,[32,0],[[30,0,["date"]]],null]],[13],[1,"\\n\\t\\t\\t"],[10,0],[14,0,"widget-title"],[12],[1,[30,0,["title"]]],[13],[1,"\\n\\t\\t\\t"],[10,0],[14,0,"widget-value"],[12],[1,[28,[32,1],[[30,0,["value"]]],null]],[13],[1,"\\n\\t\\t\\t"],[10,0],[14,0,"widget-canvas"],[12],[1,"\\n\\t\\t\\t\\t"],[11,"canvas"],[24,"width","300"],[24,"height","40"],[4,[32,2],[[30,0,["drawCanvas"]]],null],[12],[13],[1,"\\n\\t\\t\\t"],[13],[1,"\\t\\n"],[41,[30,0,["showBenchmark"]],[[[1,"\\t\\t\\t"],[10,0],[14,0,"widget-benchmark"],[12],[1,"\\n\\t\\t\\t\\t"],[1,[30,0,["benchmarkTitle"]]],[1,": \\n\\t\\t\\t\\t\\tQ25: "],[1,[28,[32,1],[[30,0,["q25"]]],null]],[1,"\\n\\t\\t\\t\\t\\t- \\n\\t\\t\\t\\t\\tM: "],[1,[28,[32,1],[[30,0,["median"]]],null]],[1,"\\n\\t\\t\\t\\t\\t- \\n\\t\\t\\t\\t\\tQ75: "],[1,[28,[32,1],[[30,0,["q75"]]],null]],[1,"\\n\\t\\t\\t"],[13],[1,"\\n"]],[]],null],[1,"\\t\\t\\t"],[10,0],[14,0,"widget-trend"],[12],[1,"\\n\\t\\t\\t\\t"],[10,0],[14,0,"left"],[12],[1,"âŒ€ drei "],[1,[28,[32,3],[[30,0,["display"]]],null]],[1,": "],[1,[28,[32,1],[[30,0,["comparison"]]],null]],[1," "],[13],[1,"\\n\\t\\t\\t\\t"],[10,0],[15,0,[29,["right ",[28,[32,4],[[30,0,["trend"]]],null]]]],[12],[1,[28,[32,5],[[30,0,["trend"]]],null]],[13],[1,"\\n\\t\\t\\t"],[13],[1,"\\n\\t\\t\\t"],[10,0],[14,0,"widget-toggle"],[12],[1,"\\n\\t\\t\\t\\t"],[11,"button"],[24,0,"btn btn-xs btn-info"],[4,[32,6],["click",[30,0,["toggleEditMode"]]],null],[12],[1,"â„¹"],[13],[1,"\\n\\t\\t\\t"],[13],[1,"\\n\\t\\t"],[13],[1,"\\n"]],[]],null],[41,[30,0,["editMode"]],[[[1,"    \\t"],[10,0],[14,0,"widget-edit"],[12],[1,"\\n    \\t\\t"],[10,0],[14,0,"widget-edit-title"],[12],[1,"Bearbeiten"],[13],[1,"\\n    \\t\\t"],[10,0],[14,0,"grid grid-cols-3 gap-4"],[12],[1,"\\n    \\t\\t\\t"],[10,0],[14,0,"field"],[12],[1,"\\n    \\t\\t\\t    "],[8,[32,7],null,[["@title","@value","@onInput"],["Date column",[30,0,["dateColumn"]],[30,0,["updateDateColumn"]]]],null],[1,"\\n\\t\\t\\t\\t"],[13],[1,"\\n    \\t\\t\\t"],[10,0],[14,0,"field"],[12],[1,"\\n    \\t\\t\\t    "],[8,[32,7],null,[["@title","@value","@onInput"],["Value column",[30,0,["valueColumn"]],[30,0,["updateValueColumn"]]]],null],[1,"\\n\\t\\t\\t\\t"],[13],[1,"\\n    \\t\\t"],[13],[1,"\\n\\t\\t\\t"],[10,0],[14,0,"widget-toggle"],[12],[1,"\\n\\t\\t\\t\\t"],[11,"button"],[24,0,"btn btn-xs btn-info"],[4,[32,6],["click",[30,0,["toggleEditMode"]]],null],[12],[1,"â„¹"],[13],[1,"\\n\\t\\t\\t"],[13],[1,"\\n    \\t"],[13],[1,"\\n"]],[]],null],[1,"  \\t"],[13],[1,"\\n    "]],[],false,["unless","if"]]',moduleName:"(unknown template module)",scope:function(){return[FI,wI,CI,_I,MI,II,Xl,WI]},isStrictMode:!0}),yN);const bN=yN;function vN(t){return vN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},vN(t)}var wN,xN;function _N(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,CN(r.key),r)}}function kN(t,e,n){return e=EN(e),function(t,e){if(e&&("object"==vN(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,SN()?Reflect.construct(e,n||[],EN(t).constructor):e.apply(t,n))}function SN(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(SN=function(){return!!t})()}function EN(t){return EN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},EN(t)}function AN(t,e){return AN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},AN(t,e)}function CN(t){var e=function(t,e){if("object"!=vN(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=vN(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==vN(e)?e:e+""}var DN=(wN=function(t){function e(){var t,n,r,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n=t=kN(this,e,[].concat(s)),i=t,(r=xN)&&Object.defineProperty(n,"data",{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&AN(t,e)}(e,t),n=e,(r=[{key:"summarizedTable",get:function(){try{var t=this.data.groupedTable;return this.data.rollup&&(t=t.rollup(this.data.rollup)),this.data.derive&&(t=t.derive(this.data.derive)),t}catch(t){return console.log("summarytable failed: "+t),null}}}])&&_N(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(_u),xN=function(t,e,n,r,i){var o={};return Object.keys(r).forEach((function(t){o[t]=r[t]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(t,e,n)||n}),o),void 0===o.initializer&&(Object.defineProperty(t,e,o),o=null),o}(wN.prototype,"data",[Cu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),wN);ns(Va({id:"hAt8Y9LW",block:'[[[10,0],[14,0,"widget"],[12],[1,"\\n    \\t"],[10,0],[14,0,"widget-table"],[12],[1,"\\n\\t        "],[1,[30,0,["summarizedTable"]]],[1,"\\n\\t    "],[13],[1,"\\n    "],[13],[1,"\\n    "]],[],false,[]]',moduleName:"(unknown template module)",isStrictMode:!0}),DN);const MN=DN;function ON(t){return ON="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ON(t)}function TN(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,IN(r.key),r)}}function IN(t){var e=function(t,e){if("object"!=ON(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=ON(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ON(e)?e:e+""}function NN(t,e,n){return e=FN(e),function(t,e){if(e&&("object"==ON(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,$N()?Reflect.construct(e,n||[],FN(t).constructor):e.apply(t,n))}function $N(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return($N=function(){return!!t})()}function FN(t){return FN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},FN(t)}function LN(t,e){return LN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},LN(t,e)}function BN(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}jE((function(t,e){var n,r,i=(n=t,r=1,function(t){if(Array.isArray(t))return t}(n)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,s,a=[],l=!0,u=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(t){u=!0,i=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}(n,r)||function(t,e){if(t){if("string"==typeof t)return BN(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?BN(t,e):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],o=e.greeting;return"".concat(o," ").concat(i)}));var RN,PN,zN=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),NN(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&LN(t,e)}(e,t),n=e,(r=[{key:"time",get:function(){return"time"}}])&&TN(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(_u);function jN(t){return jN="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},jN(t)}function UN(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,GN(r.key),r)}}function VN(t,e,n){return e=WN(e),function(t,e){if(e&&("object"==jN(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,qN()?Reflect.construct(e,n||[],WN(t).constructor):e.apply(t,n))}function qN(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(qN=function(){return!!t})()}function WN(t){return WN=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},WN(t)}function HN(t,e){return HN=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},HN(t,e)}function GN(t){var e=function(t,e){if("object"!=jN(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=jN(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==jN(e)?e:e+""}function YN(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}ns(Va({id:"G4nN51O5",block:'[[[1,"\\n      "],[10,0],[14,0,"widget"],[12],[1,"\\n    \\t"],[10,0],[14,0,"widget-title"],[12],[1,"Current time"],[13],[1,"\\n    \\t"],[1,[30,0,["time"]]],[1,"\\n  \\t"],[13],[1,"\\n    "]],[],false,[]]',moduleName:"(unknown template module)",isStrictMode:!0}),zN),jE((function(t,e){var n,r,i=(n=t,r=1,function(t){if(Array.isArray(t))return t}(n)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,s,a=[],l=!0,u=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(t){u=!0,i=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}(n,r)||function(t,e){if(t){if("string"==typeof t)return YN(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?YN(t,e):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],o=e.greeting;return"".concat(o," ").concat(i)}));var XN=(RN=function(t){function e(){var t,n,r,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n=t=VN(this,e,[].concat(s)),i=t,(r=PN)&&Object.defineProperty(n,"data",{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&HN(t,e)}(e,t),n=e,(r=[{key:"filter",get:function(){return this.data.filter}},{key:"groupColumns",get:function(){return this.data.groupColumns}},{key:"groupNames",get:function(){return""}},{key:"columnNames",get:function(){return this.data.filteredTable.columnNames()}},{key:"derive",get:function(){return JSON.stringify(this.data.derive)}},{key:"rollup",get:function(){return JSON.stringify(this.data.rollup)}}])&&UN(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(_u),PN=function(t,e,n,r,i){var o={};return Object.keys(r).forEach((function(t){o[t]=r[t]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(t,e,n)||n}),o),void 0===o.initializer&&(Object.defineProperty(t,e,o),o=null),o}(RN.prototype,"data",[Cu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),RN);ns(Va({id:"EQEWKcFb",block:'[[[1,"\\n      "],[10,0],[14,0,"widget"],[12],[1,"\\n      \\t"],[10,0],[14,0,"widget-title"],[12],[1,"DEBUG"],[13],[1,"\\n      \\t"],[10,0],[14,0,""],[12],[1,"\\n      \\t\\tFilter:\\n      \\t\\t"],[1,[30,0,["filter"]]],[1,"\\n      \\t"],[13],[1,"\\n      \\t"],[10,0],[14,0,""],[12],[1,"\\n      \\t\\tGroup:\\n      \\t\\t"],[1,[30,0,["groupColumns"]]],[1,"\\n      \\t"],[13],[1,"\\n      \\t"],[10,0],[14,0,""],[12],[1,"\\n      \\t\\tColumn names:\\n      \\t\\t"],[1,[30,0,["columnNames"]]],[1,"\\n      \\t"],[13],[1,"\\n      \\t"],[10,0],[14,0,""],[12],[1,"\\n      \\t\\tRollup:\\n      \\t\\t"],[1,[30,0,["rollup"]]],[1,"\\n      \\t"],[13],[1,"\\n      \\t"],[10,0],[14,0,""],[12],[1,"\\n      \\t\\tDerive:\\n      \\t\\t"],[1,[30,0,["derive"]]],[1,"\\n      \\t"],[13],[1,"\\n  \\t"],[13],[1,"\\n    "]],[],false,[]]',moduleName:"(unknown template module)",isStrictMode:!0}),XN);const JN=XN;var KN,QN=(KN=function(t,e){return KN=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},KN(t,e)},function(t,e){function n(){this.constructor=t}KN(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}),ZN=Object.prototype.hasOwnProperty;function t$(t,e){return ZN.call(t,e)}function e$(t){if(Array.isArray(t)){for(var e=new Array(t.length),n=0;n<e.length;n++)e[n]=""+n;return e}if(Object.keys)return Object.keys(t);var r=[];for(var i in t)t$(t,i)&&r.push(i);return r}function n$(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function r$(t){for(var e,n=0,r=t.length;n<r;){if(!((e=t.charCodeAt(n))>=48&&e<=57))return!1;n++}return!0}function i$(t){return-1===t.indexOf("/")&&-1===t.indexOf("~")?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function o$(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function s$(t){if(void 0===t)return!0;if(t)if(Array.isArray(t)){for(var e=0,n=t.length;e<n;e++)if(s$(t[e]))return!0}else if("object"==typeof t)for(var r=e$(t),i=r.length,o=0;o<i;o++)if(s$(t[r[o]]))return!0;return!1}function a$(t,e){var n=[t];for(var r in e){var i="object"==typeof e[r]?JSON.stringify(e[r],null,2):e[r];void 0!==i&&n.push(r+": "+i)}return n.join("\n")}var l$=function(t){function e(e,n,r,i,o){var s=this.constructor,a=t.call(this,a$(e,{name:n,index:r,operation:i,tree:o}))||this;return a.name=n,a.index=r,a.operation=i,a.tree=o,Object.setPrototypeOf(a,s.prototype),a.message=a$(e,{name:n,index:r,operation:i,tree:o}),a}return QN(e,t),e}(Error),u$=l$,c$=n$,h$={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var r=t[e];return delete t[e],{newDocument:n,removed:r}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:function(t,e,n){var r=d$(n,this.path);r&&(r=n$(r));var i=p$(n,{op:"remove",path:this.from}).removed;return p$(n,{op:"add",path:this.path,value:i}),{newDocument:n,removed:r}},copy:function(t,e,n){var r=d$(n,this.from);return p$(n,{op:"add",path:this.path,value:n$(r)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:v$(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}},f$={add:function(t,e,n){return r$(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){return{newDocument:n,removed:t.splice(e,1)[0]}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:h$.move,copy:h$.copy,test:h$.test,_get:h$._get};function d$(t,e){if(""==e)return t;var n={op:"_get",path:e};return p$(t,n),n.value}function p$(t,e,n,r,i,o){if(void 0===n&&(n=!1),void 0===r&&(r=!0),void 0===i&&(i=!0),void 0===o&&(o=0),n&&("function"==typeof n?n(e,0,t,e.path):y$(e,0)),""===e.path){var s={newDocument:t};if("add"===e.op)return s.newDocument=e.value,s;if("replace"===e.op)return s.newDocument=e.value,s.removed=t,s;if("move"===e.op||"copy"===e.op)return s.newDocument=d$(t,e.from),"move"===e.op&&(s.removed=t),s;if("test"===e.op){if(s.test=v$(t,e.value),!1===s.test)throw new u$("Test operation failed","TEST_OPERATION_FAILED",o,e,t);return s.newDocument=t,s}if("remove"===e.op)return s.removed=t,s.newDocument=null,s;if("_get"===e.op)return e.value=t,s;if(n)throw new u$("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",o,e,t);return s}r||(t=n$(t));var a=(e.path||"").split("/"),l=t,u=1,c=a.length,h=void 0,f=void 0,d=void 0;for(d="function"==typeof n?n:y$;;){if((f=a[u])&&-1!=f.indexOf("~")&&(f=o$(f)),i&&("__proto__"==f||"prototype"==f&&u>0&&"constructor"==a[u-1]))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&void 0===h&&(void 0===l[f]?h=a.slice(0,u).join("/"):u==c-1&&(h=e.path),void 0!==h&&d(e,0,t,h)),u++,Array.isArray(l)){if("-"===f)f=l.length;else{if(n&&!r$(f))throw new u$("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",o,e,t);r$(f)&&(f=~~f)}if(u>=c){if(n&&"add"===e.op&&f>l.length)throw new u$("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",o,e,t);if(!1===(s=f$[e.op].call(e,l,f,t)).test)throw new u$("Test operation failed","TEST_OPERATION_FAILED",o,e,t);return s}}else if(u>=c){if(!1===(s=h$[e.op].call(e,l,f,t)).test)throw new u$("Test operation failed","TEST_OPERATION_FAILED",o,e,t);return s}if(l=l[f],n&&u<c&&(!l||"object"!=typeof l))throw new u$("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",o,e,t)}}function m$(t,e,n,r,i){if(void 0===r&&(r=!0),void 0===i&&(i=!0),n&&!Array.isArray(e))throw new u$("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(t=n$(t));for(var o=new Array(e.length),s=0,a=e.length;s<a;s++)o[s]=p$(t,e[s],n,!0,i,s),t=o[s].newDocument;return o.newDocument=t,o}function g$(t,e,n){var r=p$(t,e);if(!1===r.test)throw new u$("Test operation failed","TEST_OPERATION_FAILED",n,e,t);return r.newDocument}function y$(t,e,n,r){if("object"!=typeof t||null===t||Array.isArray(t))throw new u$("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(!h$[t.op])throw new u$("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n);if("string"!=typeof t.path)throw new u$("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(0!==t.path.indexOf("/")&&t.path.length>0)throw new u$('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if(("move"===t.op||"copy"===t.op)&&"string"!=typeof t.from)throw new u$("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&void 0===t.value)throw new u$("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if(("add"===t.op||"replace"===t.op||"test"===t.op)&&s$(t.value))throw new u$("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n)if("add"==t.op){var i=t.path.split("/").length,o=r.split("/").length;if(i!==o+1&&i!==o)throw new u$("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if("replace"===t.op||"remove"===t.op||"_get"===t.op){if(t.path!==r)throw new u$("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if("move"===t.op||"copy"===t.op){var s=b$([{op:"_get",path:t.from,value:void 0}],n);if(s&&"OPERATION_PATH_UNRESOLVABLE"===s.name)throw new u$("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}function b$(t,e,n){try{if(!Array.isArray(t))throw new u$("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)m$(n$(e),n$(t),n||!0);else{n=n||y$;for(var r=0;r<t.length;r++)n(t[r],r,e,void 0)}}catch(t){if(t instanceof u$)return t;throw t}}function v$(t,e){if(t===e)return!0;if(t&&e&&"object"==typeof t&&"object"==typeof e){var n,r,i,o=Array.isArray(t),s=Array.isArray(e);if(o&&s){if((r=t.length)!=e.length)return!1;for(n=r;0!=n--;)if(!v$(t[n],e[n]))return!1;return!0}if(o!=s)return!1;var a=Object.keys(t);if((r=a.length)!==Object.keys(e).length)return!1;for(n=r;0!=n--;)if(!e.hasOwnProperty(a[n]))return!1;for(n=r;0!=n--;)if(!v$(t[i=a[n]],e[i]))return!1;return!0}return t!=t&&e!=e}var w$=new WeakMap,x$=function(t){this.observers=new Map,this.obj=t},_$=function(t,e){this.callback=t,this.observer=e};function k$(t,e){e.unobserve()}function S$(t,e){var n,r=function(t){return w$.get(t)}(t);if(r){var i=function(t,e){return t.observers.get(e)}(r,e);n=i&&i.observer}else r=new x$(t),w$.set(t,r);if(n)return n;if(n={},r.value=n$(t),e){n.callback=e,n.next=null;var o=function(){E$(n)},s=function(){clearTimeout(n.next),n.next=setTimeout(o)};"undefined"!=typeof window&&(window.addEventListener("mouseup",s),window.addEventListener("keyup",s),window.addEventListener("mousedown",s),window.addEventListener("keydown",s),window.addEventListener("change",s))}return n.patches=[],n.object=t,n.unobserve=function(){E$(n),clearTimeout(n.next),function(t,e){t.observers.delete(e.callback)}(r,n),"undefined"!=typeof window&&(window.removeEventListener("mouseup",s),window.removeEventListener("keyup",s),window.removeEventListener("mousedown",s),window.removeEventListener("keydown",s),window.removeEventListener("change",s))},r.observers.set(e,new _$(e,n)),n}function E$(t,e){void 0===e&&(e=!1);var n=w$.get(t.object);A$(n.value,t.object,t.patches,"",e),t.patches.length&&m$(n.value,t.patches);var r=t.patches;return r.length>0&&(t.patches=[],t.callback&&t.callback(r)),r}function A$(t,e,n,r,i){if(e!==t){"function"==typeof e.toJSON&&(e=e.toJSON());for(var o=e$(e),s=e$(t),a=!1,l=s.length-1;l>=0;l--){var u=t[h=s[l]];if(!t$(e,h)||void 0===e[h]&&void 0!==u&&!1===Array.isArray(e))Array.isArray(t)===Array.isArray(e)?(i&&n.push({op:"test",path:r+"/"+i$(h),value:n$(u)}),n.push({op:"remove",path:r+"/"+i$(h)}),a=!0):(i&&n.push({op:"test",path:r,value:t}),n.push({op:"replace",path:r,value:e}));else{var c=e[h];"object"==typeof u&&null!=u&&"object"==typeof c&&null!=c&&Array.isArray(u)===Array.isArray(c)?A$(u,c,n,r+"/"+i$(h),i):u!==c&&(i&&n.push({op:"test",path:r+"/"+i$(h),value:n$(u)}),n.push({op:"replace",path:r+"/"+i$(h),value:n$(c)}))}}if(a||o.length!=s.length)for(l=0;l<o.length;l++){var h;t$(t,h=o[l])||void 0===e[h]||n.push({op:"add",path:r+"/"+i$(h),value:n$(e[h])})}}}function C$(t,e,n){void 0===n&&(n=!1);var r=[];return A$(t,e,r,"",n),r}Object.assign({},t,e,{JsonPatchError:l$,deepClone:n$,escapePathComponent:i$,unescapePathComponent:o$});var D$=n(122),M$=n.n(D$);function O$(t,e,n){return t.fields=e||[],t.fname=n,t}function T$(t){return null==t?null:t.fname}function I$(t){return null==t?null:t.fields}function N$(t){return 1===t.length?$$(t[0]):F$(t)}const $$=t=>function(e){return e[t]},F$=t=>{const e=t.length;return function(n){for(let r=0;r<e;++r)n=n[t[r]];return n}};function L$(t){throw Error(t)}function B$(t){const e=[],n=t.length;let r,i,o,s=null,a=0,l="";function u(){e.push(l+t.substring(r,i)),l="",r=i+1}for(t+="",r=i=0;i<n;++i)if(o=t[i],"\\"===o)l+=t.substring(r,i++),r=i;else if(o===s)u(),s=null,a=-1;else{if(s)continue;r===a&&'"'===o||r===a&&"'"===o?(r=i+1,s=o):"."!==o||a?"["===o?(i>r&&u(),a=r=i+1):"]"===o&&(a||L$("Access path missing open bracket: "+t),a>0&&u(),a=0,r=i+1):i>r?u():r=i+1}return a&&L$("Access path missing closing bracket: "+t),s&&L$("Access path missing closing quote: "+t),i>r&&(i++,u()),e}function R$(t,e,n){const r=B$(t);return t=1===r.length?r[0]:t,O$((n&&n.get||N$)(r),[t],e||t)}const P$=R$("id"),z$=O$((t=>t),[],"identity"),j$=O$((()=>0),[],"zero"),U$=O$((()=>1),[],"one"),V$=O$((()=>!0),[],"true"),q$=O$((()=>!1),[],"false");function W$(t,e,n){const r=[e].concat([].slice.call(n));console[t].apply(console,r)}const H$=0,G$=1,Y$=2,X$=3,J$=4;function K$(t,e){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:W$,r=t||H$;return{level(t){return arguments.length?(r=+t,this):r},error(){return r>=G$&&n(e||"error","ERROR",arguments),this},warn(){return r>=Y$&&n(e||"warn","WARN",arguments),this},info(){return r>=X$&&n(e||"log","INFO",arguments),this},debug(){return r>=J$&&n(e||"log","DEBUG",arguments),this}}}var Q$=Array.isArray;function Z$(t){return t===Object(t)}const tF=t=>"__proto__"!==t;function eF(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce(((t,e)=>{for(const n in e)if("signals"===n)t.signals=rF(t.signals,e.signals);else{const r="legend"===n?{layout:1}:"style"===n||null;nF(t,n,e[n],r)}return t}),{})}function nF(t,e,n,r){if(!tF(e))return;let i,o;if(Z$(n)&&!Q$(n))for(i in o=Z$(t[e])?t[e]:t[e]={},n)r&&(!0===r||r[i])?nF(o,i,n[i]):tF(i)&&(o[i]=n[i]);else t[e]=n}function rF(t,e){if(null==t)return e;const n={},r=[];function i(t){n[t.name]||(n[t.name]=1,r.push(t))}return e.forEach(i),t.forEach(i),r}function iF(t){return t[t.length-1]}function oF(t){return null==t||""===t?null:+t}const sF=t=>e=>t*Math.exp(e),aF=t=>e=>Math.log(t*e),lF=t=>e=>Math.sign(e)*Math.log1p(Math.abs(e/t)),uF=t=>e=>Math.sign(e)*Math.expm1(Math.abs(e))*t,cF=t=>e=>e<0?-Math.pow(-e,t):Math.pow(e,t);function hF(t,e,n,r){const i=n(t[0]),o=n(iF(t)),s=(o-i)*e;return[r(i-s),r(o-s)]}function fF(t,e){return hF(t,e,oF,z$)}function dF(t,e){var n=Math.sign(t[0]);return hF(t,e,aF(n),sF(n))}function pF(t,e,n){return hF(t,e,cF(n),cF(1/n))}function mF(t,e,n){return hF(t,e,lF(n),uF(n))}function gF(t,e,n,r,i){const o=r(t[0]),s=r(iF(t)),a=null!=e?r(e):(o+s)/2;return[i(a+(o-a)*n),i(a+(s-a)*n)]}function yF(t,e,n){return gF(t,e,n,oF,z$)}function bF(t,e,n){const r=Math.sign(t[0]);return gF(t,e,n,aF(r),sF(r))}function vF(t,e,n,r){return gF(t,e,n,cF(r),cF(1/r))}function wF(t,e,n,r){return gF(t,e,n,lF(r),uF(r))}function xF(t){return 1+~~(new Date(t).getMonth()/3)}function _F(t){return 1+~~(new Date(t).getUTCMonth()/3)}function kF(t){return null!=t?Q$(t)?t:[t]:[]}function SF(t,e,n){let r,i=t[0],o=t[1];return o<i&&(r=o,o=i,i=r),r=o-i,r>=n-e?[e,n]:[i=Math.min(Math.max(i,e),n-r),i+r]}function EF(t){return"function"==typeof t}const AF="descending";function CF(t,e,n){n=n||{},e=kF(e)||[];const r=[],i=[],o={},s=n.comparator||MF;return kF(t).forEach(((t,s)=>{null!=t&&(r.push(e[s]===AF?-1:1),i.push(t=EF(t)?t:R$(t,null,n)),(I$(t)||[]).forEach((t=>o[t]=1)))})),0===i.length?null:O$(s(i,r),Object.keys(o))}const DF=(t,e)=>(t<e||null==t)&&null!=e?-1:(t>e||null==e)&&null!=t?1:(e=e instanceof Date?+e:e,(t=t instanceof Date?+t:t)!==t&&e==e?-1:e!=e&&t==t?1:0),MF=(t,e)=>1===t.length?OF(t[0],e[0]):TF(t,e,t.length),OF=(t,e)=>function(n,r){return DF(t(n),t(r))*e},TF=(t,e,n)=>(e.push(0),function(r,i){let o,s=0,a=-1;for(;0===s&&++a<n;)o=t[a],s=DF(o(r),o(i));return s*e[a]});function IF(t){return EF(t)?t:()=>t}function NF(t,e){let n;return r=>{n&&clearTimeout(n),n=setTimeout((()=>(e(r),n=null)),t)}}function $F(t){for(let e,n,r=1,i=arguments.length;r<i;++r)for(n in e=arguments[r],e)t[n]=e[n];return t}function FF(t,e){let n,r,i,o,s=0;if(t&&(n=t.length))if(null==e){for(r=t[s];s<n&&(null==r||r!=r);r=t[++s]);for(i=o=r;s<n;++s)r=t[s],null!=r&&(r<i&&(i=r),r>o&&(o=r))}else{for(r=e(t[s]);s<n&&(null==r||r!=r);r=e(t[++s]));for(i=o=r;s<n;++s)r=e(t[s]),null!=r&&(r<i&&(i=r),r>o&&(o=r))}return[i,o]}function LF(t,e){const n=t.length;let r,i,o,s,a,l=-1;if(null==e){for(;++l<n;)if(i=t[l],null!=i&&i>=i){r=o=i;break}if(l===n)return[-1,-1];for(s=a=l;++l<n;)i=t[l],null!=i&&(r>i&&(r=i,s=l),o<i&&(o=i,a=l))}else{for(;++l<n;)if(i=e(t[l],l,t),null!=i&&i>=i){r=o=i;break}if(l===n)return[-1,-1];for(s=a=l;++l<n;)i=e(t[l],l,t),null!=i&&(r>i&&(r=i,s=l),o<i&&(o=i,a=l))}return[s,a]}const BF=Object.prototype.hasOwnProperty;function RF(t,e){return BF.call(t,e)}const PF={};function zF(t){let e,n={};function r(t){return RF(n,t)&&n[t]!==PF}const i={size:0,empty:0,object:n,has:r,get:t=>r(t)?n[t]:void 0,set(t,e){return r(t)||(++i.size,n[t]===PF&&--i.empty),n[t]=e,this},delete(t){return r(t)&&(--i.size,++i.empty,n[t]=PF),this},clear(){i.size=i.empty=0,i.object=n={}},test(t){return arguments.length?(e=t,i):e},clean(){const t={};let r=0;for(const i in n){const o=n[i];o===PF||e&&e(o)||(t[i]=o,++r)}i.size=r,i.empty=0,i.object=n=t}};return t&&Object.keys(t).forEach((e=>{i.set(e,t[e])})),i}function jF(t,e,n,r,i,o){if(!n&&0!==n)return o;const s=+n;let a,l=t[0],u=iF(t);u<l&&(a=l,l=u,u=a),a=Math.abs(e-l);const c=Math.abs(u-e);return a<c&&a<=s?r:c<=s?i:o}function UF(t,e,n){const r=t.prototype=Object.create(e.prototype);return Object.defineProperty(r,"constructor",{value:t,writable:!0,enumerable:!0,configurable:!0}),$F(r,n)}function VF(t,e,n,r){let i,o=e[0],s=e[e.length-1];return o>s&&(i=o,o=s,s=i),r=void 0===r||r,((n=void 0===n||n)?o<=t:o<t)&&(r?t<=s:t<s)}function qF(t){return"boolean"==typeof t}function WF(t){return"[object Date]"===Object.prototype.toString.call(t)}function HF(t){return t&&EF(t[Symbol.iterator])}function GF(t){return"number"==typeof t}function YF(t){return"[object RegExp]"===Object.prototype.toString.call(t)}function XF(t){return"string"==typeof t}function JF(t,e,n){t&&(t=e?kF(t).map((t=>t.replace(/\\(.)/g,"$1"))):kF(t));const r=t&&t.length,i=n&&n.get||N$,o=t=>i(e?[t]:B$(t));let s;if(r)if(1===r){const e=o(t[0]);s=function(t){return""+e(t)}}else{const e=t.map(o);s=function(t){let n=""+e[0](t),i=0;for(;++i<r;)n+="|"+e[i](t);return n}}else s=function(){return""};return O$(s,t,"key")}function KF(t,e){const n=t[0],r=iF(t),i=+e;return i?1===i?r:n+i*(r-n):n}const QF=1e4;function ZF(t){let e,n,r;t=+t||QF;const i=()=>{e={},n={},r=0},o=(i,o)=>(++r>t&&(n=e,e={},r=1),e[i]=o);return i(),{clear:i,has:t=>RF(e,t)||RF(n,t),get:t=>RF(e,t)?e[t]:RF(n,t)?o(t,n[t]):void 0,set:(t,n)=>RF(e,t)?e[t]=n:o(t,n)}}function tL(t,e,n,r){const i=e.length,o=n.length;if(!o)return e;if(!i)return n;const s=r||new e.constructor(i+o);let a=0,l=0,u=0;for(;a<i&&l<o;++u)s[u]=t(e[a],n[l])>0?n[l++]:e[a++];for(;a<i;++a,++u)s[u]=e[a];for(;l<o;++l,++u)s[u]=n[l];return s}function eL(t,e){let n="";for(;--e>=0;)n+=t;return n}function nL(t,e,n,r){const i=n||" ",o=t+"",s=e-o.length;return s<=0?o:"left"===r?eL(i,s)+o:"center"===r?eL(i,~~(s/2))+o+eL(i,Math.ceil(s/2)):o+eL(i,s)}function rL(t){return t&&iF(t)-t[0]||0}function iL(t){return Q$(t)?"["+t.map(iL)+"]":Z$(t)||XF(t)?JSON.stringify(t).replace("\u2028","\\u2028").replace("\u2029","\\u2029"):t}function oL(t){return null==t||""===t?null:!(!t||"false"===t||"0"===t||!t)}const sL=t=>GF(t)||WF(t)?t:Date.parse(t);function aL(t,e){return e=e||sL,null==t||""===t?null:e(t)}function lL(t){return null==t||""===t?null:t+""}function uL(t){const e={},n=t.length;for(let r=0;r<n;++r)e[t[r]]=!0;return e}function cL(t,e,n,r){const i=null!=r?r:"â€¦",o=t+"",s=o.length,a=Math.max(0,e-i.length);return s<=e?o:"left"===n?i+o.slice(s-a):"center"===n?o.slice(0,Math.ceil(a/2))+i+o.slice(s-~~(a/2)):o.slice(0,a)+i}function hL(t,e,n){if(t)if(e){const r=t.length;for(let i=0;i<r;++i){const r=e(t[i]);r&&n(r,i,t)}}else t.forEach(n)}var fL={},dL={},pL=34,mL=10,gL=13;function yL(t){return new Function("d","return {"+t.map((function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'})).join(",")+"}")}function bL(t){var e=Object.create(null),n=[];return t.forEach((function(t){for(var r in t)r in e||n.push(e[r]=r)})),n}function vL(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function wL(t){var e=new RegExp('["'+t+"\n\r]"),n=t.charCodeAt(0);function r(t,e){var r,i=[],o=t.length,s=0,a=0,l=o<=0,u=!1;function c(){if(l)return dL;if(u)return u=!1,fL;var e,r,i=s;if(t.charCodeAt(i)===pL){for(;s++<o&&t.charCodeAt(s)!==pL||t.charCodeAt(++s)===pL;);return(e=s)>=o?l=!0:(r=t.charCodeAt(s++))===mL?u=!0:r===gL&&(u=!0,t.charCodeAt(s)===mL&&++s),t.slice(i+1,e-1).replace(/""/g,'"')}for(;s<o;){if((r=t.charCodeAt(e=s++))===mL)u=!0;else if(r===gL)u=!0,t.charCodeAt(s)===mL&&++s;else if(r!==n)continue;return t.slice(i,e)}return l=!0,t.slice(i,o)}for(t.charCodeAt(o-1)===mL&&--o,t.charCodeAt(o-1)===gL&&--o;(r=c())!==dL;){for(var h=[];r!==fL&&r!==dL;)h.push(r),r=c();e&&null==(h=e(h,a++))||i.push(h)}return i}function i(e,n){return e.map((function(e){return n.map((function(t){return s(e[t])})).join(t)}))}function o(e){return e.map(s).join(t)}function s(t){return null==t?"":t instanceof Date?function(t){var e,n=t.getUTCHours(),r=t.getUTCMinutes(),i=t.getUTCSeconds(),o=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+vL(-e,6):e>9999?"+"+vL(e,6):vL(e,4))+"-"+vL(t.getUTCMonth()+1,2)+"-"+vL(t.getUTCDate(),2)+(o?"T"+vL(n,2)+":"+vL(r,2)+":"+vL(i,2)+"."+vL(o,3)+"Z":i?"T"+vL(n,2)+":"+vL(r,2)+":"+vL(i,2)+"Z":r||n?"T"+vL(n,2)+":"+vL(r,2)+"Z":"")}(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,e){var n,i,o=r(t,(function(t,r){if(n)return n(t,r-1);i=t,n=e?function(t,e){var n=yL(t);return function(r,i){return e(n(r),i,t)}}(t,e):yL(t)}));return o.columns=i||[],o},parseRows:r,format:function(e,n){return null==n&&(n=bL(e)),[n.map(s).join(t)].concat(i(e,n)).join("\n")},formatBody:function(t,e){return null==e&&(e=bL(t)),i(t,e).join("\n")},formatRows:function(t){return t.map(o).join("\n")},formatRow:o,formatValue:s}}function xL(t){return t}function _L(t,e){return"string"==typeof e&&(e=t.objects[e]),"GeometryCollection"===e.type?{type:"FeatureCollection",features:e.geometries.map((function(e){return kL(t,e)}))}:kL(t,e)}function kL(t,e){var n=e.id,r=e.bbox,i=null==e.properties?{}:e.properties,o=SL(t,e);return null==n&&null==r?{type:"Feature",properties:i,geometry:o}:null==r?{type:"Feature",id:n,properties:i,geometry:o}:{type:"Feature",id:n,bbox:r,properties:i,geometry:o}}function SL(t,e){var n=function(t){if(null==t)return xL;var e,n,r=t.scale[0],i=t.scale[1],o=t.translate[0],s=t.translate[1];return function(t,a){a||(e=n=0);var l=2,u=t.length,c=new Array(u);for(c[0]=(e+=t[0])*r+o,c[1]=(n+=t[1])*i+s;l<u;)c[l]=t[l],++l;return c}}(t.transform),r=t.arcs;function i(t,e){e.length&&e.pop();for(var i=r[t<0?~t:t],o=0,s=i.length;o<s;++o)e.push(n(i[o],o));t<0&&function(t,e){for(var n,r=t.length,i=r-e;i<--r;)n=t[i],t[i++]=t[r],t[r]=n}(e,s)}function o(t){return n(t)}function s(t){for(var e=[],n=0,r=t.length;n<r;++n)i(t[n],e);return e.length<2&&e.push(e[0]),e}function a(t){for(var e=s(t);e.length<4;)e.push(e[0]);return e}function l(t){return t.map(a)}return function t(e){var n,r=e.type;switch(r){case"GeometryCollection":return{type:r,geometries:e.geometries.map(t)};case"Point":n=o(e.coordinates);break;case"MultiPoint":n=e.coordinates.map(o);break;case"LineString":n=s(e.arcs);break;case"MultiLineString":n=e.arcs.map(s);break;case"Polygon":n=l(e.arcs);break;case"MultiPolygon":n=e.arcs.map(l);break;default:return null}return{type:r,coordinates:n}}(e)}function EL(t,e){var n={},r={},i={},o=[],s=-1;function a(t,e){for(var r in t){var i=t[r];delete e[i.start],delete i.start,delete i.end,i.forEach((function(t){n[t<0?~t:t]=1})),o.push(i)}}return e.forEach((function(n,r){var i,o=t.arcs[n<0?~n:n];o.length<3&&!o[1][0]&&!o[1][1]&&(i=e[++s],e[s]=n,e[r]=i)})),e.forEach((function(e){var n,o,s=function(e){var n,r=t.arcs[e<0?~e:e],i=r[0];return t.transform?(n=[0,0],r.forEach((function(t){n[0]+=t[0],n[1]+=t[1]}))):n=r[r.length-1],e<0?[n,i]:[i,n]}(e),a=s[0],l=s[1];if(n=i[a])if(delete i[n.end],n.push(e),n.end=l,o=r[l]){delete r[o.start];var u=o===n?n:n.concat(o);r[u.start=n.start]=i[u.end=o.end]=u}else r[n.start]=i[n.end]=n;else if(n=r[l])if(delete r[n.start],n.unshift(e),n.start=a,o=i[a]){delete i[o.end];var c=o===n?n:o.concat(n);r[c.start=o.start]=i[c.end=n.end]=c}else r[n.start]=i[n.end]=n;else r[(n=[e]).start=a]=i[n.end=l]=n})),a(i,r),a(r,i),e.forEach((function(t){n[t<0?~t:t]||o.push([t])})),o}function AL(t){return SL(t,CL.apply(this,arguments))}function CL(t,e,n){var r,i,o;if(arguments.length>1)r=function(t,e,n){var r,i=[],o=[];function s(t){var e=t<0?~t:t;(o[e]||(o[e]=[])).push({i:t,g:r})}function a(t){t.forEach(s)}function l(t){t.forEach(a)}return function t(e){switch(r=e,e.type){case"GeometryCollection":e.geometries.forEach(t);break;case"LineString":a(e.arcs);break;case"MultiLineString":case"Polygon":l(e.arcs);break;case"MultiPolygon":!function(t){t.forEach(l)}(e.arcs)}}(e),o.forEach(null==n?function(t){i.push(t[0].i)}:function(t){n(t[0].g,t[t.length-1].g)&&i.push(t[0].i)}),i}(0,e,n);else for(i=0,r=new Array(o=t.arcs.length);i<o;++i)r[i]=i;return{type:"MultiLineString",arcs:EL(t,r)}}const DL=yO((t=>{t.setDate(1),t.setHours(0,0,0,0)}),((t,e)=>{t.setMonth(t.getMonth()+e)}),((t,e)=>e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear())),(t=>t.getMonth())),ML=(DL.range,yO((t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)}),((t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)}),((t,e)=>e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear())),(t=>t.getUTCMonth()))),OL=(ML.range,yO((t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*bO-t.getMinutes()*vO)}),((t,e)=>{t.setTime(+t+e*wO)}),((t,e)=>(e-t)/wO),(t=>t.getHours()))),TL=(OL.range,yO((t=>{t.setUTCMinutes(0,0,0)}),((t,e)=>{t.setTime(+t+e*wO)}),((t,e)=>(e-t)/wO),(t=>t.getUTCHours()))),IL=(TL.range,yO((t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*bO)}),((t,e)=>{t.setTime(+t+e*vO)}),((t,e)=>(e-t)/vO),(t=>t.getMinutes()))),NL=(IL.range,yO((t=>{t.setUTCSeconds(0,0)}),((t,e)=>{t.setTime(+t+e*vO)}),((t,e)=>(e-t)/vO),(t=>t.getUTCMinutes()))),$L=(NL.range,yO((t=>{t.setTime(t-t.getMilliseconds())}),((t,e)=>{t.setTime(+t+e*bO)}),((t,e)=>(e-t)/bO),(t=>t.getUTCSeconds()))),FL=($L.range,yO((()=>{}),((t,e)=>{t.setTime(+t+e)}),((t,e)=>e-t)));FL.every=t=>(t=Math.floor(t),isFinite(t)&&t>0?t>1?yO((e=>{e.setTime(Math.floor(e/t)*t)}),((e,n)=>{e.setTime(+e+n*t)}),((e,n)=>(n-e)/t)):FL:null),FL.range;const LL="year",BL="quarter",RL="month",PL="week",zL="date",jL="day",UL="dayofyear",VL="hours",qL="minutes",WL="seconds",HL="milliseconds",GL=[LL,BL,RL,PL,zL,jL,UL,VL,qL,WL,HL],YL=GL.reduce(((t,e,n)=>(t[e]=1+n,t)),{});function XL(t){const e=kF(t).slice(),n={};return e.length||L$("Missing time unit."),e.forEach((t=>{RF(YL,t)?n[t]=1:L$(`Invalid time unit: ${t}.`)})),(n[PL]||n[jL]?1:0)+(n[BL]||n[RL]||n[zL]?1:0)+(n[UL]?1:0)>1&&L$(`Incompatible time units: ${t}`),e.sort(((t,e)=>YL[t]-YL[e])),e}const JL={[LL]:"%Y ",[BL]:"Q%q ",[RL]:"%b ",[zL]:"%d ",[PL]:"W%U ",[jL]:"%a ",[UL]:"%j ",[VL]:"%H:00",[qL]:"00:%M",[WL]:":%S",[HL]:".%L",[`${LL}-${RL}`]:"%Y-%m ",[`${LL}-${RL}-${zL}`]:"%Y-%m-%d ",[`${VL}-${qL}`]:"%H:%M"};function KL(t,e){const n=$F({},JL,e),r=XL(t),i=r.length;let o,s,a="",l=0;for(l=0;l<i;)for(o=r.length;o>l;--o)if(s=r.slice(l,o).join("-"),null!=n[s]){a+=n[s],l=o;break}return a.trim()}const QL=new Date;function ZL(t){return QL.setFullYear(t),QL.setMonth(0),QL.setDate(1),QL.setHours(0,0,0,0),QL}function tB(t){return nB(new Date(t))}function eB(t){return rB(new Date(t))}function nB(t){return zO.count(ZL(t.getFullYear())-1,t)}function rB(t){return EO.count(ZL(t.getFullYear())-1,t)}function iB(t){return ZL(t).getDay()}function oB(t,e,n,r,i,o,s){if(0<=t&&t<100){const a=new Date(-1,e,n,r,i,o,s);return a.setFullYear(t),a}return new Date(t,e,n,r,i,o,s)}function sB(t){return lB(new Date(t))}function aB(t){return uB(new Date(t))}function lB(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return jO.count(e-1,t)}function uB(t){const e=Date.UTC(t.getUTCFullYear(),0,1);return NO.count(e-1,t)}function cB(t){return QL.setTime(Date.UTC(t,0,1)),QL.getUTCDay()}function hB(t,e,n,r,i,o,s){if(0<=t&&t<100){const t=new Date(Date.UTC(-1,e,n,r,i,o,s));return t.setUTCFullYear(n.y),t}return new Date(Date.UTC(t,e,n,r,i,o,s))}function fB(t,e,n,r,i){const o=e||1,s=iF(t),a=(t,e,i)=>function(t,e,n,r){const i=n<=1?t:r?(e,i)=>r+n*Math.floor((t(e,i)-r)/n):(e,r)=>n*Math.floor(t(e,r)/n);return e?(t,n)=>e(i(t,n),n):i}(n[i=i||t],r[i],t===s&&o,e),l=new Date,u=uL(t),c=u[LL]?a(LL):IF(2012),h=u[RL]?a(RL):u[BL]?a(BL):j$,f=u[PL]&&u[jL]?a(jL,1,PL+jL):u[PL]?a(PL,1):u[jL]?a(jL,1):u[zL]?a(zL,1):u[UL]?a(UL,1):U$,d=u[VL]?a(VL):j$,p=u[qL]?a(qL):j$,m=u[WL]?a(WL):j$,g=u[HL]?a(HL):j$;return function(t){l.setTime(+t);const e=c(l);return i(e,h(l),f(l,e),d(l),p(l),m(l),g(l))}}function dB(t,e,n){return e+7*t-(n+6)%7}const pB={[LL]:t=>t.getFullYear(),[BL]:t=>Math.floor(t.getMonth()/3),[RL]:t=>t.getMonth(),[zL]:t=>t.getDate(),[VL]:t=>t.getHours(),[qL]:t=>t.getMinutes(),[WL]:t=>t.getSeconds(),[HL]:t=>t.getMilliseconds(),[UL]:t=>nB(t),[PL]:t=>rB(t),[PL+jL]:(t,e)=>dB(rB(t),t.getDay(),iB(e)),[jL]:(t,e)=>dB(1,t.getDay(),iB(e))},mB={[BL]:t=>3*t,[PL]:(t,e)=>dB(t,0,iB(e))};function gB(t,e){return fB(t,e||1,pB,mB,oB)}const yB={[LL]:t=>t.getUTCFullYear(),[BL]:t=>Math.floor(t.getUTCMonth()/3),[RL]:t=>t.getUTCMonth(),[zL]:t=>t.getUTCDate(),[VL]:t=>t.getUTCHours(),[qL]:t=>t.getUTCMinutes(),[WL]:t=>t.getUTCSeconds(),[HL]:t=>t.getUTCMilliseconds(),[UL]:t=>lB(t),[PL]:t=>uB(t),[jL]:(t,e)=>dB(1,t.getUTCDay(),cB(e)),[PL+jL]:(t,e)=>dB(uB(t),t.getUTCDay(),cB(e))},bB={[BL]:t=>3*t,[PL]:(t,e)=>dB(t,0,cB(e))};function vB(t,e){return fB(t,e||1,yB,bB,hB)}const wB={[LL]:VO,[BL]:DL.every(3),[RL]:DL,[PL]:EO,[zL]:zO,[jL]:zO,[UL]:zO,[VL]:OL,[qL]:IL,[WL]:$L,[HL]:FL},xB={[LL]:qO,[BL]:ML.every(3),[RL]:ML,[PL]:NO,[zL]:jO,[jL]:jO,[UL]:jO,[VL]:TL,[qL]:NL,[WL]:$L,[HL]:FL};function _B(t){return wB[t]}function kB(t){return xB[t]}function SB(t,e,n){return t?t.offset(e,n):void 0}function EB(t,e,n){return SB(_B(t),e,n)}function AB(t,e,n){return SB(kB(t),e,n)}function CB(t,e,n,r){return t?t.range(e,n,r):void 0}function DB(t,e,n,r){return CB(_B(t),e,n,r)}function MB(t,e,n,r){return CB(kB(t),e,n,r)}const OB=31536e6,TB=[LL,RL,zL,VL,qL,WL,HL],IB=TB.slice(0,-1),NB=IB.slice(0,-1),$B=NB.slice(0,-1),FB=$B.slice(0,-1),LB=[LL,RL],BB=[LL],RB=[[IB,1,1e3],[IB,5,5e3],[IB,15,15e3],[IB,30,3e4],[NB,1,6e4],[NB,5,3e5],[NB,15,9e5],[NB,30,18e5],[$B,1,36e5],[$B,3,108e5],[$B,6,216e5],[$B,12,432e5],[FB,1,864e5],[[LL,PL],1,6048e5],[LB,1,2592e6],[LB,3,7776e6],[BB,1,OB]];function PB(t){const e=t.extent,n=t.maxbins||40,r=Math.abs(rL(e))/n;let i,o,s=BM((t=>t[2])).right(RB,r);return s===RB.length?(i=BB,o=$M(e[0]/OB,e[1]/OB,n)):s?(s=RB[r/RB[s-1][2]<RB[s][2]/r?s-1:s],i=s[0],o=s[1]):(i=TB,o=Math.max($M(e[0],e[1],n),1)),{units:i,step:o}}function zB(t){const e={};return n=>e[n]||(e[n]=t(n))}function jB(t){const e=zB(t.format),n=t.formatPrefix;return{format:e,formatPrefix:n,formatFloat(t){const n=yM(t||",");if(null==n.precision){switch(n.precision=12,n.type){case"%":n.precision-=2;break;case"e":n.precision-=1}return function(t,e){return n=>{const r=t(n),i=r.indexOf(e);if(i<0)return r;let o=function(t,e){let n,r=t.lastIndexOf("e");if(r>0)return r;for(r=t.length;--r>e;)if(n=t.charCodeAt(r),n>=48&&n<=57)return r+1}(r,i);const s=o<r.length?r.slice(o):"";for(;--o>i;)if("0"!==r[o]){++o;break}return r.slice(0,o)+s}}(e(n),e(".1f")(1)[1])}return e(n)},formatSpan(t,r,i,o){o=yM(null==o?",f":o);const s=$M(t,r,i),a=Math.max(Math.abs(t),Math.abs(r));let l;if(null==o.precision)switch(o.type){case"s":return isNaN(l=uO(s,a))||(o.precision=l),n(o,a);case"":case"e":case"g":case"p":case"r":isNaN(l=cO(s,a))||(o.precision=l-("e"===o.type));break;case"f":case"%":isNaN(l=hO(s))||(o.precision=l-2*("%"===o.type))}return e(o)}}}let UB,VB;function qB(){return UB=jB({format:kM,formatPrefix:SM})}function WB(t){return jB(CM(t))}function HB(t){return arguments.length?UB=WB(t):UB}function GB(t,e,n){Z$(n=n||{})||L$(`Invalid time multi-format specifier: ${n}`);const r=e(WL),i=e(qL),o=e(VL),s=e(zL),a=e(PL),l=e(RL),u=e(BL),c=e(LL),h=t(n[HL]||".%L"),f=t(n[WL]||":%S"),d=t(n[qL]||"%I:%M"),p=t(n[VL]||"%I %p"),m=t(n[zL]||n[jL]||"%a %d"),g=t(n[PL]||"%b %d"),y=t(n[RL]||"%B"),b=t(n[BL]||"%B"),v=t(n[LL]||"%Y");return t=>(r(t)<t?h:i(t)<t?f:o(t)<t?d:s(t)<t?p:l(t)<t?a(t)<t?m:g:c(t)<t?u(t)<t?y:b:v)(t)}function YB(t){const e=zB(t.format),n=zB(t.utcFormat);return{timeFormat:t=>XF(t)?e(t):GB(e,_B,t),utcFormat:t=>XF(t)?n(t):GB(n,kB,t),timeParse:zB(t.parse),utcParse:zB(t.utcParse)}}function XB(){return VB=YB({format:JO,parse:KO,utcFormat:QO,utcParse:ZO})}function JB(t){return YB(YO(t))}function KB(t){return arguments.length?VB=JB(t):VB}qB(),XB();const QB=(t,e)=>$F({},t,e);function ZB(t,e){const n=t?WB(t):HB(),r=e?JB(e):KB();return QB(n,r)}function tR(t,e){const n=arguments.length;return n&&2!==n&&L$("defaultLocale expects either zero or two arguments."),n?QB(HB(t),KB(e)):QB(HB(),KB())}function eR(){return qB(),XB(),tR()}var nR=n(600).hp;const rR=/^(data:|([A-Za-z]+:)?\/\/)/,iR=/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp|file|data):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i,oR=/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205f\u3000]/g,sR="file://";async function aR(t,e){const n=await this.sanitize(t,e),r=n.href;return n.localFile?this.file(r):this.http(r,e)}async function lR(t,e){e=$F({},this.options,e);const n=this.fileAccess,r={href:null};let i,o,s;const a=iR.test(t.replace(oR,""));null!=t&&"string"==typeof t&&a||L$("Sanitize failure, invalid URI: "+iL(t));const l=rR.test(t);return(s=e.baseURL)&&!l&&(t.startsWith("/")||s.endsWith("/")||(t="/"+t),t=s+t),o=(i=t.startsWith(sR))||"file"===e.mode||"http"!==e.mode&&!l&&n,i?t=t.slice(7):t.startsWith("//")&&("file"===e.defaultProtocol?(t=t.slice(2),o=!0):t=(e.defaultProtocol||"http")+":"+t),Object.defineProperty(r,"localFile",{value:!!o}),r.href=t,e.target&&(r.target=e.target+""),e.rel&&(r.rel=e.rel+""),"image"===e.context&&e.crossOrigin&&(r.crossOrigin=e.crossOrigin+""),r}function uR(t){return t?e=>new Promise(((n,r)=>{t.readFile(e,((t,e)=>{t?r(t):n(e)}))})):cR}async function cR(){L$("No file system access.")}function hR(t){return t?async function(e,n){const r=$F({},this.options.http,n),i=n&&n.response,o=await t(e,r);return o.ok?EF(o[i])?o[i]():o.text():L$(o.status+""+o.statusText)}:fR}async function fR(){L$("No HTTP fetch method available.")}const dR=t=>null!=t&&t==t,pR=t=>!(Number.isNaN(+t)||t instanceof Date),mR={boolean:oL,integer:oF,number:oF,date:aL,string:lL,unknown:z$},gR=[t=>"true"===t||"false"===t||!0===t||!1===t,t=>pR(t)&&Number.isInteger(+t),pR,t=>!Number.isNaN(Date.parse(t))],yR=["boolean","integer","number","date"];function bR(t,e){if(!t||!t.length)return"unknown";const n=t.length,r=gR.length,i=gR.map(((t,e)=>e+1));for(let o,s,a=0,l=0;a<n;++a)for(s=e?t[a][e]:t[a],o=0;o<r;++o)if(i[o]&&dR(s)&&!gR[o](s)&&(i[o]=0,++l,l===gR.length))return"string";return yR[i.reduce(((t,e)=>0===t?e:t),0)-1]}function vR(t,e){return e.reduce(((e,n)=>(e[n]=bR(t,n),e)),{})}function wR(t){const e=function(e,n){const r={delimiter:t};return xR(e,n?$F(n,r):r)};return e.responseType="text",e}function xR(t,e){return e.header&&(t=e.header.map(iL).join(e.delimiter)+"\n"+t),wL(e.delimiter).parse(t+"")}function _R(t,e){const n=e&&e.property?R$(e.property):z$;return!Z$(t)||(r=t,"function"==typeof nR&&EF(nR.isBuffer)&&nR.isBuffer(r))?n(JSON.parse(t)):function(t,e){return!Q$(t)&&HF(t)&&(t=[...t]),e&&e.copy?JSON.parse(JSON.stringify(t)):t}(n(t),e);var r}xR.responseType="text",_R.responseType="json";const kR={interior:(t,e)=>t!==e,exterior:(t,e)=>t===e};function SR(t,e){let n,r,i,o;return t=_R(t,e),e&&e.feature?(n=_L,i=e.feature):e&&e.mesh?(n=AL,i=e.mesh,o=kR[e.filter]):L$("Missing TopoJSON feature or mesh parameter."),r=(r=t.objects[i])?n(t,r,o):L$("Invalid TopoJSON object: "+i),r&&r.features||[r]}SR.responseType="json";const ER={dsv:xR,csv:wR(","),tsv:wR("\t"),json:_R,topojson:SR};function AR(t,e){return arguments.length>1?(ER[t]=e,this):RF(ER,t)?ER[t]:null}function CR(t){const e=AR(t);return e&&e.responseType||"text"}function DR(t,e,n,r){const i=AR((e=e||{}).type||"json");return i||L$("Unknown data format type: "+e.type),t=i(t,e),e.parse&&function(t,e,n,r){if(!t.length)return;const i=KB();n=n||i.timeParse,r=r||i.utcParse;let o,s,a,l,u,c,h=t.columns||Object.keys(t[0]);"auto"===e&&(e=vR(t,h)),h=Object.keys(e);const f=h.map((t=>{const i=e[t];let o,s;if(i&&(i.startsWith("date:")||i.startsWith("utc:")))return o=i.split(/:(.+)?/,2),s=o[1],("'"===s[0]&&"'"===s[s.length-1]||'"'===s[0]&&'"'===s[s.length-1])&&(s=s.slice(1,-1)),("utc"===o[0]?r:n)(s);if(!mR[i])throw Error("Illegal format pattern: "+t+":"+i);return mR[i]}));for(a=0,u=t.length,c=h.length;a<u;++a)for(o=t[a],l=0;l<c;++l)s=h[l],o[s]=f[l](o[s])}(t,e.parse,n,r),RF(t,"columns")&&delete t.columns,t}const MR=function(t,e){return e=>({options:e||{},sanitize:lR,load:aR,fileAccess:!1,file:uR(null),http:hR(t)})}("undefined"!=typeof fetch&&fetch);function OR(t){const e=t||z$,n=[],r={};return n.add=t=>{const i=e(t);return r[i]||(r[i]=1,n.push(t)),n},n.remove=t=>{const i=e(t);if(r[i]){r[i]=0;const e=n.indexOf(t);e>=0&&n.splice(e,1)}return n},n}async function TR(t,e){try{await e(t)}catch(e){t.error(e)}}const IR=Symbol("vega_id");let NR=1;function $R(t){return!(!t||!FR(t))}function FR(t){return t[IR]}function LR(t,e){return t[IR]=e,t}function BR(t){const e=t===Object(t)?t:{data:t};return FR(e)?e:LR(e,NR++)}function RR(t){return PR(t,BR({}))}function PR(t,e){for(const n in t)e[n]=t[n];return e}function zR(t,e){return LR(e,FR(t))}function jR(t,e){return t?e?(n,r)=>t(n,r)||FR(e(n))-FR(e(r)):(e,n)=>t(e,n)||FR(e)-FR(n):null}function UR(t){return t&&t.constructor===VR}function VR(){const t=[],e=[],n=[],r=[],i=[];let o=null,s=!1;return{constructor:VR,insert(e){const n=kF(e),r=n.length;for(let e=0;e<r;++e)t.push(n[e]);return this},remove(t){const n=EF(t)?r:e,i=kF(t),o=i.length;for(let t=0;t<o;++t)n.push(i[t]);return this},modify(t,e,r){const o={field:e,value:IF(r)};return EF(t)?(o.filter=t,i.push(o)):(o.tuple=t,n.push(o)),this},encode(t,e){return EF(t)?i.push({filter:t,field:e}):n.push({tuple:t,field:e}),this},clean(t){return o=t,this},reflow(){return s=!0,this},pulse(a,l){const u={},c={};let h,f,d,p,m,g;for(h=0,f=l.length;h<f;++h)u[FR(l[h])]=1;for(h=0,f=e.length;h<f;++h)m=e[h],u[FR(m)]=-1;for(h=0,f=r.length;h<f;++h)p=r[h],l.forEach((t=>{p(t)&&(u[FR(t)]=-1)}));for(h=0,f=t.length;h<f;++h)m=t[h],g=FR(m),u[g]?u[g]=1:a.add.push(BR(t[h]));for(h=0,f=l.length;h<f;++h)m=l[h],u[FR(m)]<0&&a.rem.push(m);function y(t,e,n){n?t[e]=n(t):a.encode=e,s||(c[FR(t)]=t)}for(h=0,f=n.length;h<f;++h)d=n[h],m=d.tuple,p=d.field,g=u[FR(m)],g>0&&(y(m,p,d.value),a.modifies(p));for(h=0,f=i.length;h<f;++h)d=i[h],p=d.filter,l.forEach((t=>{p(t)&&u[FR(t)]>0&&y(t,d.field,d.value)})),a.modifies(d.field);if(s)a.mod=e.length||r.length?l.filter((t=>u[FR(t)]>0)):l.slice();else for(g in c)a.mod.push(c[g]);return(o||null==o&&(e.length||r.length))&&a.clean(!0),a}}}const qR="_:mod:_";function WR(){Object.defineProperty(this,qR,{writable:!0,value:{}})}WR.prototype={set(t,e,n,r){const i=this,o=i[t],s=i[qR];return null!=e&&e>=0?(o[e]!==n||r)&&(o[e]=n,s[e+":"+t]=-1,s[t]=-1):(o!==n||r)&&(i[t]=n,s[t]=Q$(n)?1+n.length:-1),i},modified(t,e){const n=this[qR];if(!arguments.length){for(const t in n)if(n[t])return!0;return!1}if(Q$(t)){for(let e=0;e<t.length;++e)if(n[t[e]])return!0;return!1}return null!=e&&e>=0?e+1<n[t]||!!n[e+":"+t]:!!n[t]},clear(){return this[qR]={},this}};let HR=0;const GR=new WR;function YR(t,e,n,r){this.id=++HR,this.value=t,this.stamp=-1,this.rank=-1,this.qrank=-1,this.flags=0,e&&(this._update=e),n&&this.parameters(n,r)}function XR(t){return function(e){const n=this.flags;return 0===arguments.length?!!(n&t):(this.flags=e?n|t:n&~t,this)}}YR.prototype={targets(){return this._targets||(this._targets=OR(P$))},set(t){return this.value!==t?(this.value=t,1):0},skip:XR(1),modified:XR(2),parameters(t,e,n){e=!1!==e;const r=this._argval=this._argval||new WR,i=this._argops=this._argops||[],o=[];let s,a,l,u;const c=(t,n,s)=>{s instanceof YR?(s!==this&&(e&&s.targets().add(this),o.push(s)),i.push({op:s,name:t,index:n})):r.set(t,n,s)};for(s in t)if(a=t[s],"pulse"===s)kF(a).forEach((t=>{t instanceof YR?t!==this&&(t.targets().add(this),o.push(t)):L$("Pulse parameters must be operator instances.")})),this.source=a;else if(Q$(a))for(r.set(s,-1,Array(l=a.length)),u=0;u<l;++u)c(s,u,a[u]);else c(s,-1,a);return this.marshall().clear(),n&&(i.initonly=!0),o},marshall(t){const e=this._argval||GR,n=this._argops;let r,i,o,s;if(n){const a=n.length;for(i=0;i<a;++i)r=n[i],o=r.op,s=o.modified()&&o.stamp===t,e.set(r.name,r.index,o.value,s);if(n.initonly){for(i=0;i<a;++i)r=n[i],r.op.targets().remove(this);this._argops=null,this._update=null}}return e},detach(){const t=this._argops;let e,n,r,i;if(t)for(e=0,n=t.length;e<n;++e)r=t[e],i=r.op,i._targets&&i._targets.remove(this);this.pulse=null,this.source=null},evaluate(t){const e=this._update;if(e){const n=this.marshall(t.stamp),r=e.call(this,n,t);if(n.clear(),r!==this.value)this.value=r;else if(!this.modified())return t.StopPropagation}},run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?(this.skip(!1),e=0):e=this.evaluate(t),this.pulse=e||t}};let JR=0;function KR(t,e,n){this.id=++JR,this.value=null,n&&(this.receive=n),t&&(this._filter=t),e&&(this._apply=e)}function QR(t,e,n){return new KR(t,e,n)}KR.prototype={_filter:V$,_apply:z$,targets(){return this._targets||(this._targets=OR(P$))},consume(t){return arguments.length?(this._consume=!!t,this):!!this._consume},receive(t){if(this._filter(t)){const e=this.value=this._apply(t),n=this._targets,r=n?n.length:0;for(let t=0;t<r;++t)n[t].receive(e);this._consume&&(t.preventDefault(),t.stopPropagation())}},filter(t){const e=QR(t);return this.targets().add(e),e},apply(t){const e=QR(null,t);return this.targets().add(e),e},merge(){const t=QR();this.targets().add(t);for(let e=0,n=arguments.length;e<n;++e)arguments[e].targets().add(t);return t},throttle(t){let e=-1;return this.filter((()=>{const n=Date.now();return n-e>t?(e=n,1):0}))},debounce(t){const e=QR();return this.targets().add(QR(null,null,NF(t,(t=>{const n=t.dataflow;e.receive(t),n&&n.run&&n.run()})))),e},between(t,e){let n=!1;return t.targets().add(QR(null,null,(()=>n=!0))),e.targets().add(QR(null,null,(()=>n=!1))),this.filter((()=>n))},detach(){this._filter=V$,this._targets=null}};const ZR={skip:!0};function tP(t,e,n,r,i,o){const s=$F({},o,ZR);let a,l;EF(n)||(n=IF(n)),void 0===r?a=e=>t.touch(n(e)):EF(r)?(l=new YR(null,r,i,!1),a=e=>{l.evaluate(e);const r=n(e),i=l.value;UR(i)?t.pulse(r,i,o):t.update(r,i,s)}):a=e=>t.update(n(e),r,s),e.apply(a)}function eP(t,e,n,r,i,o){if(void 0===r)e.targets().add(n);else{const s=o||{},a=new YR(null,function(t,e){return e=EF(e)?e:IF(e),t?function(n,r){const i=e(n,r);return t.skip()||(t.skip(i!==this.value).value=i),i}:e}(n,r),i,!1);a.modified(s.force),a.rank=e.rank,e.targets().add(a),n&&(a.skip(!0),a.value=n.value,a.targets().add(n),t.connect(n,[a]))}}const nP={};function rP(t,e,n){this.dataflow=t,this.stamp=null==e?-1:e,this.add=[],this.rem=[],this.mod=[],this.fields=null,this.encode=n||null}function iP(t,e){const n=[];return hL(t,e,(t=>n.push(t))),n}function oP(t,e){const n={};return t.visit(e,(t=>{n[FR(t)]=1})),t=>n[FR(t)]?null:t}function sP(t,e){return t?(n,r)=>t(n,r)&&e(n,r):e}function aP(t,e,n,r){const i=this;let o=0;this.dataflow=t,this.stamp=e,this.fields=null,this.encode=r||null,this.pulses=n;for(const t of n)if(t.stamp===e){if(t.fields){const e=i.fields||(i.fields={});for(const n in t.fields)e[n]=1}t.changed(i.ADD)&&(o|=i.ADD),t.changed(i.REM)&&(o|=i.REM),t.changed(i.MOD)&&(o|=i.MOD)}this.changes=o}function lP(t){return t.error("Dataflow already running. Use runAsync() to chain invocations."),t}rP.prototype={StopPropagation:nP,ADD:1,REM:2,MOD:4,ADD_REM:3,ADD_MOD:5,ALL:7,REFLOW:8,SOURCE:16,NO_SOURCE:32,NO_FIELDS:64,fork(t){return new rP(this.dataflow).init(this,t)},clone(){const t=this.fork(7);return t.add=t.add.slice(),t.rem=t.rem.slice(),t.mod=t.mod.slice(),t.source&&(t.source=t.source.slice()),t.materialize(23)},addAll(){let t=this;return!t.source||t.add===t.rem||!t.rem.length&&t.source.length===t.add.length||(t=new rP(this.dataflow).init(this),t.add=t.source,t.rem=[]),t},init(t,e){const n=this;return n.stamp=t.stamp,n.encode=t.encode,!t.fields||64&e||(n.fields=t.fields),1&e?(n.addF=t.addF,n.add=t.add):(n.addF=null,n.add=[]),2&e?(n.remF=t.remF,n.rem=t.rem):(n.remF=null,n.rem=[]),4&e?(n.modF=t.modF,n.mod=t.mod):(n.modF=null,n.mod=[]),32&e?(n.srcF=null,n.source=null):(n.srcF=t.srcF,n.source=t.source,t.cleans&&(n.cleans=t.cleans)),n},runAfter(t){this.dataflow.runAfter(t)},changed(t){const e=t||7;return 1&e&&this.add.length||2&e&&this.rem.length||4&e&&this.mod.length},reflow(t){if(t)return this.fork(7).reflow();const e=this.add.length,n=this.source&&this.source.length;return n&&n!==e&&(this.mod=this.source,e&&this.filter(4,oP(this,1))),this},clean(t){return arguments.length?(this.cleans=!!t,this):this.cleans},modifies(t){const e=this.fields||(this.fields={});return Q$(t)?t.forEach((t=>e[t]=!0)):e[t]=!0,this},modified(t,e){const n=this.fields;return!(!e&&!this.mod.length||!n)&&(arguments.length?Q$(t)?t.some((t=>n[t])):n[t]:!!n)},filter(t,e){const n=this;return 1&t&&(n.addF=sP(n.addF,e)),2&t&&(n.remF=sP(n.remF,e)),4&t&&(n.modF=sP(n.modF,e)),16&t&&(n.srcF=sP(n.srcF,e)),n},materialize(t){const e=this;return 1&(t=t||7)&&e.addF&&(e.add=iP(e.add,e.addF),e.addF=null),2&t&&e.remF&&(e.rem=iP(e.rem,e.remF),e.remF=null),4&t&&e.modF&&(e.mod=iP(e.mod,e.modF),e.modF=null),16&t&&e.srcF&&(e.source=e.source.filter(e.srcF),e.srcF=null),e},visit(t,e){const n=this,r=e;if(16&t)return hL(n.source,n.srcF,r),n;1&t&&hL(n.add,n.addF,r),2&t&&hL(n.rem,n.remF,r),4&t&&hL(n.mod,n.modF,r);const i=n.source;if(8&t&&i){const t=n.add.length+n.mod.length;t===i.length||hL(i,t?oP(n,5):n.srcF,r)}return n}},UF(aP,rP,{fork(t){const e=new rP(this.dataflow).init(this,t&this.NO_FIELDS);return void 0!==t&&(t&e.ADD&&this.visit(e.ADD,(t=>e.add.push(t))),t&e.REM&&this.visit(e.REM,(t=>e.rem.push(t))),t&e.MOD&&this.visit(e.MOD,(t=>e.mod.push(t)))),e},changed(t){return this.changes&t},modified(t){const e=this,n=e.fields;return n&&e.changes&e.MOD?Q$(t)?t.some((t=>n[t])):n[t]:0},filter(){L$("MultiPulse does not support filtering.")},materialize(){L$("MultiPulse does not support materialization.")},visit(t,e){const n=this,r=n.pulses,i=r.length;let o=0;if(t&n.SOURCE)for(;o<i;++o)r[o].visit(t,e);else for(;o<i;++o)r[o].stamp===n.stamp&&r[o].visit(t,e);return n}});const uP={skip:!1,force:!1};function cP(t,e,n,r){let i,o;const s=t[n];for(;n>e&&(o=n-1>>1,i=t[o],r(s,i)<0);)t[n]=i,n=o;return t[n]=s}function hP(){this.logger(K$()),this.logLevel(G$),this._clock=0,this._rank=0,this._locale=tR();try{this._loader=MR()}catch(t){}this._touched=OR(P$),this._input={},this._pulse=null,this._heap=function(t){let e=[];return{clear:()=>e=[],size:()=>e.length,peek:()=>e[0],push:n=>(e.push(n),cP(e,0,e.length-1,t)),pop:()=>{const n=e.pop();let r;return e.length?(r=e[0],e[0]=n,function(t,e,n){const r=e,i=t.length,o=t[e];let s,a=1+(e<<1);for(;a<i;)s=a+1,s<i&&n(t[a],t[s])>=0&&(a=s),t[e]=t[a],a=1+((e=a)<<1);t[e]=o,cP(t,r,e,n)}(e,0,t)):r=n,r}}}(((t,e)=>t.qrank-e.qrank)),this._postrun=[]}function fP(t){return function(){return this._log[t].apply(this,arguments)}}function dP(t,e){YR.call(this,t,null,e)}hP.prototype={stamp(){return this._clock},loader(t){return arguments.length?(this._loader=t,this):this._loader},locale(t){return arguments.length?(this._locale=t,this):this._locale},logger(t){return arguments.length?(this._log=t,this):this._log},error:fP("error"),warn:fP("warn"),info:fP("info"),debug:fP("debug"),logLevel:fP("level"),cleanThreshold:1e4,add:function(t,e,n,r){let i,o=1;return t instanceof YR?i=t:t&&t.prototype instanceof YR?i=new t:EF(t)?i=new YR(null,t):(o=0,i=new YR(t,e)),this.rank(i),o&&(r=n,n=e),n&&this.connect(i,i.parameters(n,r)),this.touch(i),i},connect:function(t,e){const n=t.rank,r=e.length;for(let i=0;i<r;++i)if(n<e[i].rank)return void this.rerank(t)},rank:function(t){t.rank=++this._rank},rerank:function(t){const e=[t];let n,r,i;for(;e.length;)if(this.rank(n=e.pop()),r=n._targets)for(i=r.length;--i>=0;)e.push(n=r[i]),n===t&&L$("Cycle detected in dataflow graph.")},pulse:function(t,e,n){this.touch(t,n||uP);const r=new rP(this,this._clock+(this._pulse?0:1)),i=t.pulse&&t.pulse.source||[];return r.target=t,this._input[t.id]=e.pulse(r,i),this},touch:function(t,e){const n=e||uP;return this._pulse?this._enqueue(t):this._touched.add(t),n.skip&&t.skip(!0),this},update:function(t,e,n){const r=n||uP;return(t.set(e)||r.force)&&this.touch(t,r),this},changeset:VR,ingest:function(t,e,n){return e=this.parse(e,n),this.pulse(t,this.changeset().insert(e))},parse:function(t,e){const n=this.locale();return DR(t,e,n.timeParse,n.utcParse)},preload:async function(t,e,n){const r=this,i=r._pending||function(t){let e;const n=new Promise((t=>e=t));return n.requests=0,n.done=()=>{0==--n.requests&&(t._pending=null,e(t))},t._pending=n}(r);i.requests+=1;const o=await r.request(e,n);return r.pulse(t,r.changeset().remove(V$).insert(o.data||[])),i.done(),o},request:async function(t,e){const n=this;let r,i=0;try{r=await n.loader().load(t,{context:"dataflow",response:CR(e&&e.type)});try{r=n.parse(r,e)}catch(e){i=-2,n.warn("Data ingestion failed",t,e)}}catch(e){i=-1,n.warn("Loading failed",t,e)}return{data:r,status:i}},events:function(t,e,n,r){const i=this,o=QR(n,r),s=function(t){t.dataflow=i;try{o.receive(t)}catch(t){i.error(t)}finally{i.run()}};let a;a="string"==typeof t&&"undefined"!=typeof document?document.querySelectorAll(t):kF(t);const l=a.length;for(let t=0;t<l;++t)a[t].addEventListener(e,s);return o},on:function(t,e,n,r,i){return(t instanceof YR?eP:tP)(this,t,e,n,r,i),this},evaluate:async function(t,e,n){const r=this,i=[];if(r._pulse)return lP(r);if(r._pending&&await r._pending,e&&await TR(r,e),!r._touched.length)return r.debug("Dataflow invoked, but nothing to do."),r;const o=++r._clock;r._pulse=new rP(r,o,t),r._touched.forEach((t=>r._enqueue(t,!0))),r._touched=OR(P$);let s,a,l,u=0;try{for(;r._heap.size()>0;)s=r._heap.pop(),s.rank===s.qrank?(a=s.run(r._getPulse(s,t)),a.then?a=await a:a.async&&(i.push(a.async),a=nP),a!==nP&&s._targets&&s._targets.forEach((t=>r._enqueue(t))),++u):r._enqueue(s,!0)}catch(t){r._heap.clear(),l=t}if(r._input={},r._pulse=null,r.debug(`Pulse ${o}: ${u} operators`),l&&(r._postrun=[],r.error(l)),r._postrun.length){const t=r._postrun.sort(((t,e)=>e.priority-t.priority));r._postrun=[];for(let e=0;e<t.length;++e)await TR(r,t[e].callback)}return n&&await TR(r,n),i.length&&Promise.all(i).then((t=>r.runAsync(null,(()=>{t.forEach((t=>{try{t(r)}catch(t){r.error(t)}}))})))),r},run:function(t,e,n){return this._pulse?lP(this):(this.evaluate(t,e,n),this)},runAsync:async function(t,e,n){for(;this._running;)await this._running;const r=()=>this._running=null;return(this._running=this.evaluate(t,e,n)).then(r,r),this._running},runAfter:function(t,e,n){if(this._pulse||e)this._postrun.push({priority:n||0,callback:t});else try{t(this)}catch(t){this.error(t)}},_enqueue:function(t,e){const n=t.stamp<this._clock;n&&(t.stamp=this._clock),(n||e)&&(t.qrank=t.rank,this._heap.push(t))},_getPulse:function(t,e){const n=t.source,r=this._clock;return n&&Q$(n)?new aP(this,r,n.map((t=>t.pulse)),e):this._input[t.id]||function(t,e){return e&&e.stamp===t.stamp?e:(t=t.fork(),e&&e!==nP&&(t.source=e.source),t)}(this._pulse,n&&n.pulse)}},UF(dP,YR,{run(t){if(t.stamp<this.stamp)return t.StopPropagation;let e;return this.skip()?this.skip(!1):e=this.evaluate(t),e=e||t,e.then?e=e.then((t=>this.pulse=t)):e!==t.StopPropagation&&(this.pulse=e),e},evaluate(t){const e=this.marshall(t.stamp),n=this.transform(e,t);return e.clear(),n},transform(){}});const pP={};function mP(t){const e=gP(t);return e&&e.Definition||null}function gP(t){return t=t&&t.toLowerCase(),RF(pP,t)?pP[t]:null}function yP(t,e){let n;if(void 0===e)for(const e of t)null!=e&&(n>e||void 0===n&&e>=e)&&(n=e);else{let r=-1;for(let i of t)null!=(i=e(i,++r,t))&&(n>i||void 0===n&&i>=i)&&(n=i)}return n}function bP(t,e){return(null==t||!(t>=t))-(null==e||!(e>=e))||(t<e?-1:t>e?1:0)}function vP(t,e,n=0,r=1/0,i){if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(t.length-1,r)),!(n<=e&&e<=r))return t;for(i=void 0===i?bP:function(t=FM){if(t===FM)return bP;if("function"!=typeof t)throw new TypeError("compare is not a function");return(e,n)=>{const r=t(e,n);return r||0===r?r:(0===t(n,n))-(0===t(e,e))}}(i);r>n;){if(r-n>600){const o=r-n+1,s=e-n+1,a=Math.log(o),l=.5*Math.exp(2*a/3),u=.5*Math.sqrt(a*l*(o-l)/o)*(s-o/2<0?-1:1);vP(t,e,Math.max(n,Math.floor(e-s*l/o+u)),Math.min(r,Math.floor(e+(o-s)*l/o+u)),i)}const o=t[e];let s=n,a=r;for(wP(t,n,e),i(t[r],o)>0&&wP(t,n,r);s<a;){for(wP(t,s,a),++s,--a;i(t[s],o)<0;)++s;for(;i(t[a],o)>0;)--a}0===i(t[n],o)?wP(t,n,a):(++a,wP(t,a,r)),a<=e&&(n=a+1),e<=a&&(r=a-1)}return t}function wP(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function xP(t,e,n){if(t=Float64Array.from(function*(t,e){if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(yield e);else{let n=-1;for(let r of t)null!=(r=e(r,++n,t))&&(r=+r)>=r&&(yield r)}}(t,n)),(r=t.length)&&!isNaN(e=+e)){if(e<=0||r<2)return yP(t);if(e>=1)return VE(t);var r,i=(r-1)*e,o=Math.floor(i),s=VE(vP(t,o).subarray(0,o+1));return s+(yP(t.subarray(o+1))-s)*(i-o)}}function _P(t,e,n=PM){if((r=t.length)&&!isNaN(e=+e)){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,o=Math.floor(i),s=+n(t[o],o,t);return s+(+n(t[o+1],o+1,t)-s)*(i-o)}}function kP(t,e){return xP(t,.5,e)}function*SP(t,e){if(null==e)for(let e of t)null!=e&&""!==e&&(e=+e)>=e&&(yield e);else{let n=-1;for(let r of t)r=e(r,++n,t),null!=r&&""!==r&&(r=+r)>=r&&(yield r)}}function EP(t,e,n){const r=Float64Array.from(SP(t,n));return r.sort(FM),e.map((t=>_P(r,t)))}function AP(t,e){return EP(t,[.25,.5,.75],e)}function CP(t,e){const n=t.length,r=function(t,e){const n=function(t,e){let n,r=0,i=0,o=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(n=e-i,i+=n/++r,o+=n*(e-i));else{let s=-1;for(let a of t)null!=(a=e(a,++s,t))&&(a=+a)>=a&&(n=a-i,i+=n/++r,o+=n*(a-i))}if(r>1)return o/(r-1)}(t,e);return n?Math.sqrt(n):n}(t,e),i=AP(t,e),o=(i[2]-i[0])/1.34;return 1.06*(Math.min(r,o)||r||Math.abs(i[0])||1)*Math.pow(n,-.2)}function DP(t){const e=t.maxbins||20,n=t.base||10,r=Math.log(n),i=t.divide||[5,2];let o,s,a,l,u,c,h=t.extent[0],f=t.extent[1];const d=t.span||f-h||Math.abs(h)||1;if(t.step)o=t.step;else if(t.steps){for(l=d/e,u=0,c=t.steps.length;u<c&&t.steps[u]<l;++u);o=t.steps[Math.max(0,u-1)]}else{for(s=Math.ceil(Math.log(e)/r),a=t.minstep||0,o=Math.max(a,Math.pow(n,Math.round(Math.log(d)/r)-s));Math.ceil(d/o)>e;)o*=n;for(u=0,c=i.length;u<c;++u)l=o/i[u],l>=a&&d/l<=e&&(o=l)}l=Math.log(o);const p=l>=0?0:1+~~(-l/r),m=Math.pow(n,-p-1);return(t.nice||void 0===t.nice)&&(l=Math.floor(h/o+m)*o,h=h<l?l-o:l,f=Math.ceil(f/o)*o),{start:h,stop:f===h?h+o:f,step:o}}var MP=Math.random;function OP(t){MP=t}function TP(t,e,n,r){if(!t.length)return[void 0,void 0];const i=Float64Array.from(SP(t,r)),o=i.length,s=e;let a,l,u,c;for(u=0,c=Array(s);u<s;++u){for(a=0,l=0;l<o;++l)a+=i[~~(MP()*o)];c[u]=a/o}return c.sort(FM),[xP(c,n/2),xP(c,1-n/2)]}function IP(t,e,n,r){r=r||(t=>t);const i=t.length,o=new Float64Array(i);let s,a=0,l=1,u=r(t[0]),c=u,h=u+e;for(;l<i;++l){if(s=r(t[l]),s>=h){for(c=(u+c)/2;a<l;++a)o[a]=c;h=s+e,u=s}c=s}for(c=(u+c)/2;a<l;++a)o[a]=c;return n?function(t,e){const n=t.length;let r,i,o=0,s=1;for(;t[o]===t[s];)++s;for(;s<n;){for(r=s+1;t[s]===t[r];)++r;if(t[s]-t[s-1]<e){for(i=s+(o+r-s-s>>1);i<s;)t[i++]=t[s];for(;i>s;)t[i--]=t[o]}o=s,s=r}return t}(o,e+e/4):o}function NP(t){return function(){return(t=(1103515245*t+12345)%2147483647)/2147483647}}function $P(t,e){let n,r,i;null==e&&(e=t,t=0);const o={min(t){return arguments.length?(n=t||0,i=r-n,o):n},max(t){return arguments.length?(r=t||0,i=r-n,o):r},sample:()=>n+Math.floor(i*MP()),pdf:t=>t===Math.floor(t)&&t>=n&&t<r?1/i:0,cdf(t){const e=Math.floor(t);return e<n?0:e>=r?1:(e-n+1)/i},icdf:t=>t>=0&&t<=1?n-1+Math.floor(t*i):NaN};return o.min(t).max(e)}const FP=Math.sqrt(2*Math.PI),LP=Math.SQRT2;let BP=NaN;function RP(t,e){t=t||0,e=null==e?1:e;let n,r,i=0,o=0;if(BP==BP)i=BP,BP=NaN;else{do{i=2*MP()-1,o=2*MP()-1,n=i*i+o*o}while(0===n||n>1);r=Math.sqrt(-2*Math.log(n)/n),i*=r,BP=o*r}return t+i*e}function PP(t,e,n){const r=(t-(e||0))/(n=null==n?1:n);return Math.exp(-.5*r*r)/(n*FP)}function zP(t,e,n){const r=(t-(e=e||0))/(n=null==n?1:n),i=Math.abs(r);let o;if(i>37)o=0;else{const t=Math.exp(-i*i/2);let e;i<7.07106781186547?(e=.0352624965998911*i+.700383064443688,e=e*i+6.37396220353165,e=e*i+33.912866078383,e=e*i+112.079291497871,e=e*i+221.213596169931,e=e*i+220.206867912376,o=t*e,e=.0883883476483184*i+1.75566716318264,e=e*i+16.064177579207,e=e*i+86.7807322029461,e=e*i+296.564248779674,e=e*i+637.333633378831,e=e*i+793.826512519948,e=e*i+440.413735824752,o/=e):(e=i+.65,e=i+4/e,e=i+3/e,e=i+2/e,e=i+1/e,o=t/e/2.506628274631)}return r>0?1-o:o}function jP(t,e,n){return t<0||t>1?NaN:(e||0)+(null==n?1:n)*LP*function(t){let e,n=-Math.log((1-t)*(1+t));return n<6.25?(n-=3.125,e=-364441206401782e-35,e=e*n-16850591381820166e-35,e=128584807152564e-32+e*n,e=11157877678025181e-33+e*n,e=e*n-1333171662854621e-31,e=20972767875968562e-33+e*n,e=6637638134358324e-30+e*n,e=e*n-4054566272975207e-29,e=e*n-8151934197605472e-29,e=26335093153082323e-28+e*n,e=e*n-12975133253453532e-27,e=e*n-5415412054294628e-26,e=1.0512122733215323e-9+e*n,e=e*n-4.112633980346984e-9,e=e*n-2.9070369957882005e-8,e=4.2347877827932404e-7+e*n,e=e*n-13654692000834679e-22,e=e*n-13882523362786469e-21,e=.00018673420803405714+e*n,e=e*n-.000740702534166267,e=e*n-.006033670871430149,e=.24015818242558962+e*n,e=1.6536545626831027+e*n):n<16?(n=Math.sqrt(n)-3.25,e=2.2137376921775787e-9,e=9.075656193888539e-8+e*n,e=e*n-2.7517406297064545e-7,e=1.8239629214389228e-8+e*n,e=15027403968909828e-22+e*n,e=e*n-4013867526981546e-21,e=29234449089955446e-22+e*n,e=12475304481671779e-21+e*n,e=e*n-47318229009055734e-21,e=6828485145957318e-20+e*n,e=24031110387097894e-21+e*n,e=e*n-.0003550375203628475,e=.0009532893797373805+e*n,e=e*n-.0016882755560235047,e=.002491442096107851+e*n,e=e*n-.003751208507569241,e=.005370914553590064+e*n,e=1.0052589676941592+e*n,e=3.0838856104922208+e*n):Number.isFinite(n)?(n=Math.sqrt(n)-5,e=-27109920616438573e-27,e=e*n-2.555641816996525e-10,e=1.5076572693500548e-9+e*n,e=e*n-3.789465440126737e-9,e=7.61570120807834e-9+e*n,e=e*n-1.496002662714924e-8,e=2.914795345090108e-8+e*n,e=e*n-6.771199775845234e-8,e=2.2900482228026655e-7+e*n,e=e*n-9.9298272942317e-7,e=4526062597223154e-21+e*n,e=e*n-1968177810553167e-20,e=7599527703001776e-20+e*n,e=e*n-.00021503011930044477,e=e*n-.00013871931833623122,e=1.0103004648645344+e*n,e=4.849906401408584+e*n):e=1/0,e*t}(2*t-1)}function UP(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>RP(n,r),pdf:t=>PP(t,n,r),cdf:t=>zP(t,n,r),icdf:t=>jP(t,n,r)};return i.mean(t).stdev(e)}function VP(t,e){const n=UP();let r=0;const i={data(n){return arguments.length?(t=n,r=n?n.length:0,i.bandwidth(e)):t},bandwidth(n){return arguments.length?(!(e=n)&&t&&(e=CP(t)),i):e},sample:()=>t[~~(MP()*r)]+e*n.sample(),pdf(i){let o=0,s=0;for(;s<r;++s)o+=n.pdf((i-t[s])/e);return o/e/r},cdf(i){let o=0,s=0;for(;s<r;++s)o+=n.cdf((i-t[s])/e);return o/r},icdf(){throw Error("KDE icdf not supported.")}};return i.data(t)}function qP(t,e){return t=t||0,e=null==e?1:e,Math.exp(t+RP()*e)}function WP(t,e,n){if(t<=0)return 0;e=e||0,n=null==n?1:n;const r=(Math.log(t)-e)/n;return Math.exp(-.5*r*r)/(n*FP*t)}function HP(t,e,n){return zP(Math.log(t),e,n)}function GP(t,e,n){return Math.exp(jP(t,e,n))}function YP(t,e){let n,r;const i={mean(t){return arguments.length?(n=t||0,i):n},stdev(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>qP(n,r),pdf:t=>WP(t,n,r),cdf:t=>HP(t,n,r),icdf:t=>GP(t,n,r)};return i.mean(t).stdev(e)}function XP(t,e){let n,r=0;const i={weights(t){return arguments.length?(n=function(t){const e=[];let n,i=0;for(n=0;n<r;++n)i+=e[n]=null==t[n]?1:+t[n];for(n=0;n<r;++n)e[n]/=i;return e}(e=t||[]),i):e},distributions(n){return arguments.length?(n?(r=n.length,t=n):(r=0,t=[]),i.weights(e)):t},sample(){const e=MP();let i=t[r-1],o=n[0],s=0;for(;s<r-1;o+=n[++s])if(e<o){i=t[s];break}return i.sample()},pdf(e){let i=0,o=0;for(;o<r;++o)i+=n[o]*t[o].pdf(e);return i},cdf(e){let i=0,o=0;for(;o<r;++o)i+=n[o]*t[o].cdf(e);return i},icdf(){throw Error("Mixture icdf not supported.")}};return i.distributions(t).weights(e)}function JP(t,e){return null==e&&(e=null==t?1:t,t=0),t+(e-t)*MP()}function KP(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=e&&t<=n?1/(n-e):0}function QP(t,e,n){return null==n&&(n=null==e?1:e,e=0),t<e?0:t>n?1:(t-e)/(n-e)}function ZP(t,e,n){return null==n&&(n=null==e?1:e,e=0),t>=0&&t<=1?e+t*(n-e):NaN}function tz(t,e){let n,r;const i={min(t){return arguments.length?(n=t||0,i):n},max(t){return arguments.length?(r=null==t?1:t,i):r},sample:()=>JP(n,r),pdf:t=>KP(t,n,r),cdf:t=>QP(t,n,r),icdf:t=>ZP(t,n,r)};return null==e&&(e=null==t?1:t,t=0),i.min(t).max(e)}function ez(t,e,n){let r=0,i=0;for(const o of t){const t=n(o);null==e(o)||null==t||isNaN(t)||(r+=(t-r)/++i)}return{coef:[r],predict:()=>r,rSquared:0}}function nz(t,e,n,r){const i=r-t*t,o=Math.abs(i)<1e-24?0:(n-t*e)/i;return[e-o*t,o]}function rz(t,e,n,r){t=t.filter((t=>{let r=e(t),i=n(t);return null!=r&&(r=+r)>=r&&null!=i&&(i=+i)>=i})),r&&t.sort(((t,n)=>e(t)-e(n)));const i=t.length,o=new Float64Array(i),s=new Float64Array(i);let a,l,u,c=0,h=0,f=0;for(u of t)o[c]=a=+e(u),s[c]=l=+n(u),++c,h+=(a-h)/c,f+=(l-f)/c;for(c=0;c<i;++c)o[c]-=h,s[c]-=f;return[o,s,h,f]}function iz(t,e,n,r){let i,o,s=-1;for(const a of t)i=e(a),o=n(a),null!=i&&(i=+i)>=i&&null!=o&&(o=+o)>=o&&r(i,o,++s)}function oz(t,e,n,r,i){let o=0,s=0;return iz(t,e,n,((t,e)=>{const n=e-i(t),a=e-r;o+=n*n,s+=a*a})),1-o/s}function sz(t,e,n){let r=0,i=0,o=0,s=0,a=0;iz(t,e,n,((t,e)=>{++a,r+=(t-r)/a,i+=(e-i)/a,o+=(t*e-o)/a,s+=(t*t-s)/a}));const l=nz(r,i,o,s),u=t=>l[0]+l[1]*t;return{coef:l,predict:u,rSquared:oz(t,e,n,i,u)}}function az(t,e,n){let r=0,i=0,o=0,s=0,a=0;iz(t,e,n,((t,e)=>{++a,t=Math.log(t),r+=(t-r)/a,i+=(e-i)/a,o+=(t*e-o)/a,s+=(t*t-s)/a}));const l=nz(r,i,o,s),u=t=>l[0]+l[1]*Math.log(t);return{coef:l,predict:u,rSquared:oz(t,e,n,i,u)}}function lz(t,e,n){const[r,i,o,s]=rz(t,e,n);let a,l,u,c=0,h=0,f=0,d=0,p=0;iz(t,e,n,((t,e)=>{a=r[p++],l=Math.log(e),u=a*e,c+=(e*l-c)/p,h+=(u-h)/p,f+=(u*l-f)/p,d+=(a*u-d)/p}));const[m,g]=nz(h/s,c/s,f/s,d/s),y=t=>Math.exp(m+g*(t-o));return{coef:[Math.exp(m-g*o),g],predict:y,rSquared:oz(t,e,n,s,y)}}function uz(t,e,n){let r=0,i=0,o=0,s=0,a=0,l=0;iz(t,e,n,((t,e)=>{const n=Math.log(t),u=Math.log(e);++l,r+=(n-r)/l,i+=(u-i)/l,o+=(n*u-o)/l,s+=(n*n-s)/l,a+=(e-a)/l}));const u=nz(r,i,o,s),c=t=>u[0]*Math.pow(t,u[1]);return u[0]=Math.exp(u[0]),{coef:u,predict:c,rSquared:oz(t,e,n,a,c)}}function cz(t,e,n){const[r,i,o,s]=rz(t,e,n),a=r.length;let l,u,c,h,f=0,d=0,p=0,m=0,g=0;for(l=0;l<a;)u=r[l],c=i[l++],h=u*u,f+=(h-f)/l,d+=(h*u-d)/l,p+=(h*h-p)/l,m+=(u*c-m)/l,g+=(h*c-g)/l;const y=p-f*f,b=f*y-d*d,v=(g*f-m*d)/b,w=(m*y-g*d)/b,x=-v*f,_=t=>v*(t-=o)*t+w*t+x+s;return{coef:[x-w*o+v*o*o+s,w-2*v*o,v],predict:_,rSquared:oz(t,e,n,s,_)}}function hz(t,e,n,r){if(0===r)return ez(t,e,n);if(1===r)return sz(t,e,n);if(2===r)return cz(t,e,n);const[i,o,s,a]=rz(t,e,n),l=i.length,u=[],c=[],h=r+1;let f,d,p,m,g;for(f=0;f<h;++f){for(p=0,m=0;p<l;++p)m+=Math.pow(i[p],f)*o[p];for(u.push(m),g=new Float64Array(h),d=0;d<h;++d){for(p=0,m=0;p<l;++p)m+=Math.pow(i[p],f+d);g[d]=m}c.push(g)}c.push(u);const y=function(t){const e=t.length-1,n=[];let r,i,o,s,a;for(r=0;r<e;++r){for(s=r,i=r+1;i<e;++i)Math.abs(t[r][i])>Math.abs(t[r][s])&&(s=i);for(o=r;o<e+1;++o)a=t[o][r],t[o][r]=t[o][s],t[o][s]=a;for(i=r+1;i<e;++i)for(o=e;o>=r;o--)t[o][i]-=t[o][r]*t[r][i]/t[r][r]}for(i=e-1;i>=0;--i){for(a=0,o=i+1;o<e;++o)a+=t[o][i]*n[o];n[i]=(t[e][i]-a)/t[i][i]}return n}(c),b=t=>{t-=s;let e=a+y[0]+y[1]*t+y[2]*t*t;for(f=3;f<h;++f)e+=y[f]*Math.pow(t,f);return e};return{coef:fz(h,y,-s,a),predict:b,rSquared:oz(t,e,n,a,b)}}function fz(t,e,n,r){const i=Array(t);let o,s,a,l;for(o=0;o<t;++o)i[o]=0;for(o=t-1;o>=0;--o)for(a=e[o],l=1,i[o]+=a,s=1;s<=o;++s)l*=(o+1-s)/s,i[o-s]+=a*Math.pow(n,s)*l;return i[0]+=r,i}const dz=2,pz=1e-12;function mz(t,e,n,r){const[i,o,s,a]=rz(t,e,n,!0),l=i.length,u=Math.max(2,~~(r*l)),c=new Float64Array(l),h=new Float64Array(l),f=new Float64Array(l).fill(1);for(let t=-1;++t<=dz;){const e=[0,u-1];for(let t=0;t<l;++t){const n=i[t],r=e[0],s=e[1],a=n-i[r]>i[s]-n?r:s;let l=0,u=0,d=0,p=0,m=0;const g=1/Math.abs(i[a]-n||1);for(let t=r;t<=s;++t){const e=i[t],r=o[t],s=gz(Math.abs(n-e)*g)*f[t],a=e*s;l+=s,u+=a,d+=r*s,p+=r*a,m+=e*a}const[y,b]=nz(u/l,d/l,p/l,m/l);c[t]=y+b*n,h[t]=Math.abs(o[t]-c[t]),yz(i,t+1,e)}if(t===dz)break;const n=kP(h);if(Math.abs(n)<pz)break;for(let t,e,r=0;r<l;++r)t=h[r]/(6*n),f[r]=t>=1?pz:(e=1-t*t)*e}return function(t,e,n,r){const i=t.length,o=[];let s,a=0,l=0,u=[];for(;a<i;++a)s=t[a]+n,u[0]===s?u[1]+=(e[a]-u[1])/++l:(l=0,u[1]+=r,u=[s,e[a]],o.push(u));return u[1]+=r,o}(i,c,s,a)}function gz(t){return(t=1-t*t*t)*t*t}function yz(t,e,n){const r=t[e];let i=n[0],o=n[1]+1;if(!(o>=t.length))for(;e>i&&t[o]-r<=r-t[i];)n[0]=++i,n[1]=o,++o}const bz=.5*Math.PI/180;function vz(t,e,n,r){n=n||25,r=Math.max(n,r||200);const i=e=>[e,t(e)],o=e[0],s=e[1],a=s-o,l=a/r,u=[i(o)],c=[];if(n===r){for(let t=1;t<r;++t)u.push(i(o+t/n*a));return u.push(i(s)),u}c.push(i(s));for(let t=n;--t>0;)c.push(i(o+t/n*a));let h=u[0],f=c[c.length-1];const d=1/a,p=function(t,e){let n=t,r=t;const i=e.length;for(let t=0;t<i;++t){const i=e[t][1];i<n&&(n=i),i>r&&(r=i)}return 1/(r-n)}(h[1],c);for(;f;){const t=i((h[0]+f[0])/2);t[0]-h[0]>=l&&wz(h,t,f,d,p)>bz?c.push(t):(h=f,u.push(f),c.pop()),f=c[c.length-1]}return u}function wz(t,e,n,r,i){const o=Math.atan2(i*(n[1]-t[1]),r*(n[0]-t[0])),s=Math.atan2(i*(e[1]-t[1]),r*(e[0]-t[0]));return Math.abs(o-s)}function xz(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(i);++r<i;)o[r]=t+r*n;return o}function _z(t){return t&&t.length?1===t.length?t[0]:(e=t,t=>{const n=e.length;let r=1,i=String(e[0](t));for(;r<n;++r)i+="|"+e[r](t);return i}):function(){return""};var e}function kz(t,e,n){return n||t+(e?"_"+e:"")}const Sz=()=>{},Ez={init:Sz,add:Sz,rem:Sz,idx:0},Az={values:{init:t=>t.cell.store=!0,value:t=>t.cell.data.values(),idx:-1},count:{value:t=>t.cell.num},__count__:{value:t=>t.missing+t.valid},missing:{value:t=>t.missing},valid:{value:t=>t.valid},sum:{init:t=>t.sum=0,value:t=>t.valid?t.sum:void 0,add:(t,e)=>t.sum+=+e,rem:(t,e)=>t.sum-=e},product:{init:t=>t.product=1,value:t=>t.valid?t.product:void 0,add:(t,e)=>t.product*=e,rem:(t,e)=>t.product/=e},mean:{init:t=>t.mean=0,value:t=>t.valid?t.mean:void 0,add:(t,e)=>(t.mean_d=e-t.mean,t.mean+=t.mean_d/t.valid),rem:(t,e)=>(t.mean_d=e-t.mean,t.mean-=t.valid?t.mean_d/t.valid:t.mean)},average:{value:t=>t.valid?t.mean:void 0,req:["mean"],idx:1},variance:{init:t=>t.dev=0,value:t=>t.valid>1?t.dev/(t.valid-1):void 0,add:(t,e)=>t.dev+=t.mean_d*(e-t.mean),rem:(t,e)=>t.dev-=t.mean_d*(e-t.mean),req:["mean"],idx:1},variancep:{value:t=>t.valid>1?t.dev/t.valid:void 0,req:["variance"],idx:2},stdev:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid-1)):void 0,req:["variance"],idx:2},stdevp:{value:t=>t.valid>1?Math.sqrt(t.dev/t.valid):void 0,req:["variance"],idx:2},stderr:{value:t=>t.valid>1?Math.sqrt(t.dev/(t.valid*(t.valid-1))):void 0,req:["variance"],idx:2},distinct:{value:t=>t.cell.data.distinct(t.get),req:["values"],idx:3},ci0:{value:t=>t.cell.data.ci0(t.get),req:["values"],idx:3},ci1:{value:t=>t.cell.data.ci1(t.get),req:["values"],idx:3},median:{value:t=>t.cell.data.q2(t.get),req:["values"],idx:3},q1:{value:t=>t.cell.data.q1(t.get),req:["values"],idx:3},q3:{value:t=>t.cell.data.q3(t.get),req:["values"],idx:3},min:{init:t=>t.min=void 0,value:t=>t.min=Number.isNaN(t.min)?t.cell.data.min(t.get):t.min,add:(t,e)=>{(e<t.min||void 0===t.min)&&(t.min=e)},rem:(t,e)=>{e<=t.min&&(t.min=NaN)},req:["values"],idx:4},max:{init:t=>t.max=void 0,value:t=>t.max=Number.isNaN(t.max)?t.cell.data.max(t.get):t.max,add:(t,e)=>{(e>t.max||void 0===t.max)&&(t.max=e)},rem:(t,e)=>{e>=t.max&&(t.max=NaN)},req:["values"],idx:4},argmin:{init:t=>t.argmin=void 0,value:t=>t.argmin||t.cell.data.argmin(t.get),add:(t,e,n)=>{e<t.min&&(t.argmin=n)},rem:(t,e)=>{e<=t.min&&(t.argmin=void 0)},req:["min","values"],idx:3},argmax:{init:t=>t.argmax=void 0,value:t=>t.argmax||t.cell.data.argmax(t.get),add:(t,e,n)=>{e>t.max&&(t.argmax=n)},rem:(t,e)=>{e>=t.max&&(t.argmax=void 0)},req:["max","values"],idx:3},exponential:{init:(t,e)=>{t.exp=0,t.exp_r=e},value:t=>t.valid?t.exp*(1-t.exp_r)/(1-t.exp_r**t.valid):void 0,add:(t,e)=>t.exp=t.exp_r*t.exp+e,rem:(t,e)=>t.exp=(t.exp-e/t.exp_r**(t.valid-1))/t.exp_r},exponentialb:{value:t=>t.valid?t.exp*(1-t.exp_r):void 0,req:["exponential"],idx:1}},Cz=Object.keys(Az).filter((t=>"__count__"!==t));function Dz(t,e,n){return Az[t](n,e)}function Mz(t,e){return t.idx-e.idx}function Oz(){this.valid=0,this.missing=0,this._ops.forEach((t=>null==t.aggregate_param?t.init(this):t.init(this,t.aggregate_param)))}function Tz(t,e){null!=t&&""!==t?t==t&&(++this.valid,this._ops.forEach((n=>n.add(this,t,e)))):++this.missing}function Iz(t,e){null!=t&&""!==t?t==t&&(--this.valid,this._ops.forEach((n=>n.rem(this,t,e)))):--this.missing}function Nz(t){return this._out.forEach((e=>t[e.out]=e.value(this))),t}function $z(t,e){const n=e||z$,r=function(t){const e={};t.forEach((t=>e[t.name]=t));const n=t=>{t.req&&t.req.forEach((t=>{e[t]||n(e[t]=Az[t]())}))};return t.forEach(n),Object.values(e).sort(Mz)}(t),i=t.slice().sort(Mz);function o(t){this._ops=r,this._out=i,this.cell=t,this.init()}return o.prototype.init=Oz,o.prototype.add=Tz,o.prototype.rem=Iz,o.prototype.set=Nz,o.prototype.get=n,o.fields=t.map((t=>t.out)),o}function Fz(t){this._key=t?R$(t):FR,this.reset()}[...Cz,"__count__"].forEach((t=>{Az[t]=function(t,e){return(n,r)=>$F({name:t,aggregate_param:r,out:n||t},Ez,e)}(t,Az[t])}));const Lz=Fz.prototype;function Bz(t){dP.call(this,null,t),this._adds=[],this._mods=[],this._alen=0,this._mlen=0,this._drop=!0,this._cross=!1,this._dims=[],this._dnames=[],this._measures=[],this._countOnly=!1,this._counts=null,this._prev=null,this._inputs=null,this._outputs=null}function Rz(t){dP.call(this,null,t)}function Pz(t,e,n){const r=t;let i=e||[],o=n||[],s={},a=0;return{add:t=>o.push(t),remove:t=>s[r(t)]=++a,size:()=>i.length,data:(t,e)=>(a&&(i=i.filter((t=>!s[r(t)])),s={},a=0),e&&t&&i.sort(t),o.length&&(i=t?tL(t,i,o.sort(t)):i.concat(o),o=[]),i)}}function zz(t){dP.call(this,[],t)}function jz(t){YR.call(this,null,Uz,t)}function Uz(t){return this.value&&!t.modified()?this.value:CF(t.fields,t.orders)}function Vz(t){dP.call(this,null,t)}function qz(t){dP.call(this,null,t)}Lz.reset=function(){this._add=[],this._rem=[],this._ext=null,this._get=null,this._q=null},Lz.add=function(t){this._add.push(t)},Lz.rem=function(t){this._rem.push(t)},Lz.values=function(){if(this._get=null,0===this._rem.length)return this._add;const t=this._add,e=this._rem,n=this._key,r=t.length,i=e.length,o=Array(r-i),s={};let a,l,u;for(a=0;a<i;++a)s[n(e[a])]=1;for(a=0,l=0;a<r;++a)s[n(u=t[a])]?s[n(u)]=0:o[l++]=u;return this._rem=[],this._add=o},Lz.distinct=function(t){const e=this.values(),n={};let r,i=e.length,o=0;for(;--i>=0;)r=t(e[i])+"",RF(n,r)||(n[r]=1,++o);return o},Lz.extent=function(t){if(this._get!==t||!this._ext){const e=this.values(),n=LF(e,t);this._ext=[e[n[0]],e[n[1]]],this._get=t}return this._ext},Lz.argmin=function(t){return this.extent(t)[0]||{}},Lz.argmax=function(t){return this.extent(t)[1]||{}},Lz.min=function(t){const e=this.extent(t)[0];return null!=e?t(e):void 0},Lz.max=function(t){const e=this.extent(t)[1];return null!=e?t(e):void 0},Lz.quartile=function(t){return this._get===t&&this._q||(this._q=AP(this.values(),t),this._get=t),this._q},Lz.q1=function(t){return this.quartile(t)[0]},Lz.q2=function(t){return this.quartile(t)[1]},Lz.q3=function(t){return this.quartile(t)[2]},Lz.ci=function(t){return this._get===t&&this._ci||(this._ci=TP(this.values(),1e3,.05,t),this._get=t),this._ci},Lz.ci0=function(t){return this.ci(t)[0]},Lz.ci1=function(t){return this.ci(t)[1]},Bz.Definition={type:"Aggregate",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:Cz},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"drop",type:"boolean",default:!0},{name:"cross",type:"boolean",default:!1},{name:"key",type:"field"}]},UF(Bz,dP,{transform(t,e){const n=this,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.modified();return n.stamp=r.stamp,n.value&&(i||e.modified(n._inputs,!0))?(n._prev=n.value,n.value=i?n.init(t):Object.create(null),e.visit(e.SOURCE,(t=>n.add(t)))):(n.value=n.value||n.init(t),e.visit(e.REM,(t=>n.rem(t))),e.visit(e.ADD,(t=>n.add(t)))),r.modifies(n._outputs),n._drop=!1!==t.drop,t.cross&&n._dims.length>1&&(n._drop=!1,n.cross()),e.clean()&&n._drop&&r.clean(!0).runAfter((()=>this.clean())),n.changes(r)},cross(){const t=this,e=t.value,n=t._dnames,r=n.map((()=>({}))),i=n.length;function o(t){let e,o,s,a;for(e in t)for(s=t[e].tuple,o=0;o<i;++o)r[o][a=s[n[o]]]=a}o(t._prev),o(e),function o(s,a,l){const u=n[l],c=r[l++];for(const n in c){const r=s?s+"|"+n:n;a[u]=c[n],l<i?o(r,a,l):e[r]||t.cell(r,a)}}("",{},0)},init(t){const e=this._inputs=[],n=this._outputs=[],r={};function i(t){const n=kF(I$(t)),i=n.length;let o,s=0;for(;s<i;++s)r[o=n[s]]||(r[o]=1,e.push(o))}this._dims=kF(t.groupby),this._dnames=this._dims.map((t=>{const e=T$(t);return i(t),n.push(e),e})),this.cellkey=t.key?t.key:_z(this._dims),this._countOnly=!0,this._counts=[],this._measures=[];const o=t.fields||[null],s=t.ops||["count"],a=t.aggregate_params||[null],l=t.as||[],u=o.length,c={};let h,f,d,p,m,g,y;for(u!==s.length&&L$("Unmatched number of fields and aggregate ops."),y=0;y<u;++y)h=o[y],f=s[y],d=a[y]||null,null==h&&"count"!==f&&L$("Null aggregate field specified."),m=T$(h),g=kz(f,m,l[y]),n.push(g),"count"!==f?(p=c[m],p||(i(h),p=c[m]=[],p.field=h,this._measures.push(p)),"count"!==f&&(this._countOnly=!1),p.push(Dz(f,d,g))):this._counts.push(g);return this._measures=this._measures.map((t=>$z(t,t.field))),Object.create(null)},cellkey:_z(),cell(t,e){let n=this.value[t];return n?0===n.num&&this._drop&&n.stamp<this.stamp?(n.stamp=this.stamp,this._adds[this._alen++]=n):n.stamp<this.stamp&&(n.stamp=this.stamp,this._mods[this._mlen++]=n):(n=this.value[t]=this.newcell(t,e),this._adds[this._alen++]=n),n},newcell(t,e){const n={key:t,num:0,agg:null,tuple:this.newtuple(e,this._prev&&this._prev[t]),stamp:this.stamp,store:!1};if(!this._countOnly){const t=this._measures,e=t.length;n.agg=Array(e);for(let r=0;r<e;++r)n.agg[r]=new t[r](n)}return n.store&&(n.data=new Fz),n},newtuple(t,e){const n=this._dnames,r=this._dims,i=r.length,o={};for(let e=0;e<i;++e)o[n[e]]=r[e](t);return e?zR(e.tuple,o):BR(o)},clean(){const t=this.value;for(const e in t)0===t[e].num&&delete t[e]},add(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num+=1,this._countOnly)return;n.store&&n.data.add(t);const r=n.agg;for(let e=0,n=r.length;e<n;++e)r[e].add(r[e].get(t),t)},rem(t){const e=this.cellkey(t),n=this.cell(e,t);if(n.num-=1,this._countOnly)return;n.store&&n.data.rem(t);const r=n.agg;for(let e=0,n=r.length;e<n;++e)r[e].rem(r[e].get(t),t)},celltuple(t){const e=t.tuple,n=this._counts;t.store&&t.data.values();for(let r=0,i=n.length;r<i;++r)e[n[r]]=t.num;if(!this._countOnly){const n=t.agg;for(let t=0,r=n.length;t<r;++t)n[t].set(e)}return e},changes(t){const e=this._adds,n=this._mods,r=this._prev,i=this._drop,o=t.add,s=t.rem,a=t.mod;let l,u,c,h;if(r)for(u in r)l=r[u],i&&!l.num||s.push(l.tuple);for(c=0,h=this._alen;c<h;++c)o.push(this.celltuple(e[c])),e[c]=null;for(c=0,h=this._mlen;c<h;++c)l=n[c],(0===l.num&&i?s:a).push(this.celltuple(l)),n[c]=null;return this._alen=this._mlen=0,this._prev=null,t}}),Rz.Definition={type:"Bin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"anchor",type:"number"},{name:"maxbins",type:"number",default:20},{name:"base",type:"number",default:10},{name:"divide",type:"number",array:!0,default:[5,2]},{name:"extent",type:"number",array:!0,length:2,required:!0},{name:"span",type:"number"},{name:"step",type:"number"},{name:"steps",type:"number",array:!0},{name:"minstep",type:"number",default:0},{name:"nice",type:"boolean",default:!0},{name:"name",type:"string"},{name:"as",type:"string",array:!0,length:2,default:["bin0","bin1"]}]},UF(Rz,dP,{transform(t,e){const n=!1!==t.interval,r=this._bins(t),i=r.start,o=r.step,s=t.as||["bin0","bin1"],a=s[0],l=s[1];let u;return u=t.modified()?(e=e.reflow(!0)).SOURCE:e.modified(I$(t.field))?e.ADD_MOD:e.ADD,e.visit(u,n?t=>{const e=r(t);t[a]=e,t[l]=null==e?null:i+o*(1+(e-i)/o)}:t=>t[a]=r(t)),e.modifies(n?s:a)},_bins(t){if(this.value&&!t.modified())return this.value;const e=t.field,n=DP(t),r=n.step;let i,o,s=n.start,a=s+Math.ceil((n.stop-s)/r)*r;null!=(i=t.anchor)&&(o=i-(s+r*Math.floor((i-s)/r)),s+=o,a+=o);const l=function(t){let n=oF(e(t));return null==n?null:n<s?-1/0:n>a?1/0:(n=Math.max(s,Math.min(n,a-r)),s+r*Math.floor(1e-14+(n-s)/r))};return l.start=s,l.stop=n.stop,l.step=r,this.value=O$(l,I$(e),t.name||"bin_"+T$(e))}}),zz.Definition={type:"Collect",metadata:{source:!0},params:[{name:"sort",type:"compare"}]},UF(zz,dP,{transform(t,e){const n=e.fork(e.ALL),r=Pz(FR,this.value,n.materialize(n.ADD).add),i=t.sort,o=e.changed()||i&&(t.modified("sort")||e.modified(i.fields));return n.visit(n.REM,r.remove),this.modified(o),this.value=n.source=r.data(jR(i),o),e.source&&e.source.root&&(this.value.root=e.source.root),n}}),UF(jz,YR),Vz.Definition={type:"CountPattern",metadata:{generates:!0,changes:!0},params:[{name:"field",type:"field",required:!0},{name:"case",type:"enum",values:["upper","lower","mixed"],default:"mixed"},{name:"pattern",type:"string",default:'[\\w"]+'},{name:"stopwords",type:"string",default:""},{name:"as",type:"string",array:!0,length:2,default:["text","count"]}]},UF(Vz,dP,{transform(t,e){const n=e=>n=>{for(var r,i=function(t,e,n){switch(e){case"upper":t=t.toUpperCase();break;case"lower":t=t.toLowerCase()}return t.match(n)}(a(n),t.case,o)||[],l=0,u=i.length;l<u;++l)s.test(r=i[l])||e(r)},r=this._parameterCheck(t,e),i=this._counts,o=this._match,s=this._stop,a=t.field,l=t.as||["text","count"],u=n((t=>i[t]=1+(i[t]||0))),c=n((t=>i[t]-=1));return r?e.visit(e.SOURCE,u):(e.visit(e.ADD,u),e.visit(e.REM,c)),this._finish(e,l)},_parameterCheck(t,e){let n=!1;return!t.modified("stopwords")&&this._stop||(this._stop=new RegExp("^"+(t.stopwords||"")+"$","i"),n=!0),!t.modified("pattern")&&this._match||(this._match=new RegExp(t.pattern||"[\\w']+","g"),n=!0),(t.modified("field")||e.modified(t.field.fields))&&(n=!0),n&&(this._counts={}),n},_finish(t,e){const n=this._counts,r=this._tuples||(this._tuples={}),i=e[0],o=e[1],s=t.fork(t.NO_SOURCE|t.NO_FIELDS);let a,l,u;for(a in n)l=r[a],u=n[a]||0,!l&&u?(r[a]=l=BR({}),l[i]=a,l[o]=u,s.add.push(l)):0===u?(l&&s.rem.push(l),n[a]=null,r[a]=null):l[o]!==u&&(l[o]=u,s.mod.push(l));return s.modifies(e)}}),qz.Definition={type:"Cross",metadata:{generates:!0},params:[{name:"filter",type:"expr"},{name:"as",type:"string",array:!0,length:2,default:["a","b"]}]},UF(qz,dP,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.as||["a","b"],i=r[0],o=r[1],s=!this.value||e.changed(e.ADD_REM)||t.modified("as")||t.modified("filter");let a=this.value;return s?(a&&(n.rem=a),a=e.materialize(e.SOURCE).source,n.add=this.value=function(t,e,n,r){for(var i,o,s=[],a={},l=t.length,u=0;u<l;++u)for(a[e]=o=t[u],i=0;i<l;++i)a[n]=t[i],r(a)&&(s.push(BR(a)),(a={})[e]=o);return s}(a,i,o,t.filter||V$)):n.mod=a,n.source=this.value,n.modifies(r)}});const Wz={kde:VP,mixture:XP,normal:UP,lognormal:YP,uniform:tz},Hz="function";function Gz(t,e){const n=t[Hz];RF(Wz,n)||L$("Unknown distribution function: "+n);const r=Wz[n]();for(const n in t)"field"===n?r.data((t.from||e()).map(t[n])):"distributions"===n?r[n](t[n].map((t=>Gz(t,e)))):typeof r[n]===Hz&&r[n](t[n]);return r}function Yz(t){dP.call(this,null,t)}const Xz=[{key:{function:"normal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"lognormal"},params:[{name:"mean",type:"number",default:0},{name:"stdev",type:"number",default:1}]},{key:{function:"uniform"},params:[{name:"min",type:"number",default:0},{name:"max",type:"number",default:1}]},{key:{function:"kde"},params:[{name:"field",type:"field",required:!0},{name:"from",type:"data"},{name:"bandwidth",type:"number",default:0}]}],Jz={key:{function:"mixture"},params:[{name:"distributions",type:"param",array:!0,params:Xz},{name:"weights",type:"number",array:!0}]};function Kz(t,e){return t?t.map(((t,n)=>e[n]||T$(t))):null}function Qz(t,e,n){const r=[],i=t=>t(l);let o,s,a,l,u,c;if(null==e)r.push(t.map(n));else for(o={},s=0,a=t.length;s<a;++s)l=t[s],u=e.map(i),c=o[u],c||(o[u]=c=[],c.dims=u,r.push(c)),c.push(n(l));return r}function Zz(t){dP.call(this,null,t)}function tj(t){YR.call(this,null,ej,t),this.modified(!0)}function ej(t){const e=t.expr;return this.value&&!t.modified("expr")?this.value:O$((n=>e(n,t)),I$(e),T$(e))}function nj(t){dP.call(this,[void 0,void 0],t)}function rj(t,e){YR.call(this,t),this.parent=e,this.count=0}function ij(t){dP.call(this,{},t),this._keys=zF();const e=this._targets=[];e.active=0,e.forEach=t=>{for(let n=0,r=e.active;n<r;++n)t(e[n],n,e)}}function oj(t){YR.call(this,null,sj,t)}function sj(t){return this.value&&!t.modified()?this.value:Q$(t.name)?kF(t.name).map((t=>R$(t))):R$(t.name,t.as)}function aj(t){dP.call(this,zF(),t)}function lj(t){dP.call(this,[],t)}function uj(t){dP.call(this,[],t)}function cj(t){dP.call(this,null,t)}function hj(t){dP.call(this,[],t)}Yz.Definition={type:"Density",metadata:{generates:!0},params:[{name:"extent",type:"number",array:!0,length:2},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"method",type:"string",default:"pdf",values:["pdf","cdf"]},{name:"distribution",type:"param",params:Xz.concat(Jz)},{name:"as",type:"string",array:!0,default:["value","density"]}]},UF(Yz,dP,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=Gz(t.distribution,function(t){return()=>t.materialize(t.SOURCE).source}(e)),i=t.steps||t.minsteps||25,o=t.steps||t.maxsteps||200;let s=t.method||"pdf";"pdf"!==s&&"cdf"!==s&&L$("Invalid density method: "+s),t.extent||r.data||L$("Missing density extent parameter."),s=r[s];const a=t.as||["value","density"],l=vz(s,t.extent||FF(r.data()),i,o).map((t=>{const e={};return e[a[0]]=t[0],e[a[1]]=t[1],BR(e)}));this.value&&(n.rem=this.value),this.value=n.add=n.source=l}return n}}),Zz.Definition={type:"DotBin",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"step",type:"number"},{name:"smooth",type:"boolean",default:!1},{name:"as",type:"string",default:"bin"}]},UF(Zz,dP,{transform(t,e){if(this.value&&!t.modified()&&!e.changed())return e;const n=e.materialize(e.SOURCE).source,r=Qz(e.source,t.groupby,z$),i=t.smooth||!1,o=t.field,s=t.step||((t,e)=>rL(FF(t,e))/30)(n,o),a=jR(((t,e)=>o(t)-o(e))),l=t.as||"bin",u=r.length;let c,h=1/0,f=-1/0,d=0;for(;d<u;++d){const t=r[d].sort(a);c=-1;for(const e of IP(t,s,i,o))e<h&&(h=e),e>f&&(f=e),t[++c][l]=e}return this.value={start:h,stop:f,step:s},e.reflow(!0).modifies(l)}}),UF(tj,YR),nj.Definition={type:"Extent",metadata:{},params:[{name:"field",type:"field",required:!0}]},UF(nj,dP,{transform(t,e){const n=this.value,r=t.field,i=e.changed()||e.modified(r.fields)||t.modified("field");let o=n[0],s=n[1];if((i||null==o)&&(o=1/0,s=-1/0),e.visit(i?e.SOURCE:e.ADD,(t=>{const e=oF(r(t));null!=e&&(e<o&&(o=e),e>s&&(s=e))})),!Number.isFinite(o)||!Number.isFinite(s)){let t=T$(r);t&&(t=` for field "${t}"`),e.dataflow.warn(`Infinite extent${t}: [${o}, ${s}]`),o=s=void 0}this.value=[o,s]}}),UF(rj,YR,{connect(t){return this.detachSubflow=t.detachSubflow,this.targets().add(t),t.source=this},add(t){this.count+=1,this.value.add.push(t)},rem(t){this.count-=1,this.value.rem.push(t)},mod(t){this.value.mod.push(t)},init(t){this.value.init(t,t.NO_SOURCE)},evaluate(){return this.value}}),UF(ij,dP,{activate(t){this._targets[this._targets.active++]=t},subflow(t,e,n,r){const i=this.value;let o,s,a=RF(i,t)&&i[t];return a?a.value.stamp<n.stamp&&(a.init(n),this.activate(a)):(s=r||(s=this._group[t])&&s.tuple,o=n.dataflow,a=new rj(n.fork(n.NO_SOURCE),this),o.add(a).connect(e(o,t,s)),i[t]=a,this.activate(a)),a},clean(){const t=this.value;let e=0;for(const n in t)if(0===t[n].count){const r=t[n].detachSubflow;r&&r(),delete t[n],++e}if(e){const t=this._targets.filter((t=>t&&t.count>0));this.initTargets(t)}},initTargets(t){const e=this._targets,n=e.length,r=t?t.length:0;let i=0;for(;i<r;++i)e[i]=t[i];for(;i<n&&null!=e[i];++i)e[i]=null;e.active=r},transform(t,e){const n=e.dataflow,r=t.key,i=t.subflow,o=this._keys,s=t.modified("key"),a=t=>this.subflow(t,i,e);return this._group=t.group||{},this.initTargets(),e.visit(e.REM,(t=>{const e=FR(t),n=o.get(e);void 0!==n&&(o.delete(e),a(n).rem(t))})),e.visit(e.ADD,(t=>{const e=r(t);o.set(FR(t),e),a(e).add(t)})),s||e.modified(r.fields)?e.visit(e.MOD,(t=>{const e=FR(t),n=o.get(e),i=r(t);n===i?a(i).mod(t):(o.set(e,i),a(n).rem(t),a(i).add(t))})):e.changed(e.MOD)&&e.visit(e.MOD,(t=>{a(o.get(FR(t))).mod(t)})),s&&e.visit(e.REFLOW,(t=>{const e=FR(t),n=o.get(e),i=r(t);n!==i&&(o.set(e,i),a(n).rem(t),a(i).add(t))})),e.clean()?n.runAfter((()=>{this.clean(),o.clean()})):o.empty>n.cleanThreshold&&n.runAfter(o.clean),e}}),UF(oj,YR),aj.Definition={type:"Filter",metadata:{changes:!0},params:[{name:"expr",type:"expr",required:!0}]},UF(aj,dP,{transform(t,e){const n=e.dataflow,r=this.value,i=e.fork(),o=i.add,s=i.rem,a=i.mod,l=t.expr;let u=!0;function c(e){const n=FR(e),i=l(e,t),c=r.get(n);i&&c?(r.delete(n),o.push(e)):i||c?u&&i&&!c&&a.push(e):(r.set(n,1),s.push(e))}return e.visit(e.REM,(t=>{const e=FR(t);r.has(e)?r.delete(e):s.push(t)})),e.visit(e.ADD,(e=>{l(e,t)?o.push(e):r.set(FR(e),1)})),e.visit(e.MOD,c),t.modified()&&(u=!1,e.visit(e.REFLOW,c)),r.empty>n.cleanThreshold&&n.runAfter(r.clean),i}}),lj.Definition={type:"Flatten",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"index",type:"string"},{name:"as",type:"string",array:!0}]},UF(lj,dP,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=Kz(r,t.as||[]),o=t.index||null,s=i.length;return n.rem=this.value,e.visit(e.SOURCE,(t=>{const e=r.map((e=>e(t))),a=e.reduce(((t,e)=>Math.max(t,e.length)),0);let l,u,c,h=0;for(;h<a;++h){for(u=RR(t),l=0;l<s;++l)u[i[l]]=null==(c=e[l][h])?null:c;o&&(u[o]=h),n.add.push(u)}})),this.value=n.source=n.add,o&&n.modifies(o),n.modifies(i)}}),uj.Definition={type:"Fold",metadata:{generates:!0},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0,length:2,default:["key","value"]}]},UF(uj,dP,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=r.map(T$),o=t.as||["key","value"],s=o[0],a=o[1],l=r.length;return n.rem=this.value,e.visit(e.SOURCE,(t=>{for(let e,o=0;o<l;++o)e=RR(t),e[s]=i[o],e[a]=r[o](t),n.add.push(e)})),this.value=n.source=n.add,n.modifies(o)}}),cj.Definition={type:"Formula",metadata:{modifies:!0},params:[{name:"expr",type:"expr",required:!0},{name:"as",type:"string",required:!0},{name:"initonly",type:"boolean"}]},UF(cj,dP,{transform(t,e){const n=t.expr,r=t.as,i=t.modified(),o=t.initonly?e.ADD:i?e.SOURCE:e.modified(n.fields)||e.modified(r)?e.ADD_MOD:e.ADD;return i&&(e=e.materialize().reflow(!0)),t.initonly||e.modifies(r),e.visit(o,(e=>e[r]=n(e,t)))}}),UF(hj,dP,{transform(t,e){const n=e.fork(e.ALL),r=t.generator;let i,o,s,a=this.value,l=t.size-a.length;if(l>0){for(i=[];--l>=0;)i.push(s=BR(r(t))),a.push(s);n.add=n.add.length?n.materialize(n.ADD).add.concat(i):i}else o=a.slice(0,-l),n.rem=n.rem.length?n.materialize(n.REM).rem.concat(o):o,a=a.slice(-l);return n.source=this.value=a,n}});const fj={value:"value",median:kP,mean:function(t,e){let n=0,r=0;if(void 0===e)for(let e of t)null!=e&&(e=+e)>=e&&(++n,r+=e);else{let i=-1;for(let o of t)null!=(o=e(o,++i,t))&&(o=+o)>=o&&(++n,r+=o)}if(n)return r/n},min:yP,max:VE},dj=[];function pj(t){dP.call(this,[],t)}function mj(t){Bz.call(this,t)}function gj(t){dP.call(this,null,t)}function yj(t){YR.call(this,null,bj,t)}function bj(t){return this.value&&!t.modified()?this.value:JF(t.fields,t.flat)}function vj(t){dP.call(this,[],t),this._pending=null}function wj(t,e,n){n.forEach(BR);const r=e.fork(e.NO_FIELDS&e.NO_SOURCE);return r.rem=t.value,t.value=r.source=r.add=n,t._pending=null,r.rem.length&&r.clean(!0),r}function xj(t){dP.call(this,{},t)}function _j(t){YR.call(this,null,kj,t)}function kj(t){if(this.value&&!t.modified())return this.value;const e=t.extents,n=e.length;let r,i,o=1/0,s=-1/0;for(r=0;r<n;++r)i=e[r],i[0]<o&&(o=i[0]),i[1]>s&&(s=i[1]);return[o,s]}function Sj(t){YR.call(this,null,Ej,t)}function Ej(t){return this.value&&!t.modified()?this.value:t.values.reduce(((t,e)=>t.concat(e)),[])}function Aj(t){dP.call(this,null,t)}function Cj(t){Bz.call(this,t)}function Dj(t){ij.call(this,t)}function Mj(t){dP.call(this,null,t)}function Oj(t){dP.call(this,null,t)}function Tj(t){dP.call(this,null,t)}function Ij(t){dP.call(this,null,t)}function Nj(t){dP.call(this,[],t),this.count=0}function $j(t){dP.call(this,null,t)}function Fj(t){dP.call(this,null,t),this.modified(!0)}function Lj(t){dP.call(this,null,t)}pj.Definition={type:"Impute",metadata:{changes:!0},params:[{name:"field",type:"field",required:!0},{name:"key",type:"field",required:!0},{name:"keyvals",array:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"enum",default:"value",values:["value","mean","median","max","min"]},{name:"value",default:0}]},UF(pj,dP,{transform(t,e){var n,r,i,o,s,a,l,u,c,h,f=e.fork(e.ALL),d=function(t){var e,n=t.method||fj.value;if(null!=fj[n])return n===fj.value?(e=void 0!==t.value?t.value:0,()=>e):fj[n];L$("Unrecognized imputation method: "+n)}(t),p=function(t){const e=t.field;return t=>t?e(t):NaN}(t),m=T$(t.field),g=T$(t.key),y=(t.groupby||[]).map(T$),b=function(t,e,n,r){var i,o,s,a,l,u,c,h,f=t=>t(h),d=[],p=r?r.slice():[],m={},g={};for(p.forEach(((t,e)=>m[t]=e+1)),a=0,c=t.length;a<c;++a)u=n(h=t[a]),l=m[u]||(m[u]=p.push(u)),(s=g[o=(i=e?e.map(f):dj)+""])||(s=g[o]=[],d.push(s),s.values=i),s[l-1]=h;return d.domain=p,d}(e.source,t.groupby,t.key,t.keyvals),v=[],w=this.value,x=b.domain.length;for(s=0,u=b.length;s<u;++s)for(i=(n=b[s]).values,r=NaN,l=0;l<x;++l)if(null==n[l]){for(o=b.domain[l],h={_impute:!0},a=0,c=i.length;a<c;++a)h[y[a]]=i[a];h[g]=o,h[m]=Number.isNaN(r)?r=d(n,p):r,v.push(BR(h))}return v.length&&(f.add=f.materialize(f.ADD).add.concat(v)),w.length&&(f.rem=f.materialize(f.REM).rem.concat(w)),this.value=v,f}}),mj.Definition={type:"JoinAggregate",metadata:{modifies:!0},params:[{name:"groupby",type:"field",array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"ops",type:"enum",array:!0,values:Cz},{name:"as",type:"string",null:!0,array:!0},{name:"key",type:"field"}]},UF(mj,Bz,{transform(t,e){const n=this,r=t.modified();let i;return n.value&&(r||e.modified(n._inputs,!0))?(i=n.value=r?n.init(t):{},e.visit(e.SOURCE,(t=>n.add(t)))):(i=n.value=n.value||this.init(t),e.visit(e.REM,(t=>n.rem(t))),e.visit(e.ADD,(t=>n.add(t)))),n.changes(),e.visit(e.SOURCE,(t=>{$F(t,i[n.cellkey(t)].tuple)})),e.reflow(r).modifies(this._outputs)},changes(){const t=this._adds,e=this._mods;let n,r;for(n=0,r=this._alen;n<r;++n)this.celltuple(t[n]),t[n]=null;for(n=0,r=this._mlen;n<r;++n)this.celltuple(e[n]),e[n]=null;this._alen=this._mlen=0}}),gj.Definition={type:"KDE",metadata:{generates:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"cumulative",type:"boolean",default:!1},{name:"counts",type:"boolean",default:!1},{name:"bandwidth",type:"number",default:0},{name:"extent",type:"number",array:!0,length:2},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"steps",type:"number"},{name:"minsteps",type:"number",default:25},{name:"maxsteps",type:"number",default:200},{name:"as",type:"string",array:!0,default:["value","density"]}]},UF(gj,dP,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=e.materialize(e.SOURCE).source,i=Qz(r,t.groupby,t.field),o=(t.groupby||[]).map(T$),s=t.bandwidth,a=t.cumulative?"cdf":"pdf",l=t.as||["value","density"],u=[];let c=t.extent,h=t.steps||t.minsteps||25,f=t.steps||t.maxsteps||200;"pdf"!==a&&"cdf"!==a&&L$("Invalid density method: "+a),"shared"===t.resolve&&(c||(c=FF(r,t.field)),h=f=t.steps||f),i.forEach((e=>{const n=VP(e,s)[a],r=t.counts?e.length:1;vz(n,c||FF(e),h,f).forEach((t=>{const n={};for(let t=0;t<o.length;++t)n[o[t]]=e.dims[t];n[l[0]]=t[0],n[l[1]]=t[1]*r,u.push(BR(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=u}return n}}),UF(yj,YR),UF(vj,dP,{transform(t,e){const n=e.dataflow;if(this._pending)return wj(this,e,this._pending);if(function(t){return t.modified("async")&&!(t.modified("values")||t.modified("url")||t.modified("format"))}(t))return e.StopPropagation;if(t.values)return wj(this,e,n.parse(t.values,t.format));if(t.async){const e=n.request(t.url,t.format).then((t=>(this._pending=kF(t.data),t=>t.touch(this))));return{async:e}}return n.request(t.url,t.format).then((t=>wj(this,e,kF(t.data))))}}),xj.Definition={type:"Lookup",metadata:{modifies:!0},params:[{name:"index",type:"index",params:[{name:"from",type:"data",required:!0},{name:"key",type:"field",required:!0}]},{name:"values",type:"field",array:!0},{name:"fields",type:"field",array:!0,required:!0},{name:"as",type:"string",array:!0},{name:"default",default:null}]},UF(xj,dP,{transform(t,e){const n=t.fields,r=t.index,i=t.values,o=null==t.default?null:t.default,s=t.modified(),a=n.length;let l,u,c,h=s?e.SOURCE:e.ADD,f=e,d=t.as;return i?(u=i.length,a>1&&!d&&L$('Multi-field lookup requires explicit "as" parameter.'),d&&d.length!==a*u&&L$('The "as" parameter has too few output field names.'),d=d||i.map(T$),l=function(t){for(var e,s,l=0,c=0;l<a;++l)if(null==(s=r.get(n[l](t))))for(e=0;e<u;++e,++c)t[d[c]]=o;else for(e=0;e<u;++e,++c)t[d[c]]=i[e](s)}):(d||L$("Missing output field names."),l=function(t){for(var e,i=0;i<a;++i)e=r.get(n[i](t)),t[d[i]]=null==e?o:e}),s?f=e.reflow(!0):(c=n.some((t=>e.modified(t.fields))),h|=c?e.MOD:0),e.visit(h,l),f.modifies(d)}}),UF(_j,YR),UF(Sj,YR),UF(Aj,dP,{transform(t,e){return this.modified(t.modified()),this.value=t,e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),Cj.Definition={type:"Pivot",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"value",type:"field",required:!0},{name:"op",type:"enum",values:Cz,default:"sum"},{name:"limit",type:"number",default:0},{name:"key",type:"field"}]},UF(Cj,Bz,{_transform:Bz.prototype.transform,transform(t,e){return this._transform(function(t,e){const n=t.field,r=t.value,i=("count"===t.op?"__count__":t.op)||"sum",o=I$(n).concat(I$(r)),s=function(t,e,n){const r={},i=[];return n.visit(n.SOURCE,(e=>{const n=t(e);r[n]||(r[n]=1,i.push(n))})),i.sort(DF),e?i.slice(0,e):i}(n,t.limit||0,e);return e.changed()&&t.set("__pivot__",null,null,!0),{key:t.key,groupby:t.groupby,ops:s.map((()=>i)),fields:s.map((t=>function(t,e,n,r){return O$((r=>e(r)===t?n(r):NaN),r,t+"")}(t,n,r,o))),as:s.map((t=>t+"")),modified:t.modified.bind(t)}}(t,e),e)}}),UF(Dj,ij,{transform(t,e){const n=t.subflow,r=t.field,i=t=>this.subflow(FR(t),n,e,t);return(t.modified("field")||r&&e.modified(I$(r)))&&L$("PreFacet does not support field modification."),this.initTargets(),r?(e.visit(e.MOD,(t=>{const e=i(t);r(t).forEach((t=>e.mod(t)))})),e.visit(e.ADD,(t=>{const e=i(t);r(t).forEach((t=>e.add(BR(t))))})),e.visit(e.REM,(t=>{const e=i(t);r(t).forEach((t=>e.rem(t)))}))):(e.visit(e.MOD,(t=>i(t).mod(t))),e.visit(e.ADD,(t=>i(t).add(t))),e.visit(e.REM,(t=>i(t).rem(t)))),e.clean()&&e.runAfter((()=>this.clean())),e}}),Mj.Definition={type:"Project",metadata:{generates:!0,changes:!0},params:[{name:"fields",type:"field",array:!0},{name:"as",type:"string",null:!0,array:!0}]},UF(Mj,dP,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.fields,i=Kz(t.fields,t.as||[]),o=r?(t,e)=>function(t,e,n,r){for(let i=0,o=n.length;i<o;++i)e[r[i]]=n[i](t);return e}(t,e,r,i):PR;let s;return this.value?s=this.value:(e=e.addAll(),s=this.value={}),e.visit(e.REM,(t=>{const e=FR(t);n.rem.push(s[e]),s[e]=null})),e.visit(e.ADD,(t=>{const e=o(t,BR({}));s[FR(t)]=e,n.add.push(e)})),e.visit(e.MOD,(t=>{n.mod.push(o(t,s[FR(t)]))})),n}}),UF(Oj,dP,{transform(t,e){return this.value=t.value,t.modified("value")?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}}),Tj.Definition={type:"Quantile",metadata:{generates:!0,changes:!0},params:[{name:"groupby",type:"field",array:!0},{name:"field",type:"field",required:!0},{name:"probs",type:"number",array:!0},{name:"step",type:"number",default:.01},{name:"as",type:"string",array:!0,default:["prob","value"]}]},UF(Tj,dP,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=t.as||["prob","value"];if(this.value&&!t.modified()&&!e.changed())return n.source=this.value,n;const i=Qz(e.materialize(e.SOURCE).source,t.groupby,t.field),o=(t.groupby||[]).map(T$),s=[],a=t.step||.01,l=t.probs||xz(a/2,1-1e-14,a),u=l.length;return i.forEach((t=>{const e=EP(t,l);for(let n=0;n<u;++n){const i={};for(let e=0;e<o.length;++e)i[o[e]]=t.dims[e];i[r[0]]=l[n],i[r[1]]=e[n],s.push(BR(i))}})),this.value&&(n.rem=this.value),this.value=n.add=n.source=s,n}}),UF(Ij,dP,{transform(t,e){let n,r;return this.value?r=this.value:(n=e=e.addAll(),r=this.value={}),t.derive&&(n=e.fork(e.NO_SOURCE),e.visit(e.REM,(t=>{const e=FR(t);n.rem.push(r[e]),r[e]=null})),e.visit(e.ADD,(t=>{const e=RR(t);r[FR(t)]=e,n.add.push(e)})),e.visit(e.MOD,(t=>{const e=r[FR(t)];for(const r in t)e[r]=t[r],n.modifies(r);n.mod.push(e)}))),n}}),Nj.Definition={type:"Sample",metadata:{},params:[{name:"size",type:"number",default:1e3}]},UF(Nj,dP,{transform(t,e){const n=e.fork(e.NO_SOURCE),r=t.modified("size"),i=t.size,o=this.value.reduce(((t,e)=>(t[FR(e)]=1,t)),{});let s=this.value,a=this.count,l=0;function u(t){let e,r;s.length<i?s.push(t):(r=~~((a+1)*MP()),r<s.length&&r>=l&&(e=s[r],o[FR(e)]&&n.rem.push(e),s[r]=t)),++a}if(e.rem.length&&(e.visit(e.REM,(t=>{const e=FR(t);o[e]&&(o[e]=-1,n.rem.push(t)),--a})),s=s.filter((t=>-1!==o[FR(t)]))),(e.rem.length||r)&&s.length<i&&e.source&&(l=a=s.length,e.visit(e.SOURCE,(t=>{o[FR(t)]||u(t)})),l=-1),r&&s.length>i){const t=s.length-i;for(let e=0;e<t;++e)o[FR(s[e])]=-1,n.rem.push(s[e]);s=s.slice(t)}return e.mod.length&&e.visit(e.MOD,(t=>{o[FR(t)]&&n.mod.push(t)})),e.add.length&&e.visit(e.ADD,u),(e.add.length||l<0)&&(n.add=s.filter((t=>!o[FR(t)]))),this.count=a,this.value=n.source=s,n}}),$j.Definition={type:"Sequence",metadata:{generates:!0,changes:!0},params:[{name:"start",type:"number",required:!0},{name:"stop",type:"number",required:!0},{name:"step",type:"number",default:1},{name:"as",type:"string",default:"data"}]},UF($j,dP,{transform(t,e){if(this.value&&!t.modified())return;const n=e.materialize().fork(e.MOD),r=t.as||"data";return n.rem=this.value?e.rem.concat(this.value):e.rem,this.value=xz(t.start,t.stop,t.step||1).map((t=>{const e={};return e[r]=t,BR(e)})),n.add=e.add.concat(this.value),n}}),UF(Fj,dP,{transform(t,e){return this.value=e.source,e.changed()?e.fork(e.NO_SOURCE|e.NO_FIELDS):e.StopPropagation}});const Bj=["unit0","unit1"];function Rj(t){dP.call(this,zF(),t)}function Pj(t){dP.call(this,null,t)}Lj.Definition={type:"TimeUnit",metadata:{modifies:!0},params:[{name:"field",type:"field",required:!0},{name:"interval",type:"boolean",default:!0},{name:"units",type:"enum",values:GL,array:!0},{name:"step",type:"number",default:1},{name:"maxbins",type:"number",default:40},{name:"extent",type:"date",array:!0},{name:"timezone",type:"enum",default:"local",values:["local","utc"]},{name:"as",type:"string",array:!0,length:2,default:Bj}]},UF(Lj,dP,{transform(t,e){const n=t.field,r=!1!==t.interval,i="utc"===t.timezone,o=this._floor(t,e),s=(i?kB:_B)(o.unit).offset,a=t.as||Bj,l=a[0],u=a[1],c=o.step;let h=o.start||1/0,f=o.stop||-1/0,d=e.ADD;return(t.modified()||e.changed(e.REM)||e.modified(I$(n)))&&(d=(e=e.reflow(!0)).SOURCE,h=1/0,f=-1/0),e.visit(d,(t=>{const e=n(t);let i,a;null==e?(t[l]=null,r&&(t[u]=null)):(t[l]=i=a=o(e),r&&(t[u]=a=s(i,c)),i<h&&(h=i),a>f&&(f=a))})),o.start=h,o.stop=f,e.modifies(r?a:l)},_floor(t,e){const n="utc"===t.timezone,{units:r,step:i}=t.units?{units:t.units,step:t.step||1}:PB({extent:t.extent||FF(e.materialize(e.SOURCE).source,t.field),maxbins:t.maxbins}),o=XL(r),s=this.value||{},a=(n?vB:gB)(o,i);return a.unit=iF(o),a.units=o,a.step=i,a.start=s.start,a.stop=s.stop,this.value=a}}),UF(Rj,dP,{transform(t,e){const n=e.dataflow,r=t.field,i=this.value,o=t=>i.set(r(t),t);let s=!0;return t.modified("field")||e.modified(r.fields)?(i.clear(),e.visit(e.SOURCE,o)):e.changed()?(e.visit(e.REM,(t=>i.delete(r(t)))),e.visit(e.ADD,o)):s=!1,this.modified(s),i.empty>n.cleanThreshold&&n.runAfter(i.clean),e.fork()}}),UF(Pj,dP,{transform(t,e){(!this.value||t.modified("field")||t.modified("sort")||e.changed()||t.sort&&e.modified(t.sort.fields))&&(this.value=(t.sort?e.source.slice().sort(jR(t.sort)):e.source).map(t.field))}});const zj={row_number:function(){return{next:t=>t.index+1}},rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?t=n+1:t}}},dense_rank:function(){let t;return{init:()=>t=1,next:e=>{const n=e.index,r=e.data;return n&&e.compare(r[n-1],r[n])?++t:t}}},percent_rank:function(){const t=zj.rank(),e=t.next;return{init:t.init,next:t=>(e(t)-1)/(t.data.length-1)}},cume_dist:function(){let t;return{init:()=>t=0,next:e=>{const n=e.data,r=e.compare;let i=e.index;if(t<i){for(;i+1<n.length&&!r(n[i],n[i+1]);)++i;t=i}return(1+t)/n.length}}},ntile:function(t,e){(e=+e)>0||L$("ntile num must be greater than zero.");const n=zj.cume_dist(),r=n.next;return{init:n.init,next:t=>Math.ceil(e*r(t))}},lag:function(t,e){return e=+e||1,{next:n=>{const r=n.index-e;return r>=0?t(n.data[r]):null}}},lead:function(t,e){return e=+e||1,{next:n=>{const r=n.index+e,i=n.data;return r<i.length?t(i[r]):null}}},first_value:function(t){return{next:e=>t(e.data[e.i0])}},last_value:function(t){return{next:e=>t(e.data[e.i1-1])}},nth_value:function(t,e){return(e=+e)>0||L$("nth_value nth must be greater than zero."),{next:n=>{const r=n.i0+(e-1);return r<n.i1?t(n.data[r]):null}}},prev_value:function(t){let e;return{init:()=>e=null,next:n=>{const r=t(n.data[n.index]);return null!=r?e=r:e}}},next_value:function(t){let e,n;return{init:()=>(e=null,n=-1),next:r=>{const i=r.data;return r.index<=n?e:(n=function(t,e,n){for(let r=e.length;n<r;++n)if(null!=t(e[n]))return n;return-1}(t,i,r.index))<0?(n=i.length,e=null):e=t(i[n])}}}},jj=Object.keys(zj);function Uj(t){const e=kF(t.ops),n=kF(t.fields),r=kF(t.params),i=kF(t.aggregate_params),o=kF(t.as),s=this.outputs=[],a=this.windows=[],l={},u={},c=[],h=[];let f=!0;function d(t){kF(I$(t)).forEach((t=>l[t]=1))}d(t.sort),e.forEach(((t,e)=>{const l=n[e],p=r[e],m=i[e]||null,g=T$(l),y=kz(t,g,o[e]);if(d(l),s.push(y),RF(zj,t))a.push(function(t,e,n,r){const i=zj[t](e,n);return{init:i.init||j$,update:function(t,e){e[r]=i.next(t)}}}(t,l,p,y));else{if(null==l&&"count"!==t&&L$("Null aggregate field specified."),"count"===t)return void c.push(y);f=!1;let e=u[g];e||(e=u[g]=[],e.field=l,h.push(e)),e.push(Dz(t,m,y))}})),(c.length||h.length)&&(this.cell=function(t,e,n){t=t.map((t=>$z(t,t.field)));const r={num:0,agg:null,store:!1,count:e};if(!n)for(var i=t.length,o=r.agg=Array(i),s=0;s<i;++s)o[s]=new t[s](r);if(r.store)var a=r.data=new Fz;return r.add=function(t){if(r.num+=1,!n){a&&a.add(t);for(let e=0;e<i;++e)o[e].add(o[e].get(t),t)}},r.rem=function(t){if(r.num-=1,!n){a&&a.rem(t);for(let e=0;e<i;++e)o[e].rem(o[e].get(t),t)}},r.set=function(t){let i,s;for(a&&a.values(),i=0,s=e.length;i<s;++i)t[e[i]]=r.num;if(!n)for(i=0,s=o.length;i<s;++i)o[i].set(t)},r.init=function(){r.num=0,a&&a.reset();for(let t=0;t<i;++t)o[t].init()},r}(h,c,f)),this.inputs=Object.keys(l)}const Vj=Uj.prototype;function qj(t){dP.call(this,{},t),this._mlen=0,this._mods=[]}function Wj(t,e,n,r){const i=r.sort,o=i&&!r.ignorePeers,s=r.frame||[null,0],a=t.data(n),l=a.length,u=o?BM(i):null,c={i0:0,i1:0,p0:0,p1:0,index:0,data:a,compare:i||IF(-1)};e.init();for(let t=0;t<l;++t)Hj(c,s,t,l),o&&Gj(c,u),e.update(c,a[t])}function Hj(t,e,n,r){t.p0=t.i0,t.p1=t.i1,t.i0=null==e[0]?0:Math.max(0,n-Math.abs(e[0])),t.i1=null==e[1]?r:Math.min(r,n+Math.abs(e[1])+1),t.index=n}function Gj(t,e){const n=t.i0,r=t.i1-1,i=t.compare,o=t.data,s=o.length-1;n>0&&!i(o[n],o[n-1])&&(t.i0=e.left(o,o[n])),r<s&&!i(o[r],o[r+1])&&(t.i1=e.right(o,o[r]))}function Yj(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function Xj(t){this._context=t}function Jj(){}function Kj(t){this._context=t}function Qj(t){this._context=t}function Zj(t,e){this._basis=new Xj(t),this._beta=e}Vj.init=function(){this.windows.forEach((t=>t.init())),this.cell&&this.cell.init()},Vj.update=function(t,e){const n=this.cell,r=this.windows,i=t.data,o=r&&r.length;let s;if(n){for(s=t.p0;s<t.i0;++s)n.rem(i[s]);for(s=t.p1;s<t.i1;++s)n.add(i[s]);n.set(e)}for(s=0;s<o;++s)r[s].update(t,e)},qj.Definition={type:"Window",metadata:{modifies:!0},params:[{name:"sort",type:"compare"},{name:"groupby",type:"field",array:!0},{name:"ops",type:"enum",array:!0,values:jj.concat(Cz)},{name:"params",type:"number",null:!0,array:!0},{name:"aggregate_params",type:"number",null:!0,array:!0},{name:"fields",type:"field",null:!0,array:!0},{name:"as",type:"string",null:!0,array:!0},{name:"frame",type:"number",null:!0,array:!0,length:2,default:[null,0]},{name:"ignorePeers",type:"boolean",default:!1}]},UF(qj,dP,{transform(t,e){this.stamp=e.stamp;const n=t.modified(),r=jR(t.sort),i=_z(t.groupby),o=t=>this.group(i(t));let s=this.state;s&&!n||(s=this.state=new Uj(t)),n||e.modified(s.inputs)?(this.value={},e.visit(e.SOURCE,(t=>o(t).add(t)))):(e.visit(e.REM,(t=>o(t).remove(t))),e.visit(e.ADD,(t=>o(t).add(t))));for(let e=0,n=this._mlen;e<n;++e)Wj(this._mods[e],s,r,t);return this._mlen=0,this._mods=[],e.reflow(n).modifies(s.outputs)},group(t){let e=this.value[t];return e||(e=this.value[t]=Pz(FR),e.stamp=-1),e.stamp<this.stamp&&(e.stamp=this.stamp,this._mods[this._mlen++]=e),e}}),Xj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Yj(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Yj(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Kj.prototype={areaStart:Jj,areaEnd:Jj,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:Yj(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Qj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Yj(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Zj.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,i=t[0],o=e[0],s=t[n]-i,a=e[n]-o,l=-1;++l<=n;)r=l/n,this._basis.point(this._beta*t[l]+(1-this._beta)*(i+r*s),this._beta*e[l]+(1-this._beta)*(o+r*a));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};const tU=function t(e){function n(t){return 1===e?new Xj(t):new Zj(t,e)}return n.beta=function(e){return t(+e)},n}(.85);function eU(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function nU(t,e){this._context=t,this._k=(1-e)/6}nU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:eU(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:eU(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const rU=function t(e){function n(t){return new nU(t,e)}return n.tension=function(e){return t(+e)},n}(0);function iU(t,e){this._context=t,this._k=(1-e)/6}iU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:eU(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const oU=function t(e){function n(t){return new iU(t,e)}return n.tension=function(e){return t(+e)},n}(0);function sU(t,e){this._context=t,this._k=(1-e)/6}sU.prototype={areaStart:Jj,areaEnd:Jj,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:eU(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const aU=function t(e){function n(t){return new sU(t,e)}return n.tension=function(e){return t(+e)},n}(0),lU=Math.abs,uU=Math.atan2,cU=Math.cos,hU=Math.max,fU=Math.min,dU=Math.sin,pU=Math.sqrt,mU=1e-12,gU=Math.PI,yU=gU/2,bU=2*gU;function vU(t){return t>=1?yU:t<=-1?-yU:Math.asin(t)}function wU(t,e,n){var r=t._x1,i=t._y1,o=t._x2,s=t._y2;if(t._l01_a>mU){var a=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,l=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*a-t._x0*t._l12_2a+t._x2*t._l01_2a)/l,i=(i*a-t._y0*t._l12_2a+t._y2*t._l01_2a)/l}if(t._l23_a>mU){var u=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,c=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*u+t._x1*t._l23_2a-e*t._l12_2a)/c,s=(s*u+t._y1*t._l23_2a-n*t._l12_2a)/c}t._context.bezierCurveTo(r,i,o,s,t._x2,t._y2)}function xU(t,e){this._context=t,this._alpha=e}xU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:wU(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const _U=function t(e){function n(t){return e?new xU(t,e):new nU(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function kU(t,e){this._context=t,this._alpha=e}kU.prototype={areaStart:Jj,areaEnd:Jj,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:wU(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const SU=function t(e){function n(t){return e?new kU(t,e):new sU(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function EU(t,e){this._context=t,this._alpha=e}EU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:wU(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const AU=function t(e){function n(t){return e?new EU(t,e):new iU(t,0)}return n.alpha=function(e){return t(+e)},n}(.5);function CU(t){this._context=t}function DU(t){return new CU(t)}function MU(t){this._context=t}function OU(t){return t<0?-1:1}function TU(t,e,n){var r=t._x1-t._x0,i=e-t._x1,o=(t._y1-t._y0)/(r||i<0&&-0),s=(n-t._y1)/(i||r<0&&-0),a=(o*i+s*r)/(r+i);return(OU(o)+OU(s))*Math.min(Math.abs(o),Math.abs(s),.5*Math.abs(a))||0}function IU(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function NU(t,e,n){var r=t._x0,i=t._y0,o=t._x1,s=t._y1,a=(o-r)/3;t._context.bezierCurveTo(r+a,i+a*e,o-a,s-a*n,o,s)}function $U(t){this._context=t}function FU(t){this._context=new LU(t)}function LU(t){this._context=t}function BU(t){this._context=t}function RU(t){var e,n,r=t.length-1,i=new Array(r),o=new Array(r),s=new Array(r);for(i[0]=0,o[0]=2,s[0]=t[0]+2*t[1],e=1;e<r-1;++e)i[e]=1,o[e]=4,s[e]=4*t[e]+2*t[e+1];for(i[r-1]=2,o[r-1]=7,s[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=i[e]/o[e-1],o[e]-=n,s[e]-=n*s[e-1];for(i[r-1]=s[r-1]/o[r-1],e=r-2;e>=0;--e)i[e]=(s[e]-i[e+1])/o[e];for(o[r-1]=(t[r]+i[r-1])/2,e=0;e<r-1;++e)o[e]=2*t[e+1]-i[e+1];return[i,o]}function PU(t,e){this._context=t,this._t=e}function zU(t){return function(){return t}}CU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}},MU.prototype={areaStart:Jj,areaEnd:Jj,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},$U.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:NU(this,this._t0,IU(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,NU(this,IU(this,n=TU(this,t,e)),n);break;default:NU(this,this._t0,n=TU(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(FU.prototype=Object.create($U.prototype)).point=function(t,e){$U.prototype.point.call(this,e,t)},LU.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,o){this._context.bezierCurveTo(e,t,r,n,o,i)}},BU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=RU(t),i=RU(e),o=0,s=1;s<n;++o,++s)this._context.bezierCurveTo(r[0][o],i[0][o],r[1][o],i[1][o],t[s],e[s]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},PU.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};const jU=Math.PI,UU=2*jU,VU=1e-6,qU=UU-VU;function WU(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}class HU{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?WU:function(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return WU;const n=10**e;return function(t){this._+=t[0];for(let e=1,r=t.length;e<r;++e)this._+=Math.round(arguments[e]*n)/n+t[e]}}(t)}moveTo(t,e){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,e){this._append`L${this._x1=+t},${this._y1=+e}`}quadraticCurveTo(t,e,n,r){this._append`Q${+t},${+e},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(t,e,n,r,i,o){this._append`C${+t},${+e},${+n},${+r},${this._x1=+i},${this._y1=+o}`}arcTo(t,e,n,r,i){if(t=+t,e=+e,n=+n,r=+r,(i=+i)<0)throw new Error(`negative radius: ${i}`);let o=this._x1,s=this._y1,a=n-t,l=r-e,u=o-t,c=s-e,h=u*u+c*c;if(null===this._x1)this._append`M${this._x1=t},${this._y1=e}`;else if(h>VU)if(Math.abs(c*a-l*u)>VU&&i){let f=n-o,d=r-s,p=a*a+l*l,m=f*f+d*d,g=Math.sqrt(p),y=Math.sqrt(h),b=i*Math.tan((jU-Math.acos((p+h-m)/(2*g*y)))/2),v=b/y,w=b/g;Math.abs(v-1)>VU&&this._append`L${t+v*u},${e+v*c}`,this._append`A${i},${i},0,0,${+(c*f>u*d)},${this._x1=t+w*a},${this._y1=e+w*l}`}else this._append`L${this._x1=t},${this._y1=e}`}arc(t,e,n,r,i,o){if(t=+t,e=+e,o=!!o,(n=+n)<0)throw new Error(`negative radius: ${n}`);let s=n*Math.cos(r),a=n*Math.sin(r),l=t+s,u=e+a,c=1^o,h=o?r-i:i-r;null===this._x1?this._append`M${l},${u}`:(Math.abs(this._x1-l)>VU||Math.abs(this._y1-u)>VU)&&this._append`L${l},${u}`,n&&(h<0&&(h=h%UU+UU),h>qU?this._append`A${n},${n},0,1,${c},${t-s},${e-a}A${n},${n},0,1,${c},${this._x1=l},${this._y1=u}`:h>VU&&this._append`A${n},${n},0,${+(h>=jU)},${c},${this._x1=t+n*Math.cos(i)},${this._y1=e+n*Math.sin(i)}`)}rect(t,e,n,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}}function GU(){return new HU}function YU(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(null==n)e=null;else{const t=Math.floor(n);if(!(t>=0))throw new RangeError(`invalid digits: ${n}`);e=t}return t},()=>new HU(e)}function XU(t){return t.innerRadius}function JU(t){return t.outerRadius}function KU(t){return t.startAngle}function QU(t){return t.endAngle}function ZU(t){return t&&t.padAngle}function tV(t,e,n,r,i,o,s){var a=t-n,l=e-r,u=(s?o:-o)/pU(a*a+l*l),c=u*l,h=-u*a,f=t+c,d=e+h,p=n+c,m=r+h,g=(f+p)/2,y=(d+m)/2,b=p-f,v=m-d,w=b*b+v*v,x=i-o,_=f*m-p*d,k=(v<0?-1:1)*pU(hU(0,x*x*w-_*_)),S=(_*v-b*k)/w,E=(-_*b-v*k)/w,A=(_*v+b*k)/w,C=(-_*b+v*k)/w,D=S-g,M=E-y,O=A-g,T=C-y;return D*D+M*M>O*O+T*T&&(S=A,E=C),{cx:S,cy:E,x01:-c,y01:-h,x11:S*(i/x-1),y11:E*(i/x-1)}}function eV(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function nV(t){return t[0]}function rV(t){return t[1]}function iV(t,e){var n=zU(!0),r=null,i=DU,o=null,s=YU(a);function a(a){var l,u,c,h=(a=eV(a)).length,f=!1;for(null==r&&(o=i(c=s())),l=0;l<=h;++l)!(l<h&&n(u=a[l],l,a))===f&&((f=!f)?o.lineStart():o.lineEnd()),f&&o.point(+t(u,l,a),+e(u,l,a));if(c)return o=null,c+""||null}return t="function"==typeof t?t:void 0===t?nV:zU(t),e="function"==typeof e?e:void 0===e?rV:zU(e),a.x=function(e){return arguments.length?(t="function"==typeof e?e:zU(+e),a):t},a.y=function(t){return arguments.length?(e="function"==typeof t?t:zU(+t),a):e},a.defined=function(t){return arguments.length?(n="function"==typeof t?t:zU(!!t),a):n},a.curve=function(t){return arguments.length?(i=t,null!=r&&(o=i(r)),a):i},a.context=function(t){return arguments.length?(null==t?r=o=null:o=i(r=t),a):r},a}function oV(t,e,n){var r=null,i=zU(!0),o=null,s=DU,a=null,l=YU(u);function u(u){var c,h,f,d,p,m=(u=eV(u)).length,g=!1,y=new Array(m),b=new Array(m);for(null==o&&(a=s(p=l())),c=0;c<=m;++c){if(!(c<m&&i(d=u[c],c,u))===g)if(g=!g)h=c,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),f=c-1;f>=h;--f)a.point(y[f],b[f]);a.lineEnd(),a.areaEnd()}g&&(y[c]=+t(d,c,u),b[c]=+e(d,c,u),a.point(r?+r(d,c,u):y[c],n?+n(d,c,u):b[c]))}if(p)return a=null,p+""||null}function c(){return iV().defined(i).curve(s).context(o)}return t="function"==typeof t?t:void 0===t?nV:zU(+t),e="function"==typeof e?e:zU(void 0===e?0:+e),n="function"==typeof n?n:void 0===n?rV:zU(+n),u.x=function(e){return arguments.length?(t="function"==typeof e?e:zU(+e),r=null,u):t},u.x0=function(e){return arguments.length?(t="function"==typeof e?e:zU(+e),u):t},u.x1=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:zU(+t),u):r},u.y=function(t){return arguments.length?(e="function"==typeof t?t:zU(+t),n=null,u):e},u.y0=function(t){return arguments.length?(e="function"==typeof t?t:zU(+t),u):e},u.y1=function(t){return arguments.length?(n=null==t?null:"function"==typeof t?t:zU(+t),u):n},u.lineX0=u.lineY0=function(){return c().x(t).y(e)},u.lineY1=function(){return c().x(t).y(n)},u.lineX1=function(){return c().x(r).y(e)},u.defined=function(t){return arguments.length?(i="function"==typeof t?t:zU(!!t),u):i},u.curve=function(t){return arguments.length?(s=t,null!=o&&(a=s(o)),u):s},u.context=function(t){return arguments.length?(null==t?o=a=null:a=s(o=t),u):o},u}GU.prototype=HU.prototype,Array.prototype.slice,pU(3);const sV={draw(t,e){const n=pU(e/gU);t.moveTo(n,0),t.arc(0,0,n,0,bU)}};pU(1/3),dU(gU/10),dU(7*gU/10);function aV(t,e){if("undefined"!=typeof document&&document.createElement){const n=document.createElement("canvas");if(n&&n.getContext)return n.width=t,n.height=e,n}return null}dU(bU/10),cU(bU/10),pU(3),pU(3),pU(3),pU(12);const lV=()=>"undefined"!=typeof Image?Image:null;function uV(t,e){var n,r=0,i=(t=t.slice()).length-1,o=t[r],s=t[i];return s<o&&(n=r,r=i,i=n,n=o,o=s,s=n),t[r]=e.floor(o),t[i]=e.ceil(s),t}function cV(t){return Math.log(t)}function hV(t){return Math.exp(t)}function fV(t){return-Math.log(-t)}function dV(t){return-Math.exp(-t)}function pV(t){return isFinite(t)?+("1e"+t):t<0?0:t}function mV(t){return(e,n)=>-t(-e,n)}function gV(t){const e=t(cV,hV),n=e.domain;let r,i,o=10;function s(){return r=function(t){return t===Math.E?Math.log:10===t&&Math.log10||2===t&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}(o),i=function(t){return 10===t?pV:t===Math.E?Math.exp:e=>Math.pow(t,e)}(o),n()[0]<0?(r=mV(r),i=mV(i),t(fV,dV)):t(cV,hV),e}return e.base=function(t){return arguments.length?(o=+t,s()):o},e.domain=function(t){return arguments.length?(n(t),s()):n()},e.ticks=t=>{const e=n();let s=e[0],a=e[e.length-1];const l=a<s;l&&([s,a]=[a,s]);let u,c,h=r(s),f=r(a);const d=null==t?10:+t;let p=[];if(!(o%1)&&f-h<d){if(h=Math.floor(h),f=Math.ceil(f),s>0){for(;h<=f;++h)for(u=1;u<o;++u)if(c=h<0?u/i(-h):u*i(h),!(c<s)){if(c>a)break;p.push(c)}}else for(;h<=f;++h)for(u=o-1;u>=1;--u)if(c=h>0?u/i(-h):u*i(h),!(c<s)){if(c>a)break;p.push(c)}2*p.length<d&&(p=IM(s,a,d))}else p=IM(h,f,Math.min(f-h,d)).map(i);return l?p.reverse():p},e.tickFormat=(t,n)=>{if(null==t&&(t=10),null==n&&(n=10===o?"s":","),"function"!=typeof n&&(o%1||null!=(n=yM(n)).precision||(n.trim=!0),n=kM(n)),t===1/0)return n;const s=Math.max(1,o*t/e.ticks().length);return t=>{let e=t/i(Math.round(r(t)));return e*o<o-.5&&(e*=o),e<=s?n(t):""}},e.nice=()=>n(uV(n(),{floor:t=>i(Math.floor(r(t))),ceil:t=>i(Math.ceil(r(t)))})),e}function yV(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function bV(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function vV(t){return t<0?-t*t:t*t}function wV(t){var e=t(tO,tO),n=1;return e.exponent=function(e){return arguments.length?1==(n=+e)?t(tO,tO):.5===n?t(bV,vV):t(yV(n),yV(1/n)):n},dO(e)}function xV(){var t=wV(oO());return t.copy=function(){return iO(t,xV()).exponent(t.exponent())},aO.apply(t,arguments),t}function _V(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function kV(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function SV(t){var e=1,n=t(_V(e),kV(e));return n.constant=function(n){return arguments.length?t(_V(e=+n),kV(e)):e},dO(n)}function EV(t,e,n,r,i,o){const s=[[$L,1,bO],[$L,5,5e3],[$L,15,15e3],[$L,30,3e4],[o,1,vO],[o,5,3e5],[o,15,9e5],[o,30,18e5],[i,1,wO],[i,3,108e5],[i,6,216e5],[i,12,432e5],[r,1,xO],[r,2,1728e5],[n,1,_O],[e,1,2592e6],[e,3,7776e6],[t,1,kO]];function a(e,n,r){const i=Math.abs(n-e)/r,o=BM((([,,t])=>t)).right(s,i);if(o===s.length)return t.every($M(e/kO,n/kO,r));if(0===o)return FL.every(Math.max($M(e,n,r),1));const[a,l]=s[i/s[o-1][2]<s[o][2]/i?o-1:o];return a.every(l)}return[function(t,e,n){const r=e<t;r&&([t,e]=[e,t]);const i=n&&"function"==typeof n.range?n:a(t,e,n),o=i?i.range(t,+e+1):[];return r?o.reverse():o},a]}const[AV,CV]=EV(qO,ML,NO,UO,TL,NL),[DV,MV]=EV(VO,DL,EO,zO,OL,IL);function OV(t){return new Date(t)}function TV(t){return t instanceof Date?+t:+new Date(+t)}function IV(t,e,n,r,i,o,s,a,l,u){var c=sO(),h=c.invert,f=c.domain,d=u(".%L"),p=u(":%S"),m=u("%I:%M"),g=u("%I %p"),y=u("%a %d"),b=u("%b %d"),v=u("%B"),w=u("%Y");function x(t){return(l(t)<t?d:a(t)<t?p:s(t)<t?m:o(t)<t?g:r(t)<t?i(t)<t?y:b:n(t)<t?v:w)(t)}return c.invert=function(t){return new Date(h(t))},c.domain=function(t){return arguments.length?f(Array.from(t,TV)):f().map(OV)},c.ticks=function(e){var n=f();return t(n[0],n[n.length-1],null==e?10:e)},c.tickFormat=function(t,e){return null==e?x:u(e)},c.nice=function(t){var n=f();return t&&"function"==typeof t.range||(t=e(n[0],n[n.length-1],null==t?10:t)),t?f(uV(n,t)):c},c.copy=function(){return iO(c,IV(t,e,n,r,i,o,s,a,l,u))},c}function NV(){var t,e,n,r,i,o=0,s=1,a=tO,l=!1;function u(e){return null==e||isNaN(e=+e)?i:a(0===n?.5:(e=(r(e)-t)*n,l?Math.max(0,Math.min(1,e)):e))}function c(t){return function(e){var n,r;return arguments.length?([n,r]=e,a=t(n,r),u):[a(0),a(1)]}}return u.domain=function(i){return arguments.length?([o,s]=i,t=r(o=+o),e=r(s=+s),n=t===e?0:1/(e-t),u):[o,s]},u.clamp=function(t){return arguments.length?(l=!!t,u):l},u.interpolator=function(t){return arguments.length?(a=t,u):a},u.range=c(JM),u.rangeRound=c(KM),u.unknown=function(t){return arguments.length?(i=t,u):i},function(i){return r=i,t=i(o),e=i(s),n=t===e?0:1/(e-t),u}}function $V(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function FV(){var t=dO(NV()(tO));return t.copy=function(){return $V(t,FV())},lO.apply(t,arguments)}function LV(){var t=wV(NV());return t.copy=function(){return $V(t,LV()).exponent(t.exponent())},lO.apply(t,arguments)}function BV(t,e){void 0===e&&(e=t,t=JM);for(var n=0,r=e.length-1,i=e[0],o=new Array(r<0?0:r);n<r;)o[n]=t(i,i=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return o[e](t-e)}}function RV(){var t,e,n,r,i,o,s,a=0,l=.5,u=1,c=1,h=tO,f=!1;function d(t){return isNaN(t=+t)?s:(t=.5+((t=+o(t))-e)*(c*t<c*e?r:i),h(f?Math.max(0,Math.min(1,t)):t))}function p(t){return function(e){var n,r,i;return arguments.length?([n,r,i]=e,h=BV(t,[n,r,i]),d):[h(0),h(.5),h(1)]}}return d.domain=function(s){return arguments.length?([a,l,u]=s,t=o(a=+a),e=o(l=+l),n=o(u=+u),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),c=e<t?-1:1,d):[a,l,u]},d.clamp=function(t){return arguments.length?(f=!!t,d):f},d.interpolator=function(t){return arguments.length?(h=t,d):h},d.range=p(JM),d.rangeRound=p(KM),d.unknown=function(t){return arguments.length?(s=t,d):s},function(s){return o=s,t=s(a),e=s(l),n=s(u),r=t===e?0:.5/(e-t),i=e===n?0:.5/(n-e),c=e<t?-1:1,d}}function PV(){var t=wV(RV());return t.copy=function(){return $V(t,PV()).exponent(t.exponent())},lO.apply(t,arguments)}class zV extends Map{constructor(t,e=WV){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const[e,n]of t)this.set(e,n)}get(t){return super.get(UV(this,t))}has(t){return super.has(UV(this,t))}set(t,e){return super.set(VV(this,t),e)}delete(t){return super.delete(qV(this,t))}}class jV extends Set{constructor(t,e=WV){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const e of t)this.add(e)}has(t){return super.has(UV(this,t))}add(t){return super.add(VV(this,t))}delete(t){return super.delete(qV(this,t))}}function UV({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function VV({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function qV({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function WV(t){return null!==t&&"object"==typeof t?t.valueOf():t}const HV=Symbol("implicit");function GV(){var t=new zV,e=[],n=[],r=HV;function i(i){let o=t.get(i);if(void 0===o){if(r!==HV)return r;t.set(i,o=e.push(i)-1)}return n[o%n.length]}return i.domain=function(n){if(!arguments.length)return e.slice();e=[],t=new zV;for(const r of n)t.has(r)||t.set(r,e.push(r)-1);return i},i.range=function(t){return arguments.length?(n=Array.from(t),i):n.slice()},i.unknown=function(t){return arguments.length?(r=t,i):r},i.copy=function(){return GV(e,n).unknown(r)},aO.apply(i,arguments),i}function YV(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function XV(t,e){var n=ND(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}}function JV(t){return((t=Math.exp(t))+1/t)/2}const KV=function t(e,n,r){function i(t,i){var o,s,a=t[0],l=t[1],u=t[2],c=i[0],h=i[1],f=i[2],d=c-a,p=h-l,m=d*d+p*p;if(m<1e-12)s=Math.log(f/u)/e,o=function(t){return[a+t*d,l+t*p,u*Math.exp(e*t*s)]};else{var g=Math.sqrt(m),y=(f*f-u*u+r*m)/(2*u*n*g),b=(f*f-u*u-r*m)/(2*f*n*g),v=Math.log(Math.sqrt(y*y+1)-y),w=Math.log(Math.sqrt(b*b+1)-b);s=(w-v)/e,o=function(t){var r=t*s,i=JV(v),o=u/(n*g)*(i*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(e*r+v)-function(t){return((t=Math.exp(t))-1/t)/2}(v));return[a+o*d,l+o*p,u*i/JV(e*r+v)]}}return o.duration=1e3*s*e/Math.SQRT2,o}return i.rho=function(e){var n=Math.max(.001,+e),r=n*n;return t(n,r,r*r)},i}(Math.SQRT2,2,4);function QV(t){return function(e,n){var r=t((e=kD(e)).h,(n=kD(n)).h),i=$D(e.s,n.s),o=$D(e.l,n.l),s=$D(e.opacity,n.opacity);return function(t){return e.h=r(t),e.s=i(t),e.l=o(t),e.opacity=s(t),e+""}}}const ZV=QV(ND);var tq=QV($D);const eq=Math.PI/180,nq=180/Math.PI,rq=.96422,iq=1,oq=.82521,sq=4/29,aq=6/29,lq=3*aq*aq,uq=.008856451679035631;function cq(t){if(t instanceof fq)return new fq(t.l,t.a,t.b,t.opacity);if(t instanceof bq)return vq(t);t instanceof mD||(t=dD(t));var e,n,r=gq(t.r),i=gq(t.g),o=gq(t.b),s=dq((.2225045*r+.7168786*i+.0606169*o)/iq);return r===i&&i===o?e=n=s:(e=dq((.4360747*r+.3850649*i+.1430804*o)/rq),n=dq((.0139322*r+.0971045*i+.7141733*o)/oq)),new fq(116*s-16,500*(e-s),200*(s-n),t.opacity)}function hq(t,e,n,r){return 1===arguments.length?cq(t):new fq(t,e,n,null==r?1:r)}function fq(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function dq(t){return t>uq?Math.pow(t,1/3):t/lq+sq}function pq(t){return t>aq?t*t*t:lq*(t-sq)}function mq(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function gq(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function yq(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof bq)return new bq(t.h,t.c,t.l,t.opacity);if(t instanceof fq||(t=cq(t)),0===t.a&&0===t.b)return new bq(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*nq;return new bq(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}(t):new bq(t,e,n,null==r?1:r)}function bq(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function vq(t){if(isNaN(t.h))return new fq(t.l,0,0,t.opacity);var e=t.h*eq;return new fq(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}function wq(t,e){var n=$D((t=hq(t)).l,(e=hq(e)).l),r=$D(t.a,e.a),i=$D(t.b,e.b),o=$D(t.opacity,e.opacity);return function(e){return t.l=n(e),t.a=r(e),t.b=i(e),t.opacity=o(e),t+""}}function xq(t){return function(e,n){var r=t((e=yq(e)).h,(n=yq(n)).h),i=$D(e.c,n.c),o=$D(e.l,n.l),s=$D(e.opacity,n.opacity);return function(t){return e.h=r(t),e.c=i(t),e.l=o(t),e.opacity=s(t),e+""}}}HC(fq,hq,GC(YC,{brighter(t){return new fq(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker(t){return new fq(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new mD(mq(3.1338561*(e=rq*pq(e))-1.6168667*(t=iq*pq(t))-.4906146*(n=oq*pq(n))),mq(-.9787684*e+1.9161415*t+.033454*n),mq(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),HC(bq,yq,GC(YC,{brighter(t){return new bq(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker(t){return new bq(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb(){return vq(this).rgb()}}));const _q=xq(ND);var kq=xq($D),Sq=-.14861,Eq=1.78277,Aq=-.29227,Cq=-.90649,Dq=1.97294,Mq=Dq*Cq,Oq=Dq*Eq,Tq=Eq*Aq-Cq*Sq;function Iq(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof Nq)return new Nq(t.h,t.s,t.l,t.opacity);t instanceof mD||(t=dD(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(Tq*r+Mq*e-Oq*n)/(Tq+Mq-Oq),o=r-i,s=(Dq*(n-i)-Aq*o)/Cq,a=Math.sqrt(s*s+o*o)/(Dq*i*(1-i)),l=a?Math.atan2(s,o)*nq-120:NaN;return new Nq(l<0?l+360:l,a,i,t.opacity)}(t):new Nq(t,e,n,null==r?1:r)}function Nq(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function $q(t){return function e(n){function r(e,r){var i=t((e=Iq(e)).h,(r=Iq(r)).h),o=$D(e.s,r.s),s=$D(e.l,r.l),a=$D(e.opacity,r.opacity);return function(t){return e.h=i(t),e.s=o(t),e.l=s(Math.pow(t,n)),e.opacity=a(t),e+""}}return n=+n,r.gamma=e,r}(1)}HC(Nq,Iq,GC(YC,{brighter(t){return t=null==t?JC:Math.pow(JC,t),new Nq(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?XC:Math.pow(XC,t),new Nq(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*eq,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new mD(255*(e+n*(Sq*r+Eq*i)),255*(e+n*(Aq*r+Cq*i)),255*(e+n*(Dq*r)),this.opacity)}}));const Fq=$q(ND);var Lq=$q($D);function Bq(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}function Rq(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}const Pq=Rq("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),zq=Rq("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),jq=Rq("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),Uq=Rq("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),Vq=Rq("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),qq=Rq("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),Wq=Rq("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),Hq=Rq("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),Gq=Rq("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),Yq=Rq("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f");function Xq(t,e,n){const r=t-e+2*n;return t?r>0?r:1:0}const Jq="linear",Kq="log",Qq="pow",Zq="sqrt",tW="symlog",eW="time",nW="utc",rW="sequential",iW="diverging",oW="quantile",sW="quantize",aW="threshold",lW="ordinal",uW="point",cW="band",hW="bin-ordinal",fW="continuous",dW="discrete",pW="discretizing",mW="interpolating",gW="temporal";function yW(){const t=GV().unknown(void 0),e=t.domain,n=t.range;let r,i,o=[0,1],s=!1,a=0,l=0,u=.5;function c(){const t=e().length,c=o[1]<o[0],h=o[1-c],f=Xq(t,a,l);let d=o[c-0];r=(h-d)/(f||1),s&&(r=Math.floor(r)),d+=(h-d-r*(t-a))*u,i=r*(1-a),s&&(d=Math.round(d),i=Math.round(i));const p=xz(t).map((t=>d+r*t));return n(c?p.reverse():p)}return delete t.unknown,t.domain=function(t){return arguments.length?(e(t),c()):e()},t.range=function(t){return arguments.length?(o=[+t[0],+t[1]],c()):o.slice()},t.rangeRound=function(t){return o=[+t[0],+t[1]],s=!0,c()},t.bandwidth=function(){return i},t.step=function(){return r},t.round=function(t){return arguments.length?(s=!!t,c()):s},t.padding=function(t){return arguments.length?(l=Math.max(0,Math.min(1,t)),a=l,c()):a},t.paddingInner=function(t){return arguments.length?(a=Math.max(0,Math.min(1,t)),c()):a},t.paddingOuter=function(t){return arguments.length?(l=Math.max(0,Math.min(1,t)),c()):l},t.align=function(t){return arguments.length?(u=Math.max(0,Math.min(1,t)),c()):u},t.invertRange=function(t){if(null==t[0]||null==t[1])return;const r=o[1]<o[0],s=r?n().reverse():n(),a=s.length-1;let l,u,c,h=+t[0],f=+t[1];return h!=h||f!=f||(f<h&&(c=h,h=f,f=c),f<s[0]||h>o[1-r])?void 0:(l=Math.max(0,jM(s,h)-1),u=h===f?l:jM(s,f)-1,h-s[l]>i+1e-10&&++l,r&&(c=l,l=a-u,u=a-c),l>u?void 0:e().slice(l,u+1))},t.invert=function(e){const n=t.invertRange([e,e]);return n?n[0]:n},t.copy=function(){return yW().domain(e()).range(o).round(s).paddingInner(a).paddingOuter(l).align(u)},c()}function bW(t){const e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,t.copy=function(){return bW(e())},t}var vW=Array.prototype.map;const wW=Array.prototype.slice,xW=new Map,_W=Symbol("vega_scale");function kW(t){return t[_W]=!0,t}function SW(t,e,n){return arguments.length>1?(xW.set(t,function(t,e,n){const r=function(){const n=e();return n.invertRange||(n.invertRange=n.invert?function(t){return function(e){let n,r=e[0],i=e[1];return i<r&&(n=r,r=i,i=n),[t.invert(r),t.invert(i)]}}(n):n.invertExtent?function(t){return function(e){const n=t.range();let r,i,o,s,a=e[0],l=e[1],u=-1;for(l<a&&(i=a,a=l,l=i),o=0,s=n.length;o<s;++o)n[o]>=a&&n[o]<=l&&(u<0&&(u=o),r=o);if(!(u<0))return a=t.invertExtent(n[u]),l=t.invertExtent(n[r]),[void 0===a[0]?a[1]:a[0],void 0===l[1]?l[0]:l[1]]}}(n):void 0),n.type=t,kW(n)};return r.metadata=uL(kF(n)),r}(t,e,n)),this):EW(t)?xW.get(t):void 0}function EW(t){return xW.has(t)}function AW(t,e){const n=xW.get(t);return n&&n.metadata[e]}function CW(t){return AW(t,fW)}function DW(t){return AW(t,dW)}function MW(t){return AW(t,pW)}function OW(t){return AW(t,Kq)}function TW(t){return AW(t,mW)}function IW(t){return AW(t,oW)}SW("identity",(function t(e){var n;function r(t){return null==t||isNaN(t=+t)?n:t}return r.invert=r,r.domain=r.range=function(t){return arguments.length?(e=Array.from(t,QM),r):e.slice()},r.unknown=function(t){return arguments.length?(n=t,r):n},r.copy=function(){return t(e).unknown(n)},e=arguments.length?Array.from(e,QM):[0,1],dO(r)})),SW(Jq,pO,fW),SW(Kq,(function t(){const e=gV(oO()).domain([1,10]);return e.copy=()=>iO(e,t()).base(e.base()),aO.apply(e,arguments),e}),[fW,Kq]),SW(Qq,xV,fW),SW(Zq,(function(){return xV.apply(null,arguments).exponent(.5)}),fW),SW(tW,(function t(){var e=SV(oO());return e.copy=function(){return iO(e,t()).constant(e.constant())},aO.apply(e,arguments)}),fW),SW(eW,(function(){return aO.apply(IV(DV,MV,VO,DL,EO,zO,OL,IL,$L,JO).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}),[fW,gW]),SW(nW,(function(){return aO.apply(IV(AV,CV,qO,ML,NO,jO,TL,NL,$L,QO).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}),[fW,gW]),SW(rW,FV,[fW,mW]),SW(`${rW}-${Jq}`,FV,[fW,mW]),SW(`${rW}-${Kq}`,(function t(){var e=gV(NV()).domain([1,10]);return e.copy=function(){return $V(e,t()).base(e.base())},lO.apply(e,arguments)}),[fW,mW,Kq]),SW(`${rW}-${Qq}`,LV,[fW,mW]),SW(`${rW}-${Zq}`,(function(){return LV.apply(null,arguments).exponent(.5)}),[fW,mW]),SW(`${rW}-${tW}`,(function t(){var e=SV(NV());return e.copy=function(){return $V(e,t()).constant(e.constant())},lO.apply(e,arguments)}),[fW,mW]),SW(`${iW}-${Jq}`,(function t(){var e=dO(RV()(tO));return e.copy=function(){return $V(e,t())},lO.apply(e,arguments)}),[fW,mW]),SW(`${iW}-${Kq}`,(function t(){var e=gV(RV()).domain([.1,1,10]);return e.copy=function(){return $V(e,t()).base(e.base())},lO.apply(e,arguments)}),[fW,mW,Kq]),SW(`${iW}-${Qq}`,PV,[fW,mW]),SW(`${iW}-${Zq}`,(function(){return PV.apply(null,arguments).exponent(.5)}),[fW,mW]),SW(`${iW}-${tW}`,(function t(){var e=SV(RV());return e.copy=function(){return $V(e,t()).constant(e.constant())},lO.apply(e,arguments)}),[fW,mW]),SW(oW,(function t(){var e,n=[],r=[],i=[];function o(){var t=0,e=Math.max(1,r.length);for(i=new Array(e-1);++t<e;)i[t-1]=_P(n,t/e);return s}function s(t){return null==t||isNaN(t=+t)?e:r[VM(i,t)]}return s.invertExtent=function(t){var e=r.indexOf(t);return e<0?[NaN,NaN]:[e>0?i[e-1]:n[0],e<i.length?i[e]:n[n.length-1]]},s.domain=function(t){if(!arguments.length)return n.slice();n=[];for(let e of t)null==e||isNaN(e=+e)||n.push(e);return n.sort(FM),o()},s.range=function(t){return arguments.length?(r=Array.from(t),o()):r.slice()},s.unknown=function(t){return arguments.length?(e=t,s):e},s.quantiles=function(){return i.slice()},s.copy=function(){return t().domain(n).range(r).unknown(e)},aO.apply(s,arguments)}),[pW,oW]),SW(sW,(function t(){var e,n=0,r=1,i=1,o=[.5],s=[0,1];function a(t){return null!=t&&t<=t?s[VM(o,t,0,i)]:e}function l(){var t=-1;for(o=new Array(i);++t<i;)o[t]=((t+1)*r-(t-i)*n)/(i+1);return a}return a.domain=function(t){return arguments.length?([n,r]=t,n=+n,r=+r,l()):[n,r]},a.range=function(t){return arguments.length?(i=(s=Array.from(t)).length-1,l()):s.slice()},a.invertExtent=function(t){var e=s.indexOf(t);return e<0?[NaN,NaN]:e<1?[n,o[0]]:e>=i?[o[i-1],r]:[o[e-1],o[e]]},a.unknown=function(t){return arguments.length?(e=t,a):a},a.thresholds=function(){return o.slice()},a.copy=function(){return t().domain([n,r]).range(s).unknown(e)},aO.apply(dO(a),arguments)}),pW),SW(aW,(function t(){var e,n=[.5],r=[0,1],i=1;function o(t){return null!=t&&t<=t?r[VM(n,t,0,i)]:e}return o.domain=function(t){return arguments.length?(n=Array.from(t),i=Math.min(n.length,r.length-1),o):n.slice()},o.range=function(t){return arguments.length?(r=Array.from(t),i=Math.min(n.length,r.length-1),o):r.slice()},o.invertExtent=function(t){var e=r.indexOf(t);return[n[e-1],n[e]]},o.unknown=function(t){return arguments.length?(e=t,o):e},o.copy=function(){return t().domain(n).range(r).unknown(e)},aO.apply(o,arguments)}),pW),SW(hW,(function t(){let e=[],n=[];function r(t){return null==t||t!=t?void 0:n[(VM(e,t)-1)%n.length]}return r.domain=function(t){return arguments.length?(e=function(t){return vW.call(t,oF)}(t),r):e.slice()},r.range=function(t){return arguments.length?(n=wW.call(t),r):n.slice()},r.tickFormat=function(t,n){return fO(e[0],iF(e),null==t?10:t,n)},r.copy=function(){return t().domain(r.domain()).range(r.range())},r}),[dW,pW]),SW(lW,GV,dW),SW(cW,yW,dW),SW(uW,(function(){return bW(yW().paddingInner(1))}),dW);const NW=["clamp","base","constant","exponent"];function $W(t,e){const n=e[0],r=iF(e)-n;return function(e){return t(n+e*r)}}function FW(t,e,n){return BV(RW(e||"rgb",n),t)}function LW(t,e){const n=new Array(e),r=e+1;for(let i=0;i<e;)n[i]=t(++i/r);return n}function BW(t,e,n){const r=n-e;let i,o,s;return r&&Number.isFinite(r)?(i=(o=t.type).indexOf("-"),o=i<0?o:o.slice(i+1),s=SW(o)().domain([e,n]).range([0,1]),NW.forEach((e=>t[e]?s[e](t[e]()):0)),s):IF(.5)}function RW(t,e){const n=i[function(t){return"interpolate"+t.toLowerCase().split("-").map((t=>t[0].toUpperCase()+t.slice(1))).join("")}(t)];return null!=e&&n&&n.gamma?n.gamma(e):n}function PW(t){if(Q$(t))return t;const e=t.length/6|0,n=new Array(e);for(let r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}function zW(t,e){for(const n in t)UW(n,e(t[n]))}const jW={};function UW(t,e){return t=t&&t.toLowerCase(),arguments.length>1?(jW[t]=e,this):jW[t]}zW({accent:Pq,category10:zq,category20:"1f77b4aec7e8ff7f0effbb782ca02c98df8ad62728ff98969467bdc5b0d58c564bc49c94e377c2f7b6d27f7f7fc7c7c7bcbd22dbdb8d17becf9edae5",category20b:"393b795254a36b6ecf9c9ede6379398ca252b5cf6bcedb9c8c6d31bd9e39e7ba52e7cb94843c39ad494ad6616be7969c7b4173a55194ce6dbdde9ed6",category20c:"3182bd6baed69ecae1c6dbefe6550dfd8d3cfdae6bfdd0a231a35474c476a1d99bc7e9c0756bb19e9ac8bcbddcdadaeb636363969696bdbdbdd9d9d9",dark2:jq,observable10:Uq,paired:Vq,pastel1:qq,pastel2:Wq,set1:Hq,set2:Gq,set3:Yq,tableau10:"4c78a8f58518e4575672b7b254a24beeca3bb279a2ff9da69d755dbab0ac",tableau20:"4c78a89ecae9f58518ffbf7954a24b88d27ab79a20f2cf5b43989483bcb6e45756ff9d9879706ebab0acd67195fcbfd2b279a2d6a5c99e765fd8b5a5"},PW),zW({blues:"cfe1f2bed8eca8cee58fc1de74b2d75ba3cf4592c63181bd206fb2125ca40a4a90",greens:"d3eecdc0e6baabdda594d3917bc77d60ba6c46ab5e329a512089430e7735036429",greys:"e2e2e2d4d4d4c4c4c4b1b1b19d9d9d8888887575756262624d4d4d3535351e1e1e",oranges:"fdd8b3fdc998fdb87bfda55efc9244f87f2cf06b18e4580bd14904b93d029f3303",purples:"e2e1efd4d4e8c4c5e0b4b3d6a3a0cc928ec3827cb97566ae684ea25c3696501f8c",reds:"fdc9b4fcb49afc9e80fc8767fa7051f6573fec3f2fdc2a25c81b1db21218970b13",blueGreen:"d5efedc1e8e0a7ddd18bd2be70c6a958ba9144ad77319c5d2089460e7736036429",bluePurple:"ccddecbad0e4a8c2dd9ab0d4919cc98d85be8b6db28a55a6873c99822287730f71",greenBlue:"d3eecec5e8c3b1e1bb9bd8bb82cec269c2ca51b2cd3c9fc7288abd1675b10b60a1",orangeRed:"fddcaffdcf9bfdc18afdad77fb9562f67d53ee6545e24932d32d1ebf130da70403",purpleBlue:"dbdaebc8cee4b1c3de97b7d87bacd15b9fc93a90c01e7fb70b70ab056199045281",purpleBlueGreen:"dbd8eac8cee4b0c3de93b7d872acd1549fc83892bb1c88a3097f8702736b016353",purpleRed:"dcc9e2d3b3d7ce9eccd186c0da6bb2e14da0e23189d91e6fc61159ab07498f023a",redPurple:"fccfccfcbec0faa9b8f98faff571a5ec539ddb3695c41b8aa908808d0179700174",yellowGreen:"e4f4acd1eca0b9e2949ed68880c97c62bb6e47aa5e3297502083440e723b036034",yellowOrangeBrown:"feeaa1fedd84fecc63feb746fca031f68921eb7215db5e0bc54c05ab3d038f3204",yellowOrangeRed:"fee087fed16ffebd59fea849fd903efc7335f9522bee3423de1b20ca0b22af0225",blueOrange:"134b852f78b35da2cb9dcae1d2e5eff2f0ebfce0bafbbf74e8932fc5690d994a07",brownBlueGreen:"704108a0651ac79548e3c78af3e6c6eef1eac9e9e48ed1c74da79e187a72025147",purpleGreen:"5b1667834792a67fb6c9aed3e6d6e8eff0efd9efd5aedda971bb75368e490e5e29",purpleOrange:"4114696647968f83b7b9b4d6dadbebf3eeeafce0bafbbf74e8932fc5690d994a07",redBlue:"8c0d25bf363adf745ef4ae91fbdbc9f2efeed2e5ef9dcae15da2cb2f78b3134b85",redGrey:"8c0d25bf363adf745ef4ae91fcdccbfaf4f1e2e2e2c0c0c0969696646464343434",yellowGreenBlue:"eff9bddbf1b4bde5b594d5b969c5be45b4c22c9ec02182b82163aa23479c1c3185",redYellowBlue:"a50026d4322cf16e43fcac64fedd90faf8c1dcf1ecabd6e875abd04a74b4313695",redYellowGreen:"a50026d4322cf16e43fcac63fedd8df9f7aed7ee8ea4d86e64bc6122964f006837",pinkYellowGreen:"8e0152c0267edd72adf0b3d6faddedf5f3efe1f2cab6de8780bb474f9125276419",spectral:"9e0142d13c4bf0704afcac63fedd8dfbf8b0e0f3a1a9dda269bda94288b55e4fa2",viridis:"440154470e61481a6c482575472f7d443a834144873d4e8a39568c35608d31688e2d708e2a788e27818e23888e21918d1f988b1fa08822a8842ab07f35b77943bf7154c56866cc5d7ad1518fd744a5db36bcdf27d2e21be9e51afde725",magma:"0000040404130b0924150e3720114b2c11603b0f704a107957157e651a80721f817f24828c29819a2e80a8327db6377ac43c75d1426fde4968e95462f1605df76f5cfa7f5efc8f65fe9f6dfeaf78febf84fece91fddea0fcedaffcfdbf",inferno:"0000040403130c0826170c3b240c4f330a5f420a68500d6c5d126e6b176e781c6d86216b932667a12b62ae305cbb3755c73e4cd24644dd513ae65c30ed6925f3771af8850ffb9506fca50afcb519fac62df6d645f2e661f3f484fcffa4",plasma:"0d088723069033059742039d5002a25d01a66a00a87801a88405a7900da49c179ea72198b12a90ba3488c33d80cb4779d35171da5a69e16462e76e5bed7953f2834cf68f44fa9a3dfca636fdb32ffec029fcce25f9dc24f5ea27f0f921",cividis:"00205100235800265d002961012b65042e670831690d346b11366c16396d1c3c6e213f6e26426e2c456e31476e374a6e3c4d6e42506e47536d4c566d51586e555b6e5a5e6e5e616e62646f66676f6a6a706e6d717270717573727976737c79747f7c75827f758682768985778c8877908b78938e789691789a94789e9778a19b78a59e77a9a177aea575b2a874b6ab73bbaf71c0b26fc5b66dc9b96acebd68d3c065d8c462ddc85fe2cb5ce7cf58ebd355f0d652f3da4ff7de4cfae249fce647",rainbow:"6e40aa883eb1a43db3bf3cafd83fa4ee4395fe4b83ff576eff6659ff7847ff8c38f3a130e2b72fcfcc36bee044aff05b8ff4576ff65b52f6673af27828ea8d1ddfa319d0b81cbecb23abd82f96e03d82e14c6edb5a5dd0664dbf6e40aa",sinebow:"ff4040fc582af47218e78d0bd5a703bfbf00a7d5038de70b72f41858fc2a40ff402afc5818f4720be78d03d5a700bfbf03a7d50b8de71872f42a58fc4040ff582afc7218f48d0be7a703d5bf00bfd503a7e70b8df41872fc2a58ff4040",turbo:"23171b32204a3e2a71453493493eae4b49c54a53d7485ee44569ee4074f53c7ff8378af93295f72e9ff42ba9ef28b3e926bce125c5d925cdcf27d5c629dcbc2de3b232e9a738ee9d3ff39347f68950f9805afc7765fd6e70fe667cfd5e88fc5795fb51a1f84badf545b9f140c5ec3cd0e637dae034e4d931ecd12ef4c92bfac029ffb626ffad24ffa223ff9821ff8d1fff821dff771cfd6c1af76118f05616e84b14df4111d5380fcb2f0dc0260ab61f07ac1805a313029b0f00950c00910b00",browns:"eedbbdecca96e9b97ae4a865dc9856d18954c7784cc0673fb85536ad44339f3632",tealBlues:"bce4d89dd3d181c3cb65b3c245a2b9368fae347da0306a932c5985",teals:"bbdfdfa2d4d58ac9c975bcbb61b0af4da5a43799982b8b8c1e7f7f127273006667",warmGreys:"dcd4d0cec5c1c0b8b4b3aaa7a59c9998908c8b827f7e7673726866665c5a59504e",goldGreen:"f4d166d5ca60b6c35c98bb597cb25760a6564b9c533f8f4f33834a257740146c36",goldOrange:"f4d166f8be5cf8aa4cf5983bf3852aef701be2621fd65322c54923b142239e3a26",goldRed:"f4d166f6be59f9aa51fc964ef6834bee734ae56249db5247cf4244c43141b71d3e",lightGreyRed:"efe9e6e1dad7d5cbc8c8bdb9bbaea9cd967ddc7b43e15f19df4011dc000b",lightGreyTeal:"e4eaead6dcddc8ced2b7c2c7a6b4bc64b0bf22a6c32295c11f85be1876bc",lightMulti:"e0f1f2c4e9d0b0de9fd0e181f6e072f6c053f3993ef77440ef4a3c",lightOrange:"f2e7daf7d5baf9c499fab184fa9c73f68967ef7860e8645bde515bd43d5b",lightTealBlue:"e3e9e0c0dccf9aceca7abfc859afc0389fb9328dad2f7ca0276b95255988",darkBlue:"3232322d46681a5c930074af008cbf05a7ce25c0dd38daed50f3faffffff",darkGold:"3c3c3c584b37725e348c7631ae8b2bcfa424ecc31ef9de30fff184ffffff",darkGreen:"3a3a3a215748006f4d048942489e4276b340a6c63dd2d836ffeb2cffffaa",darkMulti:"3737371f5287197d8c29a86995ce3fffe800ffffff",darkRed:"3434347036339e3c38cc4037e75d1eec8620eeab29f0ce32ffeb2c"},(t=>FW(PW(t))));const VW="symbol",qW="discrete",WW=t=>Q$(t)?t.map((t=>String(t))):String(t),HW=(t,e)=>t[1]-e[1],GW=(t,e)=>e[1]-t[1];function YW(t,e,n){let r;return GF(e)&&(t.bins&&(e=Math.max(e,t.bins.length)),null!=n&&(e=Math.min(e,Math.floor(rL(t.domain())/n||1)+1))),Z$(e)&&(r=e.step,e=e.interval),XF(e)&&(e=t.type===eW?_B(e):t.type==nW?kB(e):L$("Only time and utc scales accept interval strings."),r&&(e=e.every(r))),e}function XW(t,e,n){let r=t.range(),i=r[0],o=iF(r),s=HW;if(i>o&&(r=o,o=i,i=r,s=GW),i=Math.floor(i),o=Math.ceil(o),e=e.map((e=>[e,t(e)])).filter((t=>i<=t[1]&&t[1]<=o)).sort(s).map((t=>t[0])),n>0&&e.length>1){const t=[e[0],iF(e)];for(;e.length>n&&e.length>=3;)e=e.filter(((t,e)=>!(e%2)));e.length<3&&(e=t)}return e}function JW(t,e){return t.bins?XW(t,t.bins,e):t.ticks?t.ticks(e):t.domain()}function KW(t,e,n,r,i,o){const s=e.type;let a=WW;if(s===eW||i===eW)a=t.timeFormat(r);else if(s===nW||i===nW)a=t.utcFormat(r);else if(OW(s)){const i=t.formatFloat(r);if(o||e.bins)a=i;else{const t=QW(e,n,!1);a=e=>t(e)?i(e):""}}else if(e.tickFormat){const i=e.domain();a=t.formatSpan(i[0],i[i.length-1],n,r)}else r&&(a=t.format(r));return a}function QW(t,e,n){const r=JW(t,e),i=t.base(),o=Math.log(i),s=Math.max(1,i*e/r.length),a=t=>{let e=t/Math.pow(i,Math.round(Math.log(t)/o));return e*i<i-.5&&(e*=i),e<=s};return n?r.filter(a):a}const ZW={[oW]:"quantiles",[sW]:"thresholds",[aW]:"domain"},tH={[oW]:"quantiles",[sW]:"domain"};function eH(t,e){return t.bins?function(t){const e=t.slice(0,-1);return e.max=iF(t),e}(t.bins):t.type===Kq?QW(t,e,!0):ZW[t.type]?function(t){const e=[-1/0].concat(t);return e.max=1/0,e}(t[ZW[t.type]]()):JW(t,e)}const nH=t=>ZW[t.type]||t.bins;function rH(t,e,n,r,i,o,s){const a=tH[e.type]&&o!==eW&&o!==nW?function(t,e,n){const r=e[tH[e.type]](),i=r.length;let o,s=i>1?r[1]-r[0]:r[0];for(o=1;o<i;++o)s=Math.min(s,r[o]-r[o-1]);return t.formatSpan(0,s,30,n)}(t,e,i):KW(t,e,n,i,o,s);return r===VW&&nH(e)?iH(a):r===qW?sH(a):aH(a)}const iH=t=>(e,n,r)=>{const i=oH(r[n+1],oH(r.max,1/0)),o=lH(e,t),s=lH(i,t);return o&&s?o+" â€“ "+s:s?"< "+s:"â‰¥ "+o},oH=(t,e)=>null!=t?t:e,sH=t=>(e,n)=>n?t(e):null,aH=t=>e=>t(e),lH=(t,e)=>Number.isFinite(t)?e(t):null;function uH(t,e,n){n=n||{};const r=Math.max(3,n.maxlen||7),i=function(t,e,n,r){const i=r||e.type;return XF(n)&&function(t){return AW(t,gW)}(i)&&(n=n.replace(/%a/g,"%A").replace(/%b/g,"%B")),n||i!==eW?n||i!==nW?rH(t,e,5,null,n,r,!0):t.utcFormat("%A, %d %B %Y, %X UTC"):t.timeFormat("%A, %d %B %Y, %X")}(t,e,n.format,n.formatType);if(MW(e.type)){const t=eH(e).slice(1).map(i),n=t.length;return`${n} boundar${1===n?"y":"ies"}: ${t.join(", ")}`}if(DW(e.type)){const t=e.domain(),n=t.length;return`${n} value${1===n?"":"s"}: ${n>r?t.slice(0,r-2).map(i).join(", ")+", ending with "+t.slice(-1).map(i):t.map(i).join(", ")}`}{const t=e.domain();return`values from ${i(t[0])} to ${i(iF(t))}`}}let cH=0;const hH="p_";function fH(t){return t&&t.gradient}function dH(t,e,n){const r=t.gradient;let i=t.id,o="radial"===r?hH:"";return i||(i=t.id="gradient_"+cH++,"radial"===r?(t.x1=pH(t.x1,.5),t.y1=pH(t.y1,.5),t.r1=pH(t.r1,0),t.x2=pH(t.x2,.5),t.y2=pH(t.y2,.5),t.r2=pH(t.r2,.5),o=hH):(t.x1=pH(t.x1,0),t.y1=pH(t.y1,0),t.x2=pH(t.x2,1),t.y2=pH(t.y2,0))),e[i]=t,"url("+(n||"")+"#"+o+i+")"}function pH(t,e){return null!=t?t:e}function mH(t,e){var n,r=[];return n={gradient:"linear",x1:t?t[0]:0,y1:t?t[1]:0,x2:e?e[0]:1,y2:e?e[1]:0,stops:r,stop:function(t,e){return r.push({offset:t,color:e}),n}}}const gH={basis:{curve:function(t){return new Xj(t)}},"basis-closed":{curve:function(t){return new Kj(t)}},"basis-open":{curve:function(t){return new Qj(t)}},bundle:{curve:tU,tension:"beta",value:.85},cardinal:{curve:rU,tension:"tension",value:0},"cardinal-open":{curve:oU,tension:"tension",value:0},"cardinal-closed":{curve:aU,tension:"tension",value:0},"catmull-rom":{curve:_U,tension:"alpha",value:.5},"catmull-rom-closed":{curve:SU,tension:"alpha",value:.5},"catmull-rom-open":{curve:AU,tension:"alpha",value:.5},linear:{curve:DU},"linear-closed":{curve:function(t){return new MU(t)}},monotone:{horizontal:function(t){return new FU(t)},vertical:function(t){return new $U(t)}},natural:{curve:function(t){return new BU(t)}},step:{curve:function(t){return new PU(t,.5)}},"step-after":{curve:function(t){return new PU(t,1)}},"step-before":{curve:function(t){return new PU(t,0)}}};function yH(t,e,n){var r=RF(gH,t)&&gH[t],i=null;return r&&(i=r.curve||r[e||"vertical"],r.tension&&null!=n&&(i=i[r.tension](n))),i}const bH={m:2,l:2,h:1,v:1,z:0,c:6,s:4,q:4,t:2,a:7},vH=/[mlhvzcsqta]([^mlhvzcsqta]+|$)/gi,wH=/^[+-]?(([0-9]*\.[0-9]+)|([0-9]+\.)|([0-9]+))([eE][+-]?[0-9]+)?/,xH=/^((\s+,?\s*)|(,\s*))/,_H=/^[01]/;function kH(t){const e=[];return(t.match(vH)||[]).forEach((t=>{let n=t[0];const r=n.toLowerCase(),i=bH[r],o=function(t,e,n){const r=[];for(let i=0;e&&i<n.length;)for(let o=0;o<e;++o){const e="a"!==t||3!==o&&4!==o?wH:_H,s=n.slice(i).match(e);if(null===s)throw Error("Invalid SVG path, incorrect parameter type");i+=s[0].length,r.push(+s[0]);const a=n.slice(i).match(xH);null!==a&&(i+=a[0].length)}return r}(r,i,t.slice(1).trim()),s=o.length;if(s<i||s&&s%i!=0)throw Error("Invalid SVG path, incorrect parameter count");if(e.push([n,...o.slice(0,i)]),s!==i){"m"===r&&(n="M"===n?"L":"l");for(let t=i;t<s;t+=i)e.push([n,...o.slice(t,t+i)])}})),e}const SH=Math.PI/180,EH=Math.PI/2,AH=2*Math.PI,CH=Math.sqrt(3)/2;var DH={},MH={},OH=[].join;function TH(t){const e=OH.call(t);if(MH[e])return MH[e];var n=t[0],r=t[1],i=t[2],o=t[3],s=t[4],a=t[5],l=t[6],u=t[7];const c=u*s,h=-l*a,f=l*s,d=u*a,p=Math.cos(i),m=Math.sin(i),g=Math.cos(o),y=Math.sin(o),b=.5*(o-i),v=Math.sin(.5*b),w=8/3*v*v/Math.sin(b),x=n+p-w*m,_=r+m+w*p,k=n+g,S=r+y,E=k+w*y,A=S-w*g;return MH[e]=[c*x+h*_,f*x+d*_,c*E+h*A,f*E+d*A,c*k+h*S,f*k+d*S]}const IH=["l",0,0,0,0,0,0,0];function NH(t,e,n){const r=IH[0]=t[0];if("a"===r||"A"===r)IH[1]=e*t[1],IH[2]=n*t[2],IH[3]=t[3],IH[4]=t[4],IH[5]=t[5],IH[6]=e*t[6],IH[7]=n*t[7];else if("h"===r||"H"===r)IH[1]=e*t[1];else if("v"===r||"V"===r)IH[1]=n*t[1];else for(var i=1,o=t.length;i<o;++i)IH[i]=(i%2==1?e:n)*t[i];return IH}function $H(t,e,n,r,i,o){var s,a,l,u,c,h=null,f=0,d=0,p=0,m=0,g=0,y=0;null==n&&(n=0),null==r&&(r=0),null==i&&(i=1),null==o&&(o=i),t.beginPath&&t.beginPath();for(var b=0,v=e.length;b<v;++b){switch(s=e[b],1===i&&1===o||(s=NH(s,i,o)),s[0]){case"l":f+=s[1],d+=s[2],t.lineTo(f+n,d+r);break;case"L":f=s[1],d=s[2],t.lineTo(f+n,d+r);break;case"h":f+=s[1],t.lineTo(f+n,d+r);break;case"H":f=s[1],t.lineTo(f+n,d+r);break;case"v":d+=s[1],t.lineTo(f+n,d+r);break;case"V":d=s[1],t.lineTo(f+n,d+r);break;case"m":g=f+=s[1],y=d+=s[2],t.moveTo(f+n,d+r);break;case"M":g=f=s[1],y=d=s[2],t.moveTo(f+n,d+r);break;case"c":a=f+s[5],l=d+s[6],p=f+s[3],m=d+s[4],t.bezierCurveTo(f+s[1]+n,d+s[2]+r,p+n,m+r,a+n,l+r),f=a,d=l;break;case"C":f=s[5],d=s[6],p=s[3],m=s[4],t.bezierCurveTo(s[1]+n,s[2]+r,p+n,m+r,f+n,d+r);break;case"s":a=f+s[3],l=d+s[4],p=2*f-p,m=2*d-m,t.bezierCurveTo(p+n,m+r,f+s[1]+n,d+s[2]+r,a+n,l+r),p=f+s[1],m=d+s[2],f=a,d=l;break;case"S":a=s[3],l=s[4],p=2*f-p,m=2*d-m,t.bezierCurveTo(p+n,m+r,s[1]+n,s[2]+r,a+n,l+r),f=a,d=l,p=s[1],m=s[2];break;case"q":a=f+s[3],l=d+s[4],p=f+s[1],m=d+s[2],t.quadraticCurveTo(p+n,m+r,a+n,l+r),f=a,d=l;break;case"Q":a=s[3],l=s[4],t.quadraticCurveTo(s[1]+n,s[2]+r,a+n,l+r),f=a,d=l,p=s[1],m=s[2];break;case"t":a=f+s[1],l=d+s[2],null===h[0].match(/[QqTt]/)?(p=f,m=d):"t"===h[0]?(p=2*f-u,m=2*d-c):"q"===h[0]&&(p=2*f-p,m=2*d-m),u=p,c=m,t.quadraticCurveTo(p+n,m+r,a+n,l+r),d=l,p=(f=a)+s[1],m=d+s[2];break;case"T":a=s[1],l=s[2],p=2*f-p,m=2*d-m,t.quadraticCurveTo(p+n,m+r,a+n,l+r),f=a,d=l;break;case"a":FH(t,f+n,d+r,[s[1],s[2],s[3],s[4],s[5],s[6]+f+n,s[7]+d+r]),f+=s[6],d+=s[7];break;case"A":FH(t,f+n,d+r,[s[1],s[2],s[3],s[4],s[5],s[6]+n,s[7]+r]),f=s[6],d=s[7];break;case"z":case"Z":f=g,d=y,t.closePath()}h=s}}function FH(t,e,n,r){const i=function(t,e,n,r,i,o,s,a,l){const u=OH.call(arguments);if(DH[u])return DH[u];const c=s*SH,h=Math.sin(c),f=Math.cos(c),d=f*(a-t)*.5+h*(l-e)*.5,p=f*(l-e)*.5-h*(a-t)*.5;let m=d*d/((n=Math.abs(n))*n)+p*p/((r=Math.abs(r))*r);m>1&&(m=Math.sqrt(m),n*=m,r*=m);const g=f/n,y=h/n,b=-h/r,v=f/r,w=g*a+y*l,x=b*a+v*l,_=g*t+y*e,k=b*t+v*e;let S=1/((_-w)*(_-w)+(k-x)*(k-x))-.25;S<0&&(S=0);let E=Math.sqrt(S);o==i&&(E=-E);const A=.5*(w+_)-E*(k-x),C=.5*(x+k)+E*(_-w),D=Math.atan2(x-C,w-A);let M=Math.atan2(k-C,_-A)-D;M<0&&1===o?M+=AH:M>0&&0===o&&(M-=AH);const O=Math.ceil(Math.abs(M/(EH+.001))),T=[];for(let t=0;t<O;++t){const e=D+t*M/O,i=D+(t+1)*M/O;T[t]=[A,C,e,i,n,r,h,f]}return DH[u]=T}(r[5],r[6],r[0],r[1],r[3],r[4],r[2],e,n);for(let e=0;e<i.length;++e){const n=TH(i[e]);t.bezierCurveTo(n[0],n[1],n[2],n[3],n[4],n[5])}}const LH=.5773502691896257,BH={circle:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(n,0),t.arc(0,0,n,0,AH)}},cross:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/2.5;t.moveTo(-n,-r),t.lineTo(-n,r),t.lineTo(-r,r),t.lineTo(-r,n),t.lineTo(r,n),t.lineTo(r,r),t.lineTo(n,r),t.lineTo(n,-r),t.lineTo(r,-r),t.lineTo(r,-n),t.lineTo(-r,-n),t.lineTo(-r,-r),t.closePath()}},diamond:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.closePath()}},square:{draw:function(t,e){var n=Math.sqrt(e),r=-n/2;t.rect(r,r,n,n)}},arrow:{draw:function(t,e){var n=Math.sqrt(e)/2,r=n/7,i=n/2.5,o=n/8;t.moveTo(-r,n),t.lineTo(r,n),t.lineTo(r,-o),t.lineTo(i,-o),t.lineTo(0,-n),t.lineTo(-i,-o),t.lineTo(-r,-o),t.closePath()}},wedge:{draw:function(t,e){var n=Math.sqrt(e)/2,r=CH*n,i=r-n*LH,o=n/4;t.moveTo(0,-r-i),t.lineTo(-o,r-i),t.lineTo(o,r-i),t.closePath()}},triangle:{draw:function(t,e){var n=Math.sqrt(e)/2,r=CH*n,i=r-n*LH;t.moveTo(0,-r-i),t.lineTo(-n,r-i),t.lineTo(n,r-i),t.closePath()}},"triangle-up":{draw:function(t,e){var n=Math.sqrt(e)/2,r=CH*n;t.moveTo(0,-r),t.lineTo(-n,r),t.lineTo(n,r),t.closePath()}},"triangle-down":{draw:function(t,e){var n=Math.sqrt(e)/2,r=CH*n;t.moveTo(0,r),t.lineTo(-n,-r),t.lineTo(n,-r),t.closePath()}},"triangle-right":{draw:function(t,e){var n=Math.sqrt(e)/2,r=CH*n;t.moveTo(r,0),t.lineTo(-r,-n),t.lineTo(-r,n),t.closePath()}},"triangle-left":{draw:function(t,e){var n=Math.sqrt(e)/2,r=CH*n;t.moveTo(-r,0),t.lineTo(r,-n),t.lineTo(r,n),t.closePath()}},stroke:{draw:function(t,e){const n=Math.sqrt(e)/2;t.moveTo(-n,0),t.lineTo(n,0)}}};function RH(t){return RF(BH,t)?BH[t]:function(t){if(!RF(PH,t)){const e=kH(t);PH[t]={draw:function(t,n){$H(t,e,0,0,Math.sqrt(n)/2)}}}return PH[t]}(t)}var PH={};const zH=.448084975506;function jH(t){return t.x}function UH(t){return t.y}function VH(t){return t.width}function qH(t){return t.height}function WH(t){return"function"==typeof t?t:()=>+t}function HH(t,e,n){return Math.max(e,Math.min(t,n))}function GH(){var t=jH,e=UH,n=VH,r=qH,i=WH(0),o=i,s=i,a=i,l=null;function u(u,c,h){var f,d=null!=c?c:+t.call(this,u),p=null!=h?h:+e.call(this,u),m=+n.call(this,u),g=+r.call(this,u),y=Math.min(m,g)/2,b=HH(+i.call(this,u),0,y),v=HH(+o.call(this,u),0,y),w=HH(+s.call(this,u),0,y),x=HH(+a.call(this,u),0,y);if(l||(l=f=GU()),b<=0&&v<=0&&w<=0&&x<=0)l.rect(d,p,m,g);else{var _=d+m,k=p+g;l.moveTo(d+b,p),l.lineTo(_-v,p),l.bezierCurveTo(_-zH*v,p,_,p+zH*v,_,p+v),l.lineTo(_,k-x),l.bezierCurveTo(_,k-zH*x,_-zH*x,k,_-x,k),l.lineTo(d+w,k),l.bezierCurveTo(d+zH*w,k,d,k-zH*w,d,k-w),l.lineTo(d,p+b),l.bezierCurveTo(d,p+zH*b,d+zH*b,p,d+b,p),l.closePath()}if(f)return l=null,f+""||null}return u.x=function(e){return arguments.length?(t=WH(e),u):t},u.y=function(t){return arguments.length?(e=WH(t),u):e},u.width=function(t){return arguments.length?(n=WH(t),u):n},u.height=function(t){return arguments.length?(r=WH(t),u):r},u.cornerRadius=function(t,e,n,r){return arguments.length?(i=WH(t),o=null!=e?WH(e):i,a=null!=n?WH(n):i,s=null!=r?WH(r):o,u):i},u.context=function(t){return arguments.length?(l=null==t?null:t,u):l},u}function YH(){var t,e,n,r,i,o,s,a,l=null;function u(t,e,n){const r=n/2;if(i){var u=s-e,c=t-o;if(u||c){var h=Math.hypot(u,c),f=(u/=h)*a,d=(c/=h)*a,p=Math.atan2(c,u);l.moveTo(o-f,s-d),l.lineTo(t-u*r,e-c*r),l.arc(t,e,r,p-Math.PI,p),l.lineTo(o+f,s+d),l.arc(o,s,a,p,p+Math.PI)}else l.arc(t,e,r,0,AH);l.closePath()}else i=1;o=t,s=e,a=r}function c(o){var s,a,c,h=o.length,f=!1;for(null==l&&(l=c=GU()),s=0;s<=h;++s)!(s<h&&r(a=o[s],s,o))===f&&(f=!f)&&(i=0),f&&u(+t(a,s,o),+e(a,s,o),+n(a,s,o));if(c)return l=null,c+""||null}return c.x=function(e){return arguments.length?(t=e,c):t},c.y=function(t){return arguments.length?(e=t,c):e},c.size=function(t){return arguments.length?(n=t,c):n},c.defined=function(t){return arguments.length?(r=t,c):r},c.context=function(t){return arguments.length?(l=null==t?null:t,c):l},c}function XH(t,e){return null!=t?t:e}const JH=t=>t.x||0,KH=t=>t.y||0,QH=t=>!(!1===t.defined),ZH=function(){var t=XU,e=JU,n=zU(0),r=null,i=KU,o=QU,s=ZU,a=null,l=YU(u);function u(){var u,c,h=+t.apply(this,arguments),f=+e.apply(this,arguments),d=i.apply(this,arguments)-yU,p=o.apply(this,arguments)-yU,m=lU(p-d),g=p>d;if(a||(a=u=l()),f<h&&(c=f,f=h,h=c),f>mU)if(m>bU-mU)a.moveTo(f*cU(d),f*dU(d)),a.arc(0,0,f,d,p,!g),h>mU&&(a.moveTo(h*cU(p),h*dU(p)),a.arc(0,0,h,p,d,g));else{var y,b,v=d,w=p,x=d,_=p,k=m,S=m,E=s.apply(this,arguments)/2,A=E>mU&&(r?+r.apply(this,arguments):pU(h*h+f*f)),C=fU(lU(f-h)/2,+n.apply(this,arguments)),D=C,M=C;if(A>mU){var O=vU(A/h*dU(E)),T=vU(A/f*dU(E));(k-=2*O)>mU?(x+=O*=g?1:-1,_-=O):(k=0,x=_=(d+p)/2),(S-=2*T)>mU?(v+=T*=g?1:-1,w-=T):(S=0,v=w=(d+p)/2)}var I=f*cU(v),N=f*dU(v),$=h*cU(_),F=h*dU(_);if(C>mU){var L,B=f*cU(w),R=f*dU(w),P=h*cU(x),z=h*dU(x);if(m<gU)if(L=function(t,e,n,r,i,o,s,a){var l=n-t,u=r-e,c=s-i,h=a-o,f=h*l-c*u;if(!(f*f<mU))return[t+(f=(c*(e-o)-h*(t-i))/f)*l,e+f*u]}(I,N,P,z,B,R,$,F)){var j=I-L[0],U=N-L[1],V=B-L[0],q=R-L[1],W=1/dU(function(t){return t>1?0:t<-1?gU:Math.acos(t)}((j*V+U*q)/(pU(j*j+U*U)*pU(V*V+q*q)))/2),H=pU(L[0]*L[0]+L[1]*L[1]);D=fU(C,(h-H)/(W-1)),M=fU(C,(f-H)/(W+1))}else D=M=0}S>mU?M>mU?(y=tV(P,z,I,N,f,M,g),b=tV(B,R,$,F,f,M,g),a.moveTo(y.cx+y.x01,y.cy+y.y01),M<C?a.arc(y.cx,y.cy,M,uU(y.y01,y.x01),uU(b.y01,b.x01),!g):(a.arc(y.cx,y.cy,M,uU(y.y01,y.x01),uU(y.y11,y.x11),!g),a.arc(0,0,f,uU(y.cy+y.y11,y.cx+y.x11),uU(b.cy+b.y11,b.cx+b.x11),!g),a.arc(b.cx,b.cy,M,uU(b.y11,b.x11),uU(b.y01,b.x01),!g))):(a.moveTo(I,N),a.arc(0,0,f,v,w,!g)):a.moveTo(I,N),h>mU&&k>mU?D>mU?(y=tV($,F,B,R,h,-D,g),b=tV(I,N,P,z,h,-D,g),a.lineTo(y.cx+y.x01,y.cy+y.y01),D<C?a.arc(y.cx,y.cy,D,uU(y.y01,y.x01),uU(b.y01,b.x01),!g):(a.arc(y.cx,y.cy,D,uU(y.y01,y.x01),uU(y.y11,y.x11),!g),a.arc(0,0,h,uU(y.cy+y.y11,y.cx+y.x11),uU(b.cy+b.y11,b.cx+b.x11),g),a.arc(b.cx,b.cy,D,uU(b.y11,b.x11),uU(b.y01,b.x01),!g))):a.arc(0,0,h,_,x,g):a.lineTo($,F)}else a.moveTo(0,0);if(a.closePath(),u)return a=null,u+""||null}return u.centroid=function(){var n=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,r=(+i.apply(this,arguments)+ +o.apply(this,arguments))/2-gU/2;return[cU(r)*n,dU(r)*n]},u.innerRadius=function(e){return arguments.length?(t="function"==typeof e?e:zU(+e),u):t},u.outerRadius=function(t){return arguments.length?(e="function"==typeof t?t:zU(+t),u):e},u.cornerRadius=function(t){return arguments.length?(n="function"==typeof t?t:zU(+t),u):n},u.padRadius=function(t){return arguments.length?(r=null==t?null:"function"==typeof t?t:zU(+t),u):r},u.startAngle=function(t){return arguments.length?(i="function"==typeof t?t:zU(+t),u):i},u.endAngle=function(t){return arguments.length?(o="function"==typeof t?t:zU(+t),u):o},u.padAngle=function(t){return arguments.length?(s="function"==typeof t?t:zU(+t),u):s},u.context=function(t){return arguments.length?(a=null==t?null:t,u):a},u}().startAngle((t=>t.startAngle||0)).endAngle((t=>t.endAngle||0)).padAngle((t=>t.padAngle||0)).innerRadius((t=>t.innerRadius||0)).outerRadius((t=>t.outerRadius||0)).cornerRadius((t=>t.cornerRadius||0)),tG=oV().x(JH).y1(KH).y0((t=>(t.y||0)+(t.height||0))).defined(QH),eG=oV().y(KH).x1(JH).x0((t=>(t.x||0)+(t.width||0))).defined(QH),nG=iV().x(JH).y(KH).defined(QH),rG=GH().x(JH).y(KH).width((t=>t.width||0)).height((t=>t.height||0)).cornerRadius((t=>XH(t.cornerRadiusTopLeft,t.cornerRadius)||0),(t=>XH(t.cornerRadiusTopRight,t.cornerRadius)||0),(t=>XH(t.cornerRadiusBottomRight,t.cornerRadius)||0),(t=>XH(t.cornerRadiusBottomLeft,t.cornerRadius)||0)),iG=function(t,e){let n=null,r=YU(i);function i(){let i;if(n||(n=i=r()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),i)return n=null,i+""||null}return t="function"==typeof t?t:zU(t||sV),e="function"==typeof e?e:zU(void 0===e?64:+e),i.type=function(e){return arguments.length?(t="function"==typeof e?e:zU(e),i):t},i.size=function(t){return arguments.length?(e="function"==typeof t?t:zU(+t),i):e},i.context=function(t){return arguments.length?(n=null==t?null:t,i):n},i}().type((t=>RH(t.shape||"circle"))).size((t=>XH(t.size,64))),oG=YH().x(JH).y(KH).defined(QH).size((t=>t.size||1));function sG(t){return t.cornerRadius||t.cornerRadiusTopLeft||t.cornerRadiusTopRight||t.cornerRadiusBottomRight||t.cornerRadiusBottomLeft}function aG(t,e,n,r){return rG.context(t)(e,n,r)}var lG=1;function uG(){lG=1}function cG(t,e,n){var r=e.clip,i=t._defs,o=e.clip_id||(e.clip_id="clip"+lG++),s=i.clipping[o]||(i.clipping[o]={id:o});return EF(r)?s.path=r(null):sG(n)?s.path=aG(null,n,0,0):(s.width=n.width||0,s.height=n.height||0),"url(#"+o+")"}function hG(t){this.clear(),t&&this.union(t)}function fG(t){this.mark=t,this.bounds=this.bounds||new hG}function dG(t){fG.call(this,t),this.items=this.items||[]}hG.prototype={clone(){return new hG(this)},clear(){return this.x1=+Number.MAX_VALUE,this.y1=+Number.MAX_VALUE,this.x2=-Number.MAX_VALUE,this.y2=-Number.MAX_VALUE,this},empty(){return this.x1===+Number.MAX_VALUE&&this.y1===+Number.MAX_VALUE&&this.x2===-Number.MAX_VALUE&&this.y2===-Number.MAX_VALUE},equals(t){return this.x1===t.x1&&this.y1===t.y1&&this.x2===t.x2&&this.y2===t.y2},set(t,e,n,r){return n<t?(this.x2=t,this.x1=n):(this.x1=t,this.x2=n),r<e?(this.y2=e,this.y1=r):(this.y1=e,this.y2=r),this},add(t,e){return t<this.x1&&(this.x1=t),e<this.y1&&(this.y1=e),t>this.x2&&(this.x2=t),e>this.y2&&(this.y2=e),this},expand(t){return this.x1-=t,this.y1-=t,this.x2+=t,this.y2+=t,this},round(){return this.x1=Math.floor(this.x1),this.y1=Math.floor(this.y1),this.x2=Math.ceil(this.x2),this.y2=Math.ceil(this.y2),this},scale(t){return this.x1*=t,this.y1*=t,this.x2*=t,this.y2*=t,this},translate(t,e){return this.x1+=t,this.x2+=t,this.y1+=e,this.y2+=e,this},rotate(t,e,n){const r=this.rotatedPoints(t,e,n);return this.clear().add(r[0],r[1]).add(r[2],r[3]).add(r[4],r[5]).add(r[6],r[7])},rotatedPoints(t,e,n){var{x1:r,y1:i,x2:o,y2:s}=this,a=Math.cos(t),l=Math.sin(t),u=e-e*a+n*l,c=n-e*l-n*a;return[a*r-l*i+u,l*r+a*i+c,a*r-l*s+u,l*r+a*s+c,a*o-l*i+u,l*o+a*i+c,a*o-l*s+u,l*o+a*s+c]},union(t){return t.x1<this.x1&&(this.x1=t.x1),t.y1<this.y1&&(this.y1=t.y1),t.x2>this.x2&&(this.x2=t.x2),t.y2>this.y2&&(this.y2=t.y2),this},intersect(t){return t.x1>this.x1&&(this.x1=t.x1),t.y1>this.y1&&(this.y1=t.y1),t.x2<this.x2&&(this.x2=t.x2),t.y2<this.y2&&(this.y2=t.y2),this},encloses(t){return t&&this.x1<=t.x1&&this.x2>=t.x2&&this.y1<=t.y1&&this.y2>=t.y2},alignsWith(t){return t&&(this.x1==t.x1||this.x2==t.x2||this.y1==t.y1||this.y2==t.y2)},intersects(t){return t&&!(this.x2<t.x1||this.x1>t.x2||this.y2<t.y1||this.y1>t.y2)},contains(t,e){return!(t<this.x1||t>this.x2||e<this.y1||e>this.y2)},width(){return this.x2-this.x1},height(){return this.y2-this.y1}},UF(dG,fG);class pG{constructor(t){this._pending=0,this._loader=t||MR()}pending(){return this._pending}sanitizeURL(t){const e=this;return mG(e),e._loader.sanitize(t,{context:"href"}).then((t=>(gG(e),t))).catch((()=>(gG(e),null)))}loadImage(t){const e=this,n=lV();return mG(e),e._loader.sanitize(t,{context:"image"}).then((t=>{const r=t.href;if(!r||!n)throw{url:r};const i=new n,o=RF(t,"crossOrigin")?t.crossOrigin:"anonymous";return null!=o&&(i.crossOrigin=o),i.onload=()=>gG(e),i.onerror=()=>gG(e),i.src=r,i})).catch((t=>(gG(e),{complete:!1,width:0,height:0,src:t&&t.url||""})))}ready(){const t=this;return new Promise((e=>{!function n(r){t.pending()?setTimeout((()=>{n(!0)}),10):e(r)}(!1)}))}}function mG(t){t._pending+=1}function gG(t){t._pending-=1}function yG(t,e,n){if(e.stroke&&0!==e.opacity&&0!==e.strokeOpacity){const r=null!=e.strokeWidth?+e.strokeWidth:1;t.expand(r+(n?function(t,e){return t.strokeJoin&&"miter"!==t.strokeJoin?0:e}(e,r):0))}return t}const bG=AH-1e-8;let vG,wG,xG,_G,kG,SG,EG,AG;const CG=(t,e)=>vG.add(t,e),DG=(t,e)=>CG(wG=t,xG=e),MG=t=>CG(t,vG.y1),OG=t=>CG(vG.x1,t),TG=(t,e)=>kG*t+EG*e,IG=(t,e)=>SG*t+AG*e,NG=(t,e)=>CG(TG(t,e),IG(t,e)),$G=(t,e)=>DG(TG(t,e),IG(t,e));function FG(t,e){return vG=t,e?(_G=e*SH,kG=AG=Math.cos(_G),SG=Math.sin(_G),EG=-SG):(kG=AG=1,_G=SG=EG=0),LG}const LG={beginPath(){},closePath(){},moveTo:$G,lineTo:$G,rect(t,e,n,r){_G?(NG(t+n,e),NG(t+n,e+r),NG(t,e+r),$G(t,e)):(CG(t+n,e+r),DG(t,e))},quadraticCurveTo(t,e,n,r){const i=TG(t,e),o=IG(t,e),s=TG(n,r),a=IG(n,r);BG(wG,i,s,MG),BG(xG,o,a,OG),DG(s,a)},bezierCurveTo(t,e,n,r,i,o){const s=TG(t,e),a=IG(t,e),l=TG(n,r),u=IG(n,r),c=TG(i,o),h=IG(i,o);RG(wG,s,l,c,MG),RG(xG,a,u,h,OG),DG(c,h)},arc(t,e,n,r,i,o){if(r+=_G,i+=_G,wG=n*Math.cos(i)+t,xG=n*Math.sin(i)+e,Math.abs(i-r)>bG)CG(t-n,e-n),CG(t+n,e+n);else{const s=r=>CG(n*Math.cos(r)+t,n*Math.sin(r)+e);let a,l;if(s(r),s(i),i!==r)if((r%=AH)<0&&(r+=AH),(i%=AH)<0&&(i+=AH),i<r&&(o=!o,a=r,r=i,i=a),o)for(i-=AH,a=r-r%EH,l=0;l<4&&a>i;++l,a-=EH)s(a);else for(a=r-r%EH+EH,l=0;l<4&&a<i;++l,a+=EH)s(a)}}};function BG(t,e,n,r){const i=(t-e)/(t+n-2*e);0<i&&i<1&&r(t+(e-t)*i)}function RG(t,e,n,r,i){const o=r-t+3*e-3*n,s=t+n-2*e,a=t-e;let l,u=0,c=0;Math.abs(o)>1e-14?(l=s*s+a*o,l>=0&&(l=Math.sqrt(l),u=(-s+l)/o,c=(-s-l)/o)):u=.5*a/s,0<u&&u<1&&i(PG(u,t,e,n,r)),0<c&&c<1&&i(PG(c,t,e,n,r))}function PG(t,e,n,r,i){const o=1-t,s=o*o,a=t*t;return s*o*e+3*s*t*n+3*o*a*r+a*t*i}var zG=(zG=aV(1,1))?zG.getContext("2d"):null;const jG=new hG;function UG(t){return function(e,n){if(!zG)return!0;t(zG,e),jG.clear().union(e.bounds).intersect(n).round();const{x1:r,y1:i,x2:o,y2:s}=jG;for(let t=i;t<=s;++t)for(let e=r;e<=o;++e)if(zG.isPointInPath(e,t))return!0;return!1}}function VG(t,e){return e.contains(t.x||0,t.y||0)}function qG(t,e){const n=t.x||0,r=t.y||0,i=t.width||0,o=t.height||0;return e.intersects(jG.set(n,r,n+i,r+o))}function WG(t,e){const n=t.x||0,r=t.y||0;return HG(e,n,r,null!=t.x2?t.x2:n,null!=t.y2?t.y2:r)}function HG(t,e,n,r,i){const{x1:o,y1:s,x2:a,y2:l}=t,u=r-e,c=i-n;let h,f,d,p,m=0,g=1;for(p=0;p<4;++p){if(0===p&&(h=-u,f=-(o-e)),1===p&&(h=u,f=a-e),2===p&&(h=-c,f=-(s-n)),3===p&&(h=c,f=l-n),Math.abs(h)<1e-10&&f<0)return!1;if(d=f/h,h<0){if(d>g)return!1;d>m&&(m=d)}else if(h>0){if(d<m)return!1;d<g&&(g=d)}}return!0}function GG(t,e){t.globalCompositeOperation=e.blend||"source-over"}function YG(t,e){return null==t?e:t}function XG(t,e){const n=e.length;for(let r=0;r<n;++r)t.addColorStop(e[r].offset,e[r].color);return t}function JG(t,e,n){return fH(n)?function(t,e,n){const r=n.width(),i=n.height();let o;if("radial"===e.gradient)o=t.createRadialGradient(n.x1+YG(e.x1,.5)*r,n.y1+YG(e.y1,.5)*i,Math.max(r,i)*YG(e.r1,0),n.x1+YG(e.x2,.5)*r,n.y1+YG(e.y2,.5)*i,Math.max(r,i)*YG(e.r2,.5));else{const s=YG(e.x1,0),a=YG(e.y1,0),l=YG(e.x2,1),u=YG(e.y2,0);if(s!==l&&a!==u&&r!==i){const n=aV(Math.ceil(r),Math.ceil(i)),o=n.getContext("2d");return o.scale(r,i),o.fillStyle=XG(o.createLinearGradient(s,a,l,u),e.stops),o.fillRect(0,0,r,i),t.createPattern(n,"no-repeat")}o=t.createLinearGradient(n.x1+s*r,n.y1+a*i,n.x1+l*r,n.y1+u*i)}return XG(o,e.stops)}(t,n,e.bounds):n}function KG(t,e,n){return(n*=null==e.fillOpacity?1:e.fillOpacity)>0&&(t.globalAlpha=n,t.fillStyle=JG(t,e,e.fill),!0)}var QG=[];function ZG(t,e,n){var r=null!=(r=e.strokeWidth)?r:1;return!(r<=0)&&(n*=null==e.strokeOpacity?1:e.strokeOpacity)>0&&(t.globalAlpha=n,t.strokeStyle=JG(t,e,e.stroke),t.lineWidth=r,t.lineCap=e.strokeCap||"butt",t.lineJoin=e.strokeJoin||"miter",t.miterLimit=e.strokeMiterLimit||10,t.setLineDash&&(t.setLineDash(e.strokeDash||QG),t.lineDashOffset=e.strokeDashOffset||0),!0)}function tY(t,e){return t.zindex-e.zindex||t.index-e.index}function eY(t){if(!t.zdirty)return t.zitems;var e,n,r,i=t.items,o=[];for(n=0,r=i.length;n<r;++n)(e=i[n]).index=n,e.zindex&&o.push(e);return t.zdirty=!1,t.zitems=o.sort(tY)}function nY(t,e){var n,r,i=t.items;if(!i||!i.length)return;const o=eY(t);if(o&&o.length){for(n=0,r=i.length;n<r;++n)i[n].zindex||e(i[n]);i=o}for(n=0,r=i.length;n<r;++n)e(i[n])}function rY(t,e){var n,r,i=t.items;if(!i||!i.length)return null;const o=eY(t);for(o&&o.length&&(i=o),r=i.length;--r>=0;)if(n=e(i[r]))return n;if(i===o)for(r=(i=t.items).length;--r>=0;)if(!i[r].zindex&&(n=e(i[r])))return n;return null}function iY(t){return function(e,n,r){nY(n,(n=>{r&&!r.intersects(n.bounds)||sY(t,e,n,n)}))}}function oY(t){return function(e,n,r){!n.items.length||r&&!r.intersects(n.bounds)||sY(t,e,n.items[0],n.items)}}function sY(t,e,n,r){var i=null==n.opacity?1:n.opacity;0!==i&&(t(e,r)||(GG(e,n),n.fill&&KG(e,n,i)&&e.fill(),n.stroke&&ZG(e,n,i)&&e.stroke()))}function aY(t){return t=t||V$,function(e,n,r,i,o,s){return r*=e.pixelRatio,i*=e.pixelRatio,rY(n,(n=>{const a=n.bounds;if((!a||a.contains(o,s))&&a)return t(e,n,r,i,o,s)?n:void 0}))}}function lY(t,e){return function(n,r,i,o){var s,a,l=Array.isArray(r)?r[0]:r,u=null==e?l.fill:e,c=l.stroke&&n.isPointInStroke;return c&&(s=l.strokeWidth,a=l.strokeCap,n.lineWidth=null!=s?s:1,n.lineCap=null!=a?a:"butt"),!t(n,r)&&(u&&n.isPointInPath(i,o)||c&&n.isPointInStroke(i,o))}}function uY(t){return aY(lY(t))}function cY(t,e){return"translate("+t+","+e+")"}function hY(t){return"rotate("+t+")"}function fY(t){return cY(t.x||0,t.y||0)}function dY(t,e,n){function r(t,n){var r=n.x||0,i=n.y||0,o=n.angle||0;t.translate(r,i),o&&t.rotate(o*=SH),t.beginPath(),e(t,n),o&&t.rotate(-o),t.translate(-r,-i)}return{type:t,tag:"path",nested:!1,attr:function(t,n){t("transform",function(t){return cY(t.x||0,t.y||0)+(t.angle?" "+hY(t.angle):"")}(n)),t("d",e(null,n))},bound:function(t,n){return e(FG(t,n.angle),n),yG(t,n).translate(n.x||0,n.y||0)},draw:iY(r),pick:uY(r),isect:n||UG(r)}}var pY=dY("arc",(function(t,e){return ZH.context(t)(e)}));function mY(t,e,n){function r(t,n){t.beginPath(),e(t,n)}const i=lY(r);return{type:t,tag:"path",nested:!0,attr:function(t,n){var r=n.mark.items;r.length&&t("d",e(null,r))},bound:function(t,n){var r=n.items;return 0===r.length?t:(e(FG(t),r),yG(t,r[0]))},draw:oY(r),pick:function(t,e,n,r,o,s){var a=e.items,l=e.bounds;return!a||!a.length||l&&!l.contains(o,s)?null:(n*=t.pixelRatio,r*=t.pixelRatio,i(t,a,n,r)?a[0]:null)},isect:VG,tip:n}}var gY=mY("area",(function(t,e){const n=e[0],r=n.interpolate||"linear";return("horizontal"===n.orient?eG:tG).curve(yH(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i="horizontal"===t[0].orient?e[1]:e[0],o="horizontal"===t[0].orient?"y":"x",s=t.length,a=1/0;--s>=0;)!1!==t[s].defined&&(r=Math.abs(t[s][o]-i))<a&&(a=r,n=t[s]);return n}));function yY(t,e){t.beginPath(),sG(e)?aG(t,e,0,0):t.rect(0,0,e.width||0,e.height||0),t.clip()}function bY(t){const e=YG(t.strokeWidth,1);return null!=t.strokeOffset?t.strokeOffset:t.stroke&&e>.5&&e<1.5?.5-Math.abs(e-1):0}function vY(t,e){const n=bY(e);t("d",aG(null,e,n,n))}function wY(t,e,n,r){const i=bY(e);t.beginPath(),aG(t,e,(n||0)+i,(r||0)+i)}const xY=lY(wY),_Y=lY(wY,!1),kY=lY(wY,!0);var SY={type:"group",tag:"g",nested:!1,attr:function(t,e){t("transform",fY(e))},bound:function(t,e){if(!e.clip&&e.items){const n=e.items,r=n.length;for(let e=0;e<r;++e)t.union(n[e].bounds)}return(e.clip||e.width||e.height)&&!e.noBound&&t.add(0,0).add(e.width||0,e.height||0),yG(t,e),t.translate(e.x||0,e.y||0)},draw:function(t,e,n,r){nY(e,(e=>{const i=e.x||0,o=e.y||0,s=e.strokeForeground,a=null==e.opacity?1:e.opacity;(e.stroke||e.fill)&&a&&(wY(t,e,i,o),GG(t,e),e.fill&&KG(t,e,a)&&t.fill(),e.stroke&&!s&&ZG(t,e,a)&&t.stroke()),t.save(),t.translate(i,o),e.clip&&yY(t,e),n&&n.translate(-i,-o),nY(e,(e=>{("group"===e.marktype||null==r||r.includes(e.marktype))&&this.draw(t,e,n,r)})),n&&n.translate(i,o),t.restore(),s&&e.stroke&&a&&(wY(t,e,i,o),GG(t,e),ZG(t,e,a)&&t.stroke())}))},pick:function(t,e,n,r,i,o){if(e.bounds&&!e.bounds.contains(i,o)||!e.items)return null;const s=n*t.pixelRatio,a=r*t.pixelRatio;return rY(e,(l=>{let u,c,h;const f=l.bounds;if(f&&!f.contains(i,o))return;c=l.x||0,h=l.y||0;const d=c+(l.width||0),p=h+(l.height||0),m=l.clip;if(m&&(i<c||i>d||o<h||o>p))return;if(t.save(),t.translate(c,h),c=i-c,h=o-h,m&&sG(l)&&!kY(t,l,s,a))return t.restore(),null;const g=l.strokeForeground,y=!1!==e.interactive;return y&&g&&l.stroke&&_Y(t,l,s,a)?(t.restore(),l):(u=rY(l,(t=>function(t,e,n){return(!1!==t.interactive||"group"===t.marktype)&&t.bounds&&t.bounds.contains(e,n)}(t,c,h)?this.pick(t,n,r,c,h):null)),!u&&y&&(l.fill||!g&&l.stroke)&&xY(t,l,s,a)&&(u=l),t.restore(),u||null)}))},isect:qG,content:function(t,e,n){t("clip-path",e.clip?cG(n,e,e):null)},background:function(t,e){t("class","background"),t("aria-hidden",!0),vY(t,e)},foreground:function(t,e){t("class","foreground"),t("aria-hidden",!0),e.strokeForeground?vY(t,e):t("d","")}},EY={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",version:"1.1"};function AY(t,e){var n=t.image;return(!n||t.url&&t.url!==n.url)&&(n={complete:!1,width:0,height:0},e.loadImage(t.url).then((e=>{t.image=e,t.image.url=t.url}))),n}function CY(t,e){return null!=t.width?t.width:e&&e.width?!1!==t.aspect&&t.height?t.height*e.width/e.height:e.width:0}function DY(t,e){return null!=t.height?t.height:e&&e.height?!1!==t.aspect&&t.width?t.width*e.height/e.width:e.height:0}function MY(t,e){return"center"===t?e/2:"right"===t?e:0}function OY(t,e){return"middle"===t?e/2:"bottom"===t?e:0}var TY={type:"image",tag:"image",nested:!1,attr:function(t,e,n){const r=AY(e,n),i=CY(e,r),o=DY(e,r),s=(e.x||0)-MY(e.align,i),a=(e.y||0)-OY(e.baseline,o);t("href",!r.src&&r.toDataURL?r.toDataURL():r.src||"",EY["xmlns:xlink"],"xlink:href"),t("transform",cY(s,a)),t("width",i),t("height",o),t("preserveAspectRatio",!1===e.aspect?"none":"xMidYMid")},bound:function(t,e){const n=e.image,r=CY(e,n),i=DY(e,n),o=(e.x||0)-MY(e.align,r),s=(e.y||0)-OY(e.baseline,i);return t.set(o,s,o+r,s+i)},draw:function(t,e,n){nY(e,(e=>{if(n&&!n.intersects(e.bounds))return;const r=AY(e,this);let i=CY(e,r),o=DY(e,r);if(0===i||0===o)return;let s,a,l,u,c=(e.x||0)-MY(e.align,i),h=(e.y||0)-OY(e.baseline,o);!1!==e.aspect&&(a=r.width/r.height,l=e.width/e.height,a==a&&l==l&&a!==l&&(l<a?(u=i/a,h+=(o-u)/2,o=u):(u=o*a,c+=(i-u)/2,i=u))),(r.complete||r.toDataURL)&&(GG(t,e),t.globalAlpha=null!=(s=e.opacity)?s:1,t.imageSmoothingEnabled=!1!==e.smooth,t.drawImage(r,c,h,i,o))}))},pick:aY(),isect:V$,get:AY,xOffset:MY,yOffset:OY},IY=mY("line",(function(t,e){const n=e[0],r=n.interpolate||"linear";return nG.curve(yH(r,n.orient,n.tension)).context(t)(e)}),(function(t,e){for(var n,r,i=Math.pow(t[0].strokeWidth||1,2),o=t.length;--o>=0;)if(!1!==t[o].defined&&(n=t[o].x-e[0])*n+(r=t[o].y-e[1])*r<i)return t[o];return null}));function NY(t,e){var n=e.path;if(null==n)return!0;var r=e.x||0,i=e.y||0,o=e.scaleX||1,s=e.scaleY||1,a=(e.angle||0)*SH,l=e.pathCache;l&&l.path===n||((e.pathCache=l=kH(n)).path=n),a&&t.rotate&&t.translate?(t.translate(r,i),t.rotate(a),$H(t,l,0,0,o,s),t.rotate(-a),t.translate(-r,-i)):$H(t,l,r,i,o,s)}var $Y={type:"path",tag:"path",nested:!1,attr:function(t,e){var n=e.scaleX||1,r=e.scaleY||1;1===n&&1===r||t("vector-effect","non-scaling-stroke"),t("transform",function(t){return cY(t.x||0,t.y||0)+(t.angle?" "+hY(t.angle):"")+(t.scaleX||t.scaleY?" "+(e=t.scaleX||1,n=t.scaleY||1,"scale("+e+","+n+")"):"");var e,n}(e)),t("d",e.path)},bound:function(t,e){return NY(FG(t,e.angle),e)?t.set(0,0,0,0):yG(t,e,!0)},draw:iY(NY),pick:uY(NY),isect:UG(NY)};function FY(t,e){t.beginPath(),aG(t,e)}var LY={type:"rect",tag:"path",nested:!1,attr:function(t,e){t("d",aG(null,e))},bound:function(t,e){var n,r;return yG(t.set(n=e.x||0,r=e.y||0,n+e.width||0,r+e.height||0),e)},draw:iY(FY),pick:uY(FY),isect:qG};function BY(t,e,n){var r,i,o,s;return!(!e.stroke||!ZG(t,e,n)||(r=e.x||0,i=e.y||0,o=null!=e.x2?e.x2:r,s=null!=e.y2?e.y2:i,t.beginPath(),t.moveTo(r,i),t.lineTo(o,s),0))}var RY={type:"rule",tag:"line",nested:!1,attr:function(t,e){t("transform",fY(e)),t("x2",null!=e.x2?e.x2-(e.x||0):0),t("y2",null!=e.y2?e.y2-(e.y||0):0)},bound:function(t,e){var n,r;return yG(t.set(n=e.x||0,r=e.y||0,null!=e.x2?e.x2:n,null!=e.y2?e.y2:r),e)},draw:function(t,e,n){nY(e,(e=>{if(!n||n.intersects(e.bounds)){var r=null==e.opacity?1:e.opacity;r&&BY(t,e,r)&&(GG(t,e),t.stroke())}}))},pick:aY((function(t,e,n,r){return!!t.isPointInStroke&&BY(t,e,1)&&t.isPointInStroke(n,r)})),isect:WG},PY=dY("shape",(function(t,e){return(e.mark.shape||e.shape).context(t)(e)})),zY=dY("symbol",(function(t,e){return iG.context(t)(e)}),VG);const jY=ZF();var UY={height:YY,measureWidth:HY,estimateWidth:qY,width:qY,canvas:VY};function VY(t){UY.width=t&&zG?HY:qY}function qY(t,e){return WY(QY(t,e),YY(t))}function WY(t,e){return~~(.8*t.length*e)}function HY(t,e){return YY(t)<=0||!(e=QY(t,e))?0:GY(e,tX(t))}function GY(t,e){const n=`(${e}) ${t}`;let r=jY.get(n);return void 0===r&&(zG.font=e,r=zG.measureText(t).width,jY.set(n,r)),r}function YY(t){return null!=t.fontSize?+t.fontSize||0:11}function XY(t){return null!=t.lineHeight?t.lineHeight:YY(t)+2}function JY(t){return e=t.lineBreak&&t.text&&!Q$(t.text)?t.text.split(t.lineBreak):t.text,Q$(e)?e.length>1?e:e[0]:e;var e}function KY(t){const e=JY(t);return(Q$(e)?e.length-1:0)*XY(t)}function QY(t,e){const n=null==e?"":(e+"").trim();return t.limit>0&&n.length?function(t,e){var n=+t.limit,r=function(t){if(UY.width===HY){const e=tX(t);return t=>GY(t,e)}if(UY.width===qY){const e=YY(t);return t=>WY(t,e)}return e=>UY.width(t,e)}(t);if(r(e)<n)return e;var i,o=t.ellipsis||"â€¦",s="rtl"===t.dir,a=0,l=e.length;if(n-=r(o),s){for(;a<l;)i=a+l>>>1,r(e.slice(i))>n?a=i+1:l=i;return o+e.slice(a)}for(;a<l;)i=1+(a+l>>>1),r(e.slice(0,i))<n?a=i:l=i-1;return e.slice(0,a)+o}(t,n):n}function ZY(t,e){var n=t.font;return(e&&n?String(n).replace(/"/g,"'"):n)||"sans-serif"}function tX(t,e){return(t.fontStyle?t.fontStyle+" ":"")+(t.fontVariant?t.fontVariant+" ":"")+(t.fontWeight?t.fontWeight+" ":"")+YY(t)+"px "+ZY(t,e)}function eX(t){var e=t.baseline,n=YY(t);return Math.round("top"===e?.79*n:"middle"===e?.3*n:"bottom"===e?-.21*n:"line-top"===e?.29*n+.5*XY(t):"line-bottom"===e?.29*n-.5*XY(t):0)}VY(!0);const nX={left:"start",center:"middle",right:"end"},rX=new hG;function iX(t){var e,n=t.x||0,r=t.y||0,i=t.radius||0;return i&&(e=(t.theta||0)-EH,n+=i*Math.cos(e),r+=i*Math.sin(e)),rX.x1=n,rX.y1=r,rX}function oX(t,e,n){var r,i=UY.height(e),o=e.align,s=iX(e),a=s.x1,l=s.y1,u=e.dx||0,c=(e.dy||0)+eX(e)-Math.round(.8*i),h=JY(e);if(Q$(h)?(i+=XY(e)*(h.length-1),r=h.reduce(((t,n)=>Math.max(t,UY.width(e,n))),0)):r=UY.width(e,h),"center"===o?u-=r/2:"right"===o&&(u-=r),t.set(u+=a,c+=l,u+r,c+i),e.angle&&!n)t.rotate(e.angle*SH,a,l);else if(2===n)return t.rotatedPoints(e.angle*SH,a,l);return t}var sX={type:"text",tag:"text",nested:!1,attr:function(t,e){var n,r=e.dx||0,i=(e.dy||0)+eX(e),o=iX(e),s=o.x1,a=o.y1,l=e.angle||0;t("text-anchor",nX[e.align]||"start"),l?(n=cY(s,a)+" "+hY(l),(r||i)&&(n+=" "+cY(r,i))):n=cY(s+r,a+i),t("transform",n)},bound:oX,draw:function(t,e,n){nY(e,(e=>{var r,i,o,s,a,l,u,c=null==e.opacity?1:e.opacity;if(!(n&&!n.intersects(e.bounds)||0===c||e.fontSize<=0||null==e.text||0===e.text.length)){if(t.font=tX(e),t.textAlign=e.align||"left",i=(r=iX(e)).x1,o=r.y1,e.angle&&(t.save(),t.translate(i,o),t.rotate(e.angle*SH),i=o=0),i+=e.dx||0,o+=(e.dy||0)+eX(e),l=JY(e),GG(t,e),Q$(l))for(a=XY(e),s=0;s<l.length;++s)u=QY(e,l[s]),e.fill&&KG(t,e,c)&&t.fillText(u,i,o),e.stroke&&ZG(t,e,c)&&t.strokeText(u,i,o),o+=a;else u=QY(e,l),e.fill&&KG(t,e,c)&&t.fillText(u,i,o),e.stroke&&ZG(t,e,c)&&t.strokeText(u,i,o);e.angle&&t.restore()}}))},pick:aY((function(t,e,n,r,i,o){if(e.fontSize<=0)return!1;if(!e.angle)return!0;var s=iX(e),a=s.x1,l=s.y1,u=oX(rX,e,1),c=-e.angle*SH,h=Math.cos(c),f=Math.sin(c),d=h*i-f*o+(a-h*a+f*l),p=f*i+h*o+(l-f*a-h*l);return u.contains(d,p)})),isect:function(t,e){const n=oX(rX,t,2);return HG(e,n[0],n[1],n[2],n[3])||HG(e,n[0],n[1],n[4],n[5])||HG(e,n[4],n[5],n[6],n[7])||HG(e,n[2],n[3],n[6],n[7])}},aX=mY("trail",(function(t,e){return oG.context(t)(e)}),(function(t,e){for(var n,r,i=t.length;--i>=0;)if(!1!==t[i].defined&&(n=t[i].x-e[0])*n+(r=t[i].y-e[1])*r<(n=t[i].size||1)*n)return t[i];return null})),lX={arc:pY,area:gY,group:SY,image:TY,line:IY,path:$Y,rect:LY,rule:RY,shape:PY,symbol:zY,text:sX,trail:aX};function uX(t,e,n){var r=lX[t.mark.marktype],i=e||r.bound;return r.nested&&(t=t.mark),i(t.bounds||(t.bounds=new hG),t,n)}var cX={mark:null};function hX(t,e,n){var r,i,o,s,a=lX[t.marktype],l=a.bound,u=t.items,c=u&&u.length;if(a.nested)return c?o=u[0]:(cX.mark=t,o=cX),s=uX(o,l,n),e&&e.union(s)||s;if(e=e||t.bounds&&t.bounds.clear()||new hG,c)for(r=0,i=u.length;r<i;++r)e.union(uX(u[r],l,n));return t.bounds=e}const fX=["marktype","name","role","interactive","clip","items","zindex","x","y","width","height","align","baseline","fill","fillOpacity","opacity","blend","stroke","strokeOpacity","strokeWidth","strokeCap","strokeDash","strokeDashOffset","strokeForeground","strokeOffset","startAngle","endAngle","innerRadius","outerRadius","cornerRadius","padAngle","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight","interpolate","tension","orient","defined","url","aspect","smooth","path","scaleX","scaleY","x2","y2","size","shape","text","angle","theta","radius","dir","dx","dy","ellipsis","limit","lineBreak","lineHeight","font","fontSize","fontWeight","fontStyle","fontVariant","description","aria","ariaRole","ariaRoleDescription"];function dX(t,e){return JSON.stringify(t,fX,e)}function pX(t){return mX("string"==typeof t?JSON.parse(t):t)}function mX(t){var e,n,r,i=t.marktype,o=t.items;if(o)for(n=0,r=o.length;n<r;++n)e=i?"mark":"group",o[n][e]=t,o[n].zindex&&(o[n][e].zdirty=!0),"group"===(i||e)&&mX(o[n]);return i&&hX(t),t}class gX{constructor(t){arguments.length?this.root=pX(t):(this.root=yX({marktype:"group",name:"root",role:"frame"}),this.root.items=[new dG(this.root)])}toJSON(t){return dX(this.root,t||0)}mark(t,e,n){const r=yX(t,e=e||this.root.items[0]);return e.items[n]=r,r.zindex&&(r.group.zdirty=!0),r}}function yX(t,e){const n={bounds:new hG,clip:!!t.clip,group:e,interactive:!1!==t.interactive,items:[],marktype:t.marktype,name:t.name||void 0,role:t.role||void 0,zindex:t.zindex||0};return null!=t.aria&&(n.aria=t.aria),t.description&&(n.description=t.description),n}function bX(t,e,n){return!t&&"undefined"!=typeof document&&document.createElement&&(t=document),t?n?t.createElementNS(n,e):t.createElement(e):null}function vX(t,e){e=e.toLowerCase();for(var n=t.childNodes,r=0,i=n.length;r<i;++r)if(n[r].tagName.toLowerCase()===e)return n[r]}function wX(t,e,n,r){var i,o=t.childNodes[e];return o&&o.tagName.toLowerCase()===n.toLowerCase()||(i=o||null,o=bX(t.ownerDocument,n,r),t.insertBefore(o,i)),o}function xX(t,e){for(var n=t.childNodes,r=n.length;r>e;)t.removeChild(n[--r]);return t}function _X(t){return"mark-"+t.marktype+(t.role?" role-"+t.role:"")+(t.name?" "+t.name:"")}function kX(t,e){const n=e.getBoundingClientRect();return[t.clientX-n.left-(e.clientLeft||0),t.clientY-n.top-(e.clientTop||0)]}class SX{constructor(t,e){this._active=null,this._handlers={},this._loader=t||MR(),this._tooltip=e||EX}initialize(t,e,n){return this._el=t,this._obj=n||null,this.origin(e)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}origin(t){return arguments.length?(this._origin=t||[0,0],this):this._origin.slice()}scene(t){return arguments.length?(this._scene=t,this):this._scene}on(){}off(){}_handlerIndex(t,e,n){for(let r=t?t.length:0;--r>=0;)if(t[r].type===e&&(!n||t[r].handler===n))return r;return-1}handlers(t){const e=this._handlers,n=[];if(t)n.push(...e[this.eventName(t)]);else for(const t in e)n.push(...e[t]);return n}eventName(t){const e=t.indexOf(".");return e<0?t:t.slice(0,e)}handleHref(t,e,n){this._loader.sanitize(n,{context:"href"}).then((e=>{const n=new MouseEvent(t.type,t),r=bX(null,"a");for(const t in e)r.setAttribute(t,e[t]);r.dispatchEvent(n)})).catch((()=>{}))}handleTooltip(t,e,n){if(e&&null!=e.tooltip){e=function(t,e,n,r){var i,o,s=t&&t.mark;if(s&&(i=lX[s.marktype]).tip){for((o=kX(e,n))[0]-=r[0],o[1]-=r[1];t=t.mark.group;)o[0]-=t.x||0,o[1]-=t.y||0;t=i.tip(s.items,o)}return t}(e,t,this.canvas(),this._origin);const r=n&&e&&e.tooltip||null;this._tooltip.call(this._obj,this,t,e,r)}}getItemBoundingClientRect(t){const e=this.canvas();if(!e)return;const n=e.getBoundingClientRect(),r=this._origin,i=t.bounds,o=i.width(),s=i.height();let a=i.x1+r[0]+n.left,l=i.y1+r[1]+n.top;for(;t.mark&&(t=t.mark.group);)a+=t.x||0,l+=t.y||0;return{x:a,y:l,width:o,height:s,left:a,top:l,right:a+o,bottom:l+s}}}function EX(t,e,n,r){t.element().setAttribute("title",r||"")}class AX{constructor(t){this._el=null,this._bgcolor=null,this._loader=new pG(t)}initialize(t,e,n,r,i){return this._el=t,this.resize(e,n,r,i)}element(){return this._el}canvas(){return this._el&&this._el.firstChild}background(t){return 0===arguments.length?this._bgcolor:(this._bgcolor=t,this)}resize(t,e,n,r){return this._width=t,this._height=e,this._origin=n||[0,0],this._scale=r||1,this}dirty(){}render(t,e){const n=this;return n._call=function(){n._render(t,e)},n._call(),n._call=null,n}_render(){}renderAsync(t,e){const n=this.render(t,e);return this._ready?this._ready.then((()=>n)):Promise.resolve(n)}_load(t,e){var n=this,r=n._loader[t](e);if(!n._ready){const t=n._call;n._ready=n._loader.ready().then((e=>{e&&t(),n._ready=null}))}return r}sanitizeURL(t){return this._load("sanitizeURL",t)}loadImage(t){return this._load("loadImage",t)}}const CX="dragenter",DX="dragleave",MX="dragover",OX="pointerdown",TX="pointermove",IX="pointerout",NX="pointerover",$X="mousedown",FX="mousemove",LX="mouseout",BX="mouseover",RX="click",PX="mousewheel",zX="touchstart",jX="touchmove",UX="touchend",VX=["keydown","keypress","keyup",CX,DX,MX,OX,"pointerup",TX,IX,NX,$X,"mouseup",FX,LX,BX,RX,"dblclick","wheel",PX,zX,jX,UX],qX=TX,WX=LX,HX=RX;class GX extends SX{constructor(t,e){super(t,e),this._down=null,this._touch=null,this._first=!0,this._events={},this.events=VX,this.pointermove=KX([TX,FX],[NX,BX],[IX,LX]),this.dragover=KX([MX],[CX],[DX]),this.pointerout=QX([IX,LX]),this.dragleave=QX([DX])}initialize(t,e,n){return this._canvas=t&&vX(t,"canvas"),[RX,$X,OX,TX,IX,DX].forEach((t=>XX(this,t))),super.initialize(t,e,n)}canvas(){return this._canvas}context(){return this._canvas.getContext("2d")}DOMMouseScroll(t){this.fire(PX,t)}pointerdown(t){this._down=this._active,this.fire(OX,t)}mousedown(t){this._down=this._active,this.fire($X,t)}click(t){this._down===this._active&&(this.fire(RX,t),this._down=null)}touchstart(t){this._touch=this.pickEvent(t.changedTouches[0]),this._first&&(this._active=this._touch,this._first=!1),this.fire(zX,t,!0)}touchmove(t){this.fire(jX,t,!0)}touchend(t){this.fire(UX,t,!0),this._touch=null}fire(t,e,n){const r=n?this._touch:this._active,i=this._handlers[t];if(e.vegaType=t,t===HX&&r&&r.href?this.handleHref(e,r,r.href):t!==qX&&t!==WX||this.handleTooltip(e,r,t!==WX),i)for(let t=0,n=i.length;t<n;++t)i[t].handler.call(this._obj,e,r)}on(t,e){const n=this.eventName(t),r=this._handlers;return this._handlerIndex(r[n],t,e)<0&&(XX(this,t),(r[n]||(r[n]=[])).push({type:t,handler:e})),this}off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&r.splice(i,1),this}pickEvent(t){const e=kX(t,this._canvas),n=this._origin;return this.pick(this._scene,e[0],e[1],e[0]-n[0],e[1]-n[1])}pick(t,e,n,r,i){const o=this.context();return lX[t.marktype].pick.call(this,o,t,e,n,r,i)}}const YX=t=>t===zX||t===jX||t===UX?[zX,jX,UX]:[t];function XX(t,e){YX(e).forEach((e=>function(t,e){const n=t.canvas();n&&!t._events[e]&&(t._events[e]=1,n.addEventListener(e,t[e]?n=>t[e](n):n=>t.fire(e,n)))}(t,e)))}function JX(t,e,n){e.forEach((e=>t.fire(e,n)))}function KX(t,e,n){return function(r){const i=this._active,o=this.pickEvent(r);o===i||(i&&i.exit||JX(this,n,r),this._active=o,JX(this,e,r)),JX(this,t,r)}}function QX(t){return function(e){JX(this,t,e),this._active=null}}class ZX extends AX{constructor(t){super(t),this._options={},this._redraw=!1,this._dirty=new hG,this._tempb=new hG}initialize(t,e,n,r,i,o){return this._options=o||{},this._canvas=this._options.externalContext?null:aV(1,1,this._options.type),t&&this._canvas&&(xX(t,0).appendChild(this._canvas),this._canvas.setAttribute("class","marks")),super.initialize(t,e,n,r,i)}resize(t,e,n,r){if(super.resize(t,e,n,r),this._canvas)!function(t,e,n,r,i,o){const s="undefined"!=typeof HTMLElement&&t instanceof HTMLElement&&null!=t.parentNode,a=t.getContext("2d"),l=s?"undefined"!=typeof window&&window.devicePixelRatio||1:i;t.width=e*l,t.height=n*l;for(const t in o)a[t]=o[t];s&&1!==l&&(t.style.width=e+"px",t.style.height=n+"px"),a.pixelRatio=l,a.setTransform(l,0,0,l,l*r[0],l*r[1])}(this._canvas,this._width,this._height,this._origin,this._scale,this._options.context);else{const t=this._options.externalContext;t||L$("CanvasRenderer is missing a valid canvas or context"),t.scale(this._scale,this._scale),t.translate(this._origin[0],this._origin[1])}return this._redraw=!0,this}canvas(){return this._canvas}context(){return this._options.externalContext||(this._canvas?this._canvas.getContext("2d"):null)}dirty(t){const e=this._tempb.clear().union(t.bounds);let n=t.mark.group;for(;n;)e.translate(n.x||0,n.y||0),n=n.mark.group;this._dirty.union(e)}_render(t,e){const n=this.context(),r=this._origin,i=this._width,o=this._height,s=this._dirty,a=tJ(r,i,o);n.save();const l=this._redraw||s.empty()?(this._redraw=!1,a.expand(1)):function(t,e,n){return e.expand(1).round(),t.pixelRatio%1&&e.scale(t.pixelRatio).round().scale(1/t.pixelRatio),e.translate(-n[0]%1,-n[1]%1),t.beginPath(),t.rect(e.x1,e.y1,e.width(),e.height()),t.clip(),e}(n,a.intersect(s),r);return this.clear(-r[0],-r[1],i,o),this.draw(n,t,l,e),n.restore(),s.clear(),this}draw(t,e,n,r){if("group"!==e.marktype&&null!=r&&!r.includes(e.marktype))return;const i=lX[e.marktype];e.clip&&function(t,e){var n=e.clip;t.save(),EF(n)?(t.beginPath(),n(t),t.clip()):yY(t,e.group)}(t,e),i.draw.call(this,t,e,n,r),e.clip&&t.restore()}clear(t,e,n,r){const i=this._options,o=this.context();"pdf"===i.type||i.externalContext||o.clearRect(t,e,n,r),null!=this._bgcolor&&(o.fillStyle=this._bgcolor,o.fillRect(t,e,n,r))}}const tJ=(t,e,n)=>(new hG).set(0,0,e,n).translate(-t[0],-t[1]);class eJ extends SX{constructor(t,e){super(t,e);const n=this;n._hrefHandler=nJ(n,((t,e)=>{e&&e.href&&n.handleHref(t,e,e.href)})),n._tooltipHandler=nJ(n,((t,e)=>{n.handleTooltip(t,e,t.type!==WX)}))}initialize(t,e,n){let r=this._svg;return r&&(r.removeEventListener(HX,this._hrefHandler),r.removeEventListener(qX,this._tooltipHandler),r.removeEventListener(WX,this._tooltipHandler)),this._svg=r=t&&vX(t,"svg"),r&&(r.addEventListener(HX,this._hrefHandler),r.addEventListener(qX,this._tooltipHandler),r.addEventListener(WX,this._tooltipHandler)),super.initialize(t,e,n)}canvas(){return this._svg}on(t,e){const n=this.eventName(t),r=this._handlers;if(this._handlerIndex(r[n],t,e)<0){const i={type:t,handler:e,listener:nJ(this,e)};(r[n]||(r[n]=[])).push(i),this._svg&&this._svg.addEventListener(n,i.listener)}return this}off(t,e){const n=this.eventName(t),r=this._handlers[n],i=this._handlerIndex(r,t,e);return i>=0&&(this._svg&&this._svg.removeEventListener(n,r[i].listener),r.splice(i,1)),this}}const nJ=(t,e)=>n=>{let r=n.target.__data__;r=Array.isArray(r)?r[0]:r,n.vegaType=n.type,e.call(t._obj,n,r)},rJ="aria-hidden",iJ="aria-label",oJ="role",sJ="aria-roledescription",aJ="graphics-object",lJ="graphics-symbol",uJ=(t,e,n)=>({[oJ]:t,[sJ]:e,[iJ]:n||void 0}),cJ=uL(["axis-domain","axis-grid","axis-label","axis-tick","axis-title","legend-band","legend-entry","legend-gradient","legend-label","legend-title","legend-symbol","title"]),hJ={axis:{desc:"axis",caption:function(t){const e=t.datum,n=t.orient,r=e.title?gJ(t):null,i=t.context,o=i.scales[e.scale].value,s=i.dataflow.locale(),a=o.type;return`${"left"===n||"right"===n?"Y":"X"}-axis`+(r?` titled '${r}'`:"")+` for a ${DW(a)?"discrete":a} scale`+` with ${uH(s,o,t)}`}},legend:{desc:"legend",caption:function(t){const e=t.datum,n=e.title?gJ(t):null,r=`${e.type||""} legend`.trim(),i=e.scales,o=Object.keys(i),s=t.context,a=s.scales[i[o[0]]].value,l=s.dataflow.locale();return((u=r).length?u[0].toUpperCase()+u.slice(1):u)+(n?` titled '${n}'`:"")+` for ${function(t){return(t=t.map((t=>t+("fill"===t||"stroke"===t?" color":"")))).length<2?t[0]:t.slice(0,-1).join(", ")+" and "+iF(t)}(o)}`+` with ${uH(l,a,t)}`;var u}},"title-text":{desc:"title",caption:t=>`Title text '${mJ(t)}'`},"title-subtitle":{desc:"subtitle",caption:t=>`Subtitle text '${mJ(t)}'`}},fJ={ariaRole:oJ,ariaRoleDescription:sJ,description:iJ};function dJ(t,e){const n=!1===e.aria;if(t(rJ,n||void 0),n||null==e.description)for(const e in fJ)t(fJ[e],void 0);else{const n=e.mark.marktype;t(iJ,e.description),t(oJ,e.ariaRole||("group"===n?aJ:lJ)),t(sJ,e.ariaRoleDescription||`${n} mark`)}}function pJ(t){return!1===t.aria?{[rJ]:!0}:cJ[t.role]?null:hJ[t.role]?function(t,e){try{const n=t.items[0],r=e.caption||(()=>"");return uJ(e.role||lJ,e.desc,n.description||r(n))}catch(t){return null}}(t,hJ[t.role]):function(t){const e=t.marktype,n="group"===e||"text"===e||t.items.some((t=>null!=t.description&&!1!==t.aria));return uJ(n?aJ:lJ,`${e} mark container`,t.description)}(t)}function mJ(t){return kF(t.text).join(" ")}function gJ(t){try{return kF(iF(t.items).items[0].text).join(" ")}catch(t){return null}}const yJ=t=>(t+"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),bJ=t=>yJ(t).replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;");function vJ(){let t="",e="",n="";const r=[],i=()=>e=n="",o=(t,n)=>(null!=n&&(e+=` ${t}="${bJ(n)}"`),s),s={open(a){(o=>{e&&(t+=`${e}>${n}`,i()),r.push(o)})(a),e="<"+a;for(var l=arguments.length,u=new Array(l>1?l-1:0),c=1;c<l;c++)u[c-1]=arguments[c];for(const t of u)for(const e in t)o(e,t[e]);return s},close(){const o=r.pop();return t+=e?e+(n?`>${n}</${o}>`:"/>"):`</${o}>`,i(),s},attr:o,text:t=>(n+=yJ(t),s),toString:()=>t};return s}const wJ=t=>xJ(vJ(),t)+"";function xJ(t,e){if(t.open(e.tagName),e.hasAttributes()){const n=e.attributes,r=n.length;for(let e=0;e<r;++e)t.attr(n[e].name,n[e].value)}if(e.hasChildNodes()){const n=e.childNodes;for(const e of n)3===e.nodeType?t.text(e.nodeValue):xJ(t,e)}return t.close()}const _J={fill:"fill",fillOpacity:"fill-opacity",stroke:"stroke",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",strokeCap:"stroke-linecap",strokeJoin:"stroke-linejoin",strokeDash:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeMiterLimit:"stroke-miterlimit",opacity:"opacity"},kJ={blend:"mix-blend-mode"},SJ={fill:"none","stroke-miterlimit":10},EJ="http://www.w3.org/2000/xmlns/",AJ=EY.xmlns;class CJ extends AX{constructor(t){super(t),this._dirtyID=0,this._dirty=[],this._svg=null,this._root=null,this._defs=null}initialize(t,e,n,r,i){return this._defs={},this._clearDefs(),t&&(this._svg=wX(t,0,"svg",AJ),this._svg.setAttributeNS(EJ,"xmlns",AJ),this._svg.setAttributeNS(EJ,"xmlns:xlink",EY["xmlns:xlink"]),this._svg.setAttribute("version",EY.version),this._svg.setAttribute("class","marks"),xX(t,1),this._root=wX(this._svg,0,"g",AJ),BJ(this._root,SJ),xX(this._svg,1)),this.background(this._bgcolor),super.initialize(t,e,n,r,i)}background(t){return arguments.length&&this._svg&&this._svg.style.setProperty("background-color",t),super.background(...arguments)}resize(t,e,n,r){return super.resize(t,e,n,r),this._svg&&(BJ(this._svg,{width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}),this._root.setAttribute("transform",`translate(${this._origin})`)),this._dirty=[],this}canvas(){return this._svg}svg(){const t=this._svg,e=this._bgcolor;if(!t)return null;let n;e&&(t.removeAttribute("style"),n=wX(t,0,"rect",AJ),BJ(n,{width:this._width,height:this._height,fill:e}));const r=wJ(t);return e&&(t.removeChild(n),this._svg.style.setProperty("background-color",e)),r}_render(t,e){return this._dirtyCheck()&&(this._dirtyAll&&this._clearDefs(),this.mark(this._root,t,void 0,e),xX(this._root,1)),this.defs(),this._dirty=[],++this._dirtyID,this}dirty(t){t.dirty!==this._dirtyID&&(t.dirty=this._dirtyID,this._dirty.push(t))}isDirty(t){return this._dirtyAll||!t._svg||!t._svg.ownerSVGElement||t.dirty===this._dirtyID}_dirtyCheck(){this._dirtyAll=!0;const t=this._dirty;if(!t.length||!this._dirtyID)return!0;const e=++this._dirtyID;let n,r,i,o,s,a,l;for(s=0,a=t.length;s<a;++s)n=t[s],r=n.mark,r.marktype!==i&&(i=r.marktype,o=lX[i]),r.zdirty&&r.dirty!==e&&(this._dirtyAll=!1,DJ(n,e),r.items.forEach((t=>{t.dirty=e}))),r.zdirty||(n.exit?(o.nested&&r.items.length?(l=r.items[0],l._svg&&this._update(o,l._svg,l)):n._svg&&(l=n._svg.parentNode,l&&l.removeChild(n._svg)),n._svg=null):(n=o.nested?r.items[0]:n,n._update!==e&&(n._svg&&n._svg.ownerSVGElement?this._update(o,n._svg,n):(this._dirtyAll=!1,DJ(n,e)),n._update=e)));return!this._dirtyAll}mark(t,e,n,r){if(!this.isDirty(e))return e._svg;const i=this._svg,o=e.marktype,s=lX[o],a=!1===e.interactive?"none":null,l="g"===s.tag,u=TJ(e,t,n,"g",i);if("group"!==o&&null!=r&&!r.includes(o))return xX(u,0),e._svg;u.setAttribute("class",_X(e));const c=pJ(e);for(const t in c)RJ(u,t,c[t]);l||RJ(u,"pointer-events",a),RJ(u,"clip-path",e.clip?cG(this,e,e.group):null);let h=null,f=0;const d=t=>{const e=this.isDirty(t),n=TJ(t,u,h,s.tag,i);e&&(this._update(s,n,t),l&&function(t,e,n,r){e=e.lastChild.previousSibling;let i,o=0;nY(n,(n=>{i=t.mark(e,n,i,r),++o})),xX(e,1+o)}(this,n,t,r)),h=n,++f};return s.nested?e.items.length&&d(e.items[0]):nY(e,d),xX(u,f),u}_update(t,e,n){IJ=e,NJ=e.__values__,dJ(FJ,n),t.attr(FJ,n,this);const r=$J[t.type];r&&r.call(this,t,e,n),IJ&&this.style(IJ,n)}style(t,e){if(null!=e){for(const n in _J){let r="font"===n?ZY(e):e[n];if(r===NJ[n])continue;const i=_J[n];null==r?t.removeAttribute(i):(fH(r)&&(r=dH(r,this._defs.gradient,PJ())),t.setAttribute(i,r+"")),NJ[n]=r}for(const n in kJ)LJ(t,kJ[n],e[n])}}defs(){const t=this._svg,e=this._defs;let n=e.el,r=0;for(const i in e.gradient)n||(e.el=n=wX(t,1,"defs",AJ)),r=MJ(n,e.gradient[i],r);for(const i in e.clipping)n||(e.el=n=wX(t,1,"defs",AJ)),r=OJ(n,e.clipping[i],r);n&&(0===r?(t.removeChild(n),e.el=null):xX(n,r))}_clearDefs(){const t=this._defs;t.gradient={},t.clipping={}}}function DJ(t,e){for(;t&&t.dirty!==e;t=t.mark.group){if(t.dirty=e,!t.mark||t.mark.dirty===e)return;t.mark.dirty=e}}function MJ(t,e,n){let r,i,o;if("radial"===e.gradient){let r=wX(t,n++,"pattern",AJ);BJ(r,{id:hH+e.id,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),r=wX(r,0,"rect",AJ),BJ(r,{width:1,height:1,fill:`url(${PJ()}#${e.id})`}),BJ(t=wX(t,n++,"radialGradient",AJ),{id:e.id,fx:e.x1,fy:e.y1,fr:e.r1,cx:e.x2,cy:e.y2,r:e.r2})}else BJ(t=wX(t,n++,"linearGradient",AJ),{id:e.id,x1:e.x1,x2:e.x2,y1:e.y1,y2:e.y2});for(r=0,i=e.stops.length;r<i;++r)o=wX(t,r,"stop",AJ),o.setAttribute("offset",e.stops[r].offset),o.setAttribute("stop-color",e.stops[r].color);return xX(t,r),n}function OJ(t,e,n){let r;return(t=wX(t,n,"clipPath",AJ)).setAttribute("id",e.id),e.path?(r=wX(t,0,"path",AJ),r.setAttribute("d",e.path)):(r=wX(t,0,"rect",AJ),BJ(r,{x:0,y:0,width:e.width,height:e.height})),xX(t,1),n+1}function TJ(t,e,n,r,i){let o,s=t._svg;if(!s&&(o=e.ownerDocument,s=bX(o,r,AJ),t._svg=s,t.mark&&(s.__data__=t,s.__values__={fill:"default"},"g"===r))){const e=bX(o,"path",AJ);s.appendChild(e),e.__data__=t;const n=bX(o,"g",AJ);s.appendChild(n),n.__data__=t;const r=bX(o,"path",AJ);s.appendChild(r),r.__data__=t,r.__values__={fill:"default"}}return(s.ownerSVGElement!==i||function(t,e){return t.parentNode&&t.parentNode.childNodes.length>1&&t.previousSibling!=e}(s,n))&&e.insertBefore(s,n?n.nextSibling:e.firstChild),s}let IJ=null,NJ=null;const $J={group(t,e,n){const r=IJ=e.childNodes[2];NJ=r.__values__,t.foreground(FJ,n,this),NJ=e.__values__,IJ=e.childNodes[1],t.content(FJ,n,this);const i=IJ=e.childNodes[0];t.background(FJ,n,this);const o=!1===n.mark.interactive?"none":null;if(o!==NJ.events&&(RJ(r,"pointer-events",o),RJ(i,"pointer-events",o),NJ.events=o),n.strokeForeground&&n.stroke){const t=n.fill;RJ(r,"display",null),this.style(i,n),RJ(i,"stroke",null),t&&(n.fill=null),NJ=r.__values__,this.style(r,n),t&&(n.fill=t),IJ=null}else RJ(r,"display","none")},image(t,e,n){!1===n.smooth?(LJ(e,"image-rendering","optimizeSpeed"),LJ(e,"image-rendering","pixelated")):LJ(e,"image-rendering",null)},text(t,e,n){const r=JY(n);let i,o,s,a;Q$(r)?(o=r.map((t=>QY(n,t))),i=o.join("\n"),i!==NJ.text&&(xX(e,0),s=e.ownerDocument,a=XY(n),o.forEach(((t,r)=>{const i=bX(s,"tspan",AJ);i.__data__=n,i.textContent=t,r&&(i.setAttribute("x",0),i.setAttribute("dy",a)),e.appendChild(i)})),NJ.text=i)):(o=QY(n,r),o!==NJ.text&&(e.textContent=o,NJ.text=o)),RJ(e,"font-family",ZY(n)),RJ(e,"font-size",YY(n)+"px"),RJ(e,"font-style",n.fontStyle),RJ(e,"font-variant",n.fontVariant),RJ(e,"font-weight",n.fontWeight)}};function FJ(t,e,n){e!==NJ[t]&&(n?function(t,e,n,r){null!=n?t.setAttributeNS(r,e,n):t.removeAttributeNS(r,e)}(IJ,t,e,n):RJ(IJ,t,e),NJ[t]=e)}function LJ(t,e,n){n!==NJ[e]&&(null==n?t.style.removeProperty(e):t.style.setProperty(e,n+""),NJ[e]=n)}function BJ(t,e){for(const n in e)RJ(t,n,e[n])}function RJ(t,e,n){null!=n?t.setAttribute(e,n):t.removeAttribute(e)}function PJ(){let t;return"undefined"==typeof window?"":(t=window.location).hash?t.href.slice(0,-t.hash.length):t.href}class zJ extends AX{constructor(t){super(t),this._text=null,this._defs={gradient:{},clipping:{}}}svg(){return this._text}_render(t){const e=vJ();e.open("svg",$F({},EY,{class:"marks",width:this._width*this._scale,height:this._height*this._scale,viewBox:`0 0 ${this._width} ${this._height}`}));const n=this._bgcolor;return n&&"transparent"!==n&&"none"!==n&&e.open("rect",{width:this._width,height:this._height,fill:n}).close(),e.open("g",SJ,{transform:"translate("+this._origin+")"}),this.mark(e,t),e.close(),this.defs(e),this._text=e.close()+"",this}mark(t,e){const n=lX[e.marktype],r=n.tag,i=[dJ,n.attr];t.open("g",{class:_X(e),"clip-path":e.clip?cG(this,e,e.group):null},pJ(e),{"pointer-events":"g"!==r&&!1===e.interactive?"none":null});const o=o=>{const s=this.href(o);if(s&&t.open("a",s),t.open(r,this.attr(e,o,i,"g"!==r?r:null)),"text"===r){const e=JY(o);if(Q$(e)){const n={x:0,dy:XY(o)};for(let r=0;r<e.length;++r)t.open("tspan",r?n:null).text(QY(o,e[r])).close()}else t.text(QY(o,e))}else if("g"===r){const r=o.strokeForeground,i=o.fill,s=o.stroke;r&&s&&(o.stroke=null),t.open("path",this.attr(e,o,n.background,"bgrect")).close(),t.open("g",this.attr(e,o,n.content)),nY(o,(e=>this.mark(t,e))),t.close(),r&&s?(i&&(o.fill=null),o.stroke=s,t.open("path",this.attr(e,o,n.foreground,"bgrect")).close(),i&&(o.fill=i)):t.open("path",this.attr(e,o,n.foreground,"bgfore")).close()}t.close(),s&&t.close()};return n.nested?e.items&&e.items.length&&o(e.items[0]):nY(e,o),t.close()}href(t){const e=t.href;let n;if(e){if(n=this._hrefs&&this._hrefs[e])return n;this.sanitizeURL(e).then((t=>{t["xlink:href"]=t.href,t.href=null,(this._hrefs||(this._hrefs={}))[e]=t}))}return null}attr(t,e,n,r){const i={},o=(t,e,n,r)=>{i[r||t]=e};return Array.isArray(n)?n.forEach((t=>t(o,e,this))):n(o,e,this),r&&function(t,e,n,r,i){let o;if(null==e)return t;if("bgrect"===r&&!1===n.interactive&&(t["pointer-events"]="none"),"bgfore"===r&&(!1===n.interactive&&(t["pointer-events"]="none"),t.display="none",null!==e.fill))return t;"image"===r&&!1===e.smooth&&(o=["image-rendering: optimizeSpeed;","image-rendering: pixelated;"]),"text"===r&&(t["font-family"]=ZY(e),t["font-size"]=YY(e)+"px",t["font-style"]=e.fontStyle,t["font-variant"]=e.fontVariant,t["font-weight"]=e.fontWeight);for(const n in _J){let r=e[n];const o=_J[n];("transparent"!==r||"fill"!==o&&"stroke"!==o)&&null!=r&&(fH(r)&&(r=dH(r,i.gradient,"")),t[o]=r)}for(const t in kJ){const n=e[t];null!=n&&(o=o||[],o.push(`${kJ[t]}: ${n};`))}o&&(t.style=o.join(" "))}(i,e,t,r,this._defs),i}defs(t){const e=this._defs.gradient,n=this._defs.clipping;if(0!==Object.keys(e).length+Object.keys(n).length){t.open("defs");for(const n in e){const r=e[n],i=r.stops;"radial"===r.gradient?(t.open("pattern",{id:hH+n,viewBox:"0,0,1,1",width:"100%",height:"100%",preserveAspectRatio:"xMidYMid slice"}),t.open("rect",{width:"1",height:"1",fill:"url(#"+n+")"}).close(),t.close(),t.open("radialGradient",{id:n,fx:r.x1,fy:r.y1,fr:r.r1,cx:r.x2,cy:r.y2,r:r.r2})):t.open("linearGradient",{id:n,x1:r.x1,x2:r.x2,y1:r.y1,y2:r.y2});for(let e=0;e<i.length;++e)t.open("stop",{offset:i[e].offset,"stop-color":i[e].color}).close();t.close()}for(const e in n){const r=n[e];t.open("clipPath",{id:e}),r.path?t.open("path",{d:r.path}).close():t.open("rect",{x:0,y:0,width:r.width,height:r.height}).close(),t.close()}t.close()}}}const jJ={svgMarkTypes:["text"],svgOnTop:!0,debug:!1};function UJ(t){jJ.svgMarkTypes=t.svgMarkTypes??["text"],jJ.svgOnTop=t.svgOnTop??!0,jJ.debug=t.debug??!1}class VJ extends AX{constructor(t){super(t),this._svgRenderer=new CJ(t),this._canvasRenderer=new ZX(t)}initialize(t,e,n,r,i){this._root_el=wX(t,0,"div");const o=wX(this._root_el,0,"div"),s=wX(this._root_el,1,"div");return this._root_el.style.position="relative",jJ.debug||(o.style.height="100%",s.style.position="absolute",s.style.top="0",s.style.left="0",s.style.height="100%",s.style.width="100%"),this._svgEl=jJ.svgOnTop?s:o,this._canvasEl=jJ.svgOnTop?o:s,this._svgEl.style.pointerEvents="none",this._canvasRenderer.initialize(this._canvasEl,e,n,r,i),this._svgRenderer.initialize(this._svgEl,e,n,r,i),super.initialize(t,e,n,r,i)}dirty(t){return jJ.svgMarkTypes.includes(t.mark.marktype)?this._svgRenderer.dirty(t):this._canvasRenderer.dirty(t),this}_render(t,e){const n=(e??["arc","area","image","line","path","rect","rule","shape","symbol","text","trail"]).filter((t=>!jJ.svgMarkTypes.includes(t)));this._svgRenderer.render(t,jJ.svgMarkTypes),this._canvasRenderer.render(t,n)}resize(t,e,n,r){return super.resize(t,e,n,r),this._svgRenderer.resize(t,e,n,r),this._canvasRenderer.resize(t,e,n,r),this}background(t){return jJ.svgOnTop?this._canvasRenderer.background(t):this._svgRenderer.background(t),this}}class qJ extends GX{constructor(t,e){super(t,e)}initialize(t,e,n){const r=wX(wX(t,0,"div"),jJ.svgOnTop?0:1,"div");return super.initialize(r,e,n)}}const WJ="canvas",HJ="hybrid",GJ="none",YJ={Canvas:WJ,PNG:"png",SVG:"svg",Hybrid:HJ,None:GJ},XJ={};function JJ(t,e){return t=String(t||"").toLowerCase(),arguments.length>1?(XJ[t]=e,this):XJ[t]}function KJ(t,e,n){const r=[],i=(new hG).union(e),o=t.marktype;return o?QJ(t,i,n,r):"group"===o?ZJ(t,i,n,r):L$("Intersect scene must be mark node or group item.")}function QJ(t,e,n,r){if(function(t,e,n){return t.bounds&&e.intersects(t.bounds)&&("group"===t.marktype||!1!==t.interactive&&(!n||n(t)))}(t,e,n)){const i=t.items,o=t.marktype,s=i.length;let a=0;if("group"===o)for(;a<s;++a)ZJ(i[a],e,n,r);else for(const t=lX[o].isect;a<s;++a){const n=i[a];tK(n,e,t)&&r.push(n)}}return r}function ZJ(t,e,n,r){n&&n(t.mark)&&tK(t,e,lX.group.isect)&&r.push(t);const i=t.items,o=i&&i.length;if(o){const s=t.x||0,a=t.y||0;e.translate(-s,-a);for(let t=0;t<o;++t)QJ(i[t],e,n,r);e.translate(s,a)}return r}function tK(t,e,n){const r=t.bounds;return e.encloses(r)||e.intersects(r)&&n(t,e)}XJ[WJ]=XJ.png={renderer:ZX,headless:ZX,handler:GX},XJ.svg={renderer:CJ,headless:zJ,handler:eJ},XJ[HJ]={renderer:VJ,headless:VJ,handler:qJ},XJ[GJ]={};const eK=new hG;function nK(t){const e=t.clip;if(EF(e))e(FG(eK.clear()));else{if(!e)return;eK.set(0,0,t.group.width,t.group.height)}t.bounds.intersect(eK)}const rK=1e-9;function iK(t,e,n){return t===e||("path"===n?oK(t,e):t instanceof Date&&e instanceof Date?+t==+e:GF(t)&&GF(e)?Math.abs(t-e)<=rK:t&&e&&(Z$(t)||Z$(e))?function(t,e){var n,r,i=Object.keys(t),o=Object.keys(e);if(i.length!==o.length)return!1;for(i.sort(),o.sort(),r=i.length-1;r>=0;r--)if(i[r]!=o[r])return!1;for(r=i.length-1;r>=0;r--)if(!iK(t[n=i[r]],e[n],n))return!1;return typeof t==typeof e}(t,e):t==e)}function oK(t,e){return iK(kH(t),kH(e))}function sK(){uG(),cH=0}const aK="top",lK="left",uK="right",cK="bottom",hK="start",fK="middle",dK="end",pK="x",mK="y",gK="group",yK="axis",bK="title",vK="legend",wK="row-header",xK="row-footer",_K="row-title",kK="column-header",SK="column-footer",EK="column-title",AK="fit-x",CK="fit-y",DK="none",MK="all",OK="each",TK="flush",IK="column",NK="row";function $K(t){dP.call(this,null,t)}function FK(t,e,n){return e(t.bounds.clear(),t,n)}UF($K,dP,{transform(t,e){const n=e.dataflow,r=t.mark,i=r.marktype,o=lX[i],s=o.bound;let a,l=r.bounds;if(o.nested)r.items.length&&n.dirty(r.items[0]),l=FK(r,s),r.items.forEach((t=>{t.bounds.clear().union(l)}));else if(i===gK||t.modified())switch(e.visit(e.MOD,(t=>n.dirty(t))),l.clear(),r.items.forEach((t=>l.union(FK(t,s)))),r.role){case yK:case vK:case bK:e.reflow()}else a=e.changed(e.REM),e.visit(e.ADD,(t=>{l.union(FK(t,s))})),e.visit(e.MOD,(t=>{a=a||l.alignsWith(t.bounds),n.dirty(t),l.union(FK(t,s))})),a&&(l.clear(),r.items.forEach((t=>l.union(t.bounds))));return nK(r),e.modifies("bounds")}});const LK=":vega_identifier:";function BK(t){dP.call(this,0,t)}function RK(t){dP.call(this,null,t)}function PK(t){dP.call(this,null,t)}BK.Definition={type:"Identifier",metadata:{modifies:!0},params:[{name:"as",type:"string",required:!0}]},UF(BK,dP,{transform(t,e){const n=(i=e.dataflow)._signals[LK]||(i._signals[LK]=i.add(0)),r=t.as;var i;let o=n.value;return e.visit(e.ADD,(t=>t[r]=t[r]||++o)),n.set(this.value=o),e}}),UF(RK,dP,{transform(t,e){let n=this.value;n||(n=e.dataflow.scenegraph().mark(t.markdef,function(t){const e=t.groups,n=t.parent;return e&&1===e.size?e.get(Object.keys(e.object)[0]):e&&n?e.lookup(n):null}(t),t.index),n.group.context=t.context,t.context.group||(t.context.group=n.group),n.source=this.source,n.clip=t.clip,n.interactive=t.interactive,this.value=n);const r=n.marktype===gK?dG:fG;return e.visit(e.ADD,(t=>r.call(t,n))),(t.modified("clip")||t.modified("interactive"))&&(n.clip=t.clip,n.interactive=!!t.interactive,n.zdirty=!0,e.reflow()),n.items=e.source,e}});const zK={parity:t=>t.filter(((t,e)=>e%2?t.opacity=0:1)),greedy:(t,e)=>{let n;return t.filter(((t,r)=>r&&jK(n.bounds,t.bounds,e)?t.opacity=0:(n=t,1)))}},jK=(t,e,n)=>n>Math.max(e.x1-t.x2,t.x1-e.x2,e.y1-t.y2,t.y1-e.y2),UK=(t,e)=>{for(var n,r=1,i=t.length,o=t[0].bounds;r<i;o=n,++r)if(jK(o,n=t[r].bounds,e))return!0},VK=t=>{const e=t.bounds;return e.width()>1&&e.height()>1},qK=t=>(t.forEach((t=>t.opacity=1)),t),WK=(t,e)=>t.reflow(e.modified()).modifies("opacity");function HK(t){dP.call(this,null,t)}UF(PK,dP,{transform(t,e){const n=zK[t.method]||zK.parity,r=t.separation||0;let i,o,s=e.materialize(e.SOURCE).source;if(!s||!s.length)return;if(!t.method)return t.modified("method")&&(qK(s),e=WK(e,t)),e;if(s=s.filter(VK),!s.length)return;if(t.sort&&(s=s.slice().sort(t.sort)),i=qK(s),e=WK(e,t),i.length>=3&&UK(i,r)){do{i=n(i,r)}while(i.length>=3&&UK(i,r));i.length<3&&!iF(s).opacity&&(i.length>1&&(iF(i).opacity=0),iF(s).opacity=1)}t.boundScale&&t.boundTolerance>=0&&(o=((t,e,n)=>{var r=t.range(),i=new hG;return e===aK||e===cK?i.set(r[0],-1/0,r[1],1/0):i.set(-1/0,r[0],1/0,r[1]),i.expand(n||1),t=>i.encloses(t.bounds)})(t.boundScale,t.boundOrient,+t.boundTolerance),s.forEach((t=>{o(t)||(t.opacity=0)})));const a=i[0].mark.bounds.clear();return s.forEach((t=>{t.opacity&&a.union(t.bounds)})),e}}),UF(HK,dP,{transform(t,e){const n=e.dataflow;if(e.visit(e.ALL,(t=>n.dirty(t))),e.fields&&e.fields.zindex){const t=e.source&&e.source[0];t&&(t.mark.zdirty=!0)}}});const GK=new hG;function YK(t,e,n){return t[e]===n?0:(t[e]=n,1)}function XK(t){var e=t.items[0].orient;return e===lK||e===uK}function JK(t,e,n,r){var i,o,s=e.items[0],a=s.datum,l=null!=s.translate?s.translate:.5,u=s.orient,c=function(t){let e=+t.grid;return[t.ticks?e++:-1,t.labels?e++:-1,e+ +t.domain]}(a),h=s.range,f=s.offset,d=s.position,p=s.minExtent,m=s.maxExtent,g=a.title&&s.items[c[2]].items[0],y=s.titlePadding,b=s.bounds,v=g&&KY(g),w=0,x=0;switch(GK.clear().union(b),b.clear(),(i=c[0])>-1&&b.union(s.items[i].bounds),(i=c[1])>-1&&b.union(s.items[i].bounds),u){case aK:w=d||0,x=-f,o=Math.max(p,Math.min(m,-b.y1)),b.add(0,-o).add(h,0),g&&KK(t,g,o,y,v,0,-1,b);break;case lK:w=-f,x=d||0,o=Math.max(p,Math.min(m,-b.x1)),b.add(-o,0).add(0,h),g&&KK(t,g,o,y,v,1,-1,b);break;case uK:w=n+f,x=d||0,o=Math.max(p,Math.min(m,b.x2)),b.add(0,0).add(o,h),g&&KK(t,g,o,y,v,1,1,b);break;case cK:w=d||0,x=r+f,o=Math.max(p,Math.min(m,b.y2)),b.add(0,0).add(h,o),g&&KK(t,g,o,y,0,0,1,b);break;default:w=s.x,x=s.y}return yG(b.translate(w,x),s),YK(s,"x",w+l)|YK(s,"y",x+l)&&(s.bounds=GK,t.dirty(s),s.bounds=b,t.dirty(s)),s.mark.bounds.clear().union(b)}function KK(t,e,n,r,i,o,s,a){const l=e.bounds;if(e.auto){const a=s*(n+i+r);let u=0,c=0;t.dirty(e),o?u=(e.x||0)-(e.x=a):c=(e.y||0)-(e.y=a),e.mark.bounds.clear().union(l.translate(-u,-c)),t.dirty(e)}a.union(l)}const QK=(t,e)=>Math.floor(Math.min(t,e)),ZK=(t,e)=>Math.ceil(Math.max(t,e));function tQ(t){return(new hG).set(0,0,t.width||0,t.height||0)}function eQ(t){const e=t.bounds.clone();return e.empty()?e.set(0,0,0,0):e.translate(-(t.x||0),-(t.y||0))}function nQ(t,e,n){const r=Z$(t)?t[e]:t;return null!=r?r:void 0!==n?n:0}function rQ(t){return t<0?Math.ceil(-t):0}function iQ(t,e,n){var r,i,o,s,a,l,u,c,h,f,d,p=!n.nodirty,m=n.bounds===TK?tQ:eQ,g=GK.set(0,0,0,0),y=nQ(n.align,IK),b=nQ(n.align,NK),v=nQ(n.padding,IK),w=nQ(n.padding,NK),x=n.columns||e.length,_=x<=0?1:Math.ceil(e.length/x),k=e.length,S=Array(k),E=Array(x),A=0,C=Array(k),D=Array(_),M=0,O=Array(k),T=Array(k),I=Array(k);for(i=0;i<x;++i)E[i]=0;for(i=0;i<_;++i)D[i]=0;for(i=0;i<k;++i)l=e[i],a=I[i]=m(l),l.x=l.x||0,O[i]=0,l.y=l.y||0,T[i]=0,o=i%x,s=~~(i/x),A=Math.max(A,u=Math.ceil(a.x2)),M=Math.max(M,c=Math.ceil(a.y2)),E[o]=Math.max(E[o],u),D[s]=Math.max(D[s],c),S[i]=v+rQ(a.x1),C[i]=w+rQ(a.y1),p&&t.dirty(e[i]);for(i=0;i<k;++i)i%x==0&&(S[i]=0),i<x&&(C[i]=0);if(y===OK)for(o=1;o<x;++o){for(d=0,i=o;i<k;i+=x)d<S[i]&&(d=S[i]);for(i=o;i<k;i+=x)S[i]=d+E[o-1]}else if(y===MK){for(d=0,i=0;i<k;++i)i%x&&d<S[i]&&(d=S[i]);for(i=0;i<k;++i)i%x&&(S[i]=d+A)}else for(y=!1,o=1;o<x;++o)for(i=o;i<k;i+=x)S[i]+=E[o-1];if(b===OK)for(s=1;s<_;++s){for(d=0,r=(i=s*x)+x;i<r;++i)d<C[i]&&(d=C[i]);for(i=s*x;i<r;++i)C[i]=d+D[s-1]}else if(b===MK){for(d=0,i=x;i<k;++i)d<C[i]&&(d=C[i]);for(i=x;i<k;++i)C[i]=d+M}else for(b=!1,s=1;s<_;++s)for(r=(i=s*x)+x;i<r;++i)C[i]+=D[s-1];for(h=0,i=0;i<k;++i)h=S[i]+(i%x?h:0),O[i]+=h-e[i].x;for(o=0;o<x;++o)for(f=0,i=o;i<k;i+=x)f+=C[i],T[i]+=f-e[i].y;if(y&&nQ(n.center,IK)&&_>1)for(i=0;i<k;++i)(h=(a=y===MK?A:E[i%x])-I[i].x2-e[i].x-O[i])>0&&(O[i]+=h/2);if(b&&nQ(n.center,NK)&&1!==x)for(i=0;i<k;++i)(f=(a=b===MK?M:D[~~(i/x)])-I[i].y2-e[i].y-T[i])>0&&(T[i]+=f/2);for(i=0;i<k;++i)g.union(I[i].translate(O[i],T[i]));switch(h=nQ(n.anchor,pK),f=nQ(n.anchor,mK),nQ(n.anchor,IK)){case dK:h-=g.width();break;case fK:h-=g.width()/2}switch(nQ(n.anchor,NK)){case dK:f-=g.height();break;case fK:f-=g.height()/2}for(h=Math.round(h),f=Math.round(f),g.clear(),i=0;i<k;++i)e[i].mark.bounds.clear();for(i=0;i<k;++i)(l=e[i]).x+=O[i]+=h,l.y+=T[i]+=f,g.union(l.mark.bounds.union(l.bounds.translate(O[i],T[i]))),p&&t.dirty(l);return g}function oQ(t,e){return"x1"===e?t.x||0:"y1"===e?t.y||0:"x2"===e?(t.x||0)+(t.width||0):"y2"===e?(t.y||0)+(t.height||0):void 0}function sQ(t,e){return t.bounds[e]}function aQ(t,e,n,r,i,o,s,a,l,u,c,h,f,d){var p,m,g,y,b,v,w,x,_,k=n.length,S=0,E=0;if(!k)return S;for(p=c;p<k;p+=h)n[p]&&(S=s(S,l(n[p],u)));if(!e.length)return S;for(e.length>i&&(t.warn("Grid headers exceed limit: "+i),e=e.slice(0,i)),S+=o,m=0,y=e.length;m<y;++m)t.dirty(e[m]),e[m].mark.bounds.clear();for(p=c,m=0,y=e.length;m<y;++m,p+=h){for(b=(v=e[m]).mark.bounds,g=p;g>=0&&null==(w=n[g]);g-=f);a?(x=null==d?w.x:Math.round(w.bounds.x1+d*w.bounds.width()),_=S):(x=S,_=null==d?w.y:Math.round(w.bounds.y1+d*w.bounds.height())),b.union(v.bounds.translate(x-(v.x||0),_-(v.y||0))),v.x=x,v.y=_,t.dirty(v),E=s(E,b[u])}return E}function lQ(t,e,n,r,i,o){if(e){t.dirty(e);var s=n,a=n;r?s=Math.round(i.x1+o*i.width()):a=Math.round(i.y1+o*i.height()),e.bounds.translate(s-(e.x||0),a-(e.y||0)),e.mark.bounds.clear().union(e.bounds),e.x=s,e.y=a,t.dirty(e)}}function uQ(t,e,n,r,i,o,s){const a=function(t,e){const n=t[e]||{};return(e,r)=>null!=n[e]?n[e]:null!=t[e]?t[e]:r}(n,e),l=function(t,e){let n=-1/0;return t.forEach((t=>{null!=t.offset&&(n=Math.max(n,t.offset))})),n>-1/0?n:e}(t,a("offset",0)),u=a("anchor",hK),c=u===dK?1:u===fK?.5:0,h={align:OK,bounds:a("bounds",TK),columns:"vertical"===a("direction")?1:t.length,padding:a("margin",8),center:a("center"),nodirty:!0};switch(e){case lK:h.anchor={x:Math.floor(r.x1)-l,column:dK,y:c*(s||r.height()+2*r.y1),row:u};break;case uK:h.anchor={x:Math.ceil(r.x2)+l,y:c*(s||r.height()+2*r.y1),row:u};break;case aK:h.anchor={y:Math.floor(i.y1)-l,row:dK,x:c*(o||i.width()+2*i.x1),column:u};break;case cK:h.anchor={y:Math.ceil(i.y2)+l,x:c*(o||i.width()+2*i.x1),column:u};break;case"top-left":h.anchor={x:l,y:l};break;case"top-right":h.anchor={x:o-l,y:l,column:dK};break;case"bottom-left":h.anchor={x:l,y:s-l,row:dK};break;case"bottom-right":h.anchor={x:o-l,y:s-l,column:dK,row:dK}}return h}function cQ(t,e){var n,r,i=e.items[0],o=i.datum,s=i.orient,a=i.bounds,l=i.x,u=i.y;return i._bounds?i._bounds.clear().union(a):i._bounds=a.clone(),a.clear(),function(t,e,n){var r=e.padding,i=r-n.x,o=r-n.y;if(e.datum.title){var s=e.items[1].items[0],a=s.anchor,l=e.titlePadding||0,u=r-s.x,c=r-s.y;switch(s.orient){case lK:i+=Math.ceil(s.bounds.width())+l;break;case uK:case cK:break;default:o+=s.bounds.height()+l}switch((i||o)&&fQ(t,n,i,o),s.orient){case lK:c+=hQ(e,n,s,a,1,1);break;case uK:u+=hQ(e,n,s,dK,0,0)+l,c+=hQ(e,n,s,a,1,1);break;case cK:u+=hQ(e,n,s,a,0,0),c+=hQ(e,n,s,dK,-1,0,1)+l;break;default:u+=hQ(e,n,s,a,0,0)}(u||c)&&fQ(t,s,u,c),(u=Math.round(s.bounds.x1-r))<0&&(fQ(t,n,-u,0),fQ(t,s,-u,0))}else(i||o)&&fQ(t,n,i,o)}(t,i,i.items[0].items[0]),a=function(t,e){return t.items.forEach((t=>e.union(t.bounds))),e.x1=t.padding,e.y1=t.padding,e}(i,a),n=2*i.padding,r=2*i.padding,a.empty()||(n=Math.ceil(a.width()+n),r=Math.ceil(a.height()+r)),"symbol"===o.type&&function(t){const e=t.reduce(((t,e)=>(t[e.column]=Math.max(e.bounds.x2-e.x,t[e.column]||0),t)),{});t.forEach((t=>{t.width=e[t.column],t.height=t.bounds.y2-t.y}))}(i.items[0].items[0].items[0].items),s!==DK&&(i.x=l=0,i.y=u=0),i.width=n,i.height=r,yG(a.set(l,u,l+n,u+r),i),i.mark.bounds.clear().union(a),i}function hQ(t,e,n,r,i,o,s){const a="symbol"!==t.datum.type,l=n.datum.vgrad,u=(!a||!o&&l||s?e:e.items[0]).bounds[i?"y2":"x2"]-t.padding,c=l&&o?u:0,h=l&&o?0:u,f=i<=0?0:KY(n);return Math.round(r===hK?c:r===dK?h-f:.5*(u-f))}function fQ(t,e,n,r){e.x+=n,e.y+=r,e.bounds.translate(n,r),e.mark.bounds.translate(n,r),t.dirty(e)}function dQ(t){dP.call(this,null,t)}function pQ(t,e){let n=0;if(void 0===e)for(let e of t)(e=+e)&&(n+=e);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&(n+=i)}return n}function mQ(t){dP.call(this,null,t)}function gQ(t){dP.call(this,null,t)}function yQ(){return BR({})}function bQ(t){dP.call(this,null,t)}function vQ(t){dP.call(this,[],t)}UF(dQ,dP,{transform(t,e){const n=e.dataflow;return t.mark.items.forEach((e=>{t.layout&&function(t,e,n){var r,i,o,s,a,l,u,c=function(t){var e,n,r=t.items,i=r.length,o=0;const s={marks:[],rowheaders:[],rowfooters:[],colheaders:[],colfooters:[],rowtitle:null,coltitle:null};for(;o<i;++o)if(n=(e=r[o]).items,e.marktype===gK)switch(e.role){case yK:case vK:case bK:break;case wK:s.rowheaders.push(...n);break;case xK:s.rowfooters.push(...n);break;case kK:s.colheaders.push(...n);break;case SK:s.colfooters.push(...n);break;case _K:s.rowtitle=n[0];break;case EK:s.coltitle=n[0];break;default:s.marks.push(...n)}return s}(e),h=c.marks,f=n.bounds===TK?oQ:sQ,d=n.offset,p=n.columns||h.length,m=p<=0?1:Math.ceil(h.length/p),g=m*p;const y=iQ(t,h,n);y.empty()&&y.set(0,0,0,0),c.rowheaders&&(l=nQ(n.headerBand,NK,null),r=aQ(t,c.rowheaders,h,0,m,-nQ(d,"rowHeader"),QK,0,f,"x1",0,p,1,l)),c.colheaders&&(l=nQ(n.headerBand,IK,null),i=aQ(t,c.colheaders,h,0,p,-nQ(d,"columnHeader"),QK,1,f,"y1",0,1,p,l)),c.rowfooters&&(l=nQ(n.footerBand,NK,null),o=aQ(t,c.rowfooters,h,0,m,nQ(d,"rowFooter"),ZK,0,f,"x2",p-1,p,1,l)),c.colfooters&&(l=nQ(n.footerBand,IK,null),s=aQ(t,c.colfooters,h,0,p,nQ(d,"columnFooter"),ZK,1,f,"y2",g-p,1,p,l)),c.rowtitle&&(a=nQ(n.titleAnchor,NK),u=nQ(d,"rowTitle"),u=a===dK?o+u:r-u,l=nQ(n.titleBand,NK,.5),lQ(t,c.rowtitle,u,0,y,l)),c.coltitle&&(a=nQ(n.titleAnchor,IK),u=nQ(d,"columnTitle"),u=a===dK?s+u:i-u,l=nQ(n.titleBand,IK,.5),lQ(t,c.coltitle,u,1,y,l))}(n,e,t.layout),function(t,e,n){var r,i,o,s,a,l=e.items,u=Math.max(0,e.width||0),c=Math.max(0,e.height||0),h=(new hG).set(0,0,u,c),f=h.clone(),d=h.clone(),p=[];for(s=0,a=l.length;s<a;++s)switch((i=l[s]).role){case yK:(XK(i)?f:d).union(JK(t,i,u,c));break;case bK:r=i;break;case vK:p.push(cQ(t,i));break;case"frame":case"scope":case wK:case xK:case _K:case kK:case SK:case EK:f.union(i.bounds),d.union(i.bounds);break;default:h.union(i.bounds)}if(p.length){const e={};p.forEach((t=>{(o=t.orient||uK)!==DK&&(e[o]||(e[o]=[])).push(t)}));for(const r in e){const i=e[r];iQ(t,i,uQ(i,r,n.legends,f,d,u,c))}p.forEach((e=>{const r=e.bounds;if(r.equals(e._bounds)||(e.bounds=e._bounds,t.dirty(e),e.bounds=r,t.dirty(e)),!n.autosize||"fit"!==n.autosize.type&&n.autosize.type!==AK&&n.autosize.type!==CK)h.union(r);else switch(e.orient){case lK:case uK:h.add(r.x1,0).add(r.x2,0);break;case aK:case cK:h.add(0,r.y1).add(0,r.y2)}}))}h.union(f).union(d),r&&h.union(function(t,e,n,r,i){var o,s=e.items[0],a=s.frame,l=s.orient,u=s.anchor,c=s.offset,h=s.padding,f=s.items[0].items[0],d=s.items[1]&&s.items[1].items[0],p=l===lK||l===uK?r:n,m=0,g=0,y=0,b=0,v=0;if(a!==gK?l===lK?(m=i.y2,p=i.y1):l===uK?(m=i.y1,p=i.y2):(m=i.x1,p=i.x2):l===lK&&(m=r,p=0),o=u===hK?m:u===dK?p:(m+p)/2,d&&d.text){switch(l){case aK:case cK:v=f.bounds.height()+h;break;case lK:b=f.bounds.width()+h;break;case uK:b=-f.bounds.width()-h}GK.clear().union(d.bounds),GK.translate(b-(d.x||0),v-(d.y||0)),YK(d,"x",b)|YK(d,"y",v)&&(t.dirty(d),d.bounds.clear().union(GK),d.mark.bounds.clear().union(GK),t.dirty(d)),GK.clear().union(d.bounds)}else GK.clear();switch(GK.union(f.bounds),l){case aK:g=o,y=i.y1-GK.height()-c;break;case lK:g=i.x1-GK.width()-c,y=o;break;case uK:g=i.x2+GK.width()+c,y=o;break;case cK:g=o,y=i.y2+c;break;default:g=s.x,y=s.y}return YK(s,"x",g)|YK(s,"y",y)&&(GK.translate(g,y),t.dirty(s),s.bounds.clear().union(GK),e.bounds.clear().union(GK),t.dirty(s)),s.bounds}(t,r,u,c,h)),e.clip&&h.set(0,0,e.width||0,e.height||0),function(t,e,n,r){const i=r.autosize||{},o=i.type;if(t._autosize<1||!o)return;let s=t._width,a=t._height,l=Math.max(0,e.width||0),u=Math.max(0,Math.ceil(-n.x1)),c=Math.max(0,e.height||0),h=Math.max(0,Math.ceil(-n.y1));const f=Math.max(0,Math.ceil(n.x2-l)),d=Math.max(0,Math.ceil(n.y2-c));if("padding"===i.contains){const e=t.padding();s-=e.left+e.right,a-=e.top+e.bottom}o===DK?(u=0,h=0,l=s,c=a):"fit"===o?(l=Math.max(0,s-u-f),c=Math.max(0,a-h-d)):o===AK?(l=Math.max(0,s-u-f),a=c+h+d):o===CK?(s=l+u+f,c=Math.max(0,a-h-d)):"pad"===o&&(s=l+u+f,a=c+h+d),t._resizeView(s,a,l,c,[u,h],i.resize)}(t,e,h,n)}(n,e,t)})),function(t){return t&&"legend-entry"!==t.mark.role}(t.mark.group)?e.reflow():e}}),UF(mQ,dP,{transform(t,e){if(this.value&&!t.modified())return e.StopPropagation;var n=e.dataflow.locale(),r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=this.value,o=t.scale,s=YW(o,null==t.count?t.values?t.values.length:10:t.count,t.minstep),a=t.format||KW(n,o,s,t.formatSpecifier,t.formatType,!!t.values),l=t.values?XW(o,t.values,s):JW(o,s);return i&&(r.rem=i),i=l.map(((t,e)=>BR({index:e/(l.length-1||1),value:t,label:a(t)}))),t.extra&&i.length&&i.push(BR({index:-1,extra:{value:i[0].value},label:""})),r.source=i,r.add=i,this.value=i,r}}),UF(gQ,dP,{transform(t,e){var n=e.dataflow,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=t.item||yQ,o=t.key||FR,s=this.value;return Q$(r.encode)&&(r.encode=null),s&&(t.modified("key")||e.modified(o))&&L$("DataJoin does not support modified key function or fields."),s||(e=e.addAll(),this.value=s=function(t){const e=zF().test((t=>t.exit));return e.lookup=n=>e.get(t(n)),e}(o)),e.visit(e.ADD,(t=>{const e=o(t);let n=s.get(e);n?n.exit?(s.empty--,r.add.push(n)):r.mod.push(n):(n=i(t),s.set(e,n),r.add.push(n)),n.datum=t,n.exit=!1})),e.visit(e.MOD,(t=>{const e=o(t),n=s.get(e);n&&(n.datum=t,r.mod.push(n))})),e.visit(e.REM,(t=>{const e=o(t),n=s.get(e);t!==n.datum||n.exit||(r.rem.push(n),n.exit=!0,++s.empty)})),e.changed(e.ADD_MOD)&&r.modifies("datum"),(e.clean()||t.clean&&s.empty>n.cleanThreshold)&&n.runAfter(s.clean),r}}),UF(bQ,dP,{transform(t,e){var n=e.fork(e.ADD_REM),r=t.mod||!1,i=t.encoders,o=e.encode;if(Q$(o)){if(!n.changed()&&!o.every((t=>i[t])))return e.StopPropagation;o=o[0],n.encode=null}var s="enter"===o,a=i.update||q$,l=i.enter||q$,u=i.exit||q$,c=(o&&!s?i[o]:a)||q$;if(e.changed(e.ADD)&&(e.visit(e.ADD,(e=>{l(e,t),a(e,t)})),n.modifies(l.output),n.modifies(a.output),c!==q$&&c!==a&&(e.visit(e.ADD,(e=>{c(e,t)})),n.modifies(c.output))),e.changed(e.REM)&&u!==q$&&(e.visit(e.REM,(e=>{u(e,t)})),n.modifies(u.output)),s||c!==q$){const i=e.MOD|(t.modified()?e.REFLOW:0);s?(e.visit(i,(e=>{const i=l(e,t)||r;(c(e,t)||i)&&n.mod.push(e)})),n.mod.length&&n.modifies(l.output)):e.visit(i,(e=>{(c(e,t)||r)&&n.mod.push(e)})),n.mod.length&&n.modifies(c.output)}return n.changed()?n:e.StopPropagation}}),UF(vQ,dP,{transform(t,e){if(null!=this.value&&!t.modified())return e.StopPropagation;var n,r,i,o,s,a=e.dataflow.locale(),l=e.fork(e.NO_SOURCE|e.NO_FIELDS),u=this.value,c=t.type||VW,h=t.scale,f=+t.limit,d=YW(h,null==t.count?5:t.count,t.minstep),p=!!t.values||c===VW,m=t.format||rH(a,h,d,c,t.formatSpecifier,t.formatType,p),g=t.values||eH(h,d);return u&&(l.rem=u),c===VW?(f&&g.length>f?(e.dataflow.warn("Symbol legend count exceeds limit, filtering items."),u=g.slice(0,f-1),s=!0):u=g,EF(i=t.size)?(t.values||0!==h(u[0])||(u=u.slice(1)),o=u.reduce(((e,n)=>Math.max(e,i(n,t))),0)):i=IF(o=i||8),u=u.map(((e,n)=>BR({index:n,label:m(e,n,u),value:e,offset:o,size:i(e,t)}))),s&&(s=g[u.length],u.push(BR({index:u.length,label:`â€¦${g.length-u.length} entries`,value:s,offset:o,size:i(s,t)})))):"gradient"===c?(n=h.domain(),r=BW(h,n[0],iF(n)),g.length<3&&!t.values&&n[0]!==iF(n)&&(g=[n[0],iF(n)]),u=g.map(((t,e)=>BR({index:e,label:m(t,e,g),value:t,perc:r(t)})))):(i=g.length-1,r=function(t){const e=t.domain(),n=e.length-1;let r=+e[0],i=+iF(e),o=i-r;if(t.type===aW){const t=n?o/n:.1;r-=t,i+=t,o=i-r}return t=>(t-r)/o}(h),u=g.map(((t,e)=>BR({index:e,label:m(t,e,g),value:t,perc:e?r(t):0,perc2:e===i?1:r(g[e+1])})))),l.source=u,l.add=u,this.value=u,l}});const wQ=t=>t.source.x,xQ=t=>t.source.y,_Q=t=>t.target.x,kQ=t=>t.target.y;function SQ(t){dP.call(this,{},t)}SQ.Definition={type:"LinkPath",metadata:{modifies:!0},params:[{name:"sourceX",type:"field",default:"source.x"},{name:"sourceY",type:"field",default:"source.y"},{name:"targetX",type:"field",default:"target.x"},{name:"targetY",type:"field",default:"target.y"},{name:"orient",type:"enum",default:"vertical",values:["horizontal","vertical","radial"]},{name:"shape",type:"enum",default:"line",values:["line","arc","curve","diagonal","orthogonal"]},{name:"require",type:"signal"},{name:"as",type:"string",default:"path"}]},UF(SQ,dP,{transform(t,e){var n=t.sourceX||wQ,r=t.sourceY||xQ,i=t.targetX||_Q,o=t.targetY||kQ,s=t.as||"path",a=t.orient||"vertical",l=t.shape||"line",u=DQ.get(l+"-"+a)||DQ.get(l);return u||L$("LinkPath unsupported type: "+t.shape+(t.orient?"-"+t.orient:"")),e.visit(e.SOURCE,(t=>{t[s]=u(n(t),r(t),i(t),o(t))})),e.reflow(t.modified()).modifies(s)}});const EQ=(t,e,n,r)=>"M"+t+","+e+"L"+n+","+r,AQ=(t,e,n,r)=>{var i=n-t,o=r-e,s=Math.hypot(i,o)/2;return"M"+t+","+e+"A"+s+","+s+" "+180*Math.atan2(o,i)/Math.PI+" 0 1 "+n+","+r},CQ=(t,e,n,r)=>{const i=n-t,o=r-e,s=.2*(i+o),a=.2*(o-i);return"M"+t+","+e+"C"+(t+s)+","+(e+a)+" "+(n+a)+","+(r-s)+" "+n+","+r},DQ=zF({line:EQ,"line-radial":(t,e,n,r)=>EQ(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),arc:AQ,"arc-radial":(t,e,n,r)=>AQ(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),curve:CQ,"curve-radial":(t,e,n,r)=>CQ(e*Math.cos(t),e*Math.sin(t),r*Math.cos(n),r*Math.sin(n)),"orthogonal-horizontal":(t,e,n,r)=>"M"+t+","+e+"V"+r+"H"+n,"orthogonal-vertical":(t,e,n,r)=>"M"+t+","+e+"H"+n+"V"+r,"orthogonal-radial":(t,e,n,r)=>{const i=Math.cos(t),o=Math.sin(t),s=Math.cos(n),a=Math.sin(n);return"M"+e*i+","+e*o+"A"+e+","+e+" 0 0,"+((Math.abs(n-t)>Math.PI?n<=t:n>t)?1:0)+" "+e*s+","+e*a+"L"+r*s+","+r*a},"diagonal-horizontal":(t,e,n,r)=>{const i=(t+n)/2;return"M"+t+","+e+"C"+i+","+e+" "+i+","+r+" "+n+","+r},"diagonal-vertical":(t,e,n,r)=>{const i=(e+r)/2;return"M"+t+","+e+"C"+t+","+i+" "+n+","+i+" "+n+","+r},"diagonal-radial":(t,e,n,r)=>{const i=Math.cos(t),o=Math.sin(t),s=Math.cos(n),a=Math.sin(n),l=(e+r)/2;return"M"+e*i+","+e*o+"C"+l*i+","+l*o+" "+l*s+","+l*a+" "+r*s+","+r*a}});function MQ(t){dP.call(this,null,t)}MQ.Definition={type:"Pie",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"startAngle",type:"number",default:0},{name:"endAngle",type:"number",default:6.283185307179586},{name:"sort",type:"boolean",default:!1},{name:"as",type:"string",array:!0,length:2,default:["startAngle","endAngle"]}]},UF(MQ,dP,{transform(t,e){var n,r,i,o=t.as||["startAngle","endAngle"],s=o[0],a=o[1],l=t.field||U$,u=t.startAngle||0,c=null!=t.endAngle?t.endAngle:2*Math.PI,h=e.source,f=h.map(l),d=f.length,p=u,m=(c-u)/pQ(f),g=xz(d);for(t.sort&&g.sort(((t,e)=>f[t]-f[e])),n=0;n<d;++n)i=f[g[n]],(r=h[g[n]])[s]=p,r[a]=p+=i*m;return this.value=f,e.reflow(t.modified()).modifies(o)}});function OQ(t){return CW(t)&&t!==rW}const TQ=uL(["set","modified","clear","type","scheme","schemeExtent","schemeCount","domain","domainMin","domainMid","domainMax","domainRaw","domainImplicit","nice","zero","bins","range","rangeStep","round","reverse","interpolate","interpolateGamma"]);function IQ(t){dP.call(this,null,t),this.modified(!0)}function NQ(t,e,n){OW(t)&&(Math.abs(e.reduce(((t,e)=>t+(e<0?-1:e>0?1:0)),0))!==e.length&&n.warn("Log scale domain includes zero: "+iL(e)));return e}function $Q(t,e,n){return EF(t)&&(e||n)?$W(t,FQ(e||[0,1],n)):t}function FQ(t,e){return e?t.slice().reverse():t}function LQ(t){dP.call(this,null,t)}UF(IQ,dP,{transform(t,e){var n=e.dataflow,r=this.value,i=function(t){var e,n=t.type,r="";return n===rW?rW+"-"+Jq:(function(t){const e=t.type;return CW(e)&&e!==eW&&e!==nW&&(t.scheme||t.range&&t.range.length&&t.range.every(XF))}(t)&&(r=2===(e=t.rawDomain?t.rawDomain.length:t.domain?t.domain.length+ +(null!=t.domainMid):0)?rW+"-":3===e?iW+"-":""),(r+n||Jq).toLowerCase())}(t);for(i in r&&i===r.type||(this.value=r=SW(i)()),t)if(!TQ[i]){if("padding"===i&&OQ(r.type))continue;EF(r[i])?r[i](t[i]):n.warn("Unsupported scale property: "+i)}return function(t,e,n){var r=t.type,i=e.round||!1,o=e.range;if(null!=e.rangeStep)o=function(t,e,n){t!==cW&&t!==uW&&L$("Only band and point scales support rangeStep.");var r=(null!=e.paddingOuter?e.paddingOuter:e.padding)||0,i=t===uW?1:(null!=e.paddingInner?e.paddingInner:e.padding)||0;return[0,e.rangeStep*Xq(n,i,r)]}(r,e,n);else if(e.scheme&&(o=function(t,e,n){var r,i=e.schemeExtent;return Q$(e.scheme)?r=FW(e.scheme,e.interpolate,e.interpolateGamma):(r=UW(e.scheme.toLowerCase()))||L$(`Unrecognized scheme name: ${e.scheme}`),n=t===aW?n+1:t===hW?n-1:t===oW||t===sW?+e.schemeCount||5:n,TW(t)?$Q(r,i,e.reverse):EF(r)?LW($Q(r,i),n):t===lW?r:r.slice(0,n)}(r,e,n),EF(o))){if(t.interpolator)return t.interpolator(o);L$(`Scale type ${r} does not support interpolating color schemes.`)}if(o&&TW(r))return t.interpolator(FW(FQ(o,e.reverse),e.interpolate,e.interpolateGamma));o&&e.interpolate&&t.interpolate?t.interpolate(RW(e.interpolate,e.interpolateGamma)):EF(t.round)?t.round(i):EF(t.rangeRound)&&t.interpolate(i?KM:JM),o&&t.range(FQ(o,e.reverse))}(r,t,function(t,e,n){let r=e.bins;if(r&&!Q$(r)){const e=t.domain(),n=e[0],i=iF(e),o=r.step;let s=null==r.start?n:r.start,a=null==r.stop?i:r.stop;o||L$("Scale bins parameter missing step property."),s<n&&(s=o*Math.ceil(n/o)),a>i&&(a=o*Math.floor(i/o)),r=xz(s,a+o/2,o)}return r?t.bins=r:t.bins&&delete t.bins,t.type===hW&&(r?e.domain||e.domainRaw||(t.domain(r),n=r.length):t.bins=t.domain()),n}(r,t,function(t,e,n){const r=function(t,e,n){return e?(t.domain(NQ(t.type,e,n)),e.length):-1}(t,e.domainRaw,n);if(r>-1)return r;var i,o,s=e.domain,a=t.type,l=e.zero||void 0===e.zero&&function(t){const e=t.type;return!t.bins&&(e===Jq||e===Qq||e===Zq)}(t);if(!s)return 0;if((l||null!=e.domainMin||null!=e.domainMax||null!=e.domainMid)&&(i=(s=s.slice()).length-1||1,l&&(s[0]>0&&(s[0]=0),s[i]<0&&(s[i]=0)),null!=e.domainMin&&(s[0]=e.domainMin),null!=e.domainMax&&(s[i]=e.domainMax),null!=e.domainMid)){const t=(o=e.domainMid)>s[i]?i+1:o<s[0]?0:i;t!==i&&n.warn("Scale domainMid exceeds domain min or max.",o),s.splice(t,0,o)}return OQ(a)&&e.padding&&s[0]!==iF(s)&&(s=function(t,e,n,r,i,o){var s=Math.abs(iF(n)-n[0]),a=s/(s-2*r),l=t===Kq?bF(e,null,a):t===Zq?vF(e,null,a,.5):t===Qq?vF(e,null,a,i||1):t===tW?wF(e,null,a,o||1):yF(e,null,a);return(e=e.slice())[0]=l[0],e[e.length-1]=l[1],e}(a,s,e.range,e.padding,e.exponent,e.constant)),t.domain(NQ(a,s,n)),a===lW&&t.unknown(e.domainImplicit?HV:void 0),e.nice&&t.nice&&t.nice(!0!==e.nice&&YW(t,e.nice)||null),s.length}(r,t,n))),e.fork(e.NO_SOURCE|e.NO_FIELDS)}}),UF(LQ,dP,{transform(t,e){const n=t.modified("sort")||e.changed(e.ADD)||e.modified(t.sort.fields)||e.modified("datum");return n&&e.source.sort(jR(t.sort)),this.modified(n),e}});const BQ="zero",RQ="center",PQ="normalize",zQ=["y0","y1"];function jQ(t){dP.call(this,null,t)}function UQ(t,e,n,r,i){for(var o,s=(e-t.sum)/2,a=t.length,l=0;l<a;++l)(o=t[l])[r]=s,o[i]=s+=Math.abs(n(o))}function VQ(t,e,n,r,i){for(var o,s=1/t.sum,a=0,l=t.length,u=0,c=0;u<l;++u)(o=t[u])[r]=a,o[i]=a=s*(c+=Math.abs(n(o)))}function qQ(t,e,n,r,i){for(var o,s,a=0,l=0,u=t.length,c=0;c<u;++c)(o=+n(s=t[c]))<0?(s[r]=l,s[i]=l+=o):(s[r]=a,s[i]=a+=o)}jQ.Definition={type:"Stack",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"groupby",type:"field",array:!0},{name:"sort",type:"compare"},{name:"offset",type:"enum",default:BQ,values:[BQ,RQ,PQ]},{name:"as",type:"string",array:!0,length:2,default:zQ}]},UF(jQ,dP,{transform(t,e){var n,r,i,o,s=t.as||zQ,a=s[0],l=s[1],u=jR(t.sort),c=t.field||U$,h=t.offset===RQ?UQ:t.offset===PQ?VQ:qQ;for(n=function(t,e,n,r){var i,o,s,a,l,u,c,h,f,d=[],p=t=>t(l);if(null==e)d.push(t.slice());else for(i={},o=0,s=t.length;o<s;++o)l=t[o],(c=i[u=e.map(p)])||(i[u]=c=[],d.push(c)),c.push(l);for(u=0,f=0,a=d.length;u<a;++u){for(o=0,h=0,s=(c=d[u]).length;o<s;++o)h+=Math.abs(r(c[o]));c.sum=h,h>f&&(f=h),n&&c.sort(n)}return d.max=f,d}(e.source,t.groupby,u,c),r=0,i=n.length,o=n.max;r<i;++r)h(n[r],o,c,a,l);return e.reflow(t.modified()).modifies(s)}});const WQ=t=>t;function HQ(t,e){t&&YQ.hasOwnProperty(t.type)&&YQ[t.type](t,e)}var GQ={Feature:function(t,e){HQ(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)HQ(n[r].geometry,e)}},YQ={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){XQ(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)XQ(n[r],e,0)},Polygon:function(t,e){JQ(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)JQ(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)HQ(n[r],e)}};function XQ(t,e,n){var r,i=-1,o=t.length-n;for(e.lineStart();++i<o;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function JQ(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)XQ(t[n],e,1);e.polygonEnd()}function KQ(t,e){t&&GQ.hasOwnProperty(t.type)?GQ[t.type](t,e):HQ(t,e)}class QQ{constructor(){this._partials=new Float64Array(32),this._n=0}add(t){const e=this._partials;let n=0;for(let r=0;r<this._n&&r<32;r++){const i=e[r],o=t+i,s=Math.abs(t)<Math.abs(i)?t-(o-i):i-(o-t);s&&(e[n++]=s),t=o}return e[n]=t,this._n=n+1,this}valueOf(){const t=this._partials;let e,n,r,i=this._n,o=0;if(i>0){for(o=t[--i];i>0&&(e=o,n=t[--i],o=e+n,r=n-(o-e),!r););i>0&&(r<0&&t[i-1]<0||r>0&&t[i-1]>0)&&(n=2*r,e=o+n,n==e-o&&(o=e))}return o}}var ZQ=1e-6,tZ=1e-12,eZ=Math.PI,nZ=eZ/2,rZ=eZ/4,iZ=2*eZ,oZ=180/eZ,sZ=eZ/180,aZ=Math.abs,lZ=Math.atan,uZ=Math.atan2,cZ=Math.cos,hZ=Math.ceil,fZ=Math.exp,dZ=(Math.floor,Math.hypot),pZ=Math.log,mZ=Math.pow,gZ=Math.sin,yZ=Math.sign||function(t){return t>0?1:t<0?-1:0},bZ=Math.sqrt,vZ=Math.tan;function wZ(t){return t>1?0:t<-1?eZ:Math.acos(t)}function xZ(t){return t>1?nZ:t<-1?-nZ:Math.asin(t)}function _Z(){}var kZ,SZ,EZ,AZ,CZ=new QQ,DZ=new QQ,MZ={point:_Z,lineStart:_Z,lineEnd:_Z,polygonStart:function(){MZ.lineStart=OZ,MZ.lineEnd=NZ},polygonEnd:function(){MZ.lineStart=MZ.lineEnd=MZ.point=_Z,CZ.add(aZ(DZ)),DZ=new QQ},result:function(){var t=CZ/2;return CZ=new QQ,t}};function OZ(){MZ.point=TZ}function TZ(t,e){MZ.point=IZ,kZ=EZ=t,SZ=AZ=e}function IZ(t,e){DZ.add(AZ*t-EZ*e),EZ=t,AZ=e}function NZ(){IZ(kZ,SZ)}const $Z=MZ;var FZ=1/0,LZ=FZ,BZ=-FZ,RZ=BZ,PZ={point:function(t,e){t<FZ&&(FZ=t),t>BZ&&(BZ=t),e<LZ&&(LZ=e),e>RZ&&(RZ=e)},lineStart:_Z,lineEnd:_Z,polygonStart:_Z,polygonEnd:_Z,result:function(){var t=[[FZ,LZ],[BZ,RZ]];return BZ=RZ=-(LZ=FZ=1/0),t}};const zZ=PZ;var jZ,UZ,VZ,qZ,WZ=0,HZ=0,GZ=0,YZ=0,XZ=0,JZ=0,KZ=0,QZ=0,ZZ=0,t0={point:e0,lineStart:n0,lineEnd:o0,polygonStart:function(){t0.lineStart=s0,t0.lineEnd=a0},polygonEnd:function(){t0.point=e0,t0.lineStart=n0,t0.lineEnd=o0},result:function(){var t=ZZ?[KZ/ZZ,QZ/ZZ]:JZ?[YZ/JZ,XZ/JZ]:GZ?[WZ/GZ,HZ/GZ]:[NaN,NaN];return WZ=HZ=GZ=YZ=XZ=JZ=KZ=QZ=ZZ=0,t}};function e0(t,e){WZ+=t,HZ+=e,++GZ}function n0(){t0.point=r0}function r0(t,e){t0.point=i0,e0(VZ=t,qZ=e)}function i0(t,e){var n=t-VZ,r=e-qZ,i=bZ(n*n+r*r);YZ+=i*(VZ+t)/2,XZ+=i*(qZ+e)/2,JZ+=i,e0(VZ=t,qZ=e)}function o0(){t0.point=e0}function s0(){t0.point=l0}function a0(){u0(jZ,UZ)}function l0(t,e){t0.point=u0,e0(jZ=VZ=t,UZ=qZ=e)}function u0(t,e){var n=t-VZ,r=e-qZ,i=bZ(n*n+r*r);YZ+=i*(VZ+t)/2,XZ+=i*(qZ+e)/2,JZ+=i,KZ+=(i=qZ*t-VZ*e)*(VZ+t),QZ+=i*(qZ+e),ZZ+=3*i,e0(VZ=t,qZ=e)}const c0=t0;function h0(t){this._context=t}h0.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,iZ)}},result:_Z};var f0,d0,p0,m0,g0,y0=new QQ,b0={point:_Z,lineStart:function(){b0.point=v0},lineEnd:function(){f0&&w0(d0,p0),b0.point=_Z},polygonStart:function(){f0=!0},polygonEnd:function(){f0=null},result:function(){var t=+y0;return y0=new QQ,t}};function v0(t,e){b0.point=w0,d0=m0=t,p0=g0=e}function w0(t,e){m0-=t,g0-=e,y0.add(bZ(m0*m0+g0*g0)),m0=t,g0=e}const x0=b0;let _0,k0,S0,E0;class A0{constructor(t){this._append=null==t?C0:function(t){const e=Math.floor(t);if(!(e>=0))throw new RangeError(`invalid digits: ${t}`);if(e>15)return C0;if(e!==_0){const t=10**e;_0=e,k0=function(e){let n=1;this._+=e[0];for(const r=e.length;n<r;++n)this._+=Math.round(arguments[n]*t)/t+e[n]}}return k0}(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){0===this._line&&(this._+="Z"),this._point=NaN}point(t,e){switch(this._point){case 0:this._append`M${t},${e}`,this._point=1;break;case 1:this._append`L${t},${e}`;break;default:if(this._append`M${t},${e}`,this._radius!==S0||this._append!==k0){const t=this._radius,e=this._;this._="",this._append`m0,${t}a${t},${t} 0 1,1 0,${-2*t}a${t},${t} 0 1,1 0,${2*t}z`,S0=t,k0=this._append,E0=this._,this._=e}this._+=E0}}result(){const t=this._;return this._="",t.length?t:null}}function C0(t){let e=1;this._+=t[0];for(const n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function D0(t,e){let n,r,i=3,o=4.5;function s(t){return t&&("function"==typeof o&&r.pointRadius(+o.apply(this,arguments)),KQ(t,n(r))),r.result()}return s.area=function(t){return KQ(t,n($Z)),$Z.result()},s.measure=function(t){return KQ(t,n(x0)),x0.result()},s.bounds=function(t){return KQ(t,n(zZ)),zZ.result()},s.centroid=function(t){return KQ(t,n(c0)),c0.result()},s.projection=function(e){return arguments.length?(n=null==e?(t=null,WQ):(t=e).stream,s):t},s.context=function(t){return arguments.length?(r=null==t?(e=null,new A0(i)):new h0(e=t),"function"!=typeof o&&r.pointRadius(o),s):e},s.pointRadius=function(t){return arguments.length?(o="function"==typeof t?t:(r.pointRadius(+t),+t),s):o},s.digits=function(t){if(!arguments.length)return i;if(null==t)i=null;else{const e=Math.floor(t);if(!(e>=0))throw new RangeError(`invalid digits: ${t}`);i=e}return null===e&&(r=new A0(i)),s},s.projection(t).digits(i).context(e)}function M0(){var t,e=[];return{point:function(e,n,r){t.push([e,n,r])},lineStart:function(){e.push(t=[])},lineEnd:_Z,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var n=e;return e=[],t=null,n}}}function O0(t,e){return aZ(t[0]-e[0])<ZQ&&aZ(t[1]-e[1])<ZQ}function T0(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function I0(t,e,n,r,i){var o,s,a=[],l=[];if(t.forEach((function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],s=t[e];if(O0(r,s)){if(!r[2]&&!s[2]){for(i.lineStart(),o=0;o<e;++o)i.point((r=t[o])[0],r[1]);return void i.lineEnd()}s[0]+=2*ZQ}a.push(n=new T0(r,t,null,!0)),l.push(n.o=new T0(r,null,n,!1)),a.push(n=new T0(s,t,null,!1)),l.push(n.o=new T0(s,null,n,!0))}})),a.length){for(l.sort(e),N0(a),N0(l),o=0,s=l.length;o<s;++o)l[o].e=n=!n;for(var u,c,h=a[0];;){for(var f=h,d=!0;f.v;)if((f=f.n)===h)return;u=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(d)for(o=0,s=u.length;o<s;++o)i.point((c=u[o])[0],c[1]);else r(f.x,f.n.x,1,i);f=f.n}else{if(d)for(u=f.p.z,o=u.length-1;o>=0;--o)i.point((c=u[o])[0],c[1]);else r(f.x,f.p.x,-1,i);f=f.p}u=(f=f.o).z,d=!d}while(!f.v);i.lineEnd()}}}function N0(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}function $0(t){return[uZ(t[1],t[0]),xZ(t[2])]}function F0(t){var e=t[0],n=t[1],r=cZ(n);return[r*cZ(e),r*gZ(e),gZ(n)]}function L0(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function B0(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function R0(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function P0(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function z0(t){var e=bZ(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function j0(t){return aZ(t[0])<=eZ?t[0]:yZ(t[0])*((aZ(t[0])+eZ)%iZ-eZ)}function U0(t){return Array.from(function*(t){for(const e of t)yield*e}(t))}function V0(t,e,n,r){return function(i){var o,s,a,l=e(i),u=M0(),c=e(u),h=!1,f={point:d,lineStart:m,lineEnd:g,polygonStart:function(){f.point=y,f.lineStart=b,f.lineEnd=v,s=[],o=[]},polygonEnd:function(){f.point=d,f.lineStart=m,f.lineEnd=g,s=U0(s);var t=function(t,e){var n=j0(e),r=e[1],i=gZ(r),o=[gZ(n),-cZ(n),0],s=0,a=0,l=new QQ;1===i?r=nZ+ZQ:-1===i&&(r=-nZ-ZQ);for(var u=0,c=t.length;u<c;++u)if(f=(h=t[u]).length)for(var h,f,d=h[f-1],p=j0(d),m=d[1]/2+rZ,g=gZ(m),y=cZ(m),b=0;b<f;++b,p=w,g=_,y=k,d=v){var v=h[b],w=j0(v),x=v[1]/2+rZ,_=gZ(x),k=cZ(x),S=w-p,E=S>=0?1:-1,A=E*S,C=A>eZ,D=g*_;if(l.add(uZ(D*E*gZ(A),y*k+D*cZ(A))),s+=C?S+E*iZ:S,C^p>=n^w>=n){var M=B0(F0(d),F0(v));z0(M);var O=B0(o,M);z0(O);var T=(C^S>=0?-1:1)*xZ(O[2]);(r>T||r===T&&(M[0]||M[1]))&&(a+=C^S>=0?1:-1)}}return(s<-ZQ||s<ZQ&&l<-tZ)^1&a}(o,r);s.length?(h||(i.polygonStart(),h=!0),I0(s,W0,t,n,i)):t&&(h||(i.polygonStart(),h=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),h&&(i.polygonEnd(),h=!1),s=o=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(e,n){t(e,n)&&i.point(e,n)}function p(t,e){l.point(t,e)}function m(){f.point=p,l.lineStart()}function g(){f.point=d,l.lineEnd()}function y(t,e){a.push([t,e]),c.point(t,e)}function b(){c.lineStart(),a=[]}function v(){y(a[0][0],a[0][1]),c.lineEnd();var t,e,n,r,l=c.clean(),f=u.result(),d=f.length;if(a.pop(),o.push(a),a=null,d)if(1&l){if((e=(n=f[0]).length-1)>0){for(h||(i.polygonStart(),h=!0),i.lineStart(),t=0;t<e;++t)i.point((r=n[t])[0],r[1]);i.lineEnd()}}else d>1&&2&l&&f.push(f.pop().concat(f.shift())),s.push(f.filter(q0))}return f}}function q0(t){return t.length>1}function W0(t,e){return((t=t.x)[0]<0?t[1]-nZ-ZQ:nZ-t[1])-((e=e.x)[0]<0?e[1]-nZ-ZQ:nZ-e[1])}const H0=V0((function(){return!0}),(function(t){var e,n=NaN,r=NaN,i=NaN;return{lineStart:function(){t.lineStart(),e=1},point:function(o,s){var a=o>0?eZ:-eZ,l=aZ(o-n);aZ(l-eZ)<ZQ?(t.point(n,r=(r+s)/2>0?nZ:-nZ),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(a,r),t.point(o,r),e=0):i!==a&&l>=eZ&&(aZ(n-i)<ZQ&&(n-=i*ZQ),aZ(o-a)<ZQ&&(o-=a*ZQ),r=function(t,e,n,r){var i,o,s=gZ(t-n);return aZ(s)>ZQ?lZ((gZ(e)*(o=cZ(r))*gZ(n)-gZ(r)*(i=cZ(e))*gZ(t))/(i*o*s)):(e+r)/2}(n,r,o,s),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(a,r),e=0),t.point(n=o,r=s),i=a},lineEnd:function(){t.lineEnd(),n=r=NaN},clean:function(){return 2-e}}}),(function(t,e,n,r){var i;if(null==t)i=n*nZ,r.point(-eZ,i),r.point(0,i),r.point(eZ,i),r.point(eZ,0),r.point(eZ,-i),r.point(0,-i),r.point(-eZ,-i),r.point(-eZ,0),r.point(-eZ,i);else if(aZ(t[0]-e[0])>ZQ){var o=t[0]<e[0]?eZ:-eZ;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])}),[-eZ,-nZ]);function G0(t,e){(e=F0(e))[0]-=t,z0(e);var n=wZ(-e[1]);return((-e[2]<0?-n:n)+iZ-ZQ)%iZ}var Y0=1e9,X0=-Y0;function J0(t,e,n,r){function i(i,o){return t<=i&&i<=n&&e<=o&&o<=r}function o(i,o,a,u){var c=0,h=0;if(null==i||(c=s(i,a))!==(h=s(o,a))||l(i,o)<0^a>0)do{u.point(0===c||3===c?t:n,c>1?r:e)}while((c=(c+a+4)%4)!==h);else u.point(o[0],o[1])}function s(r,i){return aZ(r[0]-t)<ZQ?i>0?0:3:aZ(r[0]-n)<ZQ?i>0?2:1:aZ(r[1]-e)<ZQ?i>0?1:0:i>0?3:2}function a(t,e){return l(t.x,e.x)}function l(t,e){var n=s(t,1),r=s(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(s){var l,u,c,h,f,d,p,m,g,y,b,v=s,w=M0(),x={point:_,lineStart:function(){x.point=k,u&&u.push(c=[]),y=!0,g=!1,p=m=NaN},lineEnd:function(){l&&(k(h,f),d&&g&&w.rejoin(),l.push(w.result())),x.point=_,g&&v.lineEnd()},polygonStart:function(){v=w,l=[],u=[],b=!0},polygonEnd:function(){var e=function(){for(var e=0,n=0,i=u.length;n<i;++n)for(var o,s,a=u[n],l=1,c=a.length,h=a[0],f=h[0],d=h[1];l<c;++l)o=f,s=d,f=(h=a[l])[0],d=h[1],s<=r?d>r&&(f-o)*(r-s)>(d-s)*(t-o)&&++e:d<=r&&(f-o)*(r-s)<(d-s)*(t-o)&&--e;return e}(),n=b&&e,i=(l=U0(l)).length;(n||i)&&(s.polygonStart(),n&&(s.lineStart(),o(null,null,1,s),s.lineEnd()),i&&I0(l,a,e,o,s),s.polygonEnd()),v=s,l=u=c=null}};function _(t,e){i(t,e)&&v.point(t,e)}function k(o,s){var a=i(o,s);if(u&&c.push([o,s]),y)h=o,f=s,d=a,y=!1,a&&(v.lineStart(),v.point(o,s));else if(a&&g)v.point(o,s);else{var l=[p=Math.max(X0,Math.min(Y0,p)),m=Math.max(X0,Math.min(Y0,m))],w=[o=Math.max(X0,Math.min(Y0,o)),s=Math.max(X0,Math.min(Y0,s))];!function(t,e,n,r,i,o){var s,a=t[0],l=t[1],u=0,c=1,h=e[0]-a,f=e[1]-l;if(s=n-a,h||!(s>0)){if(s/=h,h<0){if(s<u)return;s<c&&(c=s)}else if(h>0){if(s>c)return;s>u&&(u=s)}if(s=i-a,h||!(s<0)){if(s/=h,h<0){if(s>c)return;s>u&&(u=s)}else if(h>0){if(s<u)return;s<c&&(c=s)}if(s=r-l,f||!(s>0)){if(s/=f,f<0){if(s<u)return;s<c&&(c=s)}else if(f>0){if(s>c)return;s>u&&(u=s)}if(s=o-l,f||!(s<0)){if(s/=f,f<0){if(s>c)return;s>u&&(u=s)}else if(f>0){if(s<u)return;s<c&&(c=s)}return u>0&&(t[0]=a+u*h,t[1]=l+u*f),c<1&&(e[0]=a+c*h,e[1]=l+c*f),!0}}}}}(l,w,t,e,n,r)?a&&(v.lineStart(),v.point(o,s),b=!1):(g||(v.lineStart(),v.point(l[0],l[1])),v.point(w[0],w[1]),a||v.lineEnd(),b=!1)}p=o,m=s,g=a}return x}}function K0(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return(n=e.invert(n,r))&&t.invert(n[0],n[1])}),n}function Q0(t,e){return aZ(t)>eZ&&(t-=Math.round(t/iZ)*iZ),[t,e]}function Z0(t,e,n){return(t%=iZ)?e||n?K0(e1(t),n1(e,n)):e1(t):e||n?n1(e,n):Q0}function t1(t){return function(e,n){return aZ(e+=t)>eZ&&(e-=Math.round(e/iZ)*iZ),[e,n]}}function e1(t){var e=t1(t);return e.invert=t1(-t),e}function n1(t,e){var n=cZ(t),r=gZ(t),i=cZ(e),o=gZ(e);function s(t,e){var s=cZ(e),a=cZ(t)*s,l=gZ(t)*s,u=gZ(e),c=u*n+a*r;return[uZ(l*i-c*o,a*n-u*r),xZ(c*i+l*o)]}return s.invert=function(t,e){var s=cZ(e),a=cZ(t)*s,l=gZ(t)*s,u=gZ(e),c=u*i-l*o;return[uZ(l*i+u*o,a*n+c*r),xZ(c*n-a*r)]},s}function r1(t){return function(e){var n=new i1;for(var r in t)n[r]=t[r];return n.stream=e,n}}function i1(){}function o1(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),KQ(n,t.stream(zZ)),e(zZ.result()),null!=r&&t.clipExtent(r),t}function s1(t,e,n){return o1(t,(function(n){var r=e[1][0]-e[0][0],i=e[1][1]-e[0][1],o=Math.min(r/(n[1][0]-n[0][0]),i/(n[1][1]-n[0][1])),s=+e[0][0]+(r-o*(n[1][0]+n[0][0]))/2,a=+e[0][1]+(i-o*(n[1][1]+n[0][1]))/2;t.scale(150*o).translate([s,a])}),n)}function a1(t,e,n){return s1(t,[[0,0],e],n)}function l1(t,e,n){return o1(t,(function(n){var r=+e,i=r/(n[1][0]-n[0][0]),o=(r-i*(n[1][0]+n[0][0]))/2,s=-i*n[0][1];t.scale(150*i).translate([o,s])}),n)}function u1(t,e,n){return o1(t,(function(n){var r=+e,i=r/(n[1][1]-n[0][1]),o=-i*n[0][0],s=(r-i*(n[1][1]+n[0][1]))/2;t.scale(150*i).translate([o,s])}),n)}Q0.invert=Q0,i1.prototype={constructor:i1,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var c1=16,h1=cZ(30*sZ);function f1(t,e){return+e?function(t,e){function n(r,i,o,s,a,l,u,c,h,f,d,p,m,g){var y=u-r,b=c-i,v=y*y+b*b;if(v>4*e&&m--){var w=s+f,x=a+d,_=l+p,k=bZ(w*w+x*x+_*_),S=xZ(_/=k),E=aZ(aZ(_)-1)<ZQ||aZ(o-h)<ZQ?(o+h)/2:uZ(x,w),A=t(E,S),C=A[0],D=A[1],M=C-r,O=D-i,T=b*M-y*O;(T*T/v>e||aZ((y*M+b*O)/v-.5)>.3||s*f+a*d+l*p<h1)&&(n(r,i,o,s,a,l,C,D,E,w/=k,x/=k,_,m,g),g.point(C,D),n(C,D,E,w,x,_,u,c,h,f,d,p,m,g))}}return function(e){var r,i,o,s,a,l,u,c,h,f,d,p,m={point:g,lineStart:y,lineEnd:v,polygonStart:function(){e.polygonStart(),m.lineStart=w},polygonEnd:function(){e.polygonEnd(),m.lineStart=y}};function g(n,r){n=t(n,r),e.point(n[0],n[1])}function y(){c=NaN,m.point=b,e.lineStart()}function b(r,i){var o=F0([r,i]),s=t(r,i);n(c,h,u,f,d,p,c=s[0],h=s[1],u=r,f=o[0],d=o[1],p=o[2],c1,e),e.point(c,h)}function v(){m.point=g,e.lineEnd()}function w(){y(),m.point=x,m.lineEnd=_}function x(t,e){b(r=t,e),i=c,o=h,s=f,a=d,l=p,m.point=b}function _(){n(c,h,u,f,d,p,i,o,r,s,a,l,c1,e),m.lineEnd=v,v()}return m}}(t,e):function(t){return r1({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}(t)}var d1=r1({point:function(t,e){this.stream.point(t*sZ,e*sZ)}});function p1(t,e,n,r,i,o){if(!o)return function(t,e,n,r,i){function o(o,s){return[e+t*(o*=r),n-t*(s*=i)]}return o.invert=function(o,s){return[(o-e)/t*r,(n-s)/t*i]},o}(t,e,n,r,i);var s=cZ(o),a=gZ(o),l=s*t,u=a*t,c=s/t,h=a/t,f=(a*n-s*e)/t,d=(a*e+s*n)/t;function p(t,o){return[l*(t*=r)-u*(o*=i)+e,n-u*t-l*o]}return p.invert=function(t,e){return[r*(c*t-h*e+f),i*(d-h*t-c*e)]},p}function m1(t){return g1((function(){return t}))()}function g1(t){var e,n,r,i,o,s,a,l,u,c,h=150,f=480,d=250,p=0,m=0,g=0,y=0,b=0,v=0,w=1,x=1,_=null,k=H0,S=null,E=WQ,A=.5;function C(t){return l(t[0]*sZ,t[1]*sZ)}function D(t){return(t=l.invert(t[0],t[1]))&&[t[0]*oZ,t[1]*oZ]}function M(){var t=p1(h,0,0,w,x,v).apply(null,e(p,m)),r=p1(h,f-t[0],d-t[1],w,x,v);return n=Z0(g,y,b),a=K0(e,r),l=K0(n,a),s=f1(a,A),O()}function O(){return u=c=null,C}return C.stream=function(t){return u&&c===t?u:u=d1(function(t){return r1({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}(n)(k(s(E(c=t)))))},C.preclip=function(t){return arguments.length?(k=t,_=void 0,O()):k},C.postclip=function(t){return arguments.length?(E=t,S=r=i=o=null,O()):E},C.clipAngle=function(t){return arguments.length?(k=+t?function(t){var e=cZ(t),n=2*sZ,r=e>0,i=aZ(e)>ZQ;function o(t,n){return cZ(t)*cZ(n)>e}function s(t,n,r){var i=[1,0,0],o=B0(F0(t),F0(n)),s=L0(o,o),a=o[0],l=s-a*a;if(!l)return!r&&t;var u=e*s/l,c=-e*a/l,h=B0(i,o),f=P0(i,u);R0(f,P0(o,c));var d=h,p=L0(f,d),m=L0(d,d),g=p*p-m*(L0(f,f)-1);if(!(g<0)){var y=bZ(g),b=P0(d,(-p-y)/m);if(R0(b,f),b=$0(b),!r)return b;var v,w=t[0],x=n[0],_=t[1],k=n[1];x<w&&(v=w,w=x,x=v);var S=x-w,E=aZ(S-eZ)<ZQ;if(!E&&k<_&&(v=_,_=k,k=v),E||S<ZQ?E?_+k>0^b[1]<(aZ(b[0]-w)<ZQ?_:k):_<=b[1]&&b[1]<=k:S>eZ^(w<=b[0]&&b[0]<=x)){var A=P0(d,(-p+y)/m);return R0(A,f),[b,$0(A)]}}}function a(e,n){var i=r?t:eZ-t,o=0;return e<-i?o|=1:e>i&&(o|=2),n<-i?o|=4:n>i&&(o|=8),o}return V0(o,(function(t){var e,n,l,u,c;return{lineStart:function(){u=l=!1,c=1},point:function(h,f){var d,p=[h,f],m=o(h,f),g=r?m?0:a(h,f):m?a(h+(h<0?eZ:-eZ),f):0;if(!e&&(u=l=m)&&t.lineStart(),m!==l&&(!(d=s(e,p))||O0(e,d)||O0(p,d))&&(p[2]=1),m!==l)c=0,m?(t.lineStart(),d=s(p,e),t.point(d[0],d[1])):(d=s(e,p),t.point(d[0],d[1],2),t.lineEnd()),e=d;else if(i&&e&&r^m){var y;g&n||!(y=s(p,e,!0))||(c=0,r?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1],3)))}!m||e&&O0(e,p)||t.point(p[0],p[1]),e=p,l=m,n=g},lineEnd:function(){l&&t.lineEnd(),e=null},clean:function(){return c|(u&&l)<<1}}}),(function(e,r,i,o){!function(t,e,n,r,i,o){if(n){var s=cZ(e),a=gZ(e),l=r*n;null==i?(i=e+r*iZ,o=e-l/2):(i=G0(s,i),o=G0(s,o),(r>0?i<o:i>o)&&(i+=r*iZ));for(var u,c=i;r>0?c>o:c<o;c-=l)u=$0([s,-a*cZ(c),-a*gZ(c)]),t.point(u[0],u[1])}}(o,t,n,i,e,r)}),r?[0,-t]:[-eZ,t-eZ])}(_=t*sZ):(_=null,H0),O()):_*oZ},C.clipExtent=function(t){return arguments.length?(E=null==t?(S=r=i=o=null,WQ):J0(S=+t[0][0],r=+t[0][1],i=+t[1][0],o=+t[1][1]),O()):null==S?null:[[S,r],[i,o]]},C.scale=function(t){return arguments.length?(h=+t,M()):h},C.translate=function(t){return arguments.length?(f=+t[0],d=+t[1],M()):[f,d]},C.center=function(t){return arguments.length?(p=t[0]%360*sZ,m=t[1]%360*sZ,M()):[p*oZ,m*oZ]},C.rotate=function(t){return arguments.length?(g=t[0]%360*sZ,y=t[1]%360*sZ,b=t.length>2?t[2]%360*sZ:0,M()):[g*oZ,y*oZ,b*oZ]},C.angle=function(t){return arguments.length?(v=t%360*sZ,M()):v*oZ},C.reflectX=function(t){return arguments.length?(w=t?-1:1,M()):w<0},C.reflectY=function(t){return arguments.length?(x=t?-1:1,M()):x<0},C.precision=function(t){return arguments.length?(s=f1(a,A=t*t),O()):bZ(A)},C.fitExtent=function(t,e){return s1(C,t,e)},C.fitSize=function(t,e){return a1(C,t,e)},C.fitWidth=function(t,e){return l1(C,t,e)},C.fitHeight=function(t,e){return u1(C,t,e)},function(){return e=t.apply(this,arguments),C.invert=e.invert&&D,M()}}function y1(t){var e=0,n=eZ/3,r=g1(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*sZ,n=t[1]*sZ):[e*oZ,n*oZ]},i}function b1(t,e){var n=gZ(t),r=(n+gZ(e))/2;if(aZ(r)<ZQ)return function(t){var e=cZ(t);function n(t,n){return[t*e,gZ(n)/e]}return n.invert=function(t,n){return[t/e,xZ(n*e)]},n}(t);var i=1+n*(2*r-n),o=bZ(i)/r;function s(t,e){var n=bZ(i-2*r*gZ(e))/r;return[n*gZ(t*=r),o-n*cZ(t)]}return s.invert=function(t,e){var n=o-e,s=uZ(t,aZ(n))*yZ(n);return n*r<0&&(s-=eZ*yZ(t)*yZ(n)),[s/r,xZ((i-(t*t+n*n)*r*r)/(2*r))]},s}function v1(){return y1(b1).scale(155.424).center([0,33.6442])}function w1(){return v1().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function x1(t){return function(e,n){var r=cZ(e),i=cZ(n),o=t(r*i);return o===1/0?[2,0]:[o*i*gZ(e),o*gZ(n)]}}function _1(t){return function(e,n){var r=bZ(e*e+n*n),i=t(r),o=gZ(i),s=cZ(i);return[uZ(e*o,r*s),xZ(r&&n*o/r)]}}var k1=x1((function(t){return bZ(2/(1+t))}));k1.invert=_1((function(t){return 2*xZ(t/2)}));var S1=x1((function(t){return(t=wZ(t))&&t/gZ(t)}));function E1(t,e){return[t,pZ(vZ((nZ+e)/2))]}function A1(t){var e,n,r,i=m1(t),o=i.center,s=i.scale,a=i.translate,l=i.clipExtent,u=null;function c(){var o=eZ*s(),a=i(function(t){function e(e){return(e=t(e[0]*sZ,e[1]*sZ))[0]*=oZ,e[1]*=oZ,e}return t=Z0(t[0]*sZ,t[1]*sZ,t.length>2?t[2]*sZ:0),e.invert=function(e){return(e=t.invert(e[0]*sZ,e[1]*sZ))[0]*=oZ,e[1]*=oZ,e},e}(i.rotate()).invert([0,0]));return l(null==u?[[a[0]-o,a[1]-o],[a[0]+o,a[1]+o]]:t===E1?[[Math.max(a[0]-o,u),e],[Math.min(a[0]+o,n),r]]:[[u,Math.max(a[1]-o,e)],[n,Math.min(a[1]+o,r)]])}return i.scale=function(t){return arguments.length?(s(t),c()):s()},i.translate=function(t){return arguments.length?(a(t),c()):a()},i.center=function(t){return arguments.length?(o(t),c()):o()},i.clipExtent=function(t){return arguments.length?(null==t?u=e=n=r=null:(u=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),c()):null==u?null:[[u,e],[n,r]]},c()}function C1(t){return vZ((nZ+t)/2)}function D1(t,e){var n=cZ(t),r=t===e?gZ(t):pZ(n/cZ(e))/pZ(C1(e)/C1(t)),i=n*mZ(C1(t),r)/r;if(!r)return E1;function o(t,e){i>0?e<-nZ+ZQ&&(e=-nZ+ZQ):e>nZ-ZQ&&(e=nZ-ZQ);var n=i/mZ(C1(e),r);return[n*gZ(r*t),i-n*cZ(r*t)]}return o.invert=function(t,e){var n=i-e,o=yZ(r)*bZ(t*t+n*n),s=uZ(t,aZ(n))*yZ(n);return n*r<0&&(s-=eZ*yZ(t)*yZ(n)),[s/r,2*lZ(mZ(i/o,1/r))-nZ]},o}function M1(t,e){return[t,e]}function O1(t,e){var n=cZ(t),r=t===e?gZ(t):(n-cZ(e))/(e-t),i=n/r+t;if(aZ(r)<ZQ)return M1;function o(t,e){var n=i-e,o=r*t;return[n*gZ(o),i-n*cZ(o)]}return o.invert=function(t,e){var n=i-e,o=uZ(t,aZ(n))*yZ(n);return n*r<0&&(o-=eZ*yZ(t)*yZ(n)),[o/r,i-yZ(r)*bZ(t*t+n*n)]},o}S1.invert=_1((function(t){return t})),E1.invert=function(t,e){return[t,2*lZ(fZ(e))-nZ]},M1.invert=M1;var T1=1.340264,I1=-.081106,N1=893e-6,$1=.003796,F1=bZ(3)/2;function L1(t,e){var n=xZ(F1*gZ(e)),r=n*n,i=r*r*r;return[t*cZ(n)/(F1*(T1+3*I1*r+i*(7*N1+9*$1*r))),n*(T1+I1*r+i*(N1+$1*r))]}function B1(t,e){var n=cZ(e),r=cZ(t)*n;return[n*gZ(t)/r,gZ(e)/r]}function R1(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function P1(t,e){return[cZ(e)*gZ(t),gZ(e)]}function z1(t,e){var n=cZ(e),r=1+cZ(t)*n;return[n*gZ(t)/r,gZ(e)/r]}function j1(t,e){return[pZ(vZ((nZ+e)/2)),-t]}L1.invert=function(t,e){for(var n,r=e,i=r*r,o=i*i*i,s=0;s<12&&(o=(i=(r-=n=(r*(T1+I1*i+o*(N1+$1*i))-e)/(T1+3*I1*i+o*(7*N1+9*$1*i)))*r)*i*i,!(aZ(n)<tZ));++s);return[F1*t*(T1+3*I1*i+o*(7*N1+9*$1*i))/cZ(r),xZ(gZ(r)/F1)]},B1.invert=_1(lZ),R1.invert=function(t,e){var n,r=e,i=25;do{var o=r*r,s=o*o;r-=n=(r*(1.007226+o*(.015085+s*(.028874*o-.044475-.005916*s)))-e)/(1.007226+o*(.045255+s*(.259866*o-.311325-.005916*11*s)))}while(aZ(n)>ZQ&&--i>0);return[t/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]},P1.invert=_1(xZ),z1.invert=_1((function(t){return 2*lZ(t)})),j1.invert=function(t,e){return[-e,2*lZ(fZ(t))-nZ]};var U1=Math.abs,V1=(Math.atan,Math.atan2,Math.ceil,Math.cos),q1=(Math.exp,Math.floor,Math.log,Math.max,Math.min,Math.pow,Math.round,Math.sign,Math.sin),W1=(Math.tan,1e-6),H1=Math.PI,G1=H1/2,Y1=(Math.SQRT1_2,J1(2));function X1(t){return t>1?G1:t<-1?-G1:Math.asin(t)}function J1(t){return t>0?Math.sqrt(t):0}function K1(t,e){var n,r=t*q1(e),i=30;do{e-=n=(e+q1(e)-r)/(1+V1(e))}while(U1(n)>W1&&--i>0);return e/2}J1(H1);var Q1=function(t,e,n){function r(r,i){return[t*r*V1(i=K1(n,i)),e*q1(i)]}return r.invert=function(r,i){return i=X1(i/e),[r/(t*V1(i)),X1((2*i+q1(2*i))/n)]},r}(Y1/G1,Y1,H1);const Z1=D0(),t2=["clipAngle","clipExtent","scale","translate","center","rotate","parallels","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];function e2(t,e){if(!t||"string"!=typeof t)throw new Error("Projection type must be a name string.");return t=t.toLowerCase(),arguments.length>1?(r2[t]=function(t,e){return function n(){const r=e();return r.type=t,r.path=D0().projection(r),r.copy=r.copy||function(){const t=n();return t2.forEach((e=>{r[e]&&t[e](r[e]())})),t.path.pointRadius(r.path.pointRadius()),t},kW(r)}}(t,e),this):r2[t]||null}function n2(t){return t&&t.path||Z1}const r2={albers:w1,albersusa:function(){var t,e,n,r,i,o,s=w1(),a=v1().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=v1().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(t,e){o=[t,e]}};function c(t){var e=t[0],s=t[1];return o=null,n.point(e,s),o||(r.point(e,s),o)||(i.point(e,s),o)}function h(){return t=e=null,c}return c.invert=function(t){var e=s.scale(),n=s.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&i<.234&&r>=-.425&&r<-.214?a:i>=.166&&i<.234&&r>=-.214&&r<-.115?l:s).invert(t)},c.stream=function(n){return t&&e===n?t:(r=[s.stream(e=n),a.stream(n),l.stream(n)],i=r.length,t={point:function(t,e){for(var n=-1;++n<i;)r[n].point(t,e)},sphere:function(){for(var t=-1;++t<i;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<i;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<i;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<i;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<i;)r[t].polygonEnd()}});var r,i},c.precision=function(t){return arguments.length?(s.precision(t),a.precision(t),l.precision(t),h()):s.precision()},c.scale=function(t){return arguments.length?(s.scale(t),a.scale(.35*t),l.scale(t),c.translate(s.translate())):s.scale()},c.translate=function(t){if(!arguments.length)return s.translate();var e=s.scale(),o=+t[0],c=+t[1];return n=s.translate(t).clipExtent([[o-.455*e,c-.238*e],[o+.455*e,c+.238*e]]).stream(u),r=a.translate([o-.307*e,c+.201*e]).clipExtent([[o-.425*e+ZQ,c+.12*e+ZQ],[o-.214*e-ZQ,c+.234*e-ZQ]]).stream(u),i=l.translate([o-.205*e,c+.212*e]).clipExtent([[o-.214*e+ZQ,c+.166*e+ZQ],[o-.115*e-ZQ,c+.234*e-ZQ]]).stream(u),h()},c.fitExtent=function(t,e){return s1(c,t,e)},c.fitSize=function(t,e){return a1(c,t,e)},c.fitWidth=function(t,e){return l1(c,t,e)},c.fitHeight=function(t,e){return u1(c,t,e)},c.scale(1070)},azimuthalequalarea:function(){return m1(k1).scale(124.75).clipAngle(179.999)},azimuthalequidistant:function(){return m1(S1).scale(79.4188).clipAngle(179.999)},conicconformal:function(){return y1(D1).scale(109.5).parallels([30,30])},conicequalarea:v1,conicequidistant:function(){return y1(O1).scale(131.154).center([0,13.9389])},equalEarth:function(){return m1(L1).scale(177.158)},equirectangular:function(){return m1(M1).scale(152.63)},gnomonic:function(){return m1(B1).scale(144.049).clipAngle(60)},identity:function(){var t,e,n,r,i,o,s,a=1,l=0,u=0,c=1,h=1,f=0,d=null,p=1,m=1,g=r1({point:function(t,e){var n=v([t,e]);this.stream.point(n[0],n[1])}}),y=WQ;function b(){return p=a*c,m=a*h,o=s=null,v}function v(n){var r=n[0]*p,i=n[1]*m;if(f){var o=i*t-r*e;r=r*t+i*e,i=o}return[r+l,i+u]}return v.invert=function(n){var r=n[0]-l,i=n[1]-u;if(f){var o=i*t+r*e;r=r*t-i*e,i=o}return[r/p,i/m]},v.stream=function(t){return o&&s===t?o:o=g(y(s=t))},v.postclip=function(t){return arguments.length?(y=t,d=n=r=i=null,b()):y},v.clipExtent=function(t){return arguments.length?(y=null==t?(d=n=r=i=null,WQ):J0(d=+t[0][0],n=+t[0][1],r=+t[1][0],i=+t[1][1]),b()):null==d?null:[[d,n],[r,i]]},v.scale=function(t){return arguments.length?(a=+t,b()):a},v.translate=function(t){return arguments.length?(l=+t[0],u=+t[1],b()):[l,u]},v.angle=function(n){return arguments.length?(e=gZ(f=n%360*sZ),t=cZ(f),b()):f*oZ},v.reflectX=function(t){return arguments.length?(c=t?-1:1,b()):c<0},v.reflectY=function(t){return arguments.length?(h=t?-1:1,b()):h<0},v.fitExtent=function(t,e){return s1(v,t,e)},v.fitSize=function(t,e){return a1(v,t,e)},v.fitWidth=function(t,e){return l1(v,t,e)},v.fitHeight=function(t,e){return u1(v,t,e)},v},mercator:function(){return A1(E1).scale(961/iZ)},mollweide:function(){return m1(Q1).scale(169.529)},naturalEarth1:function(){return m1(R1).scale(175.295)},orthographic:function(){return m1(P1).scale(249.5).clipAngle(90+ZQ)},stereographic:function(){return m1(z1).scale(250).clipAngle(142)},transversemercator:function(){var t=A1(j1),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)}};for(const t in r2)e2(t,r2[t]);function i2(t,e,n){var r=xz(t,e-ZQ,n).concat(e);return function(t){return r.map((function(e){return[t,e]}))}}function o2(t,e,n){var r=xz(t,e-ZQ,n).concat(e);return function(t){return r.map((function(e){return[e,t]}))}}function s2(){}const a2=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function l2(){var t=1,e=1,n=s;function r(t,e){return e.map((e=>i(t,e)))}function i(r,i){var s=[],a=[];return function(n,r,i){var s,a,l,u,c,h,f=new Array,d=new Array;for(s=a=-1,u=n[0]>=r,a2[u<<1].forEach(p);++s<t-1;)l=u,u=n[s+1]>=r,a2[l|u<<1].forEach(p);for(a2[0|u].forEach(p);++a<e-1;){for(s=-1,u=n[a*t+t]>=r,c=n[a*t]>=r,a2[u<<1|c<<2].forEach(p);++s<t-1;)l=u,u=n[a*t+t+s+1]>=r,h=c,c=n[a*t+s+1]>=r,a2[l|u<<1|c<<2|h<<3].forEach(p);a2[u|c<<3].forEach(p)}for(s=-1,c=n[a*t]>=r,a2[c<<2].forEach(p);++s<t-1;)h=c,c=n[a*t+s+1]>=r,a2[c<<2|h<<3].forEach(p);function p(t){var e,n,r=[t[0][0]+s,t[0][1]+a],l=[t[1][0]+s,t[1][1]+a],u=o(r),c=o(l);(e=d[u])?(n=f[c])?(delete d[e.end],delete f[n.start],e===n?(e.ring.push(l),i(e.ring)):f[e.start]=d[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete d[e.end],e.ring.push(l),d[e.end=c]=e):(e=f[c])?(n=d[u])?(delete f[e.start],delete d[n.end],e===n?(e.ring.push(l),i(e.ring)):f[n.start]=d[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete f[e.start],e.ring.unshift(r),f[e.start=u]=e):f[u]=d[c]={start:u,end:c,ring:[r,l]}}a2[c<<3].forEach(p)}(r,i,(t=>{n(t,r,i),function(t){for(var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r}(t)>0?s.push([t]):a.push(t)})),a.forEach((t=>{for(var e,n=0,r=s.length;n<r;++n)if(-1!==u2((e=s[n])[0],t))return void e.push(t)})),{type:"MultiPolygon",value:i,coordinates:s}}function o(e){return 2*e[0]+e[1]*(t+1)*4}function s(n,r,i){n.forEach((n=>{var o,s=n[0],a=n[1],l=0|s,u=0|a,c=r[u*t+l];s>0&&s<t&&l===s&&(o=r[u*t+l-1],n[0]=s+(i-o)/(c-o)-.5),a>0&&a<e&&u===a&&(o=r[(u-1)*t+l],n[1]=a+(i-o)/(c-o)-.5)}))}return r.contour=i,r.size=function(n){if(!arguments.length)return[t,e];var i=Math.floor(n[0]),o=Math.floor(n[1]);return i>=0&&o>=0||L$("invalid size"),t=i,e=o,r},r.smooth=function(t){return arguments.length?(n=t?s:s2,r):n===s},r}function u2(t,e){for(var n,r=-1,i=e.length;++r<i;)if(n=c2(t,e[r]))return n;return 0}function c2(t,e){for(var n=e[0],r=e[1],i=-1,o=0,s=t.length,a=s-1;o<s;a=o++){var l=t[o],u=l[0],c=l[1],h=t[a],f=h[0],d=h[1];if(h2(l,h,e))return 0;c>r!=d>r&&n<(f-u)*(r-c)/(d-c)+u&&(i=-i)}return i}function h2(t,e,n){var r,i,o,s;return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])==(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&(i=t[r=+(t[0]===e[0])],o=n[r],s=e[r],i<=o&&o<=s||s<=o&&o<=i)}function f2(t,e,n){return function(r){var i=FF(r),o=n?Math.min(i[0],0):i[0],s=i[1],a=s-o,l=e?$M(o,s,t):a/(t+1);return xz(o+l,s,l)}}function d2(t){dP.call(this,null,t)}function p2(t,e,n,r,i){const o=t.x1||0,s=t.y1||0,a=e*n<0;function l(t){t.forEach(u)}function u(t){a&&t.reverse(),t.forEach(c)}function c(t){t[0]=(t[0]-o)*e+r,t[1]=(t[1]-s)*n+i}return function(t){return t.coordinates.forEach(l),t}}function m2(t,e,n){const r=t>=0?t:CP(e,n);return Math.round((Math.sqrt(4*r*r+1)-1)/2)}function g2(t){return EF(t)?t:IF(+t)}function y2(){var t=t=>t[0],e=t=>t[1],n=U$,r=[-1,-1],i=960,o=500,s=2;function a(a,l){const u=m2(r[0],a,t)>>s,c=m2(r[1],a,e)>>s,h=u?u+2:0,f=c?c+2:0,d=2*h+(i>>s),p=2*f+(o>>s),m=new Float32Array(d*p),g=new Float32Array(d*p);let y=m;a.forEach((r=>{const i=h+(+t(r)>>s),o=f+(+e(r)>>s);i>=0&&i<d&&o>=0&&o<p&&(m[i+o*d]+=+n(r))})),u>0&&c>0?(b2(d,p,m,g,u),v2(d,p,g,m,c),b2(d,p,m,g,u),v2(d,p,g,m,c),b2(d,p,m,g,u),v2(d,p,g,m,c)):u>0?(b2(d,p,m,g,u),b2(d,p,g,m,u),b2(d,p,m,g,u),y=g):c>0&&(v2(d,p,m,g,c),v2(d,p,g,m,c),v2(d,p,m,g,c),y=g);const b=l?Math.pow(2,-2*s):1/pQ(y);for(let t=0,e=d*p;t<e;++t)y[t]*=b;return{values:y,scale:1<<s,width:d,height:p,x1:h,y1:f,x2:h+(i>>s),y2:f+(o>>s)}}return a.x=function(e){return arguments.length?(t=g2(e),a):t},a.y=function(t){return arguments.length?(e=g2(t),a):e},a.weight=function(t){return arguments.length?(n=g2(t),a):n},a.size=function(t){if(!arguments.length)return[i,o];var e=+t[0],n=+t[1];return e>=0&&n>=0||L$("invalid size"),i=e,o=n,a},a.cellSize=function(t){return arguments.length?((t=+t)>=1||L$("invalid cell size"),s=Math.floor(Math.log(t)/Math.LN2),a):1<<s},a.bandwidth=function(t){return arguments.length?(1===(t=kF(t)).length&&(t=[+t[0],+t[0]]),2!==t.length&&L$("invalid bandwidth"),r=t,a):r},a}function b2(t,e,n,r,i){const o=1+(i<<1);for(let s=0;s<e;++s)for(let e=0,a=0;e<t+i;++e)e<t&&(a+=n[e+s*t]),e>=i&&(e>=o&&(a-=n[e-o+s*t]),r[e-i+s*t]=a/Math.min(e+1,t-1+o-e,o))}function v2(t,e,n,r,i){const o=1+(i<<1);for(let s=0;s<t;++s)for(let a=0,l=0;a<e+i;++a)a<e&&(l+=n[s+a*t]),a>=i&&(a>=o&&(l-=n[s+(a-o)*t]),r[s+(a-i)*t]=l/Math.min(a+1,e-1+o-a,o))}function w2(t){dP.call(this,null,t)}d2.Definition={type:"Isocontour",metadata:{generates:!0},params:[{name:"field",type:"field"},{name:"thresholds",type:"number",array:!0},{name:"levels",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"zero",type:"boolean",default:!0},{name:"smooth",type:"boolean",default:!0},{name:"scale",type:"number",expr:!0},{name:"translate",type:"number",array:!0,expr:!0},{name:"as",type:"string",null:!0,default:"contour"}]},UF(d2,dP,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n=e.fork(e.NO_SOURCE|e.NO_FIELDS),r=e.materialize(e.SOURCE).source,i=t.field||z$,o=l2().smooth(!1!==t.smooth),s=t.thresholds||function(t,e,n){const r=f2(n.levels||10,n.nice,!1!==n.zero);return"shared"!==n.resolve?r:r(t.map((t=>VE(e(t).values))))}(r,i,t),a=null===t.as?null:t.as||"contour",l=[];return r.forEach((e=>{const n=i(e),r=o.size([n.width,n.height])(n.values,Q$(s)?s:s(n.values));!function(t,e,n,r){let i=r.scale||e.scale,o=r.translate||e.translate;if(EF(i)&&(i=i(n,r)),EF(o)&&(o=o(n,r)),(1===i||null==i)&&!o)return;const s=(GF(i)?i:i[0])||1,a=(GF(i)?i:i[1])||1,l=o&&o[0]||0,u=o&&o[1]||0;t.forEach(p2(e,s,a,l,u))}(r,n,e,t),r.forEach((t=>{l.push(PR(e,BR(null!=a?{[a]:t}:t)))}))})),this.value&&(n.rem=this.value),this.value=n.source=n.add=l,n}}),w2.Definition={type:"KDE2D",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"weight",type:"field"},{name:"groupby",type:"field",array:!0},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number",array:!0,length:2},{name:"counts",type:"boolean",default:!1},{name:"as",type:"string",default:"grid"}]};const x2=["x","y","weight","size","cellSize","bandwidth"];function _2(t,e){return x2.forEach((n=>null!=e[n]?t[n](e[n]):0)),t}function k2(t){dP.call(this,null,t)}UF(w2,dP,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r=e.fork(e.NO_SOURCE|e.NO_FIELDS),i=function(t,e){var n,r,i,o,s,a,l=[],u=t=>t(o);if(null==e)l.push(t);else for(n={},r=0,i=t.length;r<i;++r)o=t[r],(a=n[s=e.map(u)])||(n[s]=a=[],a.dims=s,l.push(a)),a.push(o);return l}(e.materialize(e.SOURCE).source,t.groupby),o=(t.groupby||[]).map(T$),s=_2(y2(),t),a=t.as||"grid";return n=i.map((e=>BR(function(t,e){for(let n=0;n<o.length;++n)t[o[n]]=e[n];return t}({[a]:s(e,t.counts)},e.dims)))),this.value&&(r.rem=this.value),this.value=r.source=r.add=n,r}}),k2.Definition={type:"Contour",metadata:{generates:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"values",type:"number",array:!0},{name:"x",type:"field"},{name:"y",type:"field"},{name:"weight",type:"field"},{name:"cellSize",type:"number"},{name:"bandwidth",type:"number"},{name:"count",type:"number"},{name:"nice",type:"boolean",default:!1},{name:"thresholds",type:"number",array:!0},{name:"smooth",type:"boolean",default:!0}]},UF(k2,dP,{transform(t,e){if(this.value&&!e.changed()&&!t.modified())return e.StopPropagation;var n,r,i=e.fork(e.NO_SOURCE|e.NO_FIELDS),o=l2().smooth(!1!==t.smooth),s=t.values,a=t.thresholds||f2(t.count||10,t.nice,!!s),l=t.size;return s||(s=e.materialize(e.SOURCE).source,r=p2(n=_2(y2(),t)(s,!0),n.scale||1,n.scale||1,0,0),l=[n.width,n.height],s=n.values),a=Q$(a)?a:a(s),s=o.size(l)(s,a),r&&s.forEach(r),this.value&&(i.rem=this.value),this.value=i.source=i.add=(s||[]).map(BR),i}});const S2="Feature",E2="FeatureCollection";function A2(t){dP.call(this,null,t)}function C2(t){dP.call(this,null,t)}function D2(t){dP.call(this,null,t)}function M2(t){dP.call(this,null,t)}function O2(t){dP.call(this,[],t),this.generator=function(){var t,e,n,r,i,o,s,a,l,u,c,h,f=10,d=f,p=90,m=360,g=2.5;function y(){return{type:"MultiLineString",coordinates:b()}}function b(){return xz(hZ(r/p)*p,n,p).map(c).concat(xz(hZ(a/m)*m,s,m).map(h)).concat(xz(hZ(e/f)*f,t,f).filter((function(t){return aZ(t%p)>ZQ})).map(l)).concat(xz(hZ(o/d)*d,i,d).filter((function(t){return aZ(t%m)>ZQ})).map(u))}return y.lines=function(){return b().map((function(t){return{type:"LineString",coordinates:t}}))},y.outline=function(){return{type:"Polygon",coordinates:[c(r).concat(h(s).slice(1),c(n).reverse().slice(1),h(a).reverse().slice(1))]}},y.extent=function(t){return arguments.length?y.extentMajor(t).extentMinor(t):y.extentMinor()},y.extentMajor=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],a=+t[0][1],s=+t[1][1],r>n&&(t=r,r=n,n=t),a>s&&(t=a,a=s,s=t),y.precision(g)):[[r,a],[n,s]]},y.extentMinor=function(n){return arguments.length?(e=+n[0][0],t=+n[1][0],o=+n[0][1],i=+n[1][1],e>t&&(n=e,e=t,t=n),o>i&&(n=o,o=i,i=n),y.precision(g)):[[e,o],[t,i]]},y.step=function(t){return arguments.length?y.stepMajor(t).stepMinor(t):y.stepMinor()},y.stepMajor=function(t){return arguments.length?(p=+t[0],m=+t[1],y):[p,m]},y.stepMinor=function(t){return arguments.length?(f=+t[0],d=+t[1],y):[f,d]},y.precision=function(f){return arguments.length?(g=+f,l=i2(o,i,90),u=o2(e,t,g),c=i2(a,s,90),h=o2(r,n,g),y):g},y.extentMajor([[-180,-90+ZQ],[180,90-ZQ]]).extentMinor([[-180,-80-ZQ],[180,80+ZQ]])}()}function T2(t){dP.call(this,null,t)}function I2(t){if(!EF(t))return!1;const e=uL(I$(t));return e.$x||e.$y||e.$value||e.$max}function N2(t){dP.call(this,null,t),this.modified(!0)}function $2(t,e,n){EF(t[e])&&t[e](n)}function F2(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,o,s,a,l,u,c,h,f,d=t._root,p={data:r},m=t._x0,g=t._y0,y=t._x1,b=t._y1;if(!d)return t._root=p,t;for(;d.length;)if((u=e>=(o=(m+y)/2))?m=o:y=o,(c=n>=(s=(g+b)/2))?g=s:b=s,i=d,!(d=d[h=c<<1|u]))return i[h]=p,t;if(a=+t._x.call(null,d.data),l=+t._y.call(null,d.data),e===a&&n===l)return p.next=d,i?i[h]=p:t._root=p,t;do{i=i?i[h]=new Array(4):t._root=new Array(4),(u=e>=(o=(m+y)/2))?m=o:y=o,(c=n>=(s=(g+b)/2))?g=s:b=s}while((h=c<<1|u)==(f=(l>=s)<<1|a>=o));return i[f]=d,i[h]=p,t}function L2(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function B2(t){return t[0]}function R2(t){return t[1]}function P2(t,e,n){var r=new z2(null==e?B2:e,null==n?R2:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function z2(t,e,n,r,i,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=o,this._root=void 0}function j2(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}A2.Definition={type:"GeoJSON",metadata:{},params:[{name:"fields",type:"field",array:!0,length:2},{name:"geojson",type:"field"}]},UF(A2,dP,{transform(t,e){var n,r=this._features,i=this._points,o=t.fields,s=o&&o[0],a=o&&o[1],l=t.geojson||!o&&z$,u=e.ADD;n=t.modified()||e.changed(e.REM)||e.modified(I$(l))||s&&e.modified(I$(s))||a&&e.modified(I$(a)),this.value&&!n||(u=e.SOURCE,this._features=r=[],this._points=i=[]),l&&e.visit(u,(t=>r.push(l(t)))),s&&a&&(e.visit(u,(t=>{var e=s(t),n=a(t);null!=e&&null!=n&&(e=+e)===e&&(n=+n)===n&&i.push([e,n])})),r=r.concat({type:S2,geometry:{type:"MultiPoint",coordinates:i}})),this.value={type:E2,features:r}}}),C2.Definition={type:"GeoPath",metadata:{modifies:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"path"}]},UF(C2,dP,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.field||z$,o=t.as||"path",s=n.SOURCE;!r||t.modified()?(this.value=r=n2(t.projection),n.materialize().reflow()):s=i===z$||e.modified(i.fields)?n.ADD_MOD:n.ADD;const a=function(t,e){const n=t.pointRadius();return t.context(null),null!=e&&t.pointRadius(e),n}(r,t.pointRadius);return n.visit(s,(t=>t[o]=r(i(t)))),r.pointRadius(a),n.modifies(o)}}),D2.Definition={type:"GeoPoint",metadata:{modifies:!0},params:[{name:"projection",type:"projection",required:!0},{name:"fields",type:"field",array:!0,required:!0,length:2},{name:"as",type:"string",array:!0,length:2,default:["x","y"]}]},UF(D2,dP,{transform(t,e){var n,r=t.projection,i=t.fields[0],o=t.fields[1],s=t.as||["x","y"],a=s[0],l=s[1];function u(t){const e=r([i(t),o(t)]);e?(t[a]=e[0],t[l]=e[1]):(t[a]=void 0,t[l]=void 0)}return t.modified()?e=e.materialize().reflow(!0).visit(e.SOURCE,u):(n=e.modified(i.fields)||e.modified(o.fields),e.visit(n?e.ADD_MOD:e.ADD,u)),e.modifies(s)}}),M2.Definition={type:"GeoShape",metadata:{modifies:!0,nomod:!0},params:[{name:"projection",type:"projection"},{name:"field",type:"field",default:"datum"},{name:"pointRadius",type:"number",expr:!0},{name:"as",type:"string",default:"shape"}]},UF(M2,dP,{transform(t,e){var n=e.fork(e.ALL),r=this.value,i=t.as||"shape",o=n.ADD;return r&&!t.modified()||(this.value=r=function(t,e,n){const r=null==n?n=>t(e(n)):r=>{var i=t.pointRadius(),o=t.pointRadius(n)(e(r));return t.pointRadius(i),o};return r.context=e=>(t.context(e),r),r}(n2(t.projection),t.field||R$("datum"),t.pointRadius),n.materialize().reflow(),o=n.SOURCE),n.visit(o,(t=>t[i]=r)),n.modifies(i)}}),O2.Definition={type:"Graticule",metadata:{changes:!0,generates:!0},params:[{name:"extent",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMajor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"extentMinor",type:"array",array:!0,length:2,content:{type:"number",array:!0,length:2}},{name:"step",type:"number",array:!0,length:2},{name:"stepMajor",type:"number",array:!0,length:2,default:[90,360]},{name:"stepMinor",type:"number",array:!0,length:2,default:[10,10]},{name:"precision",type:"number",default:2.5}]},UF(O2,dP,{transform(t,e){var n,r=this.value,i=this.generator;if(!r.length||t.modified())for(const e in t)EF(i[e])&&i[e](t[e]);return n=i(),r.length?e.mod.push(zR(r[0],n)):e.add.push(BR(n)),r[0]=n,e}}),T2.Definition={type:"heatmap",metadata:{modifies:!0},params:[{name:"field",type:"field"},{name:"color",type:"string",expr:!0},{name:"opacity",type:"number",expr:!0},{name:"resolve",type:"enum",values:["shared","independent"],default:"independent"},{name:"as",type:"string",default:"image"}]},UF(T2,dP,{transform(t,e){if(!e.changed()&&!t.modified())return e.StopPropagation;var n=e.materialize(e.SOURCE).source,r="shared"===t.resolve,i=t.field||z$,o=function(t,e){let n;return EF(t)?(n=n=>t(n,e),n.dep=I2(t)):t?n=IF(t):(n=t=>t.$value/t.$max||0,n.dep=!0),n}(t.opacity,t),s=function(t,e){let n;return EF(t)?(n=n=>pD(t(n,e)),n.dep=I2(t)):n=IF(pD(t||"#888")),n}(t.color,t),a=t.as||"image",l={$x:0,$y:0,$value:0,$max:r?VE(n.map((t=>VE(i(t).values)))):0};return n.forEach((t=>{const e=i(t),n=$F({},t,l);r||(n.$max=VE(e.values||[])),t[a]=function(t,e,n,r){const i=t.width,o=t.height,s=t.x1||0,a=t.y1||0,l=t.x2||i,u=t.y2||o,c=t.values,h=c?t=>c[t]:j$,f=aV(l-s,u-a),d=f.getContext("2d"),p=d.getImageData(0,0,l-s,u-a),m=p.data;for(let t=a,o=0;t<u;++t){e.$y=t-a;for(let a=s,u=t*i;a<l;++a,o+=4){e.$x=a-s,e.$value=h(a+u);const t=n(e);m[o+0]=t.r,m[o+1]=t.g,m[o+2]=t.b,m[o+3]=~~(255*r(e))}}return d.putImageData(p,0,0),f}(e,n,s.dep?s:IF(s(n)),o.dep?o:IF(o(n)))})),e.reflow(!0).modifies(a)}}),UF(N2,dP,{transform(t,e){let n=this.value;return!n||t.modified("type")?(this.value=n=function(t){const e=e2((t||"mercator").toLowerCase());return e||L$("Unrecognized projection type: "+t),e()}(t.type),t2.forEach((e=>{null!=t[e]&&$2(n,e,t[e])}))):t2.forEach((e=>{t.modified(e)&&$2(n,e,t[e])})),null!=t.pointRadius&&n.path.pointRadius(t.pointRadius),t.fit&&function(t,e){const n=function(t){return 1===(t=kF(t)).length?t[0]:{type:E2,features:t.reduce(((t,e)=>t.concat(function(t){return t.type===E2?t.features:kF(t).filter((t=>null!=t)).map((t=>t.type===S2?t:{type:S2,geometry:t}))}(e))),[])}}(e.fit);e.extent?t.fitExtent(e.extent,n):e.size&&t.fitSize(e.size,n)}(n,t),e.fork(e.NO_SOURCE|e.NO_FIELDS)}});var U2=P2.prototype=z2.prototype;function V2(t){return function(){return t}}function q2(t){return 1e-6*(t()-.5)}function W2(t){return t.x+t.vx}function H2(t){return t.y+t.vy}U2.copy=function(){var t,e,n=new z2(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=j2(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var i=0;i<4;++i)(e=r.source[i])&&(e.length?t.push({source:e,target:r.target[i]=new Array(4)}):r.target[i]=j2(e));return n},U2.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return F2(this.cover(e,n),e,n,t)},U2.addAll=function(t){var e,n,r,i,o=t.length,s=new Array(o),a=new Array(o),l=1/0,u=1/0,c=-1/0,h=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(i=+this._y.call(null,e))||(s[n]=r,a[n]=i,r<l&&(l=r),r>c&&(c=r),i<u&&(u=i),i>h&&(h=i));if(l>c||u>h)return this;for(this.cover(l,u).cover(c,h),n=0;n<o;++n)F2(this,s[n],a[n],t[n]);return this},U2.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,o=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{for(var s,a,l=i-n||1,u=this._root;n>t||t>=i||r>e||e>=o;)switch(a=(e<r)<<1|t<n,(s=new Array(4))[a]=u,u=s,l*=2,a){case 0:i=n+l,o=r+l;break;case 1:n=i-l,o=r+l;break;case 2:i=n+l,r=o-l;break;case 3:n=i-l,r=o-l}this._root&&this._root.length&&(this._root=u)}return this._x0=n,this._y0=r,this._x1=i,this._y1=o,this},U2.data=function(){var t=[];return this.visit((function(e){if(!e.length)do{t.push(e.data)}while(e=e.next)})),t},U2.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},U2.find=function(t,e,n){var r,i,o,s,a,l,u,c=this._x0,h=this._y0,f=this._x1,d=this._y1,p=[],m=this._root;for(m&&p.push(new L2(m,c,h,f,d)),null==n?n=1/0:(c=t-n,h=e-n,f=t+n,d=e+n,n*=n);l=p.pop();)if(!(!(m=l.node)||(i=l.x0)>f||(o=l.y0)>d||(s=l.x1)<c||(a=l.y1)<h))if(m.length){var g=(i+s)/2,y=(o+a)/2;p.push(new L2(m[3],g,y,s,a),new L2(m[2],i,y,g,a),new L2(m[1],g,o,s,y),new L2(m[0],i,o,g,y)),(u=(e>=y)<<1|t>=g)&&(l=p[p.length-1],p[p.length-1]=p[p.length-1-u],p[p.length-1-u]=l)}else{var b=t-+this._x.call(null,m.data),v=e-+this._y.call(null,m.data),w=b*b+v*v;if(w<n){var x=Math.sqrt(n=w);c=t-x,h=e-x,f=t+x,d=e+x,r=m.data}}return r},U2.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(s=+this._y.call(null,t)))return this;var e,n,r,i,o,s,a,l,u,c,h,f,d=this._root,p=this._x0,m=this._y0,g=this._x1,y=this._y1;if(!d)return this;if(d.length)for(;;){if((u=o>=(a=(p+g)/2))?p=a:g=a,(c=s>=(l=(m+y)/2))?m=l:y=l,e=d,!(d=d[h=c<<1|u]))return this;if(!d.length)break;(e[h+1&3]||e[h+2&3]||e[h+3&3])&&(n=e,f=h)}for(;d.data!==t;)if(r=d,!(d=d.next))return this;return(i=d.next)&&delete d.next,r?(i?r.next=i:delete r.next,this):e?(i?e[h]=i:delete e[h],(d=e[0]||e[1]||e[2]||e[3])&&d===(e[3]||e[2]||e[1]||e[0])&&!d.length&&(n?n[f]=d:this._root=d),this):(this._root=i,this)},U2.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},U2.root=function(){return this._root},U2.size=function(){var t=0;return this.visit((function(e){if(!e.length)do{++t}while(e=e.next)})),t},U2.visit=function(t){var e,n,r,i,o,s,a=[],l=this._root;for(l&&a.push(new L2(l,this._x0,this._y0,this._x1,this._y1));e=a.pop();)if(!t(l=e.node,r=e.x0,i=e.y0,o=e.x1,s=e.y1)&&l.length){var u=(r+o)/2,c=(i+s)/2;(n=l[3])&&a.push(new L2(n,u,c,o,s)),(n=l[2])&&a.push(new L2(n,r,c,u,s)),(n=l[1])&&a.push(new L2(n,u,i,o,c)),(n=l[0])&&a.push(new L2(n,r,i,u,c))}return this},U2.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new L2(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var i=e.node;if(i.length){var o,s=e.x0,a=e.y0,l=e.x1,u=e.y1,c=(s+l)/2,h=(a+u)/2;(o=i[0])&&n.push(new L2(o,s,a,c,h)),(o=i[1])&&n.push(new L2(o,c,a,l,h)),(o=i[2])&&n.push(new L2(o,s,h,c,u)),(o=i[3])&&n.push(new L2(o,c,h,l,u))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},U2.x=function(t){return arguments.length?(this._x=t,this):this._x},U2.y=function(t){return arguments.length?(this._y=t,this):this._y};const G2=4294967296;function Y2(t){return t.x}function X2(t){return t.y}var J2=Math.PI*(3-Math.sqrt(5));function K2(t){return t.index}function Q2(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}const Z2={center:function(t,e){var n,r=1;function i(){var i,o,s=n.length,a=0,l=0;for(i=0;i<s;++i)a+=(o=n[i]).x,l+=o.y;for(a=(a/s-t)*r,l=(l/s-e)*r,i=0;i<s;++i)(o=n[i]).x-=a,o.y-=l}return null==t&&(t=0),null==e&&(e=0),i.initialize=function(t){n=t},i.x=function(e){return arguments.length?(t=+e,i):t},i.y=function(t){return arguments.length?(e=+t,i):e},i.strength=function(t){return arguments.length?(r=+t,i):r},i},collide:function(t){var e,n,r,i=1,o=1;function s(){for(var t,s,l,u,c,h,f,d=e.length,p=0;p<o;++p)for(s=P2(e,W2,H2).visitAfter(a),t=0;t<d;++t)l=e[t],h=n[l.index],f=h*h,u=l.x+l.vx,c=l.y+l.vy,s.visit(m);function m(t,e,n,o,s){var a=t.data,d=t.r,p=h+d;if(!a)return e>u+p||o<u-p||n>c+p||s<c-p;if(a.index>l.index){var m=u-a.x-a.vx,g=c-a.y-a.vy,y=m*m+g*g;y<p*p&&(0===m&&(y+=(m=q2(r))*m),0===g&&(y+=(g=q2(r))*g),y=(p-(y=Math.sqrt(y)))/y*i,l.vx+=(m*=y)*(p=(d*=d)/(f+d)),l.vy+=(g*=y)*p,a.vx-=m*(p=1-p),a.vy-=g*p)}}}function a(t){if(t.data)return t.r=n[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function l(){if(e){var r,i,o=e.length;for(n=new Array(o),r=0;r<o;++r)i=e[r],n[i.index]=+t(i,r,e)}}return"function"!=typeof t&&(t=V2(null==t?1:+t)),s.initialize=function(t,n){e=t,r=n,l()},s.iterations=function(t){return arguments.length?(o=+t,s):o},s.strength=function(t){return arguments.length?(i=+t,s):i},s.radius=function(e){return arguments.length?(t="function"==typeof e?e:V2(+e),l(),s):t},s},nbody:function(){var t,e,n,r,i,o=V2(-30),s=1,a=1/0,l=.81;function u(n){var i,o=t.length,s=P2(t,Y2,X2).visitAfter(h);for(r=n,i=0;i<o;++i)e=t[i],s.visit(f)}function c(){if(t){var e,n,r=t.length;for(i=new Array(r),e=0;e<r;++e)n=t[e],i[n.index]=+o(n,e,t)}}function h(t){var e,n,r,o,s,a=0,l=0;if(t.length){for(r=o=s=0;s<4;++s)(e=t[s])&&(n=Math.abs(e.value))&&(a+=e.value,l+=n,r+=n*e.x,o+=n*e.y);t.x=r/l,t.y=o/l}else{(e=t).x=e.data.x,e.y=e.data.y;do{a+=i[e.data.index]}while(e=e.next)}t.value=a}function f(t,o,u,c){if(!t.value)return!0;var h=t.x-e.x,f=t.y-e.y,d=c-o,p=h*h+f*f;if(d*d/l<p)return p<a&&(0===h&&(p+=(h=q2(n))*h),0===f&&(p+=(f=q2(n))*f),p<s&&(p=Math.sqrt(s*p)),e.vx+=h*t.value*r/p,e.vy+=f*t.value*r/p),!0;if(!(t.length||p>=a)){(t.data!==e||t.next)&&(0===h&&(p+=(h=q2(n))*h),0===f&&(p+=(f=q2(n))*f),p<s&&(p=Math.sqrt(s*p)));do{t.data!==e&&(d=i[t.data.index]*r/p,e.vx+=h*d,e.vy+=f*d)}while(t=t.next)}}return u.initialize=function(e,r){t=e,n=r,c()},u.strength=function(t){return arguments.length?(o="function"==typeof t?t:V2(+t),c(),u):o},u.distanceMin=function(t){return arguments.length?(s=t*t,u):Math.sqrt(s)},u.distanceMax=function(t){return arguments.length?(a=t*t,u):Math.sqrt(a)},u.theta=function(t){return arguments.length?(l=t*t,u):Math.sqrt(l)},u},link:function(t){var e,n,r,i,o,s,a=K2,l=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},u=V2(30),c=1;function h(r){for(var i=0,a=t.length;i<c;++i)for(var l,u,h,f,d,p,m,g=0;g<a;++g)u=(l=t[g]).source,f=(h=l.target).x+h.vx-u.x-u.vx||q2(s),d=h.y+h.vy-u.y-u.vy||q2(s),f*=p=((p=Math.sqrt(f*f+d*d))-n[g])/p*r*e[g],d*=p,h.vx-=f*(m=o[g]),h.vy-=d*m,u.vx+=f*(m=1-m),u.vy+=d*m}function f(){if(r){var s,l,u=r.length,c=t.length,h=new Map(r.map(((t,e)=>[a(t,e,r),t])));for(s=0,i=new Array(u);s<c;++s)(l=t[s]).index=s,"object"!=typeof l.source&&(l.source=Q2(h,l.source)),"object"!=typeof l.target&&(l.target=Q2(h,l.target)),i[l.source.index]=(i[l.source.index]||0)+1,i[l.target.index]=(i[l.target.index]||0)+1;for(s=0,o=new Array(c);s<c;++s)l=t[s],o[s]=i[l.source.index]/(i[l.source.index]+i[l.target.index]);e=new Array(c),d(),n=new Array(c),p()}}function d(){if(r)for(var n=0,i=t.length;n<i;++n)e[n]=+l(t[n],n,t)}function p(){if(r)for(var e=0,i=t.length;e<i;++e)n[e]=+u(t[e],e,t)}return null==t&&(t=[]),h.initialize=function(t,e){r=t,s=e,f()},h.links=function(e){return arguments.length?(t=e,f(),h):t},h.id=function(t){return arguments.length?(a=t,h):a},h.iterations=function(t){return arguments.length?(c=+t,h):c},h.strength=function(t){return arguments.length?(l="function"==typeof t?t:V2(+t),d(),h):l},h.distance=function(t){return arguments.length?(u="function"==typeof t?t:V2(+t),p(),h):u},h},x:function(t){var e,n,r,i=V2(.1);function o(t){for(var i,o=0,s=e.length;o<s;++o)(i=e[o]).vx+=(r[o]-i.x)*n[o]*t}function s(){if(e){var o,s=e.length;for(n=new Array(s),r=new Array(s),o=0;o<s;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=V2(null==t?0:+t)),o.initialize=function(t){e=t,s()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:V2(+t),s(),o):i},o.x=function(e){return arguments.length?(t="function"==typeof e?e:V2(+e),s(),o):t},o},y:function(t){var e,n,r,i=V2(.1);function o(t){for(var i,o=0,s=e.length;o<s;++o)(i=e[o]).vy+=(r[o]-i.y)*n[o]*t}function s(){if(e){var o,s=e.length;for(n=new Array(s),r=new Array(s),o=0;o<s;++o)n[o]=isNaN(r[o]=+t(e[o],o,e))?0:+i(e[o],o,e)}}return"function"!=typeof t&&(t=V2(null==t?0:+t)),o.initialize=function(t){e=t,s()},o.strength=function(t){return arguments.length?(i="function"==typeof t?t:V2(+t),s(),o):i},o.y=function(e){return arguments.length?(t="function"==typeof e?e:V2(+e),s(),o):t},o}},t3="forces",e3=["alpha","alphaMin","alphaTarget","velocityDecay","forces"],n3=["static","iterations"],r3=["x","y","vx","vy"];function i3(t){dP.call(this,null,t)}function o3(t,e,n,r){var i,o,s,a,l=kF(e.forces);for(i=0,o=e3.length;i<o;++i)(s=e3[i])!==t3&&e.modified(s)&&t[s](e[s]);for(i=0,o=l.length;i<o;++i)a=t3+i,(s=n||e.modified(t3,i)?a3(l[i]):r&&s3(l[i],r)?t.force(a):null)&&t.force(a,s);for(o=t.numForces||0;i<o;++i)t.force(t3+i,null);return t.numForces=l.length,t}function s3(t,e){var n,r;for(n in t)if(EF(r=t[n])&&e.modified(I$(r)))return 1;return 0}function a3(t){var e,n;for(n in RF(Z2,t.force)||L$("Unrecognized force: "+t.force),e=Z2[t.force](),t)EF(e[n])&&l3(e[n],t[n],t);return e}function l3(t,e,n){t(EF(e)?t=>e(t,n):e)}function u3(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function c3(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=f3)):void 0===e&&(e=h3);for(var n,r,i,o,s,a=new m3(t),l=[a];n=l.pop();)if((i=e(n.data))&&(s=(i=Array.from(i)).length))for(n.children=i,o=s-1;o>=0;--o)l.push(r=i[o]=new m3(i[o])),r.parent=n,r.depth=n.depth+1;return a.eachBefore(p3)}function h3(t){return t.children}function f3(t){return Array.isArray(t)?t[1]:null}function d3(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function p3(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function m3(t){this.data=t,this.depth=this.height=0,this.parent=null}function g3(t){return null==t?null:y3(t)}function y3(t){if("function"!=typeof t)throw new Error;return t}function b3(){return 0}function v3(t){return function(){return t}}i3.Definition={type:"Force",metadata:{modifies:!0},params:[{name:"static",type:"boolean",default:!1},{name:"restart",type:"boolean",default:!1},{name:"iterations",type:"number",default:300},{name:"alpha",type:"number",default:1},{name:"alphaMin",type:"number",default:.001},{name:"alphaTarget",type:"number",default:0},{name:"velocityDecay",type:"number",default:.4},{name:"forces",type:"param",array:!0,params:[{key:{force:"center"},params:[{name:"x",type:"number",default:0},{name:"y",type:"number",default:0}]},{key:{force:"collide"},params:[{name:"radius",type:"number",expr:!0},{name:"strength",type:"number",default:.7},{name:"iterations",type:"number",default:1}]},{key:{force:"nbody"},params:[{name:"strength",type:"number",default:-30,expr:!0},{name:"theta",type:"number",default:.9},{name:"distanceMin",type:"number",default:1},{name:"distanceMax",type:"number"}]},{key:{force:"link"},params:[{name:"links",type:"data"},{name:"id",type:"field"},{name:"distance",type:"number",default:30,expr:!0},{name:"strength",type:"number",expr:!0},{name:"iterations",type:"number",default:1}]},{key:{force:"x"},params:[{name:"strength",type:"number",default:.1},{name:"x",type:"field"}]},{key:{force:"y"},params:[{name:"strength",type:"number",default:.1},{name:"y",type:"field"}]}]},{name:"as",type:"string",array:!0,modify:!1,default:r3}]},UF(i3,dP,{transform(t,e){var n,r,i=this.value,o=e.changed(e.ADD_REM),s=t.modified(e3),a=t.iterations||300;if(i?(o&&(e.modifies("index"),i.nodes(e.source)),(s||e.changed(e.MOD))&&o3(i,t,0,e)):(this.value=i=function(t,e){const n=function(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),o=0,s=.6,a=new Map,l=_C(h),u=aC("tick","end"),c=function(){let t=1;return()=>(t=(1664525*t+1013904223)%G2)/G2}();function h(){f(),u.call("tick",e),n<r&&(l.stop(),u.call("end",e))}function f(r){var l,u,c=t.length;void 0===r&&(r=1);for(var h=0;h<r;++h)for(n+=(o-n)*i,a.forEach((function(t){t(n)})),l=0;l<c;++l)null==(u=t[l]).fx?u.x+=u.vx*=s:(u.x=u.fx,u.vx=0),null==u.fy?u.y+=u.vy*=s:(u.y=u.fy,u.vy=0);return e}function d(){for(var e,n=0,r=t.length;n<r;++n){if((e=t[n]).index=n,null!=e.fx&&(e.x=e.fx),null!=e.fy&&(e.y=e.fy),isNaN(e.x)||isNaN(e.y)){var i=10*Math.sqrt(.5+n),o=n*J2;e.x=i*Math.cos(o),e.y=i*Math.sin(o)}(isNaN(e.vx)||isNaN(e.vy))&&(e.vx=e.vy=0)}}function p(e){return e.initialize&&e.initialize(t,c),e}return null==t&&(t=[]),d(),e={tick:f,restart:function(){return l.restart(h),e},stop:function(){return l.stop(),e},nodes:function(n){return arguments.length?(t=n,d(),a.forEach(p),e):t},alpha:function(t){return arguments.length?(n=+t,e):n},alphaMin:function(t){return arguments.length?(r=+t,e):r},alphaDecay:function(t){return arguments.length?(i=+t,e):+i},alphaTarget:function(t){return arguments.length?(o=+t,e):o},velocityDecay:function(t){return arguments.length?(s=1-t,e):1-s},randomSource:function(t){return arguments.length?(c=t,a.forEach(p),e):c},force:function(t,n){return arguments.length>1?(null==n?a.delete(t):a.set(t,p(n)),e):a.get(t)},find:function(e,n,r){var i,o,s,a,l,u=0,c=t.length;for(null==r?r=1/0:r*=r,u=0;u<c;++u)(s=(i=e-(a=t[u]).x)*i+(o=n-a.y)*o)<r&&(l=a,r=s);return l},on:function(t,n){return arguments.length>1?(u.on(t,n),e):u.on(t)}}}(t),r=n.stop,i=n.restart;let o=!1;return n.stopped=()=>o,n.restart=()=>(o=!1,i()),n.stop=()=>(o=!0,r()),o3(n,e,!0).on("end",(()=>o=!0))}(e.source,t),i.on("tick",(n=e.dataflow,r=this,()=>n.touch(r).run())),t.static||(o=!0,i.tick()),e.modifies("index")),s||o||t.modified(n3)||e.changed()&&t.restart)if(i.alpha(Math.max(i.alpha(),t.alpha||1)).alphaDecay(1-Math.pow(i.alphaMin(),1/a)),t.static)for(i.stop();--a>=0;)i.tick();else if(i.stopped()&&i.restart(),!o)return e.StopPropagation;return this.finish(t,e)},finish(t,e){const n=e.dataflow;for(let t,e=this._argops,a=0,l=e.length;a<l;++a)if(t=e[a],t.name===t3&&"link"===t.op._argval.force)for(var r,i=t.op._argops,o=0,s=i.length;o<s;++o)if("links"===i[o].name&&(r=i[o].op.source)){n.pulse(r,n.changeset().reflow());break}return e.reflow(t.modified()).modifies(r3)}}),m3.prototype=c3.prototype={constructor:m3,count:function(){return this.eachAfter(u3)},each:function(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this},eachAfter:function(t,e){for(var n,r,i,o=this,s=[o],a=[],l=-1;o=s.pop();)if(a.push(o),n=o.children)for(r=0,i=n.length;r<i;++r)s.push(n[r]);for(;o=a.pop();)t.call(e,o,++l,this);return this},eachBefore:function(t,e){for(var n,r,i=this,o=[i],s=-1;i=o.pop();)if(t.call(e,i,++s,this),n=i.children)for(r=n.length-1;r>=0;--r)o.push(n[r]);return this},find:function(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r},sum:function(t){return this.eachAfter((function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n}))},sort:function(t){return this.eachBefore((function(e){e.children&&e.children.sort(t)}))},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var t=[];return this.eachBefore((function(e){e.children||t.push(e)})),t},links:function(){var t=this,e=[];return t.each((function(n){n!==t&&e.push({source:n.parent,target:n})})),e},copy:function(){return c3(this).eachBefore(d3)},[Symbol.iterator]:function*(){var t,e,n,r,i=this,o=[i];do{for(t=o.reverse(),o=[];i=t.pop();)if(yield i,e=i.children)for(n=0,r=e.length;n<r;++n)o.push(e[n])}while(o.length)}};const w3=4294967296;function x3(t,e){var n,r;if(S3(e,t))return[e];for(n=0;n<t.length;++n)if(_3(e,t[n])&&S3(A3(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(_3(A3(t[n],t[r]),e)&&_3(A3(t[n],e),t[r])&&_3(A3(t[r],e),t[n])&&S3(C3(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function _3(t,e){var n=t.r-e.r,r=e.x-t.x,i=e.y-t.y;return n<0||n*n<r*r+i*i}function k3(t,e){var n=t.r-e.r+1e-9*Math.max(t.r,e.r,1),r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function S3(t,e){for(var n=0;n<e.length;++n)if(!k3(t,e[n]))return!1;return!0}function E3(t){switch(t.length){case 1:return{x:(e=t[0]).x,y:e.y,r:e.r};case 2:return A3(t[0],t[1]);case 3:return C3(t[0],t[1],t[2])}var e}function A3(t,e){var n=t.x,r=t.y,i=t.r,o=e.x,s=e.y,a=e.r,l=o-n,u=s-r,c=a-i,h=Math.sqrt(l*l+u*u);return{x:(n+o+l/h*c)/2,y:(r+s+u/h*c)/2,r:(h+i+a)/2}}function C3(t,e,n){var r=t.x,i=t.y,o=t.r,s=e.x,a=e.y,l=e.r,u=n.x,c=n.y,h=n.r,f=r-s,d=r-u,p=i-a,m=i-c,g=l-o,y=h-o,b=r*r+i*i-o*o,v=b-s*s-a*a+l*l,w=b-u*u-c*c+h*h,x=d*p-f*m,_=(p*w-m*v)/(2*x)-r,k=(m*g-p*y)/x,S=(d*v-f*w)/(2*x)-i,E=(f*y-d*g)/x,A=k*k+E*E-1,C=2*(o+_*k+S*E),D=_*_+S*S-o*o,M=-(Math.abs(A)>1e-6?(C+Math.sqrt(C*C-4*A*D))/(2*A):D/C);return{x:r+_+k*M,y:i+S+E*M,r:M}}function D3(t,e,n){var r,i,o,s,a=t.x-e.x,l=t.y-e.y,u=a*a+l*l;u?(i=e.r+n.r,i*=i,s=t.r+n.r,i>(s*=s)?(r=(u+s-i)/(2*u),o=Math.sqrt(Math.max(0,s/u-r*r)),n.x=t.x-r*a-o*l,n.y=t.y-r*l+o*a):(r=(u+i-s)/(2*u),o=Math.sqrt(Math.max(0,i/u-r*r)),n.x=e.x+r*a-o*l,n.y=e.y+r*l+o*a)):(n.x=e.x+n.r,n.y=e.y)}function M3(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function O3(t){var e=t._,n=t.next._,r=e.r+n.r,i=(e.x*n.r+n.x*e.r)/r,o=(e.y*n.r+n.y*e.r)/r;return i*i+o*o}function T3(t){this._=t,this.next=null,this.previous=null}function I3(t,e){if(!(o=(t=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(t)).length))return 0;var n,r,i,o,s,a,l,u,c,h,f;if((n=t[0]).x=0,n.y=0,!(o>1))return n.r;if(r=t[1],n.x=-r.r,r.x=n.r,r.y=0,!(o>2))return n.r+r.r;D3(r,n,i=t[2]),n=new T3(n),r=new T3(r),i=new T3(i),n.next=i.previous=r,r.next=n.previous=i,i.next=r.previous=n;t:for(l=3;l<o;++l){D3(n._,r._,i=t[l]),i=new T3(i),u=r.next,c=n.previous,h=r._.r,f=n._.r;do{if(h<=f){if(M3(u._,i._)){r=u,n.next=r,r.previous=n,--l;continue t}h+=u._.r,u=u.next}else{if(M3(c._,i._)){(n=c).next=r,r.previous=n,--l;continue t}f+=c._.r,c=c.previous}}while(u!==c.next);for(i.previous=n,i.next=r,n.next=r.previous=r=i,s=O3(n);(i=i.next)!==r;)(a=O3(i))<s&&(n=i,s=a);r=n.next}for(n=[r._],i=r;(i=i.next)!==r;)n.push(i._);for(i=function(t,e){for(var n,r,i=0,o=(t=function(t,e){let n,r,i=t.length;for(;i;)r=e()*i--|0,n=t[i],t[i]=t[r],t[r]=n;return t}(Array.from(t),e)).length,s=[];i<o;)n=t[i],r&&k3(r,n)?++i:(r=E3(s=x3(s,n)),i=0);return r}(n,e),l=0;l<o;++l)(n=t[l]).x-=i.x,n.y-=i.y;return i.r}function N3(t){return Math.sqrt(t.value)}function $3(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function F3(t,e,n){return function(r){if(i=r.children){var i,o,s,a=i.length,l=t(r)*e||0;if(l)for(o=0;o<a;++o)i[o].r+=l;if(s=I3(i,n),l)for(o=0;o<a;++o)i[o].r-=l;r.r=s+l}}}function L3(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function B3(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function R3(t,e,n,r,i){for(var o,s=t.children,a=-1,l=s.length,u=t.value&&(r-e)/t.value;++a<l;)(o=s[a]).y0=n,o.y1=i,o.x0=e,o.x1=e+=o.value*u}var P3={depth:-1},z3={},j3={};function U3(t){return t.id}function V3(t){return t.parentId}function q3(){var t,e=U3,n=V3;function r(r){var i,o,s,a,l,u,c,h,f=Array.from(r),d=e,p=n,m=new Map;if(null!=t){const e=f.map(((e,n)=>function(t){let e=(t=`${t}`).length;return H3(t,e-1)&&!H3(t,e-2)&&(t=t.slice(0,-1)),"/"===t[0]?t:`/${t}`}(t(e,n,r)))),n=e.map(W3),i=new Set(e).add("");for(const t of n)i.has(t)||(i.add(t),e.push(t),n.push(W3(t)),f.push(j3));d=(t,n)=>e[n],p=(t,e)=>n[e]}for(s=0,i=f.length;s<i;++s)o=f[s],u=f[s]=new m3(o),null!=(c=d(o,s,r))&&(c+="")&&(h=u.id=c,m.set(h,m.has(h)?z3:u)),null!=(c=p(o,s,r))&&(c+="")&&(u.parent=c);for(s=0;s<i;++s)if(c=(u=f[s]).parent){if(!(l=m.get(c)))throw new Error("missing: "+c);if(l===z3)throw new Error("ambiguous: "+c);l.children?l.children.push(u):l.children=[u],u.parent=l}else{if(a)throw new Error("multiple roots");a=u}if(!a)throw new Error("no root");if(null!=t){for(;a.data===j3&&1===a.children.length;)a=a.children[0],--i;for(let t=f.length-1;t>=0&&(u=f[t]).data===j3;--t)u.data=null}if(a.parent=P3,a.eachBefore((function(t){t.depth=t.parent.depth+1,--i})).eachBefore(p3),a.parent=null,i>0)throw new Error("cycle");return a}return r.id=function(t){return arguments.length?(e=g3(t),r):e},r.parentId=function(t){return arguments.length?(n=g3(t),r):n},r.path=function(e){return arguments.length?(t=g3(e),r):t},r}function W3(t){let e=t.length;if(e<2)return"";for(;--e>1&&!H3(t,e););return t.slice(0,e)}function H3(t,e){if("/"===t[e]){let n=0;for(;e>0&&"\\"===t[--e];)++n;if(!(1&n))return!0}return!1}function G3(t,e){return t.parent===e.parent?1:2}function Y3(t){var e=t.children;return e?e[0]:t.t}function X3(t){var e=t.children;return e?e[e.length-1]:t.t}function J3(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function K3(t,e,n){return t.a.parent===e.parent?t.a:n}function Q3(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function Z3(t,e){return t.parent===e.parent?1:2}function t4(t,e){return t+e.x}function e4(t,e){return Math.max(t,e.y)}function n4(t,e,n,r,i){for(var o,s=t.children,a=-1,l=s.length,u=t.value&&(i-n)/t.value;++a<l;)(o=s[a]).x0=e,o.x1=r,o.y0=n,o.y1=n+=o.value*u}Q3.prototype=Object.create(m3.prototype);var r4=(1+Math.sqrt(5))/2;function i4(t,e,n,r,i,o){for(var s,a,l,u,c,h,f,d,p,m,g,y=[],b=e.children,v=0,w=0,x=b.length,_=e.value;v<x;){l=i-n,u=o-r;do{c=b[w++].value}while(!c&&w<x);for(h=f=c,g=c*c*(m=Math.max(u/l,l/u)/(_*t)),p=Math.max(f/g,g/h);w<x;++w){if(c+=a=b[w].value,a<h&&(h=a),a>f&&(f=a),g=c*c*m,(d=Math.max(f/g,g/h))>p){c-=a;break}p=d}y.push(s={value:c,dice:l<u,children:b.slice(v,w)}),s.dice?R3(s,n,r,i,_?r+=u*c/_:o):n4(s,n,r,_?n+=l*c/_:i,o),_-=c,v=w}return y}const o4=function t(e){function n(t,n,r,i,o){i4(e,t,n,r,i,o)}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(r4),s4=function t(e){function n(t,n,r,i,o){if((s=t._squarify)&&s.ratio===e)for(var s,a,l,u,c,h=-1,f=s.length,d=t.value;++h<f;){for(l=(a=s[h]).children,u=a.value=0,c=l.length;u<c;++u)a.value+=l[u].value;a.dice?R3(a,n,r,i,d?r+=(o-r)*a.value/d:o):n4(a,n,r,d?n+=(i-n)*a.value/d:i,o),d-=a.value}else t._squarify=s=i4(e,t,n,r,i,o),s.ratio=e}return n.ratio=function(e){return t((e=+e)>1?e:1)},n}(r4);function a4(t,e,n){const r={};return t.each((t=>{const i=t.data;n(i)&&(r[e(i)]=t)})),t.lookup=r,t}function l4(t){dP.call(this,null,t)}l4.Definition={type:"Nest",metadata:{treesource:!0,changes:!0},params:[{name:"keys",type:"field",array:!0},{name:"generate",type:"boolean"}]};const u4=t=>t.values;function c4(){const t=[],e={entries:t=>r(n(t,0),0),key:n=>(t.push(n),e)};function n(e,r){if(r>=t.length)return e;const i=e.length,o=t[r++],s={},a={};let l,u,c,h=-1;for(;++h<i;)l=o(u=e[h])+"",(c=s[l])?c.push(u):s[l]=[u];for(l in s)a[l]=n(s[l],r);return a}function r(e,n){if(++n>t.length)return e;const i=[];for(const t in e)i.push({key:t,values:r(e[t],n)});return i}return e}function h4(t){dP.call(this,null,t)}UF(l4,dP,{transform(t,e){e.source||L$("Nest transform requires an upstream data source.");var n=t.generate,r=t.modified(),i=e.clone(),o=this.value;return(!o||r||e.changed())&&(o&&o.each((t=>{t.children&&$R(t.data)&&i.rem.push(t.data)})),this.value=o=c3({values:kF(t.keys).reduce(((t,e)=>(t.key(e),t)),c4()).entries(i.source)},u4),n&&o.each((t=>{t.children&&(t=BR(t.data),i.add.push(t),i.source.push(t))})),a4(o,FR,FR)),i.source.root=o,i}});const f4=(t,e)=>t.parent===e.parent?1:2;UF(h4,dP,{transform(t,e){e.source&&e.source.root||L$(this.constructor.name+" transform requires a backing tree data source.");const n=this.layout(t.method),r=this.fields,i=e.source.root,o=t.as||r;t.field?i.sum(t.field):i.count(),t.sort&&i.sort(jR(t.sort,(t=>t.data))),function(t,e,n){for(let r,i=0,o=e.length;i<o;++i)r=e[i],r in n&&t[r](n[r])}(n,this.params,t),n.separation&&n.separation(!1!==t.separation?f4:U$);try{this.value=n(i)}catch(t){L$(t)}return i.each((t=>function(t,e,n){const r=t.data,i=e.length-1;for(let o=0;o<i;++o)r[n[o]]=t[e[o]];r[n[i]]=t.children?t.children.length:0}(t,r,o))),e.reflow(t.modified()).modifies(o).modifies("leaf")}});const d4=["x","y","r","depth","children"];function p4(t){h4.call(this,t)}p4.Definition={type:"Pack",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"radius",type:"field",default:null},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:d4.length,default:d4}]},UF(p4,h4,{layout:function(){var t=null,e=1,n=1,r=b3;function i(i){const o=function(){let t=1;return()=>(t=(1664525*t+1013904223)%w3)/w3}();return i.x=e/2,i.y=n/2,t?i.eachBefore($3(t)).eachAfter(F3(r,.5,o)).eachBefore(L3(1)):i.eachBefore($3(N3)).eachAfter(F3(b3,1,o)).eachAfter(F3(r,i.r/Math.min(e,n),o)).eachBefore(L3(Math.min(e,n)/(2*i.r))),i}return i.radius=function(e){return arguments.length?(t=g3(e),i):t},i.size=function(t){return arguments.length?(e=+t[0],n=+t[1],i):[e,n]},i.padding=function(t){return arguments.length?(r="function"==typeof t?t:v3(+t),i):r},i},params:["radius","size","padding"],fields:d4});const m4=["x0","y0","x1","y1","depth","children"];function g4(t){h4.call(this,t)}function y4(t){dP.call(this,null,t)}g4.Definition={type:"Partition",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"padding",type:"number",default:0},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:m4.length,default:m4}]},UF(g4,h4,{layout:function(){var t=1,e=1,n=0,r=!1;function i(i){var o=i.height+1;return i.x0=i.y0=n,i.x1=t,i.y1=e/o,i.eachBefore(function(t,e){return function(r){r.children&&R3(r,r.x0,t*(r.depth+1)/e,r.x1,t*(r.depth+2)/e);var i=r.x0,o=r.y0,s=r.x1-n,a=r.y1-n;s<i&&(i=s=(i+s)/2),a<o&&(o=a=(o+a)/2),r.x0=i,r.y0=o,r.x1=s,r.y1=a}}(e,o)),r&&i.eachBefore(B3),i}return i.round=function(t){return arguments.length?(r=!!t,i):r},i.size=function(n){return arguments.length?(t=+n[0],e=+n[1],i):[t,e]},i.padding=function(t){return arguments.length?(n=+t,i):n},i},params:["size","round","padding"],fields:m4}),y4.Definition={type:"Stratify",metadata:{treesource:!0},params:[{name:"key",type:"field",required:!0},{name:"parentKey",type:"field",required:!0}]},UF(y4,dP,{transform(t,e){e.source||L$("Stratify transform requires an upstream data source.");let n=this.value;const r=t.modified(),i=e.fork(e.ALL).materialize(e.SOURCE),o=!n||r||e.changed(e.ADD_REM)||e.modified(t.key.fields)||e.modified(t.parentKey.fields);return i.source=i.source.slice(),o&&(n=i.source.length?a4(q3().id(t.key).parentId(t.parentKey)(i.source),t.key,V$):a4(q3()([{}]),t.key,t.key)),i.source.root=this.value=n,i}});const b4={tidy:function(){var t=G3,e=1,n=1,r=null;function i(i){var l=function(t){for(var e,n,r,i,o,s=new Q3(t,0),a=[s];e=a.pop();)if(r=e._.children)for(e.children=new Array(o=r.length),i=o-1;i>=0;--i)a.push(n=e.children[i]=new Q3(r[i],i)),n.parent=e;return(s.parent=new Q3(null,0)).children=[s],s}(i);if(l.eachAfter(o),l.parent.m=-l.z,l.eachBefore(s),r)i.eachBefore(a);else{var u=i,c=i,h=i;i.eachBefore((function(t){t.x<u.x&&(u=t),t.x>c.x&&(c=t),t.depth>h.depth&&(h=t)}));var f=u===c?1:t(u,c)/2,d=f-u.x,p=e/(c.x+f+d),m=n/(h.depth||1);i.eachBefore((function(t){t.x=(t.x+d)*p,t.y=t.depth*m}))}return i}function o(e){var n=e.children,r=e.parent.children,i=e.i?r[e.i-1]:null;if(n){!function(t){for(var e,n=0,r=0,i=t.children,o=i.length;--o>=0;)(e=i[o]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}(e);var o=(n[0].z+n[n.length-1].z)/2;i?(e.z=i.z+t(e._,i._),e.m=e.z-o):e.z=o}else i&&(e.z=i.z+t(e._,i._));e.parent.A=function(e,n,r){if(n){for(var i,o=e,s=e,a=n,l=o.parent.children[0],u=o.m,c=s.m,h=a.m,f=l.m;a=X3(a),o=Y3(o),a&&o;)l=Y3(l),(s=X3(s)).a=e,(i=a.z+h-o.z-u+t(a._,o._))>0&&(J3(K3(a,e,r),e,i),u+=i,c+=i),h+=a.m,u+=o.m,f+=l.m,c+=s.m;a&&!X3(s)&&(s.t=a,s.m+=h-c),o&&!Y3(l)&&(l.t=o,l.m+=u-f,r=e)}return r}(e,i,e.parent.A||r[0])}function s(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function a(t){t.x*=e,t.y=t.depth*n}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i},cluster:function(){var t=Z3,e=1,n=1,r=!1;function i(i){var o,s=0;i.eachAfter((function(e){var n=e.children;n?(e.x=function(t){return t.reduce(t4,0)/t.length}(n),e.y=function(t){return 1+t.reduce(e4,0)}(n)):(e.x=o?s+=t(e,o):0,e.y=0,o=e)}));var a=function(t){for(var e;e=t.children;)t=e[0];return t}(i),l=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(i),u=a.x-t(a,l)/2,c=l.x+t(l,a)/2;return i.eachAfter(r?function(t){t.x=(t.x-i.x)*e,t.y=(i.y-t.y)*n}:function(t){t.x=(t.x-u)/(c-u)*e,t.y=(1-(i.y?t.y/i.y:1))*n})}return i.separation=function(e){return arguments.length?(t=e,i):t},i.size=function(t){return arguments.length?(r=!1,e=+t[0],n=+t[1],i):r?null:[e,n]},i.nodeSize=function(t){return arguments.length?(r=!0,e=+t[0],n=+t[1],i):r?[e,n]:null},i}},v4=["x","y","depth","children"];function w4(t){h4.call(this,t)}function x4(t){dP.call(this,[],t)}w4.Definition={type:"Tree",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"tidy",values:["tidy","cluster"]},{name:"size",type:"number",array:!0,length:2},{name:"nodeSize",type:"number",array:!0,length:2},{name:"separation",type:"boolean",default:!0},{name:"as",type:"string",array:!0,length:v4.length,default:v4}]},UF(w4,h4,{layout(t){const e=t||"tidy";if(RF(b4,e))return b4[e]();L$("Unrecognized Tree layout method: "+e)},params:["size","nodeSize"],fields:v4}),x4.Definition={type:"TreeLinks",metadata:{tree:!0,generates:!0,changes:!0},params:[]},UF(x4,dP,{transform(t,e){const n=this.value,r=e.source&&e.source.root,i=e.fork(e.NO_SOURCE),o={};return r||L$("TreeLinks transform requires a tree data source."),e.changed(e.ADD_REM)?(i.rem=n,e.visit(e.SOURCE,(t=>o[FR(t)]=1)),r.each((t=>{const e=t.data,n=t.parent&&t.parent.data;n&&o[FR(e)]&&o[FR(n)]&&i.add.push(BR({source:n,target:e}))})),this.value=i.add):e.changed(e.MOD)&&(e.visit(e.MOD,(t=>o[FR(t)]=1)),n.forEach((t=>{(o[FR(t.source)]||o[FR(t.target)])&&i.mod.push(t)}))),i}});const _4={binary:function(t,e,n,r,i){var o,s,a=t.children,l=a.length,u=new Array(l+1);for(u[0]=s=o=0;o<l;++o)u[o+1]=s+=a[o].value;!function t(e,n,r,i,o,s,l){if(e>=n-1){var c=a[e];return c.x0=i,c.y0=o,c.x1=s,void(c.y1=l)}for(var h=u[e],f=r/2+h,d=e+1,p=n-1;d<p;){var m=d+p>>>1;u[m]<f?d=m+1:p=m}f-u[d-1]<u[d]-f&&e+1<d&&--d;var g=u[d]-h,y=r-g;if(s-i>l-o){var b=r?(i*y+s*g)/r:s;t(e,d,g,i,o,b,l),t(d,n,y,b,o,s,l)}else{var v=r?(o*y+l*g)/r:l;t(e,d,g,i,o,s,v),t(d,n,y,i,v,s,l)}}(0,l,t.value,e,n,r,i)},dice:R3,slice:n4,slicedice:function(t,e,n,r,i){(1&t.depth?n4:R3)(t,e,n,r,i)},squarify:o4,resquarify:s4},k4=["x0","y0","x1","y1","depth","children"];function S4(t){h4.call(this,t)}S4.Definition={type:"Treemap",metadata:{tree:!0,modifies:!0},params:[{name:"field",type:"field"},{name:"sort",type:"compare"},{name:"method",type:"enum",default:"squarify",values:["squarify","resquarify","binary","dice","slice","slicedice"]},{name:"padding",type:"number",default:0},{name:"paddingInner",type:"number",default:0},{name:"paddingOuter",type:"number",default:0},{name:"paddingTop",type:"number",default:0},{name:"paddingRight",type:"number",default:0},{name:"paddingBottom",type:"number",default:0},{name:"paddingLeft",type:"number",default:0},{name:"ratio",type:"number",default:1.618033988749895},{name:"round",type:"boolean",default:!1},{name:"size",type:"number",array:!0,length:2},{name:"as",type:"string",array:!0,length:k4.length,default:k4}]},UF(S4,h4,{layout(){const t=function(){var t=o4,e=!1,n=1,r=1,i=[0],o=b3,s=b3,a=b3,l=b3,u=b3;function c(t){return t.x0=t.y0=0,t.x1=n,t.y1=r,t.eachBefore(h),i=[0],e&&t.eachBefore(B3),t}function h(e){var n=i[e.depth],r=e.x0+n,c=e.y0+n,h=e.x1-n,f=e.y1-n;h<r&&(r=h=(r+h)/2),f<c&&(c=f=(c+f)/2),e.x0=r,e.y0=c,e.x1=h,e.y1=f,e.children&&(n=i[e.depth+1]=o(e)/2,r+=u(e)-n,c+=s(e)-n,(h-=a(e)-n)<r&&(r=h=(r+h)/2),(f-=l(e)-n)<c&&(c=f=(c+f)/2),t(e,r,c,h,f))}return c.round=function(t){return arguments.length?(e=!!t,c):e},c.size=function(t){return arguments.length?(n=+t[0],r=+t[1],c):[n,r]},c.tile=function(e){return arguments.length?(t=y3(e),c):t},c.padding=function(t){return arguments.length?c.paddingInner(t).paddingOuter(t):c.paddingInner()},c.paddingInner=function(t){return arguments.length?(o="function"==typeof t?t:v3(+t),c):o},c.paddingOuter=function(t){return arguments.length?c.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):c.paddingTop()},c.paddingTop=function(t){return arguments.length?(s="function"==typeof t?t:v3(+t),c):s},c.paddingRight=function(t){return arguments.length?(a="function"==typeof t?t:v3(+t),c):a},c.paddingBottom=function(t){return arguments.length?(l="function"==typeof t?t:v3(+t),c):l},c.paddingLeft=function(t){return arguments.length?(u="function"==typeof t?t:v3(+t),c):u},c}();return t.ratio=e=>{const n=t.tile();n.ratio&&t.tile(n.ratio(e))},t.method=e=>{RF(_4,e)?t.tile(_4[e]):L$("Unrecognized Treemap layout method: "+e)},t},params:["method","ratio","size","round","padding","paddingInner","paddingOuter","paddingTop","paddingRight","paddingBottom","paddingLeft"],fields:k4});const E4=4278190080;function A4(t,e,n){return new Uint32Array(t.getImageData(0,0,e,n).data.buffer)}function C4(t,e,n){if(!e.length)return;const r=e[0].mark.marktype;"group"===r?e.forEach((e=>{e.items.forEach((e=>C4(t,e.items,n)))})):lX[r].draw(t,{items:n?e.map(D4):e})}function D4(t){const e=PR(t,{});return e.stroke&&0!==e.strokeOpacity||e.fill&&0!==e.fillOpacity?{...e,strokeOpacity:1,stroke:"#000",fillOpacity:0}:e}const M4=5,O4=31,T4=32,I4=new Uint32Array(T4+1),N4=new Uint32Array(T4+1);N4[0]=0,I4[0]=~N4[0];for(let t=1;t<=T4;++t)N4[t]=N4[t-1]<<1|1,I4[t]=~N4[t];function $4(t,e,n,r,i,o){let s=n/2;return t-s<0||t+s>i||e-(s=r/2)<0||e+s>o}function F4(t,e,n,r,i,o,s,a){const l=i*o/(2*r),u=t(e-l),c=t(e+l),h=t(n-(o/=2)),f=t(n+o);return s.outOfBounds(u,h,c,f)||s.getRange(u,h,c,f)||a&&a.getRange(u,h,c,f)}const L4=[-1,-1,1,1],B4=[-1,1,-1,1],R4=["right","center","left"],P4=["bottom","middle","top"];function z4(t,e,n,r,i,o,s,a,l,u,c,h){return!(i.outOfBounds(t,n,e,r)||(h&&o||i).getRange(t,n,e,r))}const j4={"top-left":0,top:1,"top-right":2,left:4,middle:5,right:6,"bottom-left":8,bottom:9,"bottom-right":10},U4={naive:function(t,e,n,r){const i=t.width,o=t.height;return function(t){const e=t.datum.datum.items[r].items,n=e.length,s=t.datum.fontSize,a=UY.width(t.datum,t.datum.text);let l,u,c,h,f,d,p,m=0;for(let r=0;r<n;++r)l=e[r].x,c=e[r].y,u=void 0===e[r].x2?l:e[r].x2,h=void 0===e[r].y2?c:e[r].y2,f=(l+u)/2,d=(c+h)/2,p=Math.abs(u-l+h-c),p>=m&&(m=p,t.x=f,t.y=d);return f=a/2,d=s/2,l=t.x-f,u=t.x+f,c=t.y-d,h=t.y+d,t.align="center",l<0&&u<=i?t.align="left":0<=l&&i<u&&(t.align="right"),t.baseline="middle",c<0&&h<=o?t.baseline="top":0<=c&&o<h&&(t.baseline="bottom"),!0}},"reduced-search":function(t,e,n,r){const i=t.width,o=t.height,s=e[0],a=e[1];function l(e,n,r,l,u){const c=t.invert(e),h=t.invert(n);let f,d=r,p=o;if(!$4(c,h,l,u,i,o)&&!F4(t,c,h,u,l,d,s,a)&&!F4(t,c,h,u,l,u,s,null)){for(;p-d>=1;)f=(d+p)/2,F4(t,c,h,u,l,f,s,a)?p=f:d=f;if(d>r)return[c,h,d,!0]}}return function(e){const a=e.datum.datum.items[r].items,u=a.length,c=e.datum.fontSize,h=UY.width(e.datum,e.datum.text);let f,d,p,m,g,y,b,v,w,x,_,k,S,E,A,C,D,M=n?c:0,O=!1,T=!1,I=0;for(let r=0;r<u;++r){for(f=a[r].x,p=a[r].y,d=void 0===a[r].x2?f:a[r].x2,m=void 0===a[r].y2?p:a[r].y2,f>d&&(D=f,f=d,d=D),p>m&&(D=p,p=m,m=D),w=t(f),_=t(d),x=~~((w+_)/2),k=t(p),E=t(m),S=~~((k+E)/2),b=x;b>=w;--b)for(v=S;v>=k;--v)C=l(b,v,M,h,c),C&&([e.x,e.y,M,O]=C);for(b=x;b<=_;++b)for(v=S;v<=E;++v)C=l(b,v,M,h,c),C&&([e.x,e.y,M,O]=C);O||n||(A=Math.abs(d-f+m-p),g=(f+d)/2,y=(p+m)/2,A>=I&&!$4(g,y,h,c,i,o)&&!F4(t,g,y,c,h,c,s,null)&&(I=A,e.x=g,e.y=y,T=!0))}return!(!O&&!T||(g=h/2,y=c/2,s.setRange(t(e.x-g),t(e.y-y),t(e.x+g),t(e.y+y)),e.align="center",e.baseline="middle",0))}},floodfill:function(t,e,n,r){const i=t.width,o=t.height,s=e[0],a=e[1],l=t.bitmap();return function(e){const u=e.datum.datum.items[r].items,c=u.length,h=e.datum.fontSize,f=UY.width(e.datum,e.datum.text),d=[];let p,m,g,y,b,v,w,x,_,k,S,E,A=n?h:0,C=!1,D=!1,M=0;for(let r=0;r<c;++r){for(p=u[r].x,g=u[r].y,m=void 0===u[r].x2?p:u[r].x2,y=void 0===u[r].y2?g:u[r].y2,d.push([t((p+m)/2),t((g+y)/2)]);d.length;)if([w,x]=d.pop(),!(s.get(w,x)||a.get(w,x)||l.get(w,x))){l.set(w,x);for(let t=0;t<4;++t)b=w+L4[t],v=x+B4[t],l.outOfBounds(b,v,b,v)||d.push([b,v]);if(b=t.invert(w),v=t.invert(x),_=A,k=o,!$4(b,v,f,h,i,o)&&!F4(t,b,v,h,f,_,s,a)&&!F4(t,b,v,h,f,h,s,null)){for(;k-_>=1;)S=(_+k)/2,F4(t,b,v,h,f,S,s,a)?k=S:_=S;_>A&&(e.x=b,e.y=v,A=_,C=!0)}}C||n||(E=Math.abs(m-p+y-g),b=(p+m)/2,v=(g+y)/2,E>=M&&!$4(b,v,f,h,i,o)&&!F4(t,b,v,h,f,h,s,null)&&(M=E,e.x=b,e.y=v,D=!0))}return!(!C&&!D||(b=f/2,v=h/2,s.setRange(t(e.x-b),t(e.y-v),t(e.x+b),t(e.y+v)),e.align="center",e.baseline="middle",0))}}};function V4(t,e,n,r,i,o,s,a,l,u,c){if(!t.length)return t;const h=Math.max(r.length,i.length),f=function(t,e){const n=new Float64Array(e),r=t.length;for(let e=0;e<r;++e)n[e]=t[e]||0;for(let t=r;t<e;++t)n[t]=n[r-1];return n}(r,h),d=function(t,e){const n=new Int8Array(e),r=t.length;for(let e=0;e<r;++e)n[e]|=j4[t[e]];for(let t=r;t<e;++t)n[t]=n[r-1];return n}(i,h),p=(w=t[0].datum)&&w.mark&&w.mark.marktype,m="group"===p&&t[0].datum.items[l].marktype,g="area"===m,y=function(t,e,n,r){const i=t=>[t.x,t.x,t.x,t.y,t.y,t.y];return t?"line"===t||"area"===t?t=>i(t.datum):"line"===e?t=>{const e=t.datum.items[r].items;return i(e.length?e["start"===n?0:e.length-1]:{x:NaN,y:NaN})}:t=>{const e=t.datum.bounds;return[e.x1,(e.x1+e.x2)/2,e.x2,e.y1,(e.y1+e.y2)/2,e.y2]}:i}(p,m,a,l),b=null===u||u===1/0,v=g&&"naive"===c;var w;let x=-1,_=-1;const k=t.map((t=>{const e=b?UY.width(t,t.text):void 0;return x=Math.max(x,e),_=Math.max(_,t.fontSize),{datum:t,opacity:0,x:void 0,y:void 0,align:void 0,baseline:void 0,boundary:y(t),textWidth:e}}));u=null===u||u===1/0?Math.max(x,_)+Math.max(...r):u;const S=function(t,e,n){const r=Math.max(1,Math.sqrt(t*e/1e6)),i=~~((t+2*n+r)/r),o=~~((e+2*n+r)/r),s=t=>~~((t+n)/r);return s.invert=t=>t*r-n,s.bitmap=()=>function(t,e){const n=new Uint32Array(~~((t*e+T4)/T4));function r(t,e){n[t]|=e}function i(t,e){n[t]&=e}return{array:n,get:(e,r)=>{const i=r*t+e;return n[i>>>M4]&1<<(i&O4)},set:(e,n)=>{const i=n*t+e;r(i>>>M4,1<<(i&O4))},clear:(e,n)=>{const r=n*t+e;i(r>>>M4,~(1<<(r&O4)))},getRange:(e,r,i,o)=>{let s,a,l,u,c=o;for(;c>=r;--c)if(s=c*t+e,a=c*t+i,l=s>>>M4,u=a>>>M4,l===u){if(n[l]&I4[s&O4]&N4[1+(a&O4)])return!0}else{if(n[l]&I4[s&O4])return!0;if(n[u]&N4[1+(a&O4)])return!0;for(let t=l+1;t<u;++t)if(n[t])return!0}return!1},setRange:(e,n,i,o)=>{let s,a,l,u,c;for(;n<=o;++n)if(s=n*t+e,a=n*t+i,l=s>>>M4,u=a>>>M4,l===u)r(l,I4[s&O4]&N4[1+(a&O4)]);else for(r(l,I4[s&O4]),r(u,N4[1+(a&O4)]),c=l+1;c<u;++c)r(c,4294967295)},clearRange:(e,n,r,o)=>{let s,a,l,u,c;for(;n<=o;++n)if(s=n*t+e,a=n*t+r,l=s>>>M4,u=a>>>M4,l===u)i(l,N4[s&O4]|I4[1+(a&O4)]);else for(i(l,N4[s&O4]),i(u,I4[1+(a&O4)]),c=l+1;c<u;++c)i(c,0)},outOfBounds:(n,r,i,o)=>n<0||r<0||o>=e||i>=t}}(i,o),s.ratio=r,s.padding=n,s.width=t,s.height=e,s}(e[0],e[1],u);let E;if(!v){n&&k.sort(((t,e)=>n(t.datum,e.datum)));let e=!1;for(let t=0;t<d.length&&!e;++t)e=5===d[t]||f[t]<0;const r=(p&&s||g)&&t.map((t=>t.datum));E=o.length||r?function(t,e,n,r,i){const o=t.width,s=t.height,a=r||i,l=aV(o,s).getContext("2d"),u=aV(o,s).getContext("2d"),c=a&&aV(o,s).getContext("2d");n.forEach((t=>C4(l,t,!1))),C4(u,e,!1),a&&C4(c,e,!0);const h=A4(l,o,s),f=A4(u,o,s),d=a&&A4(c,o,s),p=t.bitmap(),m=a&&t.bitmap();let g,y,b,v,w,x,_,k;for(y=0;y<s;++y)for(g=0;g<o;++g)w=y*o+g,x=h[w]&E4,k=f[w]&E4,_=a&&d[w]&E4,(x||_||k)&&(b=t(g),v=t(y),i||!x&&!k||p.set(b,v),a&&(x||_)&&m.set(b,v));return[p,m]}(S,r||[],o,e,g):function(t,e){const n=t.bitmap();return(e||[]).forEach((e=>n.set(t(e.boundary[0]),t(e.boundary[3])))),[n,void 0]}(S,s&&k)}const A=g?U4[c](S,E,s,l):function(t,e,n,r){const i=t.width,o=t.height,s=e[0],a=e[1],l=r.length;return function(e){const u=e.boundary,c=e.datum.fontSize;if(u[2]<0||u[5]<0||u[0]>i||u[3]>o)return!1;let h,f,d,p,m,g,y,b,v,w,x,_,k,S,E,A=e.textWidth??0;for(let i=0;i<l;++i){if(h=(3&n[i])-1,f=(n[i]>>>2&3)-1,d=0===h&&0===f||r[i]<0,p=h&&f?Math.SQRT1_2:1,m=r[i]<0?-1:1,g=u[1+h]+r[i]*h*p,x=u[4+f]+m*c*f/2+r[i]*f*p,b=x-c/2,v=x+c/2,_=t(g),S=t(b),E=t(v),!A){if(!z4(_,_,S,E,s,a,0,0,0,0,0,d))continue;A=UY.width(e.datum,e.datum.text)}if(w=g+m*A*h/2,g=w-A/2,y=w+A/2,_=t(g),k=t(y),z4(_,k,S,E,s,a,0,0,0,0,0,d))return e.x=h?h*m<0?y:g:w,e.y=f?f*m<0?v:b:x,e.align=R4[h*m+1],e.baseline=P4[f*m+1],s.setRange(_,S,k,E),!0}return!1}}(S,E,d,f);return k.forEach((t=>t.opacity=+A(t))),k}const q4=["x","y","opacity","align","baseline"],W4=["top-left","left","bottom-left","top","bottom","top-right","right","bottom-right"];function H4(t){dP.call(this,null,t)}function G4(t,e){var n,r,i,o,s,a,l=[],u=function(t){return t(o)};if(null==e)l.push(t);else for(n={},r=0,i=t.length;r<i;++r)o=t[r],(a=n[s=e.map(u)])||(n[s]=a=[],a.dims=s,l.push(a)),a.push(o);return l}function Y4(t){dP.call(this,null,t)}H4.Definition={type:"Label",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2,required:!0},{name:"sort",type:"compare"},{name:"anchor",type:"string",array:!0,default:W4},{name:"offset",type:"number",array:!0,default:[1]},{name:"padding",type:"number",default:0,null:!0},{name:"lineAnchor",type:"string",values:["start","end"],default:"end"},{name:"markIndex",type:"number",default:0},{name:"avoidBaseMark",type:"boolean",default:!0},{name:"avoidMarks",type:"data",array:!0},{name:"method",type:"string",default:"naive"},{name:"as",type:"string",array:!0,length:q4.length,default:q4}]},UF(H4,dP,{transform(t,e){const n=t.modified();if(!(n||e.changed(e.ADD_REM)||function(n){const r=t.sort;return EF(r)&&e.modified(r.fields)}()))return;t.size&&2===t.size.length||L$("Size parameter should be specified as a [width, height] array.");const r=t.as||q4;return V4(e.materialize(e.SOURCE).source||[],t.size,t.sort,kF(null==t.offset?1:t.offset),kF(t.anchor||W4),t.avoidMarks||[],!1!==t.avoidBaseMark,t.lineAnchor||"end",t.markIndex||0,void 0===t.padding?0:t.padding,t.method||"naive").forEach((t=>{const e=t.datum;e[r[0]]=t.x,e[r[1]]=t.y,e[r[2]]=t.opacity,e[r[3]]=t.align,e[r[4]]=t.baseline})),e.reflow(n).modifies(r)}}),Y4.Definition={type:"Loess",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"bandwidth",type:"number",default:.3},{name:"as",type:"string",array:!0}]},UF(Y4,dP,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=G4(e.materialize(e.SOURCE).source,t.groupby),i=(t.groupby||[]).map(T$),o=i.length,s=t.as||[T$(t.x),T$(t.y)],a=[];r.forEach((e=>{mz(e,t.x,t.y,t.bandwidth||.3).forEach((t=>{const n={};for(let t=0;t<o;++t)n[i[t]]=e.dims[t];n[s[0]]=t[0],n[s[1]]=t[1],a.push(BR(n))}))})),this.value&&(n.rem=this.value),this.value=n.add=n.source=a}return n}});const X4={constant:ez,linear:sz,log:az,exp:lz,pow:uz,quad:cz,poly:hz};function J4(t){dP.call(this,null,t)}J4.Definition={type:"Regression",metadata:{generates:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"groupby",type:"field",array:!0},{name:"method",type:"string",default:"linear",values:Object.keys(X4)},{name:"order",type:"number",default:3},{name:"extent",type:"number",array:!0,length:2},{name:"params",type:"boolean",default:!1},{name:"as",type:"string",array:!0}]},UF(J4,dP,{transform(t,e){const n=e.fork(e.NO_SOURCE|e.NO_FIELDS);if(!this.value||e.changed()||t.modified()){const r=G4(e.materialize(e.SOURCE).source,t.groupby),i=(t.groupby||[]).map(T$),o=t.method||"linear",s=null==t.order?3:t.order,a=((t,e)=>"poly"===t?e:"quad"===t?2:1)(o,s),l=t.as||[T$(t.x),T$(t.y)],u=X4[o],c=[];let h=t.extent;RF(X4,o)||L$("Invalid regression method: "+o),null!=h&&"log"===o&&h[0]<=0&&(e.dataflow.warn("Ignoring extent with values <= 0 for log regression."),h=null),r.forEach((n=>{if(n.length<=a)return void e.dataflow.warn("Skipping regression with more parameters than data points.");const r=u(n,t.x,t.y,s);if(t.params)return void c.push(BR({keys:n.dims,coef:r.coef,rSquared:r.rSquared}));const f=h||FF(n,t.x),d=t=>{const e={};for(let t=0;t<i.length;++t)e[i[t]]=n.dims[t];e[l[0]]=t[0],e[l[1]]=t[1],c.push(BR(e))};"linear"===o||"constant"===o?f.forEach((t=>d([t,r.predict(t)]))):vz(r.predict,f,25,200).forEach(d)})),this.value&&(n.rem=this.value),this.value=n.add=n.source=c}return n}});const K4=134217729;function Q4(t,e,n,r,i){let o,s,a,l,u=e[0],c=r[0],h=0,f=0;c>u==c>-u?(o=u,u=e[++h]):(o=c,c=r[++f]);let d=0;if(h<t&&f<n)for(c>u==c>-u?(s=u+o,a=o-(s-u),u=e[++h]):(s=c+o,a=o-(s-c),c=r[++f]),o=s,0!==a&&(i[d++]=a);h<t&&f<n;)c>u==c>-u?(s=o+u,l=s-o,a=o-(s-l)+(u-l),u=e[++h]):(s=o+c,l=s-o,a=o-(s-l)+(c-l),c=r[++f]),o=s,0!==a&&(i[d++]=a);for(;h<t;)s=o+u,l=s-o,a=o-(s-l)+(u-l),u=e[++h],o=s,0!==a&&(i[d++]=a);for(;f<n;)s=o+c,l=s-o,a=o-(s-l)+(c-l),c=r[++f],o=s,0!==a&&(i[d++]=a);return 0===o&&0!==d||(i[d++]=o),d}function Z4(t){return new Float64Array(t)}const t5=Z4(4),e5=Z4(8),n5=Z4(12),r5=Z4(16),i5=Z4(4);function o5(t,e,n,r,i,o){const s=(e-o)*(n-i),a=(t-i)*(r-o),l=s-a,u=Math.abs(s+a);return Math.abs(l)>=33306690738754716e-32*u?l:-function(t,e,n,r,i,o,s){let a,l,u,c,h,f,d,p,m,g,y,b,v,w,x,_,k,S;const E=t-i,A=n-i,C=e-o,D=r-o;w=E*D,f=K4*E,d=f-(f-E),p=E-d,f=K4*D,m=f-(f-D),g=D-m,x=p*g-(w-d*m-p*m-d*g),_=C*A,f=K4*C,d=f-(f-C),p=C-d,f=K4*A,m=f-(f-A),g=A-m,k=p*g-(_-d*m-p*m-d*g),y=x-k,h=x-y,t5[0]=x-(y+h)+(h-k),b=w+y,h=b-w,v=w-(b-h)+(y-h),y=v-_,h=v-y,t5[1]=v-(y+h)+(h-_),S=b+y,h=S-b,t5[2]=b-(S-h)+(y-h),t5[3]=S;let M=function(t,e){let n=e[0];for(let t=1;t<4;t++)n+=e[t];return n}(0,t5),O=22204460492503146e-32*s;if(M>=O||-M>=O)return M;if(h=t-E,a=t-(E+h)+(h-i),h=n-A,u=n-(A+h)+(h-i),h=e-C,l=e-(C+h)+(h-o),h=r-D,c=r-(D+h)+(h-o),0===a&&0===l&&0===u&&0===c)return M;if(O=11093356479670487e-47*s+33306690738754706e-32*Math.abs(M),M+=E*c+D*a-(C*u+A*l),M>=O||-M>=O)return M;w=a*D,f=K4*a,d=f-(f-a),p=a-d,f=K4*D,m=f-(f-D),g=D-m,x=p*g-(w-d*m-p*m-d*g),_=l*A,f=K4*l,d=f-(f-l),p=l-d,f=K4*A,m=f-(f-A),g=A-m,k=p*g-(_-d*m-p*m-d*g),y=x-k,h=x-y,i5[0]=x-(y+h)+(h-k),b=w+y,h=b-w,v=w-(b-h)+(y-h),y=v-_,h=v-y,i5[1]=v-(y+h)+(h-_),S=b+y,h=S-b,i5[2]=b-(S-h)+(y-h),i5[3]=S;const T=Q4(4,t5,4,i5,e5);w=E*c,f=K4*E,d=f-(f-E),p=E-d,f=K4*c,m=f-(f-c),g=c-m,x=p*g-(w-d*m-p*m-d*g),_=C*u,f=K4*C,d=f-(f-C),p=C-d,f=K4*u,m=f-(f-u),g=u-m,k=p*g-(_-d*m-p*m-d*g),y=x-k,h=x-y,i5[0]=x-(y+h)+(h-k),b=w+y,h=b-w,v=w-(b-h)+(y-h),y=v-_,h=v-y,i5[1]=v-(y+h)+(h-_),S=b+y,h=S-b,i5[2]=b-(S-h)+(y-h),i5[3]=S;const I=Q4(T,e5,4,i5,n5);w=a*c,f=K4*a,d=f-(f-a),p=a-d,f=K4*c,m=f-(f-c),g=c-m,x=p*g-(w-d*m-p*m-d*g),_=l*u,f=K4*l,d=f-(f-l),p=l-d,f=K4*u,m=f-(f-u),g=u-m,k=p*g-(_-d*m-p*m-d*g),y=x-k,h=x-y,i5[0]=x-(y+h)+(h-k),b=w+y,h=b-w,v=w-(b-h)+(y-h),y=v-_,h=v-y,i5[1]=v-(y+h)+(h-_),S=b+y,h=S-b,i5[2]=b-(S-h)+(y-h),i5[3]=S;const N=Q4(I,n5,4,i5,r5);return r5[N-1]}(t,e,n,r,i,o,u)}Z4(4),Z4(4),Z4(4),Z4(4),Z4(4),Z4(4),Z4(4),Z4(4),Z4(4),Z4(8),Z4(8),Z4(8),Z4(4),Z4(8),Z4(8),Z4(8),Z4(12),Z4(192),Z4(192),Z4(4),Z4(4),Z4(4),Z4(4),Z4(4),Z4(4),Z4(4),Z4(4),Z4(8),Z4(8),Z4(8),Z4(8),Z4(8),Z4(8),Z4(8),Z4(8),Z4(8),Z4(4),Z4(4),Z4(4),Z4(8),Z4(16),Z4(16),Z4(16),Z4(32),Z4(32),Z4(48),Z4(64),Z4(1152),Z4(1152),Z4(4),Z4(4),Z4(4),Z4(4),Z4(4),Z4(4),Z4(4),Z4(4),Z4(4),Z4(4),Z4(24),Z4(24),Z4(24),Z4(24),Z4(24),Z4(24),Z4(24),Z4(24),Z4(24),Z4(24),Z4(1152),Z4(1152),Z4(1152),Z4(1152),Z4(1152),Z4(2304),Z4(2304),Z4(3456),Z4(5760),Z4(8),Z4(8),Z4(8),Z4(16),Z4(24),Z4(48),Z4(48),Z4(96),Z4(192),Z4(384),Z4(384),Z4(384),Z4(768),Z4(96),Z4(96),Z4(96),Z4(1152);const s5=Math.pow(2,-52),a5=new Uint32Array(512);class l5{static from(t,e=p5,n=m5){const r=t.length,i=new Float64Array(2*r);for(let o=0;o<r;o++){const r=t[o];i[2*o]=e(r),i[2*o+1]=n(r)}return new l5(i)}constructor(t){const e=t.length>>1;if(e>0&&"number"!=typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:t,_hullPrev:e,_hullNext:n,_hullTri:r,_hullHash:i}=this,o=t.length>>1;let s=1/0,a=1/0,l=-1/0,u=-1/0;for(let e=0;e<o;e++){const n=t[2*e],r=t[2*e+1];n<s&&(s=n),r<a&&(a=r),n>l&&(l=n),r>u&&(u=r),this._ids[e]=e}const c=(s+l)/2,h=(a+u)/2;let f,d,p;for(let e=0,n=1/0;e<o;e++){const r=u5(c,h,t[2*e],t[2*e+1]);r<n&&(f=e,n=r)}const m=t[2*f],g=t[2*f+1];for(let e=0,n=1/0;e<o;e++){if(e===f)continue;const r=u5(m,g,t[2*e],t[2*e+1]);r<n&&r>0&&(d=e,n=r)}let y=t[2*d],b=t[2*d+1],v=1/0;for(let e=0;e<o;e++){if(e===f||e===d)continue;const n=h5(m,g,y,b,t[2*e],t[2*e+1]);n<v&&(p=e,v=n)}let w=t[2*p],x=t[2*p+1];if(v===1/0){for(let e=0;e<o;e++)this._dists[e]=t[2*e]-t[0]||t[2*e+1]-t[1];f5(this._ids,this._dists,0,o-1);const e=new Uint32Array(o);let n=0;for(let t=0,r=-1/0;t<o;t++){const i=this._ids[t],o=this._dists[i];o>r&&(e[n++]=i,r=o)}return this.hull=e.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(o5(m,g,y,b,w,x)<0){const t=d,e=y,n=b;d=p,y=w,b=x,p=t,w=e,x=n}const _=function(t,e,n,r,i,o){const s=n-t,a=r-e,l=i-t,u=o-e,c=s*s+a*a,h=l*l+u*u,f=.5/(s*u-a*l);return{x:t+(u*c-a*h)*f,y:e+(s*h-l*c)*f}}(m,g,y,b,w,x);this._cx=_.x,this._cy=_.y;for(let e=0;e<o;e++)this._dists[e]=u5(t[2*e],t[2*e+1],_.x,_.y);f5(this._ids,this._dists,0,o-1),this._hullStart=f;let k=3;n[f]=e[p]=d,n[d]=e[f]=p,n[p]=e[d]=f,r[f]=0,r[d]=1,r[p]=2,i.fill(-1),i[this._hashKey(m,g)]=f,i[this._hashKey(y,b)]=d,i[this._hashKey(w,x)]=p,this.trianglesLen=0,this._addTriangle(f,d,p,-1,-1,-1);for(let o,s,a=0;a<this._ids.length;a++){const l=this._ids[a],u=t[2*l],c=t[2*l+1];if(a>0&&Math.abs(u-o)<=s5&&Math.abs(c-s)<=s5)continue;if(o=u,s=c,l===f||l===d||l===p)continue;let h=0;for(let t=0,e=this._hashKey(u,c);t<this._hashSize&&(h=i[(e+t)%this._hashSize],-1===h||h===n[h]);t++);h=e[h];let m,g=h;for(;m=n[g],o5(u,c,t[2*g],t[2*g+1],t[2*m],t[2*m+1])>=0;)if(g=m,g===h){g=-1;break}if(-1===g)continue;let y=this._addTriangle(g,l,n[g],-1,-1,r[g]);r[l]=this._legalize(y+2),r[g]=y,k++;let b=n[g];for(;m=n[b],o5(u,c,t[2*b],t[2*b+1],t[2*m],t[2*m+1])<0;)y=this._addTriangle(b,l,m,r[l],-1,r[b]),r[l]=this._legalize(y+2),n[b]=b,k--,b=m;if(g===h)for(;m=e[g],o5(u,c,t[2*m],t[2*m+1],t[2*g],t[2*g+1])<0;)y=this._addTriangle(m,l,g,-1,r[g],r[m]),this._legalize(y+2),r[m]=y,n[g]=g,k--,g=m;this._hullStart=e[l]=g,n[g]=e[b]=l,n[l]=b,i[this._hashKey(u,c)]=l,i[this._hashKey(t[2*g],t[2*g+1])]=g}this.hull=new Uint32Array(k);for(let t=0,e=this._hullStart;t<k;t++)this.hull[t]=e,e=n[e];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(function(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:e,_halfedges:n,coords:r}=this;let i=0,o=0;for(;;){const s=n[t],a=t-t%3;if(o=a+(t+2)%3,-1===s){if(0===i)break;t=a5[--i];continue}const l=s-s%3,u=a+(t+1)%3,c=l+(s+2)%3,h=e[o],f=e[t],d=e[u],p=e[c];if(c5(r[2*h],r[2*h+1],r[2*f],r[2*f+1],r[2*d],r[2*d+1],r[2*p],r[2*p+1])){e[t]=p,e[s]=h;const r=n[c];if(-1===r){let e=this._hullStart;do{if(this._hullTri[e]===c){this._hullTri[e]=t;break}e=this._hullPrev[e]}while(e!==this._hullStart)}this._link(t,r),this._link(s,n[o]),this._link(o,c);const a=l+(s+1)%3;i<a5.length&&(a5[i++]=a)}else{if(0===i)break;t=a5[--i]}}return o}_link(t,e){this._halfedges[t]=e,-1!==e&&(this._halfedges[e]=t)}_addTriangle(t,e,n,r,i,o){const s=this.trianglesLen;return this._triangles[s]=t,this._triangles[s+1]=e,this._triangles[s+2]=n,this._link(s,r),this._link(s+1,i),this._link(s+2,o),this.trianglesLen+=3,s}}function u5(t,e,n,r){const i=t-n,o=e-r;return i*i+o*o}function c5(t,e,n,r,i,o,s,a){const l=t-s,u=e-a,c=n-s,h=r-a,f=i-s,d=o-a,p=c*c+h*h,m=f*f+d*d;return l*(h*m-p*d)-u*(c*m-p*f)+(l*l+u*u)*(c*d-h*f)<0}function h5(t,e,n,r,i,o){const s=n-t,a=r-e,l=i-t,u=o-e,c=s*s+a*a,h=l*l+u*u,f=.5/(s*u-a*l),d=(u*c-a*h)*f,p=(s*h-l*c)*f;return d*d+p*p}function f5(t,e,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const r=t[i],o=e[r];let s=i-1;for(;s>=n&&e[t[s]]>o;)t[s+1]=t[s--];t[s+1]=r}else{let i=n+1,o=r;d5(t,n+r>>1,i),e[t[n]]>e[t[r]]&&d5(t,n,r),e[t[i]]>e[t[r]]&&d5(t,i,r),e[t[n]]>e[t[i]]&&d5(t,n,i);const s=t[i],a=e[s];for(;;){do{i++}while(e[t[i]]<a);do{o--}while(e[t[o]]>a);if(o<i)break;d5(t,i,o)}t[n+1]=t[o],t[o]=s,r-i+1>=o-n?(f5(t,e,i,r),f5(t,e,n,o-1)):(f5(t,e,n,o-1),f5(t,e,i,r))}}function d5(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function p5(t){return t[0]}function m5(t){return t[1]}const g5=1e-6;class y5{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,e){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,e){this._+=`L${this._x1=+t},${this._y1=+e}`}arc(t,e,n){const r=(t=+t)+(n=+n),i=e=+e;if(n<0)throw new Error("negative radius");null===this._x1?this._+=`M${r},${i}`:(Math.abs(this._x1-r)>g5||Math.abs(this._y1-i)>g5)&&(this._+="L"+r+","+i),n&&(this._+=`A${n},${n},0,1,1,${t-n},${e}A${n},${n},0,1,1,${this._x1=r},${this._y1=i}`)}rect(t,e,n,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${+n}v${+r}h${-n}Z`}value(){return this._||null}}class b5{constructor(){this._=[]}moveTo(t,e){this._.push([t,e])}closePath(){this._.push(this._[0].slice())}lineTo(t,e){this._.push([t,e])}value(){return this._.length?this._:null}}class v5{constructor(t,[e,n,r,i]=[0,0,960,500]){if(!((r=+r)>=(e=+e)&&(i=+i)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=r,this.xmin=e,this.ymax=i,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:t,hull:e,triangles:n},vectors:r}=this;let i,o;const s=this.circumcenters=this._circumcenters.subarray(0,n.length/3*2);for(let r,a,l=0,u=0,c=n.length;l<c;l+=3,u+=2){const c=2*n[l],h=2*n[l+1],f=2*n[l+2],d=t[c],p=t[c+1],m=t[h],g=t[h+1],y=t[f],b=t[f+1],v=m-d,w=g-p,x=y-d,_=b-p,k=2*(v*_-w*x);if(Math.abs(k)<1e-9){if(void 0===i){i=o=0;for(const n of e)i+=t[2*n],o+=t[2*n+1];i/=e.length,o/=e.length}const n=1e9*Math.sign((i-d)*_-(o-p)*x);r=(d+y)/2-n*_,a=(p+b)/2+n*x}else{const t=1/k,e=v*v+w*w,n=x*x+_*_;r=d+(_*e-w*n)*t,a=p+(v*n-x*e)*t}s[u]=r,s[u+1]=a}let a,l,u,c=e[e.length-1],h=4*c,f=t[2*c],d=t[2*c+1];r.fill(0);for(let n=0;n<e.length;++n)c=e[n],a=h,l=f,u=d,h=4*c,f=t[2*c],d=t[2*c+1],r[a+2]=r[h]=u-d,r[a+3]=r[h+1]=f-l}render(t){const e=null==t?t=new y5:void 0,{delaunay:{halfedges:n,inedges:r,hull:i},circumcenters:o,vectors:s}=this;if(i.length<=1)return null;for(let e=0,r=n.length;e<r;++e){const r=n[e];if(r<e)continue;const i=2*Math.floor(e/3),s=2*Math.floor(r/3),a=o[i],l=o[i+1],u=o[s],c=o[s+1];this._renderSegment(a,l,u,c,t)}let a,l=i[i.length-1];for(let e=0;e<i.length;++e){a=l,l=i[e];const n=2*Math.floor(r[l]/3),u=o[n],c=o[n+1],h=4*a,f=this._project(u,c,s[h+2],s[h+3]);f&&this._renderSegment(u,c,f[0],f[1],t)}return e&&e.value()}renderBounds(t){const e=null==t?t=new y5:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),e&&e.value()}renderCell(t,e){const n=null==e?e=new y5:void 0,r=this._clip(t);if(null===r||!r.length)return;e.moveTo(r[0],r[1]);let i=r.length;for(;r[0]===r[i-2]&&r[1]===r[i-1]&&i>1;)i-=2;for(let t=2;t<i;t+=2)r[t]===r[t-2]&&r[t+1]===r[t-1]||e.lineTo(r[t],r[t+1]);return e.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:t}}=this;for(let e=0,n=t.length/2;e<n;++e){const t=this.cellPolygon(e);t&&(t.index=e,yield t)}}cellPolygon(t){const e=new b5;return this.renderCell(t,e),e.value()}_renderSegment(t,e,n,r,i){let o;const s=this._regioncode(t,e),a=this._regioncode(n,r);0===s&&0===a?(i.moveTo(t,e),i.lineTo(n,r)):(o=this._clipSegment(t,e,n,r,s,a))&&(i.moveTo(o[0],o[1]),i.lineTo(o[2],o[3]))}contains(t,e,n){return(e=+e)==e&&(n=+n)==n&&this.delaunay._step(t,e,n)===t}*neighbors(t){const e=this._clip(t);if(e)for(const n of this.delaunay.neighbors(t)){const t=this._clip(n);if(t)t:for(let r=0,i=e.length;r<i;r+=2)for(let o=0,s=t.length;o<s;o+=2)if(e[r]===t[o]&&e[r+1]===t[o+1]&&e[(r+2)%i]===t[(o+s-2)%s]&&e[(r+3)%i]===t[(o+s-1)%s]){yield n;break t}}}_cell(t){const{circumcenters:e,delaunay:{inedges:n,halfedges:r,triangles:i}}=this,o=n[t];if(-1===o)return null;const s=[];let a=o;do{const n=Math.floor(a/3);if(s.push(e[2*n],e[2*n+1]),a=a%3==2?a-2:a+1,i[a]!==t)break;a=r[a]}while(a!==o&&-1!==a);return s}_clip(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const e=this._cell(t);if(null===e)return null;const{vectors:n}=this,r=4*t;return this._simplify(n[r]||n[r+1]?this._clipInfinite(t,e,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(t,e))}_clipFinite(t,e){const n=e.length;let r,i,o,s,a=null,l=e[n-2],u=e[n-1],c=this._regioncode(l,u),h=0;for(let f=0;f<n;f+=2)if(r=l,i=u,l=e[f],u=e[f+1],o=c,c=this._regioncode(l,u),0===o&&0===c)s=h,h=0,a?a.push(l,u):a=[l,u];else{let e,n,f,d,p;if(0===o){if(null===(e=this._clipSegment(r,i,l,u,o,c)))continue;[n,f,d,p]=e}else{if(null===(e=this._clipSegment(l,u,r,i,c,o)))continue;[d,p,n,f]=e,s=h,h=this._edgecode(n,f),s&&h&&this._edge(t,s,h,a,a.length),a?a.push(n,f):a=[n,f]}s=h,h=this._edgecode(d,p),s&&h&&this._edge(t,s,h,a,a.length),a?a.push(d,p):a=[d,p]}if(a)s=h,h=this._edgecode(a[0],a[1]),s&&h&&this._edge(t,s,h,a,a.length);else if(this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return a}_clipSegment(t,e,n,r,i,o){const s=i<o;for(s&&([t,e,n,r,i,o]=[n,r,t,e,o,i]);;){if(0===i&&0===o)return s?[n,r,t,e]:[t,e,n,r];if(i&o)return null;let a,l,u=i||o;8&u?(a=t+(n-t)*(this.ymax-e)/(r-e),l=this.ymax):4&u?(a=t+(n-t)*(this.ymin-e)/(r-e),l=this.ymin):2&u?(l=e+(r-e)*(this.xmax-t)/(n-t),a=this.xmax):(l=e+(r-e)*(this.xmin-t)/(n-t),a=this.xmin),i?(t=a,e=l,i=this._regioncode(t,e)):(n=a,r=l,o=this._regioncode(n,r))}}_clipInfinite(t,e,n,r,i,o){let s,a=Array.from(e);if((s=this._project(a[0],a[1],n,r))&&a.unshift(s[0],s[1]),(s=this._project(a[a.length-2],a[a.length-1],i,o))&&a.push(s[0],s[1]),a=this._clipFinite(t,a))for(let e,n=0,r=a.length,i=this._edgecode(a[r-2],a[r-1]);n<r;n+=2)e=i,i=this._edgecode(a[n],a[n+1]),e&&i&&(n=this._edge(t,e,i,a,n),r=a.length);else this.contains(t,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(t,e,n,r,i){for(;e!==n;){let n,o;switch(e){case 5:e=4;continue;case 4:e=6,n=this.xmax,o=this.ymin;break;case 6:e=2;continue;case 2:e=10,n=this.xmax,o=this.ymax;break;case 10:e=8;continue;case 8:e=9,n=this.xmin,o=this.ymax;break;case 9:e=1;continue;case 1:e=5,n=this.xmin,o=this.ymin}r[i]===n&&r[i+1]===o||!this.contains(t,n,o)||(r.splice(i,0,n,o),i+=2)}return i}_project(t,e,n,r){let i,o,s,a=1/0;if(r<0){if(e<=this.ymin)return null;(i=(this.ymin-e)/r)<a&&(s=this.ymin,o=t+(a=i)*n)}else if(r>0){if(e>=this.ymax)return null;(i=(this.ymax-e)/r)<a&&(s=this.ymax,o=t+(a=i)*n)}if(n>0){if(t>=this.xmax)return null;(i=(this.xmax-t)/n)<a&&(o=this.xmax,s=e+(a=i)*r)}else if(n<0){if(t<=this.xmin)return null;(i=(this.xmin-t)/n)<a&&(o=this.xmin,s=e+(a=i)*r)}return[o,s]}_edgecode(t,e){return(t===this.xmin?1:t===this.xmax?2:0)|(e===this.ymin?4:e===this.ymax?8:0)}_regioncode(t,e){return(t<this.xmin?1:t>this.xmax?2:0)|(e<this.ymin?4:e>this.ymax?8:0)}_simplify(t){if(t&&t.length>4){for(let e=0;e<t.length;e+=2){const n=(e+2)%t.length,r=(e+4)%t.length;(t[e]===t[n]&&t[n]===t[r]||t[e+1]===t[n+1]&&t[n+1]===t[r+1])&&(t.splice(n,2),e-=2)}t.length||(t=null)}return t}}const w5=2*Math.PI,x5=Math.pow;function _5(t){return t[0]}function k5(t){return t[1]}function S5(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}class E5{static from(t,e=_5,n=k5,r){return new E5("length"in t?function(t,e,n,r){const i=t.length,o=new Float64Array(2*i);for(let s=0;s<i;++s){const i=t[s];o[2*s]=e.call(r,i,s,t),o[2*s+1]=n.call(r,i,s,t)}return o}(t,e,n,r):Float64Array.from(function*(t,e,n,r){let i=0;for(const o of t)yield e.call(r,o,i,t),yield n.call(r,o,i,t),++i}(t,e,n,r)))}constructor(t){this._delaunator=new l5(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,e=this.points;if(t.hull&&t.hull.length>2&&function(t){const{triangles:e,coords:n}=t;for(let t=0;t<e.length;t+=3){const r=2*e[t],i=2*e[t+1],o=2*e[t+2];if((n[o]-n[r])*(n[i+1]-n[r+1])-(n[i]-n[r])*(n[o+1]-n[r+1])>1e-10)return!1}return!0}(t)){this.collinear=Int32Array.from({length:e.length/2},((t,e)=>e)).sort(((t,n)=>e[2*t]-e[2*n]||e[2*t+1]-e[2*n+1]));const t=this.collinear[0],n=this.collinear[this.collinear.length-1],r=[e[2*t],e[2*t+1],e[2*n],e[2*n+1]],i=1e-8*Math.hypot(r[3]-r[1],r[2]-r[0]);for(let t=0,n=e.length/2;t<n;++t){const n=S5(e[2*t],e[2*t+1],i);e[2*t]=n[0],e[2*t+1]=n[1]}this._delaunator=new l5(e)}else delete this.collinear;const n=this.halfedges=this._delaunator.halfedges,r=this.hull=this._delaunator.hull,i=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),s=this._hullIndex.fill(-1);for(let t=0,e=n.length;t<e;++t){const e=i[t%3==2?t-2:t+1];-1!==n[t]&&-1!==o[e]||(o[e]=t)}for(let t=0,e=r.length;t<e;++t)s[r[t]]=t;r.length<=2&&r.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=r[0],o[r[0]]=1,2===r.length&&(o[r[1]]=0,this.triangles[1]=r[1],this.triangles[2]=r[1]))}voronoi(t){return new v5(this,t)}*neighbors(t){const{inedges:e,hull:n,_hullIndex:r,halfedges:i,triangles:o,collinear:s}=this;if(s){const e=s.indexOf(t);return e>0&&(yield s[e-1]),void(e<s.length-1&&(yield s[e+1]))}const a=e[t];if(-1===a)return;let l=a,u=-1;do{if(yield u=o[l],l=l%3==2?l-2:l+1,o[l]!==t)return;if(l=i[l],-1===l){const e=n[(r[t]+1)%n.length];return void(e!==u&&(yield e))}}while(l!==a)}find(t,e,n=0){if((t=+t)!=t||(e=+e)!=e)return-1;const r=n;let i;for(;(i=this._step(n,t,e))>=0&&i!==n&&i!==r;)n=i;return i}_step(t,e,n){const{inedges:r,hull:i,_hullIndex:o,halfedges:s,triangles:a,points:l}=this;if(-1===r[t]||!l.length)return(t+1)%(l.length>>1);let u=t,c=x5(e-l[2*t],2)+x5(n-l[2*t+1],2);const h=r[t];let f=h;do{let r=a[f];const h=x5(e-l[2*r],2)+x5(n-l[2*r+1],2);if(h<c&&(c=h,u=r),f=f%3==2?f-2:f+1,a[f]!==t)break;if(f=s[f],-1===f){if(f=i[(o[t]+1)%i.length],f!==r&&x5(e-l[2*f],2)+x5(n-l[2*f+1],2)<c)return f;break}}while(f!==h);return u}render(t){const e=null==t?t=new y5:void 0,{points:n,halfedges:r,triangles:i}=this;for(let e=0,o=r.length;e<o;++e){const o=r[e];if(o<e)continue;const s=2*i[e],a=2*i[o];t.moveTo(n[s],n[s+1]),t.lineTo(n[a],n[a+1])}return this.renderHull(t),e&&e.value()}renderPoints(t,e){void 0!==e||t&&"function"==typeof t.moveTo||(e=t,t=null),e=null==e?2:+e;const n=null==t?t=new y5:void 0,{points:r}=this;for(let n=0,i=r.length;n<i;n+=2){const i=r[n],o=r[n+1];t.moveTo(i+e,o),t.arc(i,o,e,0,w5)}return n&&n.value()}renderHull(t){const e=null==t?t=new y5:void 0,{hull:n,points:r}=this,i=2*n[0],o=n.length;t.moveTo(r[i],r[i+1]);for(let e=1;e<o;++e){const i=2*n[e];t.lineTo(r[i],r[i+1])}return t.closePath(),e&&e.value()}hullPolygon(){const t=new b5;return this.renderHull(t),t.value()}renderTriangle(t,e){const n=null==e?e=new y5:void 0,{points:r,triangles:i}=this,o=2*i[t*=3],s=2*i[t+1],a=2*i[t+2];return e.moveTo(r[o],r[o+1]),e.lineTo(r[s],r[s+1]),e.lineTo(r[a],r[a+1]),e.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:t}=this;for(let e=0,n=t.length/3;e<n;++e)yield this.trianglePolygon(e)}trianglePolygon(t){const e=new b5;return this.renderTriangle(t,e),e.value()}}function A5(t){dP.call(this,null,t)}A5.Definition={type:"Voronoi",metadata:{modifies:!0},params:[{name:"x",type:"field",required:!0},{name:"y",type:"field",required:!0},{name:"size",type:"number",array:!0,length:2},{name:"extent",type:"array",array:!0,length:2,default:[[-1e5,-1e5],[1e5,1e5]],content:{type:"number",array:!0,length:2}},{name:"as",type:"string",default:"path"}]};const C5=[-1e5,-1e5,1e5,1e5];function D5(t){const e=t[0][0],n=t[0][1];let r=t.length-1;for(;t[r][0]===e&&t[r][1]===n;--r);return"M"+t.slice(0,r+1).join("L")+"Z"}UF(A5,dP,{transform(t,e){const n=t.as||"path",r=e.source;if(!r||!r.length)return e;let i=t.size;i=i?[0,0,i[0],i[1]]:(i=t.extent)?[i[0][0],i[0][1],i[1][0],i[1][1]]:C5;const o=this.value=E5.from(r,t.x,t.y).voronoi(i);for(let t=0,e=r.length;t<e;++t){const e=o.cellPolygon(t);r[t][n]=!e||2===(s=e).length&&s[0][0]===s[1][0]&&s[0][1]===s[1][1]?null:D5(e)}var s;return e.reflow(t.modified()).modifies(n)}});var M5=Math.PI/180,O5=64,T5=2048;function I5(t,e,n,r){if(!e.sprite){var i=t.context,o=t.ratio;i.clearRect(0,0,(O5<<5)/o,T5/o);var s,a,l,u,c,h=0,f=0,d=0,p=n.length;for(--r;++r<p;){if(e=n[r],i.save(),i.font=e.style+" "+e.weight+" "+~~((e.size+1)/o)+"px "+e.font,s=i.measureText(e.text+"m").width*o,l=e.size<<1,e.rotate){var m=Math.sin(e.rotate*M5),g=Math.cos(e.rotate*M5),y=s*g,b=s*m,v=l*g,w=l*m;s=Math.max(Math.abs(y+w),Math.abs(y-w))+31>>5<<5,l=~~Math.max(Math.abs(b+v),Math.abs(b-v))}else s=s+31>>5<<5;if(l>d&&(d=l),h+s>=O5<<5&&(h=0,f+=d,d=0),f+l>=T5)break;i.translate((h+(s>>1))/o,(f+(l>>1))/o),e.rotate&&i.rotate(e.rotate*M5),i.fillText(e.text,0,0),e.padding&&(i.lineWidth=2*e.padding,i.strokeText(e.text,0,0)),i.restore(),e.width=s,e.height=l,e.xoff=h,e.yoff=f,e.x1=s>>1,e.y1=l>>1,e.x0=-e.x1,e.y0=-e.y1,e.hasText=!0,h+=s}for(var x=i.getImageData(0,0,(O5<<5)/o,T5/o).data,_=[];--r>=0;)if((e=n[r]).hasText){for(a=(s=e.width)>>5,l=e.y1-e.y0,u=0;u<l*a;u++)_[u]=0;if(null==(h=e.xoff))return;f=e.yoff;var k=0,S=-1;for(c=0;c<l;c++){for(u=0;u<s;u++){var E=a*c+(u>>5),A=x[(f+c)*(O5<<5)+(h+u)<<2]?1<<31-u%32:0;_[E]|=A,k|=A}k?S=c:(e.y0++,l--,c--,f++)}e.y1=e.y0+S,e.sprite=_.slice(0,(e.y1-e.y0)*a)}}}function N5(t,e,n){n>>=5;for(var r,i=t.sprite,o=t.width>>5,s=t.x-(o<<4),a=127&s,l=32-a,u=t.y1-t.y0,c=(t.y+t.y0)*n+(s>>5),h=0;h<u;h++){r=0;for(var f=0;f<=o;f++)if((r<<l|(f<o?(r=i[h*o+f])>>>a:0))&e[c+f])return!0;c+=n}return!1}function $5(t,e){var n=t[0],r=t[1];e.x+e.x0<n.x&&(n.x=e.x+e.x0),e.y+e.y0<n.y&&(n.y=e.y+e.y0),e.x+e.x1>r.x&&(r.x=e.x+e.x1),e.y+e.y1>r.y&&(r.y=e.y+e.y1)}function F5(t,e){return t.x+t.x1>e[0].x&&t.x+t.x0<e[1].x&&t.y+t.y1>e[0].y&&t.y+t.y0<e[1].y}function L5(t){var e=t[0]/t[1];return function(t){return[e*(t*=.1)*Math.cos(t),t*Math.sin(t)]}}function B5(t){return"function"==typeof t?t:function(){return t}}var R5={archimedean:L5,rectangular:function(t){var e=4*t[0]/t[1],n=0,r=0;return function(t){var i=t<0?-1:1;switch(Math.sqrt(1+4*i*t)-i&3){case 0:n+=e;break;case 1:r+=4;break;case 2:n-=e;break;default:r-=4}return[n,r]}}};const P5=["x","y","font","fontSize","fontStyle","fontWeight","angle"],z5=["text","font","rotate","fontSize","fontStyle","fontWeight"];function j5(t){dP.call(this,function(){var t,e,n,r,i,o,s,a=[256,256],l=L5,u=[],c=Math.random,h={};function f(t,e,n){for(var r,i,o,s=e.x,u=e.y,h=Math.sqrt(a[0]*a[0]+a[1]*a[1]),f=l(a),d=c()<.5?1:-1,p=-d;(r=f(p+=d))&&(i=~~r[0],o=~~r[1],!(Math.min(Math.abs(i),Math.abs(o))>=h));)if(e.x=s+i,e.y=u+o,!(e.x+e.x0<0||e.y+e.y0<0||e.x+e.x1>a[0]||e.y+e.y1>a[1])&&(!n||!N5(e,t,a[0]))&&(!n||F5(e,n))){for(var m,g=e.sprite,y=e.width>>5,b=a[0]>>5,v=e.x-(y<<4),w=127&v,x=32-w,_=e.y1-e.y0,k=(e.y+e.y0)*b+(v>>5),S=0;S<_;S++){m=0;for(var E=0;E<=y;E++)t[k+E]|=m<<x|(E<y?(m=g[S*y+E])>>>w:0);k+=b}return e.sprite=null,!0}return!1}return h.layout=function(){for(var l=function(t){t.width=t.height=1;var e=Math.sqrt(t.getContext("2d").getImageData(0,0,1,1).data.length>>2);t.width=(O5<<5)/e,t.height=T5/e;var n=t.getContext("2d");return n.fillStyle=n.strokeStyle="red",n.textAlign="center",{context:n,ratio:e}}(aV()),h=function(t){for(var e=[],n=-1;++n<t;)e[n]=0;return e}((a[0]>>5)*a[1]),d=null,p=u.length,m=-1,g=[],y=u.map((a=>({text:t(a),font:e(a),style:r(a),weight:i(a),rotate:o(a),size:~~(n(a)+1e-14),padding:s(a),xoff:0,yoff:0,x1:0,y1:0,x0:0,y0:0,hasText:!1,sprite:null,datum:a}))).sort(((t,e)=>e.size-t.size));++m<p;){var b=y[m];b.x=a[0]*(c()+.5)>>1,b.y=a[1]*(c()+.5)>>1,I5(l,b,y,m),b.hasText&&f(h,b,d)&&(g.push(b),d?$5(d,b):d=[{x:b.x+b.x0,y:b.y+b.y0},{x:b.x+b.x1,y:b.y+b.y1}],b.x-=a[0]>>1,b.y-=a[1]>>1)}return g},h.words=function(t){return arguments.length?(u=t,h):u},h.size=function(t){return arguments.length?(a=[+t[0],+t[1]],h):a},h.font=function(t){return arguments.length?(e=B5(t),h):e},h.fontStyle=function(t){return arguments.length?(r=B5(t),h):r},h.fontWeight=function(t){return arguments.length?(i=B5(t),h):i},h.rotate=function(t){return arguments.length?(o=B5(t),h):o},h.text=function(e){return arguments.length?(t=B5(e),h):t},h.spiral=function(t){return arguments.length?(l=R5[t]||t,h):l},h.fontSize=function(t){return arguments.length?(n=B5(t),h):n},h.padding=function(t){return arguments.length?(s=B5(t),h):s},h.random=function(t){return arguments.length?(c=t,h):c},h}(),t)}j5.Definition={type:"Wordcloud",metadata:{modifies:!0},params:[{name:"size",type:"number",array:!0,length:2},{name:"font",type:"string",expr:!0,default:"sans-serif"},{name:"fontStyle",type:"string",expr:!0,default:"normal"},{name:"fontWeight",type:"string",expr:!0,default:"normal"},{name:"fontSize",type:"number",expr:!0,default:14},{name:"fontSizeRange",type:"number",array:"nullable",default:[10,50]},{name:"rotate",type:"number",expr:!0,default:0},{name:"text",type:"field"},{name:"spiral",type:"string",values:["archimedean","rectangular"]},{name:"padding",type:"number",expr:!0},{name:"as",type:"string",array:!0,length:7,default:P5}]},UF(j5,dP,{transform(t,e){!t.size||t.size[0]&&t.size[1]||L$("Wordcloud size dimensions must be non-zero.");const n=t.modified();if(!(n||e.changed(e.ADD_REM)||z5.some((function(n){const r=t[n];return EF(r)&&e.modified(r.fields)}))))return;const r=e.materialize(e.SOURCE).source,i=this.value,o=t.as||P5;let s,a=t.fontSize||14;if(EF(a)?s=t.fontSizeRange:a=IF(a),s){const t=a,e=SW("sqrt")().domain(FF(r,t)).range(s);a=n=>e(t(n))}r.forEach((t=>{t[o[0]]=NaN,t[o[1]]=NaN,t[o[3]]=0}));const l=i.words(r).text(t.text).size(t.size||[500,500]).padding(t.padding||1).spiral(t.spiral||"archimedean").rotate(t.rotate||0).font(t.font||"sans-serif").fontStyle(t.fontStyle||"normal").fontWeight(t.fontWeight||"normal").fontSize(a).random(MP).layout(),u=i.size(),c=u[0]>>1,h=u[1]>>1,f=l.length;for(let t,e,n=0;n<f;++n)t=l[n],e=t.datum,e[o[0]]=t.x+c,e[o[1]]=t.y+h,e[o[2]]=t.font,e[o[3]]=t.size,e[o[4]]=t.style,e[o[5]]=t.weight,e[o[6]]=t.rotate;return e.reflow(n).modifies(o)}});const U5=t=>new Uint8Array(t),V5=t=>new Uint16Array(t),q5=t=>new Uint32Array(t);function W5(t,e,n){const r=(e<257?U5:e<65537?V5:q5)(t);return n&&r.set(n),r}function H5(t,e,n){const r=1<<e;return{one:r,zero:~r,range:n.slice(),bisect:t.bisect,index:t.index,size:t.size,onAdd(t,e){const n=this,i=n.bisect(n.range,t.value),o=t.index,s=i[0],a=i[1],l=o.length;let u;for(u=0;u<s;++u)e[o[u]]|=r;for(u=a;u<l;++u)e[o[u]]|=r;return n}}}function G5(){let t=q5(0),e=[],n=0;return{insert:function(r,i,o){if(!i.length)return[];const s=n,a=i.length,l=q5(a);let u,c,h,f=Array(a);for(h=0;h<a;++h)f[h]=r(i[h]),l[h]=h;if(f=function(t,e){return t.sort.call(e,((e,n)=>{const r=t[e],i=t[n];return r<i?-1:r>i?1:0})),function(t,e){return Array.from(e,(e=>t[e]))}(t,e)}(f,l),s)u=e,c=t,e=Array(s+a),t=q5(s+a),function(t,e,n,r,i,o,s,a,l){let u,c=0,h=0;for(u=0;c<r&&h<s;++u)e[c]<i[h]?(a[u]=e[c],l[u]=n[c++]):(a[u]=i[h],l[u]=o[h++]+t);for(;c<r;++c,++u)a[u]=e[c],l[u]=n[c];for(;h<s;++h,++u)a[u]=i[h],l[u]=o[h]+t}(o,u,c,s,f,l,a,e,t);else{if(o>0)for(h=0;h<a;++h)l[h]+=o;e=f,t=l}return n=s+a,{index:l,value:f}},remove:function(r,i){const o=n;let s,a,l;for(a=0;!i[t[a]]&&a<o;++a);for(l=a;a<o;++a)i[s=t[a]]||(t[l]=s,e[l]=e[a],++l);n=o-r},bisect:function(t,r){let i;return r?i=r.length:(r=e,i=n),[UM(r,t[0],0,i),jM(r,t[1],0,i)]},reindex:function(e){for(let r=0,i=n;r<i;++r)t[r]=e[t[r]]},index:()=>t,size:()=>n}}function Y5(t){dP.call(this,function(){let t=8,e=[],n=q5(0),r=W5(0,t),i=W5(0,t);return{data:()=>e,seen:()=>n=function(t,e,n){return t.length>=e?t:((n=n||new t.constructor(e)).set(t),n)}(n,e.length),add(t){for(let n,r=0,i=e.length,o=t.length;r<o;++r)n=t[r],n._index=i++,e.push(n)},remove(t,n){const o=e.length,s=Array(o-t),a=e;let l,u,c;for(u=0;!n[u]&&u<o;++u)s[u]=e[u],a[u]=u;for(c=u;u<o;++u)l=e[u],n[u]?a[u]=-1:(a[u]=c,r[c]=r[u],i[c]=i[u],s[c]=l,l._index=c++),r[u]=0;return e=s,a},size:()=>e.length,curr:()=>r,prev:()=>i,reset:t=>i[t]=r[t],all:()=>t<257?255:t<65537?65535:4294967295,set(t,e){r[t]|=e},clear(t,e){r[t]&=~e},resize(e,n){(e>r.length||n>t)&&(t=Math.max(n,t),r=W5(e,t,r),i=W5(e,t))}}}(),t),this._indices=null,this._dims=null}function X5(t){dP.call(this,null,t)}Y5.Definition={type:"CrossFilter",metadata:{},params:[{name:"fields",type:"field",array:!0,required:!0},{name:"query",type:"array",array:!0,required:!0,content:{type:"number",array:!0,length:2}}]},UF(Y5,dP,{transform(t,e){return this._dims?t.modified("fields")||t.fields.some((t=>e.modified(t.fields)))?this.reinit(t,e):this.eval(t,e):this.init(t,e)},init(t,e){const n=t.fields,r=t.query,i=this._indices={},o=this._dims=[],s=r.length;let a,l,u=0;for(;u<s;++u)a=n[u].fname,l=i[a]||(i[a]=G5()),o.push(H5(l,u,r[u]));return this.eval(t,e)},reinit(t,e){const n=e.materialize().fork(),r=t.fields,i=t.query,o=this._indices,s=this._dims,a=this.value,l=a.curr(),u=a.prev(),c=a.all(),h=n.rem=n.add,f=n.mod,d=i.length,p={};let m,g,y,b,v,w,x,_,k;if(u.set(l),e.rem.length&&(v=this.remove(t,e,n)),e.add.length&&a.add(e.add),e.mod.length)for(w={},b=e.mod,x=0,_=b.length;x<_;++x)w[b[x]._index]=1;for(x=0;x<d;++x)k=r[x],(!s[x]||t.modified("fields",x)||e.modified(k.fields))&&(y=k.fname,(m=p[y])||(o[y]=g=G5(),p[y]=m=g.insert(k,e.source,0)),s[x]=H5(g,x,i[x]).onAdd(m,l));for(x=0,_=a.data().length;x<_;++x)v[x]||(u[x]!==l[x]?h.push(x):w[x]&&l[x]!==c&&f.push(x));return a.mask=(1<<d)-1,n},eval(t,e){const n=e.materialize().fork(),r=this._dims.length;let i=0;return e.rem.length&&(this.remove(t,e,n),i|=(1<<r)-1),t.modified("query")&&!t.modified("fields")&&(i|=this.update(t,e,n)),e.add.length&&(this.insert(t,e,n),i|=(1<<r)-1),e.mod.length&&(this.modify(e,n),i|=(1<<r)-1),this.value.mask=i,n},insert(t,e,n){const r=e.add,i=this.value,o=this._dims,s=this._indices,a=t.fields,l={},u=n.add,c=i.size()+r.length,h=o.length;let f,d,p,m=i.size();i.resize(c,h),i.add(r);const g=i.curr(),y=i.prev(),b=i.all();for(f=0;f<h;++f)d=a[f].fname,p=l[d]||(l[d]=s[d].insert(a[f],r,m)),o[f].onAdd(p,g);for(;m<c;++m)y[m]=b,g[m]!==b&&u.push(m)},modify(t,e){const n=e.mod,r=this.value,i=r.curr(),o=r.all(),s=t.mod;let a,l,u;for(a=0,l=s.length;a<l;++a)u=s[a]._index,i[u]!==o&&n.push(u)},remove(t,e,n){const r=this._indices,i=this.value,o=i.curr(),s=i.prev(),a=i.all(),l={},u=n.rem,c=e.rem;let h,f,d,p;for(h=0,f=c.length;h<f;++h)d=c[h]._index,l[d]=1,s[d]=p=o[d],o[d]=a,p!==a&&u.push(d);for(d in r)r[d].remove(f,l);return this.reindex(e,f,l),l},reindex(t,e,n){const r=this._indices,i=this.value;t.runAfter((()=>{const t=i.remove(e,n);for(const e in r)r[e].reindex(t)}))},update(t,e,n){const r=this._dims,i=t.query,o=e.stamp,s=r.length;let a,l,u=0;for(n.filters=0,l=0;l<s;++l)t.modified("query",l)&&(a=l,++u);if(1===u)u=r[a].one,this.incrementOne(r[a],i[a],n.add,n.rem);else for(l=0,u=0;l<s;++l)t.modified("query",l)&&(u|=r[l].one,this.incrementAll(r[l],i[l],o,n.add),n.rem=n.add);return u},incrementAll(t,e,n,r){const i=this.value,o=i.seen(),s=i.curr(),a=i.prev(),l=t.index(),u=t.bisect(t.range),c=t.bisect(e),h=c[0],f=c[1],d=u[0],p=u[1],m=t.one;let g,y,b;if(h<d)for(g=h,y=Math.min(d,f);g<y;++g)b=l[g],o[b]!==n&&(a[b]=s[b],o[b]=n,r.push(b)),s[b]^=m;else if(h>d)for(g=d,y=Math.min(h,p);g<y;++g)b=l[g],o[b]!==n&&(a[b]=s[b],o[b]=n,r.push(b)),s[b]^=m;if(f>p)for(g=Math.max(h,p),y=f;g<y;++g)b=l[g],o[b]!==n&&(a[b]=s[b],o[b]=n,r.push(b)),s[b]^=m;else if(f<p)for(g=Math.max(d,f),y=p;g<y;++g)b=l[g],o[b]!==n&&(a[b]=s[b],o[b]=n,r.push(b)),s[b]^=m;t.range=e.slice()},incrementOne(t,e,n,r){const i=this.value.curr(),o=t.index(),s=t.bisect(t.range),a=t.bisect(e),l=a[0],u=a[1],c=s[0],h=s[1],f=t.one;let d,p,m;if(l<c)for(d=l,p=Math.min(c,u);d<p;++d)m=o[d],i[m]^=f,n.push(m);else if(l>c)for(d=c,p=Math.min(l,h);d<p;++d)m=o[d],i[m]^=f,r.push(m);if(u>h)for(d=Math.max(l,h),p=u;d<p;++d)m=o[d],i[m]^=f,n.push(m);else if(u<h)for(d=Math.max(c,u),p=h;d<p;++d)m=o[d],i[m]^=f,r.push(m);t.range=e.slice()}}),X5.Definition={type:"ResolveFilter",metadata:{},params:[{name:"ignore",type:"number",required:!0,description:"A bit mask indicating which filters to ignore."},{name:"filter",type:"object",required:!0,description:"Per-tuple filter bitmaps from a CrossFilter transform."}]},UF(X5,dP,{transform(t,e){const n=~(t.ignore||0),r=t.filter,i=r.mask;if(!(i&n))return e.StopPropagation;const o=e.fork(e.ALL),s=r.data(),a=r.curr(),l=r.prev(),u=t=>a[t]&n?null:s[t];return o.filter(o.MOD,u),i&i-1?(o.filter(o.ADD,(t=>{const e=a[t]&n;return!e&&e^l[t]&n?s[t]:null})),o.filter(o.REM,(t=>!(a[t]&n)||l[t]&n?null:s[t]))):(o.filter(o.ADD,u),o.filter(o.REM,(t=>(a[t]&n)===i?s[t]:null))),o.filter(o.SOURCE,(t=>u(t._index)))}});const J5="Literal",K5="CallExpression";function Q5(t){this.type=t}var Z5,t6,e6,n6,r6;Q5.prototype.visit=function(t){let e,n,r;if(t(this))return 1;for(e=function(t){switch(t.type){case"ArrayExpression":return t.elements;case"BinaryExpression":case"LogicalExpression":return[t.left,t.right];case K5:return[t.callee].concat(t.arguments);case"ConditionalExpression":return[t.test,t.consequent,t.alternate];case"MemberExpression":return[t.object,t.property];case"ObjectExpression":return t.properties;case"Property":return[t.key,t.value];case"UnaryExpression":return[t.argument];default:return[]}}(this),n=0,r=e.length;n<r;++n)if(e[n].visit(t))return 1};var i6=1,o6=2,s6=3,a6=4,l6=5,u6=6,c6=7,h6=8;(Z5={})[i6]="Boolean",Z5[o6]="<end>",Z5[s6]="Identifier",Z5[a6]="Keyword",Z5[l6]="Null",Z5[u6]="Numeric",Z5[c6]="Punctuator",Z5[h6]="String",Z5[9]="RegularExpression";var f6="ArrayExpression",d6="BinaryExpression",p6="CallExpression",m6="ConditionalExpression",g6="Identifier",y6="Literal",b6="LogicalExpression",v6="MemberExpression",w6="ObjectExpression",x6="Property",_6="UnaryExpression",k6="Unexpected token %0",S6="Unexpected number",E6="Unexpected string",A6="Unexpected identifier",C6="Unexpected reserved word",D6="Unexpected end of input",M6="Invalid regular expression",O6="Invalid regular expression: missing /",T6="Octal literals are not allowed in strict mode.",I6="Duplicate data property in object literal not allowed in strict mode",N6="ILLEGAL",$6="Disabled.",F6=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0370-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0620-\\u064A\\u066E\\u066F\\u0671-\\u06D3\\u06D5\\u06E5\\u06E6\\u06EE\\u06EF\\u06FA-\\u06FC\\u06FF\\u0710\\u0712-\\u072F\\u074D-\\u07A5\\u07B1\\u07CA-\\u07EA\\u07F4\\u07F5\\u07FA\\u0800-\\u0815\\u081A\\u0824\\u0828\\u0840-\\u0858\\u08A0-\\u08B2\\u0904-\\u0939\\u093D\\u0950\\u0958-\\u0961\\u0971-\\u0980\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BD\\u09CE\\u09DC\\u09DD\\u09DF-\\u09E1\\u09F0\\u09F1\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A59-\\u0A5C\\u0A5E\\u0A72-\\u0A74\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABD\\u0AD0\\u0AE0\\u0AE1\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3D\\u0B5C\\u0B5D\\u0B5F-\\u0B61\\u0B71\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BD0\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D\\u0C58\\u0C59\\u0C60\\u0C61\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBD\\u0CDE\\u0CE0\\u0CE1\\u0CF1\\u0CF2\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D\\u0D4E\\u0D60\\u0D61\\u0D7A-\\u0D7F\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0E01-\\u0E30\\u0E32\\u0E33\\u0E40-\\u0E46\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB0\\u0EB2\\u0EB3\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EDC-\\u0EDF\\u0F00\\u0F40-\\u0F47\\u0F49-\\u0F6C\\u0F88-\\u0F8C\\u1000-\\u102A\\u103F\\u1050-\\u1055\\u105A-\\u105D\\u1061\\u1065\\u1066\\u106E-\\u1070\\u1075-\\u1081\\u108E\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176C\\u176E-\\u1770\\u1780-\\u17B3\\u17D7\\u17DC\\u1820-\\u1877\\u1880-\\u18A8\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1950-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19C1-\\u19C7\\u1A00-\\u1A16\\u1A20-\\u1A54\\u1AA7\\u1B05-\\u1B33\\u1B45-\\u1B4B\\u1B83-\\u1BA0\\u1BAE\\u1BAF\\u1BBA-\\u1BE5\\u1C00-\\u1C23\\u1C4D-\\u1C4F\\u1C5A-\\u1C7D\\u1CE9-\\u1CEC\\u1CEE-\\u1CF1\\u1CF5\\u1CF6\\u1D00-\\u1DBF\\u1E00-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u2071\\u207F\\u2090-\\u209C\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CEE\\u2CF2\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D80-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2E2F\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA61F\\uA62A\\uA62B\\uA640-\\uA66E\\uA67F-\\uA69D\\uA6A0-\\uA6EF\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA801\\uA803-\\uA805\\uA807-\\uA80A\\uA80C-\\uA822\\uA840-\\uA873\\uA882-\\uA8B3\\uA8F2-\\uA8F7\\uA8FB\\uA90A-\\uA925\\uA930-\\uA946\\uA960-\\uA97C\\uA984-\\uA9B2\\uA9CF\\uA9E0-\\uA9E4\\uA9E6-\\uA9EF\\uA9FA-\\uA9FE\\uAA00-\\uAA28\\uAA40-\\uAA42\\uAA44-\\uAA4B\\uAA60-\\uAA76\\uAA7A\\uAA7E-\\uAAAF\\uAAB1\\uAAB5\\uAAB6\\uAAB9-\\uAABD\\uAAC0\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEA\\uAAF2-\\uAAF4\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABE2\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D\\uFB1F-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF21-\\uFF3A\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]"),L6=new RegExp("[\\xAA\\xB5\\xBA\\xC0-\\xD6\\xD8-\\xF6\\xF8-\\u02C1\\u02C6-\\u02D1\\u02E0-\\u02E4\\u02EC\\u02EE\\u0300-\\u0374\\u0376\\u0377\\u037A-\\u037D\\u037F\\u0386\\u0388-\\u038A\\u038C\\u038E-\\u03A1\\u03A3-\\u03F5\\u03F7-\\u0481\\u0483-\\u0487\\u048A-\\u052F\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u0591-\\u05BD\\u05BF\\u05C1\\u05C2\\u05C4\\u05C5\\u05C7\\u05D0-\\u05EA\\u05F0-\\u05F2\\u0610-\\u061A\\u0620-\\u0669\\u066E-\\u06D3\\u06D5-\\u06DC\\u06DF-\\u06E8\\u06EA-\\u06FC\\u06FF\\u0710-\\u074A\\u074D-\\u07B1\\u07C0-\\u07F5\\u07FA\\u0800-\\u082D\\u0840-\\u085B\\u08A0-\\u08B2\\u08E4-\\u0963\\u0966-\\u096F\\u0971-\\u0983\\u0985-\\u098C\\u098F\\u0990\\u0993-\\u09A8\\u09AA-\\u09B0\\u09B2\\u09B6-\\u09B9\\u09BC-\\u09C4\\u09C7\\u09C8\\u09CB-\\u09CE\\u09D7\\u09DC\\u09DD\\u09DF-\\u09E3\\u09E6-\\u09F1\\u0A01-\\u0A03\\u0A05-\\u0A0A\\u0A0F\\u0A10\\u0A13-\\u0A28\\u0A2A-\\u0A30\\u0A32\\u0A33\\u0A35\\u0A36\\u0A38\\u0A39\\u0A3C\\u0A3E-\\u0A42\\u0A47\\u0A48\\u0A4B-\\u0A4D\\u0A51\\u0A59-\\u0A5C\\u0A5E\\u0A66-\\u0A75\\u0A81-\\u0A83\\u0A85-\\u0A8D\\u0A8F-\\u0A91\\u0A93-\\u0AA8\\u0AAA-\\u0AB0\\u0AB2\\u0AB3\\u0AB5-\\u0AB9\\u0ABC-\\u0AC5\\u0AC7-\\u0AC9\\u0ACB-\\u0ACD\\u0AD0\\u0AE0-\\u0AE3\\u0AE6-\\u0AEF\\u0B01-\\u0B03\\u0B05-\\u0B0C\\u0B0F\\u0B10\\u0B13-\\u0B28\\u0B2A-\\u0B30\\u0B32\\u0B33\\u0B35-\\u0B39\\u0B3C-\\u0B44\\u0B47\\u0B48\\u0B4B-\\u0B4D\\u0B56\\u0B57\\u0B5C\\u0B5D\\u0B5F-\\u0B63\\u0B66-\\u0B6F\\u0B71\\u0B82\\u0B83\\u0B85-\\u0B8A\\u0B8E-\\u0B90\\u0B92-\\u0B95\\u0B99\\u0B9A\\u0B9C\\u0B9E\\u0B9F\\u0BA3\\u0BA4\\u0BA8-\\u0BAA\\u0BAE-\\u0BB9\\u0BBE-\\u0BC2\\u0BC6-\\u0BC8\\u0BCA-\\u0BCD\\u0BD0\\u0BD7\\u0BE6-\\u0BEF\\u0C00-\\u0C03\\u0C05-\\u0C0C\\u0C0E-\\u0C10\\u0C12-\\u0C28\\u0C2A-\\u0C39\\u0C3D-\\u0C44\\u0C46-\\u0C48\\u0C4A-\\u0C4D\\u0C55\\u0C56\\u0C58\\u0C59\\u0C60-\\u0C63\\u0C66-\\u0C6F\\u0C81-\\u0C83\\u0C85-\\u0C8C\\u0C8E-\\u0C90\\u0C92-\\u0CA8\\u0CAA-\\u0CB3\\u0CB5-\\u0CB9\\u0CBC-\\u0CC4\\u0CC6-\\u0CC8\\u0CCA-\\u0CCD\\u0CD5\\u0CD6\\u0CDE\\u0CE0-\\u0CE3\\u0CE6-\\u0CEF\\u0CF1\\u0CF2\\u0D01-\\u0D03\\u0D05-\\u0D0C\\u0D0E-\\u0D10\\u0D12-\\u0D3A\\u0D3D-\\u0D44\\u0D46-\\u0D48\\u0D4A-\\u0D4E\\u0D57\\u0D60-\\u0D63\\u0D66-\\u0D6F\\u0D7A-\\u0D7F\\u0D82\\u0D83\\u0D85-\\u0D96\\u0D9A-\\u0DB1\\u0DB3-\\u0DBB\\u0DBD\\u0DC0-\\u0DC6\\u0DCA\\u0DCF-\\u0DD4\\u0DD6\\u0DD8-\\u0DDF\\u0DE6-\\u0DEF\\u0DF2\\u0DF3\\u0E01-\\u0E3A\\u0E40-\\u0E4E\\u0E50-\\u0E59\\u0E81\\u0E82\\u0E84\\u0E87\\u0E88\\u0E8A\\u0E8D\\u0E94-\\u0E97\\u0E99-\\u0E9F\\u0EA1-\\u0EA3\\u0EA5\\u0EA7\\u0EAA\\u0EAB\\u0EAD-\\u0EB9\\u0EBB-\\u0EBD\\u0EC0-\\u0EC4\\u0EC6\\u0EC8-\\u0ECD\\u0ED0-\\u0ED9\\u0EDC-\\u0EDF\\u0F00\\u0F18\\u0F19\\u0F20-\\u0F29\\u0F35\\u0F37\\u0F39\\u0F3E-\\u0F47\\u0F49-\\u0F6C\\u0F71-\\u0F84\\u0F86-\\u0F97\\u0F99-\\u0FBC\\u0FC6\\u1000-\\u1049\\u1050-\\u109D\\u10A0-\\u10C5\\u10C7\\u10CD\\u10D0-\\u10FA\\u10FC-\\u1248\\u124A-\\u124D\\u1250-\\u1256\\u1258\\u125A-\\u125D\\u1260-\\u1288\\u128A-\\u128D\\u1290-\\u12B0\\u12B2-\\u12B5\\u12B8-\\u12BE\\u12C0\\u12C2-\\u12C5\\u12C8-\\u12D6\\u12D8-\\u1310\\u1312-\\u1315\\u1318-\\u135A\\u135D-\\u135F\\u1380-\\u138F\\u13A0-\\u13F4\\u1401-\\u166C\\u166F-\\u167F\\u1681-\\u169A\\u16A0-\\u16EA\\u16EE-\\u16F8\\u1700-\\u170C\\u170E-\\u1714\\u1720-\\u1734\\u1740-\\u1753\\u1760-\\u176C\\u176E-\\u1770\\u1772\\u1773\\u1780-\\u17D3\\u17D7\\u17DC\\u17DD\\u17E0-\\u17E9\\u180B-\\u180D\\u1810-\\u1819\\u1820-\\u1877\\u1880-\\u18AA\\u18B0-\\u18F5\\u1900-\\u191E\\u1920-\\u192B\\u1930-\\u193B\\u1946-\\u196D\\u1970-\\u1974\\u1980-\\u19AB\\u19B0-\\u19C9\\u19D0-\\u19D9\\u1A00-\\u1A1B\\u1A20-\\u1A5E\\u1A60-\\u1A7C\\u1A7F-\\u1A89\\u1A90-\\u1A99\\u1AA7\\u1AB0-\\u1ABD\\u1B00-\\u1B4B\\u1B50-\\u1B59\\u1B6B-\\u1B73\\u1B80-\\u1BF3\\u1C00-\\u1C37\\u1C40-\\u1C49\\u1C4D-\\u1C7D\\u1CD0-\\u1CD2\\u1CD4-\\u1CF6\\u1CF8\\u1CF9\\u1D00-\\u1DF5\\u1DFC-\\u1F15\\u1F18-\\u1F1D\\u1F20-\\u1F45\\u1F48-\\u1F4D\\u1F50-\\u1F57\\u1F59\\u1F5B\\u1F5D\\u1F5F-\\u1F7D\\u1F80-\\u1FB4\\u1FB6-\\u1FBC\\u1FBE\\u1FC2-\\u1FC4\\u1FC6-\\u1FCC\\u1FD0-\\u1FD3\\u1FD6-\\u1FDB\\u1FE0-\\u1FEC\\u1FF2-\\u1FF4\\u1FF6-\\u1FFC\\u200C\\u200D\\u203F\\u2040\\u2054\\u2071\\u207F\\u2090-\\u209C\\u20D0-\\u20DC\\u20E1\\u20E5-\\u20F0\\u2102\\u2107\\u210A-\\u2113\\u2115\\u2119-\\u211D\\u2124\\u2126\\u2128\\u212A-\\u212D\\u212F-\\u2139\\u213C-\\u213F\\u2145-\\u2149\\u214E\\u2160-\\u2188\\u2C00-\\u2C2E\\u2C30-\\u2C5E\\u2C60-\\u2CE4\\u2CEB-\\u2CF3\\u2D00-\\u2D25\\u2D27\\u2D2D\\u2D30-\\u2D67\\u2D6F\\u2D7F-\\u2D96\\u2DA0-\\u2DA6\\u2DA8-\\u2DAE\\u2DB0-\\u2DB6\\u2DB8-\\u2DBE\\u2DC0-\\u2DC6\\u2DC8-\\u2DCE\\u2DD0-\\u2DD6\\u2DD8-\\u2DDE\\u2DE0-\\u2DFF\\u2E2F\\u3005-\\u3007\\u3021-\\u302F\\u3031-\\u3035\\u3038-\\u303C\\u3041-\\u3096\\u3099\\u309A\\u309D-\\u309F\\u30A1-\\u30FA\\u30FC-\\u30FF\\u3105-\\u312D\\u3131-\\u318E\\u31A0-\\u31BA\\u31F0-\\u31FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uA000-\\uA48C\\uA4D0-\\uA4FD\\uA500-\\uA60C\\uA610-\\uA62B\\uA640-\\uA66F\\uA674-\\uA67D\\uA67F-\\uA69D\\uA69F-\\uA6F1\\uA717-\\uA71F\\uA722-\\uA788\\uA78B-\\uA78E\\uA790-\\uA7AD\\uA7B0\\uA7B1\\uA7F7-\\uA827\\uA840-\\uA873\\uA880-\\uA8C4\\uA8D0-\\uA8D9\\uA8E0-\\uA8F7\\uA8FB\\uA900-\\uA92D\\uA930-\\uA953\\uA960-\\uA97C\\uA980-\\uA9C0\\uA9CF-\\uA9D9\\uA9E0-\\uA9FE\\uAA00-\\uAA36\\uAA40-\\uAA4D\\uAA50-\\uAA59\\uAA60-\\uAA76\\uAA7A-\\uAAC2\\uAADB-\\uAADD\\uAAE0-\\uAAEF\\uAAF2-\\uAAF6\\uAB01-\\uAB06\\uAB09-\\uAB0E\\uAB11-\\uAB16\\uAB20-\\uAB26\\uAB28-\\uAB2E\\uAB30-\\uAB5A\\uAB5C-\\uAB5F\\uAB64\\uAB65\\uABC0-\\uABEA\\uABEC\\uABED\\uABF0-\\uABF9\\uAC00-\\uD7A3\\uD7B0-\\uD7C6\\uD7CB-\\uD7FB\\uF900-\\uFA6D\\uFA70-\\uFAD9\\uFB00-\\uFB06\\uFB13-\\uFB17\\uFB1D-\\uFB28\\uFB2A-\\uFB36\\uFB38-\\uFB3C\\uFB3E\\uFB40\\uFB41\\uFB43\\uFB44\\uFB46-\\uFBB1\\uFBD3-\\uFD3D\\uFD50-\\uFD8F\\uFD92-\\uFDC7\\uFDF0-\\uFDFB\\uFE00-\\uFE0F\\uFE20-\\uFE2D\\uFE33\\uFE34\\uFE4D-\\uFE4F\\uFE70-\\uFE74\\uFE76-\\uFEFC\\uFF10-\\uFF19\\uFF21-\\uFF3A\\uFF3F\\uFF41-\\uFF5A\\uFF66-\\uFFBE\\uFFC2-\\uFFC7\\uFFCA-\\uFFCF\\uFFD2-\\uFFD7\\uFFDA-\\uFFDC]");function B6(t,e){if(!t)throw new Error("ASSERT: "+e)}function R6(t){return t>=48&&t<=57}function P6(t){return"0123456789abcdefABCDEF".indexOf(t)>=0}function z6(t){return"01234567".indexOf(t)>=0}function j6(t){return 32===t||9===t||11===t||12===t||160===t||t>=5760&&[5760,6158,8192,8193,8194,8195,8196,8197,8198,8199,8200,8201,8202,8239,8287,12288,65279].indexOf(t)>=0}function U6(t){return 10===t||13===t||8232===t||8233===t}function V6(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||92===t||t>=128&&F6.test(String.fromCharCode(t))}function q6(t){return 36===t||95===t||t>=65&&t<=90||t>=97&&t<=122||t>=48&&t<=57||92===t||t>=128&&L6.test(String.fromCharCode(t))}const W6={if:1,in:1,do:1,var:1,for:1,new:1,try:1,let:1,this:1,else:1,case:1,void:1,with:1,enum:1,while:1,break:1,catch:1,throw:1,const:1,yield:1,class:1,super:1,return:1,typeof:1,delete:1,switch:1,export:1,import:1,public:1,static:1,default:1,finally:1,extends:1,package:1,private:1,function:1,continue:1,debugger:1,interface:1,protected:1,instanceof:1,implements:1};function H6(){for(;e6<n6;){const t=t6.charCodeAt(e6);if(!j6(t)&&!U6(t))break;++e6}}function G6(t){var e,n,r,i=0;for(n="u"===t?4:2,e=0;e<n;++e)e6<n6&&P6(t6[e6])?(r=t6[e6++],i=16*i+"0123456789abcdef".indexOf(r.toLowerCase())):a8({},k6,N6);return String.fromCharCode(i)}function Y6(){var t,e,n,r;for(e=0,"}"===(t=t6[e6])&&a8({},k6,N6);e6<n6&&P6(t=t6[e6++]);)e=16*e+"0123456789abcdef".indexOf(t.toLowerCase());return(e>1114111||"}"!==t)&&a8({},k6,N6),e<=65535?String.fromCharCode(e):(n=55296+(e-65536>>10),r=56320+(e-65536&1023),String.fromCharCode(n,r))}function X6(){var t,e;for(t=t6.charCodeAt(e6++),e=String.fromCharCode(t),92===t&&(117!==t6.charCodeAt(e6)&&a8({},k6,N6),++e6,(t=G6("u"))&&"\\"!==t&&V6(t.charCodeAt(0))||a8({},k6,N6),e=t);e6<n6&&q6(t=t6.charCodeAt(e6));)++e6,e+=String.fromCharCode(t),92===t&&(e=e.substr(0,e.length-1),117!==t6.charCodeAt(e6)&&a8({},k6,N6),++e6,(t=G6("u"))&&"\\"!==t&&q6(t.charCodeAt(0))||a8({},k6,N6),e+=t);return e}function J6(){var t,e,n,r,i=e6,o=t6.charCodeAt(e6),s=t6[e6];switch(o){case 46:case 40:case 41:case 59:case 44:case 123:case 125:case 91:case 93:case 58:case 63:case 126:return++e6,{type:c6,value:String.fromCharCode(o),start:i,end:e6};default:if(61===(t=t6.charCodeAt(e6+1)))switch(o){case 43:case 45:case 47:case 60:case 62:case 94:case 124:case 37:case 38:case 42:return e6+=2,{type:c6,value:String.fromCharCode(o)+String.fromCharCode(t),start:i,end:e6};case 33:case 61:return e6+=2,61===t6.charCodeAt(e6)&&++e6,{type:c6,value:t6.slice(i,e6),start:i,end:e6}}}return">>>="===(r=t6.substr(e6,4))?{type:c6,value:r,start:i,end:e6+=4}:">>>"===(n=r.substr(0,3))||"<<="===n||">>="===n?{type:c6,value:n,start:i,end:e6+=3}:s===(e=n.substr(0,2))[1]&&"+-<>&|".indexOf(s)>=0||"=>"===e?{type:c6,value:e,start:i,end:e6+=2}:("//"===e&&a8({},k6,N6),"<>=!+-*%&|^/".indexOf(s)>=0?(++e6,{type:c6,value:s,start:i,end:e6}):void a8({},k6,N6))}function K6(){var t,e,n;if(B6(R6((n=t6[e6]).charCodeAt(0))||"."===n,"Numeric literal must start with a decimal digit or a decimal point"),e=e6,t="","."!==n){if(t=t6[e6++],n=t6[e6],"0"===t){if("x"===n||"X"===n)return++e6,function(t){let e="";for(;e6<n6&&P6(t6[e6]);)e+=t6[e6++];return 0===e.length&&a8({},k6,N6),V6(t6.charCodeAt(e6))&&a8({},k6,N6),{type:u6,value:parseInt("0x"+e,16),start:t,end:e6}}(e);if(z6(n))return function(t){let e="0"+t6[e6++];for(;e6<n6&&z6(t6[e6]);)e+=t6[e6++];return(V6(t6.charCodeAt(e6))||R6(t6.charCodeAt(e6)))&&a8({},k6,N6),{type:u6,value:parseInt(e,8),octal:!0,start:t,end:e6}}(e);n&&R6(n.charCodeAt(0))&&a8({},k6,N6)}for(;R6(t6.charCodeAt(e6));)t+=t6[e6++];n=t6[e6]}if("."===n){for(t+=t6[e6++];R6(t6.charCodeAt(e6));)t+=t6[e6++];n=t6[e6]}if("e"===n||"E"===n)if(t+=t6[e6++],"+"!==(n=t6[e6])&&"-"!==n||(t+=t6[e6++]),R6(t6.charCodeAt(e6)))for(;R6(t6.charCodeAt(e6));)t+=t6[e6++];else a8({},k6,N6);return V6(t6.charCodeAt(e6))&&a8({},k6,N6),{type:u6,value:parseFloat(t),start:e,end:e6}}function Q6(){if(H6(),e6>=n6)return{type:o6,start:e6,end:e6};const t=t6.charCodeAt(e6);return V6(t)?function(){var t,e;return t=e6,e=92===t6.charCodeAt(e6)?X6():function(){var t,e;for(t=e6++;e6<n6;){if(92===(e=t6.charCodeAt(e6)))return e6=t,X6();if(!q6(e))break;++e6}return t6.slice(t,e6)}(),{type:1===e.length?s6:W6.hasOwnProperty(e)?a6:"null"===e?l6:"true"===e||"false"===e?i6:s6,value:e,start:t,end:e6}}():40===t||41===t||59===t?J6():39===t||34===t?function(){var t,e,n,r,i="",o=!1;for(B6("'"===(t=t6[e6])||'"'===t,"String literal must starts with a quote"),e=e6,++e6;e6<n6;){if((n=t6[e6++])===t){t="";break}if("\\"===n)if((n=t6[e6++])&&U6(n.charCodeAt(0)))"\r"===n&&"\n"===t6[e6]&&++e6;else switch(n){case"u":case"x":"{"===t6[e6]?(++e6,i+=Y6()):i+=G6(n);break;case"n":i+="\n";break;case"r":i+="\r";break;case"t":i+="\t";break;case"b":i+="\b";break;case"f":i+="\f";break;case"v":i+="\v";break;default:z6(n)?(0!==(r="01234567".indexOf(n))&&(o=!0),e6<n6&&z6(t6[e6])&&(o=!0,r=8*r+"01234567".indexOf(t6[e6++]),"0123".indexOf(n)>=0&&e6<n6&&z6(t6[e6])&&(r=8*r+"01234567".indexOf(t6[e6++]))),i+=String.fromCharCode(r)):i+=n}else{if(U6(n.charCodeAt(0)))break;i+=n}}return""!==t&&a8({},k6,N6),{type:h6,value:i,octal:o,start:e,end:e6}}():46===t?R6(t6.charCodeAt(e6+1))?K6():J6():R6(t)?K6():J6()}function Z6(){const t=r6;return e6=t.end,r6=Q6(),e6=t.end,t}function t8(){const t=e6;r6=Q6(),e6=t}function e8(t,e,n){const r=new Q5("||"===t||"&&"===t?b6:d6);return r.operator=t,r.left=e,r.right=n,r}function n8(t,e){const n=new Q5(p6);return n.callee=t,n.arguments=e,n}function r8(t){const e=new Q5(g6);return e.name=t,e}function i8(t){const e=new Q5(y6);return e.value=t.value,e.raw=t6.slice(t.start,t.end),t.regex&&("//"===e.raw&&(e.raw="/(?:)/"),e.regex=t.regex),e}function o8(t,e,n){const r=new Q5(v6);return r.computed="["===t,r.object=e,r.property=n,r.computed||(n.member=!0),r}function s8(t,e,n){const r=new Q5(x6);return r.key=e,r.value=n,r.kind=t,r}function a8(t,e){var n,r=Array.prototype.slice.call(arguments,2),i=e.replace(/%(\d)/g,((t,e)=>(B6(e<r.length,"Message reference must be in range"),r[e])));throw(n=new Error(i)).index=e6,n.description=i,n}function l8(t){t.type===o6&&a8(t,D6),t.type===u6&&a8(t,S6),t.type===h6&&a8(t,E6),t.type===s6&&a8(t,A6),t.type===a6&&a8(t,C6),a8(t,k6,t.value)}function u8(t){const e=Z6();e.type===c6&&e.value===t||l8(e)}function c8(t){return r6.type===c6&&r6.value===t}function h8(t){return r6.type===a6&&r6.value===t}function f8(){e6=r6.start;const t=Z6();return t.type===h6||t.type===u6?(t.octal&&a8(t,T6),i8(t)):r8(t.value)}function d8(){var t,e,n;return e6=r6.start,(t=r6).type===s6?(n=f8(),u8(":"),s8("init",n,_8())):t.type!==o6&&t.type!==c6?(e=f8(),u8(":"),s8("init",e,_8())):void l8(t)}const p8={if:1};function m8(){var t,e,n;if(c8("("))return function(){u8("(");const t=k8();return u8(")"),t}();if(c8("["))return function(){const t=[];for(e6=r6.start,u8("[");!c8("]");)c8(",")?(Z6(),t.push(null)):(t.push(_8()),c8("]")||u8(","));return Z6(),function(t){const e=new Q5(f6);return e.elements=t,e}(t)}();if(c8("{"))return function(){var t,e,n=[],r={},i=String;for(e6=r6.start,u8("{");!c8("}");)e="$"+((t=d8()).key.type===g6?t.key.name:i(t.key.value)),Object.prototype.hasOwnProperty.call(r,e)?a8({},I6):r[e]=!0,n.push(t),c8("}")||u8(",");return u8("}"),function(t){const e=new Q5(w6);return e.properties=t,e}(n)}();if(t=r6.type,e6=r6.start,t===s6||p8[r6.value])n=r8(Z6().value);else if(t===h6||t===u6)r6.octal&&a8(r6,T6),n=i8(Z6());else{if(t===a6)throw new Error($6);t===i6?((e=Z6()).value="true"===e.value,n=i8(e)):t===l6?((e=Z6()).value=null,n=i8(e)):c8("/")||c8("/=")?(n=i8(function(){var t,e,n,r;return r6=null,H6(),t=e6,e=function(){var t,e,n,r;for(B6("/"===(t=t6[e6]),"Regular expression literal must start with a slash"),e=t6[e6++],n=!1,r=!1;e6<n6;)if(e+=t=t6[e6++],"\\"===t)U6((t=t6[e6++]).charCodeAt(0))&&a8({},O6),e+=t;else if(U6(t.charCodeAt(0)))a8({},O6);else if(n)"]"===t&&(n=!1);else{if("/"===t){r=!0;break}"["===t&&(n=!0)}return r||a8({},O6),{value:e.substr(1,e.length-2),literal:e}}(),n=function(){var t,e,n;for(e="",n="";e6<n6&&q6((t=t6[e6]).charCodeAt(0));)++e6,"\\"===t&&e6<n6?a8({},k6,N6):(n+=t,e+=t);return n.search(/[^gimuy]/g)>=0&&a8({},M6,n),{value:n,literal:e}}(),r=function(t,e){let n=t;e.indexOf("u")>=0&&(n=n.replace(/\\u\{([0-9a-fA-F]+)\}/g,((t,e)=>{if(parseInt(e,16)<=1114111)return"x";a8({},M6)})).replace(/[\uD800-\uDBFF][\uDC00-\uDFFF]/g,"x"));try{new RegExp(n)}catch(t){a8({},M6)}try{return new RegExp(t,e)}catch(t){return null}}(e.value,n.value),{literal:e.literal+n.literal,value:r,regex:{pattern:e.value,flags:n.value},start:t,end:e6}}()),t8()):l8(Z6())}return n}function g8(){const t=[];if(u8("("),!c8(")"))for(;e6<n6&&(t.push(_8()),!c8(")"));)u8(",");return u8(")"),t}function y8(){e6=r6.start;const t=Z6();return function(t){return t.type===s6||t.type===a6||t.type===i6||t.type===l6}(t)||l8(t),r8(t.value)}function b8(){u8("[");const t=k8();return u8("]"),t}function v8(){const t=function(){var t;for(t=m8();;)if(c8("."))u8("."),t=o8(".",t,y8());else if(c8("("))t=n8(t,g8());else{if(!c8("["))break;t=o8("[",t,b8())}return t}();if(r6.type===c6&&(c8("++")||c8("--")))throw new Error($6);return t}function w8(){var t,e;if(r6.type!==c6&&r6.type!==a6)e=v8();else{if(c8("++")||c8("--"))throw new Error($6);if(c8("+")||c8("-")||c8("~")||c8("!"))t=Z6(),e=w8(),e=function(t,e){const n=new Q5(_6);return n.operator=t,n.argument=e,n.prefix=!0,n}(t.value,e);else{if(h8("delete")||h8("void")||h8("typeof"))throw new Error($6);e=v8()}}return e}function x8(t){let e=0;if(t.type!==c6&&t.type!==a6)return 0;switch(t.value){case"||":e=1;break;case"&&":e=2;break;case"|":e=3;break;case"^":e=4;break;case"&":e=5;break;case"==":case"!=":case"===":case"!==":e=6;break;case"<":case">":case"<=":case">=":case"instanceof":case"in":e=7;break;case"<<":case">>":case">>>":e=8;break;case"+":case"-":e=9;break;case"*":case"/":case"%":e=11}return e}function _8(){var t,e;return t=function(){var t,e,n,r,i,o,s,a,l,u;if(t=r6,l=w8(),0===(i=x8(r=r6)))return l;for(r.prec=i,Z6(),e=[t,r6],o=[l,r,s=w8()];(i=x8(r6))>0;){for(;o.length>2&&i<=o[o.length-2].prec;)s=o.pop(),a=o.pop().value,l=o.pop(),e.pop(),n=e8(a,l,s),o.push(n);(r=Z6()).prec=i,o.push(r),e.push(r6),n=w8(),o.push(n)}for(n=o[u=o.length-1],e.pop();u>1;)e.pop(),n=e8(o[u-1].value,o[u-2],n),u-=2;return n}(),c8("?")&&(Z6(),e=_8(),u8(":"),t=function(t,e,n){const r=new Q5(m6);return r.test=t,r.consequent=e,r.alternate=n,r}(t,e,_8())),t}function k8(){const t=_8();if(c8(","))throw new Error($6);return t}function S8(t){e6=0,n6=(t6=t).length,r6=null,t8();const e=k8();if(r6.type!==o6)throw new Error("Unexpect token after expression.");return e}var E8={NaN:"NaN",E:"Math.E",LN2:"Math.LN2",LN10:"Math.LN10",LOG2E:"Math.LOG2E",LOG10E:"Math.LOG10E",PI:"Math.PI",SQRT1_2:"Math.SQRT1_2",SQRT2:"Math.SQRT2",MIN_VALUE:"Number.MIN_VALUE",MAX_VALUE:"Number.MAX_VALUE"};function A8(t){function e(e,n,r){return i=>function(e,n,r,i){let o=t(n[0]);return r&&(o=r+"("+o+")",0===r.lastIndexOf("new ",0)&&(o="("+o+")")),o+"."+e+(i<0?"":0===i?"()":"("+n.slice(1).map(t).join(",")+")")}(e,i,n,r)}const n="new Date",r="String",i="RegExp";return{isNaN:"Number.isNaN",isFinite:"Number.isFinite",abs:"Math.abs",acos:"Math.acos",asin:"Math.asin",atan:"Math.atan",atan2:"Math.atan2",ceil:"Math.ceil",cos:"Math.cos",exp:"Math.exp",floor:"Math.floor",hypot:"Math.hypot",log:"Math.log",max:"Math.max",min:"Math.min",pow:"Math.pow",random:"Math.random",round:"Math.round",sin:"Math.sin",sqrt:"Math.sqrt",tan:"Math.tan",clamp:function(e){e.length<3&&L$("Missing arguments to clamp function."),e.length>3&&L$("Too many arguments to clamp function.");const n=e.map(t);return"Math.max("+n[1]+", Math.min("+n[2]+","+n[0]+"))"},now:"Date.now",utc:"Date.UTC",datetime:n,date:e("getDate",n,0),day:e("getDay",n,0),year:e("getFullYear",n,0),month:e("getMonth",n,0),hours:e("getHours",n,0),minutes:e("getMinutes",n,0),seconds:e("getSeconds",n,0),milliseconds:e("getMilliseconds",n,0),time:e("getTime",n,0),timezoneoffset:e("getTimezoneOffset",n,0),utcdate:e("getUTCDate",n,0),utcday:e("getUTCDay",n,0),utcyear:e("getUTCFullYear",n,0),utcmonth:e("getUTCMonth",n,0),utchours:e("getUTCHours",n,0),utcminutes:e("getUTCMinutes",n,0),utcseconds:e("getUTCSeconds",n,0),utcmilliseconds:e("getUTCMilliseconds",n,0),length:e("length",null,-1),parseFloat:"parseFloat",parseInt:"parseInt",upper:e("toUpperCase",r,0),lower:e("toLowerCase",r,0),substring:e("substring",r),split:e("split",r),trim:e("trim",r,0),regexp:i,test:e("test",i),if:function(e){e.length<3&&L$("Missing arguments to if function."),e.length>3&&L$("Too many arguments to if function.");const n=e.map(t);return"("+n[0]+"?"+n[1]+":"+n[2]+")"}}}function C8(t){const e=(t=t||{}).allowed?uL(t.allowed):{},n=t.forbidden?uL(t.forbidden):{},r=t.constants||E8,i=(t.functions||A8)(h),o=t.globalvar,s=t.fieldvar,a=EF(o)?o:t=>`${o}["${t}"]`;let l={},u={},c=0;function h(t){if(XF(t))return t;const e=f[t.type];return null==e&&L$("Unsupported type: "+t.type),e(t)}const f={Literal:t=>t.raw,Identifier:t=>{const i=t.name;return c>0?i:RF(n,i)?L$("Illegal identifier: "+i):RF(r,i)?r[i]:RF(e,i)?i:(l[i]=1,a(i))},MemberExpression:t=>{const e=!t.computed,n=h(t.object);e&&(c+=1);const r=h(t.property);return n===s&&(u[function(t){const e=t&&t.length-1;return e&&('"'===t[0]&&'"'===t[e]||"'"===t[0]&&"'"===t[e])?t.slice(1,-1):t}(r)]=1),e&&(c-=1),n+(e?"."+r:"["+r+"]")},CallExpression:t=>{"Identifier"!==t.callee.type&&L$("Illegal callee type: "+t.callee.type);const e=t.callee.name,n=t.arguments,r=RF(i,e)&&i[e];return r||L$("Unrecognized function: "+e),EF(r)?r(n):r+"("+n.map(h).join(",")+")"},ArrayExpression:t=>"["+t.elements.map(h).join(",")+"]",BinaryExpression:t=>"("+h(t.left)+" "+t.operator+" "+h(t.right)+")",UnaryExpression:t=>"("+t.operator+h(t.argument)+")",ConditionalExpression:t=>"("+h(t.test)+"?"+h(t.consequent)+":"+h(t.alternate)+")",LogicalExpression:t=>"("+h(t.left)+t.operator+h(t.right)+")",ObjectExpression:t=>"{"+t.properties.map(h).join(",")+"}",Property:t=>{c+=1;const e=h(t.key);return c-=1,e+":"+h(t.value)}};function d(t){const e={code:h(t),globals:Object.keys(l),fields:Object.keys(u)};return l={},u={},e}return d.functions=i,d.constants=r,d}var D8,M8,O8,T8,I8,N8,$8,F8,L8,B8,R8,P8,z8,j8,U8,V8,q8=new QQ,W8=new QQ,H8={point:_Z,lineStart:_Z,lineEnd:_Z,polygonStart:function(){q8=new QQ,H8.lineStart=G8,H8.lineEnd=Y8},polygonEnd:function(){var t=+q8;W8.add(t<0?iZ+t:t),this.lineStart=this.lineEnd=this.point=_Z},sphere:function(){W8.add(iZ)}};function G8(){H8.point=X8}function Y8(){J8(D8,M8)}function X8(t,e){H8.point=J8,D8=t,M8=e,O8=t*=sZ,T8=cZ(e=(e*=sZ)/2+rZ),I8=gZ(e)}function J8(t,e){var n=(t*=sZ)-O8,r=n>=0?1:-1,i=r*n,o=cZ(e=(e*=sZ)/2+rZ),s=gZ(e),a=I8*s,l=T8*o+a*cZ(i),u=a*r*gZ(i);q8.add(uZ(u,l)),O8=t,T8=o,I8=s}var K8,Q8,Z8,t9,e9,n9,r9,i9,o9,s9,a9,l9,u9,c9,h9,f9,d9={point:p9,lineStart:g9,lineEnd:y9,polygonStart:function(){d9.point=b9,d9.lineStart=v9,d9.lineEnd=w9,j8=new QQ,H8.polygonStart()},polygonEnd:function(){H8.polygonEnd(),d9.point=p9,d9.lineStart=g9,d9.lineEnd=y9,q8<0?(N8=-(F8=180),$8=-(L8=90)):j8>ZQ?L8=90:j8<-ZQ&&($8=-90),V8[0]=N8,V8[1]=F8},sphere:function(){N8=-(F8=180),$8=-(L8=90)}};function p9(t,e){U8.push(V8=[N8=t,F8=t]),e<$8&&($8=e),e>L8&&(L8=e)}function m9(t,e){var n=F0([t*sZ,e*sZ]);if(z8){var r=B0(z8,n),i=B0([r[1],-r[0],0],r);z0(i),i=$0(i);var o,s=t-B8,a=s>0?1:-1,l=i[0]*oZ*a,u=aZ(s)>180;u^(a*B8<l&&l<a*t)?(o=i[1]*oZ)>L8&&(L8=o):u^(a*B8<(l=(l+360)%360-180)&&l<a*t)?(o=-i[1]*oZ)<$8&&($8=o):(e<$8&&($8=e),e>L8&&(L8=e)),u?t<B8?x9(N8,t)>x9(N8,F8)&&(F8=t):x9(t,F8)>x9(N8,F8)&&(N8=t):F8>=N8?(t<N8&&(N8=t),t>F8&&(F8=t)):t>B8?x9(N8,t)>x9(N8,F8)&&(F8=t):x9(t,F8)>x9(N8,F8)&&(N8=t)}else U8.push(V8=[N8=t,F8=t]);e<$8&&($8=e),e>L8&&(L8=e),z8=n,B8=t}function g9(){d9.point=m9}function y9(){V8[0]=N8,V8[1]=F8,d9.point=p9,z8=null}function b9(t,e){if(z8){var n=t-B8;j8.add(aZ(n)>180?n+(n>0?360:-360):n)}else R8=t,P8=e;H8.point(t,e),m9(t,e)}function v9(){H8.lineStart()}function w9(){b9(R8,P8),H8.lineEnd(),aZ(j8)>ZQ&&(N8=-(F8=180)),V8[0]=N8,V8[1]=F8,z8=null}function x9(t,e){return(e-=t)<0?e+360:e}function _9(t,e){return t[0]-e[0]}function k9(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var S9={sphere:_Z,point:E9,lineStart:C9,lineEnd:O9,polygonStart:function(){S9.lineStart=T9,S9.lineEnd=I9},polygonEnd:function(){S9.lineStart=C9,S9.lineEnd=O9}};function E9(t,e){t*=sZ;var n=cZ(e*=sZ);A9(n*cZ(t),n*gZ(t),gZ(e))}function A9(t,e,n){++K8,Z8+=(t-Z8)/K8,t9+=(e-t9)/K8,e9+=(n-e9)/K8}function C9(){S9.point=D9}function D9(t,e){t*=sZ;var n=cZ(e*=sZ);c9=n*cZ(t),h9=n*gZ(t),f9=gZ(e),S9.point=M9,A9(c9,h9,f9)}function M9(t,e){t*=sZ;var n=cZ(e*=sZ),r=n*cZ(t),i=n*gZ(t),o=gZ(e),s=uZ(bZ((s=h9*o-f9*i)*s+(s=f9*r-c9*o)*s+(s=c9*i-h9*r)*s),c9*r+h9*i+f9*o);Q8+=s,n9+=s*(c9+(c9=r)),r9+=s*(h9+(h9=i)),i9+=s*(f9+(f9=o)),A9(c9,h9,f9)}function O9(){S9.point=E9}function T9(){S9.point=N9}function I9(){$9(l9,u9),S9.point=E9}function N9(t,e){l9=t,u9=e,t*=sZ,e*=sZ,S9.point=$9;var n=cZ(e);c9=n*cZ(t),h9=n*gZ(t),f9=gZ(e),A9(c9,h9,f9)}function $9(t,e){t*=sZ;var n=cZ(e*=sZ),r=n*cZ(t),i=n*gZ(t),o=gZ(e),s=h9*o-f9*i,a=f9*r-c9*o,l=c9*i-h9*r,u=dZ(s,a,l),c=xZ(u),h=u&&-c/u;o9.add(h*s),s9.add(h*a),a9.add(h*l),Q8+=c,n9+=c*(c9+(c9=r)),r9+=c*(h9+(h9=i)),i9+=c*(f9+(f9=o)),A9(c9,h9,f9)}function F9(t){return t instanceof jV?t:new jV(t)}const L9=Symbol("vega_selection_getter");function B9(t){return t.getter&&t.getter[L9]||(t.getter=R$(t.field),t.getter[L9]=!0),t.getter}const R9="intersect",P9="union",z9="or",j9="and",U9="_vgsid_",V9=R$(U9),q9="index:unit";function W9(t,e){for(var n,r,i=e.fields,o=e.values,s=i.length,a=0;a<s;++a)if(WF(n=B9(r=i[a])(t))&&(n=oF(n)),WF(o[a])&&(o[a]=oF(o[a])),Q$(o[a])&&WF(o[a][0])&&(o[a]=o[a].map(oF)),"E"===r.type){if(Q$(o[a])?o[a].indexOf(n)<0:n!==o[a])return!1}else if("R"===r.type){if(!VF(n,o[a]))return!1}else if("R-RE"===r.type){if(!VF(n,o[a],!0,!1))return!1}else if("R-E"===r.type){if(!VF(n,o[a],!1,!1))return!1}else if("R-LE"===r.type&&!VF(n,o[a],!1,!0))return!1;return!0}const H9=BM(V9),G9=H9.left,Y9=H9.right;var X9={[`${U9}_union`]:function(...t){const e=new jV;for(const n of t)for(const t of n)e.add(t);return e},[`${U9}_intersect`]:function(t,...e){t=new jV(t),e=e.map(F9);t:for(const n of t)for(const r of e)if(!r.has(n)){t.delete(n);continue t}return t},E_union:function(t,e){if(!t.length)return e;for(var n=0,r=e.length;n<r;++n)t.indexOf(e[n])<0&&t.push(e[n]);return t},E_intersect:function(t,e){return t.length?t.filter((t=>e.indexOf(t)>=0)):e},R_union:function(t,e){var n=oF(e[0]),r=oF(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?(t[0]>n&&(t[0]=n),t[1]<r&&(t[1]=r),t):[n,r]},R_intersect:function(t,e){var n=oF(e[0]),r=oF(e[1]);return n>r&&(n=e[1],r=e[0]),t.length?r<t[0]||t[1]<n?[]:(t[0]<n&&(t[0]=n),t[1]>r&&(t[1]=r),t):[n,r]}};function J9(t,e,n,r){e[0].type!==J5&&L$("First argument to selection functions must be a string literal.");const i=e[0].value,o="unit",s="@"+o,a=":"+i;(e.length>=2&&iF(e).value)!==R9||RF(r,s)||(r[s]=n.getData(i).indataRef(n,o)),RF(r,a)||(r[a]=n.getData(i).tuplesRef())}function K9(t){const e=this.context.data[t];return e?e.values.value:[]}const Q9=t=>function(e,n){return this.context.dataflow.locale()[t](n)(e)},Z9=Q9("format"),t7=Q9("timeFormat"),e7=Q9("utcFormat"),n7=Q9("timeParse"),r7=Q9("utcParse"),i7=new Date(2e3,0,1);function o7(t,e,n){return Number.isInteger(t)&&Number.isInteger(e)?(i7.setYear(2e3),i7.setMonth(t),i7.setDate(e),t7.call(this,i7,n)):""}const s7="%",a7="$";function l7(t,e,n,r){e[0].type!==J5&&L$("First argument to data functions must be a string literal.");const i=e[0].value,o=":"+i;if(!RF(o,r))try{r[o]=n.getData(i).tuplesRef()}catch(t){}}function u7(t,e,n,r){if(e[0].type===J5)c7(n,r,e[0].value);else for(t in n.scales)c7(n,r,t)}function c7(t,e,n){const r=s7+n;if(!RF(e,r))try{e[r]=t.scaleRef(n)}catch(t){}}function h7(t,e){if(EF(t))return t;if(XF(t)){const r=e.scales[t];return r&&((n=r.value)&&!0===n[_W])?r.value:void 0}var n}function f7(t,e){return function(n,r,i){if(n){const e=h7(n,(i||this).context);return e&&e.path[t](r)}return e(r)}}const d7=f7("area",(function(t){return W8=new QQ,KQ(t,H8),2*W8})),p7=f7("bounds",(function(t){var e,n,r,i,o,s,a;if(L8=F8=-(N8=$8=1/0),U8=[],KQ(t,d9),n=U8.length){for(U8.sort(_9),e=1,o=[r=U8[0]];e<n;++e)k9(r,(i=U8[e])[0])||k9(r,i[1])?(x9(r[0],i[1])>x9(r[0],r[1])&&(r[1]=i[1]),x9(i[0],r[1])>x9(r[0],r[1])&&(r[0]=i[0])):o.push(r=i);for(s=-1/0,e=0,r=o[n=o.length-1];e<=n;r=i,++e)i=o[e],(a=x9(r[1],i[0]))>s&&(s=a,N8=i[0],F8=r[1])}return U8=V8=null,N8===1/0||$8===1/0?[[NaN,NaN],[NaN,NaN]]:[[N8,$8],[F8,L8]]})),m7=f7("centroid",(function(t){K8=Q8=Z8=t9=e9=n9=r9=i9=0,o9=new QQ,s9=new QQ,a9=new QQ,KQ(t,S9);var e=+o9,n=+s9,r=+a9,i=dZ(e,n,r);return i<tZ&&(e=n9,n=r9,r=i9,Q8<ZQ&&(e=Z8,n=t9,r=e9),(i=dZ(e,n,r))<tZ)?[NaN,NaN]:[uZ(n,e)*oZ,xZ(r/i)*oZ]}));function g7(t,e,n){try{t[e].apply(t,["EXPRESSION"].concat([].slice.call(n)))}catch(e){t.warn(e)}return n[n.length-1]}function y7(t){const e=t/255;return e<=.03928?e/12.92:Math.pow((e+.055)/1.055,2.4)}function b7(t){const e=pD(t);return.2126*y7(e.r)+.7152*y7(e.g)+.0722*y7(e.b)}function v7(t,e){return t===e||t!=t&&e!=e||(Q$(t)?!(!Q$(e)||t.length!==e.length)&&function(t,e){for(let n=0,r=t.length;n<r;++n)if(!v7(t[n],e[n]))return!1;return!0}(t,e):!(!Z$(t)||!Z$(e))&&w7(t,e))}function w7(t,e){for(const n in t)if(!v7(t[n],e[n]))return!1;return!0}function x7(t){return e=>w7(t,e)}const _7={};function k7(t){return Q$(t)||ArrayBuffer.isView(t)?t:null}function S7(t){return k7(t)||(XF(t)?t:null)}const E7=t=>t.data;function A7(t,e){const n=K9.call(e,t);return n.root&&n.root.lookup||{}}const C7=()=>"undefined"!=typeof window&&window||null;function D7(t,e,n){if(!t)return[];const[r,i]=t,o=(new hG).set(r[0],r[1],i[0],i[1]);return KJ(n||this.context.dataflow.scenegraph().root,o,function(t){let e=null;if(t){const n=kF(t.marktype),r=kF(t.markname);e=t=>(!n.length||n.some((e=>t.marktype===e)))&&(!r.length||r.some((e=>t.name===e)))}return e}(e))}const M7={random:()=>MP(),cumulativeNormal:zP,cumulativeLogNormal:HP,cumulativeUniform:QP,densityNormal:PP,densityLogNormal:WP,densityUniform:KP,quantileNormal:jP,quantileLogNormal:GP,quantileUniform:ZP,sampleNormal:RP,sampleLogNormal:qP,sampleUniform:JP,isArray:Q$,isBoolean:qF,isDate:WF,isDefined:t=>void 0!==t,isNumber:GF,isObject:Z$,isRegExp:YF,isString:XF,isTuple:$R,isValid:t=>null!=t&&t==t,toBoolean:oL,toDate:t=>aL(t),toNumber:oF,toString:lL,indexof:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return S7(t).indexOf(...n)},join:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return k7(t).join(...n)},lastindexof:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return S7(t).lastIndexOf(...n)},replace:function(t,e,n){return EF(n)&&L$("Function argument passed to replace."),String(t).replace(e,n)},reverse:function(t){return k7(t).slice().reverse()},slice:function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];return S7(t).slice(...n)},flush:jF,lerp:KF,merge:function(){const t=[].slice.call(arguments);return t.unshift({}),$F(...t)},pad:nL,peek:iF,pluck:function(t,e){const n=_7[e]||(_7[e]=R$(e));return Q$(t)?t.map(n):n(t)},span:rL,inrange:VF,truncate:cL,rgb:pD,lab:hq,hcl:yq,hsl:kD,luminance:b7,contrast:function(t,e){const n=b7(t),r=b7(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)},sequence:xz,format:Z9,utcFormat:e7,utcParse:r7,utcOffset:AB,utcSequence:MB,timeFormat:t7,timeParse:n7,timeOffset:EB,timeSequence:DB,timeUnitSpecifier:KL,monthFormat:function(t){return o7.call(this,t,1,"%B")},monthAbbrevFormat:function(t){return o7.call(this,t,1,"%b")},dayFormat:function(t){return o7.call(this,0,2+t,"%A")},dayAbbrevFormat:function(t){return o7.call(this,0,2+t,"%a")},quarter:xF,utcquarter:_F,week:eB,utcweek:aB,dayofyear:tB,utcdayofyear:sB,warn:function(){return g7(this.context.dataflow,"warn",arguments)},info:function(){return g7(this.context.dataflow,"info",arguments)},debug:function(){return g7(this.context.dataflow,"debug",arguments)},extent:t=>FF(t),inScope:function(t){const e=this.context.group;let n=!1;if(e)for(;t;){if(t===e){n=!0;break}t=t.mark.group}return n},intersect:D7,clampRange:SF,pinchDistance:function(t){const e=t.touches,n=e[0].clientX-e[1].clientX,r=e[0].clientY-e[1].clientY;return Math.hypot(n,r)},pinchAngle:function(t){const e=t.touches;return Math.atan2(e[0].clientY-e[1].clientY,e[0].clientX-e[1].clientX)},screen:function(){const t=C7();return t?t.screen:{}},containerSize:function(){const t=this.context.dataflow,e=t.container&&t.container();return e?[e.clientWidth,e.clientHeight]:[void 0,void 0]},windowSize:function(){const t=C7();return t?[t.innerWidth,t.innerHeight]:[void 0,void 0]},bandspace:function(t,e,n){return Xq(t||0,e||0,n||0)},setdata:function(t,e){const n=this.context.dataflow,r=this.context.data[t].input;return n.pulse(r,n.changeset().remove(V$).insert(e)),1},pathShape:function(t){let e=null;return function(n){return n?$H(n,e=e||kH(t)):t}},panLinear:fF,panLog:dF,panPow:pF,panSymlog:mF,zoomLinear:yF,zoomLog:bF,zoomPow:vF,zoomSymlog:wF,encode:function(t,e,n){if(t){const n=this.context.dataflow,r=t.mark.source;n.pulse(r,n.changeset().encode(t,e))}return void 0!==n?n:t},modify:function(t,e,n,r,i,o){const s=this.context.dataflow,a=this.context.data[t],l=a.input,u=s.stamp();let c,h,f=a.changes;if(!1===s._trigger||!(l.value.length||e||r))return 0;if((!f||f.stamp<u)&&(a.changes=f=s.changeset(),f.stamp=u,s.runAfter((()=>{a.modified=!0,s.pulse(l,f).run()}),!0,1)),n&&(c=!0===n?V$:Q$(n)||$R(n)?n:x7(n),f.remove(c)),e&&f.insert(e),r&&(c=x7(r),l.value.some(c)?f.remove(c):f.insert(r)),i)for(h in o)f.modify(i,h,o[h]);return 1},lassoAppend:function(t,e,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;const i=(t=kF(t))[t.length-1];return void 0===i||Math.hypot(i[0]-e,i[1]-n)>r?[...t,[e,n]]:t},lassoPath:function(t){return kF(t).reduce(((e,n,r)=>{let[i,o]=n;return e+(0==r?`M ${i},${o} `:r===t.length-1?" Z":`L ${i},${o} `)}),"")},intersectLasso:function(t,e,n){const{x:r,y:i,mark:o}=n,s=(new hG).set(Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER,Number.MIN_SAFE_INTEGER);for(const[t,n]of e)t<s.x1&&(s.x1=t),t>s.x2&&(s.x2=t),n<s.y1&&(s.y1=n),n>s.y2&&(s.y2=n);return s.translate(r,i),D7([[s.x1,s.y1],[s.x2,s.y2]],t,o).filter((t=>function(t,e,n){let r=0;for(let i=0,o=n.length-1;i<n.length;o=i++){const[s,a]=n[o],[l,u]=n[i];u>e!=a>e&&t<(s-l)*(e-u)/(a-u)+l&&r++}return 1&r}(t.x,t.y,e)))}},O7=["view","item","group","xy","x","y"],T7="this.",I7={},N7={forbidden:["_"],allowed:["datum","event","item"],fieldvar:"datum",globalvar:t=>`_[${iL(a7+t)}]`,functions:function(t){const e=A8(t);O7.forEach((t=>e[t]="event.vega."+t));for(const t in M7)e[t]=T7+t;return $F(e,function(t,e,n){e.__bandwidth=t=>t&&t.bandwidth?t.bandwidth():0,n._bandwidth=u7,n._range=u7,n._scale=u7;const r=e=>"_["+(e.type===J5?iL(s7+e.value):iL(s7)+"+"+t(e))+"]";return{_bandwidth:t=>`this.__bandwidth(${r(t[0])})`,_range:t=>`${r(t[0])}.range()`,_scale:e=>`${r(e[0])}(${t(e[1])})`}}(t,M7,I7)),e},constants:E8,visitors:I7},$7=C8(N7);function F7(t,e,n){return 1===arguments.length?M7[t]:(M7[t]=e,n&&(I7[t]=n),$7&&($7.functions[t]=T7+t),this)}function L7(t,e){const n={};let r;try{r=S8(t=XF(t)?t:iL(t)+"")}catch(e){L$("Expression parse error: "+t)}r.visit((t=>{if(t.type!==K5)return;const r=t.callee.name,i=N7.visitors[r];i&&i(r,t.arguments,e,n)}));const i=$7(r);return i.globals.forEach((t=>{const r=a7+t;!RF(n,r)&&e.getSignal(t)&&(n[r]=e.signalRef(t))})),{$expr:$F({code:i.code},e.options.ast?{ast:r}:null),$fields:i.fields,$params:n}}F7("bandwidth",(function(t,e){const n=h7(t,(e||this).context);return n&&n.bandwidth?n.bandwidth():0}),u7),F7("copy",(function(t,e){const n=h7(t,(e||this).context);return n?n.copy():void 0}),u7),F7("domain",(function(t,e){const n=h7(t,(e||this).context);return n?n.domain():[]}),u7),F7("range",(function(t,e){const n=h7(t,(e||this).context);return n&&n.range?n.range():[]}),u7),F7("invert",(function(t,e,n){const r=h7(t,(n||this).context);return r?Q$(e)?(r.invertRange||r.invert)(e):(r.invert||r.invertExtent)(e):void 0}),u7),F7("scale",(function(t,e,n){const r=h7(t,(n||this).context);return r?r(e):void 0}),u7),F7("gradient",(function(t,e,n,r,i){t=h7(t,(i||this).context);const o=mH(e,n);let s=t.domain(),a=s[0],l=iF(s),u=z$;return l-a?u=BW(t,a,l):t=(t.interpolator?SW("sequential")().interpolator(t.interpolator()):SW("linear")().interpolate(t.interpolate()).range(t.range())).domain([a=0,l=1]),t.ticks&&(s=t.ticks(+r||15),a!==s[0]&&s.unshift(a),l!==iF(s)&&s.push(l)),s.forEach((e=>o.stop(u(e),t(e)))),o}),u7),F7("geoArea",d7,u7),F7("geoBounds",p7,u7),F7("geoCentroid",m7,u7),F7("geoShape",(function(t,e,n){const r=h7(t,(n||this).context);return function(t){return r?r.path.context(t)(e):""}}),u7),F7("geoScale",(function(t,e){const n=h7(t,(e||this).context);return n&&n.scale()}),u7),F7("indata",(function(t,e,n){const r=this.context.data[t]["index:"+e],i=r?r.value.get(n):void 0;return i?i.count:i}),(function(t,e,n,r){e[0].type!==J5&&L$("First argument to indata must be a string literal."),e[1].type!==J5&&L$("Second argument to indata must be a string literal.");const i=e[0].value,o=e[1].value,s="@"+o;RF(s,r)||(r[s]=n.getData(i).indataRef(n,o))})),F7("data",K9,l7),F7("treePath",(function(t,e,n){const r=A7(t,this),i=r[e],o=r[n];return i&&o?i.path(o).map(E7):void 0}),l7),F7("treeAncestors",(function(t,e){const n=A7(t,this)[e];return n?n.ancestors().map(E7):void 0}),l7),F7("vlSelectionTest",(function(t,e,n){for(var r,i,o,s,a,l=this.context.data[t],u=l?l.values.value:[],c=l?l[q9]&&l[q9].value:void 0,h=n===R9,f=u.length,d=0;d<f;++d)if(r=u[d],c&&h){if(-1===(o=(i=i||{})[s=r.unit]||0))continue;if(a=W9(e,r),i[s]=a?-1:++o,a&&1===c.size)return!0;if(!a&&o===c.get(s).count)return!1}else if(h^(a=W9(e,r)))return a;return f&&h}),J9),F7("vlSelectionIdTest",(function(t,e,n){const r=this.context.data[t],i=r?r.values.value:[],o=r?r[q9]&&r[q9].value:void 0,s=n===R9,a=V9(e),l=G9(i,a);if(l===i.length)return!1;if(V9(i[l])!==a)return!1;if(o&&s){if(1===o.size)return!0;if(Y9(i,a)-l<o.size)return!1}return!0}),J9),F7("vlSelectionResolve",(function(t,e,n,r){for(var i,o,s,a,l,u,c,h,f,d,p,m,g=this.context.data[t],y=g?g.values.value:[],b={},v={},w={},x=y.length,_=0;_<x;++_)if(a=(i=y[_]).unit,o=i.fields,s=i.values,o&&s){for(p=0,m=o.length;p<m;++p)l=o[p],h=(c=b[l.field]||(b[l.field]={}))[a]||(c[a]=[]),w[l.field]=f=l.type.charAt(0),d=X9[`${f}_union`],c[a]=d(h,kF(s[p]));n&&(h=v[a]||(v[a]=[])).push(kF(s).reduce(((t,e,n)=>(t[o[n].field]=e,t)),{}))}else l=U9,u=V9(i),(h=(c=b[l]||(b[l]={}))[a]||(c[a]=[])).push(u),n&&(h=v[a]||(v[a]=[])).push({[U9]:u});return e=e||P9,b[U9]?b[U9]=X9[`${U9}_${e}`](...Object.values(b[U9])):Object.keys(b).forEach((t=>{b[t]=Object.keys(b[t]).map((e=>b[t][e])).reduce(((n,r)=>void 0===n?r:X9[`${w[t]}_${e}`](n,r)))})),y=Object.keys(v),n&&y.length&&(b[r?"vlPoint":"vlMulti"]=e===P9?{[z9]:y.reduce(((t,e)=>(t.push(...v[e]),t)),[])}:{[j9]:y.map((t=>({[z9]:v[t]})))}),b}),J9),F7("vlSelectionTuples",(function(t,e){return t.map((t=>$F(e.fields?{values:e.fields.map((e=>B9(e)(t.datum)))}:{[U9]:V9(t.datum)},e)))}));const B7=uL(["rule"]),R7=uL(["group","image","rect"]);function P7(t){return(t+"").toLowerCase()}function z7(t,e,n){n.endsWith(";")||(n="return("+n+");");const r=Function(...e.concat(n));return t&&t.functions?r.bind(t.functions):r}var j7={operator:(t,e)=>z7(t,["_"],e.code),parameter:(t,e)=>z7(t,["datum","_"],e.code),event:(t,e)=>z7(t,["event"],e.code),handler:(t,e)=>z7(t,["_","event"],`var datum=event.item&&event.item.datum;return ${e.code};`),encode:(t,e)=>{const{marktype:n,channels:r}=e;let i="var o=item,datum=o.datum,m=0,$;";for(const t in r){const e="o["+iL(t)+"]";i+=`$=${r[t].code};if(${e}!==$)${e}=$,m=1;`}return i+=function(t,e){let n="";return B7[e]||(t.x2&&(t.x?(R7[e]&&(n+="if(o.x>o.x2)$=o.x,o.x=o.x2,o.x2=$;"),n+="o.width=o.x2-o.x;"):n+="o.x=o.x2-(o.width||0);"),t.xc&&(n+="o.x=o.xc-(o.width||0)/2;"),t.y2&&(t.y?(R7[e]&&(n+="if(o.y>o.y2)$=o.y,o.y=o.y2,o.y2=$;"),n+="o.height=o.y2-o.y;"):n+="o.y=o.y2-(o.height||0);"),t.yc&&(n+="o.y=o.yc-(o.height||0)/2;")),n}(r,n),i+="return m;",z7(t,["item","_"],i)},codegen:{get(t){const e=`[${t.map(iL).join("][")}]`,n=Function("_",`return _${e};`);return n.path=e,n},comparator(t,e){let n;const r=Function("a","b","var u, v; return "+t.map(((t,r)=>{const i=e[r];let o,s;return t.path?(o=`a${t.path}`,s=`b${t.path}`):((n=n||{})["f"+r]=t,o=`this.f${r}(a)`,s=`this.f${r}(b)`),function(t,e,n,r){return`((u = ${t}) < (v = ${e}) || u == null) && v != null ? ${n}\n  : (u > v || v == null) && u != null ? ${r}\n  : ((v = v instanceof Date ? +v : v), (u = u instanceof Date ? +u : u)) !== u && v === v ? ${n}\n  : v !== v && u === u ? ${r} : `}(o,s,-i,i)})).join("")+"0;");return n?r.bind(n):r}}};function U7(t,e,n){if(!t||!Z$(t))return t;for(let r,i=0,o=V7.length;i<o;++i)if(r=V7[i],RF(t,r.key))return r.parse(t,e,n);return t}var V7=[{key:"$ref",parse:function(t,e){return e.get(t.$ref)||L$("Operator not defined: "+t.$ref)}},{key:"$key",parse:function(t,e){const n="k:"+t.$key+"_"+!!t.$flat;return e.fn[n]||(e.fn[n]=JF(t.$key,t.$flat,e.expr.codegen))}},{key:"$expr",parse:function(t,e,n){t.$params&&e.parseParameters(t.$params,n);const r="e:"+t.$expr.code;return e.fn[r]||(e.fn[r]=O$(e.parameterExpression(t.$expr),t.$fields))}},{key:"$field",parse:function(t,e){if(!t.$field)return null;const n="f:"+t.$field+"_"+t.$name;return e.fn[n]||(e.fn[n]=R$(t.$field,t.$name,e.expr.codegen))}},{key:"$encode",parse:function(t,e){const n=t.$encode,r={};for(const t in n){const i=n[t];r[t]=O$(e.encodeExpression(i.$expr),i.$fields),r[t].output=i.$output}return r}},{key:"$compare",parse:function(t,e){const n="c:"+t.$compare+"_"+t.$order,r=kF(t.$compare).map((t=>t&&t.$tupleid?FR:t));return e.fn[n]||(e.fn[n]=CF(r,t.$order,e.expr.codegen))}},{key:"$context",parse:function(t,e){return e}},{key:"$subflow",parse:function(t,e){const n=t.$subflow;return function(t,r,i){const o=e.fork().parse(n),s=o.get(n.operators[0].id),a=o.signals.parent;return a&&a.set(i),s.detachSubflow=()=>e.detach(o),s}}},{key:"$tupleid",parse:function(){return FR}}];const q7={skip:!0};function W7(t,e,n,r){return new H7(t,e,n,r)}function H7(t,e,n,r){this.dataflow=t,this.transforms=e,this.events=t.events.bind(t),this.expr=r||j7,this.signals={},this.scales={},this.nodes={},this.data={},this.fn={},n&&(this.functions=Object.create(n),this.functions.context=this)}function G7(t){this.dataflow=t.dataflow,this.transforms=t.transforms,this.events=t.events,this.expr=t.expr,this.signals=Object.create(t.signals),this.scales=Object.create(t.scales),this.nodes=Object.create(t.nodes),this.data=Object.create(t.data),this.fn=Object.create(t.fn),t.functions&&(this.functions=Object.create(t.functions),this.functions.context=this)}function Y7(t,e){t&&(null==e?t.removeAttribute("aria-label"):t.setAttribute("aria-label",e))}H7.prototype=G7.prototype={fork(){const t=new G7(this);return(this.subcontext||(this.subcontext=[])).push(t),t},detach(t){this.subcontext=this.subcontext.filter((e=>e!==t));const e=Object.keys(t.nodes);for(const n of e)t.nodes[n]._targets=null;for(const n of e)t.nodes[n].detach();t.nodes=null},get(t){return this.nodes[t]},set(t,e){return this.nodes[t]=e},add(t,e){const n=this,r=n.dataflow,i=t.value;if(n.set(t.id,e),function(t){return"collect"===P7(t)}(t.type)&&i&&(i.$ingest?r.ingest(e,i.$ingest,i.$format):i.$request?r.preload(e,i.$request,i.$format):r.pulse(e,r.changeset().insert(i))),t.root&&(n.root=e),t.parent){let i=n.get(t.parent.$ref);i?(r.connect(i,[e]),e.targets().add(i)):(n.unresolved=n.unresolved||[]).push((()=>{i=n.get(t.parent.$ref),r.connect(i,[e]),e.targets().add(i)}))}if(t.signal&&(n.signals[t.signal]=e),t.scale&&(n.scales[t.scale]=e),t.data)for(const r in t.data){const i=n.data[r]||(n.data[r]={});t.data[r].forEach((t=>i[t]=e))}},resolve(){return(this.unresolved||[]).forEach((t=>t())),delete this.unresolved,this},operator(t,e){this.add(t,this.dataflow.add(t.value,e))},transform(t,e){this.add(t,this.dataflow.add(this.transforms[P7(e)]))},stream(t,e){this.set(t.id,e)},update(t,e,n,r,i){this.dataflow.on(e,n,r,i,t.options)},operatorExpression(t){return this.expr.operator(this,t)},parameterExpression(t){return this.expr.parameter(this,t)},eventExpression(t){return this.expr.event(this,t)},handlerExpression(t){return this.expr.handler(this,t)},encodeExpression(t){return this.expr.encode(this,t)},parse:function(t){const e=this,n=t.operators||[];return t.background&&(e.background=t.background),t.eventConfig&&(e.eventConfig=t.eventConfig),t.locale&&(e.locale=t.locale),n.forEach((t=>e.parseOperator(t))),n.forEach((t=>e.parseOperatorParameters(t))),(t.streams||[]).forEach((t=>e.parseStream(t))),(t.updates||[]).forEach((t=>e.parseUpdate(t))),e.resolve()},parseOperator:function(t){const e=this;!function(t){return"operator"===P7(t)}(t.type)&&t.type?e.transform(t,t.type):e.operator(t,t.update?e.operatorExpression(t.update):null)},parseOperatorParameters:function(t){const e=this;if(t.params){const n=e.get(t.id);n||L$("Invalid operator id: "+t.id),e.dataflow.connect(n,n.parameters(e.parseParameters(t.params),t.react,t.initonly))}},parseParameters:function(t,e){e=e||{};const n=this;for(const r in t){const i=t[r];e[r]=Q$(i)?i.map((t=>U7(t,n,e))):U7(i,n,e)}return e},parseStream:function(t){var e,n=this,r=null!=t.filter?n.eventExpression(t.filter):void 0,i=null!=t.stream?n.get(t.stream):void 0;t.source?i=n.events(t.source,t.type,r):t.merge&&(i=(e=t.merge.map((t=>n.get(t))))[0].merge.apply(e[0],e.slice(1))),t.between&&(e=t.between.map((t=>n.get(t))),i=i.between(e[0],e[1])),t.filter&&(i=i.filter(r)),null!=t.throttle&&(i=i.throttle(+t.throttle)),null!=t.debounce&&(i=i.debounce(+t.debounce)),null==i&&L$("Invalid stream definition: "+JSON.stringify(t)),t.consume&&i.consume(!0),n.stream(t,i)},parseUpdate:function(t){var e,n=this,r=Z$(r=t.source)?r.$ref:r,i=n.get(r),o=t.update,s=void 0;i||L$("Source not defined: "+t.source),e=t.target&&t.target.$expr?n.eventExpression(t.target.$expr):n.get(t.target),o&&o.$expr&&(o.$params&&(s=n.parseParameters(o.$params)),o=n.handlerExpression(o.$expr)),n.update(t,i,e,o,s)},getState:function(t){var e=this,n={};if(t.signals){var r=n.signals={};Object.keys(e.signals).forEach((n=>{const i=e.signals[n];t.signals(n,i)&&(r[n]=i.value)}))}if(t.data){var i=n.data={};Object.keys(e.data).forEach((n=>{const r=e.data[n];t.data(n,r)&&(i[n]=r.input.value)}))}return e.subcontext&&!1!==t.recurse&&(n.subcontext=e.subcontext.map((e=>e.getState(t)))),n},setState:function(t){var e=this,n=e.dataflow,r=t.data,i=t.signals;Object.keys(i||{}).forEach((t=>{n.update(e.signals[t],i[t],q7)})),Object.keys(r||{}).forEach((t=>{n.pulse(e.data[t].input,n.changeset().remove(V$).insert(r[t]))})),(t.subcontext||[]).forEach(((t,n)=>{const r=e.subcontext[n];r&&r.setState(t)}))}};const X7="default";function J7(t,e){const n=t.globalCursor()?"undefined"!=typeof document&&document.body:t.container();if(n)return null==e?n.style.removeProperty("cursor"):n.style.cursor=e}function K7(t,e){var n=t._runtime.data;return RF(n,e)||L$("Unrecognized data set: "+e),n[e]}function Q7(t,e){UR(e)||L$("Second argument to changes must be a changeset.");const n=K7(this,t);return n.modified=!0,this.pulse(n.input,e)}function Z7(t){var e=t.padding();return Math.max(0,t._viewWidth+e.left+e.right)}function ttt(t){var e=t.padding();return Math.max(0,t._viewHeight+e.top+e.bottom)}function ett(t){var e=t.padding(),n=t._origin;return[e.left+n[0],e.top+n[1]]}const ntt="view",rtt={trap:!1};function itt(t,e,n,r){t._eventListeners.push({type:n,sources:kF(e),handler:r})}function ott(t,e,n){const r=t._eventConfig&&t._eventConfig[e];return!(!1===r||Z$(r)&&!r[n])||(t.warn(`Blocked ${e} ${n} event listener.`),!1)}function stt(t){return t.item}function att(t){return t.item.mark.source}function ltt(t){return function(e,n){return n.vega.view().changeset().encode(n.item,t)}}function utt(t,e,n){const r=document.createElement(t);for(const t in e)r.setAttribute(t,e[t]);return null!=n&&(r.textContent=n),r}const ctt="vega-bind-radio";function htt(t,e,n,r){const i=n.event||"input",o=()=>t.update(e.value);r.signal(n.signal,e.value),e.addEventListener(i,o),itt(r,e,i,o),t.set=t=>{e.value=t,e.dispatchEvent(function(t){return"undefined"!=typeof Event?new Event(t):{type:t}}(i))}}function ftt(t,e,n,r){const i=r.signal(n.signal),o=utt("div",{class:"vega-bind"}),s="radio"===n.input?o:o.appendChild(utt("label"));s.appendChild(utt("span",{class:"vega-bind-name"},n.name||n.signal)),e.appendChild(o);let a=dtt;switch(n.input){case"checkbox":a=ptt;break;case"select":a=mtt;break;case"radio":a=gtt;break;case"range":a=ytt}a(t,s,n,i)}function dtt(t,e,n,r){const i=utt("input");for(const t in n)"signal"!==t&&"element"!==t&&i.setAttribute("input"===t?"type":t,n[t]);i.setAttribute("name",n.signal),i.value=r,e.appendChild(i),i.addEventListener("input",(()=>t.update(i.value))),t.elements=[i],t.set=t=>i.value=t}function ptt(t,e,n,r){const i={type:"checkbox",name:n.signal};r&&(i.checked=!0);const o=utt("input",i);e.appendChild(o),o.addEventListener("change",(()=>t.update(o.checked))),t.elements=[o],t.set=t=>o.checked=!!t||null}function mtt(t,e,n,r){const i=utt("select",{name:n.signal}),o=n.labels||[];n.options.forEach(((t,e)=>{const n={value:t};btt(t,r)&&(n.selected=!0),i.appendChild(utt("option",n,(o[e]||t)+""))})),e.appendChild(i),i.addEventListener("change",(()=>{t.update(n.options[i.selectedIndex])})),t.elements=[i],t.set=t=>{for(let e=0,r=n.options.length;e<r;++e)if(btt(n.options[e],t))return void(i.selectedIndex=e)}}function gtt(t,e,n,r){const i=utt("span",{class:ctt}),o=n.labels||[];e.appendChild(i),t.elements=n.options.map(((e,s)=>{const a={type:"radio",name:n.signal,value:e};btt(e,r)&&(a.checked=!0);const l=utt("input",a);l.addEventListener("change",(()=>t.update(e)));const u=utt("label",{},(o[s]||e)+"");return u.prepend(l),i.appendChild(u),l})),t.set=e=>{const n=t.elements,r=n.length;for(let t=0;t<r;++t)btt(n[t].value,e)&&(n[t].checked=!0)}}function ytt(t,e,n,r){r=void 0!==r?r:(+n.max+ +n.min)/2;const i=null!=n.max?n.max:Math.max(100,+r)||100,o=n.min||Math.min(0,i,+r)||0,s=n.step||$M(o,i,100),a=utt("input",{type:"range",name:n.signal,min:o,max:i,step:s});a.value=r;const l=utt("span",{},+r);e.appendChild(a),e.appendChild(l);const u=()=>{l.textContent=a.value,t.update(+a.value)};a.addEventListener("input",u),a.addEventListener("change",u),t.elements=[a],t.set=t=>{a.value=t,l.textContent=t}}function btt(t,e){return t===e||t+""==e+""}function vtt(t,e,n,r,i,o){return(e=e||new r(t.loader())).initialize(n,Z7(t),ttt(t),ett(t),i,o).background(t.background())}function wtt(t,e){return e?function(){try{e.apply(this,arguments)}catch(e){t.error(e)}}:null}function xtt(t,e,n){if("string"==typeof e){if("undefined"==typeof document)return t.error("DOM document instance not found."),null;if(!(e=document.querySelector(e)))return t.error("Signal bind element not found: "+e),null}if(e&&n)try{e.textContent=""}catch(n){e=null,t.error(n)}return e}const _tt=t=>+t||0;function ktt(t){return Z$(t)?{top:_tt(t.top),bottom:_tt(t.bottom),left:_tt(t.left),right:_tt(t.right)}:(t=>({top:t,bottom:t,left:t,right:t}))(_tt(t))}async function Stt(t,e,n,r){const i=JJ(e),o=i&&i.headless;return o||L$("Unrecognized renderer type: "+e),await t.runAsync(),vtt(t,null,null,o,n,r).renderAsync(t._scenegraph.root)}var Ett="width",Att="height",Ctt="padding",Dtt={skip:!0};function Mtt(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===Ctt?r.left+r.right:0)}function Ott(t,e){var n=t.autosize(),r=t.padding();return e-(n&&n.contains===Ctt?r.top+r.bottom:0)}function Ttt(t,e){return e.modified&&Q$(e.input.value)&&!t.startsWith("_:vega:_")}function Itt(t,e){return!("parent"===t||e instanceof pP.proxy)}function Ntt(t,e,n,r){const i=t.element();i&&i.setAttribute("title",function(t){return null==t?"":Q$(t)?$tt(t):Z$(t)&&!WF(t)?function(t){return Object.keys(t).map((e=>{const n=t[e];return e+": "+(Q$(n)?$tt(n):Ftt(n))})).join("\n")}(t):t+""}(r))}function $tt(t){return"["+t.map(Ftt).join(", ")+"]"}function Ftt(t){return Q$(t)?"[â€¦]":Z$(t)&&!WF(t)?"{â€¦}":t}function Ltt(t,e){const n=this;if(e=e||{},hP.call(n),e.loader&&n.loader(e.loader),e.logger&&n.logger(e.logger),null!=e.logLevel&&n.logLevel(e.logLevel),e.locale||t.locale){const r=$F({},t.locale,e.locale);n.locale(ZB(r.number,r.time))}n._el=null,n._elBind=null,n._renderType=e.renderer||YJ.Canvas,n._scenegraph=new gX;const r=n._scenegraph.root;n._renderer=null,n._tooltip=e.tooltip||Ntt,n._redraw=!0,n._handler=(new GX).scene(r),n._globalCursor=!1,n._preventDefault=!1,n._timers=[],n._eventListeners=[],n._resizeListeners=[],n._eventConfig=function(t){const e=$F({defaults:{}},t),n=(t,e)=>{e.forEach((e=>{Q$(t[e])&&(t[e]=uL(t[e]))}))};return n(e.defaults,["prevent","allow"]),n(e,["view","window","selector"]),e}(t.eventConfig),n.globalCursor(n._eventConfig.globalCursor);const i=function(t,e,n){return W7(t,pP,M7,n).parse(e)}(n,t,e.expr);n._runtime=i,n._signals=i.signals,n._bind=(t.bindings||[]).map((t=>({state:null,param:$F({},t)}))),i.root&&i.root.set(r),r.source=i.data.root.input,n.pulse(i.data.root.input,n.changeset().insert(r.items)),n._width=n.width(),n._height=n.height(),n._viewWidth=Mtt(n,n._width),n._viewHeight=Ott(n,n._height),n._origin=[0,0],n._resize=0,n._autosize=1,function(t){var e=t._signals,n=e[Ett],r=e[Att],i=e[Ctt];function o(){t._autosize=t._resize=1}t._resizeWidth=t.add(null,(e=>{t._width=e.size,t._viewWidth=Mtt(t,e.size),o()}),{size:n}),t._resizeHeight=t.add(null,(e=>{t._height=e.size,t._viewHeight=Ott(t,e.size),o()}),{size:r});const s=t.add(null,o,{pad:i});t._resizeWidth.rank=n.rank+1,t._resizeHeight.rank=r.rank+1,s.rank=i.rank+1}(n),function(t){t.add(null,(e=>(t._background=e.bg,t._resize=1,e.bg)),{bg:t._signals.background})}(n),function(t){const e=t._signals.cursor||(t._signals.cursor=t.add({user:X7,item:null}));t.on(t.events("view","pointermove"),e,((t,n)=>{const r=e.value,i=r?XF(r)?r:r.user:X7,o=n.item&&n.item.cursor||null;return r&&i===r.user&&o==r.item?r:{user:i,item:o}})),t.add(null,(function(e){let n=e.cursor,r=this.value;return XF(n)||(r=n.item,n=n.user),J7(t,n&&n!==X7?n:r||n),r}),{cursor:e})}(n),n.description(t.description),e.hover&&n.hover(),e.container&&n.initialize(e.container,e.bind),e.watchPixelRatio&&n._watchPixelRatio()}function Btt(t,e){return RF(t._signals,e)?t._signals[e]:L$("Unrecognized signal name: "+iL(e))}function Rtt(t,e){const n=(t._targets||[]).filter((t=>t._update&&t._update.handler===e));return n.length?n[0]:null}function Ptt(t,e,n,r){let i=Rtt(n,r);return i||(i=wtt(t,(()=>r(e,n.value))),i.handler=r,t.on(n,null,i)),t}function ztt(t,e,n){const r=Rtt(e,n);return r&&e._targets.remove(r),t}UF(Ltt,hP,{async evaluate(t,e,n){if(await hP.prototype.evaluate.call(this,t,e),this._redraw||this._resize)try{this._renderer&&(this._resize&&(this._resize=0,i=ett(r=this),o=Z7(r),s=ttt(r),r._renderer.background(r.background()),r._renderer.resize(o,s,i),r._handler.origin(i),r._resizeListeners.forEach((t=>{try{t(o,s)}catch(t){r.error(t)}}))),await this._renderer.renderAsync(this._scenegraph.root)),this._redraw=!1}catch(t){this.error(t)}var r,i,o,s;return n&&TR(this,n),this},dirty(t){this._redraw=!0,this._renderer&&this._renderer.dirty(t)},description(t){if(arguments.length){const e=null!=t?t+"":null;return e!==this._desc&&Y7(this._el,this._desc=e),this}return this._desc},container(){return this._el},scenegraph(){return this._scenegraph},origin(){return this._origin.slice()},signal(t,e,n){const r=Btt(this,t);return 1===arguments.length?r.value:this.update(r,e,n)},width(t){return arguments.length?this.signal("width",t):this.signal("width")},height(t){return arguments.length?this.signal("height",t):this.signal("height")},padding(t){return arguments.length?this.signal("padding",ktt(t)):ktt(this.signal("padding"))},autosize(t){return arguments.length?this.signal("autosize",t):this.signal("autosize")},background(t){return arguments.length?this.signal("background",t):this.signal("background")},renderer(t){return arguments.length?(JJ(t)||L$("Unrecognized renderer type: "+t),t!==this._renderType&&(this._renderType=t,this._resetRenderer()),this):this._renderType},tooltip(t){return arguments.length?(t!==this._tooltip&&(this._tooltip=t,this._resetRenderer()),this):this._tooltip},loader(t){return arguments.length?(t!==this._loader&&(hP.prototype.loader.call(this,t),this._resetRenderer()),this):this._loader},resize(){return this._autosize=1,this.touch(Btt(this,"autosize"))},_resetRenderer(){this._renderer&&(this._renderer=null,this.initialize(this._el,this._elBind))},_resizeView:function(t,e,n,r,i,o){this.runAfter((s=>{let a=0;s._autosize=0,s.width()!==n&&(a=1,s.signal(Ett,n,Dtt),s._resizeWidth.skip(!0)),s.height()!==r&&(a=1,s.signal(Att,r,Dtt),s._resizeHeight.skip(!0)),s._viewWidth!==t&&(s._resize=1,s._viewWidth=t),s._viewHeight!==e&&(s._resize=1,s._viewHeight=e),s._origin[0]===i[0]&&s._origin[1]===i[1]||(s._resize=1,s._origin=i),a&&s.run("enter"),o&&s.runAfter((t=>t.resize()))}),!1,1)},addEventListener(t,e,n){let r=e;return n&&!1===n.trap||(r=wtt(this,e),r.raw=e),this._handler.on(t,r),this},removeEventListener(t,e){for(var n,r,i=this._handler.handlers(t),o=i.length;--o>=0;)if(r=i[o].type,n=i[o].handler,t===r&&(e===n||e===n.raw)){this._handler.off(r,n);break}return this},addResizeListener(t){const e=this._resizeListeners;return e.includes(t)||e.push(t),this},removeResizeListener(t){var e=this._resizeListeners,n=e.indexOf(t);return n>=0&&e.splice(n,1),this},addSignalListener(t,e){return Ptt(this,t,Btt(this,t),e)},removeSignalListener(t,e){return ztt(this,Btt(this,t),e)},addDataListener(t,e){return Ptt(this,t,K7(this,t).values,e)},removeDataListener(t,e){return ztt(this,K7(this,t).values,e)},globalCursor(t){if(arguments.length){if(this._globalCursor!==!!t){const e=J7(this,null);this._globalCursor=!!t,e&&J7(this,e)}return this}return this._globalCursor},preventDefault(t){return arguments.length?(this._preventDefault=t,this):this._preventDefault},timer:function(t,e){this._timers.push(function(t,e,n){var r=new xC,i=e;return null==e?(r.restart(t,e,n),r):(r._restart=r.restart,r.restart=function(t,e,n){e=+e,n=null==n?vC():+n,r._restart((function o(s){s+=i,r._restart(o,i+=e,n),t(s)}),e,n)},r.restart(t,e,n),r)}((function(e){t({timestamp:Date.now(),elapsed:e})}),e))},events:function(t,e,n){var r,i=this,o=new KR(n),s=function(n,r){i.runAsync(null,(()=>{t===ntt&&function(t,e){var n=t._eventConfig.defaults,r=n.prevent,i=n.allow;return!1!==r&&!0!==i&&(!0===r||!1===i||(r?r[e]:i?!i[e]:t.preventDefault()))}(i,e)&&n.preventDefault(),o.receive(function(t,e,n){var r,i,o=t._renderer,s=o&&o.canvas();return s&&(i=ett(t),(r=kX(e.changedTouches?e.changedTouches[0]:e,s))[0]-=i[0],r[1]-=i[1]),e.dataflow=t,e.item=n,e.vega=function(t,e,n){const r=e?"group"===e.mark.marktype?e:e.mark.group:null;function i(t){var n,i=r;if(t)for(n=e;n;n=n.mark.group)if(n.mark.name===t){i=n;break}return i&&i.mark&&i.mark.interactive?i:{}}function o(t){if(!t)return n;XF(t)&&(t=i(t));const e=n.slice();for(;t;)e[0]-=t.x||0,e[1]-=t.y||0,t=t.mark&&t.mark.group;return e}return{view:IF(t),item:IF(e||{}),group:i,xy:o,x:t=>o(t)[0],y:t=>o(t)[1]}}(t,n,r),e}(i,n,r))}))};if("timer"===t)ott(i,"timer",e)&&i.timer(s,e);else if(t===ntt)ott(i,"view",e)&&i.addEventListener(e,s,rtt);else if("window"===t?ott(i,"window",e)&&"undefined"!=typeof window&&(r=[window]):"undefined"!=typeof document&&ott(i,"selector",e)&&(r=Array.from(document.querySelectorAll(t))),r){for(var a=0,l=r.length;a<l;++a)r[a].addEventListener(e,s);itt(i,r,e,s)}else i.warn("Can not resolve event source: "+t);return o},finalize:function(){var t,e,n,r,i,o=this._tooltip,s=this._timers,a=this._handler.handlers(),l=this._eventListeners;for(t=s.length;--t>=0;)s[t].stop();for(t=l.length;--t>=0;)for(e=(n=l[t]).sources.length;--e>=0;)n.sources[e].removeEventListener(n.type,n.handler);for(o&&o.call(this,this._handler,null,null,null),t=a.length;--t>=0;)i=a[t].type,r=a[t].handler,this._handler.off(i,r);return this},hover:function(t,e){return e=[e||"update",(t=[t||"hover"])[0]],this.on(this.events("view","pointerover",stt),att,ltt(t)),this.on(this.events("view","pointerout",stt),att,ltt(e)),this},data:function(t,e){return arguments.length<2?K7(this,t).values.value:Q7.call(this,t,VR().remove(V$).insert(e))},change:Q7,insert:function(t,e){return Q7.call(this,t,VR().insert(e))},remove:function(t,e){return Q7.call(this,t,VR().remove(e))},scale:function(t){var e=this._runtime.scales;return RF(e,t)||L$("Unrecognized scale or projection: "+t),e[t].value},initialize:function(t,e){const n=this,r=n._renderType,i=n._eventConfig.bind,o=JJ(r);t=n._el=t?xtt(n,t,!0):null,function(t){const e=t.container();e&&(e.setAttribute("role","graphics-document"),e.setAttribute("aria-roleDescription","visualization"),Y7(e,t.description()))}(n),o||n.error("Unrecognized renderer type: "+r);const s=o.handler||GX,a=t?o.renderer:o.headless;return n._renderer=a?vtt(n,n._renderer,t,a):null,n._handler=function(t,e,n,r){const i=new r(t.loader(),wtt(t,t.tooltip())).scene(t.scenegraph().root).initialize(n,ett(t),t);return e&&e.handlers().forEach((t=>{i.on(t.type,t.handler)})),i}(n,n._handler,t,s),n._redraw=!0,t&&"none"!==i&&(e=e?n._elBind=xtt(n,e,!0):t.appendChild(utt("form",{class:"vega-bindings"})),n._bind.forEach((t=>{t.param.element&&"container"!==i&&(t.element=xtt(n,t.param.element,!!t.param.input))})),n._bind.forEach((t=>{!function(t,e,n){if(!e)return;const r=n.param;let i=n.state;i||(i=n.state={elements:null,active:!1,set:null,update:e=>{e!=t.signal(r.signal)&&t.runAsync(null,(()=>{i.source=!0,t.signal(r.signal,e)}))}},r.debounce&&(i.update=NF(r.debounce,i.update))),(null==r.input&&r.element?htt:ftt)(i,e,r,t),i.active||(t.on(t._signals[r.signal],null,(()=>{i.source?i.source=!1:i.set(t.signal(r.signal))})),i.active=!0)}(n,t.element||e,t)}))),n},toImageURL:async function(t,e){t!==YJ.Canvas&&t!==YJ.SVG&&t!==YJ.PNG&&L$("Unrecognized image type: "+t);const n=await Stt(this,t,e);return t===YJ.SVG?function(t,e){const n=new Blob([t],{type:"image/svg+xml"});return window.URL.createObjectURL(n)}(n.svg()):n.canvas().toDataURL("image/png")},toCanvas:async function(t,e){return(await Stt(this,YJ.Canvas,t,e)).canvas()},toSVG:async function(t){return(await Stt(this,YJ.SVG,t)).svg()},getState:function(t){return this._runtime.getState(t||{data:Ttt,signals:Itt,recurse:!0})},setState:function(t){return this.runAsync(null,(e=>{e._trigger=!1,e._runtime.setState(t)}),(t=>{t._trigger=!0})),this},_watchPixelRatio:function(){if("canvas"===this.renderer()&&this._renderer._canvas){let t=null;const e=()=>{null!=t&&t();const n=matchMedia(`(resolution: ${window.devicePixelRatio}dppx)`);n.addEventListener("change",e),t=()=>{n.removeEventListener("change",e)},this._renderer._canvas.getContext("2d").pixelRatio=window.devicePixelRatio||1,this._redraw=!0,this._resize=1,this.resize().runAsync()};e()}}});const jtt="view",Utt="[",Vtt="]",qtt="{",Wtt="}",Htt=":",Gtt=",",Ytt="@",Xtt=">",Jtt=/[[\]{}]/,Ktt={"*":1,arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1};let Qtt,Ztt;function tet(t,e,n){return Qtt=e||jtt,Ztt=n||Ktt,net(t.trim()).map(ret)}function eet(t,e,n,r,i){const o=t.length;let s,a=0;for(;e<o;++e){if(s=t[e],!a&&s===n)return e;i&&i.indexOf(s)>=0?--a:r&&r.indexOf(s)>=0&&++a}return e}function net(t){const e=[],n=t.length;let r=0,i=0;for(;i<n;)i=eet(t,i,Gtt,Utt+qtt,Vtt+Wtt),e.push(t.substring(r,i).trim()),r=++i;if(0===e.length)throw"Empty event selector: "+t;return e}function ret(t){return"["===t[0]?function(t){const e=t.length;let n,r=1;if(r=eet(t,r,Vtt,Utt,Vtt),r===e)throw"Empty between selector: "+t;if(n=net(t.substring(1,r)),2!==n.length)throw"Between selector must have two elements: "+t;if((t=t.slice(r+1).trim())[0]!==Xtt)throw"Expected '>' after between selector: "+t;n=n.map(ret);const i=ret(t.slice(1).trim());return i.between?{between:n,stream:i}:(i.between=n,i)}(t):function(t){const e={source:Qtt},n=[];let r,i,o=[0,0],s=0,a=0,l=t.length,u=0;if(t[l-1]===Wtt){if(u=t.lastIndexOf(qtt),!(u>=0))throw"Unmatched right brace: "+t;try{o=function(t){const e=t.split(Gtt);if(!t.length||e.length>2)throw t;return e.map((e=>{const n=+e;if(n!=n)throw t;return n}))}(t.substring(u+1,l-1))}catch(e){throw"Invalid throttle specification: "+t}l=(t=t.slice(0,u).trim()).length,u=0}if(!l)throw t;if(t[0]===Ytt&&(s=++u),r=eet(t,u,Htt),r<l&&(n.push(t.substring(a,r).trim()),a=u=++r),u=eet(t,u,Utt),u===l)n.push(t.substring(a,l).trim());else if(n.push(t.substring(a,u).trim()),i=[],a=++u,a===l)throw"Unmatched left bracket: "+t;for(;u<l;){if(u=eet(t,u,Vtt),u===l)throw"Unmatched left bracket: "+t;if(i.push(t.substring(a,u).trim()),u<l-1&&t[++u]!==Utt)throw"Expected left bracket: "+t;a=++u}if(!(l=n.length)||Jtt.test(n[l-1]))throw"Invalid event selector: "+t;return l>1?(e.type=n[1],s?e.markname=n[0].slice(1):function(t){return Ztt[t]}(n[0])?e.marktype=n[0]:e.source=n[0]):e.type=n[0],"!"===e.type.slice(-1)&&(e.consume=!0,e.type=e.type.slice(0,-1)),null!=i&&(e.filter=i),o[0]&&(e.throttle=o[0]),o[1]&&(e.debounce=o[1]),e}(t)}function iet(t){return Z$(t)?t:{type:t||"pad"}}const oet=t=>+t||0,set=t=>({top:t,bottom:t,left:t,right:t});function aet(t){return Z$(t)?t.signal?t:{top:oet(t.top),bottom:oet(t.bottom),left:oet(t.left),right:oet(t.right)}:set(oet(t))}const uet=t=>Z$(t)&&!Q$(t)?$F({},t):{value:t};function cet(t,e,n,r){return null!=n?(Z$(n)&&!Q$(n)||Q$(n)&&n.length&&Z$(n[0])?t.update[e]=n:t[r||"enter"][e]={value:n},1):0}function het(t,e,n){for(const n in e)cet(t,n,e[n]);for(const e in n)cet(t,e,n[e],"update")}function fet(t,e,n){for(const r in e)n&&RF(n,r)||(t[r]=$F(t[r]||{},e[r]));return t}function det(t,e){return e&&(e.enter&&e.enter[t]||e.update&&e.update[t])}const pet="mark",met="frame",get="scope",yet="axis",bet="axis-domain",vet="axis-grid",wet="axis-label",xet="axis-tick",_et="axis-title",ket="legend",Eet="legend-band",Aet="legend-entry",Cet="legend-gradient",Det="legend-label",Met="legend-symbol",Oet="legend-title",Tet="title",Iet="title-text",Net="title-subtitle";function $et(t,e,n){t[e]=n&&n.signal?{signal:n.signal}:{value:n}}const Fet=t=>XF(t)?iL(t):t.signal?`(${t.signal})`:Pet(t);function Let(t){if(null!=t.gradient)return function(t){const e=[t.start,t.stop,t.count].map((t=>null==t?null:iL(t)));for(;e.length&&null==iF(e);)e.pop();return e.unshift(Fet(t.gradient)),`gradient(${e.join(",")})`}(t);let e=t.signal?`(${t.signal})`:t.color?function(t){return t.c?Bet("hcl",t.h,t.c,t.l):t.h||t.s?Bet("hsl",t.h,t.s,t.l):t.l||t.a?Bet("lab",t.l,t.a,t.b):t.r||t.g||t.b?Bet("rgb",t.r,t.g,t.b):null}(t.color):null!=t.field?Pet(t.field):void 0!==t.value?iL(t.value):void 0;return null!=t.scale&&(e=function(t,e){const n=Fet(t.scale);return null!=t.range?e=`lerp(_range(${n}), ${+t.range})`:(void 0!==e&&(e=`_scale(${n}, ${e})`),t.band&&(e=(e?e+"+":"")+`_bandwidth(${n})`+(1==+t.band?"":"*"+Ret(t.band)),t.extra&&(e=`(datum.extra ? _scale(${n}, datum.extra.value) : ${e})`)),null==e&&(e="0")),e}(t,e)),void 0===e&&(e=null),null!=t.exponent&&(e=`pow(${e},${Ret(t.exponent)})`),null!=t.mult&&(e+=`*${Ret(t.mult)}`),null!=t.offset&&(e+=`+${Ret(t.offset)}`),t.round&&(e=`round(${e})`),e}const Bet=(t,e,n,r)=>`(${t}(${[e,n,r].map(Let).join(",")})+'')`;function Ret(t){return Z$(t)?"("+Let(t)+")":t}function Pet(t){return zet(Z$(t)?t:{datum:t})}function zet(t){let e,n,r;if(t.signal)e="datum",r=t.signal;else if(t.group||t.parent){for(n=Math.max(1,t.level||1),e="item";n-- >0;)e+=".mark.group";t.parent?(r=t.parent,e+=".datum"):r=t.group}else t.datum?(e="datum",r=t.datum):L$("Invalid field reference: "+iL(t));return t.signal||(r=XF(r)?B$(r).map(iL).join("]["):zet(r)),e+"["+r+"]"}function jet(t,e,n,r,i,o){const s={};(o=o||{}).encoders={$encode:s},t=function(t,e,n,r,i){const o={},s={};let a,l,u,c;for(l in l="lineBreak","text"!==e||null==i[l]||det(l,t)||$et(o,l,i[l]),("legend"==n||String(n).startsWith("axis"))&&(n=null),c=n===met?i.group:n===pet?$F({},i.mark,i[e]):null,c)u=det(l,t)||("fill"===l||"stroke"===l)&&(det("fill",t)||det("stroke",t)),u||$et(o,l,c[l]);for(l in kF(r).forEach((e=>{const n=i.style&&i.style[e];for(const e in n)det(e,t)||$et(o,e,n[e])})),t=$F({},t),o)c=o[l],c.signal?(a=a||{})[l]=c:s[l]=c;return t.enter=$F(s,t.enter),a&&(t.update=$F(a,t.update)),t}(t,e,n,r,i.config);for(const n in t)s[n]=Uet(t[n],e,o,i);return o}function Uet(t,e,n,r){const i={},o={};for(const e in t)null!=t[e]&&(i[e]=Vet((s=t[e],Q$(s)?function(t){let e="";return t.forEach((t=>{const n=Let(t);e+=t.test?`(${t.test})?${n}:`:n})),":"===iF(e)&&(e+="null"),e}(s):Let(s)),r,n,o));var s;return{$expr:{marktype:e,channels:i},$fields:Object.keys(o),$output:Object.keys(t)}}function Vet(t,e,n,r){const i=L7(t,e);return i.$fields.forEach((t=>r[t]=1)),$F(n,i.$params),i.$expr}const qet="outer",Wet=["value","update","init","react","bind"];function Het(t,e){L$(t+' for "outer" push: '+iL(e))}function Get(t,e){const n=t.name;if(t.push===qet)e.signals[n]||Het("No prior signal definition",n),Wet.forEach((e=>{void 0!==t[e]&&Het("Invalid property ",e)}));else{const r=e.addSignal(n,t.value);!1===t.react&&(r.react=!1),t.bind&&e.addBinding(n,t.bind)}}function Yet(t,e,n,r){this.id=-1,this.type=t,this.value=e,this.params=n,r&&(this.parent=r)}function Xet(t,e,n,r){return new Yet(t,e,n,r)}function Jet(t,e){return Xet("operator",t,e)}function Ket(t){const e={$ref:t.id};return t.id<0&&(t.refs=t.refs||[]).push(e),e}function Qet(t,e){return e?{$field:t,$name:e}:{$field:t}}const Zet=Qet("key");function tnt(t,e){return{$compare:t,$order:e}}function ent(t,e){return(t&&t.signal?"$"+t.signal:t||"")+(t&&e?"_":"")+(e&&e.signal?"$"+e.signal:e||"")}const nnt="scope",rnt="view";function int(t){return t&&t.signal}function ont(t){if(int(t))return!0;if(Z$(t))for(const e in t)if(ont(t[e]))return!0;return!1}function snt(t,e){return null!=t?t:e}function ant(t){return t&&t.signal||t}const lnt="timer";function unt(t,e){return(t.merge?cnt:t.stream?hnt:t.type?fnt:L$("Invalid stream specification: "+iL(t)))(t,e)}function cnt(t,e){const n=dnt({merge:t.merge.map((t=>unt(t,e)))},t,e);return e.addStream(n).id}function hnt(t,e){const n=dnt({stream:unt(t.stream,e)},t,e);return e.addStream(n).id}function fnt(t,e){let n;t.type===lnt?(n=e.event(lnt,t.throttle),t={between:t.between,filter:t.filter}):n=e.event(function(t){return t===nnt?rnt:t||rnt}(t.source),t.type);const r=dnt({stream:n},t,e);return 1===Object.keys(r).length?n:e.addStream(r).id}function dnt(t,e,n){let r=e.between;return r&&(2!==r.length&&L$('Stream "between" parameter must have 2 entries: '+iL(e)),t.between=[unt(r[0],n),unt(r[1],n)]),r=e.filter?[].concat(e.filter):[],(e.marktype||e.markname||e.markrole)&&r.push(function(t,e,n){const r="event.item";return r+(t&&"*"!==t?"&&"+r+".mark.marktype==='"+t+"'":"")+(n?"&&"+r+".mark.role==='"+n+"'":"")+(e?"&&"+r+".mark.name==='"+e+"'":"")}(e.marktype,e.markname,e.markrole)),e.source===nnt&&r.push("inScope(event.item)"),r.length&&(t.filter=L7("("+r.join(")&&(")+")",n).$expr),null!=(r=e.throttle)&&(t.throttle=+r),null!=(r=e.debounce)&&(t.debounce=+r),e.consume&&(t.consume=!0),t}const pnt={code:"_.$value",ast:{type:"Identifier",value:"value"}};function mnt(t){return{signal:"["+t.map((t=>t.scale?'scale("'+t.scale+'")':t.signal))+"]"}}const gnt=t=>(e,n,r)=>Xet(t,n,e||void 0,r),ynt=gnt("aggregate"),bnt=gnt("axisticks"),vnt=gnt("bound"),wnt=gnt("collect"),xnt=gnt("compare"),_nt=gnt("datajoin"),knt=gnt("encode"),Snt=gnt("expression"),Ent=gnt("facet"),Ant=gnt("field"),Cnt=gnt("key"),Dnt=gnt("legendentries"),Mnt=gnt("load"),Ont=gnt("mark"),Tnt=gnt("multiextent"),Int=gnt("multivalues"),Nnt=gnt("overlap"),$nt=gnt("params"),Fnt=gnt("prefacet"),Lnt=gnt("projection"),Bnt=gnt("proxy"),Rnt=gnt("relay"),Pnt=gnt("render"),znt=gnt("scale"),jnt=gnt("sieve"),Unt=gnt("sortitems"),Vnt=gnt("viewlayout"),qnt=gnt("values");let Wnt=0;const Hnt={min:"min",max:"max",count:"sum"};function Gnt(t,e){const n=e.getScale(t.name).params;let r;for(r in n.domain=Knt(t.domain,t,e),null!=t.range&&(n.range=ort(t,e,n)),null!=t.interpolate&&function(t,e){e.interpolate=Ynt(t.type||t),null!=t.gamma&&(e.interpolateGamma=Ynt(t.gamma))}(t.interpolate,n),null!=t.nice&&(n.nice=function(t,e){return t.signal?e.signalRef(t.signal):Z$(t)?{interval:Ynt(t.interval),step:Ynt(t.step)}:Ynt(t)}(t.nice,e)),null!=t.bins&&(n.bins=function(t,e){return t.signal||Q$(t)?Xnt(t,e):e.objectProperty(t)}(t.bins,e)),t)RF(n,r)||"name"===r||(n[r]=Ynt(t[r],e))}function Ynt(t,e){return Z$(t)?t.signal?e.signalRef(t.signal):L$("Unsupported object: "+iL(t)):t}function Xnt(t,e){return t.signal?e.signalRef(t.signal):t.map((t=>Ynt(t,e)))}function Jnt(t){L$("Can not find data set: "+iL(t))}function Knt(t,e,n){if(t)return t.signal?n.signalRef(t.signal):(Q$(t)?Qnt:t.fields?trt:Znt)(t,e,n);null==e.domainMin&&null==e.domainMax||L$("No scale domain defined for domainMin/domainMax to override.")}function Qnt(t,e,n){return t.map((t=>Ynt(t,n)))}function Znt(t,e,n){const r=n.getData(t.data);return r||Jnt(t.data),DW(e.type)?r.valuesRef(n,t.field,nrt(t.sort,!1)):IW(e.type)?r.domainRef(n,t.field):r.extentRef(n,t.field)}function trt(t,e,n){const r=t.data,i=t.fields.reduce(((t,e)=>(e=XF(e)?{data:r,field:e}:Q$(e)||e.signal?function(t,e){const n="_:vega:_"+Wnt++,r=wnt({});if(Q$(t))r.value={$ingest:t};else if(t.signal){const i="setdata("+iL(n)+","+t.signal+")";r.params.input=e.signalRef(i)}return e.addDataPipeline(n,[r,jnt({})]),{data:n,field:"data"}}(e,n):e,t.push(e),t)),[]);return(DW(e.type)?ert:IW(e.type)?rrt:irt)(t,n,i)}function ert(t,e,n){const r=nrt(t.sort,!0);let i,o;const s=n.map((t=>{const n=e.getData(t.data);return n||Jnt(t.data),n.countsRef(e,t.field,r)})),a={groupby:Zet,pulse:s};r&&(i=r.op||"count",o=r.field?ent(i,r.field):"count",a.ops=[Hnt[i]],a.fields=[e.fieldRef(o)],a.as=[o]),i=e.add(ynt(a));const l=e.add(wnt({pulse:Ket(i)}));return o=e.add(qnt({field:Zet,sort:e.sortRef(r),pulse:Ket(l)})),Ket(o)}function nrt(t,e){return t&&(t.field||t.op?t.field||"count"===t.op?e&&t.field&&t.op&&!Hnt[t.op]&&L$("Multiple domain scales can not be sorted using "+t.op):L$("No field provided for sort aggregate op: "+t.op):Z$(t)?t.field="key":t={field:"key"}),t}function rrt(t,e,n){const r=n.map((t=>{const n=e.getData(t.data);return n||Jnt(t.data),n.domainRef(e,t.field)}));return Ket(e.add(Int({values:r})))}function irt(t,e,n){const r=n.map((t=>{const n=e.getData(t.data);return n||Jnt(t.data),n.extentRef(e,t.field)}));return Ket(e.add(Tnt({extents:r})))}function ort(t,e,n){const r=e.config.range;let i=t.range;if(i.signal)return e.signalRef(i.signal);if(XF(i)){if(r&&RF(r,i))return ort(t=$F({},t,{range:r[i]}),e,n);"width"===i?i=[0,{signal:"width"}]:"height"===i?i=DW(t.type)?[0,{signal:"height"}]:[{signal:"height"},0]:L$("Unrecognized scale range value: "+iL(i))}else{if(i.scheme)return n.scheme=Q$(i.scheme)?Xnt(i.scheme,e):Ynt(i.scheme,e),i.extent&&(n.schemeExtent=Xnt(i.extent,e)),void(i.count&&(n.schemeCount=Ynt(i.count,e)));if(i.step)return void(n.rangeStep=Ynt(i.step,e));if(DW(t.type)&&!Q$(i))return Knt(i,t,e);Q$(i)||L$("Unsupported range type: "+iL(i))}return i.map((t=>(Q$(t)?Xnt:Ynt)(t,e)))}function srt(t,e,n){return Q$(t)?t.map((t=>srt(t,e,n))):Z$(t)?t.signal?n.signalRef(t.signal):"fit"===e?t:L$("Unsupported parameter object: "+iL(t)):t}const art="top",lrt="left",urt="right",crt="bottom",hrt="center",frt="vertical",drt="start",prt="end",mrt="index",grt="label",yrt="offset",brt="perc",vrt="perc2",wrt="value",xrt="guide-label",_rt="guide-title",krt="group-title",Srt="group-subtitle",Ert="symbol",Art="gradient",Crt="discrete",Drt="size",Mrt=[Drt,"shape","fill","stroke","strokeWidth","strokeDash","opacity"],Ort={name:1,style:1,interactive:1},Trt={value:0},Irt={value:1},Nrt="group",$rt="rect",Frt="rule",Lrt="symbol",Brt="text";function Rrt(t){return t.type=Nrt,t.interactive=t.interactive||!1,t}function Prt(t,e){const n=(n,r)=>snt(t[n],snt(e[n],r));return n.isVertical=n=>frt===snt(t.direction,e.direction||(n?e.symbolDirection:e.gradientDirection)),n.gradientLength=()=>snt(t.gradientLength,e.gradientLength||e.gradientWidth),n.gradientThickness=()=>snt(t.gradientThickness,e.gradientThickness||e.gradientHeight),n.entryColumns=()=>snt(t.columns,snt(e.columns,+n.isVertical(!0))),n}function zrt(t,e){const n=e&&(e.update&&e.update[t]||e.enter&&e.enter[t]);return n&&n.signal?n:n?n.value:null}function jrt(t,e,n){return`item.anchor === '${drt}' ? ${t} : item.anchor === '${prt}' ? ${e} : ${n}`}const Urt=jrt(iL(lrt),iL(urt),iL(hrt));function Vrt(t,e){return e?t?Z$(t)?Object.assign({},t,{offset:Vrt(t.offset,e)}):{value:t,offset:e}:e:t}function qrt(t,e){return e?(t.name=e.name,t.style=e.style||t.style,t.interactive=!!e.interactive,t.encode=fet(t.encode,e,Ort)):t.interactive=!1,t}function Wrt(t,e,n,r){const i=Prt(t,n),o=i.isVertical(),s=i.gradientThickness(),a=i.gradientLength();let l,u,c,h,f;o?(u=[0,1],c=[0,0],h=s,f=a):(u=[0,0],c=[1,0],h=a,f=s);const d={enter:l={opacity:Trt,x:Trt,y:Trt,width:uet(h),height:uet(f)},update:$F({},l,{opacity:Irt,fill:{gradient:e,start:u,stop:c}}),exit:{opacity:Trt}};return het(d,{stroke:i("gradientStrokeColor"),strokeWidth:i("gradientStrokeWidth")},{opacity:i("gradientOpacity")}),qrt({type:$rt,role:Cet,encode:d},r)}function Hrt(t,e,n,r,i){const o=Prt(t,n),s=o.isVertical(),a=o.gradientThickness(),l=o.gradientLength();let u,c,h,f,d="";s?(u="y",h="y2",c="x",f="width",d="1-"):(u="x",h="x2",c="y",f="height");const p={opacity:Trt,fill:{scale:e,field:wrt}};p[u]={signal:d+"datum."+brt,mult:l},p[c]=Trt,p[h]={signal:d+"datum."+vrt,mult:l},p[f]=uet(a);const m={enter:p,update:$F({},p,{opacity:Irt}),exit:{opacity:Trt}};return het(m,{stroke:o("gradientStrokeColor"),strokeWidth:o("gradientStrokeWidth")},{opacity:o("gradientOpacity")}),qrt({type:$rt,role:Eet,key:wrt,from:i,encode:m},r)}const Grt=`datum.${brt}<=0?"${lrt}":datum.${brt}>=1?"${urt}":"${hrt}"`,Yrt=`datum.${brt}<=0?"${crt}":datum.${brt}>=1?"${art}":"middle"`;function Xrt(t,e,n,r){const i=Prt(t,e),o=i.isVertical(),s=uet(i.gradientThickness()),a=i.gradientLength();let l,u,c,h,f=i("labelOverlap"),d="";const p={enter:l={opacity:Trt},update:u={opacity:Irt,text:{field:grt}},exit:{opacity:Trt}};return het(p,{fill:i("labelColor"),fillOpacity:i("labelOpacity"),font:i("labelFont"),fontSize:i("labelFontSize"),fontStyle:i("labelFontStyle"),fontWeight:i("labelFontWeight"),limit:snt(t.labelLimit,e.gradientLabelLimit)}),o?(l.align={value:"left"},l.baseline=u.baseline={signal:Yrt},c="y",h="x",d="1-"):(l.align=u.align={signal:Grt},l.baseline={value:"top"},c="x",h="y"),l[c]=u[c]={signal:d+"datum."+brt,mult:a},l[h]=u[h]=s,s.offset=snt(t.labelOffset,e.gradientLabelOffset)||0,f=f?{separation:i("labelSeparation"),method:f,order:"datum."+mrt}:void 0,qrt({type:Brt,role:Det,style:xrt,key:wrt,from:r,encode:p,overlap:f},n)}function Jrt(t,e,n,r,i){const o=Prt(t,e),s=n.entries,a=!(!s||!s.interactive),l=s?s.name:void 0,u=o("clipHeight"),c=o("symbolOffset"),h={data:"value"},f=`(${i}) ? datum.${yrt} : datum.${Drt}`,d=u?uet(u):{field:Drt},p=`datum.${mrt}`,m=`max(1, ${i})`;let g,y,b,v,w;d.mult=.5,g={enter:y={opacity:Trt,x:{signal:f,mult:.5,offset:c},y:d},update:b={opacity:Irt,x:y.x,y:y.y},exit:{opacity:Trt}};let x=null,_=null;t.fill||(x=e.symbolBaseFillColor,_=e.symbolBaseStrokeColor),het(g,{fill:o("symbolFillColor",x),shape:o("symbolType"),size:o("symbolSize"),stroke:o("symbolStrokeColor",_),strokeDash:o("symbolDash"),strokeDashOffset:o("symbolDashOffset"),strokeWidth:o("symbolStrokeWidth")},{opacity:o("symbolOpacity")}),Mrt.forEach((e=>{t[e]&&(b[e]=y[e]={scale:t[e],field:wrt})}));const k=qrt({type:Lrt,role:Met,key:wrt,from:h,clip:!!u||void 0,encode:g},n.symbols),S=uet(c);S.offset=o("labelOffset"),g={enter:y={opacity:Trt,x:{signal:f,offset:S},y:d},update:b={opacity:Irt,text:{field:grt},x:y.x,y:y.y},exit:{opacity:Trt}},het(g,{align:o("labelAlign"),baseline:o("labelBaseline"),fill:o("labelColor"),fillOpacity:o("labelOpacity"),font:o("labelFont"),fontSize:o("labelFontSize"),fontStyle:o("labelFontStyle"),fontWeight:o("labelFontWeight"),limit:o("labelLimit")});const E=qrt({type:Brt,role:Det,style:xrt,key:wrt,from:h,encode:g},n.labels);return g={enter:{noBound:{value:!u},width:Trt,height:u?uet(u):Trt,opacity:Trt},exit:{opacity:Trt},update:b={opacity:Irt,row:{signal:null},column:{signal:null}}},o.isVertical(!0)?(v=`ceil(item.mark.items.length / ${m})`,b.row.signal=`${p}%${v}`,b.column.signal=`floor(${p} / ${v})`,w={field:["row",p]}):(b.row.signal=`floor(${p} / ${m})`,b.column.signal=`${p} % ${m}`,w={field:p}),b.column.signal=`(${i})?${b.column.signal}:${p}`,Rrt({role:get,from:r={facet:{data:r,name:"value",groupby:mrt}},encode:fet(g,s,Ort),marks:[k,E],name:l,interactive:a,sort:w})}const Krt='item.orient === "left"',Qrt='item.orient === "right"',Zrt=`(${Krt} || ${Qrt})`,tit=`datum.vgrad && ${Zrt}`,eit=jrt('"top"','"bottom"','"middle"'),nit=`datum.vgrad && ${Qrt} ? (${jrt('"right"','"left"','"center"')}) : (${Zrt} && !(datum.vgrad && ${Krt})) ? "left" : ${Urt}`,rit=`item._anchor || (${Zrt} ? "middle" : "start")`,iit=`${tit} ? (${Krt} ? -90 : 90) : 0`,oit=`${Zrt} ? (datum.vgrad ? (${Qrt} ? "bottom" : "top") : ${eit}) : "top"`;function sit(t,e){let n;return Z$(t)&&(t.signal?n=t.signal:t.path?n="pathShape("+ait(t.path)+")":t.sphere&&(n="geoShape("+ait(t.sphere)+', {type: "Sphere"})')),n?e.signalRef(n):!!t}function ait(t){return Z$(t)&&t.signal?t.signal:iL(t)}function lit(t){const e=t.role||"";return e.startsWith("axis")||e.startsWith("legend")||e.startsWith("title")?e:t.type===Nrt?get:e||pet}function uit(t){return{marktype:t.type,name:t.name||void 0,role:t.role||lit(t),zindex:+t.zindex||void 0,aria:t.aria,description:t.description}}function cit(t,e){return t&&t.signal?e.signalRef(t.signal):!1!==t}function hit(t,e){const n=mP(t.type);n||L$("Unrecognized transform type: "+iL(t.type));const r=Xet(n.type.toLowerCase(),null,fit(n,t,e));return t.signal&&e.addSignal(t.signal,e.proxy(r)),r.metadata=n.metadata||{},r}function fit(t,e,n){const r={},i=t.params.length;for(let o=0;o<i;++o){const i=t.params[o];r[i.name]=dit(i,e,n)}return r}function dit(t,e,n){const r=t.type,i=e[t.name];return"index"===r?function(t,e,n){return XF(e.from)||L$('Lookup "from" parameter must be a string literal.'),n.getData(e.from).lookupRef(n,e.key)}(0,e,n):void 0!==i?"param"===r?function(t,e,n){const r=e[t.name];return t.array?(Q$(r)||L$("Expected an array of sub-parameters. Instead: "+iL(r)),r.map((e=>mit(t,e,n)))):mit(t,r,n)}(t,e,n):"projection"===r?n.projectionRef(e[t.name]):t.array&&!int(i)?i.map((e=>pit(t,e,n))):pit(t,i,n):void(t.required&&L$("Missing required "+iL(e.type)+" parameter: "+iL(t.name)))}function pit(t,e,n){const r=t.type;if(int(e))return vit(r)?L$("Expression references can not be signals."):wit(r)?n.fieldRef(e):xit(r)?n.compareRef(e):n.signalRef(e.signal);{const i=t.expr||wit(r);return i&&git(e)?n.exprRef(e.expr,e.as):i&&yit(e)?Qet(e.field,e.as):vit(r)?L7(e,n):bit(r)?Ket(n.getData(e).values):wit(r)?Qet(e):xit(r)?n.compareRef(e):e}}function mit(t,e,n){const r=t.params.length;let i;for(let n=0;n<r;++n){i=t.params[n];for(const t in i.key)if(i.key[t]!==e[t]){i=null;break}if(i)break}i||L$("Unsupported parameter: "+iL(e));const o=$F(fit(i,e,n),i.key);return Ket(n.add($nt(o)))}const git=t=>t&&t.expr,yit=t=>t&&t.field,bit=t=>"data"===t,vit=t=>"expr"===t,wit=t=>"field"===t,xit=t=>"compare"===t;function _it(t,e){return t.$ref?t:t.data&&t.data.$ref?t.data:Ket(e.getData(t.data).output)}function kit(t,e,n,r,i){this.scope=t,this.input=e,this.output=n,this.values=r,this.aggregate=i,this.index={}}function Sit(t){return XF(t)?t:null}function Eit(t,e,n){const r=ent(n.op,n.field);let i;if(e.ops){for(let t=0,n=e.as.length;t<n;++t)if(e.as[t]===r)return}else e.ops=["count"],e.fields=[null],e.as=["count"];n.op&&(e.ops.push((i=n.op.signal)?t.signalRef(i):n.op),e.fields.push(t.fieldRef(n.field)),e.as.push(r))}function Ait(t,e,n,r,i,o,s){const a=e[n]||(e[n]={}),l=function(t){return Z$(t)?("descending"===t.order?"-":"+")+ent(t.op,t.field):""}(o);let u,c,h=Sit(i);if(null!=h&&(t=e.scope,h+=l?"|"+l:"",u=a[h]),!u){const n=o?{field:Zet,pulse:e.countsRef(t,i,o)}:{field:t.fieldRef(i),pulse:Ket(e.output)};l&&(n.sort=t.sortRef(o)),c=t.add(Xet(r,void 0,n)),s&&(e.index[i]=c),u=Ket(c),null!=h&&(a[h]=u)}return u}function Cit(t,e,n){const r=t.remove,i=t.insert,o=t.toggle,s=t.modify,a=t.values,l=e.add(Jet()),u=L7("if("+t.trigger+',modify("'+n+'",'+[i,r,o,s,a].map((t=>null==t?"null":t)).join(",")+"),0)",e);l.update=u.$expr,l.params=u.$params}function Dit(t,e){const n=lit(t),r=t.type===Nrt,i=t.from&&t.from.facet,o=t.overlap;let s,a,l,u,c,h,f,d=t.layout||n===get||n===met;const p=n===pet||d||i,m=function(t,e,n){let r,i,o,s,a;return t?(r=t.facet)&&(e||L$("Only group marks can be faceted."),null!=r.field?s=a=_it(r,n):(t.data?a=Ket(n.getData(t.data).aggregate):(o=hit($F({type:"aggregate",groupby:kF(r.groupby)},r.aggregate),n),o.params.key=n.keyRef(r.groupby),o.params.pulse=_it(r,n),s=a=Ket(n.add(o))),i=n.keyRef(r.groupby,!0))):s=Ket(n.add(wnt(null,[{}]))),s||(s=_it(t,n)),{key:i,pulse:s,parent:a}}(t.from,r,e);a=e.add(_nt({key:m.key||(t.key?Qet(t.key):void 0),pulse:m.pulse,clean:!r}));const g=Ket(a);a=l=e.add(wnt({pulse:g})),a=e.add(Ont({markdef:uit(t),interactive:cit(t.interactive,e),clip:sit(t.clip,e),context:{$context:!0},groups:e.lookup(),parent:e.signals.parent?e.signalRef("parent"):null,index:e.markpath(),pulse:Ket(a)}));const y=Ket(a);a=u=e.add(knt(jet(t.encode,t.type,n,t.style,e,{mod:!1,pulse:y}))),a.params.parent=e.encode(),t.transform&&t.transform.forEach((t=>{const n=hit(t,e),r=n.metadata;(r.generates||r.changes)&&L$("Mark transforms should not generate new data."),r.nomod||(u.params.mod=!0),n.params.pulse=Ket(a),e.add(a=n)})),t.sort&&(a=e.add(Unt({sort:e.compareRef(t.sort),pulse:Ket(a)})));const b=Ket(a);(i||d)&&(d=e.add(Vnt({layout:e.objectProperty(t.layout),legends:e.legends,mark:y,pulse:b})),h=Ket(d));const v=e.add(vnt({mark:y,pulse:h||b}));f=Ket(v),r&&(p&&(s=e.operators,s.pop(),d&&s.pop()),e.pushState(b,h||f,g),i?function(t,e,n){const r=t.from.facet,i=r.name,o=_it(r,e);let s;r.name||L$("Facet must have a name: "+iL(r)),r.data||L$("Facet must reference a data set: "+iL(r)),r.field?s=e.add(Fnt({field:e.fieldRef(r.field),pulse:o})):r.groupby?s=e.add(Ent({key:e.keyRef(r.groupby),group:Ket(e.proxy(n.parent)),pulse:o})):L$("Facet must specify groupby or field: "+iL(r));const a=e.fork(),l=a.add(wnt()),u=a.add(jnt({pulse:Ket(l)}));a.addData(i,new kit(a,l,l,u)),a.addSignal("parent",null),s.params.subflow={$subflow:a.parse(t).toRuntime()}}(t,e,m):p?function(t,e,n){const r=e.add(Fnt({pulse:n.pulse})),i=e.fork();i.add(jnt()),i.addSignal("parent",null),r.params.subflow={$subflow:i.parse(t).toRuntime()}}(t,e,m):e.parse(t),e.popState(),p&&(d&&s.push(d),s.push(v))),o&&(f=function(t,e,n){const r=t.method,i=t.bound,o=t.separation,s={separation:int(o)?n.signalRef(o.signal):o,method:int(r)?n.signalRef(r.signal):r,pulse:e};if(t.order&&(s.sort=n.compareRef({field:t.order})),i){const t=i.tolerance;s.boundTolerance=int(t)?n.signalRef(t.signal):+t,s.boundScale=n.scaleRef(i.scale),s.boundOrient=i.orient}return Ket(n.add(Nnt(s)))}(o,f,e));const w=e.add(Pnt({pulse:f})),x=e.add(jnt({pulse:Ket(w)},void 0,e.parent()));null!=t.name&&(c=t.name,e.addData(c,new kit(e,l,w,x)),t.on&&t.on.forEach((t=>{(t.insert||t.remove||t.toggle)&&L$("Marks only support modify triggers."),Cit(t,e,c)})))}function Mit(t,e,n){const r={enter:{},update:{}};return het(r,{orient:t("orient"),offset:t("offset"),padding:t("padding"),titlePadding:t("titlePadding"),cornerRadius:t("cornerRadius"),fill:t("fillColor"),stroke:t("strokeColor"),strokeWidth:n.strokeWidth,strokeDash:n.strokeDash,x:t("legendX"),y:t("legendY"),format:e.format,formatType:e.formatType}),r}function Oit(t,e,n){return e[t]?`scale("${e[t]}",datum)`:zrt(t,n[0].encode)}kit.fromEntries=function(t,e){const n=e.length,r=e[n-1],i=e[n-2];let o=e[0],s=null,a=1;for(o&&"load"===o.type&&(o=e[1]),t.add(e[0]);a<n;++a)e[a].params.pulse=Ket(e[a-1]),t.add(e[a]),"aggregate"===e[a].type&&(s=e[a]);return new kit(t,o,i,r,s)},kit.prototype={countsRef(t,e,n){const r=this,i=r.counts||(r.counts={}),o=Sit(e);let s,a,l;return null!=o&&(t=r.scope,s=i[o]),s?n&&n.field&&Eit(t,s.agg.params,n):(l={groupby:t.fieldRef(e,"key"),pulse:Ket(r.output)},n&&n.field&&Eit(t,l,n),a=t.add(ynt(l)),s=t.add(wnt({pulse:Ket(a)})),s={agg:a,ref:Ket(s)},null!=o&&(i[o]=s)),s.ref},tuplesRef(){return Ket(this.values)},extentRef(t,e){return Ait(t,this,"extent","extent",e,!1)},domainRef(t,e){return Ait(t,this,"domain","values",e,!1)},valuesRef(t,e,n){return Ait(t,this,"vals","values",e,n||!0)},lookupRef(t,e){return Ait(t,this,"lookup","tupleindex",e,!1)},indataRef(t,e){return Ait(t,this,"indata","tupleindex",e,!0,!0)}};const Tit=`item.orient==="${lrt}"?-90:item.orient==="${urt}"?90:0`;function Iit(t,e){const n={enter:{},update:{}};return het(n,{orient:t("orient"),anchor:t("anchor"),align:{signal:Urt},angle:{signal:Tit},limit:t("limit"),frame:t("frame"),offset:t("offset")||0,padding:t("subtitlePadding")}),fet(n,e,Ort)}function Nit(t){const e=wnt({},t);return e.metadata={source:!0},e}function $it(t,e){return Mnt({url:e.url?t.property(e.url):void 0,async:e.async?t.property(e.async):void 0,values:e.values?t.property(e.values):void 0,format:t.objectProperty(e.format)})}const Fit=t=>t===crt||t===art,Lit=(t,e,n)=>int(t)?Vit(t.signal,e,n):t===lrt||t===art?e:n,Bit=(t,e,n)=>int(t)?jit(t.signal,e,n):Fit(t)?e:n,Rit=(t,e,n)=>int(t)?Uit(t.signal,e,n):Fit(t)?n:e,Pit=(t,e,n)=>int(t)?qit(t.signal,e,n):t===art?{value:e}:{value:n},zit=(t,e,n)=>int(t)?Wit(t.signal,e,n):t===urt?{value:e}:{value:n},jit=(t,e,n)=>Hit(`${t} === '${art}' || ${t} === '${crt}'`,e,n),Uit=(t,e,n)=>Hit(`${t} !== '${art}' && ${t} !== '${crt}'`,e,n),Vit=(t,e,n)=>Yit(`${t} === '${lrt}' || ${t} === '${art}'`,e,n),qit=(t,e,n)=>Yit(`${t} === '${art}'`,e,n),Wit=(t,e,n)=>Yit(`${t} === '${urt}'`,e,n),Hit=(t,e,n)=>(e=null!=e?uet(e):e,n=null!=n?uet(n):n,Git(e)&&Git(n)?{signal:`${t} ? (${e=e?e.signal||iL(e.value):null}) : (${n=n?n.signal||iL(n.value):null})`}:[$F({test:t},e)].concat(n||[])),Git=t=>null==t||1===Object.keys(t).length,Yit=(t,e,n)=>({signal:`${t} ? (${Jit(e)}) : (${Jit(n)})`}),Xit=(t,e,n,r,i)=>({signal:(null!=r?`${t} === '${lrt}' ? (${Jit(r)}) : `:"")+(null!=n?`${t} === '${crt}' ? (${Jit(n)}) : `:"")+(null!=i?`${t} === '${urt}' ? (${Jit(i)}) : `:"")+(null!=e?`${t} === '${art}' ? (${Jit(e)}) : `:"")+"(null)"}),Jit=t=>int(t)?t.signal:null==t?null:iL(t),Kit=(t,e)=>0===e?0:int(t)?{signal:`(${t.signal}) * ${e}`}:{value:t*e},Qit=(t,e)=>{const n=t.signal;return n&&n.endsWith("(null)")?{signal:n.slice(0,-6)+e.signal}:t};function Zit(t,e,n,r){let i;if(e&&RF(e,t))return e[t];if(RF(n,t))return n[t];if(t.startsWith("title")){switch(t){case"titleColor":i="fill";break;case"titleFont":case"titleFontSize":case"titleFontWeight":i=t[5].toLowerCase()+t.slice(6)}return r[_rt][i]}if(t.startsWith("label")){switch(t){case"labelColor":i="fill";break;case"labelFont":case"labelFontSize":i=t[5].toLowerCase()+t.slice(6)}return r[xrt][i]}return null}function tot(t){const e={};for(const n of t)if(n)for(const t in n)e[t]=1;return Object.keys(e)}function eot(t,e){return{scale:t.scale,range:e}}function not(t,e,n,r,i){return{signal:'flush(range("'+t+'"), scale("'+t+'", datum.value), '+e+","+n+","+r+","+i+")"}}function rot(t,e){const n=function(t,e){var n,r,i,o=e.config,s=o.style,a=o.axis,l="band"===e.scaleType(t.scale)&&o.axisBand,u=t.orient;if(int(u)){const t=tot([o.axisX,o.axisY]),e=tot([o.axisTop,o.axisBottom,o.axisLeft,o.axisRight]);for(i of(n={},t))n[i]=Bit(u,Zit(i,o.axisX,a,s),Zit(i,o.axisY,a,s));for(i of(r={},e))r[i]=Xit(u.signal,Zit(i,o.axisTop,a,s),Zit(i,o.axisBottom,a,s),Zit(i,o.axisLeft,a,s),Zit(i,o.axisRight,a,s))}else n=u===art||u===crt?o.axisX:o.axisY,r=o["axis"+u[0].toUpperCase()+u.slice(1)];return n||r||l?$F({},a,n,r,l):a}(t,e),r=t.encode||{},i=r.axis||{},o=i.name||void 0,s=i.interactive,a=i.style,l=Prt(t,n),u=function(t){const e=t("tickBand");let n,r,i=t("tickOffset");return e?e.signal?(n={signal:`(${e.signal}) === 'extent' ? 1 : 0.5`},r={signal:`(${e.signal}) === 'extent'`},Z$(i)||(i={signal:`(${e.signal}) === 'extent' ? 0 : ${i}`})):"extent"===e?(n=1,r=!0,i=0):(n=.5,r=!1):(n=t("bandPosition"),r=t("tickExtra")),{extra:r,band:n,offset:i}}(l),c={scale:t.scale,ticks:!!l("ticks"),labels:!!l("labels"),grid:!!l("grid"),domain:!!l("domain"),title:null!=t.title},h=Ket(e.add(wnt({},[c]))),f=Ket(e.add(bnt({scale:e.scaleRef(t.scale),extra:e.property(u.extra),count:e.objectProperty(t.tickCount),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)}))),d=[];let p;return c.grid&&d.push(function(t,e,n,r,i){const o=Prt(t,e),s=t.orient,a=t.gridScale,l=Lit(s,1,-1),u=function(t,e){if(1===e);else if(Z$(t)){let n=t=$F({},t);for(;null!=n.mult;){if(!Z$(n.mult))return n.mult=int(e)?{signal:`(${n.mult}) * (${e.signal})`}:n.mult*e,t;n=n.mult=$F({},n.mult)}n.mult=e}else t=int(e)?{signal:`(${e.signal}) * (${t||0})`}:e*(t||0);return t}(t.offset,l);let c,h,f;const d={enter:c={opacity:Trt},update:f={opacity:Irt},exit:h={opacity:Trt}};het(d,{stroke:o("gridColor"),strokeCap:o("gridCap"),strokeDash:o("gridDash"),strokeDashOffset:o("gridDashOffset"),strokeOpacity:o("gridOpacity"),strokeWidth:o("gridWidth")});const p={scale:t.scale,field:wrt,band:i.band,extra:i.extra,offset:i.offset,round:o("tickRound")},m=Bit(s,{signal:"height"},{signal:"width"}),g=a?{scale:a,range:0,mult:l,offset:u}:{value:0,offset:u},y=a?{scale:a,range:1,mult:l,offset:u}:$F(m,{mult:l,offset:u});return c.x=f.x=Bit(s,p,g),c.y=f.y=Rit(s,p,g),c.x2=f.x2=Rit(s,y),c.y2=f.y2=Bit(s,y),h.x=Bit(s,p),h.y=Rit(s,p),qrt({type:Frt,role:vet,key:wrt,from:r,encode:d},n)}(t,n,r.grid,f,u)),c.ticks&&(p=l("tickSize"),d.push(function(t,e,n,r,i,o){const s=Prt(t,e),a=t.orient,l=Lit(a,-1,1);let u,c,h;const f={enter:u={opacity:Trt},update:h={opacity:Irt},exit:c={opacity:Trt}};het(f,{stroke:s("tickColor"),strokeCap:s("tickCap"),strokeDash:s("tickDash"),strokeDashOffset:s("tickDashOffset"),strokeOpacity:s("tickOpacity"),strokeWidth:s("tickWidth")});const d=uet(i);d.mult=l;const p={scale:t.scale,field:wrt,band:o.band,extra:o.extra,offset:o.offset,round:s("tickRound")};return h.y=u.y=Bit(a,Trt,p),h.y2=u.y2=Bit(a,d),c.x=Bit(a,p),h.x=u.x=Rit(a,Trt,p),h.x2=u.x2=Rit(a,d),c.y=Rit(a,p),qrt({type:Frt,role:xet,key:wrt,from:r,encode:f},n)}(t,n,r.ticks,f,p,u))),c.labels&&(p=c.ticks?p:0,d.push(function(t,e,n,r,i,o){const s=Prt(t,e),a=t.orient,l=t.scale,u=Lit(a,-1,1),c=ant(s("labelFlush")),h=ant(s("labelFlushOffset")),f=s("labelAlign"),d=s("labelBaseline");let p,m=0===c||!!c;const g=uet(i);g.mult=u,g.offset=uet(s("labelPadding")||0),g.offset.mult=u;const y={scale:l,field:wrt,band:.5,offset:Vrt(o.offset,s("labelOffset"))},b=Bit(a,m?not(l,c,'"left"','"right"','"center"'):{value:"center"},zit(a,"left","right")),v=Bit(a,Pit(a,"bottom","top"),m?not(l,c,'"top"','"bottom"','"middle"'):{value:"middle"}),w=not(l,c,`-(${h})`,h,0);m=m&&h;const x={opacity:Trt,x:Bit(a,y,g),y:Rit(a,y,g)},_={enter:x,update:p={opacity:Irt,text:{field:grt},x:x.x,y:x.y,align:b,baseline:v},exit:{opacity:Trt,x:x.x,y:x.y}};het(_,{dx:!f&&m?Bit(a,w):null,dy:!d&&m?Rit(a,w):null}),het(_,{angle:s("labelAngle"),fill:s("labelColor"),fillOpacity:s("labelOpacity"),font:s("labelFont"),fontSize:s("labelFontSize"),fontWeight:s("labelFontWeight"),fontStyle:s("labelFontStyle"),limit:s("labelLimit"),lineHeight:s("labelLineHeight")},{align:f,baseline:d});const k=s("labelBound");let S=s("labelOverlap");return S=S||k?{separation:s("labelSeparation"),method:S,order:"datum.index",bound:k?{scale:l,orient:a,tolerance:k}:null}:void 0,p.align!==b&&(p.align=Qit(p.align,b)),p.baseline!==v&&(p.baseline=Qit(p.baseline,v)),qrt({type:Brt,role:wet,style:xrt,key:wrt,from:r,encode:_,overlap:S},n)}(t,n,r.labels,f,p,u))),c.domain&&d.push(function(t,e,n,r){const i=Prt(t,e),o=t.orient;let s,a;const l={enter:s={opacity:Trt},update:a={opacity:Irt},exit:{opacity:Trt}};het(l,{stroke:i("domainColor"),strokeCap:i("domainCap"),strokeDash:i("domainDash"),strokeDashOffset:i("domainDashOffset"),strokeWidth:i("domainWidth"),strokeOpacity:i("domainOpacity")});const u=eot(t,0),c=eot(t,1);return s.x=a.x=Bit(o,u,Trt),s.x2=a.x2=Bit(o,c),s.y=a.y=Rit(o,u,Trt),s.y2=a.y2=Rit(o,c),qrt({type:Frt,role:bet,from:r,encode:l},n)}(t,n,r.domain,h)),c.title&&d.push(function(t,e,n,r){const i=Prt(t,e),o=t.orient,s=Lit(o,-1,1);let a,l;const u={enter:a={opacity:Trt,anchor:uet(i("titleAnchor",null)),align:{signal:Urt}},update:l=$F({},a,{opacity:Irt,text:uet(t.title)}),exit:{opacity:Trt}},c={signal:`lerp(range("${t.scale}"), ${jrt(0,1,.5)})`};return l.x=Bit(o,c),l.y=Rit(o,c),a.angle=Bit(o,Trt,Kit(s,90)),a.baseline=Bit(o,Pit(o,crt,art),{value:crt}),l.angle=a.angle,l.baseline=a.baseline,het(u,{fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),angle:i("titleAngle"),baseline:i("titleBaseline")}),function(t,e,n,r){const i=(t,e)=>null!=t?(n.update[e]=Qit(uet(t),n.update[e]),!1):!det(e,r),o=i(t("titleX"),"x"),s=i(t("titleY"),"y");n.enter.auto=s===o?uet(s):Bit(e,uet(s),uet(o))}(i,o,u,n),u.update.align=Qit(u.update.align,a.align),u.update.angle=Qit(u.update.angle,a.angle),u.update.baseline=Qit(u.update.baseline,a.baseline),qrt({type:Brt,role:_et,style:_rt,from:r,encode:u},n)}(t,n,r.title,h)),Dit(Rrt({role:yet,from:h,encode:fet(iot(l,t),i,Ort),marks:d,aria:l("aria"),description:l("description"),zindex:l("zindex"),name:o,interactive:s,style:a}),e)}function iot(t,e){const n={enter:{},update:{}};return het(n,{orient:t("orient"),offset:t("offset")||0,position:snt(e.position,0),titlePadding:t("titlePadding"),minExtent:t("minExtent"),maxExtent:t("maxExtent"),range:{signal:`abs(span(range("${e.scale}")))`},translate:t("translate"),format:e.format,formatType:e.formatType}),n}function oot(t,e,n){const r=kF(t.signals),i=kF(t.scales);return n||r.forEach((t=>Get(t,e))),kF(t.projections).forEach((t=>function(t,e){const n=e.config.projection||{},r={};for(const n in t)"name"!==n&&(r[n]=srt(t[n],n,e));for(const t in n)null==r[t]&&(r[t]=srt(n[t],t,e));e.addProjection(t.name,r)}(t,e))),i.forEach((t=>function(t,e){const n=t.type||"linear";EW(n)||L$("Unrecognized scale type: "+iL(n)),e.addScale(t.name,{type:n,domain:void 0})}(t,e))),kF(t.data).forEach((t=>function(t,e){const n=[];t.transform&&t.transform.forEach((t=>{n.push(hit(t,e))})),t.on&&t.on.forEach((n=>{Cit(n,e,t.name)})),e.addDataPipeline(t.name,function(t,e,n){const r=[];let i,o,s,a,l,u=null,c=!1,h=!1;for(t.values?int(t.values)||ont(t.format)?(r.push($it(e,t)),r.push(u=Nit())):r.push(u=Nit({$ingest:t.values,$format:t.format})):t.url?ont(t.url)||ont(t.format)?(r.push($it(e,t)),r.push(u=Nit())):r.push(u=Nit({$request:t.url,$format:t.format})):t.source&&(u=i=kF(t.source).map((t=>Ket(e.getData(t).output))),r.push(null)),o=0,s=n.length;o<s;++o)a=n[o],l=a.metadata,u||l.source||r.push(u=Nit()),r.push(a),l.generates&&(h=!0),l.modifies&&!h&&(c=!0),l.source?u=a:l.changes&&(u=null);return i&&(s=i.length-1,r[0]=Rnt({derive:c,pulse:s?i:i[0]}),(c||s)&&r.splice(1,0,Nit())),u||r.push(Nit()),r.push(jnt({})),r}(t,e,n))}(t,e))),i.forEach((t=>Gnt(t,e))),(n||r).forEach((t=>function(t,e){const n=e.getSignal(t.name);let r=t.update;t.init&&(r?L$("Signals can not include both init and update expressions."):(r=t.init,n.initonly=!0)),r&&(r=L7(r,e),n.update=r.$expr,n.params=r.$params),t.on&&t.on.forEach((t=>function(t,e,n){const r=t.encode,i={target:n};let o=t.events,s=t.update,a=[];o||L$("Signal update missing events specification."),XF(o)&&(o=tet(o,e.isSubscope()?nnt:rnt)),o=kF(o).filter((t=>t.signal||t.scale?(a.push(t),0):1)),a.length>1&&(a=[mnt(a)]),o.length&&a.push(o.length>1?{merge:o}:o[0]),null!=r&&(s&&L$("Signal encode and update are mutually exclusive."),s="encode(item(),"+iL(r)+")"),i.update=XF(s)?L7(s,e):null!=s.expr?L7(s.expr,e):null!=s.value?s.value:null!=s.signal?{$expr:pnt,$params:{$value:e.signalRef(s.signal)}}:L$("Invalid signal update specification."),t.force&&(i.options={force:!0}),a.forEach((t=>e.addUpdate($F(function(t,e){return{source:t.signal?e.signalRef(t.signal):t.scale?e.scaleRef(t.scale):unt(t,e)}}(t,e),i))))}(t,e,n.id)))}(t,e))),kF(t.axes).forEach((t=>rot(t,e))),kF(t.marks).forEach((t=>Dit(t,e))),kF(t.legends).forEach((t=>function(t,e){const n=e.config.legend,r=t.encode||{},i=Prt(t,n),o=r.legend||{},s=o.name||void 0,a=o.interactive,l=o.style,u={};let c,h,f,d=0;Mrt.forEach((e=>t[e]?(u[e]=t[e],d=d||t[e]):0)),d||L$("Missing valid scale for legend.");const p=function(t,e){let n=t.type||Ert;return t.type||1!==function(t){return Mrt.reduce(((e,n)=>e+(t[n]?1:0)),0)}(t)||!t.fill&&!t.stroke||(n=CW(e)?Art:MW(e)?Crt:Ert),n!==Art?n:MW(e)?Crt:Art}(t,e.scaleType(d)),m={title:null!=t.title,scales:u,type:p,vgrad:"symbol"!==p&&i.isVertical()},g=Ket(e.add(wnt(null,[m]))),y=Ket(e.add(Dnt(h={type:p,scale:e.scaleRef(d),count:e.objectProperty(i("tickCount")),limit:e.property(i("symbolLimit")),values:e.objectProperty(t.values),minstep:e.property(t.tickMinStep),formatType:e.property(t.formatType),formatSpecifier:e.property(t.format)})));return p===Art?(f=[Wrt(t,d,n,r.gradient),Xrt(t,n,r.labels,y)],h.count=h.count||e.signalRef(`max(2,2*floor((${ant(i.gradientLength())})/100))`)):p===Crt?f=[Hrt(t,d,n,r.gradient,y),Xrt(t,n,r.labels,y)]:(c=function(t,e){const n=Prt(t,e);return{align:n("gridAlign"),columns:n.entryColumns(),center:{row:!0,column:!1},padding:{row:n("rowPadding"),column:n("columnPadding")}}}(t,n),f=[Jrt(t,n,r,y,ant(c.columns))],h.size=function(t,e,n){const r=ant(Oit("size",t,n)),i=ant(Oit("strokeWidth",t,n)),o=ant(function(t,e,n){return zrt("fontSize",t)||function(t,e,n){const r=e.config.style[n];return r&&r.fontSize}(0,e,n)}(n[1].encode,e,xrt));return L7(`max(ceil(sqrt(${r})+${i}),${o})`,e)}(t,e,f[0].marks)),f=[Rrt({role:Aet,from:g,encode:{enter:{x:{value:0},y:{value:0}}},marks:f,layout:c,interactive:a})],m.title&&f.push(function(t,e,n,r){const i=Prt(t,e),o={enter:{opacity:Trt},update:{opacity:Irt,x:{field:{group:"padding"}},y:{field:{group:"padding"}}},exit:{opacity:Trt}};return het(o,{orient:i("titleOrient"),_anchor:i("titleAnchor"),anchor:{signal:rit},angle:{signal:iit},align:{signal:nit},baseline:{signal:oit},text:t.title,fill:i("titleColor"),fillOpacity:i("titleOpacity"),font:i("titleFont"),fontSize:i("titleFontSize"),fontStyle:i("titleFontStyle"),fontWeight:i("titleFontWeight"),limit:i("titleLimit"),lineHeight:i("titleLineHeight")},{align:i("titleAlign"),baseline:i("titleBaseline")}),qrt({type:Brt,role:Oet,style:_rt,from:r,encode:o},n)}(t,n,r.title,g)),Dit(Rrt({role:ket,from:g,encode:fet(Mit(i,t,n),o,Ort),marks:f,aria:i("aria"),description:i("description"),zindex:i("zindex"),name:s,interactive:a,style:l}),e)}(t,e))),t.title&&function(t,e){const n=Prt(t=XF(t)?{text:t}:t,e.config.title),r=t.encode||{},i=r.group||{},o=i.name||void 0,s=i.interactive,a=i.style,l=[],u=Ket(e.add(wnt(null,[{}])));l.push(function(t,e,n,r){const i={value:0},o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return het(o,{text:t.text,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("color"),font:e("font"),fontSize:e("fontSize"),fontStyle:e("fontStyle"),fontWeight:e("fontWeight"),lineHeight:e("lineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),qrt({type:Brt,role:Iet,style:krt,from:r,encode:o},n)}(t,n,function(t){const e=t.encode;return e&&e.title||$F({name:t.name,interactive:t.interactive,style:t.style},e)}(t),u)),t.subtitle&&l.push(function(t,e,n,r){const i={value:0},o={enter:{opacity:i},update:{opacity:{value:1}},exit:{opacity:i}};return het(o,{text:t.subtitle,align:{signal:"item.mark.group.align"},angle:{signal:"item.mark.group.angle"},limit:{signal:"item.mark.group.limit"},baseline:"top",dx:e("dx"),dy:e("dy"),fill:e("subtitleColor"),font:e("subtitleFont"),fontSize:e("subtitleFontSize"),fontStyle:e("subtitleFontStyle"),fontWeight:e("subtitleFontWeight"),lineHeight:e("subtitleLineHeight")},{align:e("align"),angle:e("angle"),baseline:e("baseline")}),qrt({type:Brt,role:Net,style:Srt,from:r,encode:o},n)}(t,n,r.subtitle,u)),Dit(Rrt({role:Tet,from:u,encode:Iit(n,i),marks:l,aria:n("aria"),description:n("description"),zindex:n("zindex"),name:o,interactive:s,style:a}),e)}(t.title,e),e.parseLambdas(),e}const sot=t=>fet({enter:{x:{value:0},y:{value:0}},update:{width:{signal:"width"},height:{signal:"height"}}},t);function aot(t,e){return e&&e.signal?{name:t,update:e.signal}:{name:t,value:e}}function lot(t,e){this.config=t||{},this.options=e||{},this.bindings=[],this.field={},this.signals={},this.lambdas={},this.scales={},this.events={},this.data={},this.streams=[],this.updates=[],this.operators=[],this.eventConfig=null,this.locale=null,this._id=0,this._subid=0,this._nextsub=[0],this._parent=[],this._encode=[],this._lookup=[],this._markpath=[]}function uot(t){this.config=t.config,this.options=t.options,this.legends=t.legends,this.field=Object.create(t.field),this.signals=Object.create(t.signals),this.lambdas=Object.create(t.lambdas),this.scales=Object.create(t.scales),this.events=Object.create(t.events),this.data=Object.create(t.data),this.streams=[],this.updates=[],this.operators=[],this._id=0,this._subid=++t._nextsub[0],this._nextsub=t._nextsub,this._parent=t._parent.slice(),this._encode=t._encode.slice(),this._lookup=t._lookup.slice(),this._markpath=t._markpath}function cot(t){return(Q$(t)?hot:fot)(t)}function hot(t){const e=t.length;let n="[";for(let r=0;r<e;++r){const e=t[r];n+=(r>0?",":"")+(Z$(e)?e.signal||cot(e):iL(e))}return n+"]"}function fot(t){let e,n,r="{",i=0;for(e in t)n=t[e],r+=(++i>1?",":"")+iL(e)+":"+(Z$(n)?n.signal||cot(n):iL(n));return r+"}"}function dot(t,e,n){return Z$(t)||L$("Input Vega specification must be an object."),e=eF(function(){const t="sans-serif",e="#4c78a8",n="#000",r="#888",i="#ddd";return{description:"Vega visualization",padding:0,autosize:"pad",background:null,events:{defaults:{allow:["wheel"]}},group:null,mark:null,arc:{fill:e},area:{fill:e},image:null,line:{stroke:e,strokeWidth:2},path:{stroke:e},rect:{fill:e},rule:{stroke:n},shape:{stroke:e},symbol:{fill:e,size:64},text:{fill:n,font:t,fontSize:11},trail:{fill:e,size:2},style:{"guide-label":{fill:n,font:t,fontSize:10},"guide-title":{fill:n,font:t,fontSize:11,fontWeight:"bold"},"group-title":{fill:n,font:t,fontSize:13,fontWeight:"bold"},"group-subtitle":{fill:n,font:t,fontSize:12},point:{size:30,strokeWidth:2,shape:"circle"},circle:{size:30,strokeWidth:2},square:{size:30,strokeWidth:2,shape:"square"},cell:{fill:"transparent",stroke:i},view:{fill:"transparent"}},title:{orient:"top",anchor:"middle",offset:4,subtitlePadding:3},axis:{minExtent:0,maxExtent:200,bandPosition:.5,domain:!0,domainWidth:1,domainColor:r,grid:!1,gridWidth:1,gridColor:i,labels:!0,labelAngle:0,labelLimit:180,labelOffset:0,labelPadding:2,ticks:!0,tickColor:r,tickOffset:0,tickRound:!0,tickSize:5,tickWidth:1,titlePadding:4},axisBand:{tickOffset:-.5},projection:{type:"mercator"},legend:{orient:"right",padding:0,gridAlign:"each",columnPadding:10,rowPadding:2,symbolDirection:"vertical",gradientDirection:"vertical",gradientLength:200,gradientThickness:16,gradientStrokeColor:i,gradientStrokeWidth:0,gradientLabelOffset:2,labelAlign:"left",labelBaseline:"middle",labelLimit:160,labelOffset:4,labelOverlap:!0,symbolLimit:30,symbolType:"circle",symbolSize:100,symbolOffset:0,symbolStrokeWidth:1.5,symbolBaseFillColor:"transparent",symbolBaseStrokeColor:r,titleLimit:180,titleOrient:"top",titlePadding:5,layout:{offset:18,direction:"horizontal",left:{direction:"vertical"},right:{direction:"vertical"}}},range:{category:{scheme:"tableau10"},ordinal:{scheme:"blues"},heatmap:{scheme:"yellowgreenblue"},ramp:{scheme:"blues"},diverging:{scheme:"blueorange",extent:[1,0]},symbol:["circle","square","triangle-up","cross","diamond","triangle-right","triangle-down","triangle-left"]}}}(),e,t.config),function(t,e){const n=e.config,r=Ket(e.root=e.add(Jet())),i=function(t,e){const n=n=>snt(t[n],e[n]),r=[aot("background",n("background")),aot("autosize",iet(n("autosize"))),aot("padding",aet(n("padding"))),aot("width",n("width")||0),aot("height",n("height")||0)],i=r.reduce(((t,e)=>(t[e.name]=e,t)),{}),o={};return kF(t.signals).forEach((t=>{RF(i,t.name)?t=$F(i[t.name],t):r.push(t),o[t.name]=t})),kF(e.signals).forEach((t=>{RF(o,t.name)||RF(i,t.name)||r.push(t)})),r}(t,n);i.forEach((t=>Get(t,e))),e.description=t.description||n.description,e.eventConfig=n.events,e.legends=e.objectProperty(n.legend&&n.legend.layout),e.locale=n.locale;const o=e.add(wnt()),s=e.add(knt(jet(sot(t.encode),Nrt,met,t.style,e,{pulse:Ket(o)}))),a=e.add(Vnt({layout:e.objectProperty(t.layout),legends:e.legends,autosize:e.signalRef("autosize"),mark:r,pulse:Ket(s)}));e.operators.pop(),e.pushState(Ket(s),Ket(a),null),oot(t,e,i),e.operators.push(a);let l=e.add(vnt({mark:r,pulse:Ket(a)}));return l=e.add(Pnt({pulse:Ket(l)})),l=e.add(jnt({pulse:Ket(l)})),e.addData("root",new kit(e,o,o,l)),e}(t,new lot(e,n)).toRuntime()}lot.prototype=uot.prototype={parse(t){return oot(t,this)},fork(){return new uot(this)},isSubscope(){return this._subid>0},toRuntime(){return this.finish(),{description:this.description,operators:this.operators,streams:this.streams,updates:this.updates,bindings:this.bindings,eventConfig:this.eventConfig,locale:this.locale}},id(){return(this._subid?this._subid+":":0)+this._id++},add(t){return this.operators.push(t),t.id=this.id(),t.refs&&(t.refs.forEach((e=>{e.$ref=t.id})),t.refs=null),t},proxy(t){const e=t instanceof Yet?Ket(t):t;return this.add(Bnt({value:e}))},addStream(t){return this.streams.push(t),t.id=this.id(),t},addUpdate(t){return this.updates.push(t),t},finish(){let t,e;for(t in this.root&&(this.root.root=!0),this.signals)this.signals[t].signal=t;for(t in this.scales)this.scales[t].scale=t;function n(t,e,n){let r,i;t&&(r=t.data||(t.data={}),i=r[e]||(r[e]=[]),i.push(n))}for(t in this.data){e=this.data[t],n(e.input,t,"input"),n(e.output,t,"output"),n(e.values,t,"values");for(const r in e.index)n(e.index[r],t,"index:"+r)}return this},pushState(t,e,n){this._encode.push(Ket(this.add(jnt({pulse:t})))),this._parent.push(e),this._lookup.push(n?Ket(this.proxy(n)):null),this._markpath.push(-1)},popState(){this._encode.pop(),this._parent.pop(),this._lookup.pop(),this._markpath.pop()},parent(){return iF(this._parent)},encode(){return iF(this._encode)},lookup(){return iF(this._lookup)},markpath(){const t=this._markpath;return++t[t.length-1]},fieldRef(t,e){if(XF(t))return Qet(t,e);t.signal||L$("Unsupported field reference: "+iL(t));const n=t.signal;let r=this.field[n];if(!r){const t={name:this.signalRef(n)};e&&(t.as=e),this.field[n]=r=Ket(this.add(Ant(t)))}return r},compareRef(t){let e=!1;const n=t=>int(t)?(e=!0,this.signalRef(t.signal)):function(t){return t&&t.expr}(t)?(e=!0,this.exprRef(t.expr)):t,r=kF(t.field).map(n),i=kF(t.order).map(n);return e?Ket(this.add(xnt({fields:r,orders:i}))):tnt(r,i)},keyRef(t,e){let n=!1;const r=this.signals;return t=kF(t).map((t=>int(t)?(n=!0,Ket(r[t.signal])):t)),n?Ket(this.add(Cnt({fields:t,flat:e}))):function(t,e){const n={$key:t};return e&&(n.$flat=!0),n}(t,e)},sortRef(t){if(!t)return t;const e=ent(t.op,t.field),n=t.order||"ascending";return n.signal?Ket(this.add(xnt({fields:e,orders:this.signalRef(n.signal)}))):tnt(e,n)},event(t,e){const n=t+":"+e;if(!this.events[n]){const r=this.id();this.streams.push({id:r,source:t,type:e}),this.events[n]=r}return this.events[n]},hasOwnSignal(t){return RF(this.signals,t)},addSignal(t,e){this.hasOwnSignal(t)&&L$("Duplicate signal name: "+iL(t));const n=e instanceof Yet?e:this.add(Jet(e));return this.signals[t]=n},getSignal(t){return this.signals[t]||L$("Unrecognized signal name: "+iL(t)),this.signals[t]},signalRef(t){return this.signals[t]?Ket(this.signals[t]):(RF(this.lambdas,t)||(this.lambdas[t]=this.add(Jet(null))),Ket(this.lambdas[t]))},parseLambdas(){const t=Object.keys(this.lambdas);for(let e=0,n=t.length;e<n;++e){const n=t[e],r=L7(n,this),i=this.lambdas[n];i.params=r.$params,i.update=r.$expr}},property(t){return t&&t.signal?this.signalRef(t.signal):t},objectProperty(t){return t&&Z$(t)?this.signalRef(t.signal||cot(t)):t},exprRef(t,e){const n={expr:L7(t,this)};return e&&(n.expr.$name=e),Ket(this.add(Snt(n)))},addBinding(t,e){this.bindings||L$("Nested signals do not support binding: "+iL(t)),this.bindings.push($F({signal:t},e))},addScaleProj(t,e){RF(this.scales,t)&&L$("Duplicate scale or projection name: "+iL(t)),this.scales[t]=this.add(e)},addScale(t,e){this.addScaleProj(t,znt(e))},addProjection(t,e){this.addScaleProj(t,Lnt(e))},getScale(t){return this.scales[t]||L$("Unrecognized scale name: "+iL(t)),this.scales[t]},scaleRef(t){return Ket(this.getScale(t))},scaleType(t){return this.getScale(t).params.type},projectionRef(t){return this.scaleRef(t)},projectionType(t){return this.scaleType(t)},addData(t,e){return RF(this.data,t)&&L$("Duplicate data set name: "+iL(t)),this.data[t]=e},getData(t){return this.data[t]||L$("Undefined data set name: "+iL(t)),this.data[t]},addDataPipeline(t,e){return RF(this.data,t)&&L$("Duplicate data set name: "+iL(t)),this.addData(t,kit.fromEntries(this,e))}};var pot="5.29.0";$F(pP,r,o,s,a,l,c,u,h,f,d,p);var mot={NaN:NaN,E:Math.E,LN2:Math.LN2,LN10:Math.LN10,LOG2E:Math.LOG2E,LOG10E:Math.LOG10E,PI:Math.PI,SQRT1_2:Math.SQRT1_2,SQRT2:Math.SQRT2,MIN_VALUE:Number.MIN_VALUE,MAX_VALUE:Number.MAX_VALUE},got={"*":(t,e)=>t*e,"+":(t,e)=>t+e,"-":(t,e)=>t-e,"/":(t,e)=>t/e,"%":(t,e)=>t%e,">":(t,e)=>t>e,"<":(t,e)=>t<e,"<=":(t,e)=>t<=e,">=":(t,e)=>t>=e,"==":(t,e)=>t==e,"!=":(t,e)=>t!=e,"===":(t,e)=>t===e,"!==":(t,e)=>t!==e,"&":(t,e)=>t&e,"|":(t,e)=>t|e,"^":(t,e)=>t^e,"<<":(t,e)=>t<<e,">>":(t,e)=>t>>e,">>>":(t,e)=>t>>>e},yot={"+":t=>+t,"-":t=>-t,"~":t=>~t,"!":t=>!t};const bot=Array.prototype.slice,vot=(t,e,n)=>{const r=n?n(e[0]):e[0];return r[t].apply(r,bot.call(e,1))};var wot={isNaN:Number.isNaN,isFinite:Number.isFinite,abs:Math.abs,acos:Math.acos,asin:Math.asin,atan:Math.atan,atan2:Math.atan2,ceil:Math.ceil,cos:Math.cos,exp:Math.exp,floor:Math.floor,log:Math.log,max:Math.max,min:Math.min,pow:Math.pow,random:Math.random,round:Math.round,sin:Math.sin,sqrt:Math.sqrt,tan:Math.tan,clamp:(t,e,n)=>Math.max(e,Math.min(n,t)),now:Date.now,utc:Date.UTC,datetime:(t,e,n,r,i,o,s)=>new Date(t,e||0,null!=n?n:1,r||0,i||0,o||0,s||0),date:t=>new Date(t).getDate(),day:t=>new Date(t).getDay(),year:t=>new Date(t).getFullYear(),month:t=>new Date(t).getMonth(),hours:t=>new Date(t).getHours(),minutes:t=>new Date(t).getMinutes(),seconds:t=>new Date(t).getSeconds(),milliseconds:t=>new Date(t).getMilliseconds(),time:t=>new Date(t).getTime(),timezoneoffset:t=>new Date(t).getTimezoneOffset(),utcdate:t=>new Date(t).getUTCDate(),utcday:t=>new Date(t).getUTCDay(),utcyear:t=>new Date(t).getUTCFullYear(),utcmonth:t=>new Date(t).getUTCMonth(),utchours:t=>new Date(t).getUTCHours(),utcminutes:t=>new Date(t).getUTCMinutes(),utcseconds:t=>new Date(t).getUTCSeconds(),utcmilliseconds:t=>new Date(t).getUTCMilliseconds(),length:t=>t.length,join:function(){return vot("join",arguments)},indexof:function(){return vot("indexOf",arguments)},lastindexof:function(){return vot("lastIndexOf",arguments)},slice:function(){return vot("slice",arguments)},reverse:t=>t.slice().reverse(),parseFloat,parseInt,upper:t=>String(t).toUpperCase(),lower:t=>String(t).toLowerCase(),substring:function(){return vot("substring",arguments,String)},split:function(){return vot("split",arguments,String)},replace:function(){return vot("replace",arguments,String)},trim:t=>String(t).trim(),regexp:RegExp,test:(t,e)=>RegExp(t).test(e)};const xot=["view","item","group","xy","x","y"],_ot=new Set([Function,eval,setTimeout,setInterval]);"function"==typeof setImmediate&&_ot.add(setImmediate);const kot={Literal:(t,e)=>e.value,Identifier:(t,e)=>{const n=e.name;return t.memberDepth>0?n:"datum"===n?t.datum:"event"===n?t.event:"item"===n?t.item:mot[n]||t.params["$"+n]},MemberExpression:(t,e)=>{const n=!e.computed,r=t(e.object);n&&(t.memberDepth+=1);const i=t(e.property);if(n&&(t.memberDepth-=1),!_ot.has(r[i]))return r[i];console.error(`Prevented interpretation of member "${i}" which could lead to insecure code execution`)},CallExpression:(t,e)=>{const n=e.arguments;let r=e.callee.name;return r.startsWith("_")&&(r=r.slice(1)),"if"===r?t(n[0])?t(n[1]):t(n[2]):(t.fn[r]||wot[r]).apply(t.fn,n.map(t))},ArrayExpression:(t,e)=>e.elements.map(t),BinaryExpression:(t,e)=>got[e.operator](t(e.left),t(e.right)),UnaryExpression:(t,e)=>yot[e.operator](t(e.argument)),ConditionalExpression:(t,e)=>t(e.test)?t(e.consequent):t(e.alternate),LogicalExpression:(t,e)=>"&&"===e.operator?t(e.left)&&t(e.right):t(e.left)||t(e.right),ObjectExpression:(t,e)=>e.properties.reduce(((e,n)=>{t.memberDepth+=1;const r=t(n.key);return t.memberDepth-=1,_ot.has(t(n.value))?console.error(`Prevented interpretation of property "${r}" which could lead to insecure code execution`):e[r]=t(n.value),e}),{})};function Sot(t,e,n,r,i,o){const s=t=>kot[t.type](s,t);return s.memberDepth=0,s.fn=Object.create(e),s.params=n,s.datum=r,s.event=i,s.item=o,xot.forEach((t=>s.fn[t]=function(){return i.vega[t](...arguments)})),s(t)}var Eot={operator(t,e){const n=e.ast,r=t.functions;return t=>Sot(n,r,t)},parameter(t,e){const n=e.ast,r=t.functions;return(t,e)=>Sot(n,r,e,t)},event(t,e){const n=e.ast,r=t.functions;return t=>Sot(n,r,void 0,void 0,t)},handler(t,e){const n=e.ast,r=t.functions;return(t,e)=>{const i=e.item&&e.item.datum;return Sot(n,r,t,i,e)}},encode(t,e){const{marktype:n,channels:r}=e,i=t.functions,o="group"===n||"image"===n||"rect"===n;return(t,e)=>{const s=t.datum;let a,l=0;for(const n in r)a=Sot(r[n].ast,i,e,s,void 0,t),t[n]!==a&&(t[n]=a,l=1);return"rule"!==n&&function(t,e,n){let r;e.x2&&(e.x?(n&&t.x>t.x2&&(r=t.x,t.x=t.x2,t.x2=r),t.width=t.x2-t.x):t.x=t.x2-(t.width||0)),e.xc&&(t.x=t.xc-(t.width||0)/2),e.y2&&(e.y?(n&&t.y>t.y2&&(r=t.y,t.y=t.y2,t.y2=r),t.height=t.y2-t.y):t.y=t.y2-(t.height||0)),e.yc&&(t.y=t.yc-(t.height||0)/2)}(t,r,o),l}}};function Aot(t){return!!t.or}function Cot(t){return!!t.and}function Dot(t){return!!t.not}function Mot(t,e){if(Dot(t))Mot(t.not,e);else if(Cot(t))for(const n of t.and)Mot(n,e);else if(Aot(t))for(const n of t.or)Mot(n,e);else e(t)}function Oot(t,e){return Dot(t)?{not:Oot(t.not,e)}:Cot(t)?{and:t.and.map((t=>Oot(t,e)))}:Aot(t)?{or:t.or.map((t=>Oot(t,e)))}:e(t)}const Tot=structuredClone;function Iot(t){throw new Error(t)}function Not(t,e){const n={};for(const r of e)RF(t,r)&&(n[r]=t[r]);return n}function $ot(t,e){const n={...t};for(const t of e)delete n[t];return n}function Fot(t){if(GF(t))return t;const e=XF(t)?t:wst(t);if(e.length<250)return e;let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return n}function Lot(t){return!1===t||null===t}function Bot(t,e){return t.includes(e)}function Rot(t,e){let n=0;for(const[r,i]of t.entries())if(e(i,r,n++))return!0;return!1}function Pot(t,e){let n=0;for(const[r,i]of t.entries())if(!e(i,r,n++))return!1;return!0}function zot(t,...e){for(const n of e)jot(t,n??{});return t}function jot(t,e){for(const n of Xot(e))nF(t,n,e[n],!0)}function Uot(t,e){const n=[],r={};let i;for(const o of t)i=e(o),i in r||(r[i]=1,n.push(o));return n}function Vot(t,e){const n=Xot(t),r=Xot(e);if(n.length!==r.length)return!1;for(const r of n)if(t[r]!==e[r])return!1;return!0}function qot(t,e){if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0}function Wot(t,e){for(const n of t)if(e.has(n))return!0;return!1}function Hot(t){const e=new Set;for(const n of t){const t=B$(n).map(((t,e)=>0===e?t:`[${t}]`)),r=t.map(((e,n)=>t.slice(0,n+1).join("")));for(const t of r)e.add(t)}return e}function Got(t,e){return void 0===t||void 0===e||Wot(Hot(t),Hot(e))}function Yot(t){return 0===Xot(t).length}Set.prototype.toJSON=function(){return`Set(${[...this].map((t=>wst(t))).join(",")})`};const Xot=Object.keys,Jot=Object.values,Kot=Object.entries;function Qot(t){return!0===t||!1===t}function Zot(t){const e=t.replace(/\W/g,"_");return(t.match(/^\d+/)?"_":"")+e}function tst(t,e){return Dot(t)?`!(${tst(t.not,e)})`:Cot(t)?`(${t.and.map((t=>tst(t,e))).join(") && (")})`:Aot(t)?`(${t.or.map((t=>tst(t,e))).join(") || (")})`:e(t)}function est(t,e){if(0===e.length)return!0;const n=e.shift();return n in t&&est(t[n],e)&&delete t[n],Yot(t)}function nst(t){return t.charAt(0).toUpperCase()+t.substr(1)}function rst(t,e="datum"){const n=B$(t),r=[];for(let t=1;t<=n.length;t++){const i=`[${n.slice(0,t).map(iL).join("][")}]`;r.push(`${e}${i}`)}return r.join(" && ")}function ist(t,e="datum"){return`${e}[${iL(B$(t).join("."))}]`}function ost(t){return t.replace(/(\[|\]|\.|'|")/g,"\\$1")}function sst(t){return`${B$(t).map(ost).join("\\.")}`}function ast(t,e,n){return t.replace(new RegExp(e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&"),"g"),n)}function lst(t){return`${B$(t).join(".")}`}function ust(t){return t?B$(t).length:0}function cst(...t){for(const e of t)if(void 0!==e)return e}let hst=42;function fst(t){const e=++hst;return t?String(t)+e:e}function dst(){hst=42}function pst(t){return mst(t)?t:`__${t}`}function mst(t){return t.startsWith("__")}function gst(t){if(void 0!==t)return(t%360+360)%360}function yst(t){return!!GF(t)||!isNaN(t)&&!isNaN(parseFloat(t))}const bst=Object.getPrototypeOf(structuredClone({}));function vst(t,e){if(t===e)return!0;if(t&&e&&"object"==typeof t&&"object"==typeof e){if(t.constructor.name!==e.constructor.name)return!1;let n,r;if(Array.isArray(t)){if(n=t.length,n!=e.length)return!1;for(r=n;0!=r--;)if(!vst(t[r],e[r]))return!1;return!0}if(t instanceof Map&&e instanceof Map){if(t.size!==e.size)return!1;for(r of t.entries())if(!e.has(r[0]))return!1;for(r of t.entries())if(!vst(r[1],e.get(r[0])))return!1;return!0}if(t instanceof Set&&e instanceof Set){if(t.size!==e.size)return!1;for(r of t.entries())if(!e.has(r[0]))return!1;return!0}if(ArrayBuffer.isView(t)&&ArrayBuffer.isView(e)){if(n=t.length,n!=e.length)return!1;for(r=n;0!=r--;)if(t[r]!==e[r])return!1;return!0}if(t.constructor===RegExp)return t.source===e.source&&t.flags===e.flags;if(t.valueOf!==Object.prototype.valueOf&&t.valueOf!==bst.valueOf)return t.valueOf()===e.valueOf();if(t.toString!==Object.prototype.toString&&t.toString!==bst.toString)return t.toString()===e.toString();const i=Object.keys(t);if(n=i.length,n!==Object.keys(e).length)return!1;for(r=n;0!=r--;)if(!Object.prototype.hasOwnProperty.call(e,i[r]))return!1;for(r=n;0!=r--;){const n=i[r];if(!vst(t[n],e[n]))return!1}return!0}return t!=t&&e!=e}function wst(t){const e=[];return function t(n){if(n&&n.toJSON&&"function"==typeof n.toJSON&&(n=n.toJSON()),void 0===n)return;if("number"==typeof n)return isFinite(n)?""+n:"null";if("object"!=typeof n)return JSON.stringify(n);let r,i;if(Array.isArray(n)){for(i="[",r=0;r<n.length;r++)r&&(i+=","),i+=t(n[r])||"null";return i+"]"}if(null===n)return"null";if(e.includes(n))throw new TypeError("Converting circular structure to JSON");const o=e.push(n)-1,s=Object.keys(n).sort();for(i="",r=0;r<s.length;r++){const e=s[r],o=t(n[e]);o&&(i&&(i+=","),i+=JSON.stringify(e)+":"+o)}return e.splice(o,1),`{${i}}`}(t)}const xst="row",_st="column",kst="facet",Sst="x",Est="y",Ast="x2",Cst="y2",Dst="xOffset",Mst="yOffset",Ost="radius",Tst="radius2",Ist="theta",Nst="theta2",$st="latitude",Fst="longitude",Lst="latitude2",Bst="longitude2",Rst="color",Pst="fill",zst="stroke",jst="shape",Ust="size",Vst="angle",qst="opacity",Wst="fillOpacity",Hst="strokeOpacity",Gst="strokeWidth",Yst="strokeDash",Xst="text",Jst="order",Kst="detail",Qst="key",Zst="tooltip",tat="href",eat="url",nat="description",rat={theta:1,theta2:1,radius:1,radius2:1};function iat(t){return t in rat}const oat={longitude:1,longitude2:1,latitude:1,latitude2:1};function sat(t){switch(t){case $st:return"y";case Lst:return"y2";case Fst:return"x";case Bst:return"x2"}}function aat(t){return t in oat}const lat=Xot(oat),uat={x:1,y:1,x2:1,y2:1,...rat,...oat,xOffset:1,yOffset:1,color:1,fill:1,stroke:1,opacity:1,fillOpacity:1,strokeOpacity:1,strokeWidth:1,strokeDash:1,size:1,angle:1,shape:1,order:1,text:1,detail:1,key:1,tooltip:1,href:1,url:1,description:1};function cat(t){return t===Rst||t===Pst||t===zst}const hat={row:1,column:1,facet:1},fat=Xot(hat),dat={...uat,...hat},pat=Xot(dat),{order:mat,detail:gat,tooltip:yat,...bat}=dat,{row:vat,column:wat,facet:xat,..._at}=bat;function kat(t){return!!dat[t]}Xot(bat),Xot(_at);const Sat=[Ast,Cst,Lst,Bst,Nst,Tst];function Eat(t){return Aat(t)!==t}function Aat(t){switch(t){case Ast:return Sst;case Cst:return Est;case Lst:return $st;case Bst:return Fst;case Nst:return Ist;case Tst:return Ost}return t}function Cat(t){if(iat(t))switch(t){case Ist:return"startAngle";case Nst:return"endAngle";case Ost:return"outerRadius";case Tst:return"innerRadius"}return t}function Dat(t){switch(t){case Sst:return Ast;case Est:return Cst;case $st:return Lst;case Fst:return Bst;case Ist:return Nst;case Ost:return Tst}}function Mat(t){switch(t){case Sst:case Ast:return"width";case Est:case Cst:return"height"}}function Oat(t){switch(t){case Sst:return"xOffset";case Est:return"yOffset";case Ast:return"x2Offset";case Cst:return"y2Offset";case Ist:return"thetaOffset";case Ost:return"radiusOffset";case Nst:return"theta2Offset";case Tst:return"radius2Offset"}}function Tat(t){switch(t){case Sst:return"xOffset";case Est:return"yOffset"}}function Iat(t){switch(t){case"xOffset":return"x";case"yOffset":return"y"}}const Nat=Xot(uat),{x:$at,y:Fat,x2:Lat,y2:Bat,xOffset:Rat,yOffset:Pat,latitude:zat,longitude:jat,latitude2:Uat,longitude2:Vat,theta:qat,theta2:Wat,radius:Hat,radius2:Gat,...Yat}=uat,Xat=Xot(Yat),Jat={x:1,y:1},Kat=Xot(Jat);function Qat(t){return t in Jat}const Zat={theta:1,radius:1},tlt=Xot(Zat);function elt(t){return"width"===t?Sst:Est}const nlt={xOffset:1,yOffset:1};function rlt(t){return t in nlt}Xot(nlt);const{text:ilt,tooltip:olt,href:slt,url:alt,description:llt,detail:ult,key:clt,order:hlt,...flt}=Yat,dlt=Xot(flt),plt={...Jat,...Zat,...nlt,...flt},mlt=Xot(plt);function glt(t){return!!plt[t]}const ylt={arc:"always",area:"always",bar:"always",circle:"always",geoshape:"always",image:"always",line:"always",rule:"always",point:"always",rect:"always",square:"always",trail:"always",text:"always",tick:"always"},{geoshape:blt,...vlt}=ylt;function wlt(t){switch(t){case Sst:case Est:case Ist:case Ost:case Dst:case Mst:case Ust:case Vst:case Gst:case qst:case Wst:case Hst:case Ast:case Cst:case Nst:case Tst:return;case kst:case xst:case _st:case jst:case Yst:case Xst:case Zst:case tat:case eat:case nat:return"discrete";case Rst:case Pst:case zst:return"flexible";case $st:case Fst:case Lst:case Bst:case Kst:case Qst:case Jst:return}}const xlt={argmax:1,argmin:1,average:1,count:1,distinct:1,exponential:1,exponentialb:1,product:1,max:1,mean:1,median:1,min:1,missing:1,q1:1,q3:1,ci0:1,ci1:1,stderr:1,stdev:1,stdevp:1,sum:1,valid:1,values:1,variance:1,variancep:1},_lt={count:1,min:1,max:1};function klt(t){return!!t&&!!t.argmin}function Slt(t){return!!t&&!!t.argmax}function Elt(t){return XF(t)&&!!xlt[t]}const Alt=new Set(["count","valid","missing","distinct"]);function Clt(t){return XF(t)&&Alt.has(t)}const Dlt=new Set(["count","sum","distinct","valid","missing"]),Mlt=new Set(["mean","average","median","q1","q3","min","max"]);function Olt(t){return qF(t)&&(t=Lft(t,void 0)),"bin"+Xot(t).map((e=>$lt(t[e])?Zot(`_${e}_${Kot(t[e])}`):Zot(`_${e}_${t[e]}`))).join("")}function Tlt(t){return!0===t||Nlt(t)&&!t.binned}function Ilt(t){return"binned"===t||Nlt(t)&&!0===t.binned}function Nlt(t){return Z$(t)}function $lt(t){return t?.param}function Flt(t){switch(t){case xst:case _st:case Ust:case Rst:case Pst:case zst:case Gst:case qst:case Wst:case Hst:case jst:return 6;case Yst:return 4;default:return 10}}function Llt(t){return!!t?.expr}function Blt(t){const e=Xot(t||{}),n={};for(const r of e)n[r]=Glt(t[r]);return n}function Rlt(t){const{anchor:e,frame:n,offset:r,orient:i,angle:o,limit:s,color:a,subtitleColor:l,subtitleFont:u,subtitleFontSize:c,subtitleFontStyle:h,subtitleFontWeight:f,subtitleLineHeight:d,subtitlePadding:p,...m}=t,g={...e?{anchor:e}:{},...n?{frame:n}:{},...r?{offset:r}:{},...i?{orient:i}:{},...void 0!==o?{angle:o}:{},...void 0!==s?{limit:s}:{}},y={...l?{subtitleColor:l}:{},...u?{subtitleFont:u}:{},...c?{subtitleFontSize:c}:{},...h?{subtitleFontStyle:h}:{},...f?{subtitleFontWeight:f}:{},...d?{subtitleLineHeight:d}:{},...p?{subtitlePadding:p}:{}};return{titleMarkConfig:{...m,...a?{fill:a}:{}},subtitleMarkConfig:Not(t,["align","baseline","dx","dy","limit"]),nonMarkTitleProperties:g,subtitle:y}}function Plt(t){return XF(t)||Q$(t)&&XF(t[0])}function zlt(t){return!!t?.signal}function jlt(t){return!!t.step}function Ult(t){return!Q$(t)&&"field"in t&&"data"in t}const Vlt=Xot({aria:1,description:1,ariaRole:1,ariaRoleDescription:1,blend:1,opacity:1,fill:1,fillOpacity:1,stroke:1,strokeCap:1,strokeWidth:1,strokeOpacity:1,strokeDash:1,strokeDashOffset:1,strokeJoin:1,strokeOffset:1,strokeMiterLimit:1,startAngle:1,endAngle:1,padAngle:1,innerRadius:1,outerRadius:1,size:1,shape:1,interpolate:1,tension:1,orient:1,align:1,baseline:1,text:1,dir:1,dx:1,dy:1,ellipsis:1,limit:1,radius:1,theta:1,angle:1,font:1,fontSize:1,fontWeight:1,fontStyle:1,lineBreak:1,lineHeight:1,cursor:1,href:1,tooltip:1,cornerRadius:1,cornerRadiusTopLeft:1,cornerRadiusTopRight:1,cornerRadiusBottomLeft:1,cornerRadiusBottomRight:1,aspect:1,width:1,height:1,url:1,smooth:1}),qlt={arc:1,area:1,group:1,image:1,line:1,path:1,rect:1,rule:1,shape:1,symbol:1,text:1,trail:1},Wlt=["cornerRadius","cornerRadiusTopLeft","cornerRadiusTopRight","cornerRadiusBottomLeft","cornerRadiusBottomRight"];function Hlt(t){const e=Q$(t.condition)?t.condition.map(Ylt):Ylt(t.condition);return{...Glt(t),condition:e}}function Glt(t){if(Llt(t)){const{expr:e,...n}=t;return{signal:e,...n}}return t}function Ylt(t){if(Llt(t)){const{expr:e,...n}=t;return{signal:e,...n}}return t}function Xlt(t){if(Llt(t)){const{expr:e,...n}=t;return{signal:e,...n}}return zlt(t)?t:void 0!==t?{value:t}:void 0}function Jlt(t){return zlt(t)?t.signal:iL(t)}function Klt(t){return zlt(t)?t.signal:iL(t.value)}function Qlt(t){return zlt(t)?t.signal:null==t?null:iL(t)}function Zlt(t,e,n){for(const r of n){const n=nut(r,e.markDef,e.config);void 0!==n&&(t[r]=Xlt(n))}return t}function tut(t){return[].concat(t.type,t.style??[])}function eut(t,e,n,r={}){const{vgChannel:i,ignoreVgConfig:o}=r;return i&&void 0!==e[i]?e[i]:void 0!==e[t]?e[t]:!o||i&&i!==t?nut(t,e,n,r):void 0}function nut(t,e,n,{vgChannel:r}={}){return cst(r?rut(t,e,n.style):void 0,rut(t,e,n.style),r?n[e.type][r]:void 0,n[e.type][t],r?n.mark[r]:n.mark[t])}function rut(t,e,n){return iut(t,tut(e),n)}function iut(t,e,n){let r;e=kF(e);for(const i of e){const e=n[i];e&&void 0!==e[t]&&(r=e[t])}return r}function out(t,e){return kF(t).reduce(((t,n)=>(t.field.push(_ft(n,e)),t.order.push(n.sort??"ascending"),t)),{field:[],order:[]})}function sut(t,e){const n=[...t];return e.forEach((t=>{for(const e of n)if(vst(e,t))return;n.push(t)})),n}function aut(t,e){return vst(t,e)||!e?t:t?[...kF(t),...kF(e)].join(", "):e}function lut(t,e){const n=t.value,r=e.value;if(null==n||null===r)return{explicit:t.explicit,value:null};if((Plt(n)||zlt(n))&&(Plt(r)||zlt(r)))return{explicit:t.explicit,value:aut(n,r)};if(Plt(n)||zlt(n))return{explicit:t.explicit,value:n};if(Plt(r)||zlt(r))return{explicit:t.explicit,value:r};if(!(Plt(n)||zlt(n)||Plt(r)||zlt(r)))return{explicit:t.explicit,value:sut(n,r)};throw new Error("It should never reach here")}function uut(t){return`Invalid specification ${wst(t)}. Make sure the specification includes at least one of the following properties: "mark", "layer", "facet", "hconcat", "vconcat", "concat", or "repeat".`}const cut='Autosize "fit" only works for single views and layered views.';function hut(t){return("width"==t?"Width":"Height")+' "container" only works for single views and layered views.'}function fut(t){return`${"width"==t?"Width":"Height"} "container" only works well with autosize "fit" or "fit-${"width"==t?"x":"y"}".`}function dut(t){return t?`Dropping "fit-${t}" because spec has discrete ${Mat(t)}.`:'Dropping "fit" because spec has discrete size.'}function put(t){return`Unknown field for ${t}. Cannot calculate view size.`}function mut(t){return`Cannot project a selection on encoding channel "${t}", which has no field.`}function gut(t,e){return`Cannot project a selection on encoding channel "${t}" as it uses an aggregate function ("${e}").`}function yut(t){return`Selection not supported for ${t} yet.`}function but(t){return`The "columns" property cannot be used when "${t}" has nested row/column.`}function vut(t,e,n){return`An ancestor parsed field "${t}" as ${n} but a child wants to parse the field as ${e}.`}function wut(t){return`Config.customFormatTypes is not true, thus custom format type and format for channel ${t} are dropped.`}function xut(t){return`${t}Offset dropped because ${t} is continuous`}function _ut(t){return`Invalid field type "${t}".`}function kut(t,e){const{fill:n,stroke:r}=e;return`Dropping color ${t} as the plot also has ${n&&r?"fill and stroke":n?"fill":"stroke"}.`}function Sut(t,e){return`Dropping ${wst(t)} from channel "${e}" since it does not contain any data field, datum, value, or signal.`}function Eut(t,e,n){return`${t} dropped as it is incompatible with "${e}"${n?` when ${n}`:""}.`}function Aut(t){return`${t} encoding should be discrete (ordinal / nominal / binned).`}function Cut(t){return`${t} encoding should be discrete (ordinal / nominal / binned) or use a discretizing scale (e.g. threshold).`}function Dut(t,e){return`Using discrete channel "${t}" to encode "${e}" field can be misleading as it does not encode ${"ordinal"===e?"order":"magnitude"}.`}function Mut(t){return`Using unaggregated domain with raw field has no effect (${wst(t)}).`}function Out(t){return`Unaggregated domain not applicable for "${t}" since it produces values outside the origin domain of the source data.`}function Tut(t){return`Unaggregated domain is currently unsupported for log scale (${wst(t)}).`}function Iut(t,e,n){return`${n}-scale's "${e}" is dropped as it does not work with ${t} scale.`}function Nut(t){return`The step for "${t}" is dropped because the ${"width"===t?"x":"y"} is continuous.`}const $ut="Domains that should be unioned has conflicting sort properties. Sort will be set to true.";function Fut(t,e){return`Invalid ${t}: ${wst(e)}.`}function Lut(t){return`1D error band does not support ${t}.`}function But(t){return`Channel ${t} is required for "binned" bin.`}const Rut=K$(Y$);let Put=Rut;function zut(...t){Put.warn(...t)}function jut(t){if(t&&Z$(t))for(const e of Xut)if(e in t)return!0;return!1}new WeakMap;const Uut=["january","february","march","april","may","june","july","august","september","october","november","december"],Vut=Uut.map((t=>t.substr(0,3))),qut=["sunday","monday","tuesday","wednesday","thursday","friday","saturday"],Wut=qut.map((t=>t.substr(0,3)));function Hut(t,e){const n=[];if(e&&void 0!==t.day&&Xot(t).length>1&&(zut(function(t){return`Dropping day from datetime ${wst(t)} as day cannot be combined with other units.`}(t)),delete(t=Tot(t)).day),void 0!==t.year?n.push(t.year):n.push(2012),void 0!==t.month){const r=e?function(t){if(yst(t)&&(t=+t),GF(t))return t-1;{const e=t.toLowerCase(),n=Uut.indexOf(e);if(-1!==n)return n;const r=e.substr(0,3),i=Vut.indexOf(r);if(-1!==i)return i;throw new Error(Fut("month",t))}}(t.month):t.month;n.push(r)}else if(void 0!==t.quarter){const r=e?function(t){if(yst(t)&&(t=+t),GF(t))return t>4&&zut(Fut("quarter",t)),t-1;throw new Error(Fut("quarter",t))}(t.quarter):t.quarter;n.push(GF(r)?3*r:`${r}*3`)}else n.push(0);if(void 0!==t.date)n.push(t.date);else if(void 0!==t.day){const r=e?function(t){if(yst(t)&&(t=+t),GF(t))return t%7;{const e=t.toLowerCase(),n=qut.indexOf(e);if(-1!==n)return n;const r=e.substr(0,3),i=Wut.indexOf(r);if(-1!==i)return i;throw new Error(Fut("day",t))}}(t.day):t.day;n.push(GF(r)?r+1:`${r}+1`)}else n.push(1);for(const e of["hours","minutes","seconds","milliseconds"]){const r=t[e];n.push(void 0===r?0:r)}return n}function Gut(t){const e=Hut(t,!0).join(", ");return t.utc?`utc(${e})`:`datetime(${e})`}const Yut={year:1,quarter:1,month:1,week:1,day:1,dayofyear:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1},Xut=Xot(Yut);function Jut(t){return Z$(t)?t.binned:Kut(t)}function Kut(t){return t&&t.startsWith("binned")}function Qut(t){return t.startsWith("utc")}const Zut={"year-month":"%b %Y ","year-month-date":"%b %d, %Y "};function tct(t){return Xut.filter((e=>nct(t,e)))}function ect(t){const e=tct(t);return e[e.length-1]}function nct(t,e){const n=t.indexOf(e);return!(n<0||n>0&&"seconds"===e&&"i"===t.charAt(n-1)||t.length>n+3&&"day"===e&&"o"===t.charAt(n+3)||n>0&&"year"===e&&"f"===t.charAt(n-1))}function rct(t){if(t)return`timeUnitSpecifier(${wst(tct(t))}, ${wst(Zut)})`}function ict(t){if(!t)return;let e;return XF(t)?e=Kut(t)?{unit:t.substring(6),binned:!0}:{unit:t}:Z$(t)&&(e={...t,...t.unit?{unit:t.unit}:{}}),Qut(e.unit)&&(e.utc=!0,e.unit=function(t){return t.substring(3)}(e.unit)),e}function oct(t,e=(t=>t)){const n=ict(t),r=ect(n.unit);if(r&&"day"!==r){const t={year:2001,month:1,date:1,hours:0,minutes:0,seconds:0,milliseconds:0},{step:i,part:o}=act(r,n.step);return`${e(Gut({...t,[o]:+t[o]+i}))} - ${e(Gut(t))}`}}const sct={year:1,month:1,date:1,hours:1,minutes:1,seconds:1,milliseconds:1};function act(t,e=1){if(function(t){return!!sct[t]}(t))return{part:t,step:e};switch(t){case"day":case"dayofyear":return{part:"date",step:e};case"quarter":return{part:"month",step:3*e};case"week":return{part:"date",step:7*e}}}function lct(t){return!!t?.field&&void 0!==t.equal}function uct(t){return!!t?.field&&void 0!==t.lt}function cct(t){return!!t?.field&&void 0!==t.lte}function hct(t){return!!t?.field&&void 0!==t.gt}function fct(t){return!!t?.field&&void 0!==t.gte}function dct(t){if(t?.field){if(Q$(t.range)&&2===t.range.length)return!0;if(zlt(t.range))return!0}return!1}function pct(t){return!!t?.field&&(Q$(t.oneOf)||Q$(t.in))}function mct(t){return pct(t)||lct(t)||dct(t)||uct(t)||hct(t)||cct(t)||fct(t)}function gct(t,e){return Pft(t,{timeUnit:e,wrapTime:!0})}function yct(t,e=!0){const{field:n}=t,r=ict(t.timeUnit),{unit:i,binned:o}=r||{},s=_ft(t,{expr:"datum"}),a=i?`time(${o?s:function(t,e,{end:n}={end:!1}){const r=rst(e),i=Qut(t)?"utc":"";let o;const s={};for(const e of Xut)nct(t,e)&&(s[e]="quarter"===(a=e)?`(${i}quarter(${r})-1)`:`${i}${a}(${r})`,o=e);var a;return n&&(s[o]+="+1"),function(t){const e=Hut(t,!1).join(", ");return t.utc?`utc(${e})`:`datetime(${e})`}(s)}(i,n)})`:s;if(lct(t))return`${a}===${gct(t.equal,i)}`;if(uct(t))return`${a}<${gct(t.lt,i)}`;if(hct(t))return`${a}>${gct(t.gt,i)}`;if(cct(t))return`${a}<=${gct(t.lte,i)}`;if(fct(t))return`${a}>=${gct(t.gte,i)}`;if(pct(t))return`indexof([${function(t,e){return t.map((t=>gct(t,e)))}(t.oneOf,i).join(",")}], ${a}) !== -1`;if(function(t){return!!t?.field&&void 0!==t.valid}(t))return bct(a,t.valid);if(dct(t)){const{range:n}=t,r=zlt(n)?{signal:`${n.signal}[0]`}:n[0],o=zlt(n)?{signal:`${n.signal}[1]`}:n[1];if(null!==r&&null!==o&&e)return"inrange("+a+", ["+gct(r,i)+", "+gct(o,i)+"])";const s=[];return null!==r&&s.push(`${a} >= ${gct(r,i)}`),null!==o&&s.push(`${a} <= ${gct(o,i)}`),s.length>0?s.join(" && "):"true"}throw new Error(`Invalid field predicate: ${wst(t)}`)}function bct(t,e=!0){return e?`isValid(${t}) && isFinite(+${t})`:`!isValid(${t}) || !isFinite(+${t})`}function vct(t){return mct(t)&&t.timeUnit?{...t,timeUnit:ict(t.timeUnit)}:t}const wct={quantitative:"quantitative",ordinal:"ordinal",temporal:"temporal",nominal:"nominal",geojson:"geojson"};function xct(t){return"quantitative"===t||"temporal"===t}function _ct(t){return"ordinal"===t||"nominal"===t}const kct=wct.quantitative,Sct=wct.ordinal,Ect=wct.temporal,Act=wct.nominal,Cct=wct.geojson;Xot(wct);const Dct={LINEAR:"linear",LOG:"log",POW:"pow",SQRT:"sqrt",SYMLOG:"symlog",IDENTITY:"identity",SEQUENTIAL:"sequential",TIME:"time",UTC:"utc",QUANTILE:"quantile",QUANTIZE:"quantize",THRESHOLD:"threshold",BIN_ORDINAL:"bin-ordinal",ORDINAL:"ordinal",POINT:"point",BAND:"band"},Mct={linear:"numeric",log:"numeric",pow:"numeric",sqrt:"numeric",symlog:"numeric",identity:"numeric",sequential:"numeric",time:"time",utc:"time",ordinal:"ordinal","bin-ordinal":"bin-ordinal",point:"ordinal-position",band:"ordinal-position",quantile:"discretizing",quantize:"discretizing",threshold:"discretizing"};function Oct(t,e){const n=Mct[t],r=Mct[e];return n===r||"ordinal-position"===n&&"time"===r||"ordinal-position"===r&&"time"===n}Xot(Mct);const Tct={linear:0,log:1,pow:1,sqrt:1,symlog:1,identity:1,sequential:1,time:0,utc:0,point:10,band:11,ordinal:0,"bin-ordinal":0,quantile:0,quantize:0,threshold:0};function Ict(t){return Tct[t]}const Nct=new Set(["linear","log","pow","sqrt","symlog"]),$ct=new Set([...Nct,"time","utc"]);function Fct(t){return Nct.has(t)}const Lct=new Set(["quantile","quantize","threshold"]),Bct=new Set([...$ct,...Lct,"sequential","identity"]),Rct=new Set(["ordinal","bin-ordinal","point","band"]);function Pct(t){return Rct.has(t)}function zct(t){return Bct.has(t)}function jct(t){return $ct.has(t)}function Uct(t){return Lct.has(t)}function Vct(t){return t?.param}new Set(["time","utc"]);const qct={type:1,domain:1,domainMax:1,domainMin:1,domainMid:1,domainRaw:1,align:1,range:1,rangeMax:1,rangeMin:1,scheme:1,bins:1,reverse:1,round:1,clamp:1,nice:1,base:1,exponent:1,constant:1,interpolate:1,zero:1,padding:1,paddingInner:1,paddingOuter:1},{type:Wct,domain:Hct,range:Gct,rangeMax:Yct,rangeMin:Xct,scheme:Jct,...Kct}=(Xot(qct),qct),Qct=Xot(Kct);function Zct(t,e){switch(e){case"type":case"domain":case"reverse":case"range":return!0;case"scheme":case"interpolate":return!["point","band","identity"].includes(t);case"bins":return!["point","band","identity","ordinal"].includes(t);case"round":return jct(t)||"band"===t||"point"===t;case"padding":case"rangeMin":case"rangeMax":return jct(t)||["point","band"].includes(t);case"paddingOuter":case"align":return["point","band"].includes(t);case"paddingInner":return"band"===t;case"domainMax":case"domainMid":case"domainMin":case"domainRaw":case"clamp":return jct(t);case"nice":return jct(t)||"quantize"===t||"threshold"===t;case"exponent":return"pow"===t;case"base":return"log"===t;case"constant":return"symlog"===t;case"zero":return zct(t)&&!Bot(["log","time","utc","threshold","quantile"],t)}}function tht(t,e){switch(e){case"interpolate":case"scheme":case"domainMid":return cat(t)?void 0:`Cannot use the scale property "${e}" with non-color channel.`;case"align":case"type":case"bins":case"domain":case"domainMax":case"domainMin":case"domainRaw":case"range":case"base":case"exponent":case"constant":case"nice":case"padding":case"paddingInner":case"paddingOuter":case"rangeMax":case"rangeMin":case"reverse":case"round":case"clamp":case"zero":return}}function eht(t){const{channel:e,channelDef:n,markDef:r,scale:i,config:o}=t,s=sht(t);return lft(n)&&!Clt(n.aggregate)&&i&&jct(i.get("type"))?function({fieldDef:t,channel:e,markDef:n,ref:r,config:i}){return null===eut("invalid",n,i)?[nht(t,e),r]:r}({fieldDef:n,channel:e,markDef:r,ref:s,config:o}):s}function nht(t,e){return{test:rht(t,!0),..."y"===Aat(e)?{field:{group:"height"}}:{value:0}}}function rht(t,e=!0){return bct(XF(t)?t:_ft(t,{expr:"datum"}),!e)}function iht(t,e,n,r){const i={};if(e&&(i.scale=e),cft(t)){const{datum:e}=t;jut(e)?i.signal=Gut(e):zlt(e)?i.signal=e.signal:Llt(e)?i.signal=e.expr:i.value=e}else i.field=_ft(t,n);if(r){const{offset:t,band:e}=r;t&&(i.offset=t),e&&(i.band=e)}return i}function oht({scaleName:t,fieldOrDatumDef:e,fieldOrDatumDef2:n,offset:r,startSuffix:i,endSuffix:o="end",bandPosition:s=.5}){const a=!zlt(s)&&0<s&&s<1?"datum":void 0,l=_ft(e,{expr:a,suffix:i}),u=void 0!==n?_ft(n,{expr:a}):_ft(e,{suffix:o,expr:a}),c={};if(0===s||1===s){c.scale=t;const e=0===s?l:u;c.field=e}else{const e=zlt(s)?`(1-${s.signal}) * ${l} + ${s.signal} * ${u}`:`${1-s} * ${l} + ${s} * ${u}`;c.signal=`scale("${t}", ${e})`}return r&&(c.offset=r),c}function sht({channel:t,channelDef:e,channel2Def:n,markDef:r,config:i,scaleName:o,scale:s,stack:a,offset:l,defaultRef:u,bandPosition:c}){if(e){if(pft(e)){const u=s?.get("type");if(mft(e)){c??(c=eft({fieldDef:e,fieldDef2:n,markDef:r,config:i}));const{bin:s,timeUnit:h,type:f}=e;if(Tlt(s)||c&&h&&f===Ect)return a?.impute?iht(e,o,{binSuffix:"mid"},{offset:l}):c&&!Pct(u)?oht({scaleName:o,fieldOrDatumDef:e,bandPosition:c,offset:l}):iht(e,o,jft(e,t)?{binSuffix:"range"}:{},{offset:l});if(Ilt(s)){if(lft(n))return oht({scaleName:o,fieldOrDatumDef:e,fieldOrDatumDef2:n,bandPosition:c,offset:l});zut(But(t===Sst?Ast:Cst))}}return iht(e,o,Pct(u)?{binSuffix:"range"}:{},{offset:l,band:"band"===u?c??e.bandPosition??.5:void 0})}if(gft(e)){const n=l?{offset:l}:{};return{...aht(t,e.value),...n}}}return EF(u)&&(u=u()),u?{...u,...l?{offset:l}:{}}:u}function aht(t,e){return Bot(["x","x2"],t)&&"width"===e?{field:{group:"width"}}:Bot(["y","y2"],t)&&"height"===e?{field:{group:"height"}}:Xlt(e)}function lht(t){return t&&"number"!==t&&"time"!==t}function uht(t,e,n){return`${t}(${e}${n?`, ${wst(n)}`:""})`}const cht=" â€“ ";function hht({fieldOrDatumDef:t,format:e,formatType:n,expr:r,normalizeStack:i,config:o}){if(lht(n))return dht({fieldOrDatumDef:t,format:e,formatType:n,expr:r,config:o});const s=fht(t,r,i),a=uft(t);if(void 0===e&&void 0===n&&o.customFormatTypes){if("quantitative"===a){if(i&&o.normalizedNumberFormatType)return dht({fieldOrDatumDef:t,format:o.normalizedNumberFormat,formatType:o.normalizedNumberFormatType,expr:r,config:o});if(o.numberFormatType)return dht({fieldOrDatumDef:t,format:o.numberFormat,formatType:o.numberFormatType,expr:r,config:o})}if("temporal"===a&&o.timeFormatType&&lft(t)&&void 0===t.timeUnit)return dht({fieldOrDatumDef:t,format:o.timeFormat,formatType:o.timeFormatType,expr:r,config:o})}if(Rft(t)){const n=function({field:t,timeUnit:e,format:n,formatType:r,rawTimeFormat:i,isUTCScale:o}){return!e||n?!e&&r?`${r}(${t}, '${n}')`:`${o?"utc":"time"}Format(${t}, '${n=XF(n)?n:i}')`:function(t,e,n){if(!t)return;const r=rct(t);return`${n||Qut(t)?"utc":"time"}Format(${e}, ${r})`}(e,t,o)}({field:s,timeUnit:lft(t)?ict(t.timeUnit)?.unit:void 0,format:e,formatType:o.timeFormatType,rawTimeFormat:o.timeFormat,isUTCScale:yft(t)&&t.scale?.type===Dct.UTC});return n?{signal:n}:void 0}return e=ght({type:a,specifiedFormat:e,config:o,normalizeStack:i}),lft(t)&&Tlt(t.bin)?{signal:vht(s,_ft(t,{expr:r,binSuffix:"end"}),e,n,o)}:e||"quantitative"===uft(t)?{signal:`${yht(s,e)}`}:{signal:`isValid(${s}) ? ${s} : ""+${s}`}}function fht(t,e,n){return lft(t)?n?`${_ft(t,{expr:e,suffix:"end"})}-${_ft(t,{expr:e,suffix:"start"})}`:_ft(t,{expr:e}):function(t){const{datum:e}=t;return jut(e)?Gut(e):`${wst(e)}`}(t)}function dht({fieldOrDatumDef:t,format:e,formatType:n,expr:r,normalizeStack:i,config:o,field:s}){return s??(s=fht(t,r,i)),"datum.value"!==s&&lft(t)&&Tlt(t.bin)?{signal:vht(s,_ft(t,{expr:r,binSuffix:"end"}),e,n,o)}:{signal:uht(n,s,e)}}function pht(t,e,n,r,i,o){if(!XF(r)||!lht(r)){if(void 0===n&&void 0===r&&i.customFormatTypes&&"quantitative"===uft(t)){if(i.normalizedNumberFormatType&&bft(t)&&"normalize"===t.stack)return;if(i.numberFormatType)return}if(bft(t)&&"normalize"===t.stack&&i.normalizedNumberFormat)return ght({type:"quantitative",config:i,normalizeStack:!0});if(Rft(t)){const e=lft(t)?ict(t.timeUnit)?.unit:void 0;if(void 0===e&&i.customFormatTypes&&i.timeFormatType)return;return function({specifiedFormat:t,timeUnit:e,config:n,omitTimeFormatConfig:r}){return t||(e?{signal:rct(e)}:r?void 0:n.timeFormat)}({specifiedFormat:n,timeUnit:e,config:i,omitTimeFormatConfig:o})}return ght({type:e,specifiedFormat:n,config:i})}}function mht(t,e,n){return t&&(zlt(t)||"number"===t||"time"===t)?t:Rft(e)&&"time"!==n&&"utc"!==n?lft(e)&&ict(e?.timeUnit)?.utc?"utc":"time":void 0}function ght({type:t,specifiedFormat:e,config:n,normalizeStack:r}){return XF(e)?e:t===kct?r?n.normalizedNumberFormat:n.numberFormat:void 0}function yht(t,e){return`format(${t}, "${e||""}")`}function bht(t,e,n,r){return lht(n)?uht(n,t,e):yht(t,(XF(e)?e:void 0)??r.numberFormat)}function vht(t,e,n,r,i){if(void 0===n&&void 0===r&&i.customFormatTypes&&i.numberFormatType)return vht(t,e,i.numberFormat,i.numberFormatType,i);const o=bht(t,n,r,i),s=bht(e,n,r,i);return`${bct(t,!1)} ? "null" : ${o} + "${cht}" + ${s}`}const wht={arc:"arc",area:"area",bar:"bar",image:"image",line:"line",point:"point",rect:"rect",rule:"rule",text:"text",tick:"tick",trail:"trail",circle:"circle",square:"square",geoshape:"geoshape"},xht=wht.arc,_ht=wht.area,kht=wht.bar,Sht=wht.image,Eht=wht.line,Aht=wht.point,Cht=wht.rect,Dht=wht.rule,Mht=wht.text,Oht=wht.tick,Tht=wht.trail,Iht=wht.circle,Nht=wht.square,$ht=wht.geoshape;function Fht(t){return["line","area","trail"].includes(t)}function Lht(t){return["rect","bar","image","arc"].includes(t)}const Bht=new Set(Xot(wht));function Rht(t){return t.type}const Pht=["stroke","strokeWidth","strokeDash","strokeDashOffset","strokeOpacity","strokeJoin","strokeMiterLimit","fill","fillOpacity"],zht=Xot({color:1,filled:1,invalid:1,order:1,radius2:1,theta2:1,timeUnitBandSize:1,timeUnitBandPosition:1}),jht=Xot({mark:1,arc:1,area:1,bar:1,circle:1,image:1,line:1,point:1,rect:1,rule:1,square:1,text:1,tick:1,trail:1,geoshape:1});function Uht(t){return t&&null!=t.band}const Vht={horizontal:["cornerRadiusTopRight","cornerRadiusBottomRight"],vertical:["cornerRadiusTopLeft","cornerRadiusTopRight"]},qht="min",Wht={x:1,y:1,color:1,fill:1,stroke:1,strokeWidth:1,size:1,shape:1,fillOpacity:1,strokeOpacity:1,opacity:1,text:1};function Hht(t){return t in Wht}function Ght(t){return!!t?.encoding}function Yht(t){return t&&("count"===t.op||!!t.field)}function Xht(t){return t&&Q$(t)}function Jht(t){return"row"in t||"column"in t}function Kht(t){return!!t&&"header"in t}function Qht(t){return"facet"in t}function Zht(t){const{field:e,timeUnit:n,bin:r,aggregate:i}=t;return{...n?{timeUnit:n}:{},...r?{bin:r}:{},...i?{aggregate:i}:{},field:e}}function tft(t){return"sort"in t}function eft({fieldDef:t,fieldDef2:e,markDef:n,config:r}){if(pft(t)&&void 0!==t.bandPosition)return t.bandPosition;if(lft(t)){const{timeUnit:i,bin:o}=t;if(i&&!e)return nut("timeUnitBandPosition",n,r);if(Tlt(o))return.5}}function nft({channel:t,fieldDef:e,fieldDef2:n,markDef:r,config:i,scaleType:o,useVlSizeChannel:s}){const a=Mat(t),l=eut(s?"size":a,r,i,{vgChannel:a});if(void 0!==l)return l;if(lft(e)){const{timeUnit:t,bin:s}=e;if(t&&!n)return{band:nut("timeUnitBandSize",r,i)};if(Tlt(s)&&!Pct(o))return{band:1}}return Lht(r.type)?o?Pct(o)?i[r.type]?.discreteBandSize||{band:1}:i[r.type]?.continuousBandSize:i[r.type]?.discreteBandSize:void 0}function rft(t,e,n,r){return!!(Tlt(t.bin)||t.timeUnit&&mft(t)&&"temporal"===t.type)&&void 0!==eft({fieldDef:t,fieldDef2:e,markDef:n,config:r})}function ift(t){return t&&!!t.sort&&!t.field}function oft(t){return t&&"condition"in t}function sft(t){const e=t?.condition;return!!e&&!Q$(e)&&lft(e)}function aft(t){const e=t?.condition;return!!e&&!Q$(e)&&pft(e)}function lft(t){return t&&(!!t.field||"count"===t.aggregate)}function uft(t){return t?.type}function cft(t){return t&&"datum"in t}function hft(t){return mft(t)&&!kft(t)||dft(t)}function fft(t){return mft(t)&&"quantitative"===t.type&&!t.bin||dft(t)}function dft(t){return cft(t)&&GF(t.datum)}function pft(t){return lft(t)||cft(t)}function mft(t){return t&&("field"in t||"count"===t.aggregate)&&"type"in t}function gft(t){return t&&"value"in t&&"value"in t}function yft(t){return t&&("scale"in t||"sort"in t)}function bft(t){return t&&("axis"in t||"stack"in t||"impute"in t)}function vft(t){return t&&"legend"in t}function wft(t){return t&&("format"in t||"formatType"in t)}function xft(t){return $ot(t,["legend","axis","header","scale"])}function _ft(t,e={}){let n=t.field;const r=e.prefix;let i=e.suffix,o="";if(function(t){return"count"===t.aggregate}(t))n=pst("count");else{let r;if(!e.nofn)if(function(t){return"op"in t}(t))r=t.op;else{const{bin:s,aggregate:a,timeUnit:l}=t;Tlt(s)?(r=Olt(s),i=(e.binSuffix??"")+(e.suffix??"")):a?Slt(a)?(o=`["${n}"]`,n=`argmax_${a.argmax}`):klt(a)?(o=`["${n}"]`,n=`argmin_${a.argmin}`):r=String(a):l&&!Jut(l)&&(r=function(t){const{utc:e,...n}=ict(t);return n.unit?(e?"utc":"")+Xot(n).map((t=>Zot(`${"unit"===t?"":`_${t}_`}${n[t]}`))).join(""):(e?"utc":"")+"timeunit"+Xot(n).map((t=>Zot(`_${t}_${n[t]}`))).join("")}(l),i=(!["range","mid"].includes(e.binSuffix)&&e.binSuffix||"")+(e.suffix??""))}r&&(n=n?`${r}_${n}`:r)}return i&&(n=`${n}_${i}`),r&&(n=`${r}_${n}`),e.forAs?lst(n):e.expr?ist(n,e.expr)+o:sst(n)+o}function kft(t){switch(t.type){case"nominal":case"ordinal":case"geojson":return!0;case"quantitative":return lft(t)&&!!t.bin;case"temporal":return!1}throw new Error(_ut(t.type))}const Sft=(t,e)=>{switch(e.fieldTitle){case"plain":return t.field;case"functional":return function(t){const{aggregate:e,bin:n,timeUnit:r,field:i}=t;if(Slt(e))return`${i} for argmax(${e.argmax})`;if(klt(e))return`${i} for argmin(${e.argmin})`;const o=r&&!Jut(r)?ict(r):void 0,s=e||o?.unit||o?.maxbins&&"timeunit"||Tlt(n)&&"bin";return s?`${s.toUpperCase()}(${i})`:i}(t);default:return function(t,e){const{field:n,bin:r,timeUnit:i,aggregate:o}=t;if("count"===o)return e.countTitle;if(Tlt(r))return`${n} (binned)`;if(i&&!Jut(i)){const t=ict(i)?.unit;if(t)return`${n} (${tct(t).join("-")})`}else if(o)return Slt(o)?`${n} for max ${o.argmax}`:klt(o)?`${n} for min ${o.argmin}`:`${nst(o)} of ${n}`;return n}(t,e)}};let Eft=Sft;function Aft(t){Eft=t}function Cft(t,e,{allowDisabling:n,includeDefault:r=!0}){const i=Dft(t)?.title;if(!lft(t))return i??t.title;const o=t,s=r?Mft(o,e):void 0;return n?cst(i,o.title,s):i??o.title??s}function Dft(t){return bft(t)&&t.axis?t.axis:vft(t)&&t.legend?t.legend:Kht(t)&&t.header?t.header:void 0}function Mft(t,e){return Eft(t,e)}function Oft(t){if(wft(t)){const{format:e,formatType:n}=t;return{format:e,formatType:n}}{const e=Dft(t)??{},{format:n,formatType:r}=e;return{format:n,formatType:r}}}function Tft(t){return lft(t)?t:sft(t)?t.condition:void 0}function Ift(t){return pft(t)?t:aft(t)?t.condition:void 0}function Nft(t,e,n,r={}){return XF(t)||GF(t)||qF(t)?(zut(function(t,e,n){return`Channel ${t} is a ${e}. Converted to {value: ${wst(n)}}.`}(e,XF(t)?"string":GF(t)?"number":"boolean",t)),{value:t}):pft(t)?$ft(t,e,n,r):aft(t)?{...t,condition:$ft(t.condition,e,n,r)}:t}function $ft(t,e,n,r){if(wft(t)){const{format:i,formatType:o,...s}=t;if(lht(o)&&!n.customFormatTypes)return zut(wut(e)),$ft(s,e,n,r)}else{const i=bft(t)?"axis":vft(t)?"legend":Kht(t)?"header":null;if(i&&t[i]){const{format:o,formatType:s,...a}=t[i];if(lht(s)&&!n.customFormatTypes)return zut(wut(e)),$ft({...t,[i]:a},e,n,r)}}return lft(t)?Fft(t,e,r):function(t){let e=t.type;if(e)return t;const{datum:n}=t;return e=GF(n)?"quantitative":XF(n)?"nominal":jut(n)?"temporal":void 0,{...t,type:e}}(t)}function Fft(t,e,{compositeMark:n=!1}={}){const{aggregate:r,timeUnit:i,bin:o,field:s}=t,a={...t};if(n||!r||Elt(r)||Slt(r)||klt(r)||(zut(function(t){return`Invalid aggregation operator "${t}".`}(r)),delete a.aggregate),i&&(a.timeUnit=ict(i)),s&&(a.field=`${s}`),Tlt(o)&&(a.bin=Lft(o,e)),Ilt(o)&&!Qat(e)&&zut(function(t){return`Channel ${t} should not be used with "binned" bin.`}(e)),mft(a)){const{type:t}=a,e=function(t){if(t)switch(t=t.toLowerCase()){case"q":case kct:return"quantitative";case"t":case Ect:return"temporal";case"o":case Sct:return"ordinal";case"n":case Act:return"nominal";case Cct:return"geojson"}}(t);t!==e&&(a.type=e),"quantitative"!==t&&Clt(r)&&(zut(function(t,e){return`Invalid field type "${t}" for aggregate: "${e}", using "quantitative" instead.`}(t,r)),a.type="quantitative")}else if(!Eat(e)){const t=function(t,e){switch(e){case"latitude":case"longitude":return"quantitative";case"row":case"column":case"facet":case"shape":case"strokeDash":return"nominal";case"order":return"ordinal"}if(tft(t)&&Q$(t.sort))return"ordinal";const{aggregate:n,bin:r,timeUnit:i}=t;if(i)return"temporal";if(r||n&&!Slt(n)&&!klt(n))return"quantitative";if(yft(t)&&t.scale?.type)switch(Mct[t.scale.type]){case"numeric":case"discretizing":return"quantitative";case"time":return"temporal"}return"nominal"}(a,e);a.type=t}if(mft(a)){const{compatible:t,warning:n}=function(t,e){const n=t.type;if("geojson"===n&&"shape"!==e)return{compatible:!1,warning:`Channel ${e} should not be used with a geojson data.`};switch(e){case xst:case _st:case kst:return kft(t)?Bft:{compatible:!1,warning:Aut(e)};case Sst:case Est:case Dst:case Mst:case Rst:case Pst:case zst:case Xst:case Kst:case Qst:case Zst:case tat:case eat:case Vst:case Ist:case Ost:case nat:return Bft;case Fst:case Bst:case $st:case Lst:return n!==kct?{compatible:!1,warning:`Channel ${e} should be used with a quantitative field only, not ${t.type} field.`}:Bft;case qst:case Wst:case Hst:case Gst:case Ust:case Nst:case Tst:case Ast:case Cst:return"nominal"!==n||t.sort?Bft:{compatible:!1,warning:`Channel ${e} should not be used with an unsorted discrete field.`};case jst:case Yst:return kft(t)||function(t){return yft(t)&&Uct(t.scale?.type)}(t)?Bft:{compatible:!1,warning:Cut(e)};case Jst:return"nominal"!==t.type||"sort"in t?Bft:{compatible:!1,warning:"Channel order is inappropriate for nominal field, which has no inherent order."}}}(a,e)||{};!1===t&&zut(n)}if(tft(a)&&XF(a.sort)){const{sort:t}=a;if(Hht(t))return{...a,sort:{encoding:t}};const e=t.substr(1);if("-"===t.charAt(0)&&Hht(e))return{...a,sort:{encoding:e,order:"descending"}}}if(Kht(a)){const{header:t}=a;if(t){const{orient:e,...n}=t;if(e)return{...a,header:{...n,labelOrient:t.labelOrient||e,titleOrient:t.titleOrient||e}}}}return a}function Lft(t,e){return qF(t)?{maxbins:Flt(e)}:"binned"===t?{binned:!0}:t.maxbins||t.step?t:{...t,maxbins:Flt(e)}}const Bft={compatible:!0};function Rft(t){const{formatType:e}=Oft(t);return"time"===e||!e&&function(t){return t&&("temporal"===t.type||lft(t)&&!!t.timeUnit)}(t)}function Pft(t,{timeUnit:e,type:n,wrapTime:r,undefinedIfExprNotRequired:i}){const o=e&&ict(e)?.unit;let s,a=o||"temporal"===n;return Llt(t)?s=t.expr:zlt(t)?s=t.signal:jut(t)?(a=!0,s=Gut(t)):(XF(t)||GF(t))&&a&&(s=`datetime(${wst(t)})`,function(t){return!!Yut[t]}(o)&&(GF(t)&&t<1e4||XF(t)&&isNaN(Date.parse(t)))&&(s=Gut({[o]:t}))),s?r&&a?`time(${s})`:s:i?void 0:wst(t)}function zft(t,e){const{type:n}=t;return e.map((e=>{const r=Pft(e,{timeUnit:lft(t)&&!Jut(t.timeUnit)?t.timeUnit:void 0,type:n,undefinedIfExprNotRequired:!0});return void 0!==r?{signal:r}:e}))}function jft(t,e){return Tlt(t.bin)?glt(e)&&["ordinal","nominal"].includes(t.type):(console.warn("Only call this method for binned field defs."),!1)}const Uft={labelAlign:{part:"labels",vgProp:"align"},labelBaseline:{part:"labels",vgProp:"baseline"},labelColor:{part:"labels",vgProp:"fill"},labelFont:{part:"labels",vgProp:"font"},labelFontSize:{part:"labels",vgProp:"fontSize"},labelFontStyle:{part:"labels",vgProp:"fontStyle"},labelFontWeight:{part:"labels",vgProp:"fontWeight"},labelOpacity:{part:"labels",vgProp:"opacity"},labelOffset:null,labelPadding:null,gridColor:{part:"grid",vgProp:"stroke"},gridDash:{part:"grid",vgProp:"strokeDash"},gridDashOffset:{part:"grid",vgProp:"strokeDashOffset"},gridOpacity:{part:"grid",vgProp:"opacity"},gridWidth:{part:"grid",vgProp:"strokeWidth"},tickColor:{part:"ticks",vgProp:"stroke"},tickDash:{part:"ticks",vgProp:"strokeDash"},tickDashOffset:{part:"ticks",vgProp:"strokeDashOffset"},tickOpacity:{part:"ticks",vgProp:"opacity"},tickSize:null,tickWidth:{part:"ticks",vgProp:"strokeWidth"}};function Vft(t){return t?.condition}const qft=["domain","grid","labels","ticks","title"],Wft={grid:"grid",gridCap:"grid",gridColor:"grid",gridDash:"grid",gridDashOffset:"grid",gridOpacity:"grid",gridScale:"grid",gridWidth:"grid",orient:"main",bandPosition:"both",aria:"main",description:"main",domain:"main",domainCap:"main",domainColor:"main",domainDash:"main",domainDashOffset:"main",domainOpacity:"main",domainWidth:"main",format:"main",formatType:"main",labelAlign:"main",labelAngle:"main",labelBaseline:"main",labelBound:"main",labelColor:"main",labelFlush:"main",labelFlushOffset:"main",labelFont:"main",labelFontSize:"main",labelFontStyle:"main",labelFontWeight:"main",labelLimit:"main",labelLineHeight:"main",labelOffset:"main",labelOpacity:"main",labelOverlap:"main",labelPadding:"main",labels:"main",labelSeparation:"main",maxExtent:"main",minExtent:"main",offset:"both",position:"main",tickCap:"main",tickColor:"main",tickDash:"main",tickDashOffset:"main",tickMinStep:"both",tickOffset:"both",tickOpacity:"main",tickRound:"both",ticks:"main",tickSize:"main",tickWidth:"both",title:"main",titleAlign:"main",titleAnchor:"main",titleAngle:"main",titleBaseline:"main",titleColor:"main",titleFont:"main",titleFontSize:"main",titleFontStyle:"main",titleFontWeight:"main",titleLimit:"main",titleLineHeight:"main",titleOpacity:"main",titlePadding:"main",titleX:"main",titleY:"main",encode:"both",scale:"both",tickBand:"both",tickCount:"both",tickExtra:"both",translate:"both",values:"both",zindex:"both"},Hft={orient:1,aria:1,bandPosition:1,description:1,domain:1,domainCap:1,domainColor:1,domainDash:1,domainDashOffset:1,domainOpacity:1,domainWidth:1,format:1,formatType:1,grid:1,gridCap:1,gridColor:1,gridDash:1,gridDashOffset:1,gridOpacity:1,gridWidth:1,labelAlign:1,labelAngle:1,labelBaseline:1,labelBound:1,labelColor:1,labelFlush:1,labelFlushOffset:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelLineHeight:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labels:1,labelSeparation:1,maxExtent:1,minExtent:1,offset:1,position:1,tickBand:1,tickCap:1,tickColor:1,tickCount:1,tickDash:1,tickDashOffset:1,tickExtra:1,tickMinStep:1,tickOffset:1,tickOpacity:1,tickRound:1,ticks:1,tickSize:1,tickWidth:1,title:1,titleAlign:1,titleAnchor:1,titleAngle:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titlePadding:1,titleX:1,titleY:1,translate:1,values:1,zindex:1},Gft={...Hft,style:1,labelExpr:1,encoding:1};function Yft(t){return!!Gft[t]}Xot(Gft);const Xft=Xot({axis:1,axisBand:1,axisBottom:1,axisDiscrete:1,axisLeft:1,axisPoint:1,axisQuantitative:1,axisRight:1,axisTemporal:1,axisTop:1,axisX:1,axisXBand:1,axisXDiscrete:1,axisXPoint:1,axisXQuantitative:1,axisXTemporal:1,axisY:1,axisYBand:1,axisYDiscrete:1,axisYPoint:1,axisYQuantitative:1,axisYTemporal:1});function Jft(t){return"mark"in t}class Kft{constructor(t,e){this.name=t,this.run=e}hasMatchingType(t){return!!Jft(t)&&function(t){return Rht(t)?t.type:t}(t.mark)===this.name}}function Qft(t,e){const n=t&&t[e];return!!n&&(Q$(n)?Rot(n,(t=>!!t.field)):lft(n)||sft(n))}function Zft(t,e){const n=t&&t[e];return!!n&&(Q$(n)?Rot(n,(t=>!!t.field)):lft(n)||cft(n)||aft(n))}function tdt(t,e){if(Qat(e)){const n=t[e];if((lft(n)||cft(n))&&(_ct(n.type)||lft(n)&&n.timeUnit))return Zft(t,Tat(e))}return!1}function edt(t){return Rot(pat,(e=>{if(Qft(t,e)){const n=t[e];if(Q$(n))return Rot(n,(t=>!!t.aggregate));{const t=Tft(n);return t&&!!t.aggregate}}return!1}))}function ndt(t,e){const n=[],r=[],i=[],o=[],s={};return odt(t,((a,l)=>{if(lft(a)){const{field:u,aggregate:c,bin:h,timeUnit:f,...d}=a;if(c||f||h){const t=Dft(a),p=t?.title;let m=_ft(a,{forAs:!0});const g={...p?[]:{title:Cft(a,e,{allowDisabling:!0})},...d,field:m};if(c){let t;if(Slt(c)?(t="argmax",m=_ft({op:"argmax",field:c.argmax},{forAs:!0}),g.field=`${m}.${u}`):klt(c)?(t="argmin",m=_ft({op:"argmin",field:c.argmin},{forAs:!0}),g.field=`${m}.${u}`):"boxplot"!==c&&"errorbar"!==c&&"errorband"!==c&&(t=c),t){const e={op:t,as:m};u&&(e.field=u),o.push(e)}}else if(n.push(m),mft(a)&&Tlt(h)){if(r.push({bin:h,field:u,as:m}),n.push(_ft(a,{binSuffix:"end"})),jft(a,l)&&n.push(_ft(a,{binSuffix:"range"})),Qat(l)){const t={field:`${m}_end`};s[`${l}2`]=t}g.bin="binned",Eat(l)||(g.type=kct)}else if(f&&!Jut(f)){i.push({timeUnit:f,field:u,as:m});const t=mft(a)&&a.type!==Ect&&"time";t&&(l===Xst||l===Zst?g.formatType=t:function(t){return!!Yat[t]}(l)?g.legend={formatType:t,...g.legend}:Qat(l)&&(g.axis={formatType:t,...g.axis}))}s[l]=g}else n.push(u),s[l]=t[l]}else s[l]=t[l]})),{bins:r,timeUnits:i,aggregate:o,groupby:n,encoding:s}}function rdt(t,e,n){const r=function(t,e){return function(t){switch(t){case Rst:case Pst:case zst:case nat:case Kst:case Qst:case Zst:case tat:case Jst:case qst:case Wst:case Hst:case Gst:case kst:case xst:case _st:return ylt;case Sst:case Est:case Dst:case Mst:case $st:case Fst:return vlt;case Ast:case Cst:case Lst:case Bst:return{area:"always",bar:"always",image:"always",rect:"always",rule:"always",circle:"binned",point:"binned",square:"binned",tick:"binned",line:"binned",trail:"binned"};case Ust:return{point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",text:"always",line:"always",trail:"always"};case Yst:return{line:"always",point:"always",tick:"always",rule:"always",circle:"always",square:"always",bar:"always",geoshape:"always"};case jst:return{point:"always",geoshape:"always"};case Xst:return{text:"always"};case Vst:return{point:"always",square:"always",text:"always"};case eat:return{image:"always"};case Ist:case Ost:return{text:"always",arc:"always"};case Nst:case Tst:return{arc:"always"}}}(t)[e]}(e,n);if(!r)return!1;if("binned"===r){const n=t[e===Ast?Sst:Est];return!!(lft(n)&&lft(t[e])&&Ilt(n.bin))}return!0}function idt(t,e){const n={};for(const r of Xot(t)){const i=Nft(t[r],r,e,{compositeMark:!0});n[r]=i}return n}function odt(t,e,n){if(t)for(const r of Xot(t)){const i=t[r];if(Q$(i))for(const t of i)e.call(n,t,r);else e.call(n,i,r)}}function sdt(t,e){return Xot(e).reduce(((n,r)=>{switch(r){case Sst:case Est:case tat:case nat:case eat:case Ast:case Cst:case Dst:case Mst:case Ist:case Nst:case Ost:case Tst:case $st:case Fst:case Lst:case Bst:case Xst:case jst:case Vst:case Zst:return n;case Jst:if("line"===t||"trail"===t)return n;case Kst:case Qst:{const t=e[r];if(Q$(t)||lft(t))for(const e of kF(t))e.aggregate||n.push(_ft(e,{}));return n}case Ust:if("trail"===t)return n;case Rst:case Pst:case zst:case qst:case Wst:case Hst:case Yst:case Gst:{const t=Tft(e[r]);return t&&!t.aggregate&&n.push(_ft(t,{})),n}}}),[])}function adt(t,e,n,r=!0){if("tooltip"in n)return{tooltip:n.tooltip};const i=t.map((({fieldPrefix:t,titlePrefix:n})=>{const i=r?` of ${ldt(e)}`:"";return{field:t+e.field,type:e.type,title:zlt(n)?{signal:`${n}"${escape(i)}"`}:n+i}})),o=function(t){const e=[];for(const n of Xot(t))if(Qft(t,n)){const r=kF(t[n]);for(const t of r)lft(t)?e.push(t):sft(t)&&e.push(t.condition)}return e}(n).map(xft);return{tooltip:[...i,...Uot(o,Fot)]}}function ldt(t){const{title:e,field:n}=t;return cst(e,n)}function udt(t,e,n,r,i){const{scale:o,axis:s}=n;return({partName:a,mark:l,positionPrefix:u,endPositionPrefix:c,extraEncoding:h={}})=>{const f=ldt(n);return cdt(t,a,i,{mark:l,encoding:{[e]:{field:`${u}_${n.field}`,type:n.type,...void 0!==f?{title:f}:{},...void 0!==o?{scale:o}:{},...void 0!==s?{axis:s}:{}},...XF(c)?{[`${e}2`]:{field:`${c}_${n.field}`}}:{},...r,...h}})}}function cdt(t,e,n,r){const{clip:i,color:o,opacity:s}=t,a=t.type;return t[e]||void 0===t[e]&&n[e]?[{...r,mark:{...n[e],...i?{clip:i}:{},...o?{color:o}:{},...s?{opacity:s}:{},...Rht(r.mark)?r.mark:{type:r.mark},style:`${a}-${String(e)}`,...qF(t[e])?{}:t[e]}}]:[]}function hdt(t,e,n){const{encoding:r}=t,i="vertical"===e?"y":"x",o=r[i],s=r[`${i}2`],a=r[`${i}Error`],l=r[`${i}Error2`];return{continuousAxisChannelDef:fdt(o,n),continuousAxisChannelDef2:fdt(s,n),continuousAxisChannelDefError:fdt(a,n),continuousAxisChannelDefError2:fdt(l,n),continuousAxis:i}}function fdt(t,e){if(t?.aggregate){const{aggregate:n,...r}=t;return n!==e&&zut(function(t,e){return`Continuous axis should not have customized aggregation function ${t}; ${e} already agregates the axis.`}(n,e)),r}return t}function ddt(t,e){const{mark:n,encoding:r}=t,{x:i,y:o}=r;if(Rht(n)&&n.orient)return n.orient;if(hft(i)){if(hft(o)){const t=lft(i)&&i.aggregate,n=lft(o)&&o.aggregate;if(t||n!==e){if(n||t!==e){if(t===e&&n===e)throw new Error("Both x and y cannot have aggregate");return Rft(o)&&!Rft(i)?"horizontal":"vertical"}return"horizontal"}return"vertical"}return"horizontal"}if(hft(o))return"vertical";throw new Error(`Need a valid continuous axis for ${e}s`)}const pdt="boxplot",mdt=new Kft(pdt,ydt);function gdt(t){return GF(t)?"tukey":t}function ydt(t,{config:e}){t={...t,encoding:idt(t.encoding,e)};const{mark:n,encoding:r,params:i,projection:o,...s}=t,a=Rht(n)?n:{type:n};i&&zut(yut("boxplot"));const l=a.extent??e.boxplot.extent,u=eut("size",a,e),c=a.invalid,h=gdt(l),{bins:f,timeUnits:d,transform:p,continuousAxisChannelDef:m,continuousAxis:g,groupby:y,aggregate:b,encodingWithoutContinuousAxis:v,ticksOrient:w,boxOrient:x,customTooltipWithoutAggregatedField:_}=function(t,e,n){const r=ddt(t,pdt),{continuousAxisChannelDef:i,continuousAxis:o}=hdt(t,r,pdt),s=i.field,a=lst(s),l=gdt(e),u=[...bdt(s),{op:"median",field:s,as:`mid_box_${a}`},{op:"min",field:s,as:("min-max"===l?"lower_whisker_":"min_")+a},{op:"max",field:s,as:("min-max"===l?"upper_whisker_":"max_")+a}],c="min-max"===l||"tukey"===l?[]:[{calculate:`datum["upper_box_${a}"] - datum["lower_box_${a}"]`,as:`iqr_${a}`},{calculate:`min(datum["upper_box_${a}"] + datum["iqr_${a}"] * ${e}, datum["max_${a}"])`,as:`upper_whisker_${a}`},{calculate:`max(datum["lower_box_${a}"] - datum["iqr_${a}"] * ${e}, datum["min_${a}"])`,as:`lower_whisker_${a}`}],{[o]:h,...f}=t.encoding,{customTooltipWithoutAggregatedField:d,filteredEncoding:p}=function(t){const{tooltip:e,...n}=t;if(!e)return{filteredEncoding:n};let r,i;if(Q$(e)){for(const t of e)t.aggregate?(r||(r=[]),r.push(t)):(i||(i=[]),i.push(t));r&&(n.tooltip=r)}else e.aggregate?n.tooltip=e:i=e;return Q$(i)&&1===i.length&&(i=i[0]),{customTooltipWithoutAggregatedField:i,filteredEncoding:n}}(f),{bins:m,timeUnits:g,aggregate:y,groupby:b,encoding:v}=ndt(p,n),w="vertical"===r?"horizontal":"vertical",x=r;return{bins:m,timeUnits:g,transform:[...m,...g,{aggregate:[...y,...u],groupby:b},...c],groupby:b,aggregate:y,continuousAxisChannelDef:i,continuousAxis:o,encodingWithoutContinuousAxis:v,ticksOrient:w,boxOrient:x,customTooltipWithoutAggregatedField:d}}(t,l,e),k=lst(m.field),{color:S,size:E,...A}=v,C=t=>udt(a,g,m,t,e.boxplot),D=C(A),M=C(v),O=(Z$(e.boxplot.box)?e.boxplot.box.color:e.mark.color)||"#4c78a8",T=C({...A,...E?{size:E}:{},color:{condition:{test:`datum['lower_box_${m.field}'] >= datum['upper_box_${m.field}']`,...S||{value:O}}}}),I=adt([{fieldPrefix:"min-max"===h?"upper_whisker_":"max_",titlePrefix:"Max"},{fieldPrefix:"upper_box_",titlePrefix:"Q3"},{fieldPrefix:"mid_box_",titlePrefix:"Median"},{fieldPrefix:"lower_box_",titlePrefix:"Q1"},{fieldPrefix:"min-max"===h?"lower_whisker_":"min_",titlePrefix:"Min"}],m,v),N={type:"tick",color:"black",opacity:1,orient:w,invalid:c,aria:!1},$="min-max"===h?I:adt([{fieldPrefix:"upper_whisker_",titlePrefix:"Upper Whisker"},{fieldPrefix:"lower_whisker_",titlePrefix:"Lower Whisker"}],m,v),F=[...D({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"lower_whisker",endPositionPrefix:"lower_box",extraEncoding:$}),...D({partName:"rule",mark:{type:"rule",invalid:c,aria:!1},positionPrefix:"upper_box",endPositionPrefix:"upper_whisker",extraEncoding:$}),...D({partName:"ticks",mark:N,positionPrefix:"lower_whisker",extraEncoding:$}),...D({partName:"ticks",mark:N,positionPrefix:"upper_whisker",extraEncoding:$})],L=[..."tukey"!==h?F:[],...M({partName:"box",mark:{type:"bar",...u?{size:u}:{},orient:x,invalid:c,ariaRoleDescription:"box"},positionPrefix:"lower_box",endPositionPrefix:"upper_box",extraEncoding:I}),...T({partName:"median",mark:{type:"tick",invalid:c,...Z$(e.boxplot.median)&&e.boxplot.median.color?{color:e.boxplot.median.color}:{},...u?{size:u}:{},orient:w,aria:!1},positionPrefix:"mid_box",extraEncoding:I})];if("min-max"===h)return{...s,transform:(s.transform??[]).concat(p),layer:L};const B=`datum["lower_box_${m.field}"]`,R=`datum["upper_box_${m.field}"]`,P=`(${R} - ${B})`,z=`${B} - ${l} * ${P}`,j=`${R} + ${l} * ${P}`,U=`datum["${m.field}"]`,V={joinaggregate:bdt(m.field),groupby:y},q={transform:[{filter:`(${z} <= ${U}) && (${U} <= ${j})`},{aggregate:[{op:"min",field:m.field,as:`lower_whisker_${k}`},{op:"max",field:m.field,as:`upper_whisker_${k}`},{op:"min",field:`lower_box_${m.field}`,as:`lower_box_${k}`},{op:"max",field:`upper_box_${m.field}`,as:`upper_box_${k}`},...b],groupby:y}],layer:F},{tooltip:W,...H}=A,{scale:G,axis:Y}=m,X=ldt(m),J=$ot(Y,["title"]),K=cdt(a,"outliers",e.boxplot,{transform:[{filter:`(${U} < ${z}) || (${U} > ${j})`}],mark:"point",encoding:{[g]:{field:m.field,type:m.type,...void 0!==X?{title:X}:{},...void 0!==G?{scale:G}:{},...Yot(J)?{}:{axis:J}},...H,...S?{color:S}:{},..._?{tooltip:_}:{}}})[0];let Q;const Z=[...f,...d,V];return K?Q={transform:Z,layer:[K,q]}:(Q=q,Q.transform.unshift(...Z)),{...s,layer:[Q,{transform:p,layer:L}]}}function bdt(t){const e=lst(t);return[{op:"q1",field:t,as:`lower_box_${e}`},{op:"q3",field:t,as:`upper_box_${e}`}]}const vdt="errorbar",wdt=new Kft(vdt,xdt);function xdt(t,{config:e}){t={...t,encoding:idt(t.encoding,e)};const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,ticksOrient:s,markDef:a,outerSpec:l,tooltipEncoding:u}=_dt(t,vdt,e);delete o.size;const c=udt(a,i,r,o,e.errorbar),h=a.thickness,f=a.size,d={type:"tick",orient:s,aria:!1,...void 0!==h?{thickness:h}:{},...void 0!==f?{size:f}:{}},p=[...c({partName:"ticks",mark:d,positionPrefix:"lower",extraEncoding:u}),...c({partName:"ticks",mark:d,positionPrefix:"upper",extraEncoding:u}),...c({partName:"rule",mark:{type:"rule",ariaRoleDescription:"errorbar",...void 0!==h?{size:h}:{}},positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:u})];return{...l,transform:n,...p.length>1?{layer:p}:{...p[0]}}}function _dt(t,e,n){const{mark:r,encoding:i,params:o,projection:s,...a}=t,l=Rht(r)?r:{type:r};o&&zut(yut(e));const{orient:u,inputType:c}=function(t,e){const{encoding:n}=t;if(function(t){return(pft(t.x)||pft(t.y))&&!pft(t.x2)&&!pft(t.y2)&&!pft(t.xError)&&!pft(t.xError2)&&!pft(t.yError)&&!pft(t.yError2)}(n))return{orient:ddt(t,e),inputType:"raw"};const r=function(t){return pft(t.x2)||pft(t.y2)}(n),i=function(t){return pft(t.xError)||pft(t.xError2)||pft(t.yError)||pft(t.yError2)}(n),o=n.x,s=n.y;if(r){if(i)throw new Error(`${e} cannot be both type aggregated-upper-lower and aggregated-error`);const t=n.x2,r=n.y2;if(pft(t)&&pft(r))throw new Error(`${e} cannot have both x2 and y2`);if(pft(t)){if(hft(o))return{orient:"horizontal",inputType:"aggregated-upper-lower"};throw new Error(`Both x and x2 have to be quantitative in ${e}`)}if(pft(r)){if(hft(s))return{orient:"vertical",inputType:"aggregated-upper-lower"};throw new Error(`Both y and y2 have to be quantitative in ${e}`)}throw new Error("No ranged axis")}{const t=n.xError,r=n.xError2,i=n.yError,a=n.yError2;if(pft(r)&&!pft(t))throw new Error(`${e} cannot have xError2 without xError`);if(pft(a)&&!pft(i))throw new Error(`${e} cannot have yError2 without yError`);if(pft(t)&&pft(i))throw new Error(`${e} cannot have both xError and yError with both are quantiative`);if(pft(t)){if(hft(o))return{orient:"horizontal",inputType:"aggregated-error"};throw new Error("All x, xError, and xError2 (if exist) have to be quantitative")}if(pft(i)){if(hft(s))return{orient:"vertical",inputType:"aggregated-error"};throw new Error("All y, yError, and yError2 (if exist) have to be quantitative")}throw new Error("No ranged axis")}}(t,e),{continuousAxisChannelDef:h,continuousAxisChannelDef2:f,continuousAxisChannelDefError:d,continuousAxisChannelDefError2:p,continuousAxis:m}=hdt(t,u,e),{errorBarSpecificAggregate:g,postAggregateCalculates:y,tooltipSummary:b,tooltipTitleWithFieldName:v}=function(t,e,n,r,i,o,s,a){let l=[],u=[];const c=e.field;let h,f=!1;if("raw"===o){const e=t.center?t.center:t.extent?"iqr"===t.extent?"median":"mean":a.errorbar.center,n=t.extent?t.extent:"mean"===e?"stderr":"iqr";if("median"===e!=("iqr"===n)&&zut(function(t,e,n){return`${t} is not usually used with ${e} for ${n}.`}(e,n,s)),"stderr"===n||"stdev"===n)l=[{op:n,field:c,as:`extent_${c}`},{op:e,field:c,as:`center_${c}`}],u=[{calculate:`datum["center_${c}"] + datum["extent_${c}"]`,as:`upper_${c}`},{calculate:`datum["center_${c}"] - datum["extent_${c}"]`,as:`lower_${c}`}],h=[{fieldPrefix:"center_",titlePrefix:nst(e)},{fieldPrefix:"upper_",titlePrefix:kdt(e,n,"+")},{fieldPrefix:"lower_",titlePrefix:kdt(e,n,"-")}],f=!0;else{let t,e,r;"ci"===n?(t="mean",e="ci0",r="ci1"):(t="median",e="q1",r="q3"),l=[{op:e,field:c,as:`lower_${c}`},{op:r,field:c,as:`upper_${c}`},{op:t,field:c,as:`center_${c}`}],h=[{fieldPrefix:"upper_",titlePrefix:Cft({field:c,aggregate:r,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"lower_",titlePrefix:Cft({field:c,aggregate:e,type:"quantitative"},a,{allowDisabling:!1})},{fieldPrefix:"center_",titlePrefix:Cft({field:c,aggregate:t,type:"quantitative"},a,{allowDisabling:!1})}]}}else{(t.center||t.extent)&&zut(function(t,e){return`${e?"extent ":""}${e&&t?"and ":""}${t?"center ":""}${e&&t?"are ":"is "}not needed when data are aggregated.`}(t.center,t.extent)),"aggregated-upper-lower"===o?(h=[],u=[{calculate:`datum["${n.field}"]`,as:`upper_${c}`},{calculate:`datum["${c}"]`,as:`lower_${c}`}]):"aggregated-error"===o&&(h=[{fieldPrefix:"",titlePrefix:c}],u=[{calculate:`datum["${c}"] + datum["${r.field}"]`,as:`upper_${c}`}],i?u.push({calculate:`datum["${c}"] + datum["${i.field}"]`,as:`lower_${c}`}):u.push({calculate:`datum["${c}"] - datum["${r.field}"]`,as:`lower_${c}`}));for(const t of u)h.push({fieldPrefix:t.as.substring(0,6),titlePrefix:ast(ast(t.calculate,'datum["',""),'"]',"")})}return{postAggregateCalculates:u,errorBarSpecificAggregate:l,tooltipSummary:h,tooltipTitleWithFieldName:f}}(l,h,f,d,p,c,e,n),{[m]:w,["x"===m?"x2":"y2"]:x,["x"===m?"xError":"yError"]:_,["x"===m?"xError2":"yError2"]:k,...S}=i,{bins:E,timeUnits:A,aggregate:C,groupby:D,encoding:M}=ndt(S,n),O=[...C,...g],T="raw"!==c?[]:D,I=adt(b,h,M,v);return{transform:[...a.transform??[],...E,...A,...0===O.length?[]:[{aggregate:O,groupby:T}],...y],groupby:T,continuousAxisChannelDef:h,continuousAxis:m,encodingWithoutContinuousAxis:M,ticksOrient:"vertical"===u?"horizontal":"vertical",markDef:l,outerSpec:a,tooltipEncoding:I}}function kdt(t,e,n){return`${nst(t)} ${n} ${e}`}const Sdt="errorband",Edt=new Kft(Sdt,Adt);function Adt(t,{config:e}){t={...t,encoding:idt(t.encoding,e)};const{transform:n,continuousAxisChannelDef:r,continuousAxis:i,encodingWithoutContinuousAxis:o,markDef:s,outerSpec:a,tooltipEncoding:l}=_dt(t,Sdt,e),u=s,c=udt(u,i,r,o,e.errorband),h=void 0!==t.encoding.x&&void 0!==t.encoding.y;let f={type:h?"area":"rect"},d={type:h?"line":"rule"};const p={...u.interpolate?{interpolate:u.interpolate}:{},...u.tension&&u.interpolate?{tension:u.tension}:{}};return h?(f={...f,...p,ariaRoleDescription:"errorband"},d={...d,...p,aria:!1}):u.interpolate?zut(Lut("interpolate")):u.tension&&zut(Lut("tension")),{...a,transform:n,layer:[...c({partName:"band",mark:f,positionPrefix:"lower",endPositionPrefix:"upper",extraEncoding:l}),...c({partName:"borders",mark:d,positionPrefix:"lower",extraEncoding:l}),...c({partName:"borders",mark:d,positionPrefix:"upper",extraEncoding:l})]}}const Cdt={};function Ddt(t,e,n){const r=new Kft(t,e);Cdt[t]={normalizer:r,parts:n}}Ddt(pdt,ydt,["box","median","outliers","rule","ticks"]),Ddt(vdt,xdt,["ticks","rule"]),Ddt(Sdt,Adt,["band","borders"]);const Mdt=["gradientHorizontalMaxLength","gradientHorizontalMinLength","gradientVerticalMaxLength","gradientVerticalMinLength","unselectedOpacity"],Odt={titleAlign:"align",titleAnchor:"anchor",titleAngle:"angle",titleBaseline:"baseline",titleColor:"color",titleFont:"font",titleFontSize:"fontSize",titleFontStyle:"fontStyle",titleFontWeight:"fontWeight",titleLimit:"limit",titleLineHeight:"lineHeight",titleOrient:"orient",titlePadding:"offset"},Tdt={labelAlign:"align",labelAnchor:"anchor",labelAngle:"angle",labelBaseline:"baseline",labelColor:"color",labelFont:"font",labelFontSize:"fontSize",labelFontStyle:"fontStyle",labelFontWeight:"fontWeight",labelLimit:"limit",labelLineHeight:"lineHeight",labelOrient:"orient",labelPadding:"offset"},Idt=Xot(Odt),Ndt=Xot(Tdt),$dt=Xot({header:1,headerRow:1,headerColumn:1,headerFacet:1}),Fdt=["size","shape","fill","stroke","strokeDash","strokeWidth","opacity"],Ldt={aria:1,clipHeight:1,columnPadding:1,columns:1,cornerRadius:1,description:1,direction:1,fillColor:1,format:1,formatType:1,gradientLength:1,gradientOpacity:1,gradientStrokeColor:1,gradientStrokeWidth:1,gradientThickness:1,gridAlign:1,labelAlign:1,labelBaseline:1,labelColor:1,labelFont:1,labelFontSize:1,labelFontStyle:1,labelFontWeight:1,labelLimit:1,labelOffset:1,labelOpacity:1,labelOverlap:1,labelPadding:1,labelSeparation:1,legendX:1,legendY:1,offset:1,orient:1,padding:1,rowPadding:1,strokeColor:1,symbolDash:1,symbolDashOffset:1,symbolFillColor:1,symbolLimit:1,symbolOffset:1,symbolOpacity:1,symbolSize:1,symbolStrokeColor:1,symbolStrokeWidth:1,symbolType:1,tickCount:1,tickMinStep:1,title:1,titleAlign:1,titleAnchor:1,titleBaseline:1,titleColor:1,titleFont:1,titleFontSize:1,titleFontStyle:1,titleFontWeight:1,titleLimit:1,titleLineHeight:1,titleOpacity:1,titleOrient:1,titlePadding:1,type:1,values:1,zindex:1},Bdt=(Xot(Ldt),"_vgsid_"),Rdt={point:{on:"click",fields:[Bdt],toggle:"event.shiftKey",resolve:"global",clear:"dblclick"},interval:{on:"[pointerdown, window:pointerup] > window:pointermove!",encodings:["x","y"],translate:"[pointerdown, window:pointerup] > window:pointermove!",zoom:"wheel!",mark:{fill:"#333",fillOpacity:.125,stroke:"white"},resolve:"global",clear:"dblclick"}};function Pdt(t){return"legend"===t||!!t?.legend}function zdt(t){return Pdt(t)&&Z$(t)}function jdt(t){return!!t?.select}function Udt(t){const e=[];for(const n of t||[]){if(jdt(n))continue;const{expr:t,bind:r,...i}=n;if(r&&t){const n={...i,bind:r,init:t};e.push(n)}else{const n={...i,...t?{update:t}:{},...r?{bind:r}:{}};e.push(n)}}return e}function Vdt(t){return"concat"in t}function qdt(t){return"vconcat"in t}function Wdt(t){return"hconcat"in t}function Hdt({step:t,offsetIsDiscrete:e}){return e?t.for??"offset":"position"}function Gdt(t){return Z$(t)&&void 0!==t.step}function Ydt(t){return t.view||t.width||t.height}const Xdt=Xot({align:1,bounds:1,center:1,columns:1,spacing:1});function Jdt(t,e){return t[e]??t["width"===e?"continuousWidth":"continuousHeight"]}function Kdt(t,e){const n=Qdt(t,e);return Gdt(n)?n.step:Zdt}function Qdt(t,e){return cst(t[e]??t["width"===e?"discreteWidth":"discreteHeight"],{step:t.step})}const Zdt=20,tpt={background:"white",padding:5,timeFormat:"%b %d, %Y",countTitle:"Count of Records",view:{continuousWidth:200,continuousHeight:200,step:Zdt},mark:{color:"#4c78a8",invalid:"filter",timeUnitBandSize:1},arc:{},area:{},bar:{binSpacing:1,continuousBandSize:5,minBandSize:.25,timeUnitBandPosition:.5},circle:{},geoshape:{},image:{},line:{},point:{},rect:{binSpacing:0,continuousBandSize:5,minBandSize:.25,timeUnitBandPosition:.5},rule:{color:"black"},square:{},text:{color:"black"},tick:{thickness:1},trail:{},boxplot:{size:14,extent:1.5,box:{},median:{color:"white"},outliers:{},rule:{},ticks:null},errorbar:{center:"mean",rule:!0,ticks:!1},errorband:{band:{opacity:.3},borders:!1},scale:{pointPadding:.5,barBandPaddingInner:.1,rectBandPaddingInner:0,bandWithNestedOffsetPaddingInner:.2,bandWithNestedOffsetPaddingOuter:.2,minBandSize:2,minFontSize:8,maxFontSize:40,minOpacity:.3,maxOpacity:.8,minSize:9,minStrokeWidth:1,maxStrokeWidth:4,quantileCount:4,quantizeCount:4,zero:!0},projection:{},legend:{gradientHorizontalMaxLength:200,gradientHorizontalMinLength:100,gradientVerticalMaxLength:200,gradientVerticalMinLength:64,unselectedOpacity:.35},header:{titlePadding:10,labelPadding:10},headerColumn:{},headerRow:{},headerFacet:{},selection:Rdt,style:{},title:{},facet:{spacing:20},concat:{spacing:20},normalizedNumberFormat:".0%"},ept=["#4c78a8","#f58518","#e45756","#72b7b2","#54a24b","#eeca3b","#b279a2","#ff9da6","#9d755d","#bab0ac"],npt={text:11,guideLabel:10,guideTitle:11,groupTitle:13,groupSubtitle:12},rpt={blue:ept[0],orange:ept[1],red:ept[2],teal:ept[3],green:ept[4],yellow:ept[5],purple:ept[6],pink:ept[7],brown:ept[8],gray0:"#000",gray1:"#111",gray2:"#222",gray3:"#333",gray4:"#444",gray5:"#555",gray6:"#666",gray7:"#777",gray8:"#888",gray9:"#999",gray10:"#aaa",gray11:"#bbb",gray12:"#ccc",gray13:"#ddd",gray14:"#eee",gray15:"#fff"};function ipt(t){const e=Xot(t||{}),n={};for(const r of e){const e=t[r];n[r]=Vft(e)?Hlt(e):Glt(e)}return n}const opt=[...jht,...Xft,...$dt,"background","padding","legend","lineBreak","scale","style","title","view"];function spt(t={}){const{color:e,font:n,fontSize:r,selection:i,...o}=t,s=eF({},Tot(tpt),n?function(t){return{text:{font:t},style:{"guide-label":{font:t},"guide-title":{font:t},"group-title":{font:t},"group-subtitle":{font:t}}}}(n):{},e?function(t={}){return{signals:[{name:"color",value:Z$(t)?{...rpt,...t}:rpt}],mark:{color:{signal:"color.blue"}},rule:{color:{signal:"color.gray0"}},text:{color:{signal:"color.gray0"}},style:{"guide-label":{fill:{signal:"color.gray0"}},"guide-title":{fill:{signal:"color.gray0"}},"group-title":{fill:{signal:"color.gray0"}},"group-subtitle":{fill:{signal:"color.gray0"}},cell:{stroke:{signal:"color.gray8"}}},axis:{domainColor:{signal:"color.gray13"},gridColor:{signal:"color.gray8"},tickColor:{signal:"color.gray13"}},range:{category:[{signal:"color.blue"},{signal:"color.orange"},{signal:"color.red"},{signal:"color.teal"},{signal:"color.green"},{signal:"color.yellow"},{signal:"color.purple"},{signal:"color.pink"},{signal:"color.brown"},{signal:"color.grey8"}]}}}(e):{},r?function(t){return{signals:[{name:"fontSize",value:Z$(t)?{...npt,...t}:npt}],text:{fontSize:{signal:"fontSize.text"}},style:{"guide-label":{fontSize:{signal:"fontSize.guideLabel"}},"guide-title":{fontSize:{signal:"fontSize.guideTitle"}},"group-title":{fontSize:{signal:"fontSize.groupTitle"}},"group-subtitle":{fontSize:{signal:"fontSize.groupSubtitle"}}}}}(r):{},o||{});i&&nF(s,"selection",i,!0);const a=$ot(s,opt);for(const t of["background","lineBreak","padding"])s[t]&&(a[t]=Glt(s[t]));for(const t of jht)s[t]&&(a[t]=Blt(s[t]));for(const t of Xft)s[t]&&(a[t]=ipt(s[t]));for(const t of $dt)s[t]&&(a[t]=Blt(s[t]));return s.legend&&(a.legend=Blt(s.legend)),s.scale&&(a.scale=Blt(s.scale)),s.style&&(a.style=function(t){const e=Xot(t),n={};for(const r of e)n[r]=ipt(t[r]);return n}(s.style)),s.title&&(a.title=Blt(s.title)),s.view&&(a.view=Blt(s.view)),a}const apt=new Set(["view",...Bht]),lpt=["color","fontSize","background","padding","facet","concat","numberFormat","numberFormatType","normalizedNumberFormat","normalizedNumberFormatType","timeFormat","countTitle","header","axisQuantitative","axisTemporal","axisDiscrete","axisPoint","axisXBand","axisXPoint","axisXDiscrete","axisXQuantitative","axisXTemporal","axisYBand","axisYPoint","axisYDiscrete","axisYQuantitative","axisYTemporal","scale","selection","overlay"],upt={view:["continuousWidth","continuousHeight","discreteWidth","discreteHeight","step"],area:["line","point"],bar:["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],rect:["binSpacing","continuousBandSize","discreteBandSize","minBandSize"],line:["point"],tick:["bandSize","thickness"]};function cpt(t,e,n,r){"view"===e&&(n="cell");const i={...r?t[e][r]:t[e],...t.style[n??e]};Yot(i)||(t.style[n??e]=i),r||delete t[e]}function hpt(t){return"layer"in t}class fpt{map(t,e){return Qht(t)?this.mapFacet(t,e):function(t){return"repeat"in t}(t)?this.mapRepeat(t,e):Wdt(t)?this.mapHConcat(t,e):qdt(t)?this.mapVConcat(t,e):Vdt(t)?this.mapConcat(t,e):this.mapLayerOrUnit(t,e)}mapLayerOrUnit(t,e){if(hpt(t))return this.mapLayer(t,e);if(Jft(t))return this.mapUnit(t,e);throw new Error(uut(t))}mapLayer(t,e){return{...t,layer:t.layer.map((t=>this.mapLayerOrUnit(t,e)))}}mapHConcat(t,e){return{...t,hconcat:t.hconcat.map((t=>this.map(t,e)))}}mapVConcat(t,e){return{...t,vconcat:t.vconcat.map((t=>this.map(t,e)))}}mapConcat(t,e){const{concat:n,...r}=t;return{...r,concat:n.map((t=>this.map(t,e)))}}mapFacet(t,e){return{...t,spec:this.map(t.spec,e)}}mapRepeat(t,e){return{...t,spec:this.map(t.spec,e)}}}const dpt={zero:1,center:1,normalize:1},ppt=new Set([xht,kht,_ht,Dht,Aht,Iht,Nht,Eht,Mht,Oht]),mpt=new Set([kht,_ht,xht]);function gpt(t){return lft(t)&&"quantitative"===uft(t)&&!t.bin}function ypt(t,e,{orient:n,type:r}){const i="x"===e?"y":"radius",o="x"===e&&["bar","area"].includes(r),s=t[e],a=t[i];if(lft(s)&&lft(a))if(gpt(s)&&gpt(a)){if(s.stack)return e;if(a.stack)return i;const t=lft(s)&&!!s.aggregate;if(t!==(lft(a)&&!!a.aggregate))return t?e:i;if(o){if("vertical"===n)return i;if("horizontal"===n)return e}}else{if(gpt(s))return e;if(gpt(a))return i}else{if(gpt(s)){if(o&&"vertical"===n)return;return e}if(gpt(a)){if(o&&"horizontal"===n)return;return i}}}function bpt(t,e){const n=Rht(t)?t:{type:t},r=n.type;if(!ppt.has(r))return null;const i=ypt(e,"x",n)||ypt(e,"theta",n);if(!i)return null;const o=e[i],s=lft(o)?_ft(o,{}):void 0,a=function(t){switch(t){case"x":return"y";case"y":return"x";case"theta":return"radius";case"radius":return"theta"}}(i),l=[],u=new Set;if(e[a]){const t=e[a],n=lft(t)?_ft(t,{}):void 0;n&&n!==s&&(l.push(a),u.add(n))}const c="x"===a?"xOffset":"yOffset",h=e[c],f=lft(h)?_ft(h,{}):void 0;f&&f!==s&&(l.push(c),u.add(f));const d=Xat.reduce(((t,n)=>{if("tooltip"!==n&&Qft(e,n)){const r=e[n];for(const e of kF(r)){const r=Tft(e);if(r.aggregate)continue;const i=_ft(r,{});i&&u.has(i)||t.push({channel:n,fieldDef:r})}}return t}),[]);let p;return void 0!==o.stack?p=qF(o.stack)?o.stack?"zero":null:o.stack:mpt.has(r)&&(p="zero"),p&&p in dpt?edt(e)&&0===d.length?null:(o?.scale?.type&&o?.scale?.type!==Dct.LINEAR&&o?.stack&&zut(function(t){return`Stack is applied to a non-linear scale (${t}).`}(o.scale.type)),pft(e[Dat(i)])?(void 0!==o.stack&&zut(`Cannot stack "${m=i}" if there is already "${m}2".`),null):(lft(o)&&o.aggregate&&!Dlt.has(o.aggregate)&&zut(function(t){return`Stacking is applied even though the aggregate function is non-summative ("${t}").`}(o.aggregate)),{groupbyChannels:l,groupbyFields:u,fieldChannel:i,impute:null!==o.impute&&Fht(r),stackBy:d,offset:p})):null;var m}function vpt(t,e,n){const r=Blt(t),i=eut("orient",r,n);if(r.orient=function(t,e,n){switch(t){case Aht:case Iht:case Nht:case Mht:case Cht:case Sht:return}const{x:r,y:i,x2:o,y2:s}=e;switch(t){case kht:if(lft(r)&&(Ilt(r.bin)||lft(i)&&i.aggregate&&!r.aggregate))return"vertical";if(lft(i)&&(Ilt(i.bin)||lft(r)&&r.aggregate&&!i.aggregate))return"horizontal";if(s||o){if(n)return n;if(!o)return(lft(r)&&r.type===kct&&!Tlt(r.bin)||dft(r))&&lft(i)&&Ilt(i.bin)?"horizontal":"vertical";if(!s)return(lft(i)&&i.type===kct&&!Tlt(i.bin)||dft(i))&&lft(r)&&Ilt(r.bin)?"vertical":"horizontal"}case Dht:if(o&&(!lft(r)||!Ilt(r.bin))&&s&&(!lft(i)||!Ilt(i.bin)))return;case _ht:if(s)return lft(i)&&Ilt(i.bin)?"horizontal":"vertical";if(o)return lft(r)&&Ilt(r.bin)?"vertical":"horizontal";if(t===Dht){if(r&&!i)return"vertical";if(i&&!r)return"horizontal"}case Eht:case Oht:{const e=fft(r),o=fft(i);if(n)return n;if(e&&!o)return"tick"!==t?"horizontal":"vertical";if(!e&&o)return"tick"!==t?"vertical":"horizontal";if(e&&o)return"vertical";{const t=mft(r)&&r.type===Ect,e=mft(i)&&i.type===Ect;if(t&&!e)return"vertical";if(!t&&e)return"horizontal"}return}}return"vertical"}(r.type,e,i),void 0!==i&&i!==r.orient&&zut(`Specified orient "${r.orient}" overridden with "${i}".`),"bar"===r.type&&r.orient){const t=eut("cornerRadiusEnd",r,n);if(void 0!==t){const n="horizontal"===r.orient&&e.x2||"vertical"===r.orient&&e.y2?["cornerRadius"]:Vht[r.orient];for(const e of n)r[e]=t;void 0!==r.cornerRadiusEnd&&delete r.cornerRadiusEnd}}const o=eut("opacity",r,n),s=eut("fillOpacity",r,n);return void 0===o&&void 0===s&&(r.opacity=function(t,e){if(Bot([Aht,Oht,Iht,Nht],t)&&!edt(e))return.7}(r.type,e)),void 0===eut("cursor",r,n)&&(r.cursor=function(t,e,n){return e.href||t.href||eut("href",t,n)?"pointer":t.cursor}(r,e,n)),r}function wpt(t){const{point:e,line:n,...r}=t;return Xot(r).length>1?r:r.type}function xpt(t){for(const e of["line","area","rule","trail"])t[e]&&(t={...t,[e]:$ot(t[e],["point","line"])});return t}function _pt(t,e={},n){return"transparent"===t.point?{opacity:0}:t.point?Z$(t.point)?t.point:{}:void 0!==t.point?null:e.point||n.shape?Z$(e.point)?e.point:{}:void 0}function kpt(t,e={}){return t.line?!0===t.line?{}:t.line:void 0!==t.line?null:e.line?!0===e.line?{}:e.line:void 0}class Spt{constructor(){this.name="path-overlay"}hasMatchingType(t,e){if(Jft(t)){const{mark:n,encoding:r}=t,i=Rht(n)?n:{type:n};switch(i.type){case"line":case"rule":case"trail":return!!_pt(i,e[i.type],r);case"area":return!!_pt(i,e[i.type],r)||!!kpt(i,e[i.type])}}return!1}run(t,e,n){const{config:r}=e,{params:i,projection:o,mark:s,name:a,encoding:l,...u}=t,c=idt(l,r),h=Rht(s)?s:{type:s},f=_pt(h,r[h.type],c),d="area"===h.type&&kpt(h,r[h.type]),p=[{name:a,...i?{params:i}:{},mark:wpt({..."area"===h.type&&void 0===h.opacity&&void 0===h.fillOpacity?{opacity:.7}:{},...h}),encoding:$ot(c,["shape"])}],m=bpt(vpt(h,c,r),c);let g=c;if(m){const{fieldChannel:t,offset:e}=m;g={...c,[t]:{...c[t],...e?{stack:e}:{}}}}return g=$ot(g,["y2","x2"]),d&&p.push({...o?{projection:o}:{},mark:{type:"line",...Not(h,["clip","interpolate","tension","tooltip"]),...d},encoding:g}),f&&p.push({...o?{projection:o}:{},mark:{type:"point",opacity:1,filled:!0,...Not(h,["clip","tooltip"]),...f},encoding:g}),n({...u,layer:p},{...e,config:xpt(r)})}}function Ept(t,e){return e?Jht(t)?Tpt(t,e):Dpt(t,e):t}function Apt(t,e){return e?Tpt(t,e):t}function Cpt(t,e,n){const r=e[t];return function(t){return t&&!XF(t)&&"repeat"in t}(r)?r.repeat in n?{...e,[t]:n[r.repeat]}:void zut(function(t){return`Unknown repeated value "${t}".`}(r.repeat)):e}function Dpt(t,e){if(void 0!==(t=Cpt("field",t,e))){if(null===t)return null;if(tft(t)&&Yht(t.sort)){const n=Cpt("field",t.sort,e);t={...t,...n?{sort:n}:{}}}return t}}function Mpt(t,e){if(lft(t))return Dpt(t,e);{const n=Cpt("datum",t,e);return n===t||n.type||(n.type="nominal"),n}}function Opt(t,e){if(!pft(t)){if(aft(t)){const n=Mpt(t.condition,e);if(n)return{...t,condition:n};{const{condition:e,...n}=t;return n}}return t}{const n=Mpt(t,e);if(n)return n;if(oft(t))return{condition:t.condition}}}function Tpt(t,e){const n={};for(const r in t)if(RF(t,r)){const i=t[r];if(Q$(i))n[r]=i.map((t=>Opt(t,e))).filter((t=>t));else{const t=Opt(i,e);void 0!==t&&(n[r]=t)}}return n}class Ipt{constructor(){this.name="RuleForRangedLine"}hasMatchingType(t){if(Jft(t)){const{encoding:e,mark:n}=t;if("line"===n||Rht(n)&&"line"===n.type)for(const t of Sat){const n=e[Aat(t)];if(e[t]&&(lft(n)&&!Ilt(n.bin)||cft(n)))return!0}}return!1}run(t,e,n){const{encoding:r,mark:i}=t;var o,s;return zut((o=!!r.x2,s=!!r.y2,`Line mark is for continuous lines and thus cannot be used with ${o&&s?"x2 and y2":o?"x2":"y2"}. We will use the rule mark (line segments) instead.`)),n({...t,mark:Z$(i)?{...i,type:"rule"}:"rule"},e)}}function Npt({parentEncoding:t,encoding:e={},layer:n}){let r={};if(t){const i=new Set([...Xot(t),...Xot(e)]);for(const o of i){const i=e[o],s=t[o];if(pft(i)){const t={...s,...i};r[o]=t}else aft(i)?r[o]={...i,condition:{...s,...i.condition}}:i||null===i?r[o]=i:(n||gft(s)||zlt(s)||pft(s)||Q$(s))&&(r[o]=s)}}else r=e;return!r||Yot(r)?void 0:r}function $pt(t){const{parentProjection:e,projection:n}=t;return e&&n&&zut(function(t){const{parentProjection:e,projection:n}=t;return`Layer's shared projection ${wst(e)} is overridden by a child projection ${wst(n)}.`}({parentProjection:e,projection:n})),n??e}function Fpt(t){return"filter"in t}function Lpt(t){return void 0!==t?.stop}function Bpt(t){return"lookup"in t}function Rpt(t){return"pivot"in t}function Ppt(t){return"density"in t}function zpt(t){return"quantile"in t}function jpt(t){return"regression"in t}function Upt(t){return"loess"in t}function Vpt(t){return"sample"in t}function qpt(t){return"window"in t}function Wpt(t){return"joinaggregate"in t}function Hpt(t){return"flatten"in t}function Gpt(t){return"calculate"in t}function Ypt(t){return"bin"in t}function Xpt(t){return"impute"in t}function Jpt(t){return"timeUnit"in t}function Kpt(t){return"aggregate"in t}function Qpt(t){return"stack"in t}function Zpt(t){return"fold"in t}function tmt(t){return"extent"in t&&!("density"in t)&&!("regression"in t)}function emt(t,e){const{transform:n,...r}=t;if(n){const t=n.map((t=>{if(Fpt(t))return{filter:imt(t,e)};if(Ypt(t)&&Nlt(t.bin))return{...t,bin:rmt(t.bin)};if(Bpt(t)){const{selection:e,...n}=t.from;return e?{...t,from:{param:e,...n}}:t}return t}));return{...r,transform:t}}return t}function nmt(t,e){const n=Tot(t);if(lft(n)&&Nlt(n.bin)&&(n.bin=rmt(n.bin)),yft(n)&&n.scale?.domain?.selection){const{selection:t,...e}=n.scale.domain;n.scale.domain={...e,...t?{param:t}:{}}}if(oft(n))if(Q$(n.condition))n.condition=n.condition.map((t=>{const{selection:n,param:r,test:i,...o}=t;return r?t:{...o,test:imt(t,e)}}));else{const{selection:t,param:r,test:i,...o}=nmt(n.condition,e);n.condition=r?n.condition:{...o,test:imt(n.condition,e)}}return n}function rmt(t){const e=t.extent;if(e?.selection){const{selection:n,...r}=e;return{...t,extent:{...r,param:n}}}return t}function imt(t,e){const n=t=>Oot(t,(t=>{var n;const r={param:t,empty:e.emptySelections[t]??!0};return(n=e.selectionPredicates)[t]??(n[t]=[]),e.selectionPredicates[t].push(r),r}));return t.selection?n(t.selection):Oot(t.test||t.filter,(t=>t.selection?n(t.selection):t))}class omt extends fpt{map(t,e){const n=e.selections??[];if(t.params&&!Jft(t)){const e=[];for(const r of t.params)jdt(r)?n.push(r):e.push(r);t.params=e}return e.selections=n,super.map(t,e)}mapUnit(t,e){const n=e.selections;if(!n||!n.length)return t;const r=(e.path??[]).concat(t.name),i=[];for(const e of n)if(e.views&&e.views.length)for(const n of e.views)(XF(n)&&(n===t.name||r.includes(n))||Q$(n)&&n.map((t=>r.indexOf(t))).every(((t,e,n)=>-1!==t&&(0===e||t>n[e-1]))))&&i.push(e);else i.push(e);return i.length&&(t.params=i),t}}for(const t of["mapFacet","mapRepeat","mapHConcat","mapVConcat","mapLayer"]){const e=omt.prototype[t];omt.prototype[t]=function(t,n){return e.call(this,t,smt(t,n))}}function smt(t,e){return t.name?{...e,path:(e.path??[]).concat(t.name)}:e}function amt(t,e){void 0===e&&(e=spt(t.config));const n=function(t,e={}){const n={config:e};return cmt.map(lmt.map(umt.map(t,n),n),n)}(t,e),{width:r,height:i}=t,o=function(t,e,n){let{width:r,height:i}=e;const o=Jft(t)||hpt(t),s={};o?"container"==r&&"container"==i?(s.type="fit",s.contains="padding"):"container"==r?(s.type="fit-x",s.contains="padding"):"container"==i&&(s.type="fit-y",s.contains="padding"):("container"==r&&(zut(hut("width")),r=void 0),"container"==i&&(zut(hut("height")),i=void 0));const a={type:"pad",...s,...n?hmt(n.autosize):{},...hmt(t.autosize)};if("fit"!==a.type||o||(zut(cut),a.type="pad"),"container"==r&&"fit"!=a.type&&"fit-x"!=a.type&&zut(fut("width")),"container"==i&&"fit"!=a.type&&"fit-y"!=a.type&&zut(fut("height")),!vst(a,{type:"pad"}))return a}(n,{width:r,height:i,autosize:t.autosize},e);return{...n,...o?{autosize:o}:{}}}const lmt=new class extends fpt{constructor(){super(...arguments),this.nonFacetUnitNormalizers=[mdt,wdt,Edt,new Spt,new Ipt]}map(t,e){if(Jft(t)){const n=Qft(t.encoding,xst),r=Qft(t.encoding,_st),i=Qft(t.encoding,kst);if(n||r||i)return this.mapFacetedUnit(t,e)}return super.map(t,e)}mapUnit(t,e){const{parentEncoding:n,parentProjection:r}=e,i=Apt(t.encoding,e.repeater),o={...t,...t.name?{name:[e.repeaterPrefix,t.name].filter((t=>t)).join("_")}:{},...i?{encoding:i}:{}};if(n||r)return this.mapUnitWithParentEncodingOrProjection(o,e);const s=this.mapLayerOrUnit.bind(this);for(const t of this.nonFacetUnitNormalizers)if(t.hasMatchingType(o,e.config))return t.run(o,e,s);return o}mapRepeat(t,e){return function(t){return!Q$(t.repeat)&&t.repeat.layer}(t)?this.mapLayerRepeat(t,e):this.mapNonLayerRepeat(t,e)}mapLayerRepeat(t,e){const{repeat:n,spec:r,...i}=t,{row:o,column:s,layer:a}=n,{repeater:l={},repeaterPrefix:u=""}=e;return o||s?this.mapRepeat({...t,repeat:{...o?{row:o}:{},...s?{column:s}:{}},spec:{repeat:{layer:a},spec:r}},e):{...i,layer:a.map((t=>{const n={...l,layer:t},i=`${(r.name?`${r.name}_`:"")+u}child__layer_${Zot(t)}`,o=this.mapLayerOrUnit(r,{...e,repeater:n,repeaterPrefix:i});return o.name=i,o}))}}mapNonLayerRepeat(t,e){const{repeat:n,spec:r,data:i,...o}=t;!Q$(n)&&t.columns&&(t=$ot(t,["columns"]),zut(but("repeat")));const s=[],{repeater:a={},repeaterPrefix:l=""}=e,u=!Q$(n)&&n.row||[a?a.row:null],c=!Q$(n)&&n.column||[a?a.column:null],h=Q$(n)&&n||[a?a.repeat:null];for(const t of h)for(const i of u)for(const o of c){const u={repeat:t,row:i,column:o,layer:a.layer},c=(r.name?`${r.name}_`:"")+l+"child__"+(Q$(n)?`${Zot(t)}`:(n.row?`row_${Zot(i)}`:"")+(n.column?`column_${Zot(o)}`:"")),h=this.map(r,{...e,repeater:u,repeaterPrefix:c});h.name=c,s.push($ot(h,["data"]))}const f=Q$(n)?t.columns:n.column?n.column.length:1;return{data:r.data??i,align:"all",...o,columns:f,concat:s}}mapFacet(t,e){const{facet:n}=t;return Jht(n)&&t.columns&&(t=$ot(t,["columns"]),zut(but("facet"))),super.mapFacet(t,e)}mapUnitWithParentEncodingOrProjection(t,e){const{encoding:n,projection:r}=t,{parentEncoding:i,parentProjection:o,config:s}=e,a=$pt({parentProjection:o,projection:r}),l=Npt({parentEncoding:i,encoding:Apt(n,e.repeater)});return this.mapUnit({...t,...a?{projection:a}:{},...l?{encoding:l}:{}},{config:s})}mapFacetedUnit(t,e){const{row:n,column:r,facet:i,...o}=t.encoding,{mark:s,width:a,projection:l,height:u,view:c,params:h,encoding:f,...d}=t,{facetMapping:p,layout:m}=this.getFacetMappingAndLayout({row:n,column:r,facet:i},e),g=Apt(o,e.repeater);return this.mapFacet({...d,...m,facet:p,spec:{...a?{width:a}:{},...u?{height:u}:{},...c?{view:c}:{},...l?{projection:l}:{},mark:s,encoding:g,...h?{params:h}:{}}},e)}getFacetMappingAndLayout(t,e){const{row:n,column:r,facet:i}=t;if(n||r){i&&zut(`Facet encoding dropped as ${(o=[...n?[xst]:[],...r?[_st]:[]]).join(" and ")} ${o.length>1?"are":"is"} also specified.`);const e={},s={};for(const n of[xst,_st]){const r=t[n];if(r){const{align:t,center:i,spacing:o,columns:a,...l}=r;e[n]=l;for(const t of["align","center","spacing"])void 0!==r[t]&&(s[t]??(s[t]={}),s[t][n]=r[t])}}return{facetMapping:e,layout:s}}{const{align:t,center:n,spacing:r,columns:o,...s}=i;return{facetMapping:Ept(s,e.repeater),layout:{...t?{align:t}:{},...n?{center:n}:{},...r?{spacing:r}:{},...o?{columns:o}:{}}}}var o}mapLayer(t,{parentEncoding:e,parentProjection:n,...r}){const{encoding:i,projection:o,...s}=t,a={...r,parentEncoding:Npt({parentEncoding:e,encoding:i,layer:!0}),parentProjection:$pt({parentProjection:n,projection:o})};return super.mapLayer({...s,...t.name?{name:[a.repeaterPrefix,t.name].filter((t=>t)).join("_")}:{}},a)}},umt=new class extends fpt{map(t,e){return e.emptySelections??(e.emptySelections={}),e.selectionPredicates??(e.selectionPredicates={}),t=emt(t,e),super.map(t,e)}mapLayerOrUnit(t,e){if((t=emt(t,e)).encoding){const n={};for(const[r,i]of Kot(t.encoding))n[r]=nmt(i,e);t={...t,encoding:n}}return super.mapLayerOrUnit(t,e)}mapUnit(t,e){const{selection:n,...r}=t;return n?{...r,params:Kot(n).map((([t,n])=>{const{init:r,bind:i,empty:o,...s}=n;"single"===s.type?(s.type="point",s.toggle=!1):"multi"===s.type&&(s.type="point"),e.emptySelections[t]="none"!==o;for(const n of Jot(e.selectionPredicates[t]??{}))n.empty="none"!==o;return{name:t,value:r,select:s,bind:i}}))}:t}},cmt=new omt;function hmt(t){return XF(t)?{type:t}:t??{}}const fmt=["background","padding"];function dmt(t,e){const n={};for(const e of fmt)t&&void 0!==t[e]&&(n[e]=Glt(t[e]));return e&&(n.params=t.params),n}class pmt{constructor(t={},e={}){this.explicit=t,this.implicit=e}clone(){return new pmt(Tot(this.explicit),Tot(this.implicit))}combine(){return{...this.explicit,...this.implicit}}get(t){return cst(this.explicit[t],this.implicit[t])}getWithExplicit(t){return void 0!==this.explicit[t]?{explicit:!0,value:this.explicit[t]}:void 0!==this.implicit[t]?{explicit:!1,value:this.implicit[t]}:{explicit:!1,value:void 0}}setWithExplicit(t,{value:e,explicit:n}){void 0!==e&&this.set(t,e,n)}set(t,e,n){return delete this[n?"implicit":"explicit"][t],this[n?"explicit":"implicit"][t]=e,this}copyKeyFromSplit(t,{explicit:e,implicit:n}){void 0!==e[t]?this.set(t,e[t],!0):void 0!==n[t]&&this.set(t,n[t],!1)}copyKeyFromObject(t,e){void 0!==e[t]&&this.set(t,e[t],!0)}copyAll(t){for(const e of Xot(t.combine())){const n=t.getWithExplicit(e);this.setWithExplicit(e,n)}}}function mmt(t){return{explicit:!0,value:t}}function gmt(t){return{explicit:!1,value:t}}function ymt(t){return(e,n,r,i)=>{const o=t(e.value,n.value);return o>0?e:o<0?n:bmt(e,n,r,i)}}function bmt(t,e,n,r){return t.explicit&&e.explicit&&zut(function(t,e,n,r){return`Conflicting ${e.toString()} property "${t.toString()}" (${wst(n)} and ${wst(r)}). Using ${wst(n)}.`}(n,r,t.value,e.value)),t}function vmt(t,e,n,r,i=bmt){return void 0===t||void 0===t.value?e:t.explicit&&!e.explicit?t:e.explicit&&!t.explicit?e:vst(t.value,e.value)?t:i(t,e,n,r)}class wmt extends pmt{constructor(t={},e={},n=!1){super(t,e),this.explicit=t,this.implicit=e,this.parseNothing=n}clone(){const t=super.clone();return t.parseNothing=this.parseNothing,t}}function xmt(t){return"url"in t}function _mt(t){return"values"in t}function kmt(t){return"name"in t&&!xmt(t)&&!_mt(t)&&!Smt(t)}function Smt(t){return t&&(Emt(t)||Amt(t)||Cmt(t))}function Emt(t){return"sequence"in t}function Amt(t){return"sphere"in t}function Cmt(t){return"graticule"in t}var Dmt;function Mmt(t){const{signals:e,hasLegend:n,index:r,...i}=t;return i.field=sst(i.field),i}function Omt(t,e=!0,n=z$){if(Q$(t)){const r=t.map((t=>Omt(t,e,n)));return e?`[${r.join(", ")}]`:r}return jut(t)?n(e?Gut(t):function(t){const e=Hut(t,!0);return t.utc?+new Date(Date.UTC(...e)):+new Date(...e)}(t)):e?n(wst(t)):t}function Tmt(t,e){for(const n of Jot(t.component.selection??{})){const r=n.name;let i=`${r}${nyt}, ${"global"===n.resolve?"true":`{unit: ${syt(t)}}`}`;for(const r of oyt)r.defined(n)&&(r.signals&&(e=r.signals(t,n,e)),r.modifyExpr&&(i=r.modifyExpr(t,n,i)));e.push({name:r+ryt,on:[{events:{signal:n.name+nyt},update:`modify(${iL(n.name+eyt)}, ${i})`}]})}return $mt(e)}function Imt(t,e){if(t.component.selection&&Xot(t.component.selection).length){const n=iL(t.getName("cell"));e.unshift({name:"facet",value:{},on:[{events:tet("pointermove","scope"),update:`isTuple(facet) ? facet : group(${n}).datum`}]})}return $mt(e)}function Nmt(t,e){for(const n of Jot(t.component.selection??{}))for(const r of oyt)r.defined(n)&&r.marks&&(e=r.marks(t,n,e));return e}function $mt(t){return t.map((t=>(t.on&&!t.on.length&&delete t.on,t)))}!function(t){t[t.Raw=0]="Raw",t[t.Main=1]="Main",t[t.Row=2]="Row",t[t.Column=3]="Column",t[t.Lookup=4]="Lookup"}(Dmt||(Dmt={}));class Fmt{constructor(t,e){this.debugName=e,this._children=[],this._parent=null,t&&(this.parent=t)}clone(){throw new Error("Cannot clone node")}get parent(){return this._parent}set parent(t){this._parent=t,t&&t.addChild(this)}get children(){return this._children}numChildren(){return this._children.length}addChild(t,e){this._children.includes(t)?zut("Attempt to add the same child twice."):void 0!==e?this._children.splice(e,0,t):this._children.push(t)}removeChild(t){const e=this._children.indexOf(t);return this._children.splice(e,1),e}remove(){let t=this._parent.removeChild(this);for(const e of this._children)e._parent=this._parent,this._parent.addChild(e,t++)}insertAsParentOf(t){const e=t.parent;e.removeChild(this),this.parent=e,t.parent=this}swapWithParent(){const t=this._parent,e=t.parent;for(const e of this._children)e.parent=t;this._children=[],t.removeChild(this);const n=t.parent.removeChild(t);this._parent=e,e.addChild(this,n),t.parent=this}}class Lmt extends Fmt{clone(){const t=new this.constructor;return t.debugName=`clone_${this.debugName}`,t._source=this._source,t._name=`clone_${this._name}`,t.type=this.type,t.refCounts=this.refCounts,t.refCounts[t._name]=0,t}constructor(t,e,n,r){super(t,e),this.type=n,this.refCounts=r,this._source=this._name=e,this.refCounts&&!(this._name in this.refCounts)&&(this.refCounts[this._name]=0)}dependentFields(){return new Set}producedFields(){return new Set}hash(){return void 0===this._hash&&(this._hash=`Output ${fst()}`),this._hash}getSource(){return this.refCounts[this._name]++,this._source}isRequired(){return!!this.refCounts[this._name]}setSource(t){this._source=t}}function Bmt(t){return void 0!==t.as}function Rmt(t){return`${t}_end`}class Pmt extends Fmt{clone(){return new Pmt(null,Tot(this.timeUnits))}constructor(t,e){super(t),this.timeUnits=e}static makeFromEncoding(t,e){const n=e.reduceFieldDef(((t,n,r)=>{const{field:i,timeUnit:o}=n;if(o){let s;if(Jut(o)){if(Rvt(e)){const{mark:t,markDef:r,config:a}=e,l=eft({fieldDef:n,markDef:r,config:a});(Lht(t)||l)&&(s={timeUnit:ict(o),field:i})}}else s={as:_ft(n,{forAs:!0}),field:i,timeUnit:o};if(Rvt(e)){const{mark:t,markDef:i,config:o}=e,a=eft({fieldDef:n,markDef:i,config:o});Lht(t)&&Qat(r)&&.5!==a&&(s.rectBandPosition=a)}s&&(t[Fot(s)]=s)}return t}),{});return Yot(n)?null:new Pmt(t,n)}static makeFromTransform(t,e){const{timeUnit:n,...r}={...e},i={...r,timeUnit:ict(n)};return new Pmt(t,{[Fot(i)]:i})}merge(t){this.timeUnits={...this.timeUnits};for(const e in t.timeUnits)this.timeUnits[e]||(this.timeUnits[e]=t.timeUnits[e]);for(const e of t.children)t.removeChild(e),e.parent=this;t.remove()}removeFormulas(t){const e={};for(const[n,r]of Kot(this.timeUnits)){const i=Bmt(r)?r.as:`${r.field}_end`;t.has(i)||(e[n]=r)}this.timeUnits=e}producedFields(){return new Set(Jot(this.timeUnits).map((t=>Bmt(t)?t.as:Rmt(t.field))))}dependentFields(){return new Set(Jot(this.timeUnits).map((t=>t.field)))}hash(){return`TimeUnit ${Fot(this.timeUnits)}`}assemble(){const t=[];for(const e of Jot(this.timeUnits)){const{rectBandPosition:n}=e,r=ict(e.timeUnit);if(Bmt(e)){const{field:i,as:o}=e,{unit:s,utc:a,...l}=r,u=[o,`${o}_end`];t.push({field:sst(i),type:"timeunit",...s?{units:tct(s)}:{},...a?{timezone:"utc"}:{},...l,as:u}),t.push(...Vmt(u,n,r))}else if(e){const{field:i}=e,o=i.replaceAll("\\.","."),s=Umt({timeUnit:r,field:o}),a=Rmt(o);t.push({type:"formula",expr:s,as:a}),t.push(...Vmt([o,a],n,r))}}return t}}const zmt="offsetted_rect_start",jmt="offsetted_rect_end";function Umt({timeUnit:t,field:e,reverse:n}){const{unit:r,utc:i}=t,o=ect(r),{part:s,step:a}=act(o,t.step);return`${i?"utcOffset":"timeOffset"}('${s}', datum['${e}'], ${n?-a:a})`}function Vmt([t,e],n,r){if(void 0!==n&&.5!==n){const i=`datum['${t}']`,o=`datum['${e}']`;return[{type:"formula",expr:qmt([Umt({timeUnit:r,field:t,reverse:!0}),i],n+.5),as:`${t}_${zmt}`},{type:"formula",expr:qmt([i,o],n+.5),as:`${t}_${jmt}`}]}return[]}function qmt([t,e],n){return`${1-n} * ${t} + ${n} * ${e}`}const Wmt="_tuple_fields";class Hmt{constructor(...t){this.items=t,this.hasChannel={},this.hasField={},this.hasSelectionId=!1}}const Gmt={defined:()=>!0,parse:(t,e,n)=>{const r=e.name,i=e.project??(e.project=new Hmt),o={},s={},a=new Set,l=(t,e)=>{const n="visual"===e?t.channel:t.field;let i=Zot(`${r}_${n}`);for(let t=1;a.has(i);t++)i=Zot(`${r}_${n}_${t}`);return a.add(i),{[e]:i}},u=e.type,c=t.config.selection[u],h=void 0!==n.value?kF(n.value):null;let{fields:f,encodings:d}=Z$(n.select)?n.select:{};if(!f&&!d&&h)for(const t of h)if(Z$(t))for(const e of Xot(t))_at[e]?(d||(d=[])).push(e):"interval"===u?(zut('Interval selections should be initialized using "x", "y", "longitude", or "latitude" keys.'),d=c.encodings):(f??(f=[])).push(e);f||d||(d=c.encodings,"fields"in c&&(f=c.fields));for(const e of d??[]){const n=t.fieldDef(e);if(n){let r=n.field;if(n.aggregate){zut(gut(e,n.aggregate));continue}if(!r){zut(mut(e));continue}if(n.timeUnit&&!Jut(n.timeUnit)){r=t.vgField(e);const i={timeUnit:n.timeUnit,as:r,field:n.field};s[Fot(i)]=i}if(!o[r]){const s={field:r,channel:e,type:"interval"===u&&glt(e)&&zct(t.getScaleComponent(e).get("type"))?"R":n.bin?"R-RE":"E",index:i.items.length};s.signals={...l(s,"data"),...l(s,"visual")},i.items.push(o[r]=s),i.hasField[r]=o[r],i.hasSelectionId=i.hasSelectionId||r===Bdt,aat(e)?(s.geoChannel=e,s.channel=sat(e),i.hasChannel[s.channel]=o[r]):i.hasChannel[e]=o[r]}}else zut(mut(e))}for(const t of f??[]){if(i.hasField[t])continue;const e={type:"E",field:t,index:i.items.length};e.signals={...l(e,"data")},i.items.push(e),i.hasField[t]=e,i.hasSelectionId=i.hasSelectionId||t===Bdt}h&&(e.init=h.map((t=>i.items.map((e=>Z$(t)?void 0!==t[e.geoChannel||e.channel]?t[e.geoChannel||e.channel]:t[e.field]:t))))),Yot(s)||(i.timeUnit=new Pmt(null,s))},signals:(t,e,n)=>{const r=e.name+Wmt;return n.filter((t=>t.name===r)).length>0||e.project.hasSelectionId?n:n.concat({name:r,value:e.project.items.map(Mmt)})}},Ymt=Gmt,Xmt={defined:t=>"interval"===t.type&&"global"===t.resolve&&t.bind&&"scales"===t.bind,parse:(t,e)=>{const n=e.scales=[];for(const r of e.project.items){const i=r.channel;if(!glt(i))continue;const o=t.getScaleComponent(i),s=o?o.get("type"):void 0;"sequential"==s&&zut("Sequntial scales are deprecated. The available quantitative scale type values are linear, log, pow, sqrt, symlog, time and utc"),o&&zct(s)?(o.set("selectionExtent",{param:e.name,field:r.field},!0),n.push(r)):zut("Scale bindings are currently only supported for scales with unbinned, continuous domains.")}},topLevelSignals:(t,e,n)=>{const r=e.scales.filter((t=>0===n.filter((e=>e.name===t.signals.data)).length));if(!t.parent||Qmt(t)||0===r.length)return n;const i=n.filter((t=>t.name===e.name))[0];let o=i.update;if(o.indexOf(iyt)>=0)i.update=`{${r.map((t=>`${iL(sst(t.field))}: ${t.signals.data}`)).join(", ")}}`;else{for(const t of r){const e=`${iL(sst(t.field))}: ${t.signals.data}`;o.includes(e)||(o=`${o.substring(0,o.length-1)}, ${e}}`)}i.update=o}return n.concat(r.map((t=>({name:t.signals.data}))))},signals:(t,e,n)=>{if(t.parent&&!Qmt(t))for(const t of e.scales){const e=n.find((e=>e.name===t.signals.data));e.push="outer",delete e.value,delete e.update}return n}},Jmt=Xmt;function Kmt(t,e){return`domain(${iL(t.scaleName(e))})`}function Qmt(t){return t.parent&&jvt(t.parent)&&(!t.parent.parent??Qmt(t.parent.parent))}const Zmt="_brush",tgt="_scale_trigger",egt="geo_interval_init_tick",ngt="_init",rgt={defined:t=>"interval"===t.type,parse:(t,e,n)=>{var r;if(t.hasProjection){const t={...Z$(n.select)?n.select:{}};t.fields=[Bdt],t.encodings||(t.encodings=n.value?Xot(n.value):[Fst,$st]),n.select={type:"interval",...t}}if(e.translate&&!Jmt.defined(e)){const t=`!event.item || event.item.mark.name !== ${iL(e.name+Zmt)}`;for(const n of e.events){if(!n.between){zut(`${n} is not an ordered event stream for interval selections.`);continue}const e=kF((r=n.between[0]).filter??(r.filter=[]));e.indexOf(t)<0&&e.push(t)}}},signals:(t,e,n)=>{const r=e.name,i=r+nyt,o=Jot(e.project.hasChannel).filter((t=>t.channel===Sst||t.channel===Est)),s=e.init?e.init[0]:null;if(n.push(...o.reduce(((n,r)=>n.concat(function(t,e,n,r){const i=!t.hasProjection,o=n.channel,s=n.signals.visual,a=iL(i?t.scaleName(o):t.projectionName()),l=t=>`scale(${a}, ${t})`,u=t.getSizeSignalRef(o===Sst?"width":"height").signal,c=`${o}(unit)`,h=e.events.reduce(((t,e)=>[...t,{events:e.between[0],update:`[${c}, ${c}]`},{events:e,update:`[${s}[0], clamp(${c}, 0, ${u})]`}]),[]);if(i){const i=n.signals.data,u=Jmt.defined(e),c=t.getScaleComponent(o),f=c?c.get("type"):void 0,d=r?{init:Omt(r,!0,l)}:{value:[]};return h.push({events:{signal:e.name+tgt},update:zct(f)?`[${l(`${i}[0]`)}, ${l(`${i}[1]`)}]`:"[0, 0]"}),u?[{name:i,on:[]}]:[{name:s,...d,on:h},{name:i,...r?{init:Omt(r)}:{},on:[{events:{signal:s},update:`${s}[0] === ${s}[1] ? null : invert(${a}, ${s})`}]}]}{const t=o===Sst?0:1,n=e.name+ngt;return[{name:s,...r?{init:`[${n}[0][${t}], ${n}[1][${t}]]`}:{value:[]},on:h}]}}(t,e,r,s&&s[r.index]))),[])),t.hasProjection){const a=iL(t.projectionName()),l=t.projectionName()+"_center",{x:u,y:c}=e.project.hasChannel,h=u&&u.signals.visual,f=c&&c.signals.visual,d=u?s&&s[u.index]:`${l}[0]`,p=c?s&&s[c.index]:`${l}[1]`,m=e=>t.getSizeSignalRef(e).signal,g=`[[${h?h+"[0]":"0"}, ${f?f+"[0]":"0"}],[${h?h+"[1]":m("width")}, ${f?f+"[1]":m("height")}]]`;if(s&&(n.unshift({name:r+ngt,init:`[scale(${a}, [${u?d[0]:d}, ${c?p[0]:p}]), scale(${a}, [${u?d[1]:d}, ${c?p[1]:p}])]`}),!u||!c)){n.find((t=>t.name===l))||n.unshift({name:l,update:`invert(${a}, [${m("width")}/2, ${m("height")}/2])`})}const y=`vlSelectionTuples(intersect(${g}, {markname: ${iL(t.getName("marks"))}}, unit.mark), {unit: ${syt(t)}})`,b=o.map((t=>t.signals.visual));return n.concat({name:i,on:[{events:[...b.length?[{signal:b.join(" || ")}]:[],...s?[{signal:egt}]:[]],update:y}]})}{if(!Jmt.defined(e)){const e=r+tgt,i=o.map((e=>{const n=e.channel,{data:r,visual:i}=e.signals,o=iL(t.scaleName(n)),s=zct(t.getScaleComponent(n).get("type"))?"+":"";return`(!isArray(${r}) || (${s}invert(${o}, ${i})[0] === ${s}${r}[0] && ${s}invert(${o}, ${i})[1] === ${s}${r}[1]))`}));i.length&&n.push({name:e,value:{},on:[{events:o.map((e=>({scale:t.scaleName(e.channel)}))),update:i.join(" && ")+` ? ${e} : {}`}]})}const a=o.map((t=>t.signals.data)),l=`unit: ${syt(t)}, fields: ${r+Wmt}, values`;return n.concat({name:i,...s?{init:`{${l}: ${Omt(s)}}`}:{},...a.length?{on:[{events:[{signal:a.join(" || ")}],update:`${a.join(" && ")} ? {${l}: [${a}]} : null`}]}:{}})}},topLevelSignals:(t,e,n)=>{if(Rvt(t)&&t.hasProjection&&e.init){n.filter((t=>t.name===egt)).length||n.unshift({name:egt,value:null,on:[{events:"timer{1}",update:`${egt} === null ? {} : ${egt}`}]})}return n},marks:(t,e,n)=>{const r=e.name,{x:i,y:o}=e.project.hasChannel,s=i?.signals.visual,a=o?.signals.visual,l=`data(${iL(e.name+eyt)})`;if(Jmt.defined(e)||!i&&!o)return n;const u={x:void 0!==i?{signal:`${s}[0]`}:{value:0},y:void 0!==o?{signal:`${a}[0]`}:{value:0},x2:void 0!==i?{signal:`${s}[1]`}:{field:{group:"width"}},y2:void 0!==o?{signal:`${a}[1]`}:{field:{group:"height"}}};if("global"===e.resolve)for(const e of Xot(u))u[e]=[{test:`${l}.length && ${l}[0].unit === ${syt(t)}`,...u[e]},{value:0}];const{fill:c,fillOpacity:h,cursor:f,...d}=e.mark,p=Xot(d).reduce(((t,e)=>(t[e]=[{test:[void 0!==i&&`${s}[0] !== ${s}[1]`,void 0!==o&&`${a}[0] !== ${a}[1]`].filter((t=>t)).join(" && "),value:d[e]},{value:null}],t)),{}),m=f??(e.translate?"move":null);return[{name:`${r+Zmt}_bg`,type:"rect",clip:!0,encode:{enter:{fill:{value:c},fillOpacity:{value:h}},update:u}},...n,{name:r+Zmt,type:"rect",clip:!0,encode:{enter:{...m?{cursor:{value:m}}:{},fill:{value:"transparent"}},update:{...u,...p}}}]}},igt=rgt,ogt={defined:t=>"point"===t.type,signals:(t,e,n)=>{const r=e.name,i=r+Wmt,o=e.project,s="(item().isVoronoi ? datum.datum : datum)",a=Jot(t.component.selection??{}).reduce(((t,e)=>"interval"===e.type?t.concat(e.name+Zmt):t),[]).map((t=>`indexof(item().mark.name, '${t}') < 0`)).join(" && "),l="datum && item().mark.marktype !== 'group' && indexof(item().mark.role, 'legend') < 0"+(a?` && ${a}`:"");let u=`unit: ${syt(t)}, `;e.project.hasSelectionId?u+=`${Bdt}: ${s}[${iL(Bdt)}]`:u+=`fields: ${i}, values: [${o.items.map((e=>{const n=t.fieldDef(e.channel);return n?.bin?`[${s}[${iL(t.vgField(e.channel,{}))}], ${s}[${iL(t.vgField(e.channel,{binSuffix:"end"}))}]]`:`${s}[${iL(e.field)}]`})).join(", ")}]`;const c=e.events;return n.concat([{name:r+nyt,on:c?[{events:c,update:`${l} ? {${u}} : null`,force:!0}]:[]}])}},sgt=ogt;function agt(t,e,n,r){const i=oft(e)&&e.condition,o=r(e);if(i){const e=kF(i).map((e=>{const n=r(e);if(function(t){return t.param}(e)){const{param:r,empty:i}=e;return{test:dyt(t,{param:r,empty:i}),...n}}return{test:myt(t,e.test),...n}}));return{[n]:[...e,...void 0!==o?[o]:[]]}}return void 0!==o?{[n]:o}:{}}function lgt(t,e="text"){const n=t.encoding[e];return agt(t,n,e,(e=>ugt(e,t.config)))}function ugt(t,e,n="datum"){if(t){if(gft(t))return Xlt(t.value);if(pft(t)){const{format:r,formatType:i}=Oft(t);return hht({fieldOrDatumDef:t,format:r,formatType:i,expr:n,config:e})}}}function cgt(t,e={}){const{encoding:n,markDef:r,config:i,stack:o}=t,s=n.tooltip;if(Q$(s))return{tooltip:fgt({tooltip:s},o,i,e)};{const a=e.reactiveGeom?"datum.datum":"datum";return agt(t,s,"tooltip",(t=>{const s=ugt(t,i,a);if(s)return s;if(null===t)return;let l=eut("tooltip",r,i);return!0===l&&(l={content:"encoding"}),XF(l)?{value:l}:Z$(l)?zlt(l)?l:"encoding"===l.content?fgt(n,o,i,e):{signal:a}:void 0}))}}function hgt(t,e,n,{reactiveGeom:r}={}){const i={...n,...n.tooltipFormat},o={},s=r?"datum.datum":"datum",a=[];function l(n,r){const l=Aat(r),u=mft(n)?n:{...n,type:t[l].type},c=kF(u.title||Mft(u,i)).join(", ").replaceAll(/"/g,'\\"');let h;if(Qat(r)){const e="x"===r?"x2":"y2",n=Tft(t[e]);if(Ilt(u.bin)&&n){const t=_ft(u,{expr:s}),r=_ft(n,{expr:s}),{format:a,formatType:l}=Oft(u);h=vht(t,r,a,l,i),o[e]=!0}}if((Qat(r)||r===Ist||r===Ost)&&e&&e.fieldChannel===r&&"normalize"===e.offset){const{format:t,formatType:e}=Oft(u);h=hht({fieldOrDatumDef:u,format:t,formatType:e,expr:s,config:i,normalizeStack:!0}).signal}h??(h=ugt(u,i,s).signal),a.push({channel:r,key:c,value:h})}odt(t,((t,e)=>{lft(t)?l(t,e):sft(t)&&l(t.condition,e)}));const u={};for(const{channel:t,key:e,value:n}of a)o[t]||u[e]||(u[e]=n);return u}function fgt(t,e,n,{reactiveGeom:r}={}){const i=hgt(t,e,n,{reactiveGeom:r}),o=Kot(i).map((([t,e])=>`"${t}": ${e}`));return o.length>0?{signal:`{${o.join(", ")}}`}:void 0}function dgt(t){const{markDef:e,config:n}=t,r=eut("aria",e,n);return!1===r?{}:{...r?{aria:r}:{},...pgt(t),...mgt(t)}}function pgt(t){const{mark:e,markDef:n,config:r}=t;if(!1===r.aria)return{};const i=eut("ariaRoleDescription",n,r);return null!=i?{ariaRoleDescription:{value:i}}:e in qlt?{}:{ariaRoleDescription:{value:e}}}function mgt(t){const{encoding:e,markDef:n,config:r,stack:i}=t,o=e.description;if(o)return agt(t,o,"description",(e=>ugt(e,t.config)));const s=eut("description",n,r);if(null!=s)return{description:Xlt(s)};if(!1===r.aria)return{};const a=hgt(e,i,r);return Yot(a)?void 0:{description:{signal:Kot(a).map((([t,e],n)=>`"${n>0?"; ":""}${t}: " + (${e})`)).join(" + ")}}}function ggt(t,e,n={}){const{markDef:r,encoding:i,config:o}=e,{vgChannel:s}=n;let{defaultRef:a,defaultValue:l}=n;void 0===a&&(l??(l=eut(t,r,o,{vgChannel:s,ignoreVgConfig:!0})),void 0!==l&&(a=Xlt(l)));const u=i[t];return agt(e,u,s??t,(n=>sht({channel:t,channelDef:n,markDef:r,config:o,scaleName:e.scaleName(t),scale:e.getScaleComponent(t),stack:null,defaultRef:a})))}function ygt(t,e={filled:void 0}){const{markDef:n,encoding:r,config:i}=t,{type:o}=n,s=e.filled??eut("filled",n,i),a=Bot(["bar","point","circle","square","geoshape"],o)?"transparent":void 0,l=eut(!0===s?"color":void 0,n,i,{vgChannel:"fill"})??i.mark[!0===s&&"color"]??a,u=eut(!1===s?"color":void 0,n,i,{vgChannel:"stroke"})??i.mark[!1===s&&"color"],c=s?"fill":"stroke",h={...l?{fill:Xlt(l)}:{},...u?{stroke:Xlt(u)}:{}};return n.color&&(s?n.fill:n.stroke)&&zut(kut("property",{fill:"fill"in n,stroke:"stroke"in n})),{...h,...ggt("color",t,{vgChannel:c,defaultValue:s?l:u}),...ggt("fill",t,{defaultValue:r.fill?l:void 0}),...ggt("stroke",t,{defaultValue:r.stroke?u:void 0})}}function bgt(t){const{encoding:e,mark:n}=t,r=e.order;return!Fht(n)&&gft(r)?agt(t,r,"zindex",(t=>Xlt(t.value))):{}}function vgt({channel:t,markDef:e,encoding:n={},model:r,bandPosition:i}){const o=`${t}Offset`,s=e[o],a=n[o];if(("xOffset"===o||"yOffset"===o)&&a)return{offsetType:"encoding",offset:sht({channel:o,channelDef:a,markDef:e,config:r?.config,scaleName:r.scaleName(o),scale:r.getScaleComponent(o),stack:null,defaultRef:Xlt(s),bandPosition:i})};const l=e[o];return l?{offsetType:"visual",offset:l}:{}}function wgt(t,e,{defaultPos:n,vgChannel:r}){const{encoding:i,markDef:o,config:s,stack:a}=e,l=i[t],u=i[Dat(t)],c=e.scaleName(t),h=e.getScaleComponent(t),{offset:f,offsetType:d}=vgt({channel:t,markDef:o,encoding:i,model:e,bandPosition:.5}),p=xgt({model:e,defaultPos:n,channel:t,scaleName:c,scale:h}),m=!l&&Qat(t)&&(i.latitude||i.longitude)?{field:e.getName(t)}:function(t){const{channel:e,channelDef:n,scaleName:r,stack:i,offset:o,markDef:s}=t;if(pft(n)&&i&&e===i.fieldChannel){if(lft(n)){let t=n.bandPosition;if(void 0!==t||"text"!==s.type||"radius"!==e&&"theta"!==e||(t=.5),void 0!==t)return oht({scaleName:r,fieldOrDatumDef:n,startSuffix:"start",bandPosition:t,offset:o})}return iht(n,r,{suffix:"end"},{offset:o})}return eht(t)}({channel:t,channelDef:l,channel2Def:u,markDef:o,config:s,scaleName:c,scale:h,stack:a,offset:f,defaultRef:p,bandPosition:"encoding"===d?0:void 0});return m?{[r||t]:m}:void 0}function xgt({model:t,defaultPos:e,channel:n,scaleName:r,scale:i}){const{markDef:o,config:s}=t;return()=>{const a=Aat(n),l=Cat(n),u=eut(n,o,s,{vgChannel:l});if(void 0!==u)return aht(n,u);switch(e){case"zeroOrMin":case"zeroOrMax":if(r){const t=i.get("type");if(Bot([Dct.LOG,Dct.TIME,Dct.UTC],t));else if(i.domainDefinitelyIncludesZero())return{scale:r,value:0}}if("zeroOrMin"===e)return"y"===a?{field:{group:"height"}}:{value:0};switch(a){case"radius":return{signal:`min(${t.width.signal},${t.height.signal})/2`};case"theta":return{signal:"2*PI"};case"x":return{field:{group:"width"}};case"y":return{value:0}}break;case"mid":return{...t[Mat(n)],mult:.5}}}}const _gt={left:"x",center:"xc",right:"x2"},kgt={top:"y",middle:"yc",bottom:"y2"};function Sgt(t,e,n,r="middle"){if("radius"===t||"theta"===t)return Cat(t);const i="x"===t?"align":"baseline",o=eut(i,e,n);let s;return zlt(o)?(zut(function(t){return`The ${t} for range marks cannot be an expression`}(i)),s=void 0):s=o,"x"===t?_gt[s||("top"===r?"left":"center")]:kgt[s||r]}function Egt(t,e,{defaultPos:n,defaultPos2:r,range:i}){return i?Agt(t,e,{defaultPos:n,defaultPos2:r}):wgt(t,e,{defaultPos:n})}function Agt(t,e,{defaultPos:n,defaultPos2:r}){const{markDef:i,config:o}=e,s=Dat(t),a=Mat(t),l=function(t,e,n){const{encoding:r,mark:i,markDef:o,stack:s,config:a}=t,l=Aat(n),u=Mat(n),c=Cat(n),h=r[l],f=t.scaleName(l),d=t.getScaleComponent(l),{offset:p}=vgt(n in r||n in o?{channel:n,markDef:o,encoding:r,model:t}:{channel:l,markDef:o,encoding:r,model:t});if(!h&&("x2"===n||"y2"===n)&&(r.latitude||r.longitude)){const e=Mat(n),r=t.markDef[e];return null!=r?{[e]:{value:r}}:{[c]:{field:t.getName(n)}}}const m=function({channel:t,channelDef:e,channel2Def:n,markDef:r,config:i,scaleName:o,scale:s,stack:a,offset:l,defaultRef:u}){return pft(e)&&a&&t.charAt(0)===a.fieldChannel.charAt(0)?iht(e,o,{suffix:"start"},{offset:l}):eht({channel:t,channelDef:n,scaleName:o,scale:s,stack:a,markDef:r,config:i,offset:l,defaultRef:u})}({channel:n,channelDef:h,channel2Def:r[n],markDef:o,config:a,scaleName:f,scale:d,stack:s,offset:p,defaultRef:void 0});return void 0!==m?{[c]:m}:Cgt(n,o)||Cgt(n,{[n]:rut(n,o,a.style),[u]:rut(u,o,a.style)})||Cgt(n,a[i])||Cgt(n,a.mark)||{[c]:xgt({model:t,defaultPos:e,channel:n,scaleName:f,scale:d})()}}(e,r,s);return{...wgt(t,e,{defaultPos:n,vgChannel:l[a]?Sgt(t,i,o):Cat(t)}),...l}}function Cgt(t,e){const n=Mat(t),r=Cat(t);if(void 0!==e[r])return{[r]:aht(t,e[r])};if(void 0!==e[t])return{[r]:aht(t,e[t])};if(e[n]){const r=e[n];if(!Uht(r))return{[n]:aht(t,r)};zut(function(t){return`Position range does not support relative band size for ${t}.`}(n))}}function Dgt(t,e){const{config:n,encoding:r,markDef:i}=t,o=i.type,s=Dat(e),a=Mat(e),l=r[e],u=r[s],c=t.getScaleComponent(e),h=c?c.get("type"):void 0,f=i.orient,d=r[a]??r.size??eut("size",i,n,{vgChannel:a}),p=Oat(e),m="bar"===o&&("x"===e?"vertical"===f:"horizontal"===f);return!lft(l)||!(Tlt(l.bin)||Ilt(l.bin)||l.timeUnit&&!u)||d&&!Uht(d)||r[p]||Pct(h)?(pft(l)&&Pct(h)||m)&&!u?function(t,e,n){const{markDef:r,encoding:i,config:o,stack:s}=n,a=r.orient,l=n.scaleName(e),u=n.getScaleComponent(e),c=Mat(e),h=Dat(e),f=Oat(e),d=n.scaleName(f),p=n.getScaleComponent(Tat(e)),m="horizontal"===a&&"y"===e||"vertical"===a&&"x"===e;let g;(i.size||r.size)&&(m?g=ggt("size",n,{vgChannel:c,defaultRef:Xlt(r.size)}):zut(function(t){return`Cannot apply size to non-oriented mark "${t}".`}(r.type)));const y=!!g,b=nft({channel:e,fieldDef:t,markDef:r,config:o,scaleType:(u||p)?.get("type"),useVlSizeChannel:m});g=g||{[c]:Mgt(c,d||l,p||u,o,b,!!t,r.type)};const v=Sgt(e,r,o,"band"===(u||p)?.get("type")&&Uht(b)&&!y?"top":"middle"),w="xc"===v||"yc"===v,{offset:x,offsetType:_}=vgt({channel:e,markDef:r,encoding:i,model:n,bandPosition:w?.5:0}),k=eht({channel:e,channelDef:t,markDef:r,config:o,scaleName:l,scale:u,stack:s,offset:x,defaultRef:xgt({model:n,defaultPos:"mid",channel:e,scaleName:l,scale:u}),bandPosition:w?"encoding"===_?0:.5:zlt(b)?{signal:`(1-${b})/2`}:Uht(b)?(1-b.band)/2:0});if(c)return{[v]:k,...g};{const t=Cat(h),e=g[c],n=x?{...e,offset:x}:e;return{[v]:k,[t]:Q$(k)?[k[0],{...k[1],offset:n}]:{...k,offset:n}}}}(l,e,t):Agt(e,t,{defaultPos:"zeroOrMax",defaultPos2:"zeroOrMin"}):function({fieldDef:t,fieldDef2:e,channel:n,model:r}){const{config:i,markDef:o,encoding:s}=r,a=r.getScaleComponent(n),l=r.scaleName(n),u=a?a.get("type"):void 0,c=a.get("reverse"),h=nft({channel:n,fieldDef:t,markDef:o,config:i,scaleType:u}),f=r.component.axes[n]?.[0],d=f?.get("translate")??.5,p=Qat(n)?eut("binSpacing",o,i)??0:0,m=Dat(n),g=Cat(n),y=Cat(m),b=nut("minBandSize",o,i),{offset:v}=vgt({channel:n,markDef:o,encoding:s,model:r,bandPosition:0}),{offset:w}=vgt({channel:m,markDef:o,encoding:s,model:r,bandPosition:0}),x=function({scaleName:t,fieldDef:e}){const n=_ft(e,{expr:"datum"});return`abs(scale("${t}", ${_ft(e,{expr:"datum",suffix:"end"})}) - scale("${t}", ${n}))`}({fieldDef:t,scaleName:l}),_=Ogt(n,p,c,d,v,b,x),k=Ogt(m,p,c,d,w??v,b,x),S=zlt(h)?{signal:`(1-${h.signal})/2`}:Uht(h)?(1-h.band)/2:.5,E=eft({fieldDef:t,fieldDef2:e,markDef:o,config:i});if(Tlt(t.bin)||t.timeUnit){const e=t.timeUnit&&.5!==E;return{[y]:Tgt({fieldDef:t,scaleName:l,bandPosition:S,offset:k,useRectOffsetField:e}),[g]:Tgt({fieldDef:t,scaleName:l,bandPosition:zlt(S)?{signal:`1-${S.signal}`}:1-S,offset:_,useRectOffsetField:e})}}if(Ilt(t.bin)){const n=iht(t,l,{},{offset:k});if(lft(e))return{[y]:n,[g]:iht(e,l,{},{offset:_})};if(Nlt(t.bin)&&t.bin.step)return{[y]:n,[g]:{signal:`scale("${l}", ${_ft(t,{expr:"datum"})} + ${t.bin.step})`,offset:_}}}zut(But(m))}({fieldDef:l,fieldDef2:u,channel:e,model:t})}function Mgt(t,e,n,r,i,o,s){if(Uht(i)){if(!n)return{mult:i.band,field:{group:t}};{const t=n.get("type");if("band"===t){let t=`bandwidth('${e}')`;1!==i.band&&(t=`${i.band} * ${t}`);const n=nut("minBandSize",{type:s},r);return{signal:n?`max(${Qlt(n)}, ${t})`:t}}1!==i.band&&(zut(function(t){return`Cannot use the relative band size with ${t} scale.`}(t)),i=void 0)}}else{if(zlt(i))return i;if(i)return{value:i}}if(n){const t=n.get("range");if(jlt(t)&&GF(t.step))return{value:t.step-2}}if(!o){const{bandPaddingInner:e,barBandPaddingInner:n,rectBandPaddingInner:i}=r.scale,o=cst(e,"bar"===s?n:i);if(zlt(o))return{signal:`(1 - (${o.signal})) * ${t}`};if(GF(o))return{signal:`${1-o} * ${t}`}}return{value:Kdt(r.view,t)-2}}function Ogt(t,e,n,r,i,o,s){if(iat(t))return 0;const a="x"===t||"y2"===t,l=a?-e/2:e/2;if(zlt(n)||zlt(i)||zlt(r)||o){const t=Qlt(n),e=Qlt(i),u=Qlt(r),c=Qlt(o),h=o?`(${s} < ${c} ? ${a?"":"-"}0.5 * (${c} - (${s})) : ${l})`:l;return{signal:(u?`${u} + `:"")+(t?`(${t} ? -1 : 1) * `:"")+(e?`(${e} + ${h})`:h)}}return i=i||0,r+(n?-i-l:+i+l)}function Tgt({fieldDef:t,scaleName:e,bandPosition:n,offset:r,useRectOffsetField:i}){return oht({scaleName:e,fieldOrDatumDef:t,bandPosition:n,offset:r,...i?{startSuffix:zmt,endSuffix:jmt}:{}})}const Igt=new Set(["aria","width","height"]);function Ngt(t,e){const{fill:n,stroke:r}="include"===e.color?ygt(t):{};return{...Fgt(t.markDef,e),...$gt(t,"fill",n),...$gt(t,"stroke",r),...ggt("opacity",t),...ggt("fillOpacity",t),...ggt("strokeOpacity",t),...ggt("strokeWidth",t),...ggt("strokeDash",t),...bgt(t),...cgt(t),...lgt(t,"href"),...dgt(t)}}function $gt(t,e,n){const{config:r,mark:i,markDef:o}=t;if("hide"===eut("invalid",o,r)&&n&&!Fht(i)){const r=function(t,{invalid:e=!1,channels:n}){const r=n.reduce(((e,n)=>{const r=t.getScaleComponent(n);if(r){const i=r.get("type"),o=t.vgField(n,{expr:"datum"});o&&zct(i)&&(e[o]=!0)}return e}),{}),i=Xot(r);if(i.length>0){const t=e?"||":"&&";return i.map((t=>rht(t,e))).join(` ${t} `)}}(t,{invalid:!0,channels:mlt});if(r)return{[e]:[{test:r,value:null},...kF(n)]}}return n?{[e]:n}:{}}function Fgt(t,e){return Vlt.reduce(((n,r)=>(Igt.has(r)||void 0===t[r]||"ignore"===e[r]||(n[r]=Xlt(t[r])),n)),{})}function Lgt(t){const{config:e,markDef:n}=t;if(eut("invalid",n,e)){const e=function(t,{invalid:e=!1,channels:n}){const r=n.reduce(((e,n)=>{const r=t.getScaleComponent(n);if(r){const i=r.get("type"),o=t.vgField(n,{expr:"datum",binSuffix:t.stack?.impute?"mid":void 0});o&&zct(i)&&(e[o]=!0)}return e}),{}),i=Xot(r);if(i.length>0){const t=e?"||":"&&";return i.map((t=>rht(t,e))).join(` ${t} `)}}(t,{channels:Kat});if(e)return{defined:{signal:e}}}return{}}function Bgt(t,e){if(void 0!==e)return{[t]:Xlt(e)}}const Rgt="voronoi",Pgt={defined:t=>"point"===t.type&&t.nearest,parse:(t,e)=>{if(e.events)for(const n of e.events)n.markname=t.getName(Rgt)},marks:(t,e,n)=>{const{x:r,y:i}=e.project.hasChannel,o=t.mark;if(Fht(o))return zut(`The "nearest" transform is not supported for ${o} marks.`),n;const s={name:t.getName(Rgt),type:"path",interactive:!0,from:{data:t.getName("marks")},encode:{update:{fill:{value:"transparent"},strokeWidth:{value:.35},stroke:{value:"transparent"},isVoronoi:{value:!0},...cgt(t,{reactiveGeom:!0})}},transform:[{type:"voronoi",x:{expr:r||!i?"datum.datum.x || 0":"0"},y:{expr:i||!r?"datum.datum.y || 0":"0"},size:[t.getSizeSignalRef("width"),t.getSizeSignalRef("height")]}]};let a=0,l=!1;return n.forEach(((e,n)=>{const r=e.name??"";r===t.component.mark[0].name?a=n:r.indexOf(Rgt)>=0&&(l=!0)})),l||n.splice(a+1,0,s),n}},zgt=Pgt,jgt={defined:t=>"point"===t.type&&"global"===t.resolve&&t.bind&&"scales"!==t.bind&&!Pdt(t.bind),parse:(t,e,n)=>lyt(e,n),topLevelSignals:(t,e,n)=>{const r=e.name,i=e.project,o=e.bind,s=e.init&&e.init[0],a=zgt.defined(e)?"(item().isVoronoi ? datum.datum : datum)":"datum";return i.items.forEach(((t,i)=>{const l=Zot(`${r}_${t.field}`);n.filter((t=>t.name===l)).length||n.unshift({name:l,...s?{init:Omt(s[i])}:{value:null},on:e.events?[{events:e.events,update:`datum && item().mark.marktype !== 'group' ? ${a}[${iL(t.field)}] : null`}]:[],bind:o[t.field]??o[t.channel]??o})})),n},signals:(t,e,n)=>{const r=e.name,i=e.project,o=n.filter((t=>t.name===r+nyt))[0],s=r+Wmt,a=i.items.map((t=>Zot(`${r}_${t.field}`))),l=a.map((t=>`${t} !== null`)).join(" && ");return a.length&&(o.update=`${l} ? {fields: ${s}, values: [${a.join(", ")}]} : null`),delete o.value,delete o.on,n}},Ugt=jgt,Vgt="_toggle",qgt={defined:t=>"point"===t.type&&!!t.toggle,signals:(t,e,n)=>n.concat({name:e.name+Vgt,value:!1,on:[{events:e.events,update:e.toggle}]}),modifyExpr:(t,e)=>{const n=e.name+nyt,r=e.name+Vgt;return`${r} ? null : ${n}, `+("global"===e.resolve?`${r} ? null : true, `:`${r} ? null : {unit: ${syt(t)}}, `)+`${r} ? ${n} : null`}},Wgt={defined:t=>void 0!==t.clear&&!1!==t.clear,parse:(t,e)=>{e.clear&&(e.clear=XF(e.clear)?tet(e.clear,"view"):e.clear)},topLevelSignals:(t,e,n)=>{if(Ugt.defined(e))for(const t of e.project.items){const r=n.findIndex((n=>n.name===Zot(`${e.name}_${t.field}`)));-1!==r&&n[r].on.push({events:e.clear,update:"null"})}return n},signals:(t,e,n)=>{function r(t,r){-1!==t&&n[t].on&&n[t].on.push({events:e.clear,update:r})}if("interval"===e.type)for(const t of e.project.items){const e=n.findIndex((e=>e.name===t.signals.visual));r(e,"[0, 0]"),-1===e&&r(n.findIndex((e=>e.name===t.signals.data)),"null")}else{let t=n.findIndex((t=>t.name===e.name+nyt));r(t,"null"),qgt.defined(e)&&(t=n.findIndex((t=>t.name===e.name+Vgt)),r(t,"false"))}return n}},Hgt={defined:t=>{const e="global"===t.resolve&&t.bind&&Pdt(t.bind),n=1===t.project.items.length&&t.project.items[0].field!==Bdt;return e&&!n&&zut("Legend bindings are only supported for selections over an individual field or encoding channel."),e&&n},parse:(t,e,n)=>{const r=Tot(n);if(r.select=XF(r.select)?{type:r.select,toggle:e.toggle}:{...r.select,toggle:e.toggle},lyt(e,r),Z$(n.select)&&(n.select.on||n.select.clear)){const t='event.item && indexof(event.item.mark.role, "legend") < 0';for(const n of e.events)n.filter=kF(n.filter??[]),n.filter.includes(t)||n.filter.push(t)}const i=zdt(e.bind)?e.bind.legend:"click",o=XF(i)?tet(i,"view"):kF(i);e.bind={legend:{merge:o}}},topLevelSignals:(t,e,n)=>{const r=e.name,i=zdt(e.bind)&&e.bind.legend,o=t=>e=>{const n=Tot(e);return n.markname=t,n};for(const t of e.project.items){if(!t.hasLegend)continue;const s=`${Zot(t.field)}_legend`,a=`${r}_${s}`;if(0===n.filter((t=>t.name===a)).length){const t=i.merge.map(o(`${s}_symbols`)).concat(i.merge.map(o(`${s}_labels`))).concat(i.merge.map(o(`${s}_entries`)));n.unshift({name:a,...e.init?{}:{value:null},on:[{events:t,update:"isDefined(datum.value) ? datum.value : item().items[0].items[0].datum.value",force:!0},{events:i.merge,update:`!event.item || !datum ? null : ${a}`,force:!0}]})}}return n},signals:(t,e,n)=>{const r=e.name,i=e.project,o=n.find((t=>t.name===r+nyt)),s=r+Wmt,a=i.items.filter((t=>t.hasLegend)).map((t=>Zot(`${r}_${Zot(t.field)}_legend`))),l=`${a.map((t=>`${t} !== null`)).join(" && ")} ? {fields: ${s}, values: [${a.join(", ")}]} : null`;e.events&&a.length>0?o.on.push({events:a.map((t=>({signal:t}))),update:l}):a.length>0&&(o.update=l,delete o.value,delete o.on);const u=n.find((t=>t.name===r+Vgt)),c=zdt(e.bind)&&e.bind.legend;return u&&(e.events?u.on.push({...u.on[0],events:c}):u.on[0].events=c),n}},Ggt="_translate_anchor",Ygt="_translate_delta",Xgt={defined:t=>"interval"===t.type&&t.translate,signals:(t,e,n)=>{const r=e.name,i=Jmt.defined(e),o=r+Ggt,{x:s,y:a}=e.project.hasChannel;let l=tet(e.translate,"scope");return i||(l=l.map((t=>(t.between[0].markname=r+Zmt,t)))),n.push({name:o,value:{},on:[{events:l.map((t=>t.between[0])),update:"{x: x(unit), y: y(unit)"+(void 0!==s?`, extent_x: ${i?Kmt(t,Sst):`slice(${s.signals.visual})`}`:"")+(void 0!==a?`, extent_y: ${i?Kmt(t,Est):`slice(${a.signals.visual})`}`:"")+"}"}]},{name:r+Ygt,value:{},on:[{events:l,update:`{x: ${o}.x - x(unit), y: ${o}.y - y(unit)}`}]}),void 0!==s&&Jgt(t,e,s,"width",n),void 0!==a&&Jgt(t,e,a,"height",n),n}};function Jgt(t,e,n,r,i){const o=e.name,s=o+Ggt,a=o+Ygt,l=n.channel,u=Jmt.defined(e),c=i.filter((t=>t.name===n.signals[u?"data":"visual"]))[0],h=t.getSizeSignalRef(r).signal,f=t.getScaleComponent(l),d=f&&f.get("type"),p=f&&f.get("reverse"),m=`${s}.extent_${l}`,g=`${u&&f?"log"===d?"panLog":"symlog"===d?"panSymlog":"pow"===d?"panPow":"panLinear":"panLinear"}(${m}, ${u?l===Sst?p?"":"-":p?"-":"":""}${a}.${l} / ${u?`${h}`:`span(${m})`}${u?"pow"===d?`, ${f.get("exponent")??1}`:"symlog"===d?`, ${f.get("constant")??1}`:"":""})`;c.on.push({events:{signal:a},update:u?g:`clampRange(${g}, 0, ${h})`})}const Kgt="_zoom_anchor",Qgt="_zoom_delta",Zgt={defined:t=>"interval"===t.type&&t.zoom,signals:(t,e,n)=>{const r=e.name,i=Jmt.defined(e),o=r+Qgt,{x:s,y:a}=e.project.hasChannel,l=iL(t.scaleName(Sst)),u=iL(t.scaleName(Est));let c=tet(e.zoom,"scope");return i||(c=c.map((t=>(t.markname=r+Zmt,t)))),n.push({name:r+Kgt,on:[{events:c,update:i?"{"+[l?`x: invert(${l}, x(unit))`:"",u?`y: invert(${u}, y(unit))`:""].filter((t=>t)).join(", ")+"}":"{x: x(unit), y: y(unit)}"}]},{name:o,on:[{events:c,force:!0,update:"pow(1.001, event.deltaY * pow(16, event.deltaMode))"}]}),void 0!==s&&tyt(t,e,s,"width",n),void 0!==a&&tyt(t,e,a,"height",n),n}};function tyt(t,e,n,r,i){const o=e.name,s=n.channel,a=Jmt.defined(e),l=i.filter((t=>t.name===n.signals[a?"data":"visual"]))[0],u=t.getSizeSignalRef(r).signal,c=t.getScaleComponent(s),h=c&&c.get("type"),f=a?Kmt(t,s):l.name,d=o+Qgt,p=`${a&&c?"log"===h?"zoomLog":"symlog"===h?"zoomSymlog":"pow"===h?"zoomPow":"zoomLinear":"zoomLinear"}(${f}, ${o}${Kgt}.${s}, ${d}${a?"pow"===h?`, ${c.get("exponent")??1}`:"symlog"===h?`, ${c.get("constant")??1}`:"":""})`;l.on.push({events:{signal:d},update:a?p:`clampRange(${p}, 0, ${u})`})}const eyt="_store",nyt="_tuple",ryt="_modify",iyt="vlSelectionResolve",oyt=[sgt,igt,Ymt,qgt,Ugt,Jmt,Hgt,Wgt,Xgt,Zgt,zgt];function syt(t,{escape:e}={escape:!0}){let n=e?iL(t.name):t.name;const r=function(t){let e=t.parent;for(;e&&!Pvt(e);)e=e.parent;return e}(t);if(r){const{facet:t}=r;for(const e of fat)t[e]&&(n+=` + '__facet_${e}_' + (facet[${iL(r.vgField(e))}])`)}return n}function ayt(t){return Jot(t.component.selection??{}).reduce(((t,e)=>t||e.project.hasSelectionId),!1)}function lyt(t,e){!XF(e.select)&&e.select.on||delete t.events,!XF(e.select)&&e.select.clear||delete t.clear,!XF(e.select)&&e.select.toggle||delete t.toggle}function uyt(t){const e=[];return"Identifier"===t.type?[t.name]:"Literal"===t.type?[t.value]:("MemberExpression"===t.type&&(e.push(...uyt(t.object)),e.push(...uyt(t.property))),e)}function cyt(t){return"MemberExpression"===t.object.type?cyt(t.object):"datum"===t.object.name}function hyt(t){const e=S8(t),n=new Set;return e.visit((t=>{"MemberExpression"===t.type&&cyt(t)&&n.add(uyt(t).slice(1).join("."))})),n}class fyt extends Fmt{clone(){return new fyt(null,this.model,Tot(this.filter))}constructor(t,e,n){super(t),this.model=e,this.filter=n,this.expr=myt(this.model,this.filter,this),this._dependentFields=hyt(this.expr)}dependentFields(){return this._dependentFields}producedFields(){return new Set}assemble(){return{type:"filter",expr:this.expr}}hash(){return`Filter ${this.expr}`}}function dyt(t,e,n,r="datum"){const i=XF(e)?e:e.param,o=Zot(i),s=iL(o+eyt);let a;try{a=t.getSelectionComponent(o,i)}catch(t){return`!!${o}`}if(a.project.timeUnit){const e=n??t.component.data.raw,r=a.project.timeUnit.clone();e.parent?r.insertAsParentOf(e):e.parent=r}const l=`${a.project.hasSelectionId?"vlSelectionIdTest(":"vlSelectionTest("}${s}, ${r}${"global"===a.resolve?")":`, ${iL(a.resolve)})`}`,u=`length(data(${s}))`;return!1===e.empty?`${u} && ${l}`:`!${u} || ${l}`}function pyt(t,e,n){const r=Zot(e),i=n.encoding;let o,s=n.field;try{o=t.getSelectionComponent(r,e)}catch(t){return r}if(i||s){if(i&&!s){const t=o.project.items.filter((t=>t.channel===i));!t.length||t.length>1?(s=o.project.items[0].field,zut((t.length?"Multiple ":"No ")+`matching ${iL(i)} encoding found for selection ${iL(n.param)}. `+`Using "field": ${iL(s)}.`)):s=t[0].field}}else s=o.project.items[0].field,o.project.items.length>1&&zut(`A "field" or "encoding" must be specified when using a selection as a scale domain. Using "field": ${iL(s)}.`);return`${o.name}[${iL(sst(s))}]`}function myt(t,e,n){return tst(e,(e=>XF(e)?e:function(t){return t?.param}(e)?dyt(t,e,n):yct(e)))}function gyt(t,e,n,r){var i,o;t.encode??(t.encode={}),(i=t.encode)[e]??(i[e]={}),(o=t.encode[e]).update??(o.update={}),t.encode[e].update[n]=r}function yyt(t,e,n,r={header:!1}){const{disable:i,orient:o,scale:s,labelExpr:a,title:l,zindex:u,...c}=t.combine();if(!i){for(const t in c){const n=Wft[t],r=c[t];if(n&&n!==e&&"both"!==n)delete c[t];else if(Vft(r)){const{condition:e,...n}=r,i=kF(e),o=Uft[t];if(o){const{vgProp:e,part:r}=o,s=[...i.map((t=>{const{test:e,...n}=t;return{test:myt(null,e),...n}})),n];gyt(c,r,e,s),delete c[t]}else if(null===o){const e={signal:i.map((t=>{const{test:e,...n}=t;return`${myt(null,e)} ? ${Klt(n)} : `})).join("")+Klt(n)};c[t]=e}}else if(zlt(r)){const e=Uft[t];if(e){const{vgProp:n,part:i}=e;gyt(c,i,n,r),delete c[t]}}Bot(["labelAlign","labelBaseline"],t)&&null===c[t]&&delete c[t]}if("grid"===e){if(!c.grid)return;if(c.encode){const{grid:t}=c.encode;c.encode={...t?{grid:t}:{}},Yot(c.encode)&&delete c.encode}return{scale:s,orient:o,...c,domain:!1,labels:!1,aria:!1,maxExtent:0,minExtent:0,ticks:!1,zindex:cst(u,0)}}{if(!r.header&&t.mainExtracted)return;if(void 0!==a){let t=a;c.encode?.labels?.update&&zlt(c.encode.labels.update.text)&&(t=ast(a,"datum.label",c.encode.labels.update.text.signal)),gyt(c,"labels","text",{signal:t})}if(null===c.labelAlign&&delete c.labelAlign,c.encode){for(const e of qft)t.hasAxisPart(e)||delete c.encode[e];Yot(c.encode)&&delete c.encode}const e=function(t,e){if(t)return Q$(t)&&!Plt(t)?t.map((t=>Mft(t,e))).join(", "):t}(l,n);return{scale:s,orient:o,grid:!1,...e?{title:e}:{},...c,...!1===n.aria?{aria:!1}:{},zindex:cst(u,0)}}}}function byt(t){const{axes:e}=t.component,n=[];for(const r of Kat)if(e[r])for(const i of e[r])if(!i.get("disable")&&!i.get("gridScale")){const e="x"===r?"height":"width",i=t.getSizeSignalRef(e).signal;e!==i&&n.push({name:e,update:i})}return n}function vyt(t,e,n,r){return Object.assign.apply(null,[{},...t.map((t=>{if("axisOrient"===t){const t="x"===n?"bottom":"left",i=e["x"===n?"axisBottom":"axisLeft"]||{},o=e["x"===n?"axisTop":"axisRight"]||{},s=new Set([...Xot(i),...Xot(o)]),a={};for(const e of s.values())a[e]={signal:`${r.signal} === "${t}" ? ${Qlt(i[e])} : ${Qlt(o[e])}`};return a}return e[t]}))])}function wyt(t,e){const n=[{}];for(const r of t){let t=e[r]?.style;if(t){t=kF(t);for(const r of t)n.push(e.style[r])}}return Object.assign.apply(null,n)}function xyt(t,e,n,r={}){const i=iut(t,n,e);if(void 0!==i)return{configFrom:"style",configValue:i};for(const e of["vlOnlyAxisConfig","vgAxisConfig","axisConfigStyle"])if(void 0!==r[e]?.[t])return{configFrom:e,configValue:r[e][t]};return{}}const _yt={scale:({model:t,channel:e})=>t.scaleName(e),format:({format:t})=>t,formatType:({formatType:t})=>t,grid:({fieldOrDatumDef:t,axis:e,scaleType:n})=>e.grid??function(t,e){return!Pct(t)&&lft(e)&&!Tlt(e?.bin)&&!Ilt(e?.bin)}(n,t),gridScale:({model:t,channel:e})=>function(t,e){const n="x"===e?"y":"x";if(t.getScaleComponent(n))return t.scaleName(n)}(t,e),labelAlign:({axis:t,labelAngle:e,orient:n,channel:r})=>t.labelAlign||Eyt(e,n,r),labelAngle:({labelAngle:t})=>t,labelBaseline:({axis:t,labelAngle:e,orient:n,channel:r})=>t.labelBaseline||Syt(e,n,r),labelFlush:({axis:t,fieldOrDatumDef:e,channel:n})=>t.labelFlush??function(t,e){if("x"===e&&Bot(["quantitative","temporal"],t))return!0}(e.type,n),labelOverlap:({axis:t,fieldOrDatumDef:e,scaleType:n})=>t.labelOverlap??function(t,e,n,r){if(n&&!Z$(r)||"nominal"!==t&&"ordinal"!==t)return"log"!==e&&"symlog"!==e||"greedy"}(e.type,n,lft(e)&&!!e.timeUnit,lft(e)?e.sort:void 0),orient:({orient:t})=>t,tickCount:({channel:t,model:e,axis:n,fieldOrDatumDef:r,scaleType:i})=>{const o="x"===t?"width":"y"===t?"height":void 0,s=o?e.getSizeSignalRef(o):void 0;return n.tickCount??function({fieldOrDatumDef:t,scaleType:e,size:n,values:r}){if(!r&&!Pct(e)&&"log"!==e){if(lft(t)){if(Tlt(t.bin))return{signal:`ceil(${n.signal}/10)`};if(t.timeUnit&&Bot(["month","hours","day","quarter"],ict(t.timeUnit)?.unit))return}return{signal:`ceil(${n.signal}/40)`}}}({fieldOrDatumDef:r,scaleType:i,size:s,values:n.values})},tickMinStep:function({format:t,fieldOrDatumDef:e}){if("d"===t)return 1;if(lft(e)){const{timeUnit:t}=e;if(t){const e=oct(t);if(e)return{signal:e}}}},title:({axis:t,model:e,channel:n})=>{if(void 0!==t.title)return t.title;const r=Ayt(e,n);if(void 0!==r)return r;const i=e.typedFieldDef(n),o="x"===n?"x2":"y2",s=e.fieldDef(o);return sut(i?[Zht(i)]:[],lft(s)?[Zht(s)]:[])},values:({axis:t,fieldOrDatumDef:e})=>function(t,e){const n=t.values;return Q$(n)?zft(e,n):zlt(n)?n:void 0}(t,e),zindex:({axis:t,fieldOrDatumDef:e,mark:n})=>t.zindex??function(t,e){return"rect"===t&&kft(e)?1:0}(n,e)};function kyt(t){return`(((${t.signal} % 360) + 360) % 360)`}function Syt(t,e,n,r){if(void 0!==t){if("x"===n){if(zlt(t)){const n=kyt(t);return{signal:`(45 < ${n} && ${n} < 135) || (225 < ${n} && ${n} < 315) ? "middle" :(${n} <= 45 || 315 <= ${n}) === ${zlt(e)?`(${e.signal} === "top")`:"top"===e} ? "bottom" : "top"`}}if(45<t&&t<135||225<t&&t<315)return"middle";if(zlt(e)){const n=t<=45||315<=t?"===":"!==";return{signal:`${e.signal} ${n} "top" ? "bottom" : "top"`}}return(t<=45||315<=t)==("top"===e)?"bottom":"top"}if(zlt(t)){const n=kyt(t);return{signal:`${n} <= 45 || 315 <= ${n} || (135 <= ${n} && ${n} <= 225) ? ${r?'"middle"':"null"} : (45 <= ${n} && ${n} <= 135) === ${zlt(e)?`(${e.signal} === "left")`:"left"===e} ? "top" : "bottom"`}}if(t<=45||315<=t||135<=t&&t<=225)return r?"middle":null;if(zlt(e)){const n=45<=t&&t<=135?"===":"!==";return{signal:`${e.signal} ${n} "left" ? "top" : "bottom"`}}return(45<=t&&t<=135)==("left"===e)?"top":"bottom"}}function Eyt(t,e,n){if(void 0===t)return;const r="x"===n,i=r?0:90,o=r?"bottom":"left";if(zlt(t)){const n=kyt(t);return{signal:`(${i?`(${n} + 90)`:n} % 180 === 0) ? ${r?null:'"center"'} :(${i} < ${n} && ${n} < ${180+i}) === ${zlt(e)?`(${e.signal} === "${o}")`:e===o} ? "left" : "right"`}}if((t+i)%180==0)return r?null:"center";if(zlt(e)){const n=i<t&&t<180+i?"===":"!==";return{signal:`${e.signal} ${n} "${o}" ? "left" : "right"`}}return(i<t&&t<180+i)==(e===o)?"left":"right"}function Ayt(t,e){const n="x"===e?"x2":"y2",r=t.fieldDef(e),i=t.fieldDef(n),o=r?r.title:void 0,s=i?i.title:void 0;return o&&s?aut(o,s):o||s||(void 0!==o?o:void 0!==s?s:void 0)}class Cyt extends Fmt{clone(){return new Cyt(null,Tot(this.transform))}constructor(t,e){super(t),this.transform=e,this._dependentFields=hyt(this.transform.calculate)}static parseAllForSortIndex(t,e){return e.forEachFieldDef(((e,n)=>{if(yft(e)&&Xht(e.sort)){const{field:r,timeUnit:i}=e,o=e.sort,s=o.map(((t,e)=>`${yct({field:r,timeUnit:i,equal:t})} ? ${e} : `)).join("")+o.length;t=new Cyt(t,{calculate:s,as:Dyt(e,n,{forAs:!0})})}})),t}producedFields(){return new Set([this.transform.as])}dependentFields(){return this._dependentFields}assemble(){return{type:"formula",expr:this.transform.calculate,as:this.transform.as}}hash(){return`Calculate ${Fot(this.transform)}`}}function Dyt(t,e,n){return _ft(t,{prefix:e,suffix:"sort_index",...n})}function Myt(t,e){return Bot(["top","bottom"],e)?"column":Bot(["left","right"],e)||"row"===t?"row":"column"}function Oyt(t,e,n,r){const i="row"===r?n.headerRow:"column"===r?n.headerColumn:n.headerFacet;return cst((e||{})[t],i[t],n.header[t])}function Tyt(t,e,n,r){const i={};for(const o of t){const t=Oyt(o,e||{},n,r);void 0!==t&&(i[o]=t)}return i}const Iyt=["row","column"],Nyt=["header","footer"];function $yt(t,e){const n=t.component.layoutHeaders[e].title,r=t.config?t.config:void 0,i=t.component.layoutHeaders[e].facetFieldDef?t.component.layoutHeaders[e].facetFieldDef:void 0,{titleAnchor:o,titleAngle:s,titleOrient:a}=Tyt(["titleAnchor","titleAngle","titleOrient"],i.header,r,e),l=Myt(e,a),u=gst(s);return{name:`${e}-title`,type:"group",role:`${l}-title`,title:{text:n,..."row"===e?{orient:"left"}:{},style:"guide-title",...Lyt(u,l),...Fyt(l,u,o),...Vyt(r,i,e,Idt,Odt)}}}function Fyt(t,e,n="middle"){switch(n){case"start":return{align:"left"};case"end":return{align:"right"}}const r=Eyt(e,"row"===t?"left":"top","row"===t?"y":"x");return r?{align:r}:{}}function Lyt(t,e){const n=Syt(t,"row"===e?"left":"top","row"===e?"y":"x",!0);return n?{baseline:n}:{}}function Byt(t,e){const n=t.component.layoutHeaders[e],r=[];for(const i of Nyt)if(n[i])for(const o of n[i]){const s=zyt(t,e,i,n,o);null!=s&&r.push(s)}return r}function Ryt(t,e){const{sort:n}=t;return Yht(n)?{field:_ft(n,{expr:"datum"}),order:n.order??"ascending"}:Q$(n)?{field:Dyt(t,e,{expr:"datum"}),order:"ascending"}:{field:_ft(t,{expr:"datum"}),order:n??"ascending"}}function Pyt(t,e,n){const{format:r,formatType:i,labelAngle:o,labelAnchor:s,labelOrient:a,labelExpr:l}=Tyt(["format","formatType","labelAngle","labelAnchor","labelOrient","labelExpr"],t.header,n,e),u=hht({fieldOrDatumDef:t,format:r,formatType:i,expr:"parent",config:n}).signal,c=Myt(e,a);return{text:{signal:l?ast(ast(l,"datum.label",u),"datum.value",_ft(t,{expr:"parent"})):u},..."row"===e?{orient:"left"}:{},style:"guide-label",frame:"group",...Lyt(o,c),...Fyt(c,o,s),...Vyt(n,t,e,Ndt,Tdt)}}function zyt(t,e,n,r,i){if(i){let o=null;const{facetFieldDef:s}=r,a=t.config?t.config:void 0;if(s&&i.labels){const{labelOrient:t}=Tyt(["labelOrient"],s.header,a,e);("row"===e&&!Bot(["top","bottom"],t)||"column"===e&&!Bot(["left","right"],t))&&(o=Pyt(s,e,a))}const l=Pvt(t)&&!Jht(t.facet),u=i.axes,c=u?.length>0;if(o||c){const a="row"===e?"height":"width";return{name:t.getName(`${e}_${n}`),type:"group",role:`${e}-${n}`,...r.facetFieldDef?{from:{data:t.getName(`${e}_domain`)},sort:Ryt(s,e)}:{},...c&&l?{from:{data:t.getName(`facet_domain_${e}`)}}:{},...o?{title:o}:{},...i.sizeSignal?{encode:{update:{[a]:i.sizeSignal}}}:{},...c?{axes:u}:{}}}}return null}const jyt={column:{start:0,end:1},row:{start:1,end:0}};function Uyt(t,e){return jyt[e][t]}function Vyt(t,e,n,r,i){const o={};for(const s of r){if(!i[s])continue;const r=Oyt(s,e?.header,t,n);void 0!==r&&(o[i[s]]=r)}return o}function qyt(t){return[...Wyt(t,"width"),...Wyt(t,"height"),...Wyt(t,"childWidth"),...Wyt(t,"childHeight")]}function Wyt(t,e){const n="width"===e?"x":"y",r=t.component.layoutSize.get(e);if(!r||"merged"===r)return[];const i=t.getSizeSignalRef(e).signal;if("step"===r){const e=t.getScaleComponent(n);if(e){const r=e.get("type"),o=e.get("range");if(Pct(r)&&jlt(o)){const r=t.scaleName(n);return Pvt(t.parent)&&"independent"===t.parent.component.resolve.scale[n]?[Hyt(r,o)]:[Hyt(r,o),{name:i,update:Gyt(r,e,`domain('${r}').length`)}]}}throw new Error("layout size is step although width/height is not step.")}if("container"==r){const e=i.endsWith("width"),n=e?"containerSize()[0]":"containerSize()[1]",r=`isFinite(${n}) ? ${n} : ${Jdt(t.config.view,e?"width":"height")}`;return[{name:i,init:r,on:[{update:r,events:"window:resize"}]}]}return[{name:i,value:r}]}function Hyt(t,e){const n=`${t}_step`;return zlt(e.step)?{name:n,update:e.step.signal}:{name:n,value:e.step}}function Gyt(t,e,n){const r=e.get("type"),i=e.get("padding"),o=cst(e.get("paddingOuter"),i);let s=e.get("paddingInner");return s="band"===r?void 0!==s?s:i:1,`bandspace(${n}, ${Qlt(s)}, ${Qlt(o)}) * ${t}_step`}function Yyt(t){return"childWidth"===t?"width":"childHeight"===t?"height":t}function Xyt(t,e){return Xot(t).reduce(((n,r)=>{const i=t[r];return{...n,...agt(e,i,r,(t=>Xlt(t.value)))}}),{})}function Jyt(t,e){if(Pvt(e))return"theta"===t?"independent":"shared";if(jvt(e))return"shared";if(zvt(e))return Qat(t)||"theta"===t||"radius"===t?"independent":"shared";throw new Error("invalid model type for resolve")}function Kyt(t,e){const n=t.scale[e],r=Qat(e)?"axis":"legend";return"independent"===n?("shared"===t[r][e]&&zut(function(t){return`Setting the scale to be independent for "${t}" means we also have to set the guide (axis or legend) to be independent.`}(e)),"independent"):t[r][e]||"shared"}const Qyt={...Ldt,disable:1,labelExpr:1,selections:1,opacity:1,shape:1,stroke:1,fill:1,size:1,strokeWidth:1,strokeDash:1,encode:1},Zyt=Xot(Qyt);class tbt extends pmt{}const ebt={symbols:function(t,{fieldOrDatumDef:e,model:n,channel:r,legendCmpt:i,legendType:o}){if("symbol"!==o)return;const{markDef:s,encoding:a,config:l,mark:u}=n,c=s.filled&&"trail"!==u;let h={...Zlt({},n,Pht),...ygt(n,{filled:c})};const f=i.get("symbolOpacity")??l.legend.symbolOpacity,d=i.get("symbolFillColor")??l.legend.symbolFillColor,p=i.get("symbolStrokeColor")??l.legend.symbolStrokeColor,m=void 0===f?nbt(a.opacity)??s.opacity:void 0;if(h.fill)if("fill"===r||c&&r===Rst)delete h.fill;else if(h.fill.field)d?delete h.fill:(h.fill=Xlt(l.legend.symbolBaseFillColor??"black"),h.fillOpacity=Xlt(m??1));else if(Q$(h.fill)){const t=rbt(a.fill??a.color)??s.fill??(c&&s.color);t&&(h.fill=Xlt(t))}if(h.stroke)if("stroke"===r||!c&&r===Rst)delete h.stroke;else if(h.stroke.field||p)delete h.stroke;else if(Q$(h.stroke)){const t=cst(rbt(a.stroke||a.color),s.stroke,c?s.color:void 0);t&&(h.stroke={value:t})}if(r!==qst){const t=lft(e)&&obt(0,i,e);t?h.opacity=[{test:t,...Xlt(m??1)},Xlt(l.legend.unselectedOpacity)]:m&&(h.opacity=Xlt(m))}return h={...h,...t},Yot(h)?void 0:h},gradient:function(t,{model:e,legendType:n,legendCmpt:r}){if("gradient"!==n)return;const{config:i,markDef:o,encoding:s}=e;let a={};const l=void 0===(r.get("gradientOpacity")??i.legend.gradientOpacity)?nbt(s.opacity)||o.opacity:void 0;return l&&(a.opacity=Xlt(l)),a={...a,...t},Yot(a)?void 0:a},labels:function(t,{fieldOrDatumDef:e,model:n,channel:r,legendCmpt:i}){const o=n.legend(r)||{},s=n.config,a=lft(e)?obt(0,i,e):void 0,l=a?[{test:a,value:1},{value:s.legend.unselectedOpacity}]:void 0,{format:u,formatType:c}=o;let h;lht(c)?h=dht({fieldOrDatumDef:e,field:"datum.value",format:u,formatType:c,config:s}):void 0===u&&void 0===c&&s.customFormatTypes&&("quantitative"===e.type&&s.numberFormatType?h=dht({fieldOrDatumDef:e,field:"datum.value",format:s.numberFormat,formatType:s.numberFormatType,config:s}):"temporal"===e.type&&s.timeFormatType&&lft(e)&&void 0===e.timeUnit&&(h=dht({fieldOrDatumDef:e,field:"datum.value",format:s.timeFormat,formatType:s.timeFormatType,config:s})));const f={...l?{opacity:l}:{},...h?{text:h}:{},...t};return Yot(f)?void 0:f},entries:function(t,{legendCmpt:e}){const n=e.get("selections");return n?.length?{...t,fill:{value:"transparent"}}:t}};function nbt(t){return ibt(t,((t,e)=>Math.max(t,e.value)))}function rbt(t){return ibt(t,((t,e)=>cst(t,e.value)))}function ibt(t,e){return function(t){const e=t?.condition;return!!e&&(Q$(e)||gft(e))}(t)?kF(t.condition).reduce(e,t.value):gft(t)?t.value:void 0}function obt(t,e,n){const r=e.get("selections");if(!r?.length)return;const i=iL(n.field);return r.map((t=>`(!length(data(${iL(Zot(t)+eyt)})) || (${t}[${i}] && indexof(${t}[${i}], datum.value) >= 0))`)).join(" || ")}const sbt={direction:({direction:t})=>t,format:({fieldOrDatumDef:t,legend:e,config:n})=>{const{format:r,formatType:i}=e;return pht(t,t.type,r,i,n,!1)},formatType:({legend:t,fieldOrDatumDef:e,scaleType:n})=>{const{formatType:r}=t;return mht(r,e,n)},gradientLength:t=>{const{legend:e,legendConfig:n}=t;return e.gradientLength??n.gradientLength??function({legendConfig:t,model:e,direction:n,orient:r,scaleType:i}){const{gradientHorizontalMaxLength:o,gradientHorizontalMinLength:s,gradientVerticalMaxLength:a,gradientVerticalMinLength:l}=t;if(jct(i))return"horizontal"===n?"top"===r||"bottom"===r?lbt(e,"width",s,o):s:lbt(e,"height",l,a)}(t)},labelOverlap:({legend:t,legendConfig:e,scaleType:n})=>t.labelOverlap??e.labelOverlap??function(t){if(Bot(["quantile","threshold","log","symlog"],t))return"greedy"}(n),symbolType:({legend:t,markDef:e,channel:n,encoding:r})=>t.symbolType??function(t,e,n,r){if("shape"!==e){const t=rbt(n)??r;if(t)return t}switch(t){case"bar":case"rect":case"image":case"square":return"square";case"line":case"trail":case"rule":return"stroke";case"arc":case"point":case"circle":case"tick":case"geoshape":case"area":case"text":return"circle"}}(e.type,n,r.shape,e.shape),title:({fieldOrDatumDef:t,config:e})=>Cft(t,e,{allowDisabling:!0}),type:({legendType:t,scaleType:e,channel:n})=>{if(cat(n)&&jct(e)){if("gradient"===t)return}else if("symbol"===t)return;return t},values:({fieldOrDatumDef:t,legend:e})=>function(t,e){const n=t.values;return Q$(n)?zft(e,n):zlt(n)?n:void 0}(e,t)};function abt({legendConfig:t,legendType:e,orient:n,legend:r}){return r.direction??t[e?"gradientDirection":"symbolDirection"]??function(t,e){switch(t){case"top":case"bottom":return"horizontal";case"left":case"right":case"none":case void 0:return;default:return"gradient"===e?"horizontal":void 0}}(n,e)}function lbt(t,e,n,r){return{signal:`clamp(${t.getSizeSignalRef(e).signal}, ${n}, ${r})`}}function ubt(t){const e=Rvt(t)?function(t){const{encoding:e}=t,n={};for(const r of[Rst,...Fdt]){const i=Ift(e[r]);i&&t.getScaleComponent(r)&&(r===jst&&lft(i)&&i.type===Cct||(n[r]=hbt(t,r)))}return n}(t):function(t){const{legends:e,resolve:n}=t.component;for(const r of t.children){ubt(r);for(const i of Xot(r.component.legends))n.legend[i]=Kyt(t.component.resolve,i),"shared"===n.legend[i]&&(e[i]=fbt(e[i],r.component.legends[i]),e[i]||(n.legend[i]="independent",delete e[i]))}for(const r of Xot(e))for(const e of t.children)e.component.legends[r]&&"shared"===n.legend[r]&&delete e.component.legends[r];return e}(t);return t.component.legends=e,e}function cbt(t,e,n,r){switch(e){case"disable":return void 0!==n;case"values":return!!n?.values;case"title":if("title"===e&&t===r?.title)return!0}return t===(n||{})[e]}function hbt(t,e){let n=t.legend(e);const{markDef:r,encoding:i,config:o}=t,s=o.legend,a=new tbt({},function(t,e){const n=t.scaleName(e);if("trail"===t.mark){if("color"===e)return{stroke:n};if("size"===e)return{strokeWidth:n}}return"color"===e?t.markDef.filled?{fill:n}:{stroke:n}:{[e]:n}}(t,e));!function(t,e,n){const r=t.fieldDef(e)?.field;for(const i of Jot(t.component.selection??{})){const t=i.project.hasField[r]??i.project.hasChannel[e];if(t&&Hgt.defined(i)){const e=n.get("selections")??[];e.push(i.name),n.set("selections",e,!1),t.hasLegend=!0}}}(t,e,a);const l=void 0!==n?!n:s.disable;if(a.set("disable",l,void 0!==n),l)return a;n=n||{};const u=t.getScaleComponent(e).get("type"),c=Ift(i[e]),h=lft(c)?ict(c.timeUnit)?.unit:void 0,f=n.orient||o.legend.orient||"right",d=function(t){const{legend:e}=t;return cst(e.type,function({channel:t,timeUnit:e,scaleType:n}){if(cat(t)){if(Bot(["quarter","month","day"],e))return"symbol";if(jct(n))return"gradient"}return"symbol"}(t))}({legend:n,channel:e,timeUnit:h,scaleType:u}),p={legend:n,channel:e,model:t,markDef:r,encoding:i,fieldOrDatumDef:c,legendConfig:s,config:o,scaleType:u,orient:f,legendType:d,direction:abt({legend:n,legendType:d,orient:f,legendConfig:s})};for(const r of Zyt){if("gradient"===d&&r.startsWith("symbol")||"symbol"===d&&r.startsWith("gradient"))continue;const i=r in sbt?sbt[r](p):n[r];if(void 0!==i){const s=cbt(i,r,n,t.fieldDef(e));(s||void 0===o.legend[r])&&a.set(r,i,s)}}const m=n?.encoding??{},g=a.get("selections"),y={},b={fieldOrDatumDef:c,model:t,channel:e,legendCmpt:a,legendType:d};for(const e of["labels","legend","title","symbols","gradient","entries"]){const n=Xyt(m[e]??{},t),r=e in ebt?ebt[e](n,b):n;void 0===r||Yot(r)||(y[e]={...g?.length&&lft(c)?{name:`${Zot(c.field)}_legend_${e}`}:{},...g?.length?{interactive:!!g}:{},update:r})}return Yot(y)||a.set("encode",y,!!n?.encoding),a}function fbt(t,e){if(!t)return e.clone();const n=t.getWithExplicit("orient"),r=e.getWithExplicit("orient");if(n.explicit&&r.explicit&&n.value!==r.value)return;let i=!1;for(const n of Zyt){const r=vmt(t.getWithExplicit(n),e.getWithExplicit(n),n,"legend",((t,e)=>{switch(n){case"symbolType":return r=t,"circle"===(o=e).value?o:r;case"title":return lut(t,e);case"type":return i=!0,gmt("symbol")}var r,o;return bmt(t,e,n,"legend")}));t.setWithExplicit(n,r)}return i&&(t.implicit?.encode?.gradient&&est(t.implicit,["encode","gradient"]),t.explicit?.encode?.gradient&&est(t.explicit,["encode","gradient"])),t}function dbt(t){const e=t.component.legends,n={};for(const r of Xot(e)){const i=wst(t.getScaleComponent(r).get("domains"));if(n[i])for(const t of n[i])fbt(t,e[r])||n[i].push(e[r]);else n[i]=[e[r].clone()]}const r=Jot(n).flat().map((e=>function(t,e){const{disable:n,labelExpr:r,selections:i,...o}=t.combine();if(!n){if(!1===e.aria&&null==o.aria&&(o.aria=!1),o.encode?.symbols){const t=o.encode.symbols.update;!t.fill||"transparent"===t.fill.value||t.stroke||o.stroke||(t.stroke={value:"transparent"});for(const e of Fdt)o[e]&&delete t[e]}if(o.title||delete o.title,void 0!==r){let t=r;o.encode?.labels?.update&&zlt(o.encode.labels.update.text)&&(t=ast(r,"datum.label",o.encode.labels.update.text.signal)),function(t,e,n,r){var i,o;t.encode??(t.encode={}),(i=t.encode)[e]??(i[e]={}),(o=t.encode[e]).update??(o.update={}),t.encode[e].update.text=r}(o,"labels",0,{signal:t})}return o}}(e,t.config))).filter((t=>void 0!==t));return r}function pbt(t){const e=t.component.projection;if(!e||e.merged)return[];const n=e.combine(),{name:r}=n;if(e.data){const i={signal:`[${e.size.map((t=>t.signal)).join(", ")}]`},o=e.data.reduce(((e,n)=>{const r=zlt(n)?n.signal:`data('${t.lookupDataSource(n)}')`;return Bot(e,r)||e.push(r),e}),[]);if(o.length<=0)throw new Error("Projection's fit didn't find any data sources");return[{name:r,size:i,fit:{signal:o.length>1?`[${o.join(", ")}]`:o[0]},...n}]}return[{name:r,translate:{signal:"[width / 2, height / 2]"},...n}]}const mbt=["type","clipAngle","clipExtent","center","rotate","precision","reflectX","reflectY","coefficient","distance","fraction","lobes","parallel","radius","ratio","spacing","tilt"];class gbt extends pmt{constructor(t,e,n,r){super({...e},{name:t}),this.specifiedProjection=e,this.size=n,this.data=r,this.merged=!1}get isFit(){return!!this.data}}function ybt(t){t.component.projection=Rvt(t)?function(t){if(t.hasProjection){const e=Blt(t.specifiedProjection),n=!(e&&(null!=e.scale||null!=e.translate)),r=n?[t.getSizeSignalRef("width"),t.getSizeSignalRef("height")]:void 0,i=n?function(t){const e=[],{encoding:n}=t;for(const r of[[Fst,$st],[Bst,Lst]])(Ift(n[r[0]])||Ift(n[r[1]]))&&e.push({signal:t.getName(`geojson_${e.length}`)});return t.channelHasField(jst)&&t.typedFieldDef(jst).type===Cct&&e.push({signal:t.getName(`geojson_${e.length}`)}),0===e.length&&e.push(t.requestDataName(Dmt.Main)),e}(t):void 0,o=new gbt(t.projectionName(!0),{...Blt(t.config.projection),...e},r,i);return o.get("type")||o.set("type","equalEarth",!1),o}}(t):function(t){if(0===t.children.length)return;let e;for(const e of t.children)ybt(e);const n=Pot(t.children,(t=>{const n=t.component.projection;if(n){if(e){const t=function(t,e){const n=Pot(mbt,(n=>!RF(t.explicit,n)&&!RF(e.explicit,n)||!!(RF(t.explicit,n)&&RF(e.explicit,n)&&vst(t.get(n),e.get(n)))));if(vst(t.size,e.size)){if(n)return t;if(vst(t.explicit,{}))return e;if(vst(e.explicit,{}))return t}return null}(e,n);return t&&(e=t),!!t}return e=n,!0}return!0}));if(e&&n){const n=t.projectionName(!0),r=new gbt(n,e.specifiedProjection,e.size,Tot(e.data));for(const e of t.children){const t=e.component.projection;t&&(t.isFit&&r.data.push(...e.component.projection.data),e.renameProjection(t.get("name"),n),t.merged=!0)}return r}}(t)}function bbt(t,e,n,r){if(jft(e,n)){const i=Rvt(t)?t.axis(n)??t.legend(n)??{}:{},o=_ft(e,{expr:"datum"}),s=_ft(e,{expr:"datum",binSuffix:"end"});return{formulaAs:_ft(e,{binSuffix:"range",forAs:!0}),formula:vht(o,s,i.format,i.formatType,r)}}return{}}function vbt(t,e){return`${Olt(t)}_${e}`}function wbt(t,e,n){const r=vbt(Lft(n,void 0)??{},e);return t.getName(`${r}_bins`)}function xbt(t,e,n){let r,i;r=function(t){return"as"in t}(t)?XF(t.as)?[t.as,`${t.as}_end`]:[t.as[0],t.as[1]]:[_ft(t,{forAs:!0}),_ft(t,{binSuffix:"end",forAs:!0})];const o={...Lft(e,void 0)},s=vbt(o,t.field),{signal:a,extentSignal:l}=function(t,e){return{signal:t.getName(`${e}_bins`),extentSignal:t.getName(`${e}_extent`)}}(n,s);if($lt(o.extent)){const t=o.extent;i=pyt(n,t.param,t),delete o.extent}return{key:s,binComponent:{bin:o,field:t.field,as:[r],...a?{signal:a}:{},...l?{extentSignal:l}:{},...i?{span:i}:{}}}}class _bt extends Fmt{clone(){return new _bt(null,Tot(this.bins))}constructor(t,e){super(t),this.bins=e}static makeFromEncoding(t,e){const n=e.reduceFieldDef(((t,n,r)=>{if(mft(n)&&Tlt(n.bin)){const{key:i,binComponent:o}=xbt(n,n.bin,e);t[i]={...o,...t[i],...bbt(e,n,r,e.config)}}return t}),{});return Yot(n)?null:new _bt(t,n)}static makeFromTransform(t,e,n){const{key:r,binComponent:i}=xbt(e,e.bin,n);return new _bt(t,{[r]:i})}merge(t,e){for(const n of Xot(t.bins))n in this.bins?(e(t.bins[n].signal,this.bins[n].signal),this.bins[n].as=Uot([...this.bins[n].as,...t.bins[n].as],Fot)):this.bins[n]=t.bins[n];for(const e of t.children)t.removeChild(e),e.parent=this;t.remove()}producedFields(){return new Set(Jot(this.bins).map((t=>t.as)).flat(2))}dependentFields(){return new Set(Jot(this.bins).map((t=>t.field)))}hash(){return`Bin ${Fot(this.bins)}`}assemble(){return Jot(this.bins).flatMap((t=>{const e=[],[n,...r]=t.as,{extent:i,...o}=t.bin,s={type:"bin",field:sst(t.field),as:n,signal:t.signal,...$lt(i)?{extent:null}:{extent:i},...t.span?{span:{signal:`span(${t.span})`}}:{},...o};!i&&t.extentSignal&&(e.push({type:"extent",field:sst(t.field),signal:t.extentSignal}),s.extent={signal:t.extentSignal}),e.push(s);for(const t of r)for(let r=0;r<2;r++)e.push({type:"formula",expr:_ft({field:n[r]},{expr:"datum"}),as:t[r]});return t.formula&&e.push({type:"formula",expr:t.formula,as:t.formulaAs}),e}))}}class kbt extends Fmt{clone(){return new kbt(null,new Set(this.dimensions),Tot(this.measures))}constructor(t,e,n){super(t),this.dimensions=e,this.measures=n}get groupBy(){return this.dimensions}static makeFromEncoding(t,e){let n=!1;e.forEachFieldDef((t=>{t.aggregate&&(n=!0)}));const r={},i=new Set;return n?(e.forEachFieldDef(((t,n)=>{const{aggregate:o,field:s}=t;if(o)if("count"===o)r["*"]??(r["*"]={}),r["*"].count=new Set([_ft(t,{forAs:!0})]);else{if(klt(o)||Slt(o)){const t=klt(o)?"argmin":"argmax",e=o[t];r[e]??(r[e]={}),r[e][t]=new Set([_ft({op:t,field:e},{forAs:!0})])}else r[s]??(r[s]={}),r[s][o]=new Set([_ft(t,{forAs:!0})]);glt(n)&&"unaggregated"===e.scaleDomain(n)&&(r[s]??(r[s]={}),r[s].min=new Set([_ft({field:s,aggregate:"min"},{forAs:!0})]),r[s].max=new Set([_ft({field:s,aggregate:"max"},{forAs:!0})]))}else!function(t,e,n,r){const i=Rvt(r)?r.encoding[Dat(e)]:void 0;if(mft(n)&&Rvt(r)&&rft(n,i,r.markDef,r.config)){t.add(_ft(n,{})),t.add(_ft(n,{suffix:"end"}));const{mark:i,markDef:o,config:s}=r,a=eft({fieldDef:n,markDef:o,config:s});Lht(i)&&.5!==a&&Qat(e)&&(t.add(_ft(n,{suffix:zmt})),t.add(_ft(n,{suffix:jmt}))),n.bin&&jft(n,e)&&t.add(_ft(n,{binSuffix:"range"}))}else if(aat(e)){const n=sat(e);t.add(r.getName(n))}else t.add(_ft(n));return yft(n)&&(o=n.scale?.range,Z$(o)&&"field"in o)&&t.add(n.scale.range.field),t;var o}(i,n,t,e)})),i.size+Xot(r).length===0?null:new kbt(t,i,r)):null}static makeFromTransform(t,e){const n=new Set,r={};for(const t of e.aggregate){const{op:e,field:n,as:i}=t;e&&("count"===e?(r["*"]??(r["*"]={}),r["*"].count=new Set([i||_ft(t,{forAs:!0})])):(r[n]??(r[n]={}),r[n][e]=new Set([i||_ft(t,{forAs:!0})])))}for(const t of e.groupby??[])n.add(t);return n.size+Xot(r).length===0?null:new kbt(t,n,r)}merge(t){return qot(this.dimensions,t.dimensions)?(function(t,e){for(const n of Xot(e)){const r=e[n];for(const e of Xot(r))n in t?t[n][e]=new Set([...t[n][e]??[],...r[e]]):t[n]={[e]:r[e]}}}(this.measures,t.measures),!0):(function(...t){Put.debug(...t)}("different dimensions, cannot merge"),!1)}addDimensions(t){t.forEach(this.dimensions.add,this.dimensions)}dependentFields(){return new Set([...this.dimensions,...Xot(this.measures)])}producedFields(){const t=new Set;for(const e of Xot(this.measures))for(const n of Xot(this.measures[e])){const r=this.measures[e][n];0===r.size?t.add(`${n}_${e}`):r.forEach(t.add,t)}return t}hash(){return`Aggregate ${Fot({dimensions:this.dimensions,measures:this.measures})}`}assemble(){const t=[],e=[],n=[];for(const r of Xot(this.measures))for(const i of Xot(this.measures[r]))for(const o of this.measures[r][i])n.push(o),t.push(i),e.push("*"===r?null:sst(r));return{type:"aggregate",groupby:[...this.dimensions].map(sst),ops:t,fields:e,as:n}}}class Sbt extends Fmt{constructor(t,e,n,r){super(t),this.model=e,this.name=n,this.data=r;for(const t of fat){const n=e.facet[t];if(n){const{bin:r,sort:i}=n;this[t]={name:e.getName(`${t}_domain`),fields:[_ft(n),...Tlt(r)?[_ft(n,{binSuffix:"end"})]:[]],...Yht(i)?{sortField:i}:Q$(i)?{sortIndexField:Dyt(n,t)}:{}}}}this.childModel=e.child}hash(){let t="Facet";for(const e of fat)this[e]&&(t+=` ${e.charAt(0)}:${Fot(this[e])}`);return t}get fields(){const t=[];for(const e of fat)this[e]?.fields&&t.push(...this[e].fields);return t}dependentFields(){const t=new Set(this.fields);for(const e of fat)this[e]&&(this[e].sortField&&t.add(this[e].sortField.field),this[e].sortIndexField&&t.add(this[e].sortIndexField));return t}producedFields(){return new Set}getSource(){return this.name}getChildIndependentFieldsWithStep(){const t={};for(const e of Kat){const n=this.childModel.component.scales[e];if(n&&!n.merged){const r=n.get("type"),i=n.get("range");if(Pct(r)&&jlt(i)){const n=pvt(mvt(this.childModel,e));n?t[e]=n:zut(put(e))}}}return t}assembleRowColumnHeaderData(t,e,n){const r={row:"y",column:"x",facet:void 0}[t],i=[],o=[],s=[];r&&n&&n[r]&&(e?(i.push(`distinct_${n[r]}`),o.push("max")):(i.push(n[r]),o.push("distinct")),s.push(`distinct_${n[r]}`));const{sortField:a,sortIndexField:l}=this[t];if(a){const{op:t=qht,field:e}=a;i.push(e),o.push(t),s.push(_ft(a,{forAs:!0}))}else l&&(i.push(l),o.push("max"),s.push(l));return{name:this[t].name,source:e??this.data,transform:[{type:"aggregate",groupby:this[t].fields,...i.length?{fields:i,ops:o,as:s}:{}}]}}assembleFacetHeaderData(t){const{columns:e}=this.model.layout,{layoutHeaders:n}=this.model.component,r=[],i={};for(const t of Iyt){for(const e of Nyt){const r=(n[t]&&n[t][e])??[];for(const e of r)if(e.axes?.length>0){i[t]=!0;break}}if(i[t]){const n=`length(data("${this.facet.name}"))`,i="row"===t?e?{signal:`ceil(${n} / ${e})`}:1:e?{signal:`min(${n}, ${e})`}:{signal:n};r.push({name:`${this.facet.name}_${t}`,transform:[{type:"sequence",start:0,stop:i}]})}}const{row:o,column:s}=i;return(o||s)&&r.unshift(this.assembleRowColumnHeaderData("facet",null,t)),r}assemble(){const t=[];let e=null;const n=this.getChildIndependentFieldsWithStep(),{column:r,row:i,facet:o}=this;if(r&&i&&(n.x||n.y)){e=`cross_${this.column.name}_${this.row.name}`;const r=[].concat(n.x??[],n.y??[]),i=r.map((()=>"distinct"));t.push({name:e,source:this.data,transform:[{type:"aggregate",groupby:this.fields,fields:r,ops:i}]})}for(const r of[_st,xst])this[r]&&t.push(this.assembleRowColumnHeaderData(r,e,n));if(o){const e=this.assembleFacetHeaderData(n);e&&t.push(...e)}return t}}function Ebt(t){return t.startsWith("'")&&t.endsWith("'")||t.startsWith('"')&&t.endsWith('"')?t.slice(1,-1):t}function Abt(t){const e={};return Mot(t.filter,(t=>{if(mct(t)){let n=null;lct(t)?n=Glt(t.equal):cct(t)?n=Glt(t.lte):uct(t)?n=Glt(t.lt):hct(t)?n=Glt(t.gt):fct(t)?n=Glt(t.gte):dct(t)?n=t.range[0]:pct(t)&&(n=(t.oneOf??t.in)[0]),n&&(jut(n)?e[t.field]="date":GF(n)?e[t.field]="number":XF(n)&&(e[t.field]="string")),t.timeUnit&&(e[t.field]="date")}})),e}class Cbt extends Fmt{clone(){return new Cbt(null,Tot(this._parse))}constructor(t,e){super(t),this._parse=e}hash(){return`Parse ${Fot(this._parse)}`}static makeExplicit(t,e,n){let r={};const i=e.data;return!Smt(i)&&i?.format?.parse&&(r=i.format.parse),this.makeWithAncestors(t,r,{},n)}static makeWithAncestors(t,e,n,r){for(const t of Xot(n)){const e=r.getWithExplicit(t);void 0!==e.value&&(e.explicit||e.value===n[t]||"derived"===e.value||"flatten"===n[t]?delete n[t]:zut(vut(t,n[t],e.value)))}for(const t of Xot(e)){const n=r.get(t);void 0!==n&&(n===e[t]?delete e[t]:zut(vut(t,e[t],n)))}const i=new pmt(e,n);r.copyAll(i);const o={};for(const t of Xot(i.combine())){const e=i.get(t);null!==e&&(o[t]=e)}return 0===Xot(o).length||r.parseNothing?null:new Cbt(t,o)}get parse(){return this._parse}merge(t){this._parse={...this._parse,...t.parse},t.remove()}assembleFormatParse(){const t={};for(const e of Xot(this._parse)){const n=this._parse[e];1===ust(e)&&(t[e]=n)}return t}producedFields(){return new Set(Xot(this._parse))}dependentFields(){return new Set(Xot(this._parse))}assembleTransforms(t=!1){return Xot(this._parse).filter((e=>!t||ust(e)>1)).map((t=>{const e=function(t,e){const n=rst(t);return"number"===e?`toNumber(${n})`:"boolean"===e?`toBoolean(${n})`:"string"===e?`toString(${n})`:"date"===e?`toDate(${n})`:"flatten"===e?n:e.startsWith("date:")?`timeParse(${n},'${Ebt(e.slice(5,e.length))}')`:e.startsWith("utc:")?`utcParse(${n},'${Ebt(e.slice(4,e.length))}')`:(zut(`Unrecognized parse "${e}".`),null)}(t,this._parse[t]);return e?{type:"formula",expr:e,as:lst(t)}:null})).filter((t=>null!==t))}}class Dbt extends Fmt{clone(){return new Dbt(null)}constructor(t){super(t)}dependentFields(){return new Set}producedFields(){return new Set([Bdt])}hash(){return"Identifier"}assemble(){return{type:"identifier",as:Bdt}}}class Mbt extends Fmt{clone(){return new Mbt(null,this.params)}constructor(t,e){super(t),this.params=e}dependentFields(){return new Set}producedFields(){}hash(){return`Graticule ${Fot(this.params)}`}assemble(){return{type:"graticule",...!0===this.params?{}:this.params}}}class Obt extends Fmt{clone(){return new Obt(null,this.params)}constructor(t,e){super(t),this.params=e}dependentFields(){return new Set}producedFields(){return new Set([this.params.as??"data"])}hash(){return`Hash ${Fot(this.params)}`}assemble(){return{type:"sequence",...this.params}}}class Tbt extends Fmt{constructor(t){let e;if(super(null),t??(t={name:"source"}),Smt(t)||(e=t.format?{...$ot(t.format,["parse"])}:{}),_mt(t))this._data={values:t.values};else if(xmt(t)){if(this._data={url:t.url},!e.type){let n=/(?:\.([^.]+))?$/.exec(t.url)[1];Bot(["json","csv","tsv","dsv","topojson"],n)||(n="json"),e.type=n}}else Amt(t)?this._data={values:[{type:"Sphere"}]}:(kmt(t)||Smt(t))&&(this._data={});this._generator=Smt(t),t.name&&(this._name=t.name),e&&!Yot(e)&&(this._data.format=e)}dependentFields(){return new Set}producedFields(){}get data(){return this._data}hasName(){return!!this._name}get isGenerator(){return this._generator}get dataName(){return this._name}set dataName(t){this._name=t}set parent(t){throw new Error("Source nodes have to be roots.")}remove(){throw new Error("Source nodes are roots and cannot be removed.")}hash(){throw new Error("Cannot hash sources")}assemble(){return{name:this._name,...this._data,transform:[]}}}var Ibt,Nbt=function(t,e,n,r,i){if("m"===r)throw new TypeError("Private method is not writable");if("a"===r&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?i.call(t,n):i?i.value=n:e.set(t,n),n};function $bt(t){return t instanceof Tbt||t instanceof Mbt||t instanceof Obt}class Fbt{constructor(){Ibt.set(this,void 0),Nbt(this,Ibt,!1,"f")}setModified(){Nbt(this,Ibt,!0,"f")}get modifiedFlag(){return function(t,e,n,r){if("a"===n&&!r)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?r:"a"===n?r.call(t):r?r.value:e.get(t)}(this,Ibt,"f")}}Ibt=new WeakMap;class Lbt extends Fbt{getNodeDepths(t,e,n){n.set(t,e);for(const r of t.children)this.getNodeDepths(r,e+1,n);return n}optimize(t){const e=[...this.getNodeDepths(t,0,new Map).entries()].sort(((t,e)=>e[1]-t[1]));for(const t of e)this.run(t[0]);return this.modifiedFlag}}class Bbt extends Fbt{optimize(t){this.run(t);for(const e of t.children)this.optimize(e);return this.modifiedFlag}}class Rbt extends Bbt{mergeNodes(t,e){const n=e.shift();for(const r of e)t.removeChild(r),r.parent=n,r.remove()}run(t){const e=t.children.map((t=>t.hash())),n={};for(let r=0;r<e.length;r++)void 0===n[e[r]]?n[e[r]]=[t.children[r]]:n[e[r]].push(t.children[r]);for(const e of Xot(n))n[e].length>1&&(this.setModified(),this.mergeNodes(t,n[e]))}}class Pbt extends Bbt{constructor(t){super(),this.requiresSelectionId=t&&ayt(t)}run(t){t instanceof Dbt&&(this.requiresSelectionId&&($bt(t.parent)||t.parent instanceof kbt||t.parent instanceof Cbt)||(this.setModified(),t.remove()))}}class zbt extends Fbt{optimize(t){return this.run(t,new Set),this.modifiedFlag}run(t,e){let n=new Set;t instanceof Pmt&&(n=t.producedFields(),Wot(n,e)&&(this.setModified(),t.removeFormulas(e),0===t.producedFields.length&&t.remove()));for(const r of t.children)this.run(r,new Set([...e,...n]))}}class jbt extends Bbt{constructor(){super()}run(t){t instanceof Lmt&&!t.isRequired()&&(this.setModified(),t.remove())}}class Ubt extends Lbt{run(t){if(!($bt(t)||t.numChildren()>1))for(const e of t.children)if(e instanceof Cbt)if(t instanceof Cbt)this.setModified(),t.merge(e);else{if(Got(t.producedFields(),e.dependentFields()))continue;this.setModified(),e.swapWithParent()}}}class Vbt extends Lbt{run(t){const e=[...t.children],n=t.children.filter((t=>t instanceof Cbt));if(t.numChildren()>1&&n.length>=1){const r={},i=new Set;for(const t of n){const e=t.parse;for(const t of Xot(e))t in r?r[t]!==e[t]&&i.add(t):r[t]=e[t]}for(const t of i)delete r[t];if(!Yot(r)){this.setModified();const n=new Cbt(t,r);for(const i of e){if(i instanceof Cbt)for(const t of Xot(r))delete i.parse[t];t.removeChild(i),i.parent=n,i instanceof Cbt&&0===Xot(i.parse).length&&i.remove()}}}}}class qbt extends Lbt{run(t){t instanceof Lmt||t.numChildren()>0||t instanceof Sbt||t instanceof Tbt||(this.setModified(),t.remove())}}class Wbt extends Lbt{run(t){const e=t.children.filter((t=>t instanceof Pmt)),n=e.pop();for(const t of e)this.setModified(),n.merge(t)}}class Hbt extends Lbt{run(t){const e=t.children.filter((t=>t instanceof kbt)),n={};for(const t of e){const e=Fot(t.groupBy);e in n||(n[e]=[]),n[e].push(t)}for(const e of Xot(n)){const r=n[e];if(r.length>1){const e=r.pop();for(const n of r)e.merge(n)&&(t.removeChild(n),n.parent=e,n.remove(),this.setModified())}}}}class Gbt extends Lbt{constructor(t){super(),this.model=t}run(t){const e=!($bt(t)||t instanceof fyt||t instanceof Cbt||t instanceof Dbt),n=[],r=[];for(const i of t.children)i instanceof _bt&&(e&&!Got(t.producedFields(),i.dependentFields())?n.push(i):r.push(i));if(n.length>0){const e=n.pop();for(const t of n)e.merge(t,this.model.renameSignal.bind(this.model));this.setModified(),t instanceof _bt?t.merge(e,this.model.renameSignal.bind(this.model)):e.swapWithParent()}if(r.length>1){const t=r.pop();for(const e of r)t.merge(e,this.model.renameSignal.bind(this.model));this.setModified()}}}class Ybt extends Lbt{run(t){const e=[...t.children];if(!Rot(e,(t=>t instanceof Lmt))||t.numChildren()<=1)return;const n=[];let r;for(const i of e)if(i instanceof Lmt){let e=i;for(;1===e.numChildren();){const[t]=e.children;if(!(t instanceof Lmt))break;e=t}n.push(...e.children),r?(t.removeChild(i),i.parent=r.parent,r.parent.removeChild(r),r.parent=e,this.setModified()):r=e}else n.push(i);if(n.length){this.setModified();for(const t of n)t.parent.removeChild(t),t.parent=r}}}class Xbt extends Fmt{clone(){return new Xbt(null,Tot(this.transform))}constructor(t,e){super(t),this.transform=e}addDimensions(t){this.transform.groupby=Uot(this.transform.groupby.concat(t),(t=>t))}dependentFields(){const t=new Set;return this.transform.groupby&&this.transform.groupby.forEach(t.add,t),this.transform.joinaggregate.map((t=>t.field)).filter((t=>void 0!==t)).forEach(t.add,t),t}producedFields(){return new Set(this.transform.joinaggregate.map(this.getDefaultName))}getDefaultName(t){return t.as??_ft(t)}hash(){return`JoinAggregateTransform ${Fot(this.transform)}`}assemble(){const t=[],e=[],n=[];for(const r of this.transform.joinaggregate)e.push(r.op),n.push(this.getDefaultName(r)),t.push(void 0===r.field?null:r.field);const r=this.transform.groupby;return{type:"joinaggregate",as:n,ops:e,fields:t,...void 0!==r?{groupby:r}:{}}}}class Jbt extends Fmt{clone(){return new Jbt(null,Tot(this._stack))}constructor(t,e){super(t),this._stack=e}static makeFromTransform(t,e){const{stack:n,groupby:r,as:i,offset:o="zero"}=e,s=[],a=[];if(void 0!==e.sort)for(const t of e.sort)s.push(t.field),a.push(cst(t.order,"ascending"));const l={field:s,order:a};let u;return u=function(t){return Q$(t)&&t.every((t=>XF(t)))&&t.length>1}(i)?i:XF(i)?[i,`${i}_end`]:[`${e.stack}_start`,`${e.stack}_end`],new Jbt(t,{dimensionFieldDefs:[],stackField:n,groupby:r,offset:o,sort:l,facetby:[],as:u})}static makeFromEncoding(t,e){const n=e.stack,{encoding:r}=e;if(!n)return null;const{groupbyChannels:i,fieldChannel:o,offset:s,impute:a}=n,l=i.map((t=>Tft(r[t]))).filter((t=>!!t)),u=function(t){return t.stack.stackBy.reduce(((t,e)=>{const n=_ft(e.fieldDef);return n&&t.push(n),t}),[])}(e),c=e.encoding.order;let h;if(Q$(c)||lft(c))h=out(c);else{const t=ift(c)?c.sort:"y"===o?"descending":"ascending";h=u.reduce(((e,n)=>(e.field.includes(n)||(e.field.push(n),e.order.push(t)),e)),{field:[],order:[]})}return new Jbt(t,{dimensionFieldDefs:l,stackField:e.vgField(o),facetby:[],stackby:u,sort:h,offset:s,impute:a,as:[e.vgField(o,{suffix:"start",forAs:!0}),e.vgField(o,{suffix:"end",forAs:!0})]})}get stack(){return this._stack}addDimensions(t){this._stack.facetby.push(...t)}dependentFields(){const t=new Set;return t.add(this._stack.stackField),this.getGroupbyFields().forEach(t.add,t),this._stack.facetby.forEach(t.add,t),this._stack.sort.field.forEach(t.add,t),t}producedFields(){return new Set(this._stack.as)}hash(){return`Stack ${Fot(this._stack)}`}getGroupbyFields(){const{dimensionFieldDefs:t,impute:e,groupby:n}=this._stack;return t.length>0?t.map((t=>t.bin?e?[_ft(t,{binSuffix:"mid"})]:[_ft(t,{}),_ft(t,{binSuffix:"end"})]:[_ft(t)])).flat():n??[]}assemble(){const t=[],{facetby:e,dimensionFieldDefs:n,stackField:r,stackby:i,sort:o,offset:s,impute:a,as:l}=this._stack;if(a)for(const o of n){const{bandPosition:n=.5,bin:s}=o;if(s){const e=_ft(o,{expr:"datum"}),r=_ft(o,{expr:"datum",binSuffix:"end"});t.push({type:"formula",expr:`${n}*${e}+${1-n}*${r}`,as:_ft(o,{binSuffix:"mid",forAs:!0})})}t.push({type:"impute",field:r,groupby:[...i,...e],key:_ft(o,{binSuffix:"mid"}),method:"value",value:0})}return t.push({type:"stack",groupby:[...this.getGroupbyFields(),...e],field:r,sort:o,as:l,offset:s}),t}}class Kbt extends Fmt{clone(){return new Kbt(null,Tot(this.transform))}constructor(t,e){super(t),this.transform=e}addDimensions(t){this.transform.groupby=Uot(this.transform.groupby.concat(t),(t=>t))}dependentFields(){const t=new Set;return(this.transform.groupby??[]).forEach(t.add,t),(this.transform.sort??[]).forEach((e=>t.add(e.field))),this.transform.window.map((t=>t.field)).filter((t=>void 0!==t)).forEach(t.add,t),t}producedFields(){return new Set(this.transform.window.map(this.getDefaultName))}getDefaultName(t){return t.as??_ft(t)}hash(){return`WindowTransform ${Fot(this.transform)}`}assemble(){const t=[],e=[],n=[],r=[];for(const i of this.transform.window)e.push(i.op),n.push(this.getDefaultName(i)),r.push(void 0===i.param?null:i.param),t.push(void 0===i.field?null:i.field);const i=this.transform.frame,o=this.transform.groupby;if(i&&null===i[0]&&null===i[1]&&e.every((t=>Elt(t))))return{type:"joinaggregate",as:n,ops:e,fields:t,...void 0!==o?{groupby:o}:{}};const s=[],a=[];if(void 0!==this.transform.sort)for(const t of this.transform.sort)s.push(t.field),a.push(t.order??"ascending");const l={field:s,order:a},u=this.transform.ignorePeers;return{type:"window",params:r,as:n,ops:e,fields:t,sort:l,...void 0!==u?{ignorePeers:u}:{},...void 0!==o?{groupby:o}:{},...void 0!==i?{frame:i}:{}}}}function Qbt(t){if(t instanceof Sbt)if(1!==t.numChildren()||t.children[0]instanceof Lmt){const n=t.model.component.data.main;Zbt(n);const r=(e=t,function t(n){if(!(n instanceof Sbt)){const r=n.clone();if(r instanceof Lmt){const t=tvt+r.getSource();r.setSource(t),e.model.component.data.outputNodes[t]=r}else(r instanceof kbt||r instanceof Jbt||r instanceof Kbt||r instanceof Xbt)&&r.addDimensions(e.fields);for(const e of n.children.flatMap(t))e.parent=r;return[r]}return n.children.flatMap(t)}),i=t.children.map(r).flat();for(const t of i)t.parent=n}else{const e=t.children[0];(e instanceof kbt||e instanceof Jbt||e instanceof Kbt||e instanceof Xbt)&&e.addDimensions(t.fields),e.swapWithParent(),Qbt(t)}else t.children.map(Qbt);var e}function Zbt(t){if(t instanceof Lmt&&t.type===Dmt.Main&&1===t.numChildren()){const e=t.children[0];e instanceof Sbt||(e.swapWithParent(),Zbt(t))}}const tvt="scale_",evt=5;function nvt(t){for(const e of t){for(const t of e.children)if(t.parent!==e)return!1;if(!nvt(e.children))return!1}return!0}function rvt(t,e){let n=!1;for(const r of e)n=t.optimize(r)||n;return n}function ivt(t,e,n){let r=t.sources,i=!1;return i=rvt(new jbt,r)||i,i=rvt(new Pbt(e),r)||i,r=r.filter((t=>t.numChildren()>0)),i=rvt(new qbt,r)||i,r=r.filter((t=>t.numChildren()>0)),n||(i=rvt(new Ubt,r)||i,i=rvt(new Gbt(e),r)||i,i=rvt(new zbt,r)||i,i=rvt(new Vbt,r)||i,i=rvt(new Hbt,r)||i,i=rvt(new Wbt,r)||i,i=rvt(new Rbt,r)||i,i=rvt(new Ybt,r)||i),t.sources=r,i}class ovt{constructor(t){Object.defineProperty(this,"signal",{enumerable:!0,get:t})}static fromName(t,e){return new ovt((()=>t(e)))}}function svt(t){Rvt(t)?function(t){const e=t.component.scales;for(const n of Xot(e)){const r=avt(t,n);if(e[n].setWithExplicit("domains",r),hvt(t,n),t.component.data.isFaceted){let e=t;for(;!Pvt(e)&&e.parent;)e=e.parent;if("shared"===e.component.resolve.scale[n])for(const t of r.value)Ult(t)&&(t.data=tvt+t.data.replace(tvt,""))}}}(t):function(t){for(const e of t.children)svt(e);const e=t.component.scales;for(const n of Xot(e)){let r,i=null;for(const e of t.children){const t=e.component.scales[n];if(t){r=void 0===r?t.getWithExplicit("domains"):vmt(r,t.getWithExplicit("domains"),"domains","scale",dvt);const e=t.get("selectionExtent");i&&e&&i.param!==e.param&&zut("The same selection must be used to override scale domains in a layered view."),i=e}}e[n].setWithExplicit("domains",r),i&&e[n].set("selectionExtent",i,!0)}}(t)}function avt(t,e){const n=t.getScaleComponent(e).get("type"),{encoding:r}=t,i=function(t,e,n,r){if("unaggregated"===t){const{valid:t,reason:r}=fvt(e,n);if(!t)return void zut(r)}else if(void 0===t&&r.useUnaggregatedDomain){const{valid:t}=fvt(e,n);if(t)return"unaggregated"}return t}(t.scaleDomain(e),t.typedFieldDef(e),n,t.config.scale);return i!==t.scaleDomain(e)&&(t.specifiedScales[e]={...t.specifiedScales[e],domain:i}),"x"===e&&Ift(r.x2)?Ift(r.x)?vmt(uvt(n,i,t,"x"),uvt(n,i,t,"x2"),"domain","scale",dvt):uvt(n,i,t,"x2"):"y"===e&&Ift(r.y2)?Ift(r.y)?vmt(uvt(n,i,t,"y"),uvt(n,i,t,"y2"),"domain","scale",dvt):uvt(n,i,t,"y2"):uvt(n,i,t,e)}function lvt(t,e,n){const r=ict(n)?.unit;return"temporal"===e||r?function(t,e,n){return t.map((t=>({signal:`{data: ${Pft(t,{timeUnit:n,type:e})}}`})))}(t,e,r):[t]}function uvt(t,e,n,r){const{encoding:i,markDef:o,mark:s,config:a,stack:l}=n,u=Ift(i[r]),{type:c}=u,h=u.timeUnit;if(function(t){return t?.unionWith}(e)){const i=uvt(t,void 0,n,r);return mmt([...lvt(e.unionWith,c,h),...i.value])}if(zlt(e))return mmt([e]);if(e&&"unaggregated"!==e&&!Vct(e))return mmt(lvt(e,c,h));if(l&&r===l.fieldChannel){if("normalize"===l.offset)return gmt([[0,1]]);const t=n.requestDataName(Dmt.Main);return gmt([{data:t,field:n.vgField(r,{suffix:"start"})},{data:t,field:n.vgField(r,{suffix:"end"})}])}const f=glt(r)&&lft(u)?function(t,e,n){if(!Pct(n))return;const r=t.fieldDef(e),i=r.sort;if(Xht(i))return{op:"min",field:Dyt(r,e),order:"ascending"};const{stack:o}=t,s=o?new Set([...o.groupbyFields,...o.stackBy.map((t=>t.fieldDef.field))]):void 0;if(Yht(i))return cvt(i,o&&!s.has(i.field));if(Ght(i)){const{encoding:e,order:n}=i,r=t.fieldDef(e),{aggregate:a,field:l}=r,u=o&&!s.has(l);if(klt(a)||Slt(a))return cvt({field:_ft(r),order:n},u);if(Elt(a)||!a)return cvt({op:a,field:l,order:n},u)}else{if("descending"===i)return{op:"min",field:t.vgField(e),order:"descending"};if(Bot(["ascending",void 0],i))return!0}}(n,r,t):void 0;if(cft(u))return gmt(lvt([u.datum],c,h));const d=u;if("unaggregated"===e){const t=n.requestDataName(Dmt.Main),{field:e}=u;return gmt([{data:t,field:_ft({field:e,aggregate:"min"})},{data:t,field:_ft({field:e,aggregate:"max"})}])}if(Tlt(d.bin)){if(Pct(t))return gmt("bin-ordinal"===t?[]:[{data:Qot(f)?n.requestDataName(Dmt.Main):n.requestDataName(Dmt.Raw),field:n.vgField(r,jft(d,r)?{binSuffix:"range"}:{}),sort:!0!==f&&Z$(f)?f:{field:n.vgField(r,{}),op:"min"}}]);{const{bin:t}=d;if(Tlt(t)){const e=wbt(n,d.field,t);return gmt([new ovt((()=>{const t=n.getSignalName(e);return`[${t}.start, ${t}.stop]`}))])}return gmt([{data:n.requestDataName(Dmt.Main),field:n.vgField(r,{})}])}}if(d.timeUnit&&Bot(["time","utc"],t)){const t=i[Dat(r)];if(rft(d,t,o,a)){const e=n.requestDataName(Dmt.Main),i=eft({fieldDef:d,fieldDef2:t,markDef:o,config:a}),l=Lht(s)&&.5!==i&&Qat(r);return gmt([{data:e,field:n.vgField(r,l?{suffix:zmt}:{})},{data:e,field:n.vgField(r,{suffix:l?jmt:"end"})}])}}return gmt(f?[{data:Qot(f)?n.requestDataName(Dmt.Main):n.requestDataName(Dmt.Raw),field:n.vgField(r),sort:f}]:[{data:n.requestDataName(Dmt.Main),field:n.vgField(r)}])}function cvt(t,e){const{op:n,field:r,order:i}=t;return{op:n??(e?"sum":qht),...r?{field:sst(r)}:{},...i?{order:i}:{}}}function hvt(t,e){const n=t.component.scales[e],r=t.specifiedScales[e].domain,i=t.fieldDef(e)?.bin,o=Vct(r)&&r,s=Nlt(i)&&$lt(i.extent)&&i.extent;(o||s)&&n.set("selectionExtent",o??s,!0)}function fvt(t,e){const{aggregate:n,type:r}=t;return n?XF(n)&&!Mlt.has(n)?{valid:!1,reason:Out(n)}:"quantitative"===r&&"log"===e?{valid:!1,reason:Tut(t)}:{valid:!0}:{valid:!1,reason:Mut(t)}}function dvt(t,e,n,r){return t.explicit&&e.explicit&&zut(function(t,e,n,r){return`Conflicting ${e.toString()} property "${t.toString()}" (${wst(n)} and ${wst(r)}). Using the union of the two domains.`}(n,r,t.value,e.value)),{explicit:t.explicit,value:[...t.value,...e.value]}}function pvt(t){if(Ult(t)&&XF(t.field))return t.field;if(function(t){return!Q$(t)&&"fields"in t&&!("data"in t)}(t)){let e;for(const n of t.fields)if(Ult(n)&&XF(n.field))if(e){if(e!==n.field)return zut("Detected faceted independent scales that union domain of multiple fields from different data sources. We will use the first field. The result view size may be incorrect."),e}else e=n.field;return zut("Detected faceted independent scales that union domain of the same fields from different source. We will assume that this is the same field from a different fork of the same data source. However, if this is not the case, the result view size may be incorrect."),e}if(function(t){return!Q$(t)&&"fields"in t&&"data"in t}(t)){zut("Detected faceted independent scales that union domain of multiple fields from the same data source. We will use the first field. The result view size may be incorrect.");const e=t.fields[0];return XF(e)?e:void 0}}function mvt(t,e){return function(t){const e=Uot(t.map((t=>{if(Ult(t)){const{sort:e,...n}=t;return n}return t})),Fot),n=Uot(t.map((t=>{if(Ult(t)){const e=t.sort;return void 0===e||Qot(e)||("op"in e&&"count"===e.op&&delete e.field,"ascending"===e.order&&delete e.order),e}})).filter((t=>void 0!==t)),Fot);if(0===e.length)return;if(1===e.length){const e=t[0];if(Ult(e)&&n.length>0){let t=n[0];if(n.length>1){zut($ut);const e=n.filter((t=>Z$(t)&&"op"in t&&"min"!==t.op));t=!n.every((t=>Z$(t)&&"op"in t))||1!==e.length||e[0]}else if(Z$(t)&&"field"in t){const n=t.field;e.field===n&&(t=!t.order||{order:t.order})}return{...e,sort:t}}return e}const r=Uot(n.map((t=>Qot(t)||!("op"in t)||XF(t.op)&&t.op in _lt?t:(zut(function(t){return`Dropping sort property ${wst(t)} as unioned domains only support boolean or op "count", "min", and "max".`}(t)),!0))),Fot);let i;1===r.length?i=r[0]:r.length>1&&(zut($ut),i=!0);const o=Uot(t.map((t=>Ult(t)?t.data:null)),(t=>t));return 1===o.length&&null!==o[0]?{data:o[0],fields:e.map((t=>t.field)),...i?{sort:i}:{}}:{fields:e,...i?{sort:i}:{}}}(t.component.scales[e].get("domains").map((e=>(Ult(e)&&(e.data=t.lookupDataSource(e.data)),e))))}function gvt(t){return jvt(t)||zvt(t)?t.children.reduce(((t,e)=>t.concat(gvt(e))),yvt(t)):yvt(t)}function yvt(t){return Xot(t.component.scales).reduce(((e,n)=>{const r=t.component.scales[n];if(r.merged)return e;const i=r.combine(),{name:o,type:s,selectionExtent:a,domains:l,range:u,reverse:c,...h}=i,f=function(t,e,n,r){if(Qat(n)){if(jlt(t))return{step:{signal:`${e}_step`}}}else if(Z$(t)&&Ult(t))return{...t,data:r.lookupDataSource(t.data)};return t}(i.range,o,n,t),d=mvt(t,n),p=a?function(t,e,n,r){const i=pyt(t,e.param,e);return{signal:zct(n.get("type"))&&Q$(r)&&r[0]>r[1]?`isValid(${i}) && reverse(${i})`:i}}(t,a,r,d):null;return e.push({name:o,type:s,...d?{domain:d}:{},...p?{domainRaw:p}:{},range:f,...void 0!==c?{reverse:c}:{},...h}),e}),[])}class bvt extends pmt{constructor(t,e){super({},{name:t}),this.merged=!1,this.setWithExplicit("type",e)}domainDefinitelyIncludesZero(){return!1!==this.get("zero")||Rot(this.get("domains"),(t=>Q$(t)&&2===t.length&&GF(t[0])&&t[0]<=0&&GF(t[1])&&t[1]>=0))}}const vvt=["range","scheme"];function wvt(t,e){const n=t.fieldDef(e);if(n?.bin){const{bin:r,field:i}=n,o=Mat(e),s=t.getName(o);if(Z$(r)&&r.binned&&void 0!==r.step)return new ovt((()=>{const n=t.scaleName(e),i=`(domain("${n}")[1] - domain("${n}")[0]) / ${r.step}`;return`${t.getSignalName(s)} / (${i})`}));if(Tlt(r)){const e=wbt(t,i,r);return new ovt((()=>{const n=t.getSignalName(e),r=`(${n}.stop - ${n}.start) / ${n}.step`;return`${t.getSignalName(s)} / (${r})`}))}}}function xvt(t,e){const n=e.specifiedScales[t],{size:r}=e,i=e.getScaleComponent(t).get("type");for(const r of vvt)if(void 0!==n[r]){const o=Zct(i,r),s=tht(t,r);if(o)if(s)zut(s);else switch(r){case"range":{const r=n.range;if(Q$(r)){if(Qat(t))return mmt(r.map((t=>{if("width"===t||"height"===t){const n=e.getName(t),r=e.getSignalName.bind(e);return ovt.fromName(r,n)}return t})))}else if(Z$(r))return mmt({data:e.requestDataName(Dmt.Main),field:r.field,sort:{op:"min",field:e.vgField(t)}});return mmt(r)}case"scheme":return mmt(_vt(n[r]))}else zut(Iut(i,r,t))}const o=t===Sst||"xOffset"===t?"width":"height",s=r[o];if(Gdt(s))if(Qat(t))if(Pct(i)){const n=Svt(s,e,t);if(n)return mmt({step:n})}else zut(Nut(o));else if(rlt(t)){const n=t===Dst?"x":"y";if("band"===e.getScaleComponent(n).get("type")){const t=Evt(s,i);if(t)return mmt(t)}}const{rangeMin:a,rangeMax:l}=n,u=function(t,e){const{size:n,config:r,mark:i,encoding:o}=e,{type:s}=Ift(o[t]),a=e.getScaleComponent(t).get("type"),{domain:l,domainMid:u}=e.specifiedScales[t];switch(t){case Sst:case Est:if(Bot(["point","band"],a)){const i=Avt(t,n,r.view);if(Gdt(i))return{step:Svt(i,e,t)}}return kvt(t,e,a);case Dst:case Mst:return function(t,e,n){const r=t===Dst?"x":"y",i=e.getScaleComponent(r);if(!i)return kvt(r,e,n,{center:!0});const o=i.get("type"),s=e.scaleName(r),{markDef:a,config:l}=e;if("band"===o){const t=Avt(r,e.size,e.config.view);if(Gdt(t)){const e=Evt(t,n);if(e)return e}return[0,{signal:`bandwidth('${s}')`}]}{const n=e.encoding[r];if(lft(n)&&n.timeUnit){const t=oct(n.timeUnit,(t=>`scale('${s}', ${t})`)),r=e.config.scale.bandWithNestedOffsetPaddingInner,i=eft({fieldDef:n,markDef:a,config:l})-.5,o=0!==i?` + ${i}`:"";return r?[{signal:`${zlt(r)?`${r.signal}/2`+o:`${r/2+i}`} * (${t})`},{signal:`${zlt(r)?`(1 - ${r.signal}/2)`+o:`${1-r/2+i}`} * (${t})`}]:[0,{signal:t}]}return Iot(`Cannot use ${t} scale if ${r} scale is not discrete.`)}}(t,e,a);case Ust:{const o=Cvt(i,e.component.scales[t].get("zero"),r),s=function(t,e,n,r){const i={x:wvt(n,"x"),y:wvt(n,"y")};switch(t){case"bar":case"tick":{if(void 0!==r.scale.maxBandSize)return r.scale.maxBandSize;const t=Mvt(e,i,r.view);return GF(t)?t-1:new ovt((()=>`${t.signal} - 1`))}case"line":case"trail":case"rule":return r.scale.maxStrokeWidth;case"text":return r.scale.maxFontSize;case"point":case"square":case"circle":{if(r.scale.maxSize)return r.scale.maxSize;const t=Mvt(e,i,r.view);return GF(t)?Math.pow(Dvt*t,2):new ovt((()=>`pow(${Dvt} * ${t.signal}, 2)`))}}throw new Error(Eut("size",t))}(i,n,e,r);return Uct(a)?function(t,e,n){const r=()=>{const r=Qlt(e),i=Qlt(t),o=`(${r} - ${i}) / (${n} - 1)`;return`sequence(${i}, ${r} + ${o}, ${o})`};return zlt(e)?new ovt(r):{signal:r()}}(o,s,function(t,e,n,r){switch(t){case"quantile":return e.scale.quantileCount;case"quantize":return e.scale.quantizeCount;case"threshold":return void 0!==n&&Q$(n)?n.length+1:(zut(function(t){return`Domain for ${t} is required for threshold scale.`}(r)),3)}}(a,r,l,t)):[o,s]}case Ist:return[0,2*Math.PI];case Vst:return[0,360];case Ost:return[0,new ovt((()=>`min(${e.getSignalName(Pvt(e.parent)?"child_width":"width")},${e.getSignalName(Pvt(e.parent)?"child_height":"height")})/2`))];case Gst:return[r.scale.minStrokeWidth,r.scale.maxStrokeWidth];case Yst:return[[1,0],[4,2],[2,1],[1,1],[1,2,4,2]];case jst:return"symbol";case Rst:case Pst:case zst:return"ordinal"===a?"nominal"===s?"category":"ordinal":void 0!==u?"diverging":"rect"===i||"geoshape"===i?"heatmap":"ramp";case qst:case Wst:case Hst:return[r.scale.minOpacity,r.scale.maxOpacity]}}(t,e);return(void 0!==a||void 0!==l)&&Zct(i,"rangeMin")&&Q$(u)&&2===u.length?mmt([a??u[0],l??u[1]]):gmt(u)}function _vt(t){return function(t){return!XF(t)&&!!t.name}(t)?{scheme:t.name,...$ot(t,["name"])}:{scheme:t}}function kvt(t,e,n,{center:r}={}){const i=Mat(t),o=e.getName(i),s=e.getSignalName.bind(e);return t===Est&&zct(n)?r?[ovt.fromName((t=>`${s(t)}/2`),o),ovt.fromName((t=>`-${s(t)}/2`),o)]:[ovt.fromName(s,o),0]:r?[ovt.fromName((t=>`-${s(t)}/2`),o),ovt.fromName((t=>`${s(t)}/2`),o)]:[0,ovt.fromName(s,o)]}function Svt(t,e,n){const{encoding:r}=e,i=e.getScaleComponent(n),o=Tat(n),s=r[o];if("offset"===Hdt({step:t,offsetIsDiscrete:pft(s)&&_ct(s.type)})&&Zft(r,o)){const n=e.getScaleComponent(o);let r=`domain('${e.scaleName(o)}').length`;"band"===n.get("type")&&(r=`bandspace(${r}, ${n.get("paddingInner")??n.get("padding")??0}, ${n.get("paddingOuter")??n.get("padding")??0})`);const s=i.get("paddingInner")??i.get("padding");return{signal:`${t.step} * ${r} / (1-${Jlt(s)})`}}return t.step}function Evt(t,e){if("offset"===Hdt({step:t,offsetIsDiscrete:Pct(e)}))return{step:t.step}}function Avt(t,e,n){const r=t===Sst?"width":"height";return e[r]||Qdt(n,r)}function Cvt(t,e,n){if(e)return zlt(e)?{signal:`${e.signal} ? 0 : ${Cvt(t,!1,n)}`}:0;switch(t){case"bar":case"tick":return n.scale.minBandSize;case"line":case"trail":case"rule":return n.scale.minStrokeWidth;case"text":return n.scale.minFontSize;case"point":case"square":case"circle":return n.scale.minSize}throw new Error(Eut("size",t))}const Dvt=.95;function Mvt(t,e,n){const r=Gdt(t.width)?t.width.step:Kdt(n,"width"),i=Gdt(t.height)?t.height.step:Kdt(n,"height");return e.x||e.y?new ovt((()=>`min(${[e.x?e.x.signal:r,e.y?e.y.signal:i].join(", ")})`)):Math.min(r,i)}function Ovt(t,e){Rvt(t)?function(t,e){const n=t.component.scales,{config:r,encoding:i,markDef:o,specifiedScales:s}=t;for(const a of Xot(n)){const l=s[a],u=n[a],c=t.getScaleComponent(a),h=Ift(i[a]),f=l[e],d=c.get("type"),p=c.get("padding"),m=c.get("paddingInner"),g=Zct(d,e),y=tht(a,e);if(void 0!==f&&(g?y&&zut(y):zut(Iut(d,e,a))),g&&void 0===y)if(void 0!==f){const t=h.timeUnit,n=h.type;switch(e){case"domainMax":case"domainMin":jut(l[e])||"temporal"===n||t?u.set(e,{signal:Pft(l[e],{type:n,timeUnit:t})},!0):u.set(e,l[e],!0);break;default:u.copyKeyFromObject(e,l)}}else{const n=e in Tvt?Tvt[e]({model:t,channel:a,fieldOrDatumDef:h,scaleType:d,scalePadding:p,scalePaddingInner:m,domain:l.domain,domainMin:l.domainMin,domainMax:l.domainMax,markDef:o,config:r,hasNestedOffsetScale:tdt(i,a),hasSecondaryRangeChannel:!!i[Dat(a)]}):r.scale[e];void 0!==n&&u.set(e,n,!1)}}}(t,e):Nvt(t,e)}const Tvt={bins:({model:t,fieldOrDatumDef:e})=>lft(e)?function(t,e){const n=e.bin;if(Tlt(n)){const r=wbt(t,e.field,n);return new ovt((()=>t.getSignalName(r)))}if(Ilt(n)&&Nlt(n)&&void 0!==n.step)return{step:n.step}}(t,e):void 0,interpolate:({channel:t,fieldOrDatumDef:e})=>function(t,e){if(Bot([Rst,Pst,zst],t)&&"nominal"!==e)return"hcl"}(t,e.type),nice:({scaleType:t,channel:e,domain:n,domainMin:r,domainMax:i,fieldOrDatumDef:o})=>function(t,e,n,r,i,o){if(!(Tft(o)?.bin||Q$(n)||null!=i||null!=r||Bot([Dct.TIME,Dct.UTC],t)))return!!Qat(e)||void 0}(t,e,n,r,i,o),padding:({channel:t,scaleType:e,fieldOrDatumDef:n,markDef:r,config:i})=>function(t,e,n,r,i,o){if(Qat(t)){if(jct(e)){if(void 0!==n.continuousPadding)return n.continuousPadding;const{type:e,orient:s}=i;if("bar"===e&&(!lft(r)||!r.bin&&!r.timeUnit)&&("vertical"===s&&"x"===t||"horizontal"===s&&"y"===t))return o.continuousBandSize}if(e===Dct.POINT)return n.pointPadding}}(t,e,i.scale,n,r,i.bar),paddingInner:({scalePadding:t,channel:e,markDef:n,scaleType:r,config:i,hasNestedOffsetScale:o})=>function(t,e,n,r,i,o=!1){if(void 0===t){if(Qat(e)){const{bandPaddingInner:t,barBandPaddingInner:e,rectBandPaddingInner:r,bandWithNestedOffsetPaddingInner:s}=i;return o?s:cst(t,"bar"===n?e:r)}return rlt(e)&&r===Dct.BAND?i.offsetBandPaddingInner:void 0}}(t,e,n.type,r,i.scale,o),paddingOuter:({scalePadding:t,channel:e,scaleType:n,scalePaddingInner:r,config:i,hasNestedOffsetScale:o})=>function(t,e,n,r,i,o=!1){if(void 0===t)if(Qat(e)){const{bandPaddingOuter:t,bandWithNestedOffsetPaddingOuter:e}=i;if(o)return e;if(n===Dct.BAND)return cst(t,zlt(r)?{signal:`${r.signal}/2`}:r/2)}else if(rlt(e)){if(n===Dct.POINT)return.5;if(n===Dct.BAND)return i.offsetBandPaddingOuter}}(t,e,n,r,i.scale,o),reverse:({fieldOrDatumDef:t,scaleType:e,channel:n,config:r})=>function(t,e,n,r){return"x"===n&&void 0!==r.xReverse?zct(t)&&"descending"===e?zlt(r.xReverse)?{signal:`!${r.xReverse.signal}`}:!r.xReverse:r.xReverse:!(!zct(t)||"descending"!==e)||void 0}(e,lft(t)?t.sort:void 0,n,r.scale),zero:({channel:t,fieldOrDatumDef:e,domain:n,markDef:r,scaleType:i,config:o,hasSecondaryRangeChannel:s})=>function(t,e,n,r,i,o,s){if(n&&"unaggregated"!==n&&zct(i)){if(Q$(n)){const t=n[0],e=n[n.length-1];if(GF(t)&&t<=0&&GF(e)&&e>=0)return!0}return!1}if("size"===t&&"quantitative"===e.type&&!Uct(i))return!0;if((!lft(e)||!e.bin)&&Bot([...Kat,...tlt],t)){const{orient:e,type:n}=r;return(!Bot(["bar","area","line","trail"],n)||!("horizontal"===e&&"y"===t||"vertical"===e&&"x"===t))&&(!(!Bot(["bar","area"],n)||s)||o?.zero)}return!1}(t,e,n,r,i,o.scale,s)};function Ivt(t){Rvt(t)?function(t){const e=t.component.scales;for(const n of mlt){const r=e[n];if(!r)continue;const i=xvt(n,t);r.setWithExplicit("range",i)}}(t):Nvt(t,"range")}function Nvt(t,e){const n=t.component.scales;for(const n of t.children)"range"===e?Ivt(n):Ovt(n,e);for(const r of Xot(n)){let i;for(const n of t.children){const t=n.component.scales[r];t&&(i=vmt(i,t.getWithExplicit(e),e,"scale",ymt(((t,n)=>"range"===e&&t.step&&n.step?t.step-n.step:0))))}n[r].setWithExplicit(e,i)}}function $vt(t,e,n,r,i=!1){const o=function(t,e,n,r){switch(e.type){case"nominal":case"ordinal":if(cat(t)||"discrete"===wlt(t))return"shape"===t&&"ordinal"===e.type&&zut(Dut(t,"ordinal")),"ordinal";if(Qat(t)||rlt(t)){if(Bot(["rect","bar","image","rule"],n.type))return"band";if(r)return"band"}else if("arc"===n.type&&t in Zat)return"band";return Uht(n[Mat(t)])||bft(e)&&e.axis?.tickBand?"band":"point";case"temporal":return cat(t)?"time":"discrete"===wlt(t)?(zut(Dut(t,"temporal")),"ordinal"):lft(e)&&e.timeUnit&&ict(e.timeUnit).utc?"utc":"time";case"quantitative":return cat(t)?lft(e)&&Tlt(e.bin)?"bin-ordinal":"linear":"discrete"===wlt(t)?(zut(Dut(t,"quantitative")),"ordinal"):"linear";case"geojson":return}throw new Error(_ut(e.type))}(e,n,r,i),{type:s}=t;return glt(e)?void 0!==s?function(t,e,n=!1){if(!glt(t))return!1;switch(t){case Sst:case Est:case Dst:case Mst:case Ist:case Ost:return!!jct(e)||"band"===e||"point"===e&&!n;case Ust:case Gst:case qst:case Wst:case Hst:case Vst:return jct(e)||Uct(e)||Bot(["band","point","ordinal"],e);case Rst:case Pst:case zst:return"band"!==e;case Yst:case jst:return"ordinal"===e||Uct(e)}}(e,s)?lft(n)&&(a=s,l=n.type,!(Bot([Sct,Act],l)?void 0===a||Pct(a):l===Ect?Bot([Dct.TIME,Dct.UTC,void 0],a):l!==kct||Fct(a)||Uct(a)||void 0===a))?(zut(function(t,e){return`FieldDef does not work with "${t}" scale. We are using "${e}" scale instead.`}(s,o)),o):s:(zut(function(t,e,n){return`Channel "${t}" does not work with "${e}" scale. We are using "${n}" scale instead.`}(e,s,o)),o):o:null;var a,l}function Fvt(t){Rvt(t)?t.component.scales=function(t){const{encoding:e,mark:n,markDef:r}=t,i={};for(const o of mlt){const s=Ift(e[o]);if(s&&n===$ht&&o===jst&&s.type===Cct)continue;let a=s&&s.scale;if(s&&null!==a&&!1!==a){a??(a={});const n=$vt(a,o,s,r,tdt(e,o));i[o]=new bvt(t.scaleName(`${o}`,!0),{value:n,explicit:a.type===n})}}return i}(t):t.component.scales=function(t){var e;const n=t.component.scales={},r={},i=t.component.resolve;for(const n of t.children){Fvt(n);for(const o of Xot(n.component.scales))if((e=i.scale)[o]??(e[o]=Jyt(o,t)),"shared"===i.scale[o]){const t=r[o],e=n.component.scales[o].getWithExplicit("type");t?Oct(t.value,e.value)?r[o]=vmt(t,e,"type","scale",Lvt):(i.scale[o]="independent",delete r[o]):r[o]=e}}for(const e of Xot(r)){const i=t.scaleName(e,!0),o=r[e];n[e]=new bvt(i,o);for(const n of t.children){const t=n.component.scales[e];t&&(n.renameScale(t.get("name"),i),t.merged=!0)}}return n}(t)}const Lvt=ymt(((t,e)=>Ict(t)-Ict(e)));class Bvt{constructor(){this.nameMap={}}rename(t,e){this.nameMap[t]=e}has(t){return void 0!==this.nameMap[t]}get(t){for(;this.nameMap[t]&&t!==this.nameMap[t];)t=this.nameMap[t];return t}}function Rvt(t){return"unit"===t?.type}function Pvt(t){return"facet"===t?.type}function zvt(t){return"concat"===t?.type}function jvt(t){return"layer"===t?.type}class Uvt{constructor(t,e,n,r,i,o,s){this.type=e,this.parent=n,this.config=i,this.correctDataNames=t=>(t.from?.data&&(t.from.data=this.lookupDataSource(t.from.data)),t.from?.facet?.data&&(t.from.facet.data=this.lookupDataSource(t.from.facet.data)),t),this.parent=n,this.config=i,this.view=Blt(s),this.name=t.name??r,this.title=Plt(t.title)?{text:t.title}:t.title?Blt(t.title):void 0,this.scaleNameMap=n?n.scaleNameMap:new Bvt,this.projectionNameMap=n?n.projectionNameMap:new Bvt,this.signalNameMap=n?n.signalNameMap:new Bvt,this.data=t.data,this.description=t.description,this.transforms=(t.transform??[]).map((t=>Fpt(t)?{filter:Oot(t.filter,vct)}:t)),this.layout="layer"===e||"unit"===e?{}:function(t,e,n){const r=n[e],i={},{spacing:o,columns:s}=r;void 0!==o&&(i.spacing=o),void 0!==s&&(Qht(t)&&!Jht(t.facet)||Vdt(t))&&(i.columns=s),qdt(t)&&(i.columns=1);for(const e of Xdt)if(void 0!==t[e])if("spacing"===e){const n=t[e];i[e]=GF(n)?n:{row:n.row??o,column:n.column??o}}else i[e]=t[e];return i}(t,e,i),this.component={data:{sources:n?n.component.data.sources:[],outputNodes:n?n.component.data.outputNodes:{},outputNodeRefCounts:n?n.component.data.outputNodeRefCounts:{},isFaceted:Qht(t)||n?.component.data.isFaceted&&void 0===t.data},layoutSize:new pmt,layoutHeaders:{row:{},column:{},facet:{}},mark:null,resolve:{scale:{},axis:{},legend:{},...o?Tot(o):{}},selection:null,scales:null,projection:null,axes:{},legends:{}}}get width(){return this.getSizeSignalRef("width")}get height(){return this.getSizeSignalRef("height")}parse(){this.parseScale(),this.parseLayoutSize(),this.renameTopLevelLayoutSizeSignal(),this.parseSelections(),this.parseProjection(),this.parseData(),this.parseAxesAndHeaders(),this.parseLegends(),this.parseMarkGroup()}parseScale(){!function(t,{ignoreRange:e}={}){Fvt(t),svt(t);for(const e of Qct)Ovt(t,e);e||Ivt(t)}(this)}parseProjection(){ybt(this)}renameTopLevelLayoutSizeSignal(){"width"!==this.getName("width")&&this.renameSignal(this.getName("width"),"width"),"height"!==this.getName("height")&&this.renameSignal(this.getName("height"),"height")}parseLegends(){ubt(this)}assembleEncodeFromView(t){const{style:e,...n}=t,r={};for(const t of Xot(n)){const e=n[t];void 0!==e&&(r[t]=Xlt(e))}return r}assembleGroupEncodeEntry(t){let e={};return this.view&&(e=this.assembleEncodeFromView(this.view)),t||(this.description&&(e.description=Xlt(this.description)),"unit"!==this.type&&"layer"!==this.type)?Yot(e)?void 0:e:{width:this.getSizeSignalRef("width"),height:this.getSizeSignalRef("height"),...e}}assembleLayout(){if(!this.layout)return;const{spacing:t,...e}=this.layout,{component:n,config:r}=this,i=function(t,e){const n={};for(const r of fat){const i=t[r];if(i?.facetFieldDef){const{titleAnchor:t,titleOrient:o}=Tyt(["titleAnchor","titleOrient"],i.facetFieldDef.header,e,r),s=Myt(r,o),a=Uyt(t,s);void 0!==a&&(n[s]=a)}}return Yot(n)?void 0:n}(n.layoutHeaders,r);return{padding:t,...this.assembleDefaultLayout(),...e,...i?{titleBand:i}:{}}}assembleDefaultLayout(){return{}}assembleHeaderMarks(){const{layoutHeaders:t}=this.component;let e=[];for(const n of fat)t[n].title&&e.push($yt(this,n));for(const t of Iyt)e=e.concat(Byt(this,t));return e}assembleAxes(){return function(t,e){const{x:n=[],y:r=[]}=t;return[...n.map((t=>yyt(t,"grid",e))),...r.map((t=>yyt(t,"grid",e))),...n.map((t=>yyt(t,"main",e))),...r.map((t=>yyt(t,"main",e)))].filter((t=>t))}(this.component.axes,this.config)}assembleLegends(){return dbt(this)}assembleProjections(){return jvt(t=this)||zvt(t)?function(t){return t.children.reduce(((t,e)=>t.concat(e.assembleProjections())),pbt(t))}(t):pbt(t);var t}assembleTitle(){const{encoding:t,...e}=this.title??{},n={...Rlt(this.config.title).nonMarkTitleProperties,...e,...t?{encode:{update:t}}:{}};if(n.text)return Bot(["unit","layer"],this.type)?Bot(["middle",void 0],n.anchor)&&(n.frame??(n.frame="group")):n.anchor??(n.anchor="start"),Yot(n)?void 0:n}assembleGroup(t=[]){const e={};(t=t.concat(this.assembleSignals())).length>0&&(e.signals=t);const n=this.assembleLayout();n&&(e.layout=n),e.marks=[].concat(this.assembleHeaderMarks(),this.assembleMarks());const r=!this.parent||Pvt(this.parent)?gvt(this):[];r.length>0&&(e.scales=r);const i=this.assembleAxes();i.length>0&&(e.axes=i);const o=this.assembleLegends();return o.length>0&&(e.legends=o),e}getName(t){return Zot((this.name?`${this.name}_`:"")+t)}getDataName(t){return this.getName(Dmt[t].toLowerCase())}requestDataName(t){const e=this.getDataName(t),n=this.component.data.outputNodeRefCounts;return n[e]=(n[e]||0)+1,e}getSizeSignalRef(t){if(Pvt(this.parent)){const e=elt(Yyt(t)),n=this.component.scales[e];if(n&&!n.merged){const t=n.get("type"),r=n.get("range");if(Pct(t)&&jlt(r)){const t=n.get("name"),r=pvt(mvt(this,e));return r?{signal:Gyt(t,n,_ft({aggregate:"distinct",field:r},{expr:"datum"}))}:(zut(put(e)),null)}}}return{signal:this.signalNameMap.get(this.getName(t))}}lookupDataSource(t){const e=this.component.data.outputNodes[t];return e?e.getSource():t}getSignalName(t){return this.signalNameMap.get(t)}renameSignal(t,e){this.signalNameMap.rename(t,e)}renameScale(t,e){this.scaleNameMap.rename(t,e)}renameProjection(t,e){this.projectionNameMap.rename(t,e)}scaleName(t,e){return e?this.getName(t):kat(t)&&glt(t)&&this.component.scales[t]||this.scaleNameMap.has(this.getName(t))?this.scaleNameMap.get(this.getName(t)):void 0}projectionName(t){return t?this.getName("projection"):this.component.projection&&!this.component.projection.merged||this.projectionNameMap.has(this.getName("projection"))?this.projectionNameMap.get(this.getName("projection")):void 0}getScaleComponent(t){if(!this.component.scales)throw new Error("getScaleComponent cannot be called before parseScale(). Make sure you have called parseScale or use parseUnitModelWithScale().");const e=this.component.scales[t];return e&&!e.merged?e:this.parent?this.parent.getScaleComponent(t):void 0}getSelectionComponent(t,e){let n=this.component.selection[t];if(!n&&this.parent&&(n=this.parent.getSelectionComponent(t,e)),!n)throw new Error(`Cannot find a selection named "${e}".`);return n}hasAxisOrientSignalRef(){return this.component.axes.x?.some((t=>t.hasOrientSignalRef()))||this.component.axes.y?.some((t=>t.hasOrientSignalRef()))}}class Vvt extends Uvt{vgField(t,e={}){const n=this.fieldDef(t);if(n)return _ft(n,e)}reduceFieldDef(t,e){return function(t,e,n,r){return t?Xot(t).reduce(((n,i)=>{const o=t[i];return Q$(o)?o.reduce(((t,n)=>e.call(r,t,n,i)),n):e.call(r,n,o,i)}),n):n}(this.getMapping(),((e,n,r)=>{const i=Tft(n);return i?t(e,i,r):e}),e)}forEachFieldDef(t,e){odt(this.getMapping(),((e,n)=>{const r=Tft(e);r&&t(r,n)}),e)}}class qvt extends Fmt{clone(){return new qvt(null,Tot(this.transform))}constructor(t,e){super(t),this.transform=e,this.transform=Tot(e);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??"value",n[1]??"density"];const r=this.transform.resolve??"shared";this.transform.resolve=r}dependentFields(){return new Set([this.transform.density,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`DensityTransform ${Fot(this.transform)}`}assemble(){const{density:t,...e}=this.transform,n={type:"kde",field:t,...e};return n.resolve=this.transform.resolve,n}}class Wvt extends Fmt{clone(){return new Wvt(null,Tot(this.transform))}constructor(t,e){super(t),this.transform=e,this.transform=Tot(e)}dependentFields(){return new Set([this.transform.extent])}producedFields(){return new Set([])}hash(){return`ExtentTransform ${Fot(this.transform)}`}assemble(){const{extent:t,param:e}=this.transform;return{type:"extent",field:t,signal:e}}}class Hvt extends Fmt{clone(){return new Hvt(null,{...this.filter})}constructor(t,e){super(t),this.filter=e}static make(t,e){const{config:n,mark:r,markDef:i}=e;if("filter"!==eut("invalid",i,n))return null;const o=e.reduceFieldDef(((t,n,i)=>{const o=glt(i)&&e.getScaleComponent(i);return o&&zct(o.get("type"))&&"count"!==n.aggregate&&!Fht(r)&&(t[n.field]=n),t}),{});return Xot(o).length?new Hvt(t,o):null}dependentFields(){return new Set(Xot(this.filter))}producedFields(){return new Set}hash(){return`FilterInvalid ${Fot(this.filter)}`}assemble(){const t=Xot(this.filter).reduce(((t,e)=>{const n=this.filter[e],r=_ft(n,{expr:"datum"});return null!==n&&("temporal"===n.type?t.push(`(isDate(${r}) || (isValid(${r}) && isFinite(+${r})))`):"quantitative"===n.type&&(t.push(`isValid(${r})`),t.push(`isFinite(+${r})`))),t}),[]);return t.length>0?{type:"filter",expr:t.join(" && ")}:null}}class Gvt extends Fmt{clone(){return new Gvt(this.parent,Tot(this.transform))}constructor(t,e){super(t),this.transform=e,this.transform=Tot(e);const{flatten:n,as:r=[]}=this.transform;this.transform.as=n.map(((t,e)=>r[e]??t))}dependentFields(){return new Set(this.transform.flatten)}producedFields(){return new Set(this.transform.as)}hash(){return`FlattenTransform ${Fot(this.transform)}`}assemble(){const{flatten:t,as:e}=this.transform;return{type:"flatten",fields:t,as:e}}}class Yvt extends Fmt{clone(){return new Yvt(null,Tot(this.transform))}constructor(t,e){super(t),this.transform=e,this.transform=Tot(e);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??"key",n[1]??"value"]}dependentFields(){return new Set(this.transform.fold)}producedFields(){return new Set(this.transform.as)}hash(){return`FoldTransform ${Fot(this.transform)}`}assemble(){const{fold:t,as:e}=this.transform;return{type:"fold",fields:t,as:e}}}class Xvt extends Fmt{clone(){return new Xvt(null,Tot(this.fields),this.geojson,this.signal)}static parseAll(t,e){if(e.component.projection&&!e.component.projection.isFit)return t;let n=0;for(const r of[[Fst,$st],[Bst,Lst]]){const i=r.map((t=>{const n=Ift(e.encoding[t]);return lft(n)?n.field:cft(n)?{expr:`${n.datum}`}:gft(n)?{expr:`${n.value}`}:void 0}));(i[0]||i[1])&&(t=new Xvt(t,i,null,e.getName("geojson_"+n++)))}if(e.channelHasField(jst)){const r=e.typedFieldDef(jst);r.type===Cct&&(t=new Xvt(t,null,r.field,e.getName("geojson_"+n++)))}return t}constructor(t,e,n,r){super(t),this.fields=e,this.geojson=n,this.signal=r}dependentFields(){const t=(this.fields??[]).filter(XF);return new Set([...this.geojson?[this.geojson]:[],...t])}producedFields(){return new Set}hash(){return`GeoJSON ${this.geojson} ${this.signal} ${Fot(this.fields)}`}assemble(){return[...this.geojson?[{type:"filter",expr:`isValid(datum["${this.geojson}"])`}]:[],{type:"geojson",...this.fields?{fields:this.fields}:{},...this.geojson?{geojson:this.geojson}:{},signal:this.signal}]}}class Jvt extends Fmt{clone(){return new Jvt(null,this.projection,Tot(this.fields),Tot(this.as))}constructor(t,e,n,r){super(t),this.projection=e,this.fields=n,this.as=r}static parseAll(t,e){if(!e.projectionName())return t;for(const n of[[Fst,$st],[Bst,Lst]]){const r=n.map((t=>{const n=Ift(e.encoding[t]);return lft(n)?n.field:cft(n)?{expr:`${n.datum}`}:gft(n)?{expr:`${n.value}`}:void 0})),i=n[0]===Bst?"2":"";(r[0]||r[1])&&(t=new Jvt(t,e.projectionName(),r,[e.getName(`x${i}`),e.getName(`y${i}`)]))}return t}dependentFields(){return new Set(this.fields.filter(XF))}producedFields(){return new Set(this.as)}hash(){return`Geopoint ${this.projection} ${Fot(this.fields)} ${Fot(this.as)}`}assemble(){return{type:"geopoint",projection:this.projection,fields:this.fields,as:this.as}}}class Kvt extends Fmt{clone(){return new Kvt(null,Tot(this.transform))}constructor(t,e){super(t),this.transform=e}dependentFields(){return new Set([this.transform.impute,this.transform.key,...this.transform.groupby??[]])}producedFields(){return new Set([this.transform.impute])}processSequence(t){const{start:e=0,stop:n,step:r}=t;return{signal:`sequence(${[e,n,...r?[r]:[]].join(",")})`}}static makeFromTransform(t,e){return new Kvt(t,e)}static makeFromEncoding(t,e){const n=e.encoding,r=n.x,i=n.y;if(lft(r)&&lft(i)){const o=r.impute?r:i.impute?i:void 0;if(void 0===o)return;const s=r.impute?i:i.impute?r:void 0,{method:a,value:l,frame:u,keyvals:c}=o.impute,h=sdt(e.mark,n);return new Kvt(t,{impute:o.field,key:s.field,...a?{method:a}:{},...void 0!==l?{value:l}:{},...u?{frame:u}:{},...void 0!==c?{keyvals:c}:{},...h.length?{groupby:h}:{}})}return null}hash(){return`Impute ${Fot(this.transform)}`}assemble(){const{impute:t,key:e,keyvals:n,method:r,groupby:i,value:o,frame:s=[null,null]}=this.transform,a={type:"impute",field:t,key:e,...n?{keyvals:Lpt(n)?this.processSequence(n):n}:{},method:"value",...i?{groupby:i}:{},value:r&&"value"!==r?null:o};return r&&"value"!==r?[a,{type:"window",as:[`imputed_${t}_value`],ops:[r],fields:[t],frame:s,ignorePeers:!1,...i?{groupby:i}:{}},{type:"formula",expr:`datum.${t} === null ? datum.imputed_${t}_value : datum.${t}`,as:t}]:[a]}}class Qvt extends Fmt{clone(){return new Qvt(null,Tot(this.transform))}constructor(t,e){super(t),this.transform=e,this.transform=Tot(e);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??e.on,n[1]??e.loess]}dependentFields(){return new Set([this.transform.loess,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`LoessTransform ${Fot(this.transform)}`}assemble(){const{loess:t,on:e,...n}=this.transform;return{type:"loess",x:e,y:t,...n}}}class Zvt extends Fmt{clone(){return new Zvt(null,Tot(this.transform),this.secondary)}constructor(t,e,n){super(t),this.transform=e,this.secondary=n}static make(t,e,n,r){const i=e.component.data.sources,{from:o}=n;let s=null;if(function(t){return"data"in t}(o)){let t=dwt(o.data,i);t||(t=new Tbt(o.data),i.push(t));const n=e.getName(`lookup_${r}`);s=new Lmt(t,n,Dmt.Lookup,e.component.data.outputNodeRefCounts),e.component.data.outputNodes[n]=s}else if(function(t){return"param"in t}(o)){const t=o.param;let r;n={as:t,...n};try{r=e.getSelectionComponent(Zot(t),t)}catch(e){throw new Error(`Lookups can only be performed on selection parameters. "${t}" is a variable parameter.`)}if(s=r.materialized,!s)throw new Error(`Cannot define and lookup the "${t}" selection in the same view. Try moving the lookup into a second, layered view?`)}return new Zvt(t,n,s.getSource())}dependentFields(){return new Set([this.transform.lookup])}producedFields(){return new Set(this.transform.as?kF(this.transform.as):this.transform.from.fields)}hash(){return`Lookup ${Fot({transform:this.transform,secondary:this.secondary})}`}assemble(){let t;if(this.transform.from.fields)t={values:this.transform.from.fields,...this.transform.as?{as:kF(this.transform.as)}:{}};else{let e=this.transform.as;XF(e)||(zut('If "from.fields" is not specified, "as" has to be a string that specifies the key to be used for the data from the secondary source.'),e="_lookup"),t={as:[e]}}return{type:"lookup",from:this.secondary,key:this.transform.from.key,fields:[this.transform.lookup],...t,...this.transform.default?{default:this.transform.default}:{}}}}class twt extends Fmt{clone(){return new twt(null,Tot(this.transform))}constructor(t,e){super(t),this.transform=e,this.transform=Tot(e);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??"prob",n[1]??"value"]}dependentFields(){return new Set([this.transform.quantile,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`QuantileTransform ${Fot(this.transform)}`}assemble(){const{quantile:t,...e}=this.transform;return{type:"quantile",field:t,...e}}}class ewt extends Fmt{clone(){return new ewt(null,Tot(this.transform))}constructor(t,e){super(t),this.transform=e,this.transform=Tot(e);const n=this.transform.as??[void 0,void 0];this.transform.as=[n[0]??e.on,n[1]??e.regression]}dependentFields(){return new Set([this.transform.regression,this.transform.on,...this.transform.groupby??[]])}producedFields(){return new Set(this.transform.as)}hash(){return`RegressionTransform ${Fot(this.transform)}`}assemble(){const{regression:t,on:e,...n}=this.transform;return{type:"regression",x:e,y:t,...n}}}class nwt extends Fmt{clone(){return new nwt(null,Tot(this.transform))}constructor(t,e){super(t),this.transform=e}addDimensions(t){this.transform.groupby=Uot((this.transform.groupby??[]).concat(t),(t=>t))}producedFields(){}dependentFields(){return new Set([this.transform.pivot,this.transform.value,...this.transform.groupby??[]])}hash(){return`PivotTransform ${Fot(this.transform)}`}assemble(){const{pivot:t,value:e,groupby:n,limit:r,op:i}=this.transform;return{type:"pivot",field:t,value:e,...void 0!==r?{limit:r}:{},...void 0!==i?{op:i}:{},...void 0!==n?{groupby:n}:{}}}}class rwt extends Fmt{clone(){return new rwt(null,Tot(this.transform))}constructor(t,e){super(t),this.transform=e}dependentFields(){return new Set}producedFields(){return new Set}hash(){return`SampleTransform ${Fot(this.transform)}`}assemble(){return{type:"sample",size:this.transform.sample}}}function iwt(t){let e=0;return function n(r,i){if(r instanceof Tbt&&!r.isGenerator&&!xmt(r.data)&&(t.push(i),i={name:null,source:i.name,transform:[]}),r instanceof Cbt&&(r.parent instanceof Tbt&&!i.source?(i.format={...i.format,parse:r.assembleFormatParse()},i.transform.push(...r.assembleTransforms(!0))):i.transform.push(...r.assembleTransforms())),r instanceof Sbt)return i.name||(i.name="data_"+e++),!i.source||i.transform.length>0?(t.push(i),r.data=i.name):r.data=i.source,void t.push(...r.assemble());switch((r instanceof Mbt||r instanceof Obt||r instanceof Hvt||r instanceof fyt||r instanceof Cyt||r instanceof Jvt||r instanceof kbt||r instanceof Zvt||r instanceof Kbt||r instanceof Xbt||r instanceof Yvt||r instanceof Gvt||r instanceof qvt||r instanceof Qvt||r instanceof twt||r instanceof ewt||r instanceof Dbt||r instanceof rwt||r instanceof nwt||r instanceof Wvt)&&i.transform.push(r.assemble()),(r instanceof _bt||r instanceof Pmt||r instanceof Kvt||r instanceof Jbt||r instanceof Xvt)&&i.transform.push(...r.assemble()),r instanceof Lmt&&(i.source&&0===i.transform.length?r.setSource(i.source):r.parent instanceof Lmt?r.setSource(i.name):(i.name||(i.name="data_"+e++),r.setSource(i.name),1===r.numChildren()&&(t.push(i),i={name:null,source:i.name,transform:[]}))),r.numChildren()){case 0:r instanceof Lmt&&(!i.source||i.transform.length>0)&&t.push(i);break;case 1:n(r.children[0],i);break;default:{i.name||(i.name="data_"+e++);let o=i.name;!i.source||i.transform.length>0?t.push(i):o=i.source;for(const t of r.children)n(t,{name:null,source:o,transform:[]});break}}}}function owt(t,e){const{facet:n,config:r,child:i,component:o}=t;if(t.channelHasField(e)){const s=n[e],a=Oyt("title",null,r,e);let l=Cft(s,r,{allowDisabling:!0,includeDefault:void 0===a||!!a});i.component.layoutHeaders[e].title&&(l=Q$(l)?l.join(", "):l,l+=` / ${i.component.layoutHeaders[e].title}`,i.component.layoutHeaders[e].title=null);const u=Oyt("labelOrient",s.header,r,e),c=null!==s.header&&cst(s.header?.labels,r.header.labels,!0),h=Bot(["bottom","right"],u)?"footer":"header";o.layoutHeaders[e]={title:null!==s.header?l:null,facetFieldDef:s,[h]:"facet"===e?[]:[swt(t,e,c)]}}}function swt(t,e,n){const r="row"===e?"height":"width";return{labels:n,sizeSignal:t.child.component.layoutSize.get(r)?t.child.getSizeSignalRef(r):void 0,axes:[]}}function awt(t,e){const{child:n}=t;if(n.component.axes[e]){const{layoutHeaders:i,resolve:o}=t.component;if(o.axis[e]=Kyt(o,e),"shared"===o.axis[e]){const o="x"===e?"column":"row",s=i[o];for(const i of n.component.axes[e]){const e="top"===(r=i.get("orient"))||"left"===r||zlt(r)?"header":"footer";s[e]??(s[e]=[swt(t,o,!1)]);const n=yyt(i,"main",t.config,{header:!0});n&&s[e][0].axes.push(n),i.mainExtracted=!0}}}var r}function lwt(t){for(const e of t.children)e.parseLayoutSize()}function uwt(t,e){const n=Yyt(e),r=elt(n),i=t.component.resolve,o=t.component.layoutSize;let s;for(const e of t.children){const o=e.component.layoutSize.getWithExplicit(n),a=i.scale[r]??Jyt(r,t);if("independent"===a&&"step"===o.value){s=void 0;break}if(s){if("independent"===a&&s.value!==o.value){s=void 0;break}s=vmt(s,o,n,"")}else s=o}if(s){for(const r of t.children)t.renameSignal(r.getName(n),t.getName(e)),r.component.layoutSize.set(n,"merged",!1);o.setWithExplicit(e,s)}else o.setWithExplicit(e,{explicit:!1,value:void 0})}function cwt(t,e){const n="width"===e?"x":"y",r=t.config,i=t.getScaleComponent(n);if(i){const t=i.get("type"),n=i.get("range");if(Pct(t)){const t=Qdt(r.view,e);return jlt(n)||Gdt(t)?"step":t}return Jdt(r.view,e)}if(t.hasProjection||"arc"===t.mark)return Jdt(r.view,e);{const t=Qdt(r.view,e);return Gdt(t)?t.step:t}}function hwt(t,e,n){return _ft(e,{suffix:`by_${_ft(t)}`,...n})}class fwt extends Vvt{constructor(t,e,n,r){super(t,"facet",e,n,r,t.resolve),this.child=Bwt(t.spec,this,this.getName("child"),void 0,r),this.children=[this.child],this.facet=this.initFacet(t.facet)}initFacet(t){if(!Jht(t))return{facet:this.initFacetFieldDef(t,"facet")};const e=Xot(t),n={};for(const r of e){if(![xst,_st].includes(r)){zut(Eut(r,"facet"));break}const e=t[r];if(void 0===e.field){zut(Sut(e,r));break}n[r]=this.initFacetFieldDef(e,r)}return n}initFacetFieldDef(t,e){const n=Fft(t,e);return n.header?n.header=Blt(n.header):null===n.header&&(n.header=null),n}channelHasField(t){return!!this.facet[t]}fieldDef(t){return this.facet[t]}parseData(){this.component.data=pwt(this),this.child.parseData()}parseLayoutSize(){lwt(this)}parseSelections(){this.child.parseSelections(),this.component.selection=this.child.component.selection}parseMarkGroup(){this.child.parseMarkGroup()}parseAxesAndHeaders(){this.child.parseAxesAndHeaders(),function(t){for(const e of fat)owt(t,e);awt(t,"x"),awt(t,"y")}(this)}assembleSelectionTopLevelSignals(t){return this.child.assembleSelectionTopLevelSignals(t)}assembleSignals(){return this.child.assembleSignals(),[]}assembleSelectionData(t){return this.child.assembleSelectionData(t)}getHeaderLayoutMixins(){const t={};for(const e of fat)for(const n of Nyt){const r=this.component.layoutHeaders[e],i=r[n],{facetFieldDef:o}=r;if(o){const n=Oyt("titleOrient",o.header,this.config,e);if(["right","bottom"].includes(n)){const r=Myt(e,n);t.titleAnchor??(t.titleAnchor={}),t.titleAnchor[r]="end"}}if(i?.[0]){const i="row"===e?"height":"width",o="header"===n?"headerBand":"footerBand";"facet"===e||this.child.component.layoutSize.get(i)||(t[o]??(t[o]={}),t[o][e]=.5),r.title&&(t.offset??(t.offset={}),t.offset["row"===e?"rowTitle":"columnTitle"]=10)}}return t}assembleDefaultLayout(){const{column:t,row:e}=this.facet,n=t?this.columnDistinctSignal():e?1:void 0;let r="all";return(e||"independent"!==this.component.resolve.scale.x)&&(t||"independent"!==this.component.resolve.scale.y)||(r="none"),{...this.getHeaderLayoutMixins(),...n?{columns:n}:{},bounds:"full",align:r}}assembleLayoutSignals(){return this.child.assembleLayoutSignals()}columnDistinctSignal(){if(!(this.parent&&this.parent instanceof fwt))return{signal:`length(data('${this.getName("column_domain")}'))`}}assembleGroupStyle(){}assembleGroup(t){return this.parent&&this.parent instanceof fwt?{...this.channelHasField("column")?{encode:{update:{columns:{field:_ft(this.facet.column,{prefix:"distinct"})}}}}:{},...super.assembleGroup(t)}:super.assembleGroup(t)}getCardinalityAggregateForChild(){const t=[],e=[],n=[];if(this.child instanceof fwt){if(this.child.channelHasField("column")){const r=_ft(this.child.facet.column);t.push(r),e.push("distinct"),n.push(`distinct_${r}`)}}else for(const r of Kat){const i=this.child.component.scales[r];if(i&&!i.merged){const o=i.get("type"),s=i.get("range");if(Pct(o)&&jlt(s)){const i=pvt(mvt(this.child,r));i?(t.push(i),e.push("distinct"),n.push(`distinct_${i}`)):zut(put(r))}}}return{fields:t,ops:e,as:n}}assembleFacet(){const{name:t,data:e}=this.component.data.facetRoot,{row:n,column:r}=this.facet,{fields:i,ops:o,as:s}=this.getCardinalityAggregateForChild(),a=[];for(const t of fat){const e=this.facet[t];if(e){a.push(_ft(e));const{bin:l,sort:u}=e;if(Tlt(l)&&a.push(_ft(e,{binSuffix:"end"})),Yht(u)){const{field:t,op:a=qht}=u,l=hwt(e,u);n&&r?(i.push(l),o.push("max"),s.push(l)):(i.push(t),o.push(a),s.push(l))}else if(Q$(u)){const n=Dyt(e,t);i.push(n),o.push("max"),s.push(n)}}}const l=!!n&&!!r;return{name:t,data:e,groupby:a,...l||i.length>0?{aggregate:{...l?{cross:l}:{},...i.length?{fields:i,ops:o,as:s}:{}}}:{}}}facetSortFields(t){const{facet:e}=this,n=e[t];return n?Yht(n.sort)?[hwt(n,n.sort,{expr:"datum"})]:Q$(n.sort)?[Dyt(n,t,{expr:"datum"})]:[_ft(n,{expr:"datum"})]:[]}facetSortOrder(t){const{facet:e}=this,n=e[t];if(n){const{sort:t}=n;return[(Yht(t)?t.order:!Q$(t)&&t)||"ascending"]}return[]}assembleLabelTitle(){const{facet:t,config:e}=this;if(t.facet)return Pyt(t.facet,"facet",e);const n={row:["top","bottom"],column:["left","right"]};for(const r of Iyt)if(t[r]){const i=Oyt("labelOrient",t[r]?.header,e,r);if(n[r].includes(i))return Pyt(t[r],r,e)}}assembleMarks(){const{child:t}=this,e=function(t){const e=[],n=iwt(e);for(const e of t.children)n(e,{source:t.name,name:null,transform:[]});return e}(this.component.data.facetRoot),n=t.assembleGroupEncodeEntry(!1),r=this.assembleLabelTitle()||t.assembleTitle(),i=t.assembleGroupStyle();return[{name:this.getName("cell"),type:"group",...r?{title:r}:{},...i?{style:i}:{},from:{facet:this.assembleFacet()},sort:{field:fat.map((t=>this.facetSortFields(t))).flat(),order:fat.map((t=>this.facetSortOrder(t))).flat()},...e.length>0?{data:e}:{},...n?{encode:{update:n}}:{},...t.assembleGroup(Imt(this,[]))}]}getMapping(){return this.facet}}function dwt(t,e){for(const n of e){const e=n.data;if(t.name&&n.hasName()&&t.name!==n.dataName)continue;const r=t.format?.mesh,i=e.format?.feature;if(r&&i)continue;const o=t.format?.feature;if((o||i)&&o!==i)continue;const s=e.format?.mesh;if(!r&&!s||r===s)if(_mt(t)&&_mt(e)){if(vst(t.values,e.values))return n}else if(xmt(t)&&xmt(e)){if(t.url===e.url)return n}else if(kmt(t)&&t.name===n.dataName)return n}return null}function pwt(t){let e=function(t,e){if(t.data||!t.parent){if(null===t.data){const t=new Tbt({values:[]});return e.push(t),t}const n=dwt(t.data,e);if(n)return Smt(t.data)||(n.data.format=zot({},t.data.format,n.data.format)),!n.hasName()&&t.data.name&&(n.dataName=t.data.name),n;{const n=new Tbt(t.data);return e.push(n),n}}return t.parent.component.data.facetRoot?t.parent.component.data.facetRoot:t.parent.component.data.main}(t,t.component.data.sources);const{outputNodes:n,outputNodeRefCounts:r}=t.component.data,i=t.data,o=i&&(Smt(i)||xmt(i)||_mt(i))||!t.parent?new wmt:t.parent.component.data.ancestorParse.clone();Smt(i)?(Emt(i)?e=new Obt(e,i.sequence):Cmt(i)&&(e=new Mbt(e,i.graticule)),o.parseNothing=!0):null===i?.format?.parse&&(o.parseNothing=!0),e=Cbt.makeExplicit(e,t,o)??e,e=new Dbt(e);const s=t.parent&&jvt(t.parent);(Rvt(t)||Pvt(t))&&s&&(e=_bt.makeFromEncoding(e,t)??e),t.transforms.length>0&&(e=function(t,e,n){let r=0;for(const i of e.transforms){let o,s;if(Gpt(i))s=t=new Cyt(t,i),o="derived";else if(Fpt(i)){const r=Abt(i);s=t=Cbt.makeWithAncestors(t,{},r,n)??t,t=new fyt(t,e,i.filter)}else if(Ypt(i))s=t=_bt.makeFromTransform(t,i,e),o="number";else if(Jpt(i))o="date",void 0===n.getWithExplicit(i.field).value&&(t=new Cbt(t,{[i.field]:o}),n.set(i.field,o,!1)),s=t=Pmt.makeFromTransform(t,i);else if(Kpt(i))s=t=kbt.makeFromTransform(t,i),o="number",ayt(e)&&(t=new Dbt(t));else if(Bpt(i))s=t=Zvt.make(t,e,i,r++),o="derived";else if(qpt(i))s=t=new Kbt(t,i),o="number";else if(Wpt(i))s=t=new Xbt(t,i),o="number";else if(Qpt(i))s=t=Jbt.makeFromTransform(t,i),o="derived";else if(Zpt(i))s=t=new Yvt(t,i),o="derived";else if(tmt(i))s=t=new Wvt(t,i),o="derived";else if(Hpt(i))s=t=new Gvt(t,i),o="derived";else if(Rpt(i))s=t=new nwt(t,i),o="derived";else if(Vpt(i))t=new rwt(t,i);else if(Xpt(i))s=t=Kvt.makeFromTransform(t,i),o="derived";else if(Ppt(i))s=t=new qvt(t,i),o="derived";else if(zpt(i))s=t=new twt(t,i),o="derived";else if(jpt(i))s=t=new ewt(t,i),o="derived";else{if(!Upt(i)){zut(`Ignoring an invalid transform: ${wst(i)}.`);continue}s=t=new Qvt(t,i),o="derived"}if(s&&void 0!==o)for(const t of s.producedFields()??[])n.set(t,o,!1)}return t}(e,t,o));const a=function(t){const e={};if(Rvt(t)&&t.component.selection)for(const n of Xot(t.component.selection)){const r=t.component.selection[n];for(const t of r.project.items)!t.channel&&ust(t.field)>1&&(e[t.field]="flatten")}return e}(t),l=function(t){const e={};function n(t){Rft(t)?e[t.field]="date":"quantitative"===t.type&&function(t){return XF(t)&&Bot(["min","max"],t)}(t.aggregate)?e[t.field]="number":ust(t.field)>1?t.field in e||(e[t.field]="flatten"):yft(t)&&Yht(t.sort)&&ust(t.sort.field)>1&&(t.sort.field in e||(e[t.sort.field]="flatten"))}if((Rvt(t)||Pvt(t))&&t.forEachFieldDef(((e,r)=>{if(mft(e))n(e);else{const i=Aat(r),o=t.fieldDef(i);n({...e,type:o.type})}})),Rvt(t)){const{mark:n,markDef:r,encoding:i}=t;if(Fht(n)&&!t.encoding.order){const t=i["horizontal"===r.orient?"y":"x"];lft(t)&&"quantitative"===t.type&&!(t.field in e)&&(e[t.field]="number")}}return e}(t);e=Cbt.makeWithAncestors(e,{},{...a,...l},o)??e,Rvt(t)&&(e=Xvt.parseAll(e,t),e=Jvt.parseAll(e,t)),(Rvt(t)||Pvt(t))&&(s||(e=_bt.makeFromEncoding(e,t)??e),e=Pmt.makeFromEncoding(e,t)??e,e=Cyt.parseAllForSortIndex(e,t));const u=e=mwt(Dmt.Raw,t,e);if(Rvt(t)){const n=kbt.makeFromEncoding(e,t);n&&(e=n,ayt(t)&&(e=new Dbt(e))),e=Kvt.makeFromEncoding(e,t)??e,e=Jbt.makeFromEncoding(e,t)??e}Rvt(t)&&(e=Hvt.make(e,t)??e);const c=e=mwt(Dmt.Main,t,e);Rvt(t)&&function(t,e){for(const[n,r]of Kot(t.component.selection??{})){const i=t.getName(`lookup_${n}`);t.component.data.outputNodes[i]=r.materialized=new Lmt(new fyt(e,t,{param:n}),i,Dmt.Lookup,t.component.data.outputNodeRefCounts)}}(t,c);let h=null;if(Pvt(t)){const r=t.getName("facet");e=function(t,e){const{row:n,column:r}=e;if(n&&r){let e=null;for(const i of[n,r])if(Yht(i.sort)){const{field:n,op:r=qht}=i.sort;t=e=new Xbt(t,{joinaggregate:[{op:r,field:n,as:hwt(i,i.sort,{forAs:!0})}],groupby:[_ft(i)]})}return e}return null}(e,t.facet)??e,h=new Sbt(e,t,r,c.getSource()),n[r]=h}return{...t.component.data,outputNodes:n,outputNodeRefCounts:r,raw:u,main:c,facetRoot:h,ancestorParse:o}}function mwt(t,e,n){const{outputNodes:r,outputNodeRefCounts:i}=e.component.data,o=e.getDataName(t),s=new Lmt(n,o,t,i);return r[o]=s,s}class gwt extends Uvt{constructor(t,e,n,r){super(t,"concat",e,n,r,t.resolve),"shared"!==t.resolve?.axis?.x&&"shared"!==t.resolve?.axis?.y||zut("Axes cannot be shared in concatenated or repeated views yet (https://github.com/vega/vega-lite/issues/2415)."),this.children=this.getChildren(t).map(((t,e)=>Bwt(t,this,this.getName(`concat_${e}`),void 0,r)))}parseData(){this.component.data=pwt(this);for(const t of this.children)t.parseData()}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const e of Xot(t.component.selection))this.component.selection[e]=t.component.selection[e]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){for(const t of this.children)t.parseAxesAndHeaders()}getChildren(t){return qdt(t)?t.vconcat:Wdt(t)?t.hconcat:t.concat}parseLayoutSize(){!function(t){lwt(t);const e=1===t.layout.columns?"width":"childWidth",n=void 0===t.layout.columns?"height":"childHeight";uwt(t,e),uwt(t,n)}(this)}parseAxisGroup(){return null}assembleSelectionTopLevelSignals(t){return this.children.reduce(((t,e)=>e.assembleSelectionTopLevelSignals(t)),t)}assembleSignals(){return this.children.forEach((t=>t.assembleSignals())),[]}assembleLayoutSignals(){const t=qyt(this);for(const e of this.children)t.push(...e.assembleLayoutSignals());return t}assembleSelectionData(t){return this.children.reduce(((t,e)=>e.assembleSelectionData(t)),t)}assembleMarks(){return this.children.map((t=>{const e=t.assembleTitle(),n=t.assembleGroupStyle(),r=t.assembleGroupEncodeEntry(!1);return{type:"group",name:t.getName("group"),...e?{title:e}:{},...n?{style:n}:{},...r?{encode:{update:r}}:{},...t.assembleGroup()}}))}assembleGroupStyle(){}assembleDefaultLayout(){const t=this.layout.columns;return{...null!=t?{columns:t}:{},bounds:"full",align:"each"}}}const ywt={disable:1,gridScale:1,scale:1,...Hft,labelExpr:1,encode:1},bwt=Xot(ywt);class vwt extends pmt{constructor(t={},e={},n=!1){super(),this.explicit=t,this.implicit=e,this.mainExtracted=n}clone(){return new vwt(Tot(this.explicit),Tot(this.implicit),this.mainExtracted)}hasAxisPart(t){return!("axis"!==t&&("grid"===t||"title"===t?!this.get(t):(e=this.get(t),!1===e||null===e)));var e}hasOrientSignalRef(){return zlt(this.explicit.orient)}}const wwt={bottom:"top",top:"bottom",left:"right",right:"left"};function xwt(t,e){if(!t)return e.map((t=>t.clone()));{if(t.length!==e.length)return;const n=t.length;for(let r=0;r<n;r++){const n=t[r],i=e[r];if(!!n!=!!i)return;if(n&&i){const e=n.getWithExplicit("orient"),o=i.getWithExplicit("orient");if(e.explicit&&o.explicit&&e.value!==o.value)return;t[r]=_wt(n,i)}}}return t}function _wt(t,e){for(const n of bwt){const r=vmt(t.getWithExplicit(n),e.getWithExplicit(n),n,"axis",((t,e)=>{switch(n){case"title":return lut(t,e);case"gridScale":return{explicit:t.explicit,value:cst(t.value,e.value)}}return bmt(t,e,n,"axis")}));t.setWithExplicit(n,r)}return t}function kwt(t,e,n,r,i){if("disable"===e)return void 0!==n;switch(n=n||{},e){case"titleAngle":case"labelAngle":return t===(zlt(n.labelAngle)?n.labelAngle:gst(n.labelAngle));case"values":return!!n.values;case"encode":return!!n.encoding||!!n.labelAngle;case"title":if(t===Ayt(r,i))return!0}return t===n[e]}const Swt=new Set(["grid","translate","format","formatType","orient","labelExpr","tickCount","position","tickMinStep"]);function Ewt(t,e){let n=e.axis(t);const r=new vwt,i=Ift(e.encoding[t]),{mark:o,config:s}=e,a=n?.orient||s["x"===t?"axisX":"axisY"]?.orient||s.axis?.orient||function(t){return"x"===t?"bottom":"left"}(t),l=e.getScaleComponent(t).get("type"),u=function(t,e,n,r){const i="band"===e?["axisDiscrete","axisBand"]:"point"===e?["axisDiscrete","axisPoint"]:Fct(e)?["axisQuantitative"]:"time"===e||"utc"===e?["axisTemporal"]:[],o="x"===t?"axisX":"axisY",s=zlt(n)?"axisOrient":`axis${nst(n)}`,a=[...i,...i.map((t=>o+t.substr(4)))],l=["axis",s,o];return{vlOnlyAxisConfig:vyt(a,r,t,n),vgAxisConfig:vyt(l,r,t,n),axisConfigStyle:wyt([...l,...a],r)}}(t,l,a,e.config),c=void 0!==n?!n:xyt("disable",s.style,n?.style,u).configValue;if(r.set("disable",c,void 0!==n),c)return r;n=n||{};const h=function(t,e,n,r,i){const o=e?.labelAngle;if(void 0!==o)return zlt(o)?o:gst(o);{const{configValue:o}=xyt("labelAngle",r,e?.style,i);return void 0!==o?gst(o):n!==Sst||!Bot([Act,Sct],t.type)||lft(t)&&t.timeUnit?void 0:270}}(i,n,t,s.style,u),f=mht(n.formatType,i,l),d=pht(i,i.type,n.format,n.formatType,s,!0),p={fieldOrDatumDef:i,axis:n,channel:t,model:e,scaleType:l,orient:a,labelAngle:h,format:d,formatType:f,mark:o,config:s};for(const i of bwt){const o=i in _yt?_yt[i](p):Yft(i)?n[i]:void 0,a=void 0!==o,l=kwt(o,i,n,e,t);if(a&&l)r.set(i,o,l);else{const{configValue:t,configFrom:e}=Yft(i)&&"values"!==i?xyt(i,s.style,n.style,u):{},c=void 0!==t;a&&!c?r.set(i,o,l):("vgAxisConfig"!==e||Swt.has(i)&&c||Vft(t)||zlt(t))&&r.set(i,t,!1)}}const m=n.encoding??{},g=qft.reduce(((n,i)=>{if(!r.hasAxisPart(i))return n;const o=Xyt(m[i]??{},e),s="labels"===i?function(t,e,n){const{encoding:r,config:i}=t,o=Ift(r[e])??Ift(r[Dat(e)]),s=t.axis(e)||{},{format:a,formatType:l}=s;if(lht(l))return{text:dht({fieldOrDatumDef:o,field:"datum.value",format:a,formatType:l,config:i}),...n};if(void 0===a&&void 0===l&&i.customFormatTypes){if("quantitative"===uft(o)){if(bft(o)&&"normalize"===o.stack&&i.normalizedNumberFormatType)return{text:dht({fieldOrDatumDef:o,field:"datum.value",format:i.normalizedNumberFormat,formatType:i.normalizedNumberFormatType,config:i}),...n};if(i.numberFormatType)return{text:dht({fieldOrDatumDef:o,field:"datum.value",format:i.numberFormat,formatType:i.numberFormatType,config:i}),...n}}if("temporal"===uft(o)&&i.timeFormatType&&lft(o)&&!o.timeUnit)return{text:dht({fieldOrDatumDef:o,field:"datum.value",format:i.timeFormat,formatType:i.timeFormatType,config:i}),...n}}return n}(e,t,o):o;return void 0===s||Yot(s)||(n[i]={update:s}),n}),{});return Yot(g)||r.set("encode",g,!!n.encoding||void 0!==n.labelAngle),r}function Awt(t,e){const{config:n}=t;return{...Ngt(t,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...wgt("x",t,{defaultPos:"mid"}),...wgt("y",t,{defaultPos:"mid"}),...ggt("size",t),...ggt("angle",t),...Cwt(t,0,e)}}function Cwt(t,e,n){return n?{shape:{value:n}}:ggt("shape",t)}function Dwt(t,e,n){if(void 0===eut("align",t,n))return"center"}function Mwt(t,e,n){if(void 0===eut("baseline",t,n))return"middle"}function Owt(t){const{config:e,markDef:n}=t,{orient:r}=n,i="horizontal"===r?"width":"height",o=t.getScaleComponent("horizontal"===r?"x":"y"),s=eut("size",n,e,{vgChannel:i})??e.tick.bandSize;if(void 0!==s)return s;{const t=o?o.get("range"):void 0;return t&&jlt(t)&&GF(t.step)?3*t.step/4:3*Kdt(e.view,i)/4}}const Twt={arc:{vgMark:"arc",encodeEntry:t=>({...Ngt(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...wgt("x",t,{defaultPos:"mid"}),...wgt("y",t,{defaultPos:"mid"}),...Dgt(t,"radius"),...Dgt(t,"theta")})},area:{vgMark:"area",encodeEntry:t=>({...Ngt(t,{align:"ignore",baseline:"ignore",color:"include",orient:"include",size:"ignore",theta:"ignore"}),...Egt("x",t,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"horizontal"===t.markDef.orient}),...Egt("y",t,{defaultPos:"zeroOrMin",defaultPos2:"zeroOrMin",range:"vertical"===t.markDef.orient}),...Lgt(t)})},bar:{vgMark:"rect",encodeEntry:t=>({...Ngt(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Dgt(t,"x"),...Dgt(t,"y")})},circle:{vgMark:"symbol",encodeEntry:t=>Awt(t,"circle")},geoshape:{vgMark:"shape",encodeEntry:t=>({...Ngt(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"})}),postEncodingTransform:t=>{const{encoding:e}=t,n=e.shape;return[{type:"geoshape",projection:t.projectionName(),...n&&lft(n)&&n.type===Cct?{field:_ft(n,{expr:"datum"})}:{}}]}},image:{vgMark:"image",encodeEntry:t=>({...Ngt(t,{align:"ignore",baseline:"ignore",color:"ignore",orient:"ignore",size:"ignore",theta:"ignore"}),...Dgt(t,"x"),...Dgt(t,"y"),...lgt(t,"url")})},line:{vgMark:"line",encodeEntry:t=>({...Ngt(t,{align:"ignore",baseline:"ignore",color:"include",size:"ignore",orient:"ignore",theta:"ignore"}),...wgt("x",t,{defaultPos:"mid"}),...wgt("y",t,{defaultPos:"mid"}),...ggt("size",t,{vgChannel:"strokeWidth"}),...Lgt(t)})},point:{vgMark:"symbol",encodeEntry:t=>Awt(t)},rect:{vgMark:"rect",encodeEntry:t=>({...Ngt(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Dgt(t,"x"),...Dgt(t,"y")})},rule:{vgMark:"rule",encodeEntry:t=>{const{markDef:e}=t,n=e.orient;return t.encoding.x||t.encoding.y||t.encoding.latitude||t.encoding.longitude?{...Ngt(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...Egt("x",t,{defaultPos:"horizontal"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"vertical"!==n}),...Egt("y",t,{defaultPos:"vertical"===n?"zeroOrMax":"mid",defaultPos2:"zeroOrMin",range:"horizontal"!==n}),...ggt("size",t,{vgChannel:"strokeWidth"})}:{}}},square:{vgMark:"symbol",encodeEntry:t=>Awt(t,"square")},text:{vgMark:"text",encodeEntry:t=>{const{config:e,encoding:n}=t;return{...Ngt(t,{align:"include",baseline:"include",color:"include",size:"ignore",orient:"ignore",theta:"include"}),...wgt("x",t,{defaultPos:"mid"}),...wgt("y",t,{defaultPos:"mid"}),...lgt(t),...ggt("size",t,{vgChannel:"fontSize"}),...ggt("angle",t),...Bgt("align",Dwt(t.markDef,0,e)),...Bgt("baseline",Mwt(t.markDef,0,e)),...wgt("radius",t,{defaultPos:null}),...wgt("theta",t,{defaultPos:null})}}},tick:{vgMark:"rect",encodeEntry:t=>{const{config:e,markDef:n}=t,r=n.orient,i="horizontal"===r?"width":"height",o="horizontal"===r?"height":"width";return{...Ngt(t,{align:"ignore",baseline:"ignore",color:"include",orient:"ignore",size:"ignore",theta:"ignore"}),...wgt("x",t,{defaultPos:"mid",vgChannel:"xc"}),...wgt("y",t,{defaultPos:"mid",vgChannel:"yc"}),...ggt("size",t,{defaultValue:Owt(t),vgChannel:i}),[o]:Xlt(eut("thickness",n,e))}}},trail:{vgMark:"trail",encodeEntry:t=>({...Ngt(t,{align:"ignore",baseline:"ignore",color:"include",size:"include",orient:"ignore",theta:"ignore"}),...wgt("x",t,{defaultPos:"mid"}),...wgt("y",t,{defaultPos:"mid"}),...ggt("size",t),...Lgt(t)})}};const Iwt="faceted_path_",Nwt="stack_group_";function $wt(t,e={fromPrefix:""}){const{mark:n,markDef:r,encoding:i,config:o}=t,s=cst(r.clip,function(t){const e=t.getScaleComponent("x"),n=t.getScaleComponent("y");return!(!e?.get("selectionExtent")&&!n?.get("selectionExtent"))||void 0}(t),function(t){const e=t.component.projection;return!(!e||e.isFit)||void 0}(t)),a=tut(r),l=i.key,u=function(t){const{encoding:e,stack:n,mark:r,markDef:i,config:o}=t,s=e.order;if(!(!Q$(s)&&gft(s)&&Lot(s.value)||!s&&Lot(eut("order",i,o)))){if((Q$(s)||lft(s))&&!n)return out(s,{expr:"datum"});if(Fht(r)){const n="horizontal"===i.orient?"y":"x",r=e[n];if(lft(r)){const e=r.sort;return Q$(e)?{field:_ft(r,{prefix:n,suffix:"sort_index",expr:"datum"})}:Yht(e)?{field:_ft({aggregate:edt(t.encoding)?e.op:void 0,field:e.field},{expr:"datum"})}:Ght(e)?{field:_ft(t.fieldDef(e.encoding),{expr:"datum"}),order:e.order}:null===e?void 0:{field:_ft(r,{binSuffix:t.stack?.impute?"mid":void 0,expr:"datum"})}}}}}(t),c=function(t){if(!t.component.selection)return null;const e=Xot(t.component.selection).length;let n=e,r=t.parent;for(;r&&0===n;)n=Xot(r.component.selection).length,r=r.parent;return n?{interactive:e>0||"geoshape"===t.mark||!!t.encoding.tooltip||!!t.markDef.tooltip}:null}(t),h=eut("aria",r,o),f=Twt[n].postEncodingTransform?Twt[n].postEncodingTransform(t):null;return[{name:t.getName("marks"),type:Twt[n].vgMark,...s?{clip:s}:{},...a?{style:a}:{},...l?{key:l.field}:{},...u?{sort:u}:{},...c||{},...!1===h?{aria:h}:{},from:{data:e.fromPrefix+t.requestDataName(Dmt.Main)},encode:{update:Twt[n].encodeEntry(t)},...f?{transform:f}:{}}]}class Fwt extends Vvt{constructor(t,e,n,r={},i){super(t,"unit",e,n,i,void 0,Ydt(t)?t.view:void 0),this.specifiedScales={},this.specifiedAxes={},this.specifiedLegends={},this.specifiedProjection={},this.selection=[],this.children=[];const o=Rht(t.mark)?{...t.mark}:{type:t.mark},s=o.type;void 0===o.filled&&(o.filled=function(t,e,{graticule:n}){if(n)return!1;const r=nut("filled",t,e),i=t.type;return cst(r,i!==Aht&&i!==Eht&&i!==Dht)}(o,i,{graticule:t.data&&Cmt(t.data)}));const a=this.encoding=function(t,e,n,r){const i={};for(const e of Xot(t))kat(e)||zut(`${o=e}-encoding is dropped as ${o} is not a valid encoding channel.`);var o;for(let o of Nat){if(!t[o])continue;const s=t[o];if(rlt(o)){const t=Iat(o),e=i[t];if(lft(e)&&xct(e.type)&&lft(s)&&!e.timeUnit){zut(xut(t));continue}}if("angle"!==o||"arc"!==e||t.theta||(zut("Arc marks uses theta channel rather than angle, replacing angle with theta."),o=Ist),rdt(t,o,e)){if(o===Ust&&"line"===e){const e=Tft(t[o]);if(e?.aggregate){zut("Line marks cannot encode size with a non-groupby field. You may want to use trail marks instead.");continue}}if(o===Rst&&(n?"fill"in t:"stroke"in t))zut(kut("encoding",{fill:"fill"in t,stroke:"stroke"in t}));else if(o===Kst||o===Jst&&!Q$(s)&&!gft(s)||o===Zst&&Q$(s)){if(s){if(o===Jst){const e=t[o];if(ift(e)){i[o]=e;continue}}i[o]=kF(s).reduce(((t,e)=>(lft(e)?t.push(Fft(e,o)):zut(Sut(e,o)),t)),[])}}else{if(o===Zst&&null===s)i[o]=null;else if(!(lft(s)||cft(s)||gft(s)||oft(s)||zlt(s))){zut(Sut(s,o));continue}i[o]=Nft(s,o,r)}}else zut(Eut(o,e))}return i}(t.encoding||{},s,o.filled,i);this.markDef=vpt(o,a,i),this.size=function({encoding:t,size:e}){for(const n of Kat){const r=Mat(n);Gdt(e[r])&&hft(t[n])&&(delete e[r],zut(Nut(r)))}return e}({encoding:a,size:Ydt(t)?{...r,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}}:r}),this.stack=bpt(this.markDef,a),this.specifiedScales=this.initScales(s,a),this.specifiedAxes=this.initAxes(a),this.specifiedLegends=this.initLegends(a),this.specifiedProjection=t.projection,this.selection=(t.params??[]).filter((t=>jdt(t)))}get hasProjection(){const{encoding:t}=this,e=this.mark===$ht,n=t&&lat.some((e=>pft(t[e])));return e||n}scaleDomain(t){const e=this.specifiedScales[t];return e?e.domain:void 0}axis(t){return this.specifiedAxes[t]}legend(t){return this.specifiedLegends[t]}initScales(t,e){return mlt.reduce(((t,n)=>{const r=Ift(e[n]);return r&&(t[n]=this.initScale(r.scale??{})),t}),{})}initScale(t){const{domain:e,range:n}=t,r=Blt(t);return Q$(e)&&(r.domain=e.map(Glt)),Q$(n)&&(r.range=n.map(Glt)),r}initAxes(t){return Kat.reduce(((e,n)=>{const r=t[n];if(pft(r)||n===Sst&&pft(t.x2)||n===Est&&pft(t.y2)){const t=pft(r)?r.axis:void 0;e[n]=t?this.initAxis({...t}):t}return e}),{})}initAxis(t){const e=Xot(t),n={};for(const r of e){const e=t[r];n[r]=Vft(e)?Hlt(e):Glt(e)}return n}initLegends(t){return dlt.reduce(((e,n)=>{const r=Ift(t[n]);if(r&&function(t){switch(t){case Rst:case Pst:case zst:case Ust:case jst:case qst:case Gst:case Yst:return!0;case Wst:case Hst:case Vst:return!1}}(n)){const t=r.legend;e[n]=t?Blt(t):t}return e}),{})}parseData(){this.component.data=pwt(this)}parseLayoutSize(){!function(t){const{size:e,component:n}=t;for(const r of Kat){const i=Mat(r);if(e[i]){const t=e[i];n.layoutSize.set(i,Gdt(t)?"step":t,!0)}else{const e=cwt(t,i);n.layoutSize.set(i,e,!1)}}}(this)}parseSelections(){this.component.selection=function(t,e){const n={},r=t.config.selection;if(!e||!e.length)return n;for(const i of e){const e=Zot(i.name),o=i.select,s=XF(o)?o:o.type,a=Z$(o)?Tot(o):{type:s},l=r[s];for(const t in l)"fields"!==t&&"encodings"!==t&&("mark"===t&&(a[t]={...l[t],...a[t]}),void 0!==a[t]&&!0!==a[t]||(a[t]=Tot(l[t]??a[t])));const u=n[e]={...a,name:e,type:s,init:i.value,bind:i.bind,events:XF(a.on)?tet(a.on,"scope"):kF(Tot(a.on))},c=Tot(i);for(const e of oyt)e.defined(u)&&e.parse&&e.parse(t,u,c)}return n}(this,this.selection)}parseMarkGroup(){this.component.mark=function(t){if(Bot([Eht,_ht,Tht],t.mark)){const e=sdt(t.mark,t.encoding);if(e.length>0)return function(t,e){return[{name:t.getName("pathgroup"),type:"group",from:{facet:{name:Iwt+t.requestDataName(Dmt.Main),data:t.requestDataName(Dmt.Main),groupby:e}},encode:{update:{width:{field:{group:"width"}},height:{field:{group:"height"}}}},marks:$wt(t,{fromPrefix:Iwt})}]}(t,e)}else if(t.mark===kht){const e=Wlt.some((e=>eut(e,t.markDef,t.config)));if(t.stack&&!t.fieldDef("size")&&e)return function(t){const[e]=$wt(t,{fromPrefix:Nwt}),n=t.scaleName(t.stack.fieldChannel),r=(e={})=>t.vgField(t.stack.fieldChannel,e),i=(t,e)=>`${t}(${[r({prefix:"min",suffix:"start",expr:e}),r({prefix:"max",suffix:"start",expr:e}),r({prefix:"min",suffix:"end",expr:e}),r({prefix:"max",suffix:"end",expr:e})].map((t=>`scale('${n}',${t})`)).join(",")})`;let o,s;"x"===t.stack.fieldChannel?(o={...Not(e.encode.update,["y","yc","y2","height",...Wlt]),x:{signal:i("min","datum")},x2:{signal:i("max","datum")},clip:{value:!0}},s={x:{field:{group:"x"},mult:-1},height:{field:{group:"height"}}},e.encode.update={...$ot(e.encode.update,["y","yc","y2"]),height:{field:{group:"height"}}}):(o={...Not(e.encode.update,["x","xc","x2","width"]),y:{signal:i("min","datum")},y2:{signal:i("max","datum")},clip:{value:!0}},s={y:{field:{group:"y"},mult:-1},width:{field:{group:"width"}}},e.encode.update={...$ot(e.encode.update,["x","xc","x2"]),width:{field:{group:"width"}}});for(const n of Wlt){const r=nut(n,t.markDef,t.config);e.encode.update[n]?(o[n]=e.encode.update[n],delete e.encode.update[n]):r&&(o[n]=Xlt(r)),r&&(e.encode.update[n]={value:0})}const a=[];if(t.stack.groupbyChannels?.length>0)for(const e of t.stack.groupbyChannels){const n=t.fieldDef(e),r=_ft(n);r&&a.push(r),(n?.bin||n?.timeUnit)&&a.push(_ft(n,{binSuffix:"end"}))}return o=["stroke","strokeWidth","strokeJoin","strokeCap","strokeDash","strokeDashOffset","strokeMiterLimit","strokeOpacity"].reduce(((n,r)=>{if(e.encode.update[r])return{...n,[r]:e.encode.update[r]};{const e=nut(r,t.markDef,t.config);return void 0!==e?{...n,[r]:Xlt(e)}:n}}),o),o.stroke&&(o.strokeForeground={value:!0},o.strokeOffset={value:0}),[{type:"group",from:{facet:{data:t.requestDataName(Dmt.Main),name:Nwt+t.requestDataName(Dmt.Main),groupby:a,aggregate:{fields:[r({suffix:"start"}),r({suffix:"start"}),r({suffix:"end"}),r({suffix:"end"})],ops:["min","max","min","max"]}}},encode:{update:o},marks:[{type:"group",encode:{update:s},marks:[e]}]}]}(t)}return $wt(t)}(this)}parseAxesAndHeaders(){var t;this.component.axes=(t=this,Kat.reduce(((e,n)=>(t.component.scales[n]&&(e[n]=[Ewt(n,t)]),e)),{}))}assembleSelectionTopLevelSignals(t){return function(t,e){let n=!1;for(const r of Jot(t.component.selection??{})){const i=r.name,o=iL(i+eyt);if(0===e.filter((t=>t.name===i)).length){const t="global"===r.resolve?"union":r.resolve,n="point"===r.type?", true, true)":")";e.push({name:r.name,update:`${iyt}(${o}, ${iL(t)}${n}`})}n=!0;for(const n of oyt)n.defined(r)&&n.topLevelSignals&&(e=n.topLevelSignals(t,r,e))}if(n){0===e.filter((t=>"unit"===t.name)).length&&e.unshift({name:"unit",value:{},on:[{events:"pointermove",update:"isTuple(group()) ? group() : unit"}]})}return $mt(e)}(this,t)}assembleSignals(){return[...byt(this),...Tmt(this,[])]}assembleSelectionData(t){return function(t,e){const n=[...e],r=syt(t,{escape:!1});for(const e of Jot(t.component.selection??{})){const t={name:e.name+eyt};if(e.project.hasSelectionId&&(t.transform=[{type:"collect",sort:{field:Bdt}}]),e.init){const n=e.project.items.map(Mmt);t.values=e.project.hasSelectionId?e.init.map((t=>({unit:r,[Bdt]:Omt(t,!1)[0]}))):e.init.map((t=>({unit:r,fields:n,values:Omt(t,!1)})))}n.filter((t=>t.name===e.name+eyt)).length||n.push(t)}return n}(this,t)}assembleLayout(){return null}assembleLayoutSignals(){return qyt(this)}assembleMarks(){let t=this.component.mark??[];return this.parent&&jvt(this.parent)||(t=Nmt(this,t)),t.map(this.correctDataNames)}assembleGroupStyle(){const{style:t}=this.view||{};return void 0!==t?t:this.encoding.x||this.encoding.y?"cell":"view"}getMapping(){return this.encoding}get mark(){return this.markDef.type}channelHasField(t){return Qft(this.encoding,t)}fieldDef(t){return Tft(this.encoding[t])}typedFieldDef(t){const e=this.fieldDef(t);return mft(e)?e:null}}class Lwt extends Uvt{constructor(t,e,n,r,i){super(t,"layer",e,n,i,t.resolve,t.view);const o={...r,...t.width?{width:t.width}:{},...t.height?{height:t.height}:{}};this.children=t.layer.map(((t,e)=>{if(hpt(t))return new Lwt(t,this,this.getName(`layer_${e}`),o,i);if(Jft(t))return new Fwt(t,this,this.getName(`layer_${e}`),o,i);throw new Error(uut(t))}))}parseData(){this.component.data=pwt(this);for(const t of this.children)t.parseData()}parseLayoutSize(){lwt(this),uwt(this,"width"),uwt(this,"height")}parseSelections(){this.component.selection={};for(const t of this.children){t.parseSelections();for(const e of Xot(t.component.selection))this.component.selection[e]=t.component.selection[e]}}parseMarkGroup(){for(const t of this.children)t.parseMarkGroup()}parseAxesAndHeaders(){!function(t){const{axes:e,resolve:n}=t.component,r={top:0,bottom:0,right:0,left:0};for(const r of t.children){r.parseAxesAndHeaders();for(const i of Xot(r.component.axes))n.axis[i]=Kyt(t.component.resolve,i),"shared"===n.axis[i]&&(e[i]=xwt(e[i],r.component.axes[i]),e[i]||(n.axis[i]="independent",delete e[i]))}for(const i of Kat){for(const o of t.children)if(o.component.axes[i]){if("independent"===n.axis[i]){e[i]=(e[i]??[]).concat(o.component.axes[i]);for(const t of o.component.axes[i]){const{value:e,explicit:n}=t.getWithExplicit("orient");if(!zlt(e)){if(r[e]>0&&!n){const n=wwt[e];r[e]>r[n]&&t.set("orient",n,!1)}r[e]++}}}delete o.component.axes[i]}if("independent"===n.axis[i]&&e[i]&&e[i].length>1)for(const[t,n]of(e[i]||[]).entries())t>0&&n.get("grid")&&!n.explicit.grid&&(n.implicit.grid=!1)}}(this)}assembleSelectionTopLevelSignals(t){return this.children.reduce(((t,e)=>e.assembleSelectionTopLevelSignals(t)),t)}assembleSignals(){return this.children.reduce(((t,e)=>t.concat(e.assembleSignals())),byt(this))}assembleLayoutSignals(){return this.children.reduce(((t,e)=>t.concat(e.assembleLayoutSignals())),qyt(this))}assembleSelectionData(t){return this.children.reduce(((t,e)=>e.assembleSelectionData(t)),t)}assembleGroupStyle(){const t=new Set;for(const e of this.children)for(const n of kF(e.assembleGroupStyle()))t.add(n);const e=Array.from(t);return e.length>1?e:1===e.length?e[0]:void 0}assembleTitle(){let t=super.assembleTitle();if(t)return t;for(const e of this.children)if(t=e.assembleTitle(),t)return t}assembleLayout(){return null}assembleMarks(){return function(t,e){for(const n of t.children)Rvt(n)&&(e=Nmt(n,e));return e}(this,this.children.flatMap((t=>t.assembleMarks())))}assembleLegends(){return this.children.reduce(((t,e)=>t.concat(e.assembleLegends())),dbt(this))}}function Bwt(t,e,n,r,i){if(Qht(t))return new fwt(t,e,n,i);if(hpt(t))return new Lwt(t,e,n,r,i);if(Jft(t))return new Fwt(t,e,n,r,i);if(function(t){return qdt(t)||Wdt(t)||Vdt(t)}(t))return new gwt(t,e,n,i);throw new Error(uut(t))}function Rwt(t,e={}){var n;e.logger&&(n=e.logger,Put=n),e.fieldTitle&&Aft(e.fieldTitle);try{const n=spt(eF(e.config,t.config)),r=amt(t,n),i=Bwt(r,null,"",void 0,n);i.parse(),function(t,e){nvt(t.sources);let n=0,r=0;for(let r=0;r<evt&&ivt(t,e,!0);r++)n++;t.sources.map(Qbt);for(let n=0;n<evt&&ivt(t,e,!1);n++)r++;nvt(t.sources),Math.max(n,r)===evt&&zut(`Maximum optimization runs(${evt}) reached.`)}(i.component.data,i);const o=function(t,e,n={},r){const i=t.config?function(t){t=Tot(t);for(const e of lpt)delete t[e];if(t.axis)for(const e in t.axis)Vft(t.axis[e])&&delete t.axis[e];if(t.legend)for(const e of Mdt)delete t.legend[e];if(t.mark){for(const e of zht)delete t.mark[e];t.mark.tooltip&&Z$(t.mark.tooltip)&&delete t.mark.tooltip}t.params&&(t.signals=(t.signals||[]).concat(Udt(t.params)),delete t.params);for(const e of apt){for(const n of zht)delete t[e][n];const n=upt[e];if(n)for(const r of n)delete t[e][r];cpt(t,e)}for(const e of Xot(Cdt))delete t[e];!function(t){const{titleMarkConfig:e,subtitleMarkConfig:n,subtitle:r}=Rlt(t.title);Yot(e)||(t.style["group-title"]={...t.style["group-title"],...e}),Yot(n)||(t.style["group-subtitle"]={...t.style["group-subtitle"],...n}),Yot(r)?delete t.title:t.title=r}(t);for(const e in t)Z$(t[e])&&Yot(t[e])&&delete t[e];return Yot(t)?void 0:t}(t.config):void 0,o=[].concat(t.assembleSelectionData([]),function(t,e){const n=[],r=iwt(n);let i=0;for(const e of t.sources){e.hasName()||(e.dataName="source_"+i++);const t=e.assemble();r(e,t)}for(const t of n)0===t.transform.length&&delete t.transform;let o=0;for(const[t,e]of n.entries())0!==(e.transform??[]).length||e.source||n.splice(o++,0,n.splice(t,1)[0]);for(const e of n)for(const n of e.transform??[])"lookup"===n.type&&(n.from=t.outputNodes[n.from].getSource());for(const t of n)t.name in e&&(t.values=e[t.name]);return n}(t.component.data,n)),s=t.assembleProjections(),a=t.assembleTitle(),l=t.assembleGroupStyle(),u=t.assembleGroupEncodeEntry(!0);let c=t.assembleLayoutSignals();c=c.filter((t=>"width"!==t.name&&"height"!==t.name||void 0===t.value||(e[t.name]=+t.value,!1)));const{params:h,...f}=e;return{$schema:"https://vega.github.io/schema/vega/v5.json",...t.description?{description:t.description}:{},...f,...a?{title:a}:{},...l?{style:l}:{},...u?{encode:{update:u}}:{},data:o,...s.length>0?{projections:s}:{},...t.assembleGroup([...c,...t.assembleSelectionTopLevelSignals([]),...Udt(h)]),...i?{config:i}:{},...r?{usermeta:r}:{}}}(i,function(t,e,n,r){const i=r.component.layoutSize.get("width"),o=r.component.layoutSize.get("height");if(void 0===e?(e={type:"pad"},r.hasAxisOrientSignalRef()&&(e.resize=!0)):XF(e)&&(e={type:e}),i&&o&&("fit"===(s=e.type)||"fit-x"===s||"fit-y"===s))if("step"===i&&"step"===o)zut(dut()),e.type="pad";else if("step"===i||"step"===o){const t="step"===i?"width":"height";zut(dut(elt(t)));const n="width"===t?"height":"width";e.type=function(t){return t?`fit-${elt(t)}`:"fit"}(n)}var s;return{...1===Xot(e).length&&e.type?"pad"===e.type?{}:{autosize:e.type}:{autosize:e},...dmt(n,!1),...dmt(t,!0)}}(t,r.autosize,n,i),t.datasets,t.usermeta);return{spec:o,normalized:r}}finally{e.logger&&(Put=Rut),e.fieldTitle&&Aft(Sft)}}const Pwt="5.18.1",zwt=function(t){const[e,n]=/schema\/([\w-]+)\/([\w\.\-]+)\.json$/g.exec(t).slice(1,3);return{library:e,version:n}};const jwt="#fff",Uwt="#888",Vwt={background:"#333",view:{stroke:Uwt},title:{color:jwt,subtitleColor:jwt},style:{"guide-label":{fill:jwt},"guide-title":{fill:jwt}},axis:{domainColor:jwt,gridColor:Uwt,tickColor:jwt}},qwt="#4572a7",Wwt={background:"#fff",arc:{fill:qwt},area:{fill:qwt},line:{stroke:qwt,strokeWidth:2},path:{stroke:qwt},rect:{fill:qwt},shape:{stroke:qwt},symbol:{fill:qwt,strokeWidth:1.5,size:50},axis:{bandPosition:.5,grid:!0,gridColor:"#000000",gridOpacity:1,gridWidth:.5,labelPadding:10,tickSize:5,tickWidth:.5},axisBand:{grid:!1,tickExtra:!0},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:50,symbolType:"square"},range:{category:["#4572a7","#aa4643","#8aa453","#71598e","#4598ae","#d98445","#94aace","#d09393","#b9cc98","#a99cbc"]}},Hwt="#30a2da",Gwt="#cbcbcb",Ywt="#f0f0f0",Xwt="#333",Jwt={arc:{fill:Hwt},area:{fill:Hwt},axis:{domainColor:Gwt,grid:!0,gridColor:Gwt,gridWidth:1,labelColor:"#999",labelFontSize:10,titleColor:"#333",tickColor:Gwt,tickSize:10,titleFontSize:14,titlePadding:10,labelPadding:4},axisBand:{grid:!1},background:Ywt,group:{fill:Ywt},legend:{labelColor:Xwt,labelFontSize:11,padding:1,symbolSize:30,symbolType:"square",titleColor:Xwt,titleFontSize:14,titlePadding:10},line:{stroke:Hwt,strokeWidth:2},path:{stroke:Hwt,strokeWidth:.5},rect:{fill:Hwt},range:{category:["#30a2da","#fc4f30","#e5ae38","#6d904f","#8b8b8b","#b96db8","#ff9e27","#56cc60","#52d2ca","#52689e","#545454","#9fe4f8"],diverging:["#cc0020","#e77866","#f6e7e1","#d6e8ed","#91bfd9","#1d78b5"],heatmap:["#d6e8ed","#cee0e5","#91bfd9","#549cc6","#1d78b5"]},point:{filled:!0,shape:"circle"},shape:{stroke:Hwt},bar:{binSpacing:2,fill:Hwt,stroke:null},title:{anchor:"start",fontSize:24,fontWeight:600,offset:20}},Kwt="#000",Qwt={group:{fill:"#e5e5e5"},arc:{fill:Kwt},area:{fill:Kwt},line:{stroke:Kwt},path:{stroke:Kwt},rect:{fill:Kwt},shape:{stroke:Kwt},symbol:{fill:Kwt,size:40},axis:{domain:!1,grid:!0,gridColor:"#FFFFFF",gridOpacity:1,labelColor:"#7F7F7F",labelPadding:4,tickColor:"#7F7F7F",tickSize:5.67,titleFontSize:16,titleFontWeight:"normal"},legend:{labelBaseline:"middle",labelFontSize:11,symbolSize:40},range:{category:["#000000","#7F7F7F","#1A1A1A","#999999","#333333","#B0B0B0","#4D4D4D","#C9C9C9","#666666","#DCDCDC"]}},Zwt="Benton Gothic, sans-serif",txt="#82c6df",ext="Benton Gothic Bold, sans-serif",nxt="normal",rxt={"category-6":["#ec8431","#829eb1","#c89d29","#3580b1","#adc839","#ab7fb4"],"fire-7":["#fbf2c7","#f9e39c","#f8d36e","#f4bb6a","#e68a4f","#d15a40","#ab4232"],"fireandice-6":["#e68a4f","#f4bb6a","#f9e39c","#dadfe2","#a6b7c6","#849eae"],"ice-7":["#edefee","#dadfe2","#c4ccd2","#a6b7c6","#849eae","#607785","#47525d"]},ixt={background:"#ffffff",title:{anchor:"start",color:"#000000",font:ext,fontSize:22,fontWeight:"normal"},arc:{fill:txt},area:{fill:txt},line:{stroke:txt,strokeWidth:2},path:{stroke:txt},rect:{fill:txt},shape:{stroke:txt},symbol:{fill:txt,size:30},axis:{labelFont:Zwt,labelFontSize:11.5,labelFontWeight:"normal",titleFont:ext,titleFontSize:13,titleFontWeight:nxt},axisX:{labelAngle:0,labelPadding:4,tickSize:3},axisY:{labelBaseline:"middle",maxExtent:45,minExtent:45,tickSize:2,titleAlign:"left",titleAngle:0,titleX:-45,titleY:-11},legend:{labelFont:Zwt,labelFontSize:11.5,symbolType:"square",titleFont:ext,titleFontSize:13,titleFontWeight:nxt},range:{category:rxt["category-6"],diverging:rxt["fireandice-6"],heatmap:rxt["fire-7"],ordinal:rxt["fire-7"],ramp:rxt["fire-7"]}},oxt="#ab5787",sxt="#979797",axt={background:"#f9f9f9",arc:{fill:oxt},area:{fill:oxt},line:{stroke:oxt},path:{stroke:oxt},rect:{fill:oxt},shape:{stroke:oxt},symbol:{fill:oxt,size:30},axis:{domainColor:sxt,domainWidth:.5,gridWidth:.2,labelColor:sxt,tickColor:sxt,tickWidth:.2,titleColor:sxt},axisBand:{grid:!1},axisX:{grid:!0,tickSize:10},axisY:{domain:!1,grid:!0,tickSize:0},legend:{labelFontSize:11,padding:1,symbolSize:30,symbolType:"square"},range:{category:["#ab5787","#51b2e5","#703c5c","#168dd9","#d190b6","#00609f","#d365ba","#154866","#666666","#c4c4c4"]}},lxt="#3e5c69",uxt={background:"#fff",arc:{fill:lxt},area:{fill:lxt},line:{stroke:lxt},path:{stroke:lxt},rect:{fill:lxt},shape:{stroke:lxt},symbol:{fill:lxt},axis:{domainWidth:.5,grid:!0,labelPadding:2,tickSize:5,tickWidth:.5,titleFontWeight:"normal"},axisBand:{grid:!1},axisX:{gridWidth:.2},axisY:{gridDash:[3],gridWidth:.4},legend:{labelFontSize:11,padding:1,symbolType:"square"},range:{category:["#3e5c69","#6793a6","#182429","#0570b0","#3690c0","#74a9cf","#a6bddb","#e2ddf2"]}},cxt="#1696d2",hxt="#000000",fxt="Lato",dxt="Lato",pxt={"main-colors":["#1696d2","#d2d2d2","#000000","#fdbf11","#ec008b","#55b748","#5c5859","#db2b27"],"shades-blue":["#CFE8F3","#A2D4EC","#73BFE2","#46ABDB","#1696D2","#12719E","#0A4C6A","#062635"],"shades-gray":["#F5F5F5","#ECECEC","#E3E3E3","#DCDBDB","#D2D2D2","#9D9D9D","#696969","#353535"],"shades-yellow":["#FFF2CF","#FCE39E","#FDD870","#FCCB41","#FDBF11","#E88E2D","#CA5800","#843215"],"shades-magenta":["#F5CBDF","#EB99C2","#E46AA7","#E54096","#EC008B","#AF1F6B","#761548","#351123"],"shades-green":["#DCEDD9","#BCDEB4","#98CF90","#78C26D","#55B748","#408941","#2C5C2D","#1A2E19"],"shades-black":["#D5D5D4","#ADABAC","#848081","#5C5859","#332D2F","#262223","#1A1717","#0E0C0D"],"shades-red":["#F8D5D4","#F1AAA9","#E9807D","#E25552","#DB2B27","#A4201D","#6E1614","#370B0A"],"one-group":["#1696d2","#000000"],"two-groups-cat-1":["#1696d2","#000000"],"two-groups-cat-2":["#1696d2","#fdbf11"],"two-groups-cat-3":["#1696d2","#db2b27"],"two-groups-seq":["#a2d4ec","#1696d2"],"three-groups-cat":["#1696d2","#fdbf11","#000000"],"three-groups-seq":["#a2d4ec","#1696d2","#0a4c6a"],"four-groups-cat-1":["#000000","#d2d2d2","#fdbf11","#1696d2"],"four-groups-cat-2":["#1696d2","#ec0008b","#fdbf11","#5c5859"],"four-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a"],"five-groups-cat-1":["#1696d2","#fdbf11","#d2d2d2","#ec008b","#000000"],"five-groups-cat-2":["#1696d2","#0a4c6a","#d2d2d2","#fdbf11","#332d2f"],"five-groups-seq":["#cfe8f3","#73bf42","#1696d2","#0a4c6a","#000000"],"six-groups-cat-1":["#1696d2","#ec008b","#fdbf11","#000000","#d2d2d2","#55b748"],"six-groups-cat-2":["#1696d2","#d2d2d2","#ec008b","#fdbf11","#332d2f","#0a4c6a"],"six-groups-seq":["#cfe8f3","#a2d4ec","#73bfe2","#46abdb","#1696d2","#12719e"],"diverging-colors":["#ca5800","#fdbf11","#fdd870","#fff2cf","#cfe8f3","#73bfe2","#1696d2","#0a4c6a"]},mxt={background:"#FFFFFF",title:{anchor:"start",fontSize:18,font:fxt},axisX:{domain:!0,domainColor:hxt,domainWidth:1,grid:!1,labelFontSize:12,labelFont:dxt,labelAngle:0,tickColor:hxt,tickSize:5,titleFontSize:12,titlePadding:10,titleFont:fxt},axisY:{domain:!1,domainWidth:1,grid:!0,gridColor:"#DEDDDD",gridWidth:1,labelFontSize:12,labelFont:dxt,labelPadding:8,ticks:!1,titleFontSize:12,titlePadding:10,titleFont:fxt,titleAngle:0,titleY:-10,titleX:18},legend:{labelFontSize:12,labelFont:dxt,symbolSize:100,titleFontSize:12,titlePadding:10,titleFont:fxt,orient:"right",offset:10},view:{stroke:"transparent"},range:{category:pxt["six-groups-cat-1"],diverging:pxt["diverging-colors"],heatmap:pxt["diverging-colors"],ordinal:pxt["six-groups-seq"],ramp:pxt["shades-blue"]},area:{fill:cxt},rect:{fill:cxt},line:{color:cxt,stroke:cxt,strokeWidth:5},trail:{color:cxt,stroke:cxt,strokeWidth:0,size:1},path:{stroke:cxt,strokeWidth:.5},point:{filled:!0},text:{font:"Lato",color:cxt,fontSize:11,align:"center",fontWeight:400,size:11},style:{bar:{fill:cxt,stroke:null}},arc:{fill:cxt},shape:{stroke:cxt},symbol:{fill:cxt,size:30}},gxt="#3366CC",yxt="#ccc",bxt="Arial, sans-serif",vxt={arc:{fill:gxt},area:{fill:gxt},path:{stroke:gxt},rect:{fill:gxt},shape:{stroke:gxt},symbol:{stroke:gxt},circle:{fill:gxt},background:"#fff",padding:{top:10,right:10,bottom:10,left:10},style:{"guide-label":{font:bxt,fontSize:12},"guide-title":{font:bxt,fontSize:12},"group-title":{font:bxt,fontSize:12}},title:{font:bxt,fontSize:14,fontWeight:"bold",dy:-3,anchor:"start"},axis:{gridColor:yxt,tickColor:yxt,domain:!1,grid:!0},range:{category:["#4285F4","#DB4437","#F4B400","#0F9D58","#AB47BC","#00ACC1","#FF7043","#9E9D24","#5C6BC0","#F06292","#00796B","#C2185B"],heatmap:["#c6dafc","#5e97f6","#2a56c6"]}},wxt=t=>t*(1/3+1),xxt=wxt(9),_xt=wxt(10),kxt=wxt(12),Sxt="Segoe UI",Ext="wf_standard-font, helvetica, arial, sans-serif",Axt="#252423",Cxt="#605E5C",Dxt="transparent",Mxt="#118DFF",Oxt="#DEEFFF",Txt=[Oxt,Mxt],Ixt={view:{stroke:Dxt},background:Dxt,font:Sxt,header:{titleFont:Ext,titleFontSize:kxt,titleColor:Axt,labelFont:Sxt,labelFontSize:_xt,labelColor:Cxt},axis:{ticks:!1,grid:!1,domain:!1,labelColor:Cxt,labelFontSize:xxt,titleFont:Ext,titleColor:Axt,titleFontSize:kxt,titleFontWeight:"normal"},axisQuantitative:{tickCount:3,grid:!0,gridColor:"#C8C6C4",gridDash:[1,5],labelFlush:!1},axisBand:{tickExtra:!0},axisX:{labelPadding:5},axisY:{labelPadding:10},bar:{fill:Mxt},line:{stroke:Mxt,strokeWidth:3,strokeCap:"round",strokeJoin:"round"},text:{font:Sxt,fontSize:xxt,fill:Cxt},arc:{fill:Mxt},area:{fill:Mxt,line:!0,opacity:.6},path:{stroke:Mxt},rect:{fill:Mxt},point:{fill:Mxt,filled:!0,size:75},shape:{stroke:Mxt},symbol:{fill:Mxt,strokeWidth:1.5,size:50},legend:{titleFont:Sxt,titleFontWeight:"bold",titleColor:Cxt,labelFont:Sxt,labelFontSize:_xt,labelColor:Cxt,symbolType:"circle",symbolSize:75},range:{category:[Mxt,"#12239E","#E66C37","#6B007B","#E044A7","#744EC2","#D9B300","#D64550"],diverging:Txt,heatmap:Txt,ordinal:[Oxt,"#c7e4ff","#b0d9ff","#9aceff","#83c3ff","#6cb9ff","#55aeff","#3fa3ff","#2898ff",Mxt]}},Nxt='IBM Plex Sans,system-ui,-apple-system,BlinkMacSystemFont,".sfnstext-regular",sans-serif',$xt={textPrimary:{g90:"#f4f4f4",g100:"#f4f4f4",white:"#161616",g10:"#161616"},textSecondary:{g90:"#c6c6c6",g100:"#c6c6c6",white:"#525252",g10:"#525252"},layerAccent01:{white:"#e0e0e0",g10:"#e0e0e0",g90:"#525252",g100:"#393939"},gridBg:{white:"#ffffff",g10:"#ffffff",g90:"#161616",g100:"#161616"}},Fxt=["#8a3ffc","#33b1ff","#007d79","#ff7eb6","#fa4d56","#fff1f1","#6fdc8c","#4589ff","#d12771","#d2a106","#08bdba","#bae6ff","#ba4e00","#d4bbff"],Lxt=["#6929c4","#1192e8","#005d5d","#9f1853","#fa4d56","#570408","#198038","#002d9c","#ee538b","#b28600","#009d9a","#012749","#8a3800","#a56eff"];function Bxt({theme:t,background:e}){const n=["white","g10"].includes(t)?"light":"dark",r=$xt.gridBg[t],i=$xt.textPrimary[t],o=$xt.textSecondary[t],s="dark"===n?Fxt:Lxt,a="dark"===n?"#d4bbff":"#6929c4";return{background:e,arc:{fill:a},area:{fill:a},path:{stroke:a},rect:{fill:a},shape:{stroke:a},symbol:{stroke:a},circle:{fill:a},view:{fill:r,stroke:r},group:{fill:r},title:{color:i,anchor:"start",dy:-15,fontSize:16,font:Nxt,fontWeight:600},axis:{labelColor:o,labelFontSize:12,labelFont:'IBM Plex Sans Condensed, system-ui, -apple-system, BlinkMacSystemFont, ".SFNSText-Regular", sans-serif',labelFontWeight:400,titleColor:i,titleFontWeight:600,titleFontSize:12,grid:!0,gridColor:$xt.layerAccent01[t],labelAngle:0},axisX:{titlePadding:10},axisY:{titlePadding:2.5},style:{"guide-label":{font:Nxt,fill:o,fontWeight:400},"guide-title":{font:Nxt,fill:o,fontWeight:400}},range:{category:s,diverging:["#750e13","#a2191f","#da1e28","#fa4d56","#ff8389","#ffb3b8","#ffd7d9","#fff1f1","#e5f6ff","#bae6ff","#82cfff","#33b1ff","#1192e8","#0072c3","#00539a","#003a6d"],heatmap:["#f6f2ff","#e8daff","#d4bbff","#be95ff","#a56eff","#8a3ffc","#6929c4","#491d8b","#31135e","#1c0f30"]}}}const Rxt=Bxt({theme:"white",background:"#ffffff"}),Pxt=Bxt({theme:"g10",background:"#f4f4f4"}),zxt=Bxt({theme:"g90",background:"#262626"}),jxt=Bxt({theme:"g100",background:"#161616"}),Uxt="2.15.0";function Vxt(t,e){return JSON.stringify(t,function(t){const e=[];return function(n,r){if("object"!=typeof r||null===r)return r;const i=e.indexOf(this)+1;return e.length=i,e.length>t?"[Object]":e.indexOf(r)>=0?"[Circular]":(e.push(r),r)}}(e))}const qxt="vg-tooltip-element",Wxt={offsetX:10,offsetY:10,id:qxt,styleId:"vega-tooltip-style",theme:"light",disableDefaultStyle:!1,sanitize:function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;")},maxDepth:2,formatTooltip:function(t,e,n,r){if(Q$(t))return`[${t.map((t=>e(XF(t)?t:Vxt(t,n)))).join(", ")}]`;if(Z$(t)){let i="";const{title:o,image:s,...a}=t;o&&(i+=`<h2>${e(o)}</h2>`),s&&(i+=`<img src="${new URL(e(s),r||location.href).href}">`);const l=Object.keys(a);if(l.length>0){i+="<table>";for(const t of l){let r=a[t];void 0!==r&&(Z$(r)&&(r=Vxt(r,n)),i+=`<tr><td class="key">${e(t)}</td><td class="value">${e(r)}</td></tr>`)}i+="</table>"}return i||"{}"}return e(t)},baseURL:""};class Hxt{constructor(t){this.options={...Wxt,...t};const e=this.options.id;if(this.el=null,this.call=this.tooltipHandler.bind(this),!this.options.disableDefaultStyle&&!document.getElementById(this.options.styleId)){const t=document.createElement("style");t.setAttribute("id",this.options.styleId),t.innerHTML=function(t){if(!/^[A-Za-z]+[-:.\w]*$/.test(t))throw new Error("Invalid HTML ID");return"#vg-tooltip-element {\n  visibility: hidden;\n  padding: 8px;\n  position: fixed;\n  z-index: 1000;\n  font-family: sans-serif;\n  font-size: 11px;\n  border-radius: 3px;\n  box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);\n  /* The default theme is the light theme. */\n  background-color: rgba(255, 255, 255, 0.95);\n  border: 1px solid #d9d9d9;\n  color: black;\n}\n#vg-tooltip-element.visible {\n  visibility: visible;\n}\n#vg-tooltip-element h2 {\n  margin-top: 0;\n  margin-bottom: 10px;\n  font-size: 13px;\n}\n#vg-tooltip-element table {\n  border-spacing: 0;\n}\n#vg-tooltip-element table tr {\n  border: none;\n}\n#vg-tooltip-element table tr td {\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding-top: 2px;\n  padding-bottom: 2px;\n}\n#vg-tooltip-element table tr td.key {\n  color: #808080;\n  max-width: 150px;\n  text-align: right;\n  padding-right: 4px;\n}\n#vg-tooltip-element table tr td.value {\n  display: block;\n  max-width: 300px;\n  max-height: 7em;\n  text-align: left;\n}\n#vg-tooltip-element.dark-theme {\n  background-color: rgba(32, 32, 32, 0.9);\n  border: 1px solid #f5f5f5;\n  color: white;\n}\n#vg-tooltip-element.dark-theme td.key {\n  color: #bfbfbf;\n}\n".toString().replace(qxt,t)}(e);const n=document.head;n.childNodes.length>0?n.insertBefore(t,n.childNodes[0]):n.appendChild(t)}}tooltipHandler(t,e,n,r){if(this.el=document.getElementById(this.options.id),this.el||(this.el=document.createElement("div"),this.el.setAttribute("id",this.options.id),this.el.classList.add("vg-tooltip"),(document.fullscreenElement??document.body).appendChild(this.el)),null==r||""===r)return void this.el.classList.remove("visible",`${this.options.theme}-theme`);this.el.innerHTML=this.options.formatTooltip(r,this.options.sanitize,this.options.maxDepth,this.options.baseURL),this.el.classList.add("visible",`${this.options.theme}-theme`);const{x:i,y:o}=function(t,e,n,r){let i=t.clientX+n;i+e.width>window.innerWidth&&(i=+t.clientX-n-e.width);let o=t.clientY+r;return o+e.height>window.innerHeight&&(o=+t.clientY-r-e.height),{x:i,y:o}}(e,this.el.getBoundingClientRect(),this.options.offsetX,this.options.offsetY);this.el.style.top=`${o}px`,this.el.style.left=`${i}px`}}function Gxt(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Yxt,Xxt,Jxt=Kxt;function Kxt(t){var e=this;if(e instanceof Kxt||(e=new Kxt),e.tail=null,e.head=null,e.length=0,t&&"function"==typeof t.forEach)t.forEach((function(t){e.push(t)}));else if(arguments.length>0)for(var n=0,r=arguments.length;n<r;n++)e.push(arguments[n]);return e}function Qxt(t,e,n){var r=e===t.head?new e_t(n,null,e,t):new e_t(n,e,e.next,t);return null===r.next&&(t.tail=r),null===r.prev&&(t.head=r),t.length++,r}function Zxt(t,e){t.tail=new e_t(e,t.tail,null,t),t.head||(t.head=t.tail),t.length++}function t_t(t,e){t.head=new e_t(e,null,t.head,t),t.tail||(t.tail=t.head),t.length++}function e_t(t,e,n,r){if(!(this instanceof e_t))return new e_t(t,e,n,r);this.list=r,this.value=t,e?(e.next=this,this.prev=e):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}Kxt.Node=e_t,Kxt.create=Kxt,Kxt.prototype.removeNode=function(t){if(t.list!==this)throw new Error("removing node which does not belong to this list");var e=t.next,n=t.prev;return e&&(e.prev=n),n&&(n.next=e),t===this.head&&(this.head=e),t===this.tail&&(this.tail=n),t.list.length--,t.next=null,t.prev=null,t.list=null,e},Kxt.prototype.unshiftNode=function(t){if(t!==this.head){t.list&&t.list.removeNode(t);var e=this.head;t.list=this,t.next=e,e&&(e.prev=t),this.head=t,this.tail||(this.tail=t),this.length++}},Kxt.prototype.pushNode=function(t){if(t!==this.tail){t.list&&t.list.removeNode(t);var e=this.tail;t.list=this,t.prev=e,e&&(e.next=t),this.tail=t,this.head||(this.head=t),this.length++}},Kxt.prototype.push=function(){for(var t=0,e=arguments.length;t<e;t++)Zxt(this,arguments[t]);return this.length},Kxt.prototype.unshift=function(){for(var t=0,e=arguments.length;t<e;t++)t_t(this,arguments[t]);return this.length},Kxt.prototype.pop=function(){if(this.tail){var t=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,t}},Kxt.prototype.shift=function(){if(this.head){var t=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,t}},Kxt.prototype.forEach=function(t,e){e=e||this;for(var n=this.head,r=0;null!==n;r++)t.call(e,n.value,r,this),n=n.next},Kxt.prototype.forEachReverse=function(t,e){e=e||this;for(var n=this.tail,r=this.length-1;null!==n;r--)t.call(e,n.value,r,this),n=n.prev},Kxt.prototype.get=function(t){for(var e=0,n=this.head;null!==n&&e<t;e++)n=n.next;if(e===t&&null!==n)return n.value},Kxt.prototype.getReverse=function(t){for(var e=0,n=this.tail;null!==n&&e<t;e++)n=n.prev;if(e===t&&null!==n)return n.value},Kxt.prototype.map=function(t,e){e=e||this;for(var n=new Kxt,r=this.head;null!==r;)n.push(t.call(e,r.value,this)),r=r.next;return n},Kxt.prototype.mapReverse=function(t,e){e=e||this;for(var n=new Kxt,r=this.tail;null!==r;)n.push(t.call(e,r.value,this)),r=r.prev;return n},Kxt.prototype.reduce=function(t,e){var n,r=this.head;if(arguments.length>1)n=e;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=t(n,r.value,i),r=r.next;return n},Kxt.prototype.reduceReverse=function(t,e){var n,r=this.tail;if(arguments.length>1)n=e;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=t(n,r.value,i),r=r.prev;return n},Kxt.prototype.toArray=function(){for(var t=new Array(this.length),e=0,n=this.head;null!==n;e++)t[e]=n.value,n=n.next;return t},Kxt.prototype.toArrayReverse=function(){for(var t=new Array(this.length),e=0,n=this.tail;null!==n;e++)t[e]=n.value,n=n.prev;return t},Kxt.prototype.slice=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var n=new Kxt;if(e<t||e<0)return n;t<0&&(t=0),e>this.length&&(e=this.length);for(var r=0,i=this.head;null!==i&&r<t;r++)i=i.next;for(;null!==i&&r<e;r++,i=i.next)n.push(i.value);return n},Kxt.prototype.sliceReverse=function(t,e){(e=e||this.length)<0&&(e+=this.length),(t=t||0)<0&&(t+=this.length);var n=new Kxt;if(e<t||e<0)return n;t<0&&(t=0),e>this.length&&(e=this.length);for(var r=this.length,i=this.tail;null!==i&&r>e;r--)i=i.prev;for(;null!==i&&r>t;r--,i=i.prev)n.push(i.value);return n},Kxt.prototype.splice=function(t,e,...n){t>this.length&&(t=this.length-1),t<0&&(t=this.length+t);for(var r=0,i=this.head;null!==i&&r<t;r++)i=i.next;var o=[];for(r=0;i&&r<e;r++)o.push(i.value),i=this.removeNode(i);for(null===i&&(i=this.tail),i!==this.head&&i!==this.tail&&(i=i.prev),r=0;r<n.length;r++)i=Qxt(this,i,n[r]);return o},Kxt.prototype.reverse=function(){for(var t=this.head,e=this.tail,n=t;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=e,this.tail=t,this};try{(Xxt||(Xxt=1,Yxt=function(t){t.prototype[Symbol.iterator]=function*(){for(let t=this.head;t;t=t.next)yield t.value}}),Yxt)(Kxt)}catch(t){}const n_t=Jxt,r_t=Symbol("max"),i_t=Symbol("length"),o_t=Symbol("lengthCalculator"),s_t=Symbol("allowStale"),a_t=Symbol("maxAge"),l_t=Symbol("dispose"),u_t=Symbol("noDisposeOnSet"),c_t=Symbol("lruList"),h_t=Symbol("cache"),f_t=Symbol("updateAgeOnGet"),d_t=()=>1,p_t=(t,e,n)=>{const r=t[h_t].get(e);if(r){const e=r.value;if(m_t(t,e)){if(y_t(t,r),!t[s_t])return}else n&&(t[f_t]&&(r.value.now=Date.now()),t[c_t].unshiftNode(r));return e.value}},m_t=(t,e)=>{if(!e||!e.maxAge&&!t[a_t])return!1;const n=Date.now()-e.now;return e.maxAge?n>e.maxAge:t[a_t]&&n>t[a_t]},g_t=t=>{if(t[i_t]>t[r_t])for(let e=t[c_t].tail;t[i_t]>t[r_t]&&null!==e;){const n=e.prev;y_t(t,e),e=n}},y_t=(t,e)=>{if(e){const n=e.value;t[l_t]&&t[l_t](n.key,n.value),t[i_t]-=n.length,t[h_t].delete(n.key),t[c_t].removeNode(e)}};class b_t{constructor(t,e,n,r,i){this.key=t,this.value=e,this.length=n,this.now=r,this.maxAge=i||0}}const v_t=(t,e,n,r)=>{let i=n.value;m_t(t,i)&&(y_t(t,n),t[s_t]||(i=void 0)),i&&e.call(r,i.value,i.key,t)};var w_t=class{constructor(t){if("number"==typeof t&&(t={max:t}),t||(t={}),t.max&&("number"!=typeof t.max||t.max<0))throw new TypeError("max must be a non-negative number");this[r_t]=t.max||1/0;const e=t.length||d_t;if(this[o_t]="function"!=typeof e?d_t:e,this[s_t]=t.stale||!1,t.maxAge&&"number"!=typeof t.maxAge)throw new TypeError("maxAge must be a number");this[a_t]=t.maxAge||0,this[l_t]=t.dispose,this[u_t]=t.noDisposeOnSet||!1,this[f_t]=t.updateAgeOnGet||!1,this.reset()}set max(t){if("number"!=typeof t||t<0)throw new TypeError("max must be a non-negative number");this[r_t]=t||1/0,g_t(this)}get max(){return this[r_t]}set allowStale(t){this[s_t]=!!t}get allowStale(){return this[s_t]}set maxAge(t){if("number"!=typeof t)throw new TypeError("maxAge must be a non-negative number");this[a_t]=t,g_t(this)}get maxAge(){return this[a_t]}set lengthCalculator(t){"function"!=typeof t&&(t=d_t),t!==this[o_t]&&(this[o_t]=t,this[i_t]=0,this[c_t].forEach((t=>{t.length=this[o_t](t.value,t.key),this[i_t]+=t.length}))),g_t(this)}get lengthCalculator(){return this[o_t]}get length(){return this[i_t]}get itemCount(){return this[c_t].length}rforEach(t,e){e=e||this;for(let n=this[c_t].tail;null!==n;){const r=n.prev;v_t(this,t,n,e),n=r}}forEach(t,e){e=e||this;for(let n=this[c_t].head;null!==n;){const r=n.next;v_t(this,t,n,e),n=r}}keys(){return this[c_t].toArray().map((t=>t.key))}values(){return this[c_t].toArray().map((t=>t.value))}reset(){this[l_t]&&this[c_t]&&this[c_t].length&&this[c_t].forEach((t=>this[l_t](t.key,t.value))),this[h_t]=new Map,this[c_t]=new n_t,this[i_t]=0}dump(){return this[c_t].map((t=>!m_t(this,t)&&{k:t.key,v:t.value,e:t.now+(t.maxAge||0)})).toArray().filter((t=>t))}dumpLru(){return this[c_t]}set(t,e,n){if((n=n||this[a_t])&&"number"!=typeof n)throw new TypeError("maxAge must be a number");const r=n?Date.now():0,i=this[o_t](e,t);if(this[h_t].has(t)){if(i>this[r_t])return y_t(this,this[h_t].get(t)),!1;const o=this[h_t].get(t).value;return this[l_t]&&(this[u_t]||this[l_t](t,o.value)),o.now=r,o.maxAge=n,o.value=e,this[i_t]+=i-o.length,o.length=i,this.get(t),g_t(this),!0}const o=new b_t(t,e,i,r,n);return o.length>this[r_t]?(this[l_t]&&this[l_t](t,e),!1):(this[i_t]+=o.length,this[c_t].unshift(o),this[h_t].set(t,this[c_t].head),g_t(this),!0)}has(t){if(!this[h_t].has(t))return!1;const e=this[h_t].get(t).value;return!m_t(this,e)}get(t){return p_t(this,t,!0)}peek(t){return p_t(this,t,!1)}pop(){const t=this[c_t].tail;return t?(y_t(this,t),t.value):null}del(t){y_t(this,this[h_t].get(t))}load(t){this.reset();const e=Date.now();for(let n=t.length-1;n>=0;n--){const r=t[n],i=r.e||0;if(0===i)this.set(r.k,r.v);else{const t=i-e;t>0&&this.set(r.k,r.v,t)}}}prune(){this[h_t].forEach(((t,e)=>p_t(this,e,!1)))}};const x_t=Object.freeze({loose:!0}),__t=Object.freeze({});var k_t=t=>t?"object"!=typeof t?x_t:t:__t,S_t={exports:{}},E_t={MAX_LENGTH:256,MAX_SAFE_COMPONENT_LENGTH:16,MAX_SAFE_BUILD_LENGTH:250,MAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER||9007199254740991,RELEASE_TYPES:["major","premajor","minor","preminor","patch","prepatch","prerelease"],SEMVER_SPEC_VERSION:"2.0.0",FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},A_t="object"==typeof process&&process.env&&process.env.NODE_DEBUG&&/\bsemver\b/i.test(process.env.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};!function(t,e){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:i}=E_t,o=A_t,s=(e=t.exports={}).re=[],a=e.safeRe=[],l=e.src=[],u=e.t={};let c=0;const h="[a-zA-Z0-9-]",f=[["\\s",1],["\\d",i],[h,r]],d=(t,e,n)=>{const r=(t=>{for(const[e,n]of f)t=t.split(`${e}*`).join(`${e}{0,${n}}`).split(`${e}+`).join(`${e}{1,${n}}`);return t})(e),i=c++;o(t,i,e),u[t]=i,l[i]=e,s[i]=new RegExp(e,n?"g":void 0),a[i]=new RegExp(r,n?"g":void 0)};d("NUMERICIDENTIFIER","0|[1-9]\\d*"),d("NUMERICIDENTIFIERLOOSE","\\d+"),d("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${h}*`),d("MAINVERSION",`(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})\\.(${l[u.NUMERICIDENTIFIER]})`),d("MAINVERSIONLOOSE",`(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})\\.(${l[u.NUMERICIDENTIFIERLOOSE]})`),d("PRERELEASEIDENTIFIER",`(?:${l[u.NUMERICIDENTIFIER]}|${l[u.NONNUMERICIDENTIFIER]})`),d("PRERELEASEIDENTIFIERLOOSE",`(?:${l[u.NUMERICIDENTIFIERLOOSE]}|${l[u.NONNUMERICIDENTIFIER]})`),d("PRERELEASE",`(?:-(${l[u.PRERELEASEIDENTIFIER]}(?:\\.${l[u.PRERELEASEIDENTIFIER]})*))`),d("PRERELEASELOOSE",`(?:-?(${l[u.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${l[u.PRERELEASEIDENTIFIERLOOSE]})*))`),d("BUILDIDENTIFIER",`${h}+`),d("BUILD",`(?:\\+(${l[u.BUILDIDENTIFIER]}(?:\\.${l[u.BUILDIDENTIFIER]})*))`),d("FULLPLAIN",`v?${l[u.MAINVERSION]}${l[u.PRERELEASE]}?${l[u.BUILD]}?`),d("FULL",`^${l[u.FULLPLAIN]}$`),d("LOOSEPLAIN",`[v=\\s]*${l[u.MAINVERSIONLOOSE]}${l[u.PRERELEASELOOSE]}?${l[u.BUILD]}?`),d("LOOSE",`^${l[u.LOOSEPLAIN]}$`),d("GTLT","((?:<|>)?=?)"),d("XRANGEIDENTIFIERLOOSE",`${l[u.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),d("XRANGEIDENTIFIER",`${l[u.NUMERICIDENTIFIER]}|x|X|\\*`),d("XRANGEPLAIN",`[v=\\s]*(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:\\.(${l[u.XRANGEIDENTIFIER]})(?:${l[u.PRERELEASE]})?${l[u.BUILD]}?)?)?`),d("XRANGEPLAINLOOSE",`[v=\\s]*(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:\\.(${l[u.XRANGEIDENTIFIERLOOSE]})(?:${l[u.PRERELEASELOOSE]})?${l[u.BUILD]}?)?)?`),d("XRANGE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAIN]}$`),d("XRANGELOOSE",`^${l[u.GTLT]}\\s*${l[u.XRANGEPLAINLOOSE]}$`),d("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),d("COERCE",`${l[u.COERCEPLAIN]}(?:$|[^\\d])`),d("COERCEFULL",l[u.COERCEPLAIN]+`(?:${l[u.PRERELEASE]})?`+`(?:${l[u.BUILD]})?(?:$|[^\\d])`),d("COERCERTL",l[u.COERCE],!0),d("COERCERTLFULL",l[u.COERCEFULL],!0),d("LONETILDE","(?:~>?)"),d("TILDETRIM",`(\\s*)${l[u.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",d("TILDE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAIN]}$`),d("TILDELOOSE",`^${l[u.LONETILDE]}${l[u.XRANGEPLAINLOOSE]}$`),d("LONECARET","(?:\\^)"),d("CARETTRIM",`(\\s*)${l[u.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",d("CARET",`^${l[u.LONECARET]}${l[u.XRANGEPLAIN]}$`),d("CARETLOOSE",`^${l[u.LONECARET]}${l[u.XRANGEPLAINLOOSE]}$`),d("COMPARATORLOOSE",`^${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]})$|^$`),d("COMPARATOR",`^${l[u.GTLT]}\\s*(${l[u.FULLPLAIN]})$|^$`),d("COMPARATORTRIM",`(\\s*)${l[u.GTLT]}\\s*(${l[u.LOOSEPLAIN]}|${l[u.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",d("HYPHENRANGE",`^\\s*(${l[u.XRANGEPLAIN]})\\s+-\\s+(${l[u.XRANGEPLAIN]})\\s*$`),d("HYPHENRANGELOOSE",`^\\s*(${l[u.XRANGEPLAINLOOSE]})\\s+-\\s+(${l[u.XRANGEPLAINLOOSE]})\\s*$`),d("STAR","(<|>)?=?\\s*\\*"),d("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),d("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")}(S_t,S_t.exports);var C_t=S_t.exports;const D_t=/^[0-9]+$/,M_t=(t,e)=>{const n=D_t.test(t),r=D_t.test(e);return n&&r&&(t=+t,e=+e),t===e?0:n&&!r?-1:r&&!n?1:t<e?-1:1};var O_t={compareIdentifiers:M_t,rcompareIdentifiers:(t,e)=>M_t(e,t)};const T_t=A_t,{MAX_LENGTH:I_t,MAX_SAFE_INTEGER:N_t}=E_t,{safeRe:$_t,t:F_t}=C_t,L_t=k_t,{compareIdentifiers:B_t}=O_t;var R_t=class t{constructor(e,n){if(n=L_t(n),e instanceof t){if(e.loose===!!n.loose&&e.includePrerelease===!!n.includePrerelease)return e;e=e.version}else if("string"!=typeof e)throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>I_t)throw new TypeError(`version is longer than ${I_t} characters`);T_t("SemVer",e,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const r=e.trim().match(n.loose?$_t[F_t.LOOSE]:$_t[F_t.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>N_t||this.major<0)throw new TypeError("Invalid major version");if(this.minor>N_t||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>N_t||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map((t=>{if(/^[0-9]+$/.test(t)){const e=+t;if(e>=0&&e<N_t)return e}return t})):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(T_t("SemVer.compare",this.version,this.options,e),!(e instanceof t)){if("string"==typeof e&&e===this.version)return 0;e=new t(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof t||(e=new t(e,this.options)),B_t(this.major,e.major)||B_t(this.minor,e.minor)||B_t(this.patch,e.patch)}comparePre(e){if(e instanceof t||(e=new t(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let n=0;do{const t=this.prerelease[n],r=e.prerelease[n];if(T_t("prerelease compare",n,t,r),void 0===t&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===t)return-1;if(t!==r)return B_t(t,r)}while(++n)}compareBuild(e){e instanceof t||(e=new t(e,this.options));let n=0;do{const t=this.build[n],r=e.build[n];if(T_t("prerelease compare",n,t,r),void 0===t&&void 0===r)return 0;if(void 0===r)return 1;if(void 0===t)return-1;if(t!==r)return B_t(t,r)}while(++n)}inc(t,e,n){switch(t){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",e,n);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",e,n);break;case"prepatch":this.prerelease.length=0,this.inc("patch",e,n),this.inc("pre",e,n);break;case"prerelease":0===this.prerelease.length&&this.inc("patch",e,n),this.inc("pre",e,n);break;case"major":0===this.minor&&0===this.patch&&0!==this.prerelease.length||this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":0===this.patch&&0!==this.prerelease.length||this.minor++,this.patch=0,this.prerelease=[];break;case"patch":0===this.prerelease.length&&this.patch++,this.prerelease=[];break;case"pre":{const t=Number(n)?1:0;if(!e&&!1===n)throw new Error("invalid increment argument: identifier is empty");if(0===this.prerelease.length)this.prerelease=[t];else{let r=this.prerelease.length;for(;--r>=0;)"number"==typeof this.prerelease[r]&&(this.prerelease[r]++,r=-2);if(-1===r){if(e===this.prerelease.join(".")&&!1===n)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(t)}}if(e){let r=[e,t];!1===n&&(r=[e]),0===B_t(this.prerelease[0],e)?isNaN(this.prerelease[1])&&(this.prerelease=r):this.prerelease=r}break}default:throw new Error(`invalid increment argument: ${t}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};const P_t=R_t;var z_t=(t,e,n)=>new P_t(t,n).compare(new P_t(e,n));const j_t=z_t;const U_t=z_t;const V_t=z_t;const q_t=z_t;const W_t=z_t;const H_t=z_t;const G_t=(t,e,n)=>0===j_t(t,e,n),Y_t=(t,e,n)=>0!==U_t(t,e,n),X_t=(t,e,n)=>V_t(t,e,n)>0,J_t=(t,e,n)=>q_t(t,e,n)>=0,K_t=(t,e,n)=>W_t(t,e,n)<0,Q_t=(t,e,n)=>H_t(t,e,n)<=0;var Z_t,tkt,ekt,nkt,rkt=(t,e,n,r)=>{switch(e){case"===":return"object"==typeof t&&(t=t.version),"object"==typeof n&&(n=n.version),t===n;case"!==":return"object"==typeof t&&(t=t.version),"object"==typeof n&&(n=n.version),t!==n;case"":case"=":case"==":return G_t(t,n,r);case"!=":return Y_t(t,n,r);case">":return X_t(t,n,r);case">=":return J_t(t,n,r);case"<":return K_t(t,n,r);case"<=":return Q_t(t,n,r);default:throw new TypeError(`Invalid operator: ${e}`)}};const ikt=function t(){if(nkt)return ekt;nkt=1;class e{constructor(t,n){if(n=r(n),t instanceof e)return t.loose===!!n.loose&&t.includePrerelease===!!n.includePrerelease?t:new e(t.raw,n);if(t instanceof i)return this.raw=t.value,this.set=[[t]],this.format(),this;if(this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease,this.raw=t.trim().split(/\s+/).join(" "),this.set=this.raw.split("||").map((t=>this.parseRange(t.trim()))).filter((t=>t.length)),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const t=this.set[0];if(this.set=this.set.filter((t=>!p(t[0]))),0===this.set.length)this.set=[t];else if(this.set.length>1)for(const t of this.set)if(1===t.length&&m(t[0])){this.set=[t];break}}this.format()}format(){return this.range=this.set.map((t=>t.join(" ").trim())).join("||").trim(),this.range}toString(){return this.range}parseRange(t){const e=((this.options.includePrerelease&&f)|(this.options.loose&&d))+":"+t,r=n.get(e);if(r)return r;const s=this.options.loose,m=s?a[l.HYPHENRANGELOOSE]:a[l.HYPHENRANGE];t=t.replace(m,C(this.options.includePrerelease)),o("hyphen replace",t),t=t.replace(a[l.COMPARATORTRIM],u),o("comparator trim",t),t=t.replace(a[l.TILDETRIM],c),o("tilde trim",t),t=t.replace(a[l.CARETTRIM],h),o("caret trim",t);let g=t.split(" ").map((t=>y(t,this.options))).join(" ").split(/\s+/).map((t=>A(t,this.options)));s&&(g=g.filter((t=>(o("loose invalid filter",t,this.options),!!t.match(a[l.COMPARATORLOOSE]))))),o("range list",g);const b=new Map,v=g.map((t=>new i(t,this.options)));for(const t of v){if(p(t))return[t];b.set(t.value,t)}b.size>1&&b.has("")&&b.delete("");const w=[...b.values()];return n.set(e,w),w}intersects(t,n){if(!(t instanceof e))throw new TypeError("a Range is required");return this.set.some((e=>g(e,n)&&t.set.some((t=>g(t,n)&&e.every((e=>t.every((t=>e.intersects(t,n)))))))))}test(t){if(!t)return!1;if("string"==typeof t)try{t=new s(t,this.options)}catch(t){return!1}for(let e=0;e<this.set.length;e++)if(D(this.set[e],t,this.options))return!0;return!1}}ekt=e;const n=new w_t({max:1e3}),r=k_t,i=function(){if(tkt)return Z_t;tkt=1;const e=Symbol("SemVer ANY");class n{static get ANY(){return e}constructor(t,i){if(i=r(i),t instanceof n){if(t.loose===!!i.loose)return t;t=t.value}t=t.trim().split(/\s+/).join(" "),a("comparator",t,i),this.options=i,this.loose=!!i.loose,this.parse(t),this.semver===e?this.value="":this.value=this.operator+this.semver.version,a("comp",this)}parse(t){const n=this.options.loose?i[o.COMPARATORLOOSE]:i[o.COMPARATOR],r=t.match(n);if(!r)throw new TypeError(`Invalid comparator: ${t}`);this.operator=void 0!==r[1]?r[1]:"","="===this.operator&&(this.operator=""),r[2]?this.semver=new l(r[2],this.options.loose):this.semver=e}toString(){return this.value}test(t){if(a("Comparator.test",t,this.options.loose),this.semver===e||t===e)return!0;if("string"==typeof t)try{t=new l(t,this.options)}catch(t){return!1}return s(t,this.operator,this.semver,this.options)}intersects(t,e){if(!(t instanceof n))throw new TypeError("a Comparator is required");return""===this.operator?""===this.value||new u(t.value,e).test(this.value):""===t.operator?""===t.value||new u(this.value,e).test(t.semver):!((e=r(e)).includePrerelease&&("<0.0.0-0"===this.value||"<0.0.0-0"===t.value)||!e.includePrerelease&&(this.value.startsWith("<0.0.0")||t.value.startsWith("<0.0.0"))||(!this.operator.startsWith(">")||!t.operator.startsWith(">"))&&(!this.operator.startsWith("<")||!t.operator.startsWith("<"))&&(this.semver.version!==t.semver.version||!this.operator.includes("=")||!t.operator.includes("="))&&!(s(this.semver,"<",t.semver,e)&&this.operator.startsWith(">")&&t.operator.startsWith("<"))&&!(s(this.semver,">",t.semver,e)&&this.operator.startsWith("<")&&t.operator.startsWith(">")))}}Z_t=n;const r=k_t,{safeRe:i,t:o}=C_t,s=rkt,a=A_t,l=R_t,u=t();return Z_t}(),o=A_t,s=R_t,{safeRe:a,t:l,comparatorTrimReplace:u,tildeTrimReplace:c,caretTrimReplace:h}=C_t,{FLAG_INCLUDE_PRERELEASE:f,FLAG_LOOSE:d}=E_t,p=t=>"<0.0.0-0"===t.value,m=t=>""===t.value,g=(t,e)=>{let n=!0;const r=t.slice();let i=r.pop();for(;n&&r.length;)n=r.every((t=>i.intersects(t,e))),i=r.pop();return n},y=(t,e)=>(o("comp",t,e),t=x(t,e),o("caret",t),t=v(t,e),o("tildes",t),t=k(t,e),o("xrange",t),t=E(t,e),o("stars",t),t),b=t=>!t||"x"===t.toLowerCase()||"*"===t,v=(t,e)=>t.trim().split(/\s+/).map((t=>w(t,e))).join(" "),w=(t,e)=>{const n=e.loose?a[l.TILDELOOSE]:a[l.TILDE];return t.replace(n,((e,n,r,i,s)=>{let a;return o("tilde",t,e,n,r,i,s),b(n)?a="":b(r)?a=`>=${n}.0.0 <${+n+1}.0.0-0`:b(i)?a=`>=${n}.${r}.0 <${n}.${+r+1}.0-0`:s?(o("replaceTilde pr",s),a=`>=${n}.${r}.${i}-${s} <${n}.${+r+1}.0-0`):a=`>=${n}.${r}.${i} <${n}.${+r+1}.0-0`,o("tilde return",a),a}))},x=(t,e)=>t.trim().split(/\s+/).map((t=>_(t,e))).join(" "),_=(t,e)=>{o("caret",t,e);const n=e.loose?a[l.CARETLOOSE]:a[l.CARET],r=e.includePrerelease?"-0":"";return t.replace(n,((e,n,i,s,a)=>{let l;return o("caret",t,e,n,i,s,a),b(n)?l="":b(i)?l=`>=${n}.0.0${r} <${+n+1}.0.0-0`:b(s)?l="0"===n?`>=${n}.${i}.0${r} <${n}.${+i+1}.0-0`:`>=${n}.${i}.0${r} <${+n+1}.0.0-0`:a?(o("replaceCaret pr",a),l="0"===n?"0"===i?`>=${n}.${i}.${s}-${a} <${n}.${i}.${+s+1}-0`:`>=${n}.${i}.${s}-${a} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${s}-${a} <${+n+1}.0.0-0`):(o("no pr"),l="0"===n?"0"===i?`>=${n}.${i}.${s}${r} <${n}.${i}.${+s+1}-0`:`>=${n}.${i}.${s}${r} <${n}.${+i+1}.0-0`:`>=${n}.${i}.${s} <${+n+1}.0.0-0`),o("caret return",l),l}))},k=(t,e)=>(o("replaceXRanges",t,e),t.split(/\s+/).map((t=>S(t,e))).join(" ")),S=(t,e)=>{t=t.trim();const n=e.loose?a[l.XRANGELOOSE]:a[l.XRANGE];return t.replace(n,((n,r,i,s,a,l)=>{o("xRange",t,n,r,i,s,a,l);const u=b(i),c=u||b(s),h=c||b(a),f=h;return"="===r&&f&&(r=""),l=e.includePrerelease?"-0":"",u?n=">"===r||"<"===r?"<0.0.0-0":"*":r&&f?(c&&(s=0),a=0,">"===r?(r=">=",c?(i=+i+1,s=0,a=0):(s=+s+1,a=0)):"<="===r&&(r="<",c?i=+i+1:s=+s+1),"<"===r&&(l="-0"),n=`${r+i}.${s}.${a}${l}`):c?n=`>=${i}.0.0${l} <${+i+1}.0.0-0`:h&&(n=`>=${i}.${s}.0${l} <${i}.${+s+1}.0-0`),o("xRange return",n),n}))},E=(t,e)=>(o("replaceStars",t,e),t.trim().replace(a[l.STAR],"")),A=(t,e)=>(o("replaceGTE0",t,e),t.trim().replace(a[e.includePrerelease?l.GTE0PRE:l.GTE0],"")),C=t=>(e,n,r,i,o,s,a,l,u,c,h,f,d)=>`${n=b(r)?"":b(i)?`>=${r}.0.0${t?"-0":""}`:b(o)?`>=${r}.${i}.0${t?"-0":""}`:s?`>=${n}`:`>=${n}${t?"-0":""}`} ${l=b(u)?"":b(c)?`<${+u+1}.0.0-0`:b(h)?`<${u}.${+c+1}.0-0`:f?`<=${u}.${c}.${h}-${f}`:t?`<${u}.${c}.${+h+1}-0`:`<=${l}`}`.trim(),D=(t,e,n)=>{for(let n=0;n<t.length;n++)if(!t[n].test(e))return!1;if(e.prerelease.length&&!n.includePrerelease){for(let n=0;n<t.length;n++)if(o(t[n].semver),t[n].semver!==i.ANY&&t[n].semver.prerelease.length>0){const r=t[n].semver;if(r.major===e.major&&r.minor===e.minor&&r.patch===e.patch)return!0}return!1}return!0};return ekt}();var okt=(t,e,n)=>{try{e=new ikt(e,n)}catch(t){return!1}return e.test(t)},skt=Gxt(okt);function akt(t,...e){for(const n of e)lkt(t,n);return t}function lkt(t,e){for(const n of Object.keys(e))nF(t,n,e[n],!0)}const ukt=m;let ckt=g;const hkt="undefined"!=typeof window?window:void 0;void 0===ckt&&hkt?.vl?.compile&&(ckt=hkt.vl);const fkt={export:{svg:!0,png:!0},source:!0,compiled:!0,editor:!0},dkt={CLICK_TO_VIEW_ACTIONS:"Click to view actions",COMPILED_ACTION:"View Compiled Vega",EDITOR_ACTION:"Open in Vega Editor",PNG_ACTION:"Save as PNG",SOURCE_ACTION:"View Source",SVG_ACTION:"Save as SVG"},pkt={vega:"Vega","vega-lite":"Vega-Lite"},mkt={vega:ukt.version,"vega-lite":ckt?ckt.version:"not available"},gkt={vega:t=>t,"vega-lite":(t,e)=>ckt.compile(t,{config:e}).spec};function ykt(t,e,n,r){const i=`<html><head>${e}</head><body><pre><code class="json">`,o=`</code></pre>${n}</body></html>`,s=window.open("");s.document.write(i+t+o),s.document.title=`${pkt[r]} JSON Source`}function bkt(t){return!(!t||!("load"in t))}function vkt(t){return bkt(t)?t:ukt.loader(t)}async function wkt(t,e){const n=XF(t.config)?JSON.parse(await e.load(t.config)):t.config??{},r=XF(t.patch)?JSON.parse(await e.load(t.patch)):t.patch;return{...t,...r?{patch:r}:{},...n?{config:n}:{}}}function xkt(t){return xkt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xkt(t)}function _kt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,kkt(r.key),r)}}function kkt(t){var e=function(t,e){if("object"!=xkt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=xkt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==xkt(e)?e:e+""}const Skt=Qo((function(t){return{createModifier:function(t,e){return new t},installModifier:function(t,e,n){t.element=e,t.modify(n)},updateModifier:function(t,e){t.modify(e)},destroyModifier:function(t,e){console.log("destroy")},capabilities:function(){return{disableAutoTracking:!0}}}}),function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"modify",value:function(t){var e=t.positional[0];!async function(t,e,n={}){let r,i;XF(e)?(i=vkt(n.loader),r=JSON.parse(await i.load(e))):r=e;const o=function(t){const e=t.usermeta?.embedOptions??{};return XF(e.defaultStyle)&&(e.defaultStyle=!1),e}(r),s=o.loader;i&&!s||(i=vkt(n.loader??s));const a=await wkt(o,i),l=await wkt(n,i),u={...akt(l,a),config:eF(l.config??{},a.config??{})};await async function(t,e,n={},r){const i=n.theme?eF(y[n.theme],n.config??{}):n.config,o=qF(n.actions)?n.actions:akt({},fkt,n.actions??{}),s={...dkt,...n.i18n},a=n.renderer??"canvas",l=n.logLevel??ukt.Warn,u=n.downloadFileName??"visualization",c="string"==typeof t?document.querySelector(t):t;if(!c)throw new Error(`${t} does not exist`);if(!1!==n.defaultStyle){const t="vega-embed-style",{root:e,rootContainer:r}=function(t){const e=t.getRootNode?t.getRootNode():document;return e instanceof ShadowRoot?{root:e,rootContainer:e}:{root:document,rootContainer:document.head??document.body}}(c);if(!e.getElementById(t)){const e=document.createElement("style");e.id=t,e.innerHTML=void 0===n.defaultStyle||!0===n.defaultStyle?'.vega-embed {\n  position: relative;\n  display: inline-block;\n  box-sizing: border-box;\n}\n.vega-embed.has-actions {\n  padding-right: 38px;\n}\n.vega-embed details:not([open]) > :not(summary) {\n  display: none !important;\n}\n.vega-embed summary {\n  list-style: none;\n  position: absolute;\n  top: 0;\n  right: 0;\n  padding: 6px;\n  z-index: 1000;\n  background: white;\n  box-shadow: 1px 1px 3px rgba(0, 0, 0, 0.1);\n  color: #1b1e23;\n  border: 1px solid #aaa;\n  border-radius: 999px;\n  opacity: 0.2;\n  transition: opacity 0.4s ease-in;\n  cursor: pointer;\n  line-height: 0px;\n}\n.vega-embed summary::-webkit-details-marker {\n  display: none;\n}\n.vega-embed summary:active {\n  box-shadow: #aaa 0px 0px 0px 1px inset;\n}\n.vega-embed summary svg {\n  width: 14px;\n  height: 14px;\n}\n.vega-embed details[open] summary {\n  opacity: 0.7;\n}\n.vega-embed:hover summary, .vega-embed:focus-within summary {\n  opacity: 1 !important;\n  transition: opacity 0.2s ease;\n}\n.vega-embed .vega-actions {\n  position: absolute;\n  z-index: 1001;\n  top: 35px;\n  right: -9px;\n  display: flex;\n  flex-direction: column;\n  padding-bottom: 8px;\n  padding-top: 8px;\n  border-radius: 4px;\n  box-shadow: 0 2px 8px 0 rgba(0, 0, 0, 0.2);\n  border: 1px solid #d9d9d9;\n  background: white;\n  animation-duration: 0.15s;\n  animation-name: scale-in;\n  animation-timing-function: cubic-bezier(0.2, 0, 0.13, 1.5);\n  text-align: left;\n}\n.vega-embed .vega-actions a {\n  padding: 8px 16px;\n  font-family: sans-serif;\n  font-size: 14px;\n  font-weight: 600;\n  white-space: nowrap;\n  color: #434a56;\n  text-decoration: none;\n}\n.vega-embed .vega-actions a:hover, .vega-embed .vega-actions a:focus {\n  background-color: #f7f7f9;\n  color: black;\n}\n.vega-embed .vega-actions::before, .vega-embed .vega-actions::after {\n  content: "";\n  display: inline-block;\n  position: absolute;\n}\n.vega-embed .vega-actions::before {\n  left: auto;\n  right: 14px;\n  top: -16px;\n  border: 8px solid rgba(0, 0, 0, 0);\n  border-bottom-color: #d9d9d9;\n}\n.vega-embed .vega-actions::after {\n  left: auto;\n  right: 15px;\n  top: -14px;\n  border: 7px solid rgba(0, 0, 0, 0);\n  border-bottom-color: #fff;\n}\n.vega-embed .chart-wrapper.fit-x {\n  width: 100%;\n}\n.vega-embed .chart-wrapper.fit-y {\n  height: 100%;\n}\n\n.vega-embed-wrapper {\n  max-width: 100%;\n  overflow: auto;\n  padding-right: 14px;\n}\n\n@keyframes scale-in {\n  from {\n    opacity: 0;\n    transform: scale(0.6);\n  }\n  to {\n    opacity: 1;\n    transform: scale(1);\n  }\n}\n'.toString():n.defaultStyle,r.appendChild(e)}}const h=function(t,e){if(t.$schema){const n=zwt(t.$schema);e&&e!==n.library&&console.warn(`The given visualization spec is written in ${pkt[n.library]}, but mode argument sets ${pkt[e]??e}.`);const r=n.library;return skt(mkt[r],`^${n.version.slice(1)}`)||console.warn(`The input spec uses ${pkt[r]} ${n.version}, but the current version of ${pkt[r]} is v${mkt[r]}.`),r}return"mark"in t||"encoding"in t||"layer"in t||"hconcat"in t||"vconcat"in t||"facet"in t||"repeat"in t?"vega-lite":"marks"in t||"signals"in t||"scales"in t||"axes"in t?"vega":e??"vega"}(e,n.mode);let f=gkt[h](e,i);if("vega-lite"===h&&f.$schema){const t=zwt(f.$schema);skt(mkt.vega,`^${t.version.slice(1)}`)||console.warn(`The compiled spec uses Vega ${t.version}, but current version is v${mkt.vega}.`)}c.classList.add("vega-embed"),o&&c.classList.add("has-actions"),c.innerHTML="";let d=c;if(o){const t=document.createElement("div");t.classList.add("chart-wrapper"),c.appendChild(t),d=t}const p=n.patch;if(p&&(f=p instanceof Function?p(f):m$(f,p,!0,!1).newDocument),n.formatLocale&&ukt.formatLocale(n.formatLocale),n.timeFormatLocale&&ukt.timeFormatLocale(n.timeFormatLocale),n.expressionFunctions)for(const t in n.expressionFunctions){const e=n.expressionFunctions[t];"fn"in e?ukt.expressionFunction(t,e.fn,e.visitor):e instanceof Function&&ukt.expressionFunction(t,e)}const{ast:m}=n,g=ukt.parse(f,"vega-lite"===h?{}:i,{ast:m}),b=new(n.viewClass||ukt.View)(g,{loader:r,logLevel:l,renderer:a,...m?{expr:ukt.expressionInterpreter??n.expr??Eot}:{}});if(b.addSignalListener("autosize",((t,e)=>{const{type:n}=e;"fit-x"==n?(d.classList.add("fit-x"),d.classList.remove("fit-y")):"fit-y"==n?(d.classList.remove("fit-x"),d.classList.add("fit-y")):"fit"==n?d.classList.add("fit-x","fit-y"):d.classList.remove("fit-x","fit-y")})),!1!==n.tooltip){const{loader:t,tooltip:e}=n,r=t&&!bkt(t)?t?.baseURL:void 0,i="function"==typeof e?e:new Hxt({baseURL:r,...!0===e?{}:e}).call;b.tooltip(i)}let v,{hover:w}=n;if(void 0===w&&(w="vega"===h),w){const{hoverSet:t,updateSet:e}="boolean"==typeof w?{}:w;b.hover(t,e)}if(n&&(null!=n.width&&b.width(n.width),null!=n.height&&b.height(n.height),null!=n.padding&&b.padding(n.padding)),await b.initialize(d,n.bind).runAsync(),!1!==o){let t=c;if(!1!==n.defaultStyle||n.forceActionsMenu){const e=document.createElement("details");e.title=s.CLICK_TO_VIEW_ACTIONS,c.append(e),t=e;const n=document.createElement("summary");n.innerHTML='\n<svg viewBox="0 0 16 16" fill="currentColor" stroke="none" stroke-width="1" stroke-linecap="round" stroke-linejoin="round">\n  <circle r="2" cy="8" cx="2"></circle>\n  <circle r="2" cy="8" cx="8"></circle>\n  <circle r="2" cy="8" cx="14"></circle>\n</svg>',e.append(n),v=t=>{e.contains(t.target)||e.removeAttribute("open")},document.addEventListener("click",v)}const r=document.createElement("div");if(t.append(r),r.classList.add("vega-actions"),!0===o||!1!==o.export)for(const t of["svg","png"])if(!0===o||!0===o.export||o.export[t]){const e=s[`${t.toUpperCase()}_ACTION`],i=document.createElement("a"),o=Z$(n.scaleFactor)?n.scaleFactor[t]:n.scaleFactor;i.text=e,i.href="#",i.target="_blank",i.download=`${u}.${t}`,i.addEventListener("mousedown",(async function(e){e.preventDefault();const n=await b.toImageURL(t,o);this.href=n})),r.append(i)}if(!0===o||!1!==o.source){const t=document.createElement("a");t.text=s.SOURCE_ACTION,t.href="#",t.addEventListener("click",(function(t){ykt(M$()(e),n.sourceHeader??"",n.sourceFooter??"",h),t.preventDefault()})),r.append(t)}if("vega-lite"===h&&(!0===o||!1!==o.compiled)){const t=document.createElement("a");t.text=s.COMPILED_ACTION,t.href="#",t.addEventListener("click",(function(t){ykt(M$()(f),n.sourceHeader??"",n.sourceFooter??"","vega"),t.preventDefault()})),r.append(t)}if(!0===o||!1!==o.editor){const t=n.editorUrl??"https://vega.github.io/editor/",o=document.createElement("a");o.text=s.EDITOR_ACTION,o.href="#",o.addEventListener("click",(function(n){!function(t,e,n){const r=t.open(e),{origin:i}=new URL(e);let o=40;t.addEventListener("message",(function e(n){n.source===r&&(o=0,t.removeEventListener("message",e,!1))}),!1),setTimeout((function t(){o<=0||(r.postMessage(n,i),setTimeout(t,250),o-=1)}),250)}(window,t,{config:i,mode:h,renderer:a,spec:M$()(e)}),n.preventDefault()})),r.append(o)}}return{view:b,spec:e,vgSpec:f,finalize:function(){v&&document.removeEventListener("click",v),b.finalize()},embedOptions:n}}(t,r,u,i)}(this.element,e)}}],e&&_kt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}());function Ekt(t){return Ekt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ekt(t)}var Akt,Ckt;function Dkt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Nkt(r.key),r)}}function Mkt(t,e,n){return e=Tkt(e),function(t,e){if(e&&("object"==Ekt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Okt()?Reflect.construct(e,n||[],Tkt(t).constructor):e.apply(t,n))}function Okt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Okt=function(){return!!t})()}function Tkt(t){return Tkt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Tkt(t)}function Ikt(t,e){return Ikt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Ikt(t,e)}function Nkt(t){var e=function(t,e){if("object"!=Ekt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=Ekt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ekt(e)?e:e+""}function $kt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}jE((function(t,e){var n,r,i=(n=t,r=1,function(t){if(Array.isArray(t))return t}(n)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,s,a=[],l=!0,u=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(t){u=!0,i=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}(n,r)||function(t,e){if(t){if("string"==typeof t)return $kt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$kt(t,e):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],o=e.greeting;return"".concat(o," ").concat(i)}));var Fkt=(Akt=function(t){function e(){var t,n,r,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n=t=Mkt(this,e,[].concat(s)),i=t,(r=Ckt)&&Object.defineProperty(n,"data",{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Ikt(t,e)}(e,t),n=e,(r=[{key:"values",get:function(){return this.data.filteredTable.objects()}},{key:"columns",get:function(){return this.args.columns?this.args.columns:this.data.getNumberColumns()}},{key:"specs",get:function(){var t=this;return this.columns.map((function(e){return t.vegaSpec(e)}))}},{key:"vegaSpec",value:function(t){return{data:{values:this.values},mark:"bar",encoding:{x:{field:t,bin:"true",axis:{labelAngle:0}},y:{aggregate:"count"}}}}}])&&Dkt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(_u),Ckt=function(t,e,n,r,i){var o={};return Object.keys(r).forEach((function(t){o[t]=r[t]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(t,e,n)||n}),o),void 0===o.initializer&&(Object.defineProperty(t,e,o),o=null),o}(Akt.prototype,"data",[Cu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Akt);ns(Va({id:"uhOj3VlQ",block:'[[[1,"\\n      "],[10,0],[14,0,"widget"],[12],[1,"\\n    \\t"],[10,0],[14,0,"widget-title"],[12],[1,"Histogram"],[13],[1,"\\n"],[42,[30,0,["specs"]],null,[[[1,"    \\t"],[11,0],[24,0,"render"],[4,[32,0],[[30,1]],null],[12],[13],[1,"\\n"]],[1]],null],[1,"  \\t"],[13],[1,"\\n    "]],["col"],false,["each"]]',moduleName:"(unknown template module)",scope:function(){return[Skt]},isStrictMode:!0}),Fkt);const Lkt=Fkt;function Bkt(t){return Bkt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Bkt(t)}function Rkt(t,e,n){return e=zkt(e),function(t,e){if(e&&("object"==Bkt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Pkt()?Reflect.construct(e,n||[],zkt(t).constructor):e.apply(t,n))}function Pkt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Pkt=function(){return!!t})()}function zkt(t){return zkt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},zkt(t)}function jkt(t,e){return jkt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},jkt(t,e)}var Ukt=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Rkt(this,e,arguments)}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&jkt(t,e)}(e,t),n=e,Object.defineProperty(n,"prototype",{writable:!1}),n;var n}(_u);ns(Va({id:"HXvzOZTq",block:'[[[1,"\\n      "],[10,0],[14,0,"navbar bg-base-100"],[12],[1,"\\n  "],[10,0],[14,0,"flex-none"],[12],[1,"\\n    "],[10,"button"],[14,0,"btn btn-square btn-ghost"],[12],[1,"\\n      "],[10,"svg"],[14,"xmlns","http://www.w3.org/2000/svg","http://www.w3.org/2000/xmlns/"],[14,"fill","none"],[14,"viewBox","0 0 24 24"],[14,0,"inline-block w-5 h-5 stroke-current"],[12],[10,"path"],[14,"stroke-linecap","round"],[14,"stroke-linejoin","round"],[14,"stroke-width","2"],[14,"d","M4 6h16M4 12h16M4 18h16"],[12],[13],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n  "],[10,0],[14,0,"flex-1"],[12],[1,"\\n    "],[10,3],[14,0,"btn btn-ghost text-xl"],[12],[1,"Push Components"],[13],[1,"\\n  "],[13],[1,"\\n  "],[10,0],[14,0,"flex-none"],[12],[1,"\\n    "],[10,"button"],[14,0,"btn btn-square btn-ghost"],[12],[1,"\\n      "],[10,"svg"],[14,"xmlns","http://www.w3.org/2000/svg","http://www.w3.org/2000/xmlns/"],[14,"fill","none"],[14,"viewBox","0 0 24 24"],[14,0,"inline-block w-5 h-5 stroke-current"],[12],[10,"path"],[14,"stroke-linecap","round"],[14,"stroke-linejoin","round"],[14,"stroke-width","2"],[14,"d","M5 12h.01M12 12h.01M19 12h.01M6 12a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0zm7 0a1 1 0 11-2 0 1 1 0 012 0z"],[12],[13],[13],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"],[13],[1,"\\n    "]],[],false,[]]',moduleName:"(unknown template module)",isStrictMode:!0}),Ukt);const Vkt=Ukt;function qkt(t){return qkt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qkt(t)}var Wkt,Hkt,Gkt;function Ykt(){Ykt=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,s=Object.create(o.prototype),a=new O(r||[]);return i(s,"_invoke",{value:A(t,n,a)}),s}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",m="completed",g={};function y(){}function b(){}function v(){}var w={};u(w,s,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(T([])));_&&_!==n&&r.call(_,s)&&(w=_);var k=v.prototype=y.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(i,o,s,a){var l=h(t[i],t,o);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==qkt(c)&&r.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(c).then((function(t){u.value=t,s(u)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function A(e,n,r){var i=f;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===m){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=C(a,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var u=h(e,n,r);if("normal"===u.type){if(i=r.done?m:d,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=m,r.method="throw",r.arg=u.arg)}}}function C(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,C(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function D(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(D,this),this.reset(!0)}function T(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(qkt(e)+" is not iterable")}return b.prototype=v,i(k,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:b,configurable:!0}),b.displayName=u(v,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,u(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},S(E.prototype),u(E.prototype,a,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new E(c(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(k),u(k,l,"Generator"),u(k,s,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=T,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(M),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),u=r.call(s,"finallyLoc");if(l&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),M(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;M(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:T(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}function Xkt(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function Jkt(t,e,n,r){n&&Object.defineProperty(t,e,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function Kkt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,nSt(r.key),r)}}function Qkt(t,e,n){return e=tSt(e),function(t,e){if(e&&("object"==qkt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,Zkt()?Reflect.construct(e,n||[],tSt(t).constructor):e.apply(t,n))}function Zkt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(Zkt=function(){return!!t})()}function tSt(t){return tSt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},tSt(t)}function eSt(t,e){return eSt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},eSt(t,e)}function nSt(t){var e=function(t,e){if("object"!=qkt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=qkt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==qkt(e)?e:e+""}function rSt(t,e,n,r,i){var o={};return Object.keys(r).forEach((function(t){o[t]=r[t]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(t,e,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(t,e,o),o=null),o}var iSt=(Wkt=function(t){function e(){var t;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return Jkt(t=Qkt(this,e,[].concat(r)),"preset",Hkt,t),Jkt(t,"data",Gkt,t),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eSt(t,e)}(e,t),n=e,r=[{key:"presets",get:function(){return this.preset.presets}},{key:"loadPreset",value:(i=Ykt().mark((function t(e,n){return Ykt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.preset.load(this.data,e);case 1:case"end":return t.stop()}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(n,r){var o=i.apply(t,e);function s(t){Xkt(o,n,r,s,a,"next",t)}function a(t){Xkt(o,n,r,s,a,"throw",t)}s(void 0)}))},function(t,e){return o.apply(this,arguments)})}],r&&Kkt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r,i,o}(_u),Hkt=rSt(Wkt.prototype,"preset",[Cu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),Gkt=rSt(Wkt.prototype,"data",[Cu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),rSt(Wkt.prototype,"loadPreset",[Mu],Object.getOwnPropertyDescriptor(Wkt.prototype,"loadPreset"),Wkt.prototype),Wkt);ns(Va({id:"HIGOKcTq",block:'[[[1,"    \\n    "],[10,"h3"],[12],[1,"Datasets"],[13],[1,"\\n    "],[10,"ul"],[14,0,"menu p-4 w-80 min-h-full bg-base-200 text-base-content"],[12],[1,"\\n"],[42,[30,0,["presets"]],null,[[[1,"      \\t\\t"],[10,"li"],[12],[11,3],[4,[32,0],["click",[28,[32,1],[[30,0,["loadPreset"]],[30,1]],null]],null],[12],[1,[30,1,["title"]]],[13],[13],[1,"\\n"]],[1]],null],[1,"    "],[13],[1,"\\n\\n    "]],["preset"],false,["each"]]',moduleName:"(unknown template module)",scope:function(){return[Xl,UE]},isStrictMode:!0}),iSt);const oSt=iSt;function sSt(t){return sSt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sSt(t)}var aSt,lSt;function uSt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,pSt(r.key),r)}}function cSt(t,e,n){return e=fSt(e),function(t,e){if(e&&("object"==sSt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(t,hSt()?Reflect.construct(e,n||[],fSt(t).constructor):e.apply(t,n))}function hSt(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(hSt=function(){return!!t})()}function fSt(t){return fSt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},fSt(t)}function dSt(t,e){return dSt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},dSt(t,e)}function pSt(t){var e=function(t,e){if("object"!=sSt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=sSt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==sSt(e)?e:e+""}function mSt(t,e,n,r,i){var o={};return Object.keys(r).forEach((function(t){o[t]=r[t]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(t,e,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(t,e,o),o=null),o}function gSt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}jE((function(t,e){var n,r,i=(n=t,r=1,function(t){if(Array.isArray(t))return t}(n)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,i,o,s,a=[],l=!0,u=!1;try{if(o=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=o.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(t){u=!0,i=t}finally{try{if(!l&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(u)throw i}}return a}}(n,r)||function(t,e){if(t){if("string"==typeof t)return gSt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?gSt(t,e):void 0}}(n,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],o=e.greeting;return"".concat(o," ").concat(i)}));var ySt=(aSt=function(t){function e(){var t,n,r,i;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);for(var o=arguments.length,s=new Array(o),a=0;a<o;a++)s[a]=arguments[a];return n=t=cSt(this,e,[].concat(s)),i=t,(r=lSt)&&Object.defineProperty(n,"data",{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(i):void 0}),t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&dSt(t,e)}(e,t),n=e,(r=[{key:"filter",get:function(){return this.data.filter}},{key:"groupColumnsString",get:function(){return this.data.groupColumns.join(",")}},{key:"updateFilter",value:function(t){this.data.filter=t}},{key:"updateGroupColumns",value:function(t){this.data.groupColumns=t.split(",")}},{key:"updateRollupSpec",value:function(t){try{this.data.rollup=JSON.parse(t)}catch(t){this.data.rollup=null,console.log("parsing failed")}}},{key:"updateDeriveSpec",value:function(t){try{this.data.derive=JSON.parse(t)}catch(t){this.data.derive=null,console.log("parsing failed")}}},{key:"rollupSpec",get:function(){return JSON.stringify(this.data.rollup,0,2)}},{key:"deriveSpec",get:function(){return JSON.stringify(this.data.derive,0,2)}}])&&uSt(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n;var n,r}(_u),lSt=mSt(aSt.prototype,"data",[Cu],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),mSt(aSt.prototype,"updateFilter",[Mu],Object.getOwnPropertyDescriptor(aSt.prototype,"updateFilter"),aSt.prototype),mSt(aSt.prototype,"updateGroupColumns",[Mu],Object.getOwnPropertyDescriptor(aSt.prototype,"updateGroupColumns"),aSt.prototype),mSt(aSt.prototype,"updateRollupSpec",[Mu],Object.getOwnPropertyDescriptor(aSt.prototype,"updateRollupSpec"),aSt.prototype),mSt(aSt.prototype,"updateDeriveSpec",[Mu],Object.getOwnPropertyDescriptor(aSt.prototype,"updateDeriveSpec"),aSt.prototype),aSt);ns(Va({id:"Whi+s965",block:'[[[1,"\\n    \\t"],[8,[32,0],null,null,null],[1,"\\n"],[10,0],[14,0,"drawer drawer-open"],[12],[1,"\\n  "],[10,"input"],[14,1,"my-drawer"],[14,0,"drawer-toggle"],[14,4,"checkbox"],[12],[13],[1,"\\n    \\t"],[10,0],[14,0,"drawer-content"],[12],[1,"\\n    \\t"],[10,0],[14,0,"py-8 px-8 container mx-auto"],[12],[1,"\\n    \\t\\t"],[10,0],[14,0,"section-title"],[12],[1,"\\n    \\t\\t\\tSummary\\n    \\t\\t"],[13],[1,"\\n\\t\\t\\t"],[8,[32,1],null,[["@title"],["Impressions"]],null],[1,"\\n    \\t\\t"],[10,0],[14,0,"section-title"],[12],[1,"\\n    \\t\\t\\tDetails\\n    \\t\\t"],[13],[1,"\\n\\t\\t\\t "],[8,[32,2],null,null,null],[1,"\\n    \\t\\t"],[10,0],[14,0,"section-title"],[12],[1,"\\n    \\t\\t\\tDebug\\n    \\t\\t"],[13],[1,"\\n\\t\\t\\t"],[8,[32,3],null,null,null],[1,"\\n    \\t\\t"],[10,0],[14,0,"section-title"],[12],[1,"\\n    \\t\\t\\tHistogram\\n    \\t\\t"],[13],[1,"\\n\\t\\t\\t "],[8,[32,4],null,null,null],[1,"\\n\\t\\t\\t "],[13],[1,"\\n\\t\\t"],[13],[1,"\\n  "],[10,0],[14,0,"drawer-side bg-base-100"],[12],[1,"\\n    "],[10,"label"],[14,"for","my-drawer-2"],[14,"aria-label","close sidebar"],[14,0,"drawer-overlay"],[12],[13],[1," \\n    "],[10,0],[14,0,"py-2 px-4 bg-base-100"],[12],[1,"\\n    \\t"],[8,[32,5],null,null,null],[1,"\\n        "],[8,[32,6],null,[["@title","@value","@onInput"],["Filter",[30,0,["filter"]],[30,0,["updateFilter"]]]],null],[1,"\\n        "],[8,[32,6],null,[["@title","@value","@onInput"],["Group columns",[30,0,["groupColumnsString"]],[30,0,["updateGroupColumns"]]]],null],[1,"\\n      \\t"],[8,[32,7],null,[["@title","@value","@onInput"],["Rollup",[30,0,["rollupSpec"]],[30,0,["updateRollupSpec"]]]],null],[1,"\\n\\t    "],[8,[32,7],null,[["@title","@value","@onInput"],["Derive",[30,0,["deriveSpec"]],[30,0,["updateDeriveSpec"]]]],null],[1,"\\n\\t  "],[13],[1,"\\n  "],[13],[1,"\\n"],[13],[1,"\\n    "]],[],false,[]]',moduleName:"(unknown template module)",scope:function(){return[Vkt,bN,MN,JN,Lkt,oSt,WI,eN]},isStrictMode:!0}),ySt);const bSt=ySt;var vSt,wSt,xSt,_St,kSt,SSt,ESt;function ASt(t,e){var n="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!n){if(Array.isArray(t)||(n=MSt(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var r=0,i=function(){};return{s:i,n:function(){return r>=t.length?{done:!0}:{done:!1,value:t[r++]}},e:function(t){throw t},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,a=!1;return{s:function(){n=n.call(t)},n:function(){var t=n.next();return s=t.done,t},e:function(t){a=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(a)throw o}}}}function CSt(t){return CSt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},CSt(t)}function DSt(t){return function(t){if(Array.isArray(t))return OSt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||MSt(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function MSt(t,e){if(t){if("string"==typeof t)return OSt(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?OSt(t,e):void 0}}function OSt(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function TSt(){TSt=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,s=Object.create(o.prototype),a=new O(r||[]);return i(s,"_invoke",{value:A(t,n,a)}),s}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",m="completed",g={};function y(){}function b(){}function v(){}var w={};u(w,s,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(T([])));_&&_!==n&&r.call(_,s)&&(w=_);var k=v.prototype=y.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(i,o,s,a){var l=h(t[i],t,o);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==CSt(c)&&r.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(c).then((function(t){u.value=t,s(u)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function A(e,n,r){var i=f;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===m){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=C(a,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var u=h(e,n,r);if("normal"===u.type){if(i=r.done?m:d,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=m,r.method="throw",r.arg=u.arg)}}}function C(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,C(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function D(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(D,this),this.reset(!0)}function T(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(CSt(e)+" is not iterable")}return b.prototype=v,i(k,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:b,configurable:!0}),b.displayName=u(v,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,u(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},S(E.prototype),u(E.prototype,a,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new E(c(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(k),u(k,l,"Generator"),u(k,s,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=T,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(M),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),u=r.call(s,"finallyLoc");if(l&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),M(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;M(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:T(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}function ISt(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function NSt(t){return function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function s(t){ISt(o,r,i,s,a,"next",t)}function a(t){ISt(o,r,i,s,a,"throw",t)}s(void 0)}))}}function $St(t,e,n,r){n&&Object.defineProperty(t,e,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function FSt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,LSt(r.key),r)}}function LSt(t){var e=function(t,e){if("object"!=CSt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=CSt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==CSt(e)?e:e+""}function BSt(t,e,n,r,i){var o={};return Object.keys(r).forEach((function(t){o[t]=r[t]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(t,e,n)||n}),o),i&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(i):void 0,o.initializer=void 0),void 0===o.initializer&&(Object.defineProperty(t,e,o),o=null),o}var RSt=(vSt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),$St(this,"dataTable",wSt,this),$St(this,"filter",xSt,this),$St(this,"filterParams",_St,this),$St(this,"groupColumns",kSt,this),$St(this,"rollup",SSt,this),$St(this,"derive",ESt,this),this.dataTable=Pw.new(void 0,void 0),this.groupColumns=[]},e=[{key:"loadArrow",value:(r=NSt(TSt().mark((function t(e){return TSt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,BE(e);case 2:this.dataTable=t.sent;case 3:case"end":return t.stop()}}),t,this)}))),function(t){return r.apply(this,arguments)})},{key:"loadFrom",value:(n=NSt(TSt().mark((function t(e){return TSt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.dataTable=(n=e,r=void 0,Pw.from(n,r));case 1:case"end":return t.stop()}var n,r}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"dataTable",get:function(){return this.dataTable}},{key:"filteredTable",get:function(){return this.filter?this.dataTable.filter(this.filter):this.dataTable}},{key:"groupNames",get:function(){var t=this;try{if(this.groupColumns.length>0){var e=this.groupColumns.map((function(e){return t.filteredTable.rollup({col:zc.array_agg_distinct(e)}).object().col}));return 1===e.length?e[0].map((function(t){return[t]})):cartesian.apply(void 0,DSt(e))}return[]}catch(t){return[]}}},{key:"groupedTable",get:function(){try{return null==this.groupColumns||0==this.groupColumns.length?this.filteredTable:this.filteredTable.groupby(this.groupColumns)}catch(t){return console.log("group columns invalid"),this.filteredTable}}},{key:"groupedTables",get:function(){try{var t;return void 0!==this.groupColumns&&void 0!==this.filteredTable&&this.groupColumns.length>0?((t=this.filteredTable).groupby.apply(t,DSt(groupColumns)),this.groupedTable.partitions().map((function(t){return filteredTable.reify(t)}))):[]}catch(t){return console.log("group columns invalid"),[]}}},{key:"cartesian",value:function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return e.reduce((function(t,e){return t.flatMap((function(t){return e.map((function(e){return[t,e].reduce((function(t,e){return t.concat(e)}),[])}))}))}))}},{key:"getColumnType",value:function(t){var e=this.dataTable.column(t);if(void 0!==e){var n=e.get(0);return"SignedBigNum"===n.constructor.name?"number":"object"===CSt(n)&&n.constructor.name.includes("Array")?"array":CSt(n)}}},{key:"getCategoryColumns",value:function(){var t,e=[],n=ASt(this.dataTable.columnNames());try{for(n.s();!(t=n.n()).done;){var r=t.value;"string"===this.getColumnType(r)&&this.isStringColumnBinnable(r)&&e.push(r)}}catch(t){n.e(t)}finally{n.f()}return e}},{key:"getNumberColumns",value:function(){var t,e=[],n=ASt(this.dataTable.columnNames());try{for(n.s();!(t=n.n()).done;){var r=t.value,i=this.getColumnType(r);console.log(i),"number"===i&&this.isNumberColumnBinnable(r)&&e.push(r)}}catch(t){n.e(t)}finally{n.f()}return e}},{key:"isStringColumnBinnable",value:function(t){var e=this.dataTable.groupby(t).count().numRows();return e<.1*this.dataTable.numRows()&&e<20}},{key:"isNumberColumnBinnable",value:function(t){var e=this.dataTable.groupby(t).count().numRows();return console.log(e),console.log(.01*this.dataTable.numRows()),e>.01*this.dataTable.numRows()}}],e&&FSt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}(),wSt=BSt(vSt.prototype,"dataTable",[Su],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),xSt=BSt(vSt.prototype,"filter",[Su],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),_St=BSt(vSt.prototype,"filterParams",[Su],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),kSt=BSt(vSt.prototype,"groupColumns",[Su],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),SSt=BSt(vSt.prototype,"rollup",[Su],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),ESt=BSt(vSt.prototype,"derive",[Su],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),vSt);function PSt(t){return PSt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},PSt(t)}function zSt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,jSt(r.key),r)}}function jSt(t){var e=function(t,e){if("object"!=PSt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=PSt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==PSt(e)?e:e+""}var USt,VSt,qSt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"previousDate",value:function(t,e,n){var r=Date.parse(t);if(null==r)return null;var i=$O.floor(r);return+i!=+r?(console.log("date not week aligned"),console.log(r),console.log(i),null):("isoweek"==e&&i.setDate(i.getDate()-7*n),i.toISOString().substring(0,10))}}],e&&zSt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function WSt(t){return WSt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},WSt(t)}function HSt(){HSt=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,i=Object.defineProperty||function(t,e,n){t[e]=n.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function c(t,e,n,r){var o=e&&e.prototype instanceof y?e:y,s=Object.create(o.prototype),a=new O(r||[]);return i(s,"_invoke",{value:A(t,n,a)}),s}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=c;var f="suspendedStart",d="suspendedYield",p="executing",m="completed",g={};function y(){}function b(){}function v(){}var w={};u(w,s,(function(){return this}));var x=Object.getPrototypeOf,_=x&&x(x(T([])));_&&_!==n&&r.call(_,s)&&(w=_);var k=v.prototype=y.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function n(i,o,s,a){var l=h(t[i],t,o);if("throw"!==l.type){var u=l.arg,c=u.value;return c&&"object"==WSt(c)&&r.call(c,"__await")?e.resolve(c.__await).then((function(t){n("next",t,s,a)}),(function(t){n("throw",t,s,a)})):e.resolve(c).then((function(t){u.value=t,s(u)}),(function(t){return n("throw",t,s,a)}))}a(l.arg)}var o;i(this,"_invoke",{value:function(t,r){function i(){return new e((function(e,i){n(t,r,e,i)}))}return o=o?o.then(i,i):i()}})}function A(e,n,r){var i=f;return function(o,s){if(i===p)throw Error("Generator is already running");if(i===m){if("throw"===o)throw s;return{value:t,done:!0}}for(r.method=o,r.arg=s;;){var a=r.delegate;if(a){var l=C(a,r);if(l){if(l===g)continue;return l}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(i===f)throw i=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);i=p;var u=h(e,n,r);if("normal"===u.type){if(i=r.done?m:d,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(i=m,r.method="throw",r.arg=u.arg)}}}function C(e,n){var r=n.method,i=e.iterator[r];if(i===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,C(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var o=h(i,e.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,g;var s=o.arg;return s?s.done?(n[e.resultName]=s.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):s:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function D(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function M(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function O(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(D,this),this.reset(!0)}function T(e){if(e||""===e){var n=e[s];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function n(){for(;++i<e.length;)if(r.call(e,i))return n.value=e[i],n.done=!1,n;return n.value=t,n.done=!0,n};return o.next=o}}throw new TypeError(WSt(e)+" is not iterable")}return b.prototype=v,i(k,"constructor",{value:v,configurable:!0}),i(v,"constructor",{value:b,configurable:!0}),b.displayName=u(v,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===b||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,v):(t.__proto__=v,u(t,l,"GeneratorFunction")),t.prototype=Object.create(k),t},e.awrap=function(t){return{__await:t}},S(E.prototype),u(E.prototype,a,(function(){return this})),e.AsyncIterator=E,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var s=new E(c(t,n,r,i),o);return e.isGeneratorFunction(n)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},S(k),u(k,l,"Generator"),u(k,s,(function(){return this})),u(k,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=T,O.prototype={constructor:O,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(M),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function i(r,i){return a.type="throw",a.arg=e,n.next=r,i&&(n.method="next",n.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=r.call(s,"catchLoc"),u=r.call(s,"finallyLoc");if(l&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var i=this.tryEntries[n];if(i.tryLoc<=this.prev&&r.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),M(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;M(n)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:T(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},e}function GSt(t,e,n,r,i,o,s){try{var a=t[o](s),l=a.value}catch(t){return void n(t)}a.done?e(l):Promise.resolve(l).then(r,i)}function YSt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,XSt(r.key),r)}}function XSt(t){var e=function(t,e){if("object"!=WSt(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var r=n.call(t,"string");if("object"!=WSt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==WSt(e)?e:e+""}var JSt=(USt=function(){return t=function t(){var e,n,r;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),e=this,r=this,(n=VSt)&&Object.defineProperty(e,"presets",{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})},e=[{key:"load",value:(n=HSt().mark((function t(e,n){return HSt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n.values&&e.loadFrom(n.values),n.url&&e.loadArrow(n.url),e.filter=n.filter,e.groupColumns=n.groupColumns,e.rollup=n.rollup,e.derive=n.derive;case 6:case"end":return t.stop()}}),t)})),r=function(){var t=this,e=arguments;return new Promise((function(r,i){var o=n.apply(t,e);function s(t){GSt(o,r,i,s,a,"next",t)}function a(t){GSt(o,r,i,s,a,"throw",t)}s(void 0)}))},function(t,e){return r.apply(this,arguments)})}],e&&YSt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}(),VSt=function(t,e,n,r,i){var o={};return Object.keys(r).forEach((function(t){o[t]=r[t]})),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=n.slice().reverse().reduce((function(n,r){return r(t,e,n)||n}),o),void 0===o.initializer&&(Object.defineProperty(t,e,o),o=null),o}(USt.prototype,"presets",[Su],{configurable:!0,enumerable:!0,writable:!0,initializer:null}),USt),KSt=n(72),QSt=n.n(KSt),ZSt=n(825),tEt=n.n(ZSt),eEt=n(659),nEt=n.n(eEt),rEt=n(56),iEt=n.n(rEt),oEt=n(540),sEt=n.n(oEt),aEt=n(113),lEt=n.n(aEt),uEt=n(275),cEt={};cEt.styleTagTransform=lEt(),cEt.setAttributes=iEt(),cEt.insert=nEt().bind(null,"head"),cEt.domAPI=tEt(),cEt.insertStyleElement=sEt(),QSt()(uEt.A,cEt),uEt.A&&uEt.A.locals&&uEt.A.locals;var hEt=new RSt,fEt=new JSt;fEt.presets=[{title:"Campaigns",values:[{date:"2024-07-01",campaign:"COKE",impressions:500},{date:"2024-07-01",campaign:"PEPSI",impressions:700},{date:"2024-04-01",campaign:"COKE",impressions:200},{date:"2024-04-01",campaign:"PEPSI",impressions:300},{date:"2024-01-01",campaign:"SPRITE",impressions:100},{date:"2024-01-01",campaign:"SPRITE",impressions:700}],groupColumns:["date","campaign"],filter:"",rollup:{impressions:"op.sum(d.impressions)"},derive:{value:"d.impressions"}}],fEt.load(hEt,fEt.presets[0]),function(t,e){if(e instanceof Element)return iu(t,e);const{element:n,args:r,services:i,rehydrate:o}=e,s=new fu(i||{});iu(t,{element:n,args:r,owner:s,rehydrate:o})}(bSt,{element:document.getElementById("app"),args:{},services:{data:hEt,dateCalc:new qSt,preset:fEt}})})();